(function(){"use strict";function Ol(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Ww(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function s(){var i=!1;try{i=this instanceof s}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var i=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:function(){return n[s]}})}),t}var Ml,Sf;function $w(){if(Sf)return Ml;Sf=1;const n=e=>{const t=new Set;do for(const s of Reflect.ownKeys(e))t.add([e,s]);while((e=Reflect.getPrototypeOf(e))&&e!==Object.prototype);return t};return Ml=(e,{include:t,exclude:s}={})=>{const i=r=>{const a=o=>typeof o=="string"?r===o:o.test(r);return t?t.some(a):s?!s.some(a):!0};for(const[r,a]of n(e.constructor.prototype)){if(a==="constructor"||!i(a))continue;const o=Reflect.getOwnPropertyDescriptor(r,a);o&&typeof o.value=="function"&&(e[a]=e[a].bind(e))}return e},Ml}var Gw=$w();const zi=Ol(Gw);var La={exports:{}},Jw=La.exports,If;function Tf(){return If||(If=1,(function(n){(function(e,t,s){function i(l){var u=this,d=o();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=d(" "),u.s1=d(" "),u.s2=d(" "),u.s0-=d(l),u.s0<0&&(u.s0+=1),u.s1-=d(l),u.s1<0&&(u.s1+=1),u.s2-=d(l),u.s2<0&&(u.s2+=1),d=null}function r(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function a(l,u){var d=new i(l),h=u&&u.state,f=d.next;return f.int32=function(){return d.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,h&&(typeof h=="object"&&r(h,d),f.state=function(){return r(d,{})}),f}function o(){var l=4022871197,u=function(d){d=String(d);for(var h=0;h<d.length;h++){l+=d.charCodeAt(h);var f=.02519603282416938*l;l=f>>>0,f-=l,f*=l,l=f>>>0,f-=l,l+=f*4294967296}return(l>>>0)*23283064365386963e-26};return u}t&&t.exports?t.exports=a:this.alea=a})(Jw,n)})(La)),La.exports}var Aa={exports:{}},Kw=Aa.exports,Ef;function Zw(){return Ef||(Ef=1,(function(n){(function(e,t,s){function i(o){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},o===(o|0)?l.x=o:u+=o;for(var d=0;d<u.length+64;d++)l.x^=u.charCodeAt(d)|0,l.next()}function r(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function a(o,l){var u=new i(o),d=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,C=(u.next()>>>0)/4294967296,b=(f+C)/(1<<21);while(b===0);return b},h.int32=u.next,h.quick=h,d&&(typeof d=="object"&&r(d,u),h.state=function(){return r(u,{})}),h}t&&t.exports?t.exports=a:this.xor128=a})(Kw,n)})(Aa)),Aa.exports}var Da={exports:{}},Yw=Da.exports,Rf;function Xw(){return Rf||(Rf=1,(function(n){(function(e,t,s){function i(o){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:u+=o;for(var d=0;d<u.length+64;d++)l.x^=u.charCodeAt(d)|0,d==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function r(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function a(o,l){var u=new i(o),d=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,C=(u.next()>>>0)/4294967296,b=(f+C)/(1<<21);while(b===0);return b},h.int32=u.next,h.quick=h,d&&(typeof d=="object"&&r(d,u),h.state=function(){return r(u,{})}),h}t&&t.exports?t.exports=a:this.xorwow=a})(Yw,n)})(Da)),Da.exports}var Oa={exports:{}},e0=Oa.exports,_f;function t0(){return _f||(_f=1,(function(n){(function(e,t,s){function i(o){var l=this;l.next=function(){var d=l.x,h=l.i,f,C;return f=d[h],f^=f>>>7,C=f^f<<24,f=d[h+1&7],C^=f^f>>>10,f=d[h+3&7],C^=f^f>>>3,f=d[h+4&7],C^=f^f<<7,f=d[h+7&7],f=f^f<<13,C^=f^f<<9,d[h]=C,l.i=h+1&7,C};function u(d,h){var f,C=[];if(h===(h|0))C[0]=h;else for(h=""+h,f=0;f<h.length;++f)C[f&7]=C[f&7]<<15^h.charCodeAt(f)+C[f+1&7]<<13;for(;C.length<8;)C.push(0);for(f=0;f<8&&C[f]===0;++f);for(f==8?C[7]=-1:C[f],d.x=C,d.i=0,f=256;f>0;--f)d.next()}u(l,o)}function r(o,l){return l.x=o.x.slice(),l.i=o.i,l}function a(o,l){o==null&&(o=+new Date);var u=new i(o),d=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,C=(u.next()>>>0)/4294967296,b=(f+C)/(1<<21);while(b===0);return b},h.int32=u.next,h.quick=h,d&&(d.x&&r(d,u),h.state=function(){return r(u,{})}),h}t&&t.exports?t.exports=a:this.xorshift7=a})(e0,n)})(Oa)),Oa.exports}var Ma={exports:{}},s0=Ma.exports,Lf;function i0(){return Lf||(Lf=1,(function(n){(function(e,t,s){function i(o){var l=this;l.next=function(){var d=l.w,h=l.X,f=l.i,C,b;return l.w=d=d+1640531527|0,b=h[f+34&127],C=h[f=f+1&127],b^=b<<13,C^=C<<17,b^=b>>>15,C^=C>>>12,b=h[f]=b^C,l.i=f,b+(d^d>>>16)|0};function u(d,h){var f,C,b,x,V,P=[],M=128;for(h===(h|0)?(C=h,h=null):(h=h+"\0",C=0,M=Math.max(M,h.length)),b=0,x=-32;x<M;++x)h&&(C^=h.charCodeAt((x+32)%h.length)),x===0&&(V=C),C^=C<<10,C^=C>>>15,C^=C<<4,C^=C>>>13,x>=0&&(V=V+1640531527|0,f=P[x&127]^=C+V,b=f==0?b+1:0);for(b>=128&&(P[(h&&h.length||0)&127]=-1),b=127,x=512;x>0;--x)C=P[b+34&127],f=P[b=b+1&127],C^=C<<13,f^=f<<17,C^=C>>>15,f^=f>>>12,P[b]=C^f;d.w=V,d.X=P,d.i=b}u(l,o)}function r(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function a(o,l){o==null&&(o=+new Date);var u=new i(o),d=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,C=(u.next()>>>0)/4294967296,b=(f+C)/(1<<21);while(b===0);return b},h.int32=u.next,h.quick=h,d&&(d.X&&r(d,u),h.state=function(){return r(u,{})}),h}t&&t.exports?t.exports=a:this.xor4096=a})(s0,n)})(Ma)),Ma.exports}var ka={exports:{}},r0=ka.exports,Af;function n0(){return Af||(Af=1,(function(n){(function(e,t,s){function i(o){var l=this,u="";l.next=function(){var h=l.b,f=l.c,C=l.d,b=l.a;return h=h<<25^h>>>7^f,f=f-C|0,C=C<<24^C>>>8^b,b=b-h|0,l.b=h=h<<20^h>>>12^f,l.c=f=f-C|0,l.d=C<<16^f>>>16^b,l.a=b-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):u+=o;for(var d=0;d<u.length+20;d++)l.b^=u.charCodeAt(d)|0,l.next()}function r(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function a(o,l){var u=new i(o),d=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,C=(u.next()>>>0)/4294967296,b=(f+C)/(1<<21);while(b===0);return b},h.int32=u.next,h.quick=h,d&&(typeof d=="object"&&r(d,u),h.state=function(){return r(u,{})}),h}t&&t.exports?t.exports=a:this.tychei=a})(r0,n)})(ka)),ka.exports}var Na={exports:{}};const Df=Ww(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var a0=Na.exports,Of;function o0(){return Of||(Of=1,(function(n){(function(e,t,s){var i=256,r=6,a=52,o="random",l=s.pow(i,r),u=s.pow(2,a),d=u*2,h=i-1,f;function C(N,W,J){var ie=[];W=W==!0?{entropy:!0}:W||{};var ne=P(V(W.entropy?[N,X(t)]:N??M(),3),ie),ce=new b(ie),ye=function(){for(var le=ce.g(r),be=l,F=0;le<u;)le=(le+F)*i,be*=i,F=ce.g(1);for(;le>=d;)le/=2,be/=2,F>>>=1;return(le+F)/be};return ye.int32=function(){return ce.g(4)|0},ye.quick=function(){return ce.g(4)/4294967296},ye.double=ye,P(X(ce.S),t),(W.pass||J||function(le,be,F,Z){return Z&&(Z.S&&x(Z,ce),le.state=function(){return x(ce,{})}),F?(s[o]=le,be):le})(ye,ne,"global"in W?W.global:this==s,W.state)}function b(N){var W,J=N.length,ie=this,ne=0,ce=ie.i=ie.j=0,ye=ie.S=[];for(J||(N=[J++]);ne<i;)ye[ne]=ne++;for(ne=0;ne<i;ne++)ye[ne]=ye[ce=h&ce+N[ne%J]+(W=ye[ne])],ye[ce]=W;(ie.g=function(le){for(var be,F=0,Z=ie.i,ae=ie.j,ue=ie.S;le--;)be=ue[Z=h&Z+1],F=F*i+ue[h&(ue[Z]=ue[ae=h&ae+be])+(ue[ae]=be)];return ie.i=Z,ie.j=ae,F})(i)}function x(N,W){return W.i=N.i,W.j=N.j,W.S=N.S.slice(),W}function V(N,W){var J=[],ie=typeof N,ne;if(W&&ie=="object")for(ne in N)try{J.push(V(N[ne],W-1))}catch{}return J.length?J:ie=="string"?N:N+"\0"}function P(N,W){for(var J=N+"",ie,ne=0;ne<J.length;)W[h&ne]=h&(ie^=W[h&ne]*19)+J.charCodeAt(ne++);return X(W)}function M(){try{var N;return f&&(N=f.randomBytes)?N=N(i):(N=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(N)),X(N)}catch{var W=e.navigator,J=W&&W.plugins;return[+new Date,e,J,e.screen,X(t)]}}function X(N){return String.fromCharCode.apply(0,N)}if(P(s.random(),t),n.exports){n.exports=C;try{f=Df}catch{}}else s["seed"+o]=C})(typeof self<"u"?self:a0,[],Math)})(Na)),Na.exports}var kl,Mf;function l0(){if(Mf)return kl;Mf=1;var n=Tf(),e=Zw(),t=Xw(),s=t0(),i=i0(),r=n0(),a=o0();return a.alea=n,a.xor128=e,a.xorwow=t,a.xorshift7=s,a.xor4096=i,a.tychei=r,kl=a,kl}var Nl,kf;function u0(){if(kf)return Nl;kf=1;var n=l0(),e=["ability","able","aboard","about","above","accept","accident","according","account","accurate","acres","across","act","action","active","activity","actual","actually","add","addition","additional","adjective","adult","adventure","advice","affect","afraid","after","afternoon","again","against","age","ago","agree","ahead","aid","air","airplane","alike","alive","all","allow","almost","alone","along","aloud","alphabet","already","also","although","am","among","amount","ancient","angle","angry","animal","announced","another","answer","ants","any","anybody","anyone","anything","anyway","anywhere","apart","apartment","appearance","apple","applied","appropriate","are","area","arm","army","around","arrange","arrangement","arrive","arrow","art","article","as","aside","ask","asleep","at","ate","atmosphere","atom","atomic","attached","attack","attempt","attention","audience","author","automobile","available","average","avoid","aware","away","baby","back","bad","badly","bag","balance","ball","balloon","band","bank","bar","bare","bark","barn","base","baseball","basic","basis","basket","bat","battle","be","bean","bear","beat","beautiful","beauty","became","because","become","becoming","bee","been","before","began","beginning","begun","behavior","behind","being","believed","bell","belong","below","belt","bend","beneath","bent","beside","best","bet","better","between","beyond","bicycle","bigger","biggest","bill","birds","birth","birthday","bit","bite","black","blank","blanket","blew","blind","block","blood","blow","blue","board","boat","body","bone","book","border","born","both","bottle","bottom","bound","bow","bowl","box","boy","brain","branch","brass","brave","bread","break","breakfast","breath","breathe","breathing","breeze","brick","bridge","brief","bright","bring","broad","broke","broken","brother","brought","brown","brush","buffalo","build","building","built","buried","burn","burst","bus","bush","business","busy","but","butter","buy","by","cabin","cage","cake","call","calm","came","camera","camp","can","canal","cannot","cap","capital","captain","captured","car","carbon","card","care","careful","carefully","carried","carry","case","cast","castle","cat","catch","cattle","caught","cause","cave","cell","cent","center","central","century","certain","certainly","chain","chair","chamber","chance","change","changing","chapter","character","characteristic","charge","chart","check","cheese","chemical","chest","chicken","chief","child","children","choice","choose","chose","chosen","church","circle","circus","citizen","city","class","classroom","claws","clay","clean","clear","clearly","climate","climb","clock","close","closely","closer","cloth","clothes","clothing","cloud","club","coach","coal","coast","coat","coffee","cold","collect","college","colony","color","column","combination","combine","come","comfortable","coming","command","common","community","company","compare","compass","complete","completely","complex","composed","composition","compound","concerned","condition","congress","connected","consider","consist","consonant","constantly","construction","contain","continent","continued","contrast","control","conversation","cook","cookies","cool","copper","copy","corn","corner","correct","correctly","cost","cotton","could","count","country","couple","courage","course","court","cover","cow","cowboy","crack","cream","create","creature","crew","crop","cross","crowd","cry","cup","curious","current","curve","customs","cut","cutting","daily","damage","dance","danger","dangerous","dark","darkness","date","daughter","dawn","day","dead","deal","dear","death","decide","declared","deep","deeply","deer","definition","degree","depend","depth","describe","desert","design","desk","detail","determine","develop","development","diagram","diameter","did","die","differ","difference","different","difficult","difficulty","dig","dinner","direct","direction","directly","dirt","dirty","disappear","discover","discovery","discuss","discussion","disease","dish","distance","distant","divide","division","do","doctor","does","dog","doing","doll","dollar","done","donkey","door","dot","double","doubt","down","dozen","draw","drawn","dream","dress","drew","dried","drink","drive","driven","driver","driving","drop","dropped","drove","dry","duck","due","dug","dull","during","dust","duty","each","eager","ear","earlier","early","earn","earth","easier","easily","east","easy","eat","eaten","edge","education","effect","effort","egg","eight","either","electric","electricity","element","elephant","eleven","else","empty","end","enemy","energy","engine","engineer","enjoy","enough","enter","entire","entirely","environment","equal","equally","equator","equipment","escape","especially","essential","establish","even","evening","event","eventually","ever","every","everybody","everyone","everything","everywhere","evidence","exact","exactly","examine","example","excellent","except","exchange","excited","excitement","exciting","exclaimed","exercise","exist","expect","experience","experiment","explain","explanation","explore","express","expression","extra","eye","face","facing","fact","factor","factory","failed","fair","fairly","fall","fallen","familiar","family","famous","far","farm","farmer","farther","fast","fastened","faster","fat","father","favorite","fear","feathers","feature","fed","feed","feel","feet","fell","fellow","felt","fence","few","fewer","field","fierce","fifteen","fifth","fifty","fight","fighting","figure","fill","film","final","finally","find","fine","finest","finger","finish","fire","fireplace","firm","first","fish","five","fix","flag","flame","flat","flew","flies","flight","floating","floor","flow","flower","fly","fog","folks","follow","food","foot","football","for","force","foreign","forest","forget","forgot","forgotten","form","former","fort","forth","forty","forward","fought","found","four","fourth","fox","frame","free","freedom","frequently","fresh","friend","friendly","frighten","frog","from","front","frozen","fruit","fuel","full","fully","fun","function","funny","fur","furniture","further","future","gain","game","garage","garden","gas","gasoline","gate","gather","gave","general","generally","gentle","gently","get","getting","giant","gift","girl","give","given","giving","glad","glass","globe","go","goes","gold","golden","gone","good","goose","got","government","grabbed","grade","gradually","grain","grandfather","grandmother","graph","grass","gravity","gray","great","greater","greatest","greatly","green","grew","ground","group","grow","grown","growth","guard","guess","guide","gulf","gun","habit","had","hair","half","halfway","hall","hand","handle","handsome","hang","happen","happened","happily","happy","harbor","hard","harder","hardly","has","hat","have","having","hay","he","headed","heading","health","heard","hearing","heart","heat","heavy","height","held","hello","help","helpful","her","herd","here","herself","hidden","hide","high","higher","highest","highway","hill","him","himself","his","history","hit","hold","hole","hollow","home","honor","hope","horn","horse","hospital","hot","hour","house","how","however","huge","human","hundred","hung","hungry","hunt","hunter","hurried","hurry","hurt","husband","ice","idea","identity","if","ill","image","imagine","immediately","importance","important","impossible","improve","in","inch","include","including","income","increase","indeed","independent","indicate","individual","industrial","industry","influence","information","inside","instance","instant","instead","instrument","interest","interior","into","introduced","invented","involved","iron","is","island","it","its","itself","jack","jar","jet","job","join","joined","journey","joy","judge","jump","jungle","just","keep","kept","key","kids","kill","kind","kitchen","knew","knife","know","knowledge","known","label","labor","lack","lady","laid","lake","lamp","land","language","large","larger","largest","last","late","later","laugh","law","lay","layers","lead","leader","leaf","learn","least","leather","leave","leaving","led","left","leg","length","lesson","let","letter","level","library","lie","life","lift","light","like","likely","limited","line","lion","lips","liquid","list","listen","little","live","living","load","local","locate","location","log","lonely","long","longer","look","loose","lose","loss","lost","lot","loud","love","lovely","low","lower","luck","lucky","lunch","lungs","lying","machine","machinery","mad","made","magic","magnet","mail","main","mainly","major","make","making","man","managed","manner","manufacturing","many","map","mark","market","married","mass","massage","master","material","mathematics","matter","may","maybe","me","meal","mean","means","meant","measure","meat","medicine","meet","melted","member","memory","men","mental","merely","met","metal","method","mice","middle","might","mighty","mile","military","milk","mill","mind","mine","minerals","minute","mirror","missing","mission","mistake","mix","mixture","model","modern","molecular","moment","money","monkey","month","mood","moon","more","morning","most","mostly","mother","motion","motor","mountain","mouse","mouth","move","movement","movie","moving","mud","muscle","music","musical","must","my","myself","mysterious","nails","name","nation","national","native","natural","naturally","nature","near","nearby","nearer","nearest","nearly","necessary","neck","needed","needle","needs","negative","neighbor","neighborhood","nervous","nest","never","new","news","newspaper","next","nice","night","nine","no","nobody","nodded","noise","none","noon","nor","north","nose","not","note","noted","nothing","notice","noun","now","number","numeral","nuts","object","observe","obtain","occasionally","occur","ocean","of","off","offer","office","officer","official","oil","old","older","oldest","on","once","one","only","onto","open","operation","opinion","opportunity","opposite","or","orange","orbit","order","ordinary","organization","organized","origin","original","other","ought","our","ourselves","out","outer","outline","outside","over","own","owner","oxygen","pack","package","page","paid","pain","paint","pair","palace","pale","pan","paper","paragraph","parallel","parent","park","part","particles","particular","particularly","partly","parts","party","pass","passage","past","path","pattern","pay","peace","pen","pencil","people","per","percent","perfect","perfectly","perhaps","period","person","personal","pet","phrase","physical","piano","pick","picture","pictured","pie","piece","pig","pile","pilot","pine","pink","pipe","pitch","place","plain","plan","plane","planet","planned","planning","plant","plastic","plate","plates","play","pleasant","please","pleasure","plenty","plural","plus","pocket","poem","poet","poetry","point","pole","police","policeman","political","pond","pony","pool","poor","popular","population","porch","port","position","positive","possible","possibly","post","pot","potatoes","pound","pour","powder","power","powerful","practical","practice","prepare","present","president","press","pressure","pretty","prevent","previous","price","pride","primitive","principal","principle","printed","private","prize","probably","problem","process","produce","product","production","program","progress","promised","proper","properly","property","protection","proud","prove","provide","public","pull","pupil","pure","purple","purpose","push","put","putting","quarter","queen","question","quick","quickly","quiet","quietly","quite","rabbit","race","radio","railroad","rain","raise","ran","ranch","range","rapidly","rate","rather","raw","rays","reach","read","reader","ready","real","realize","rear","reason","recall","receive","recent","recently","recognize","record","red","refer","refused","region","regular","related","relationship","religious","remain","remarkable","remember","remove","repeat","replace","replied","report","represent","require","research","respect","rest","result","return","review","rhyme","rhythm","rice","rich","ride","riding","right","ring","rise","rising","river","road","roar","rock","rocket","rocky","rod","roll","roof","room","root","rope","rose","rough","round","route","row","rubbed","rubber","rule","ruler","run","running","rush","sad","saddle","safe","safety","said","sail","sale","salmon","salt","same","sand","sang","sat","satellites","satisfied","save","saved","saw","say","scale","scared","scene","school","science","scientific","scientist","score","screen","sea","search","season","seat","second","secret","section","see","seed","seeing","seems","seen","seldom","select","selection","sell","send","sense","sent","sentence","separate","series","serious","serve","service","sets","setting","settle","settlers","seven","several","shade","shadow","shake","shaking","shall","shallow","shape","share","sharp","she","sheep","sheet","shelf","shells","shelter","shine","shinning","ship","shirt","shoe","shoot","shop","shore","short","shorter","shot","should","shoulder","shout","show","shown","shut","sick","sides","sight","sign","signal","silence","silent","silk","silly","silver","similar","simple","simplest","simply","since","sing","single","sink","sister","sit","sitting","situation","six","size","skill","skin","sky","slabs","slave","sleep","slept","slide","slight","slightly","slip","slipped","slope","slow","slowly","small","smaller","smallest","smell","smile","smoke","smooth","snake","snow","so","soap","social","society","soft","softly","soil","solar","sold","soldier","solid","solution","solve","some","somebody","somehow","someone","something","sometime","somewhere","son","song","soon","sort","sound","source","south","southern","space","speak","special","species","specific","speech","speed","spell","spend","spent","spider","spin","spirit","spite","split","spoken","sport","spread","spring","square","stage","stairs","stand","standard","star","stared","start","state","statement","station","stay","steady","steam","steel","steep","stems","step","stepped","stick","stiff","still","stock","stomach","stone","stood","stop","stopped","store","storm","story","stove","straight","strange","stranger","straw","stream","street","strength","stretch","strike","string","strip","strong","stronger","struck","structure","struggle","stuck","student","studied","studying","subject","substance","success","successful","such","sudden","suddenly","sugar","suggest","suit","sum","summer","sun","sunlight","supper","supply","support","suppose","sure","surface","surprise","surrounded","swam","sweet","swept","swim","swimming","swing","swung","syllable","symbol","system","table","tail","take","taken","tales","talk","tall","tank","tape","task","taste","taught","tax","tea","teach","teacher","team","tears","teeth","telephone","television","tell","temperature","ten","tent","term","terrible","test","than","thank","that","thee","them","themselves","then","theory","there","therefore","these","they","thick","thin","thing","think","third","thirty","this","those","thou","though","thought","thousand","thread","three","threw","throat","through","throughout","throw","thrown","thumb","thus","thy","tide","tie","tight","tightly","till","time","tin","tiny","tip","tired","title","to","tobacco","today","together","told","tomorrow","tone","tongue","tonight","too","took","tool","top","topic","torn","total","touch","toward","tower","town","toy","trace","track","trade","traffic","trail","train","transportation","trap","travel","treated","tree","triangle","tribe","trick","tried","trip","troops","tropical","trouble","truck","trunk","truth","try","tube","tune","turn","twelve","twenty","twice","two","type","typical","uncle","under","underline","understanding","unhappy","union","unit","universe","unknown","unless","until","unusual","up","upon","upper","upward","us","use","useful","using","usual","usually","valley","valuable","value","vapor","variety","various","vast","vegetable","verb","vertical","very","vessels","victory","view","village","visit","visitor","voice","volume","vote","vowel","voyage","wagon","wait","walk","wall","want","war","warm","warn","was","wash","waste","watch","water","wave","way","we","weak","wealth","wear","weather","week","weigh","weight","welcome","well","went","were","west","western","wet","whale","what","whatever","wheat","wheel","when","whenever","where","wherever","whether","which","while","whispered","whistle","white","who","whole","whom","whose","why","wide","widely","wife","wild","will","willing","win","wind","window","wing","winter","wire","wise","wish","with","within","without","wolf","women","won","wonder","wonderful","wood","wooden","wool","word","wore","work","worker","world","worried","worry","worse","worth","would","wrapped","write","writer","writing","written","wrong","wrote","yard","year","yellow","yes","yesterday","yet","you","young","younger","your","yourself","youth","zero","zebra","zipper","zoo","zulu"];function t(s){const i=s?.seed?new n(s.seed):null;function r(){return s&&s.maxLength>1?a():o()}function a(){for(var b=!1,x;!b;)x=o(),x.length<=s.maxLength&&(b=!0);return x}function o(){return e[l(e.length)]}function l(b){const x=i?i():Math.random();return Math.floor(x*b)}if(typeof s>"u")return r();typeof s=="number"&&(s={exactly:s}),s.exactly&&(s.min=s.exactly,s.max=s.exactly),typeof s.wordsPerString!="number"&&(s.wordsPerString=1),typeof s.formatter!="function"&&(s.formatter=b=>b),typeof s.separator!="string"&&(s.separator=" ");for(var u=s.min+l(s.max+1-s.min),d=[],h="",f=0,C=0;C<u*s.wordsPerString;C++)f===s.wordsPerString-1?h+=s.formatter(r(),f):h+=s.formatter(r(),f)+s.separator,f++,(C+1)%s.wordsPerString===0&&(d.push(h),h="",f=0);return typeof s.join=="string"&&(d=d.join(s.join)),d}return Nl=t,t.wordList=e,Nl}var h0=u0();const d0=Ol(h0);var c0=Tf();const p0=Ol(c0);var g0="8.2.2";class qa{constructor(e,t){this.dependencies=e,this.extensionsConfiguration=t,this.extensions=Object.fromEntries(t.map(s=>[qa.getExtensionNameByClass(s.type),this.dependencies.instantiateExtension(s.type)]))}static getExtensionNameByClass(e){return e.info.name}getExtensionInstanceByClass(e){return this.extensions[qa.getExtensionNameByClass(e)]}async initializeExtensions(){await Promise.all(this.extensionsConfiguration.map(({type:e,params:t={}})=>{this.getExtensionInstanceByClass(e).initialize(t);const s=e.info;!("version"in s)&&!("data"in s)?console.warn(s.name,"is missing the 'version' and 'data' fields. Please update extension as 'version' and 'data' will be required in v9. See https://www.jspsych.org/latest/developers/extension-development/ for more details."):"version"in s?"data"in s||console.warn(s.name,"is missing the 'data' field. Please update extension as 'data' will be required in v9. See https://www.jspsych.org/latest/developers/extension-development/ for more details."):console.warn(s.name,"is missing the 'version' field. Please update extension as 'version' will be required in v9. See https://www.jspsych.org/latest/developers/extension-development/ for more details.")}))}onStart(e=[]){for(const{type:t,params:s}of e)this.getExtensionInstanceByClass(t)?.on_start(s)}onLoad(e=[]){for(const{type:t,params:s}of e)this.getExtensionInstanceByClass(t)?.on_load(s)}async onFinish(e=[]){const t=await Promise.all(e.map(({type:i,params:r})=>Promise.resolve(this.getExtensionInstanceByClass(i)?.on_finish(r)))),s=e.length?{extension_type:e.map(({type:i})=>i.info.name),extension_version:e.map(({type:i})=>i.info.version)}:{};return t.unshift(s),Object.assign({},...t)}}function Ba(n){return[...new Set(n)]}function Es(n){if(!n)return n;let e;if(Array.isArray(n)){e=[];for(const t of n)e.push(Es(t));return e}else if(typeof n=="object"&&n!==null){e={};for(const t in n)n.hasOwnProperty(t)&&(e[t]=Es(n[t]));return e}else return n}function Fa(n,e){let t={};for(const s in n)n.hasOwnProperty(s)&&(typeof n[s]=="object"&&e.hasOwnProperty(s)?t[s]=Fa(n[s],e[s]):t[s]=n[s]);for(const s in e)e.hasOwnProperty(s)&&(t.hasOwnProperty(s)&&typeof e[s]=="object"?t[s]=Fa(t[s],e[s]):t[s]=e[s]);return t}var m0=Object.freeze({__proto__:null,deepCopy:Es,deepMerge:Fa,unique:Ba});class ql{constructor(e=[]){this.values=e}sum(){let e=0;for(const t of this.values)e+=t;return e}mean(){let e=0,t=0;for(const s of this.values)typeof s<"u"&&s!==null&&(e+=s,t++);if(t!==0)return e/t}median(){if(this.values.length===0)return;const e=this.values.slice(0).sort(function(i,r){return i-r}),t=Math.floor(e.length/2);return e.length%2===0?(e[t]+e[t-1])/2:e[t]}min(){return Math.min.apply(null,this.values)}max(){return Math.max.apply(null,this.values)}count(){return this.values.length}variance(){const e=this.mean();let t=0;for(const i of this.values)t+=Math.pow(i-e,2);return t/(this.values.length-1)}sd(){const e=this.variance();return Math.sqrt(e)}frequencies(){const e={};for(const t of this.values)typeof e[t]>"u"?e[t]=1:e[t]++;return e}all(e){for(const t of this.values)if(!e(t))return!1;return!0}subset(e){const t=[];for(const s of this.values)e(s)&&t.push(s);return new ql(t)}}function f0(n,e){const t=new Blob([n],{type:"text/plain"});let s="";typeof window.webkitURL<"u"?s=window.webkitURL.createObjectURL(t):s=window.URL.createObjectURL(t);const i=document.createElement("a");i.id="jspsych-download-as-text-link",i.style.display="none",i.download=e,i.href=s,i.click()}function y0(n){const e=typeof n!="object"?JSON.parse(n):n;let t="",s="";const i=[];for(const r of e)for(const a in r){let o=a+"";o='"'+o.replace(/"/g,'""')+'",',i.includes(a)||(i.push(a),t+=o)}t=t.slice(0,-1),s+=t+`\r
`;for(const r of e){t="";for(const a of i){let o=typeof r[a]>"u"?"":r[a];typeof o=="object"&&(o=JSON.stringify(o));const l=o+"";t+='"'+l.replace(/"/g,'""')+'",'}t=t.slice(0,-1),s+=t+`\r
`}return s}function v0(){const n=window.location.search.substr(1).split("&"),e={};for(let t=0;t<n.length;++t){const s=n[t].split("=",2);s.length==1?e[s[0]]="":e[s[0]]=decodeURIComponent(s[1].replace(/\+/g," "))}return e}class $t{constructor(e=[]){this.trials=e}push(e){return this.trials.push(e),this}join(e){return this.trials=this.trials.concat(e.values()),this}top(){return this.trials.length<=1?this:new $t([this.trials[this.trials.length-1]])}first(e=1){if(e<1)throw`You must query with a positive nonzero integer. Please use a
               different value for n.`;return this.trials.length===0?new $t:(e>this.trials.length&&(e=this.trials.length),new $t(this.trials.slice(0,e)))}last(e=1){if(e<1)throw`You must query with a positive nonzero integer. Please use a
               different value for n.`;return this.trials.length===0?new $t:(e>this.trials.length&&(e=this.trials.length),new $t(this.trials.slice(this.trials.length-e,this.trials.length)))}values(){return this.trials}count(){return this.trials.length}readOnly(){return new $t(Es(this.trials))}addToAll(e){for(const t of this.trials)Object.assign(t,e);return this}addToLast(e){return this.trials.length>0&&Object.assign(this.trials[this.trials.length-1],e),this}filter(e){let t;Array.isArray(e)?t=Es(e):t=Es([e]);const s=[];for(const i of this.trials){let r=!1;for(const a of t){let o=!0;for(const l of Object.keys(a))typeof i[l]<"u"&&i[l]===a[l]||(o=!1);if(o){r=!0;break}}r&&s.push(i)}return new $t(s)}filterCustom(e){return new $t(this.trials.filter(e))}filterColumns(e){return new $t(this.trials.map(t=>Object.fromEntries(e.filter(s=>s in t).map(s=>[s,t[s]]))))}select(e){const t=[];for(const s of this.trials)typeof s[e]<"u"&&t.push(s[e]);return new ql(t)}ignore(e){Array.isArray(e)||(e=[e]);const t=Es(this.trials);for(const s of t)for(const i of e)delete s[i];return new $t(t)}uniqueNames(){const e=[];for(const t of this.trials)for(const s of Object.keys(t))e.includes(s)||e.push(s);return e}csv(){return y0(this.trials)}json(e=!1){return e?JSON.stringify(this.trials,null,"	"):JSON.stringify(this.trials)}localSave(e,t){e=e.toLowerCase();let s;if(e==="json")s=this.json();else if(e==="csv")s=this.csv();else throw new Error('Invalid format specified for localSave. Must be "json" or "csv".');f0(s,t)}}class C0{constructor(e){this.dependencies=e,this.dataProperties={},this.interactionListeners={blur:()=>{this.addInteractionRecord("blur")},focus:()=>{this.addInteractionRecord("focus")},fullscreenchange:()=>{this.addInteractionRecord(document.isFullScreen||document.webkitIsFullScreen||document.mozIsFullScreen||document.fullscreenElement?"fullscreenenter":"fullscreenexit")}},this.reset()}reset(){this.results=new $t,this.resultToTrialMap=new WeakMap,this.interactionRecords=new $t}get(){return this.results}getInteractionData(){return this.interactionRecords}write(e){const t=e.getResult();Object.assign(t,this.dataProperties),this.results.push(t),this.resultToTrialMap.set(t,e)}addProperties(e){this.results.addToAll(e),this.dataProperties=Object.assign({},this.dataProperties,e)}addDataToLastTrial(e){this.results.addToLast(e)}getLastTrialData(){return this.results.top()}getLastTimelineData(){const e=this.getLastTrialData().values()[0];return new $t(e?this.resultToTrialMap.get(e).parent.getResults():[])}displayData(e="json"){e=e.toLowerCase(),e!=="json"&&e!=="csv"&&(console.log("Invalid format declared for displayData function. Using json as default."),e="json");const t=document.createElement("pre");t.id="jspsych-data-display",t.textContent=e==="json"?this.results.json(!0):this.results.csv(),this.dependencies.getDisplayElement().replaceChildren(t)}urlVariables(){return typeof this.query_string>"u"&&(this.query_string=v0()),this.query_string}getURLVariable(e){return this.urlVariables()[e]}addInteractionRecord(e){const t={event:e,...this.dependencies.getProgress()};this.interactionRecords.push(t),this.dependencies.onInteractionRecordAdded(t)}createInteractionListeners(){window.addEventListener("blur",this.interactionListeners.blur),window.addEventListener("focus",this.interactionListeners.focus),document.addEventListener("fullscreenchange",this.interactionListeners.fullscreenchange),document.addEventListener("mozfullscreenchange",this.interactionListeners.fullscreenchange),document.addEventListener("webkitfullscreenchange",this.interactionListeners.fullscreenchange)}removeInteractionListeners(){window.removeEventListener("blur",this.interactionListeners.blur),window.removeEventListener("focus",this.interactionListeners.focus),document.removeEventListener("fullscreenchange",this.interactionListeners.fullscreenchange),document.removeEventListener("mozfullscreenchange",this.interactionListeners.fullscreenchange),document.removeEventListener("webkitfullscreenchange",this.interactionListeners.fullscreenchange)}}class b0{constructor(e,t=!1,s=0){this.getRootElement=e,this.areResponsesCaseSensitive=t,this.minimumValidRt=s,this.listeners=new Set,this.heldKeys=new Set,this.areRootListenersRegistered=!1,zi(this),this.registerRootListeners()}registerRootListeners(){if(!this.areRootListenersRegistered){const e=this.getRootElement();e&&(e.addEventListener("keydown",this.rootKeydownListener),e.addEventListener("keyup",this.rootKeyupListener),this.areRootListenersRegistered=!0)}}rootKeydownListener(e){for(const t of[...this.listeners])t(e);this.heldKeys.add(this.toLowerCaseIfInsensitive(e.key))}toLowerCaseIfInsensitive(e){return this.areResponsesCaseSensitive?e:e.toLowerCase()}rootKeyupListener(e){this.heldKeys.delete(this.toLowerCaseIfInsensitive(e.key))}isResponseValid(e,t,s){return!t&&this.heldKeys.has(s)?!1:e==="ALL_KEYS"?!0:e==="NO_KEYS"?!1:e.includes(s)}getKeyboardResponse({callback_function:e,valid_responses:t="ALL_KEYS",rt_method:s="performance",persist:i,audio_context:r,audio_context_start_time:a,allow_held_key:o=!1,minimum_valid_rt:l=this.minimumValidRt}){s!=="performance"&&s!=="audio"&&(console.log('Invalid RT method specified in getKeyboardResponse. Defaulting to "performance" method.'),s="performance");const d=s==="performance"?performance.now():a*1e3;this.registerRootListeners(),!this.areResponsesCaseSensitive&&typeof t!="string"&&(t=t.map(f=>f.toLowerCase()));const h=f=>{const C=Math.round((s=="performance"?performance.now():r.currentTime*1e3)-d);if(C<l)return;const b=this.toLowerCaseIfInsensitive(f.key);this.isResponseValid(t,o,b)&&(f.preventDefault(),i||this.cancelKeyboardResponse(h),e({key:f.key,rt:C}))};return this.listeners.add(h),h}cancelKeyboardResponse(e){this.listeners.delete(e)}cancelAllKeyboardResponses(){this.listeners.clear()}compareKeys(e,t){if(typeof e!="string"&&e!==null||typeof t!="string"&&t!==null){console.error("Error in jsPsych.pluginAPI.compareKeys: arguments must be key strings or null.");return}return typeof e=="string"&&typeof t=="string"?this.areResponsesCaseSensitive?e===t:e.toLowerCase()===t.toLowerCase():e===null&&t===null}}var m=(n=>(n[n.BOOL=0]="BOOL",n[n.STRING=1]="STRING",n[n.INT=2]="INT",n[n.FLOAT=3]="FLOAT",n[n.FUNCTION=4]="FUNCTION",n[n.KEY=5]="KEY",n[n.KEYS=6]="KEYS",n[n.SELECT=7]="SELECT",n[n.HTML_STRING=8]="HTML_STRING",n[n.IMAGE=9]="IMAGE",n[n.AUDIO=10]="AUDIO",n[n.VIDEO=11]="VIDEO",n[n.OBJECT=12]="OBJECT",n[n.COMPLEX=13]="COMPLEX",n[n.TIMELINE=14]="TIMELINE",n))(m||{});class Qa{constructor(e,t={useWebAudio:!1}){this.src=e,this.useWebAudio=t.useWebAudio,this.audioContext=t.audioContext||null}async load(){this.useWebAudio?this.webAudioBuffer=await this.preloadWebAudio(this.src):this.audio=await this.preloadHTMLAudio(this.src)}play(){this.audio instanceof HTMLAudioElement?this.audio.play():(this.audio||(this.audio=this.getAudioSourceNode(this.webAudioBuffer)),this.audio.start())}stop(){this.audio instanceof HTMLAudioElement?(this.audio.pause(),this.audio.currentTime=0):(this.audio.stop(),this.audio=this.getAudioSourceNode(this.webAudioBuffer))}addEventListener(e,t){!this.audio&&this.webAudioBuffer&&(this.audio=this.getAudioSourceNode(this.webAudioBuffer)),this.audio.addEventListener(e,t)}removeEventListener(e,t){!this.audio&&this.webAudioBuffer&&(this.audio=this.getAudioSourceNode(this.webAudioBuffer)),this.audio.removeEventListener(e,t)}getAudioSourceNode(e){const t=this.audioContext.createBufferSource();return t.buffer=e,t.connect(this.audioContext.destination),t}async preloadWebAudio(e){const s=await(await fetch(e)).arrayBuffer(),i=await this.audioContext.decodeAudioData(s),r=this.audioContext.createBufferSource();return r.buffer=i,r.connect(this.audioContext.destination),i}async preloadHTMLAudio(e){return new Promise((t,s)=>{const i=new Audio(e);i.addEventListener("canplaythrough",()=>{t(i)}),i.addEventListener("error",r=>{s(r)}),i.addEventListener("abort",r=>{s(r)})})}}const Nf=[m.AUDIO,m.IMAGE,m.VIDEO];class w0{constructor(e){this.useWebaudio=e,this.video_buffers={},this.context=null,this.audio_buffers=[],this.preload_requests=[],this.img_cache={},this.preloadMap=new Map,this.microphone_recorder=null,this.camera_stream=null,this.camera_recorder=null,this.useWebaudio&&typeof window<"u"&&typeof window.AudioContext<"u"&&(this.context=new AudioContext)}getVideoBuffer(e){return e.startsWith("blob:")&&(this.video_buffers[e]=e),this.video_buffers[e]}audioContext(){return this.context&&this.context.state!=="running"&&this.context.resume(),this.context}async getAudioPlayer(e){return this.audio_buffers[e]instanceof Qa?this.audio_buffers[e]:(this.audio_buffers[e]=new Qa(e,{useWebAudio:this.useWebaudio,audioContext:this.context}),await this.audio_buffers[e].load(),this.audio_buffers[e])}preloadAudio(e,t=()=>{},s=r=>{},i=r=>{}){e=Ba(e.flat());let r=0;if(e.length==0){t();return}for(const a of e)this.audio_buffers[a]instanceof Qa?(r++,s(a),r==e.length&&t()):(this.audio_buffers[a]=new Qa(a,{useWebAudio:this.useWebaudio,audioContext:this.context}),this.audio_buffers[a].load().then(()=>{r++,s(a),r==e.length&&t()}).catch(o=>{i(o)}))}preloadImages(e,t=()=>{},s=r=>{},i=r=>{}){e=Ba(e.flat());var r=0;if(e.length===0){t();return}for(let a=0;a<e.length;a++){const o=new Image,l=e[a];o.onload=()=>{r++,s(l),r===e.length&&t()},o.onerror=u=>{i({source:l,error:u})},o.src=l,this.img_cache[l]=o,this.preload_requests.push(o)}}preloadVideo(e,t=()=>{},s=r=>{},i=r=>{}){e=Ba(e.flat());let r=0;if(e.length===0){t();return}for(const a of e){const o=this.video_buffers,l=new XMLHttpRequest;l.open("GET",a,!0),l.responseType="blob",l.onload=()=>{if(l.status===200||l.status===0){const u=l.response;o[a]=URL.createObjectURL(u),r++,s(a),r===e.length&&t()}},l.onerror=u=>{let d=u;l.status==404&&(d="404"),i({source:a,error:d})},l.onloadend=u=>{l.status==404&&i({source:a,error:"404"})},l.send(),this.preload_requests.push(l)}}getAutoPreloadList(e){const t=Object.fromEntries(Nf.map(i=>[i,new Set])),s=(i,r)=>{if(typeof i.timeline<"u")for(const o of i.timeline)s(o,i.type??r);else if((i.type??r)?.info){const{name:o,parameters:l}=(i.type??r).info;this.preloadMap.has(o)||this.preloadMap.set(o,Object.fromEntries(Object.entries(l).filter(([u,{type:d,preload:h}])=>Nf.includes(d)&&(h??!0)).map(([u,{type:d}])=>[u,d])));for(const[u,d]of Object.entries(this.preloadMap.get(o))){const h=i[u],f=t[d];if(typeof h=="string")f.add(h);else if(Array.isArray(h))for(const C of h.flat())typeof C=="string"&&f.add(C)}}};return s({timeline:e}),{images:[...t[m.IMAGE]],audio:[...t[m.AUDIO]],video:[...t[m.VIDEO]]}}cancelPreloads(){for(const e of this.preload_requests)e.onload=()=>{},e.onerror=()=>{},e.oncanplaythrough=()=>{},e.onabort=()=>{};this.preload_requests=[]}initializeMicrophoneRecorder(e){const t=new MediaRecorder(e);this.microphone_recorder=t}getMicrophoneRecorder(){return this.microphone_recorder}initializeCameraRecorder(e,t){let s=this.getCompatibleMimeType()||"video/webm";const i={...t,mimeType:s};this.camera_stream=e;const r=new MediaRecorder(e,i);this.camera_recorder=r}getCompatibleMimeType(){const e=["video/webm;codecs=vp9,opus","video/webm;codecs=vp8,opus","video/mp4;codecs=avc1.42E01E,mp4a.40.2","video/mp4;codecs=h264,aac","video/mp4;codecs=hevc,aac"];for(const t of e)if(MediaRecorder.isTypeSupported(t))return t;return null}getCameraStream(){return this.camera_stream}getCameraRecorder(){return this.camera_recorder}}class x0{constructor(e,t){this.getDisplayContainerElement=e,this.setJsPsychTimeout=t}dispatchEvent(e){this.getDisplayContainerElement().dispatchEvent(e)}keyDown(e){this.dispatchEvent(new KeyboardEvent("keydown",{key:e}))}keyUp(e){this.dispatchEvent(new KeyboardEvent("keyup",{key:e}))}pressKey(e,t=0){t>0?this.setJsPsychTimeout(()=>{this.keyDown(e),this.keyUp(e)},t):(this.keyDown(e),this.keyUp(e))}clickTarget(e,t=0){t>0?this.setJsPsychTimeout(()=>{e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0})),e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0})),e.dispatchEvent(new MouseEvent("click",{bubbles:!0}))},t):(e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0})),e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0})),e.dispatchEvent(new MouseEvent("click",{bubbles:!0})))}fillTextInput(e,t,s=0){s>0?this.setJsPsychTimeout(()=>{e.value=t},s):e.value=t}getValidKey(e){const t=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"," "];let s;if(e=="NO_KEYS")s=null;else if(e=="ALL_KEYS")s=t[Math.floor(Math.random()*t.length)];else{const i=e.flat();s=i[Math.floor(Math.random()*i.length)]}return s}mergeSimulationData(e,t){return{...e,...t?.data}}ensureSimulationDataConsistency(e,t){if(t.rt&&(t.rt=Math.round(t.rt)),e.trial_duration&&t.rt&&t.rt>e.trial_duration&&(t.rt=null,t.response&&(t.response=null),t.correct&&(t.correct=!1)),e.choices&&e.choices=="NO_KEYS"&&(t.rt&&(t.rt=null),t.response&&(t.response=null)),e.allow_response_before_complete&&e.sequence_reps&&e.frame_time){const s=e.sequence_reps*e.frame_time*e.stimuli.length;t.rt<s&&(t.rt=null,t.response=null)}}}class V0{constructor(){this.timeout_handlers=[]}setTimeout(e,t){const s=window.setTimeout(e,t);return this.timeout_handlers.push(s),s}clearAllTimeouts(){for(const e of this.timeout_handlers)clearTimeout(e);this.timeout_handlers=[]}}function P0(n){const e=n.getInitSettings(),t=new b0(n.getDisplayContainerElement,e.case_sensitive_responses,e.minimum_valid_rt),s=new V0,i=new w0(e.use_webaudio),r=new x0(n.getDisplayContainerElement,s.setTimeout.bind(s));return Object.assign({},...[t,s,i,r].map(a=>zi(a)))}function S0(n=Math.random().toString()){return Math.random=p0(n),n}function Bl(n,e,t=!1){const s=Array.isArray(n),i=Array.isArray(e);if(!s)i?(e=[e[0]],console.log("Unclear parameters given to randomization.repeat. Multiple set sizes specified, but only one item exists to sample. Proceeding using the first set size.")):(n=[n],e=[e]);else if(i){if(n.length!=e.length)if(console.warn("Unclear parameters given to randomization.repeat. Items and repetitions are unequal lengths. Behavior may not be as expected."),e.length<n.length){let o=[];for(let l=0;l<n.length;l++)o.push(e);e=o}else e=e.slice(0,n.length)}else{let o=[];for(let l=0;l<n.length;l++)o.push(e);e=o}let r=[];for(let o=0;o<n.length;o++)for(let l=0;l<e[o];l++)n[o]==null||typeof n[o]!="object"?r.push(n[o]):r.push(Object.assign({},n[o]));let a=Vi(r);return t&&(a=O0(a)),a}function Vi(n){Array.isArray(n)||console.error("Argument to shuffle() must be an array.");const e=n.slice(0);let t=e.length,s,i;for(;t;)i=Math.floor(Math.random()*t--),s=e[t],e[t]=e[i],e[i]=s;return e}function I0(n,e){Array.isArray(n)||console.error("First argument to shuffleNoRepeats() must be an array."),typeof e<"u"&&typeof e!="function"&&console.error("Second argument to shuffleNoRepeats() must be a function."),typeof e>"u"&&(e=function(s,i){return s===i});const t=Vi(n);for(let s=0;s<t.length-1;s++)if(e(t[s],t[s+1])){let i=Math.floor(Math.random()*(t.length-2))+1;for(;e(t[s+1],t[i])||e(t[s+1],t[i+1])||e(t[s+1],t[i-1])||e(t[s],t[i]);)i=Math.floor(Math.random()*(t.length-2))+1;const r=t[i];t[i]=t[s+1],t[s+1]=r}return t}function qf(n,e=!1){const t=n.length;if(t==1)return console.warn("shuffleAlternateGroups() was called with only one group. Defaulting to simple shuffle."),Vi(n[0]);let s=[];for(let o=0;o<t;o++)s.push(o);e&&(s=Vi(s));const i=[];let r=null;for(let o=0;o<t;o++)r=r===null?n[o].length:Math.min(r,n[o].length),i.push(Vi(n[o]));const a=[];for(let o=0;o<r;o++)for(let l=0;l<s.length;l++)a.push(i[s[l]][o]);return a}function Bf(n,e){return Array.isArray(n)||console.error("First argument to sampleWithoutReplacement() must be an array"),e>n.length&&console.error("Cannot take a sample larger than the size of the set of items to sample."),Vi(n).slice(0,e)}function Ff(n,e,t){Array.isArray(n)||console.error("First argument to sampleWithReplacement() must be an array");const s=[];if(typeof t<"u"){t.length!==n.length&&console.error("The length of the weights array must equal the length of the array to be sampled from.");let a=0;for(const o of t)a+=o;for(const o of t)s.push(o/a)}else for(let a=0;a<n.length;a++)s.push(1/n.length);const i=[s[0]];for(let a=1;a<s.length;a++)i.push(s[a]+i[a-1]);const r=[];for(let a=0;a<e;a++){const o=Math.random();let l=0;for(;o>i[l];)l++;r.push(n[l])}return r}function T0(n,e=1,t=!1){let s=[{}];for(const[i,r]of Object.entries(n)){const a=[];for(const o of r)for(const l of s)a.push({...l,[i]:o});s=a}return Bl(s,e,t)}function E0(n=32){let e="";const t="0123456789abcdefghjklmnopqrstuvwxyz";for(let s=0;s<n;s++)e+=t[Math.floor(Math.random()*t.length)];return e}function R0(n,e){if(e<n)throw new Error("Upper boundary must be greater than or equal to lower boundary");return n+Math.floor(Math.random()*(e-n+1))}function _0(n){return Math.random()<=n?1:0}function Fl(n,e){return D0()*e+n}function Ql(n){return-Math.log(Math.random())/n}function L0(n,e,t,s=!1){let i=Fl(n,e)+Ql(t);if(s)for(;i<=0;)i=Fl(n,e)+Ql(t);return i}function A0(n){return d0(n)}function D0(){for(var n=0,e=0;n===0;)n=Math.random();for(;e===0;)e=Math.random();return Math.sqrt(-2*Math.log(n))*Math.cos(2*Math.PI*e)}function O0(n){const e={};for(const t of n)for(const s of Object.keys(t))typeof e[s]>"u"&&(e[s]=[]),e[s].push(t[s]);return e}var M0=Object.freeze({__proto__:null,factorial:T0,randomID:E0,randomInt:R0,randomWords:A0,repeat:Bl,sampleBernoulli:_0,sampleExGaussian:L0,sampleExponential:Ql,sampleNormal:Fl,sampleWithReplacement:Ff,sampleWithoutReplacement:Bf,setSeed:S0,shuffle:Vi,shuffleAlternateGroups:qf,shuffleNoRepeats:I0});function Qf(){const n={previewMode:!1,outsideTurk:!1,hitId:"INVALID_URL_PARAMETER",assignmentId:"INVALID_URL_PARAMETER",workerId:"INVALID_URL_PARAMETER",turkSubmitTo:"INVALID_URL_PARAMETER"},e=function(i,r){r=r.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");const a="[\\?&]"+r+"=([^&#]*)",l=new RegExp(a).exec(i);return l==null?"":l[1]},t=e(window.location.href,"assignmentId")?window.location.href:document.referrer;return["assignmentId","hitId","workerId","turkSubmitTo"].map(function(i){n[i]=unescape(e(t,i))}),n.previewMode=n.assignmentId=="ASSIGNMENT_ID_NOT_AVAILABLE",n.outsideTurk=!n.previewMode&&n.hitId===""&&n.assignmentId==""&&n.workerId=="",n}function k0(n){const e=Qf(),t=e.assignmentId,s=e.turkSubmitTo;if(!t||!s)return;const i=document.createElement("form");i.method="POST",i.action=s+"/mturk/externalSubmit?assignmentId="+t;for(const r in n)if(n.hasOwnProperty(r)){const a=document.createElement("input");a.type="hidden",a.name=r,a.id=r,a.value=n[r],i.appendChild(a)}document.body.appendChild(i),i.submit()}var N0=Object.freeze({__proto__:null,submitToTurk:k0,turkInfo:Qf});class q0{constructor(e,t){this.containerElement=e,this.message=t,this._progress=0,this.setupElements()}setupElements(){this.messageSpan=document.createElement("span"),this.innerDiv=document.createElement("div"),this.innerDiv.id="jspsych-progressbar-inner",this.update();const e=document.createElement("div");e.id="jspsych-progressbar-outer",e.appendChild(this.innerDiv),this.containerElement.appendChild(this.messageSpan),this.containerElement.appendChild(e)}update(){this.innerDiv.style.width=this._progress*100+"%",typeof this.message=="function"?this.messageSpan.innerHTML=this.message(this._progress):this.messageSpan.innerHTML=this.message}set progress(e){if(typeof e!="number"||e<0||e>1)throw new Error("jsPsych.progressBar.progress must be a number between 0 and 1");this._progress=e,this.update()}get progress(){return this._progress}}class Hl{constructor(e){this.name=e}}const B0=["timeline","timeline_variables","name","repetitions","loop_function","conditional_function","randomize_order","sample","on_timeline_start","on_timeline_finish"];function F0(n){return!zl(n)}function zl(n){return!!n.timeline||Array.isArray(n)}var jt=(n=>(n[n.PENDING=0]="PENDING",n[n.RUNNING=1]="RUNNING",n[n.PAUSED=2]="PAUSED",n[n.COMPLETED=3]="COMPLETED",n[n.ABORTED=4]="ABORTED",n))(jt||{});class Hf{constructor(){this.reset()}reset(){this.promise=new Promise(e=>{this.resolvePromise=e})}get(){return this.promise}resolve(e){this.resolvePromise(e),this.reset()}}function Q0(n){return n&&typeof n.then=="function"}function H0(n){return new Promise(e=>setTimeout(e,n))}function zf([n,...e]){let t=n??"";for(const s of e)t+=Number.isNaN(Number.parseInt(s))?`.${s}`:`[${s}]`;return t}function z0(n){return typeof n=="object"&&n!==null}class jl{constructor(){this.cache=new Map}static lookupChild(e,t){let s=!1,i;return Number.isNaN(Number.parseInt(t))?Object.hasOwn(e,t)&&(s=!0,i=e[t]):Number.parseInt(t)<e.length&&(s=!0,i=e[t]),{doesPathExist:s,value:i}}get(e){return this.cache.get(e.join("."))}has(e){return this.cache.has(e.join("."))}initialize(e){this.rootObject=e,this.cache.set("",e)}reset(){this.cache.clear(),this.cache.set("",this.rootObject)}set(e,t){this.cache.set(e.join("."),t)}lookup(e){if(this.has(e))return{doesPathExist:!0,value:this.get(e)};const t=s=>{const i=s.slice(0,-1),r=s[s.length-1];if(!this.has(i)&&i.length>0&&!t(i).doesPathExist)return{doesPathExist:!1};const a=this.get(i);if(!z0(a))return{doesPathExist:!1};const o=jl.lookupChild(a,r);return o.doesPathExist&&this.set(s,o.value),o};return t(e)}}class jf{constructor(e){this.dependencies=e,this.status=jt.PENDING,this.parameterValueCache=new jl}getStatus(){return this.status}initializeParameterValueCache(){this.parameterValueCache.initialize(this.description)}resetParameterValueCache(){this.parameterValueCache.reset(),this.parent?.resetParameterValueCache()}getParameterValue(e,t={}){const{evaluateFunctions:s=!0,recursive:i=!0,cacheResult:r=!0,replaceResult:a}=t;typeof e=="string"&&(e=[e]);let{doesPathExist:o,value:l}=this.parameterValueCache.lookup(e);return!o&&i&&this.parent&&(l=this.parent.getParameterValue(e,t)),typeof l=="function"&&s&&(l=l()),l instanceof Hl&&(l=this.evaluateTimelineVariable(l)),typeof a=="function"&&(l=a(l)),r&&this.parameterValueCache.set(e,l),l}getDataParameter(){const e=this.getParameterValue("data",{recursive:!1});return{...Object.fromEntries(typeof e=="object"?Object.keys(e).map(t=>[t,this.getParameterValue(["data",t])]):[]),...this.parent?.getDataParameter()}}}class Ha extends jf{constructor(e,t,s){if(super(e),this.description=t,this.parent=s,this.onLoad=()=>{this.runParameterCallback("on_load"),this.dependencies.runOnLoadExtensionCallbacks(this.getParameterValue("extensions"))},this.initializeParameterValueCache(),this.trialObject=Es(t),this.pluginClass=this.getParameterValue("type",{evaluateFunctions:!1}),this.pluginInfo=this.pluginClass?.info,!this.pluginInfo)throw new Error("Plugin not recognized. Please provide a valid plugin using the 'type' parameter.");!("version"in this.pluginInfo)&&!("data"in this.pluginInfo)?console.warn(this.pluginInfo.name,"is missing the 'version' and 'data' fields. Please update plugin as 'version' and 'data' will be required in v9. See https://www.jspsych.org/latest/developers/plugin-development/ for more details."):"version"in this.pluginInfo?"data"in this.pluginInfo||console.warn(this.pluginInfo.name,"is missing the 'data' field. Please update plugin as 'data' will be required in v9. See https://www.jspsych.org/latest/developers/plugin-development/ for more details."):console.warn(this.pluginInfo.name,"is missing the 'version' field. Please update plugin as 'version' will be required in v9. See https://www.jspsych.org/latest/developers/plugin-development/ for more details.")}async run(){this.status=jt.RUNNING,this.processParameters(),this.onStart(),this.addCssClasses(),this.pluginInstance=this.dependencies.instantiatePlugin(this.pluginClass),this.result=this.processResult(await this.executeTrial()),this.dependencies.onTrialResultAvailable(this),this.status=jt.COMPLETED,await this.onFinish(),this.removeCssClasses();const e=this.getParameterValue("post_trial_gap")??this.dependencies.getDefaultIti();e!==0&&this.dependencies.getSimulationMode()!=="data-only"&&await H0(e),this.resetParameterValueCache()}async executeTrial(){const e=this.dependencies.finishTrialPromise.get();let t=!1;e.then(()=>{t=!0});const{trialReturnValue:s,hasTrialBeenSimulated:i}=this.invokeTrialMethod();let r;return Q0(s)?(r=await Promise.race([s,e]),t&&(r=await e)):(i||this.onLoad(),r=await e),this.cleanupTrial(),r}invokeTrialMethod(){const e=this.dependencies.getSimulationMode();if(e&&typeof this.pluginInstance.simulate=="function"){const t=this.getSimulationOptions();if(t.simulate!==!1)return{hasTrialBeenSimulated:!0,trialReturnValue:this.pluginInstance.simulate(this.trialObject,t.mode??e,t,this.onLoad)}}return{hasTrialBeenSimulated:!1,trialReturnValue:this.pluginInstance.trial(this.dependencies.getDisplayElement(),this.trialObject,this.onLoad)}}cleanupTrial(){this.dependencies.clearAllTimeouts(),this.dependencies.getDisplayElement().innerHTML=""}addCssClasses(){const e=this.getParameterValue("css_classes"),t=this.dependencies.getDisplayElement().classList;typeof e=="string"?t.add(e):Array.isArray(e)&&t.add(...e)}removeCssClasses(){const e=this.getParameterValue("css_classes");e&&this.dependencies.getDisplayElement().classList.remove(...typeof e=="string"?[e]:e)}processResult(e){e||(e={});for(const[s,i]of Object.entries(this.getParameterValue("save_trial_parameters")??{}))if(this.pluginInfo.parameters[s])if(i&&!Object.hasOwn(e,s)){let r=this.trialObject[s];typeof r=="function"&&(r=r.toString()),e[s]=r}else!i&&Object.hasOwn(e,s)&&delete e[s];else console.warn(`Non-existent parameter "${s}" specified in save_trial_parameters.`);e={...this.getDataParameter(),...e,trial_type:this.pluginInfo.name,trial_index:this.index,plugin_version:this.pluginInfo.version?this.pluginInfo.version:null};const t=this.getParameterValue("save_timeline_variables");return t===!0?e.timeline_variables={...this.parent.getAllTimelineVariables()}:Array.isArray(t)&&(e.timeline_variables=Object.fromEntries(Object.entries(this.parent.getAllTimelineVariables()).filter(([s,i])=>t.includes(s)))),e}runParameterCallback(e,...t){const s=this.getParameterValue(e,{evaluateFunctions:!1});if(s)return s(...t)}onStart(){this.dependencies.onTrialStart(this),this.runParameterCallback("on_start",this.trialObject),this.dependencies.runOnStartExtensionCallbacks(this.getParameterValue("extensions"))}async onFinish(){const e=await this.dependencies.runOnFinishExtensionCallbacks(this.getParameterValue("extensions"));Object.assign(this.result,e),await Promise.resolve(this.runParameterCallback("on_finish",this.getResult())),this.dependencies.onTrialFinished(this)}evaluateTimelineVariable(e){return this.parent?.evaluateTimelineVariable(e)}getParameterValue(e,t={}){return B0.includes(typeof e=="string"?e:e[0])&&(t.recursive=!1),super.getParameterValue(e,t)}getSimulationOptions(){const e=this.getParameterValue("simulation_options",{replaceResult:(t={})=>{if(typeof t=="string"){const s=this.dependencies.getGlobalSimulationOptions();t=s[t]??s.default??{}}return Fa(Es(this.dependencies.getGlobalSimulationOptions().default),Es(t))}});return typeof e>"u"?{}:(e.mode=this.getParameterValue(["simulation_options","mode"]),e.simulate=this.getParameterValue(["simulation_options","simulate"]),e.data=this.getParameterValue(["simulation_options","data"]),typeof e.data=="object"&&(e.data=Object.fromEntries(Object.keys(e.data).map(t=>[t,this.getParameterValue(["simulation_options","data",t])]))),e)}getResult(){return this.getParameterValue("record_data")===!1?void 0:this.result}getResults(){const e=this.getResult();return e?[e]:[]}processParameters(){const e=(s,i,r=[])=>{for(const[a,o]of Object.entries(i)){const l=[...r,a];let u=this.getParameterValue(l,{evaluateFunctions:o.type!==m.FUNCTION,replaceResult:d=>{if(typeof d>"u"){if(typeof o.default>"u")throw new Error(`You must specify a value for the "${zf(l)}" parameter in the "${this.pluginInfo.name}" plugin.`);return o.default}else return d}});if(o.array&&!Array.isArray(u)){const d=zf(l);throw new Error(`A non-array value (\`${u}\`) was provided for the array parameter "${d}" in the "${this.pluginInfo.name}" plugin. Please make sure that "${d}" is an array.`)}o.type===m.COMPLEX&&o.nested&&(o.array?u=u.map((d,h)=>{const f=[...l,h.toString()],C=this.getParameterValue(f);return e(C,o.nested,f),C}):e(u,o.nested,l)),s[a]=u}},t=Es(this.description);e(t,this.pluginInfo.parameters),this.trialObject=t}getLatestNode(){return this}getActiveTimelineByName(e){}}class Pi extends jf{constructor(e,t,s){super(e),this.parent=s,this.children=[],this.shouldAbort=!1,this.resumePromise=new Hf,this.description=Array.isArray(t)?{timeline:t}:t,this.initializeParameterValueCache()}async run(){typeof this.index>"u"&&(this.index=0),this.status=jt.RUNNING;const{conditional_function:e,loop_function:t,repetitions:s=1}=this.description;let i=this.generateTimelineVariableOrder();this.setCurrentTimelineVariablesByIndex(i[0]);let r=!0,a;if(!e||e()){this.onStart();for(let o=0;o<s;o++)do{a=[],r?r=!1:i=this.generateTimelineVariableOrder();for(const l of i){this.setCurrentTimelineVariablesByIndex(l);for(const u of this.description.timeline){const d=this.instantiateChildNode(u),h=this.currentChild;if(this.currentChild=d,d.index=h?h.getLatestNode().index+1:this.index,await d.run(),this.status===jt.PAUSED&&await this.resumePromise.get(),this.shouldAbort){this.status=jt.ABORTED;return}a.push(...this.currentChild.getResults())}}}while(t&&t(new $t(a)));this.onFinish()}this.status=jt.COMPLETED}onStart(){this.description.on_timeline_start&&this.description.on_timeline_start()}onFinish(){this.description.on_timeline_finish&&this.description.on_timeline_finish()}pause(){this.currentChild instanceof Pi&&this.currentChild.pause(),this.status=jt.PAUSED}resume(){this.status==jt.PAUSED&&(this.currentChild instanceof Pi&&this.currentChild.resume(),this.status=jt.RUNNING,this.resumePromise.resolve())}abort(){(this.status===jt.RUNNING||this.status===jt.PAUSED)&&(this.currentChild instanceof Pi&&this.currentChild.abort(),this.shouldAbort=!0,this.status===jt.PAUSED&&this.resume())}instantiateChildNode(e){const t=zl(e)?new Pi(this.dependencies,e,this):new Ha(this.dependencies,e,this);return this.children.push(t),t}setCurrentTimelineVariablesByIndex(e){this.currentTimelineVariables={...this.parent?.getAllTimelineVariables(),...e===null?void 0:this.description.timeline_variables[e]}}generateTimelineVariableOrder(){const e=this.description.timeline_variables?.length;if(!e)return[null];let t=[...Array(e).keys()];const s=this.description.sample;if(s)switch(s.type){case"custom":t=s.fn(t);break;case"with-replacement":t=Ff(t,s.size,s.weights);break;case"without-replacement":t=Bf(t,s.size);break;case"fixed-repetitions":t=Bl(t,s.size);break;case"alternate-groups":t=qf(s.groups,s.randomize_group_order);break;default:throw new Error(`Invalid type "${s.type}" in timeline sample parameters. Valid options for type are "custom", "with-replacement", "without-replacement", "fixed-repetitions", and "alternate-groups"`)}return this.description.randomize_order&&(t=Vi(t)),t}getAllTimelineVariables(){return this.currentTimelineVariables}evaluateTimelineVariable(e){if(this.currentTimelineVariables?.hasOwnProperty(e.name))return this.currentTimelineVariables[e.name];throw new Error(`Timeline variable ${e.name} not found.`)}getResults(){const e=[];for(const t of this.children)if(t instanceof Ha){const s=t.getResult();s&&e.push(s)}else t instanceof Pi&&e.push(...t.getResults());return e}getNaiveProgress(){if(this.status===jt.PENDING)return 0;const e=this.getLatestNode();if(!e)return 1;let t=e.index;return e.getStatus()===jt.COMPLETED&&t++,Math.min(t/this.getNaiveTrialCount(),1)}getNaiveTrialCount(){const e=t=>{const s=i=>i.map(r=>e(r)).reduce((r,a)=>r+a);if(Array.isArray(t))return s(t);if(F0(t))return 1;if(zl(t)){let i=t.timeline_variables?.length||1;switch(t.sample?.type){case"with-replacement":case"without-replacement":i=t.sample.size;break;case"fixed-repetitions":i*=t.sample.size;break;case"alternate-groups":i=t.sample.groups.map(r=>r.length).reduce((r,a)=>r+a,0);break}return s(t.timeline)*(t.repetitions??1)*i}return 0};return e(this.description)}getLatestNode(){return this.currentChild?.getLatestNode()??this}getActiveTimelineByName(e){return this.description.name===e?this:this.currentChild?.getActiveTimelineByName(e)}}class j0{constructor(e){this.turk=N0,this.randomization=M0,this.utils=m0,this.citation={apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '},this.options={},this.isFileProtocolUsed=!1,this.finishTrialPromise=new Hf,this.timelineDependencies={onTrialStart:t=>{this.options.on_trial_start(t.trialObject),this.getDisplayContainerElement().focus(),this.getDisplayElement().scrollTop=0},onTrialResultAvailable:t=>{const s=t.getResult();s&&(s.time_elapsed=this.getTotalTime(),this.data.write(t))},onTrialFinished:t=>{const s=t.getResult();this.options.on_trial_finish(s),s&&this.options.on_data_update(s),this.progressBar&&this.options.auto_update_progress_bar&&(this.progressBar.progress=this.timeline.getNaiveProgress())},runOnStartExtensionCallbacks:t=>this.extensionManager.onStart(t),runOnLoadExtensionCallbacks:t=>this.extensionManager.onLoad(t),runOnFinishExtensionCallbacks:t=>this.extensionManager.onFinish(t),getSimulationMode:()=>this.simulationMode,getGlobalSimulationOptions:()=>this.simulationOptions,instantiatePlugin:t=>new t(this),getDisplayElement:()=>this.getDisplayElement(),getDefaultIti:()=>this.getInitSettings().default_iti,finishTrialPromise:this.finishTrialPromise,clearAllTimeouts:()=>this.pluginAPI.clearAllTimeouts()},this.extensionManagerDependencies={instantiateExtension:t=>new t(this)},this.dataDependencies={getProgress:()=>({time:this.getTotalTime(),trial:this.timeline?.getLatestNode().index??0}),onInteractionRecordAdded:t=>{this.options.on_interaction_data_update(t)},getDisplayElement:()=>this.getDisplayElement()},e={display_element:void 0,on_finish:()=>{},on_trial_start:()=>{},on_trial_finish:()=>{},on_data_update:()=>{},on_interaction_data_update:()=>{},on_close:()=>{},use_webaudio:!0,show_progress_bar:!1,message_progress_bar:"Completion Progress",auto_update_progress_bar:!0,default_iti:0,minimum_valid_rt:0,experiment_width:null,override_safe_mode:!1,case_sensitive_responses:!1,extensions:[],...e},this.options=e,zi(this),window.location.protocol=="file:"&&(e.override_safe_mode===!1||typeof e.override_safe_mode>"u")&&(e.use_webaudio=!1,this.isFileProtocolUsed=!0,console.warn("jsPsych detected that it is running via the file:// protocol and not on a web server. To prevent issues with cross-origin requests, Web Audio and video preloading have been disabled. If you would like to override this setting, you can set 'override_safe_mode' to 'true' in initJsPsych. For more information, see: https://www.jspsych.org/overview/running-experiments")),this.data=new C0(this.dataDependencies),this.pluginAPI=P0(this),this.extensionManager=new qa(this.extensionManagerDependencies,e.extensions)}version(){return g0}async run(e){typeof e>"u"&&console.error("No timeline declared in jsPsych.run(). Cannot start experiment."),e.length===0&&console.error("No trials have been added to the timeline (the timeline is an empty array). Cannot start experiment."),this.timeline=new Pi(this.timelineDependencies,e),await this.prepareDom(),await this.extensionManager.initializeExtensions(),document.documentElement.setAttribute("jspsych","present"),this.experimentStartTime=new Date,await this.timeline.run(),await Promise.resolve(this.options.on_finish(this.data.get())),this.endMessage&&(this.getDisplayElement().innerHTML=this.endMessage),this.data.removeInteractionListeners()}async simulate(e,t="data-only",s={}){this.simulationMode=t,this.simulationOptions=s,await this.run(e)}getProgress(){return{total_trials:this.timeline?.getNaiveTrialCount(),current_trial_global:this.timeline?.getLatestNode().index??0,percent_complete:this.timeline?.getNaiveProgress()*100}}getStartTime(){return this.experimentStartTime}getTotalTime(){return this.experimentStartTime?new Date().getTime()-this.experimentStartTime.getTime():0}getDisplayElement(){return this.displayElement}getDisplayContainerElement(){return this.displayContainerElement}abortExperiment(e,t={}){this.endMessage=e,this.timeline.abort(),this.pluginAPI.cancelAllKeyboardResponses(),this.pluginAPI.clearAllTimeouts(),this.finishTrial(t)}abortCurrentTimeline(){let e=this.timeline?.getLatestNode();e instanceof Ha&&(e=e.parent),e instanceof Pi&&e.abort()}abortTimelineByName(e){const t=this.timeline?.getActiveTimelineByName(e);t&&t.abort()}getCurrentTrial(){const e=this.timeline?.getLatestNode();if(e instanceof Ha)return e.description}getInitSettings(){return this.options}timelineVariable(e){return new Hl(e)}evaluateTimelineVariable(e){return this.timeline?.getLatestNode()?.evaluateTimelineVariable(new Hl(e))}pauseExperiment(){this.timeline?.pause()}resumeExperiment(){this.timeline?.resume()}getSafeModeStatus(){return this.isFileProtocolUsed}getTimeline(){return this.timeline?.description.timeline}getCitations(e=[],t="apa"){const s=["apa","bibtex"];if(t=t.toLowerCase(),Array.isArray(e))if(s.includes(t)){const i=this.citation[t],r=new Set([i]);for(const o of e)try{const l=o.info.citations[t];r.add(l)}catch{console.error(`${o} does not have citation in ${t} format.`)}return Array.from(r).join(`
`)}else throw new Error("Unsupported citation format");else throw new Error("Expected array of plugins/extensions")}get extensions(){return this.extensionManager?.extensions??{}}async prepareDom(){document.readyState!=="complete"&&await new Promise(i=>{window.addEventListener("load",i)});const e=this.options;if(typeof e.display_element>"u"){let i=document.body;i||(i=document.createElement("body"),document.documentElement.appendChild(i)),document.querySelector("html").style.height="100%",i.style.margin="0px",i.style.height="100%",i.style.width="100%",e.display_element=i}else{const i=e.display_element instanceof Element?e.display_element:document.querySelector("#"+e.display_element);i===null?console.error("The display_element specified in initJsPsych() does not exist in the DOM."):e.display_element=i}const t=document.createElement("div");t.id="jspsych-content";const s=document.createElement("div");if(s.className="jspsych-content-wrapper",s.appendChild(t),this.displayContainerElement=e.display_element,this.displayContainerElement.appendChild(s),this.displayElement=t,e.experiment_width!==null&&(this.displayElement.style.width=e.experiment_width+"px"),e.display_element.tabIndex=0,this.displayContainerElement.classList.add("jspsych-display-element"),this.displayElement.classList.add("jspsych-content"),this.data.createInteractionListeners(),window.addEventListener("beforeunload",e.on_close),this.options.show_progress_bar){const i=document.createElement("div");i.id="jspsych-progressbar-container",this.progressBar=new q0(i,this.options.message_progress_bar),this.getDisplayContainerElement().insertAdjacentElement("afterbegin",i)}}finishTrial(e){this.finishTrialPromise.resolve(e)}}let Si=class extends Error{constructor(e="The global `jsPsych` variable is no longer available in jsPsych v7."){super(`${e} Please follow the migration guide at https://www.jspsych.org/7.0/support/migration-v7/ to update your experiment.`),this.name="MigrationError"}};window.jsPsych={get init(){throw new Si("`jsPsych.init()` was replaced by `initJsPsych()` in jsPsych v7.")},get data(){throw new Si},get randomization(){throw new Si},get turk(){throw new Si},get pluginAPI(){throw new Si},get ALL_KEYS(){throw new Si('jsPsych.ALL_KEYS was replaced by the "ALL_KEYS" string in jsPsych v7.')},get NO_KEYS(){throw new Si('jsPsych.NO_KEYS was replaced by the "NO_KEYS" string in jsPsych v7.')}},typeof window<"u"&&window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext);function U0(n){const e=new j0(n);return Object.defineProperties(e,Object.fromEntries(Object.entries({init:"`jsPsych.init()` was replaced by `initJsPsych()` in jsPsych v7.",ALL_KEYS:'jsPsych.ALL_KEYS was replaced by the "ALL_KEYS" string in jsPsych v7.',NO_KEYS:'jsPsych.NO_KEYS was replaced by the "NO_KEYS" string in jsPsych v7.',currentTimelineNodeID:"`currentTimelineNodeID()` was renamed to `getCurrentTimelineNodeID()` in jsPsych v7.",progress:"`progress()` was renamed to `getProgress()` in jsPsych v7.",startTime:"`startTime()` was renamed to `getStartTime()` in jsPsych v7.",totalTime:"`totalTime()` was renamed to `getTotalTime()` in jsPsych v7.",currentTrial:"`currentTrial()` was renamed to `getCurrentTrial()` in jsPsych v7.",initSettings:"`initSettings()` was renamed to `getInitSettings()` in jsPsych v7.",allTimelineVariables:"`allTimelineVariables()` was renamed to `getAllTimelineVariables()` in jsPsych v7."}).map(([s,i])=>[s,{get(){throw new Si(i)}}]))),e}var W0="2.1.0";const $0={name:"animation",version:W0,parameters:{stimuli:{type:m.IMAGE,default:void 0,array:!0},frame_time:{type:m.INT,default:250},frame_isi:{type:m.INT,default:0},sequence_reps:{type:m.INT,default:1},choices:{type:m.KEYS,default:"ALL_KEYS"},prompt:{type:m.HTML_STRING,default:null},render_on_canvas:{type:m.BOOL,default:!0}},data:{animation_sequence:{type:m.COMPLEX,array:!0,nested:{stimulus:{type:m.STRING},time:{type:m.INT}}},response:{type:m.COMPLEX,array:!0,nested:{stimulus:{type:m.STRING},rt:{type:m.INT},key_press:{type:m.STRING}}}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Ic=class Ic{constructor(e){this.jsPsych=e}trial(e,t){var s=t.frame_time+t.frame_isi,i=0,r=0,a=performance.now(),o=[],l=[],u="";if(t.render_on_canvas){if(e.hasChildNodes())for(;e.firstChild;)e.removeChild(e.firstChild);var d=document.createElement("canvas");d.id="jspsych-animation-image",d.style.margin="0",d.style.padding="0",e.insertBefore(d,null);var h=d.getContext("2d")}const f=()=>{this.jsPsych.pluginAPI.cancelKeyboardResponse(V);var P={animation_sequence:o,response:l};this.jsPsych.finishTrial(P)};var C=setInterval(()=>{var P=!0;t.render_on_canvas||(e.innerHTML=""),i++,i==t.stimuli.length&&(i=0,r++,r>=t.sequence_reps&&(f(),clearInterval(C),P=!1)),P&&b()},s);const b=()=>{if(t.render_on_canvas){e.querySelector("#jspsych-animation-image").style.visibility="visible";var P=new Image;P.src=t.stimuli[i],d.height=P.naturalHeight,d.width=P.naturalWidth,h.drawImage(P,0,0),t.prompt!==null&&i==0&&r==0&&e.insertAdjacentHTML("beforeend",t.prompt)}else e.innerHTML='<img src="'+t.stimuli[i]+'" id="jspsych-animation-image"></img>',t.prompt!==null&&(e.innerHTML+=t.prompt);u=t.stimuli[i],o.push({stimulus:t.stimuli[i],time:Math.round(performance.now()-a)}),t.frame_isi>0&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector("#jspsych-animation-image").style.visibility="hidden",u="blank",o.push({stimulus:"blank",time:Math.round(performance.now()-a)})},t.frame_time)};var x=P=>{l.push({key_press:P.key,rt:P.rt,stimulus:u}),e.querySelector("#jspsych-animation-image").className+=" responded"},V=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:x,valid_responses:t.choices,rt_method:"performance",persist:!0,allow_held_key:!1});b()}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s=[],i=[];let r=0;const a=()=>this.jsPsych.randomization.sampleWithReplacement([!0,!1],1,[1,10])[0];for(let u=0;u<e.sequence_reps;u++)for(const d of e.stimuli)s.push({stimulus:d,time:r}),a()&&i.push({key_press:this.jsPsych.pluginAPI.getValidKey(e.choices),rt:r+this.jsPsych.randomization.randomInt(0,e.frame_time-1),current_stim:d}),r+=e.frame_time,e.frame_isi>0&&(s.push({stimulus:"blank",time:r}),a()&&i.push({key_press:this.jsPsych.pluginAPI.getValidKey(e.choices),rt:r+this.jsPsych.randomization.randomInt(0,e.frame_isi-1),current_stim:"blank"}),r+=e.frame_isi);const o={animation_sequence:s,response:i},l=this.jsPsych.pluginAPI.mergeSimulationData(o,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,l),l}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s();for(const a of i.response)this.jsPsych.pluginAPI.pressKey(a.key_press,a.rt)}};Ic.info=$0;let Ul=Ic;var G0="2.1.0";const J0={name:"audio-button-response",version:G0,parameters:{stimulus:{type:m.AUDIO,default:void 0},choices:{type:m.STRING,default:void 0,array:!0},button_html:{type:m.FUNCTION,default:function(n,e){return`<button class="jspsych-btn">${n}</button>`}},prompt:{type:m.HTML_STRING,default:null},trial_duration:{type:m.INT,default:null},button_layout:{type:m.STRING,default:"grid"},grid_rows:{type:m.INT,default:1},grid_columns:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0},trial_ends_after_audio:{type:m.BOOL,default:!1},response_allowed_while_playing:{type:m.BOOL,default:!0},enable_button_after:{type:m.INT,default:0}},data:{stimulus:{type:m.STRING},rt:{type:m.INT},response:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Tc=class Tc{constructor(e){this.jsPsych=e,this.buttonElements=[],this.response={rt:null,button:null},this.disable_buttons=()=>{for(const t of this.buttonElements)t.setAttribute("disabled","disabled")},this.enable_buttons_without_delay=()=>{for(const t of this.buttonElements)t.removeAttribute("disabled")},this.enable_buttons_with_delay=t=>{this.jsPsych.pluginAPI.setTimeout(this.enable_buttons_without_delay,t)},this.after_response=t=>{var s=performance.now(),i=Math.round(s-this.startTime);this.context!==null&&(s=this.context.currentTime,i=Math.round((s-this.startTime)*1e3)),this.response.button=parseInt(t),this.response.rt=i,this.disable_buttons(),this.params.response_ends_trial&&this.end_trial()},this.end_trial=()=>{this.audio.stop(),this.audio.removeEventListener("ended",this.end_trial),this.audio.removeEventListener("ended",this.enable_buttons);var t={rt:this.response.rt,stimulus:this.params.stimulus,response:this.response.button};this.trial_complete(t)},zi(this)}async trial(e,t,s){this.params=t,this.display=e,this.context=this.jsPsych.pluginAPI.audioContext(),this.audio=await this.jsPsych.pluginAPI.getAudioPlayer(t.stimulus),t.trial_ends_after_audio&&this.audio.addEventListener("ended",this.end_trial),!t.response_allowed_while_playing&&!t.trial_ends_after_audio&&this.audio.addEventListener("ended",this.enable_buttons);const i=document.createElement("div");if(i.id="jspsych-audio-button-response-btngroup",t.button_layout==="grid"){if(i.classList.add("jspsych-btn-group-grid"),t.grid_rows===null&&t.grid_columns===null)throw new Error("You cannot set `grid_rows` to `null` without providing a value for `grid_columns`.");const r=t.grid_columns===null?Math.ceil(t.choices.length/t.grid_rows):t.grid_columns,a=t.grid_rows===null?Math.ceil(t.choices.length/t.grid_columns):t.grid_rows;i.style.gridTemplateColumns=`repeat(${r}, 1fr)`,i.style.gridTemplateRows=`repeat(${a}, 1fr)`}else t.button_layout==="flex"&&i.classList.add("jspsych-btn-group-flex");for(const[r,a]of t.choices.entries()){i.insertAdjacentHTML("beforeend",t.button_html(a,r));const o=i.lastChild;o.dataset.choice=r.toString(),o.addEventListener("click",()=>{this.after_response(r)}),this.buttonElements.push(o)}return e.appendChild(i),t.prompt!==null&&e.insertAdjacentHTML("beforeend",t.prompt),t.response_allowed_while_playing?t.enable_button_after>0&&(this.disable_buttons(),this.enable_buttons()):this.disable_buttons(),t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{this.end_trial()},t.trial_duration),s(),this.startTime=performance.now(),this.context!==null&&(this.startTime=this.context.currentTime),this.audio.play(),new Promise(r=>{this.trial_complete=r})}enable_buttons(){this.params.enable_button_after>0?this.enable_buttons_with_delay(this.params.enable_button_after):this.enable_buttons_without_delay()}async simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={stimulus:e.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0)+e.enable_button_after,response:this.jsPsych.randomization.randomInt(0,e.choices.length-1)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement(),a=()=>{i.rt!==null&&this.jsPsych.pluginAPI.clickTarget(r.querySelector(`#jspsych-audio-button-response-btngroup [data-choice="${i.response}"]`),i.rt)};this.trial(r,e,()=>{s(),e.response_allowed_while_playing?a():this.audio.addEventListener("ended",a)})}};Tc.info=J0;let Wl=Tc;var K0="2.1.0";const Z0={name:"audio-keyboard-response",version:K0,parameters:{stimulus:{type:m.AUDIO,default:void 0},choices:{type:m.KEYS,default:"ALL_KEYS"},prompt:{type:m.HTML_STRING,pretty_name:"Prompt",default:null},trial_duration:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0},trial_ends_after_audio:{type:m.BOOL,pretty_name:"Trial ends after audio",default:!1},response_allowed_while_playing:{type:m.BOOL,default:!0}},data:{response:{type:m.STRING},rt:{type:m.INT},stimulus:{type:m.STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Ec=class Ec{constructor(e){this.jsPsych=e,this.response={rt:null,key:null},zi(this)}trial(e,t,s){return new Promise(async i=>{this.finish=i,this.params=t,this.display=e,this.audio=await this.jsPsych.pluginAPI.getAudioPlayer(t.stimulus),t.trial_ends_after_audio&&this.audio.addEventListener("ended",this.end_trial),t.prompt!==null&&(e.innerHTML=t.prompt),this.startTime=this.jsPsych.pluginAPI.audioContext()?.currentTime,t.response_allowed_while_playing?this.setup_keyboard_listener():t.trial_ends_after_audio||this.audio.addEventListener("ended",this.setup_keyboard_listener),t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{this.end_trial()},t.trial_duration),s(),this.audio.play()})}end_trial(){this.jsPsych.pluginAPI.clearAllTimeouts(),this.audio.stop(),this.audio.removeEventListener("ended",this.end_trial),this.audio.removeEventListener("ended",this.setup_keyboard_listener),this.jsPsych.pluginAPI.cancelAllKeyboardResponses();var e={rt:this.response.rt,response:this.response.key,stimulus:this.params.stimulus};this.display.innerHTML="",this.finish(e)}after_response(e){this.response=e,this.params.response_ends_trial&&this.end_trial()}setup_keyboard_listener(){this.jsPsych.pluginAPI.useWebaudio?this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:this.after_response,valid_responses:this.params.choices,rt_method:"audio",persist:!1,allow_held_key:!1,audio_context:this.jsPsych.pluginAPI.audioContext(),audio_context_start_time:this.startTime}):this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:this.after_response,valid_responses:this.params.choices,rt_method:"performance",persist:!1,allow_held_key:!1})}async simulate(e,t,s,i){if(t=="data-only")return i(),this.simulate_data_only(e,s);if(t=="visual")return this.simulate_visual(e,s,i)}simulate_data_only(e,t){return this.create_simulation_data(e,t)}async simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement(),a=()=>{i.rt!==null&&this.jsPsych.pluginAPI.pressKey(i.response,i.rt)};return await this.trial(r,e,()=>{s(),e.response_allowed_while_playing?a():this.audio.addEventListener("ended",a)})}create_simulation_data(e,t){const s={stimulus:e.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0),response:this.jsPsych.pluginAPI.getValidKey(e.choices)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}};Ec.info=Z0;let $l=Ec;var Y0="2.1.0";const X0={name:"audio-slider-response",version:Y0,parameters:{stimulus:{type:m.AUDIO,default:void 0},min:{type:m.INT,default:0},max:{type:m.INT,default:100},slider_start:{type:m.INT,default:50},step:{type:m.INT,default:1},labels:{type:m.HTML_STRING,default:[],array:!0},slider_width:{type:m.INT,default:null},button_label:{type:m.STRING,default:"Continue",array:!1},require_movement:{type:m.BOOL,default:!1},prompt:{type:m.HTML_STRING,default:null},trial_duration:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0},trial_ends_after_audio:{type:m.BOOL,default:!1},response_allowed_while_playing:{type:m.BOOL,default:!0}},data:{response:{type:m.INT},rt:{type:m.INT},stimulus:{type:m.STRING},slider_start:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Rc=class Rc{constructor(e){this.jsPsych=e,this.response={rt:null,response:null},this.setupTrial=()=>{this.params.trial_ends_after_audio&&this.audio.addEventListener("ended",this.end_trial),!this.params.response_allowed_while_playing&&!this.params.trial_ends_after_audio&&this.audio.addEventListener("ended",this.enable_slider);var t='<div id="jspsych-audio-slider-response-wrapper" style="margin: 100px 0px;">';t+='<div class="jspsych-audio-slider-response-container" style="position:relative; margin: 0 auto 3em auto; width:',this.params.slider_width!==null?t+=this.params.slider_width+"px;":t+="auto;",t+='">',t+='<input type="range" class="jspsych-slider" value="'+this.params.slider_start+'" min="'+this.params.min+'" max="'+this.params.max+'" step="'+this.params.step+'" id="jspsych-audio-slider-response-response"',this.params.response_allowed_while_playing||(t+=" disabled"),t+="></input><div>";for(var s=0;s<this.params.labels.length;s++){var i=100/(this.params.labels.length-1),r=s*(100/(this.params.labels.length-1)),a=(r-50)/50*100,o=a*this.half_thumb_width/100;t+='<div style="border: 1px solid transparent; display: inline-block; position: absolute; left:calc('+r+"% - ("+i+"% / 2) - "+o+"px); text-align: center; width: "+i+'%;">',t+='<span style="text-align: center; font-size: 80%;">'+this.params.labels[s]+"</span>",t+="</div>"}t+="</div>",t+="</div>",t+="</div>",this.params.prompt!==null&&(t+=this.params.prompt);var l="";if((this.params.require_movement||!this.params.response_allowed_while_playing)&&(l="disabled"),t+='<button id="jspsych-audio-slider-response-next" class="jspsych-btn" '+l+">"+this.params.button_label+"</button>",this.display.innerHTML=t,this.response={rt:null,response:null},this.params.response_allowed_while_playing||(this.display.querySelector("#jspsych-audio-slider-response-response").disabled=!0,this.display.querySelector("#jspsych-audio-slider-response-next").disabled=!0),this.params.require_movement){const u=()=>{this.display.querySelector("#jspsych-audio-slider-response-next").disabled=!1};this.display.querySelector("#jspsych-audio-slider-response-response").addEventListener("mousedown",u),this.display.querySelector("#jspsych-audio-slider-response-response").addEventListener("touchstart",u),this.display.querySelector("#jspsych-audio-slider-response-response").addEventListener("change",u)}this.display.querySelector("#jspsych-audio-slider-response-next").addEventListener("click",()=>{var u=performance.now(),d=Math.round(u-this.startTime);this.context!==null&&(u=this.context.currentTime,d=Math.round((u-this.startTime)*1e3)),this.response.rt=d,this.response.response=this.display.querySelector("#jspsych-audio-slider-response-response").valueAsNumber,this.params.response_ends_trial?this.end_trial():this.display.querySelector("#jspsych-audio-slider-response-next").disabled=!0}),this.startTime=performance.now(),this.context!==null&&(this.startTime=this.context.currentTime),this.audio.play(),this.params.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{this.end_trial()},this.params.trial_duration)},this.end_trial=()=>{this.jsPsych.pluginAPI.clearAllTimeouts(),this.audio.stop(),this.audio.removeEventListener("ended",this.end_trial),this.audio.removeEventListener("ended",this.enable_slider);var t={rt:this.response.rt,stimulus:this.params.stimulus,slider_start:this.params.slider_start,response:this.response.response};this.display.innerHTML="",this.trial_complete(t)},zi(this)}async trial(e,t,s){return this.params=t,this.display=e,this.response,this.half_thumb_width=7.5,this.trial_complete,this.context=this.jsPsych.pluginAPI.audioContext(),this.audio=await this.jsPsych.pluginAPI.getAudioPlayer(t.stimulus),this.setupTrial(),s(),new Promise(i=>{this.trial_complete=i})}enable_slider(){document.querySelector("#jspsych-audio-slider-response-response").disabled=!1,this.params.require_movement||(document.querySelector("#jspsych-audio-slider-response-next").disabled=!1)}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={stimulus:e.stimulus,slider_start:e.slider_start,response:this.jsPsych.randomization.randomInt(e.min,e.max),rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement(),a=()=>{if(i.rt!==null){const o=r.querySelector("input[type='range']");setTimeout(()=>{this.jsPsych.pluginAPI.clickTarget(o),o.valueAsNumber=i.response},i.rt/2),this.jsPsych.pluginAPI.clickTarget(r.querySelector("button"),i.rt)}};this.trial(r,e,()=>{s(),e.response_allowed_while_playing?a():this.audio.addEventListener("ended",a)})}};Rc.info=X0;let Gl=Rc;var Uf=function(n,e,t){if(t||arguments.length===2)for(var s=0,i=e.length,r;s<i;s++)(r||!(s in e))&&(r||(r=Array.prototype.slice.call(e,0,s)),r[s]=e[s]);return n.concat(r||Array.prototype.slice.call(e))},ex=(function(){function n(e,t,s){this.name=e,this.version=t,this.os=s,this.type="browser"}return n})(),tx=(function(){function n(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return n})(),sx=(function(){function n(e,t,s,i){this.name=e,this.version=t,this.os=s,this.bot=i,this.type="bot-device"}return n})(),ix=(function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n})(),rx=(function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n})(),nx=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,ax=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Wf=3,ox=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",nx]],$f=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Jl(n){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new rx:typeof navigator<"u"?ux(navigator.userAgent):dx()}function lx(n){return n!==""&&ox.reduce(function(e,t){var s=t[0],i=t[1];if(e)return e;var r=i.exec(n);return!!r&&[s,r]},!1)}function ux(n){var e=lx(n);if(!e)return null;var t=e[0],s=e[1];if(t==="searchbot")return new ix;var i=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);i?i.length<Wf&&(i=Uf(Uf([],i,!0),cx(Wf-i.length),!0)):i=[];var r=i.join("."),a=hx(n),o=ax.exec(n);return o&&o[1]?new sx(t,r,a,o[1]):new ex(t,r,a)}function hx(n){for(var e=0,t=$f.length;e<t;e++){var s=$f[e],i=s[0],r=s[1],a=r.exec(n);if(a)return i}return null}function dx(){var n=typeof process<"u"&&process.version;return n?new tx(process.version.slice(1)):null}function cx(n){for(var e=[],t=0;t<n;t++)e.push("0");return e}var px="2.1.0";const gx={name:"browser-check",version:px,parameters:{features:{type:m.STRING,array:!0,default:["width","height","webaudio","browser","browser_version","mobile","os","fullscreen","vsync_rate","webcam","microphone"]},skip_features:{type:m.STRING,array:!0,default:[]},vsync_frame_count:{type:m.INT,default:60},allow_window_resize:{type:m.BOOL,default:!0},minimum_width:{type:m.INT,default:0},minimum_height:{type:m.INT,default:0},window_resize_message:{type:m.HTML_STRING,default:`<p>Your browser window is too small to complete this experiment. Please maximize the size of your browser window. 
        If your browser window is already maximized, you will not be able to complete this experiment.</p>
        <p>The minimum window width is <span id="browser-check-min-width"></span> px.</p>
        <p>Your current window width is <span id="browser-check-actual-width"></span> px.</p>
        <p>The minimum window height is <span id="browser-check-min-height"></span> px.</p>
        <p>Your current window height is <span id="browser-check-actual-height"></span> px.</p>`},resize_fail_button_text:{type:m.STRING,default:"I cannot make the window any larger"},inclusion_function:{type:m.FUNCTION,default:()=>!0},exclusion_message:{type:m.FUNCTION,default:()=>"<p>Your browser does not meet the requirements to participate in this experiment.</p>"}},data:{width:{type:m.INT},height:{type:m.INT},browser:{type:m.STRING},browser_version:{type:m.STRING},os:{type:m.STRING},mobile:{type:m.BOOL},webaudio:{type:m.BOOL},fullscreen:{type:m.BOOL},vsync_rate:{type:m.FLOAT},webcam:{type:m.BOOL},microphone:{type:m.BOOL}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},_c=class _c{constructor(e){this.jsPsych=e,this.end_flag=!1}delay(e){return new Promise(t=>setTimeout(t,e))}trial(e,t){this.t=t;const s=this.create_feature_fn_map(t),i=t.features.filter(r=>!t.skip_features.includes(r));this.run_trial(s,i)}async run_trial(e,t){const s=await this.measure_features(e,t);await this.inclusion_check(this.t.inclusion_function,s)?this.end_trial(s):this.end_experiment(s)}create_feature_fn_map(e){return new Map(Object.entries({width:()=>window.innerWidth,height:()=>window.innerHeight,webaudio:()=>!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.oAudioContext||window.msAudioContext),browser:()=>Jl().name,browser_version:()=>Jl().version,mobile:()=>/Mobi/i.test(window.navigator.userAgent),os:()=>Jl().os,fullscreen:()=>!!(document.exitFullscreen||document.webkitExitFullscreen||document.msExitFullscreen),vsync_rate:()=>new Promise(t=>{let s=performance.now(),i=[],r=e.vsync_frame_count;const a=()=>{let u=0;for(const f of i)u+=f;const d=1e3/(u/i.length),h=Math.round(d*100)/100;t(h)},o=()=>{let u=performance.now();i.push(u-s),s=u,r--,r>0?requestAnimationFrame(o):a()};requestAnimationFrame(()=>{s=performance.now(),requestAnimationFrame(o)})}),webcam:()=>new Promise((t,s)=>{(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)&&t(!1),navigator.mediaDevices.enumerateDevices().then(i=>{i.filter(a=>a.kind=="videoinput").length>0?t(!0):t(!1)})}),microphone:()=>new Promise((t,s)=>{(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)&&t(!1),navigator.mediaDevices.enumerateDevices().then(i=>{i.filter(a=>a.kind=="audioinput").length>0?t(!0):t(!1)})})}))}async measure_features(e,t){const s=new Map,i=[];for(const a of t)i.push(Promise.resolve(e.get(a)()));const r=await Promise.allSettled(i);for(let a=0;a<t.length;a++)r[a].status==="fulfilled"?s.set(t[a],r[a].value):s.set(t[a],null);return s}async inclusion_check(e,t){return await this.check_allow_resize(t),this.end_flag?!1:e(Object.fromEntries(t))}async check_allow_resize(e){const t=this.jsPsych.getDisplayElement(),s=e.get("width"),i=e.get("height");if(this.t.allow_window_resize&&(s||i)&&(this.t.minimum_width>0||this.t.minimum_height>0)){t.innerHTML=this.t.window_resize_message+`<p><button id="browser-check-max-size-btn" class="jspsych-btn">${this.t.resize_fail_button_text}</button></p>`,t.querySelector("#browser-check-max-size-btn").addEventListener("click",()=>{t.innerHTML="",this.end_flag=!0});const r=t.querySelector("#browser-check-min-width"),a=t.querySelector("#browser-check-min-height"),o=t.querySelector("#browser-check-actual-height"),l=t.querySelector("#browser-check-actual-width");for(;!this.end_flag&&(window.innerWidth<this.t.minimum_width||window.innerHeight<this.t.minimum_height);)r&&(r.innerHTML=this.t.minimum_width.toString()),a&&(a.innerHTML=this.t.minimum_height.toString()),o&&(o.innerHTML=window.innerHeight.toString()),l&&(l.innerHTML=window.innerWidth.toString()),await this.delay(100),e.set("width",window.innerWidth),e.set("height",window.innerHeight)}}end_trial(e){const t={...Object.fromEntries(e)};this.jsPsych.finishTrial(t)}end_experiment(e){this.jsPsych.getDisplayElement().innerHTML="";const t={...Object.fromEntries(e)};this.jsPsych.abortExperiment(this.t.exclusion_message(t),t)}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}async create_simulation_data(e,t){const s=this.create_feature_fn_map(e),i=e.features.filter(l=>!e.skip_features.includes(l)),r=await this.measure_features(s,i.filter(l=>l!=="vsync_rate"));i.includes("vsync_rate")&&r.set("vsync_rate",60);const a=Object.fromEntries(r);return this.jsPsych.pluginAPI.mergeSimulationData(a,t)}simulate_data_only(e,t){this.create_simulation_data(e,t).then(s=>{e.allow_window_resize&&(s.width<e.minimum_width&&(s.width=e.minimum_width),s.height<e.minimum_height&&(s.height=e.minimum_height)),e.inclusion_function(s)?this.jsPsych.finishTrial(s):this.jsPsych.abortExperiment(e.exclusion_message(s),s)})}simulate_visual(e,t,s){this.t=e,s(),this.create_simulation_data(e,t).then(i=>{const r=new Map(Object.entries(i));setTimeout(()=>{const a=document.querySelector("#browser-check-max-size-btn");a&&this.jsPsych.pluginAPI.clickTarget(a)},3e3),this.inclusion_check(this.t.inclusion_function,r).then(a=>{a?this.end_trial(r):this.end_experiment(r)})})}};_c.info=gx;let Kl=_c;var mx="2.1.0";const fx={name:"call-function",version:mx,parameters:{func:{type:m.FUNCTION,default:void 0},async:{type:m.BOOL,default:!1}},data:{value:{type:m.COMPLEX,default:void 0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Lc=class Lc{constructor(e){this.jsPsych=e}trial(e,t){let s;const i=()=>{const r={value:s};this.jsPsych.finishTrial(r)};if(t.async){const r=a=>{s=a,i()};t.func(r)}else s=t.func(),i()}};Lc.info=fx;let Zl=Lc;var yx="2.1.0";const vx={name:"canvas-button-response",version:yx,parameters:{stimulus:{type:m.FUNCTION,default:void 0},choices:{type:m.STRING,default:void 0,array:!0},button_html:{type:m.FUNCTION,default:function(n,e){return`<button class="jspsych-btn">${n}</button>`}},prompt:{type:m.HTML_STRING,default:null},stimulus_duration:{type:m.INT,default:null},trial_duration:{type:m.INT,default:null},button_layout:{type:m.STRING,default:"grid"},grid_rows:{type:m.INT,default:1},grid_columns:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0},canvas_size:{type:m.INT,array:!0,default:[500,500]}},data:{response:{type:m.INT},rt:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Ac=class Ac{constructor(e){this.jsPsych=e}trial(e,t){const s=document.createElement("div");s.id="jspsych-canvas-button-response-stimulus";const i=document.createElement("canvas");i.id="jspsych-canvas-stimulus",i.height=t.canvas_size[0],i.width=t.canvas_size[1],i.style.display="block",s.appendChild(i),e.appendChild(s);const r=document.createElement("div");if(r.id="jspsych-canvas-button-response-btngroup",t.button_layout==="grid"){if(r.classList.add("jspsych-btn-group-grid"),t.grid_rows===null&&t.grid_columns===null)throw new Error("You cannot set `grid_rows` to `null` without providing a value for `grid_columns`.");const d=t.grid_columns===null?Math.ceil(t.choices.length/t.grid_rows):t.grid_columns,h=t.grid_rows===null?Math.ceil(t.choices.length/t.grid_columns):t.grid_rows;r.style.gridTemplateColumns=`repeat(${d}, 1fr)`,r.style.gridTemplateRows=`repeat(${h}, 1fr)`}else t.button_layout==="flex"&&r.classList.add("jspsych-btn-group-flex");for(const[d,h]of t.choices.entries()){r.insertAdjacentHTML("beforeend",t.button_html(h,d));const f=r.lastChild;f.dataset.choice=d.toString(),f.addEventListener("click",()=>{u(d)})}e.appendChild(r),t.prompt!==null&&e.insertAdjacentHTML("beforeend",t.prompt),t.stimulus(i);var a=performance.now(),o={rt:null,button:null};const l=()=>{var d={rt:o.rt,response:o.button};this.jsPsych.finishTrial(d)};function u(d){var h=performance.now(),f=Math.round(h-a);o.button=parseInt(d),o.rt=f,s.classList.add("responded");for(const C of r.children)C.setAttribute("disabled","disabled");t.response_ends_trial&&l()}t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{s.style.visibility="hidden"},t.stimulus_duration),t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{l()},t.trial_duration)}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0),response:this.jsPsych.randomization.randomInt(0,e.choices.length-1)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),i.rt!==null&&this.jsPsych.pluginAPI.clickTarget(r.querySelector(`#jspsych-canvas-button-response-btngroup [data-choice="${i.response}"]`),i.rt)}};Ac.info=vx;let Yl=Ac;var Cx="2.1.0";const bx={name:"canvas-keyboard-response",version:Cx,parameters:{stimulus:{type:m.FUNCTION,default:void 0},choices:{type:m.KEYS,default:"ALL_KEYS"},prompt:{type:m.HTML_STRING,default:null},stimulus_duration:{type:m.INT,default:null},trial_duration:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0},canvas_size:{type:m.INT,array:!0,default:[500,500]}},data:{response:{type:m.STRING},rt:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Dc=class Dc{constructor(e){this.jsPsych=e}trial(e,t){var s='<div id="jspsych-canvas-keyboard-response-stimulus"><canvas id="jspsych-canvas-stimulus" height="'+t.canvas_size[0]+'" width="'+t.canvas_size[1]+'"></canvas></div>';t.prompt!==null&&(s+=t.prompt),e.innerHTML=s;let i=document.getElementById("jspsych-canvas-stimulus");i.style.display="block",t.stimulus(i);var r={rt:null,key:null};const a=()=>{typeof l<"u"&&this.jsPsych.pluginAPI.cancelKeyboardResponse(l);var u={rt:r.rt,response:r.key};this.jsPsych.finishTrial(u)};var o=u=>{e.querySelector("#jspsych-canvas-keyboard-response-stimulus").className+=" responded",r.key==null&&(r=u),t.response_ends_trial&&a()};if(t.choices!="NO_KEYS")var l=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:o,valid_responses:t.choices,rt_method:"performance",persist:!1,allow_held_key:!1});t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector("#jspsych-canvas-keyboard-response-stimulus").style.visibility="hidden"},t.stimulus_duration),t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{a()},t.trial_duration)}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),i.rt!==null&&this.jsPsych.pluginAPI.pressKey(i.response,i.rt)}create_simulation_data(e,t){const s={rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0),response:this.jsPsych.pluginAPI.getValidKey(e.choices)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}};Dc.info=bx;let Xl=Dc;var wx="2.1.0";const xx={name:"canvas-slider-response",version:wx,parameters:{stimulus:{type:m.FUNCTION,default:void 0},min:{type:m.INT,default:0},max:{type:m.INT,default:100},slider_start:{type:m.INT,default:50},step:{type:m.INT,default:1},labels:{type:m.HTML_STRING,default:[],array:!0},slider_width:{type:m.INT,default:null},button_label:{type:m.STRING,default:"Continue",array:!1},require_movement:{type:m.BOOL,default:!1},prompt:{type:m.HTML_STRING,default:null},stimulus_duration:{type:m.INT,default:null},trial_duration:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0},canvas_size:{type:m.INT,array:!0,default:[500,500]}},data:{rt:{type:m.INT},response:{type:m.STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Oc=class Oc{constructor(e){this.jsPsych=e}trial(e,t){var s='<div id="jspsych-canvas-slider-response-wrapper" style="margin: 100px 0px;">';s+='<div id="jspsych-canvas-slider-response-stimulus"><canvas id="jspsych-canvas-stimulus" height="'+t.canvas_size[0]+'" width="'+t.canvas_size[1]+'"></canvas></div>',s+='<div class="jspsych-canvas-slider-response-container" style="position:relative; margin: 0 auto 3em auto; width:',t.slider_width!==null?s+=t.slider_width+"px;":s+=t.canvas_size[1]+"px;",s+='">',s+='<input type="range" class="jspsych-slider" value="'+t.slider_start+'" min="'+t.min+'" max="'+t.max+'" step="'+t.step+'" style="width: 100%;" id="jspsych-canvas-slider-response-response"></input>',s+="<div>";for(var i=0;i<t.labels.length;i++){var r=100/(t.labels.length-1),a=i*(100/(t.labels.length-1))-r/2;s+='<div style="display: inline-block; position: absolute; left:'+a+"%; text-align: center; width: "+r+'%;">',s+='<span style="text-align: center; font-size: 80%;">'+t.labels[i]+"</span>",s+="</div>"}s+="</div>",s+="</div>",s+="</div>",t.prompt!==null&&(s+=t.prompt),s+='<button id="jspsych-canvas-slider-response-next" class="jspsych-btn" '+(t.require_movement?"disabled":"")+">"+t.button_label+"</button>",e.innerHTML=s;let o=document.getElementById("jspsych-canvas-stimulus");o.style.display="block",t.stimulus(o);var l={rt:null,response:null};const u=()=>{var h={rt:l.rt,response:l.response,slider_start:t.slider_start};this.jsPsych.finishTrial(h)};if(t.require_movement){const h=()=>{e.querySelector("#jspsych-canvas-slider-response-next").disabled=!1};e.querySelector("#jspsych-canvas-slider-response-response").addEventListener("mousedown",h),e.querySelector("#jspsych-canvas-slider-response-response").addEventListener("touchstart",h),e.querySelector("#jspsych-canvas-slider-response-response").addEventListener("change",h)}e.querySelector("#jspsych-canvas-slider-response-next").addEventListener("click",()=>{var h=performance.now();l.rt=Math.round(h-d),l.response=e.querySelector("#jspsych-canvas-slider-response-response").valueAsNumber,t.response_ends_trial?u():e.querySelector("#jspsych-canvas-slider-response-next").disabled=!0}),t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector("#jspsych-canvas-slider-response-stimulus").style.visibility="hidden"},t.stimulus_duration),t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(u,t.trial_duration);var d=performance.now()}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={response:this.jsPsych.randomization.randomInt(e.min,e.max),rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();if(this.trial(r,e),s(),i.rt!==null){const a=r.querySelector("input[type='range']");setTimeout(()=>{this.jsPsych.pluginAPI.clickTarget(a),a.valueAsNumber=i.response},i.rt/2),this.jsPsych.pluginAPI.clickTarget(r.querySelector("button"),i.rt)}}};Oc.info=xx;let eu=Oc;var Vx="2.1.0";const Px={name:"categorize-animation",version:Vx,parameters:{stimuli:{type:m.IMAGE,default:void 0,array:!0},key_answer:{type:m.KEY,default:void 0},choices:{type:m.KEYS,default:"ALL_KEYS"},text_answer:{type:m.HTML_STRING,default:null},correct_text:{type:m.HTML_STRING,default:"Correct."},incorrect_text:{type:m.HTML_STRING,default:"Wrong."},frame_time:{type:m.INT,default:500},sequence_reps:{type:m.INT,default:1},allow_response_before_complete:{type:m.BOOL,default:!1},feedback_duration:{type:m.INT,default:2e3},prompt:{type:m.HTML_STRING,default:null},render_on_canvas:{type:m.BOOL,default:!0}},data:{stimulus:{type:m.STRING,array:!0},response:{type:m.STRING},rt:{type:m.INT},correct:{type:m.BOOL}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Mc=class Mc{constructor(e){this.jsPsych=e}trial(e,t){var s=0,i=0,r=!0,a=!1,o=!1,l;if(t.render_on_canvas){if(e.hasChildNodes())for(;e.firstChild;)e.removeChild(e.firstChild);var u=document.createElement("canvas");u.id="jspsych-categorize-animation-stimulus",u.style.margin="0",u.style.padding="0",e.insertBefore(u,null);var d=u.getContext("2d");if(t.prompt!==null){var h=document.createElement("div");h.id="jspsych-categorize-animation-prompt",h.style.visibility="hidden",h.innerHTML=t.prompt,e.insertBefore(h,u.nextElementSibling)}var f=document.createElement("div");e.insertBefore(f,e.nextElementSibling)}const C=()=>{if(r)if(t.render_on_canvas){e.querySelector("#jspsych-categorize-animation-stimulus").style.visibility="visible";var X=new Image;X.src=t.stimuli[s],u.height=X.naturalHeight,u.width=X.naturalWidth,d.drawImage(X,0,0)}else e.innerHTML+='<img src="'+t.stimuli[s]+'" class="jspsych-categorize-animation-stimulus"></img>';if(!a&&t.allow_response_before_complete)t.prompt!==null&&(t.render_on_canvas?h.style.visibility="visible":e.innerHTML+=t.prompt),t.render_on_canvas&&(r||u.remove());else if(!a)r||(t.prompt!==null&&(t.render_on_canvas?h.style.visibility="visible":e.innerHTML+=t.prompt),t.render_on_canvas&&u.remove());else{var N="";l?N=t.correct_text.replace("%ANS%",t.text_answer):N=t.incorrect_text.replace("%ANS%",t.text_answer),t.render_on_canvas?(t.prompt!==null&&h.remove(),f.innerHTML=N):e.innerHTML+=N,o||(o=!0,this.jsPsych.pluginAPI.setTimeout(()=>{x()},t.feedback_duration))}};var b=setInterval(()=>{t.render_on_canvas||(e.innerHTML=""),s++,s==t.stimuli.length&&(s=0,i++,t.sequence_reps!=-1&&i>=t.sequence_reps&&(r=!1)),C()},t.frame_time);C();const x=()=>{clearInterval(b),this.jsPsych.finishTrial(P)};var V,P={};const M=X=>{if(!t.allow_response_before_complete&&r)return!1;l=!1,this.jsPsych.pluginAPI.compareKeys(t.key_answer,X.key)&&(l=!0),a=!0,P={stimulus:t.stimuli,rt:X.rt,correct:l,response:X.key},this.jsPsych.pluginAPI.cancelKeyboardResponse(V)};V=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:M,valid_responses:t.choices,rt_method:"performance",persist:!0,allow_held_key:!1})}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s=e.sequence_reps*e.frame_time*e.stimuli.length,i=this.jsPsych.pluginAPI.getValidKey(e.choices),r={stimulus:e.stimuli,rt:s+this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),response:i,correct:i==e.key_answer},a=this.jsPsych.pluginAPI.mergeSimulationData(r,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,a),a}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);if(s.rt==null||s.response==null)throw new Error(`
        Simulated response for categorize-animation plugin was invalid. 
        This could be because the response RT was too fast and generated
        before the animation finished when the allow_response_before_complete
        parameter is false. In a real experiment this would cause the experiment
        to pause indefinitely.`);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();if(this.trial(r,e),s(),i.rt!==null)this.jsPsych.pluginAPI.pressKey(i.response,i.rt);else throw new Error(`
        Simulated response for categorize-animation plugin was invalid. 
        This could be because the response RT was too fast and generated
        before the animation finished when the allow_response_before_complete
        parameter is false. In a real experiment this would cause the experiment
        to pause indefinitely.`)}};Mc.info=Px;let tu=Mc;var Sx="2.1.0";const Ix={name:"categorize-html",version:Sx,parameters:{stimulus:{type:m.HTML_STRING,default:void 0},key_answer:{type:m.KEY,default:void 0},choices:{type:m.KEYS,default:"ALL_KEYS"},text_answer:{type:m.HTML_STRING,default:null},correct_text:{type:m.HTML_STRING,default:"<p class='feedback'>Correct</p>"},incorrect_text:{type:m.HTML_STRING,default:"<p class='feedback'>Incorrect</p>"},prompt:{type:m.HTML_STRING,default:null},force_correct_button_press:{type:m.BOOL,default:!1},show_stim_with_feedback:{type:m.BOOL,default:!1},show_feedback_on_timeout:{type:m.BOOL,default:!1},timeout_message:{type:m.HTML_STRING,default:"<p>Please respond faster.</p>"},stimulus_duration:{type:m.INT,default:null},trial_duration:{type:m.INT,default:null},feedback_duration:{type:m.INT,default:2e3}},data:{stimulus:{type:m.STRING},response:{type:m.STRING},rt:{type:m.INT},correct:{type:m.BOOL}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},kc=class kc{constructor(e){this.jsPsych=e}trial(e,t){e.innerHTML='<div id="jspsych-categorize-html-stimulus" class="jspsych-categorize-html-stimulus">'+t.stimulus+"</div>",t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector("#jspsych-categorize-html-stimulus").style.visibility="hidden"},t.stimulus_duration),t.prompt!==null&&(e.innerHTML+=t.prompt);var s={};const i=o=>{this.jsPsych.pluginAPI.cancelAllKeyboardResponses();var l=!1;this.jsPsych.pluginAPI.compareKeys(t.key_answer,o.key)&&(l=!0),s={rt:o.rt,correct:l,stimulus:t.stimulus,response:o.key};var u=o.rt==null;a(l,u)};this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:i,valid_responses:t.choices,rt_method:"performance",persist:!1,allow_held_key:!1}),t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{i({key:null,rt:null})},t.trial_duration);const r=()=>{this.jsPsych.finishTrial(s)},a=(o,l)=>{if(l&&!t.show_feedback_on_timeout)e.innerHTML+=t.timeout_message;else{t.show_stim_with_feedback&&(e.innerHTML='<div id="jspsych-categorize-html-stimulus" class="jspsych-categorize-html-stimulus">'+t.stimulus+"</div>");var u="";o?u=t.correct_text.replace("%ANS%",t.text_answer):u=t.incorrect_text.replace("%ANS%",t.text_answer),e.innerHTML+=u}if(t.force_correct_button_press&&o===!1&&(l&&t.show_feedback_on_timeout||!l)){var d=h=>{r()};this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:d,valid_responses:[t.key_answer],rt_method:"performance",persist:!1,allow_held_key:!1})}else this.jsPsych.pluginAPI.setTimeout(r,t.feedback_duration)}}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s=this.jsPsych.pluginAPI.getValidKey(e.choices),i={stimulus:e.stimulus,response:s,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),correct:s==e.key_answer},r=this.jsPsych.pluginAPI.mergeSimulationData(i,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,r),r}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),i.rt!==null&&this.jsPsych.pluginAPI.pressKey(i.response,i.rt),e.force_correct_button_press&&!i.correct&&this.jsPsych.pluginAPI.pressKey(e.key_answer,i.rt+e.feedback_duration/2)}};kc.info=Ix;let su=kc;var Tx="2.1.0";const Ex={name:"categorize-image",version:Tx,parameters:{stimulus:{type:m.IMAGE,default:void 0},key_answer:{type:m.KEY,default:void 0},choices:{type:m.KEYS,default:"ALL_KEYS"},text_answer:{type:m.HTML_STRING,default:null},correct_text:{type:m.HTML_STRING,default:"<p class='feedback'>Correct</p>"},incorrect_text:{type:m.HTML_STRING,default:"<p class='feedback'>Wrong</p>"},prompt:{type:m.HTML_STRING,default:null},force_correct_button_press:{type:m.BOOL,default:!1},show_stim_with_feedback:{type:m.BOOL,default:!0,no_function:!1},show_feedback_on_timeout:{type:m.BOOL,default:!1},timeout_message:{type:m.HTML_STRING,default:"<p>Please respond faster.</p>"},stimulus_duration:{type:m.INT,default:null},trial_duration:{type:m.INT,default:null},feedback_duration:{type:m.INT,default:2e3}},data:{stimulus:{type:m.STRING},response:{type:m.STRING},rt:{type:m.INT},correct:{type:m.BOOL}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Nc=class Nc{constructor(e){this.jsPsych=e}trial(e,t){e.innerHTML='<img id="jspsych-categorize-image-stimulus" class="jspsych-categorize-image-stimulus" src="'+t.stimulus+'"></img>',t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector("#jspsych-categorize-image-stimulus").style.visibility="hidden"},t.stimulus_duration),t.prompt!==null&&(e.innerHTML+=t.prompt);var s={};const i=o=>{this.jsPsych.pluginAPI.cancelAllKeyboardResponses();var l=!1;this.jsPsych.pluginAPI.compareKeys(t.key_answer,o.key)&&(l=!0),s={rt:o.rt,correct:l,stimulus:t.stimulus,response:o.key};var u=o.rt==null;a(l,u)};this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:i,valid_responses:t.choices,rt_method:"performance",persist:!1,allow_held_key:!1}),t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{i({key:null,rt:null})},t.trial_duration);const r=()=>{this.jsPsych.finishTrial(s)},a=(o,l)=>{if(l&&!t.show_feedback_on_timeout)e.innerHTML+=t.timeout_message;else{t.show_stim_with_feedback&&(e.innerHTML='<img id="jspsych-categorize-image-stimulus" class="jspsych-categorize-image-stimulus" src="'+t.stimulus+'"></img>');var u="";o?u=t.correct_text.replace("%ANS%",t.text_answer):u=t.incorrect_text.replace("%ANS%",t.text_answer),e.innerHTML+=u}if(t.force_correct_button_press&&o===!1&&(l&&t.show_feedback_on_timeout||!l)){var d=h=>{r()};this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:d,valid_responses:[t.key_answer],rt_method:"performance",persist:!1,allow_held_key:!1})}else this.jsPsych.pluginAPI.setTimeout(r,t.feedback_duration)}}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s=this.jsPsych.pluginAPI.getValidKey(e.choices),i={stimulus:e.stimulus,response:s,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),correct:s==e.key_answer},r=this.jsPsych.pluginAPI.mergeSimulationData(i,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,r),r}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),i.rt!==null&&this.jsPsych.pluginAPI.pressKey(i.response,i.rt),e.force_correct_button_press&&!i.correct&&this.jsPsych.pluginAPI.pressKey(e.key_answer,i.rt+e.feedback_duration/2)}};Nc.info=Ex;let iu=Nc;var Rx="2.2.0";const _x={name:"cloze",version:Rx,parameters:{text:{type:m.HTML_STRING,default:void 0},button_text:{type:m.STRING,default:"OK"},check_answers:{type:m.BOOL,default:!1},allow_blanks:{type:m.BOOL,default:!0},case_sensitivity:{type:m.BOOL,pretty_name:"Case sensitivity",default:!0},mistake_fn:{type:m.FUNCTION,default:()=>{}},autofocus:{type:m.BOOL,default:!0}},data:{response:{type:m.STRING,array:!0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},qc=class qc{constructor(e){this.jsPsych=e}trial(e,t){var s='<div class="cloze">',i=t.text.split("%");const r=this.getSolutions(t.text,t.case_sensitivity);let a=0;for(var o=0;o<i.length;o++)o%2===0?s+=i[o]:(s+=`<input type="text" id="input${a}" value="">`,a++);s+="</div>",e.innerHTML=s;const l=()=>{for(var u=[],d=!0,h=!0,f=0;f<r.length;f++){var C=document.getElementById("input"+f);u.push(t.case_sensitivity?C.value.trim():C.value.toLowerCase().trim()),t.check_answers&&(r[f].includes(u[f])?C.style.color="black":(C.style.color="red",d=!1)),t.allow_blanks||u[f]===""&&(h=!1)}if(t.check_answers&&!d||!t.allow_blanks&&!h)t.mistake_fn();else{var b={response:u};this.jsPsych.finishTrial(b)}};e.innerHTML+='<br><button class="jspsych-html-button-response-button" type="button" id="finish_cloze_button">'+t.button_text+"</button>",e.querySelector("#finish_cloze_button").addEventListener("click",l),t.autofocus&&e.querySelector("#input0").focus()}getSolutions(e,t){const s=[],i=e.split("%");for(let r=1;r<i.length;r+=2)s.push(t?i[r].trim().split("/"):i[r].toLowerCase().trim().split("/"));return s}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s=this.getSolutions(e.text,e.case_sensitivity),i=[];for(const l of s)if(l.includes("")){var r=this.jsPsych.randomization.randomWords({exactly:1});i.push(r[0])}else i.push(l[Math.floor(Math.random()*l.length)]);const a={response:i};return this.jsPsych.pluginAPI.mergeSimulationData(a,t)}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s();const a=r.querySelectorAll('input[type="text"]');let o=this.jsPsych.randomization.sampleExGaussian(750,200,.01,!0);for(let l=0;l<i.response.length;l++)this.jsPsych.pluginAPI.fillTextInput(a[l],i.response[l],o),o+=this.jsPsych.randomization.sampleExGaussian(750,200,.01,!0);this.jsPsych.pluginAPI.clickTarget(r.querySelector("#finish_cloze_button"),o)}};qc.info=_x;let ru=qc;var Lx="2.1.0";const Ax={name:"external-html",version:Lx,parameters:{url:{type:m.STRING,default:void 0},cont_key:{type:m.KEY,default:null},cont_btn:{type:m.STRING,default:null},check_fn:{type:m.FUNCTION,default:()=>!0},force_refresh:{type:m.BOOL,default:!1},execute_script:{type:m.BOOL,pretty_name:"Execute scripts",default:!1}},data:{url:{type:m.STRING},rt:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Bc=class Bc{constructor(e){this.jsPsych=e}trial(e,t,s){let i;var r=t.url;return t.force_refresh&&(r=t.url+"?t="+performance.now()),fetch(r).then(a=>a.text()).then(a=>{e.innerHTML=a,s();var o=performance.now();const l=f=>{this.jsPsych.pluginAPI.compareKeys(f.key,t.cont_key)&&u()},u=()=>{if(!(t.check_fn&&!t.check_fn(e))){t.cont_key&&e.removeEventListener("keydown",l);var f={rt:Math.round(performance.now()-o),url:t.url};this.jsPsych.finishTrial(f),i()}};if(t.execute_script)for(var d=e.getElementsByTagName("script"),h=0;h<d.length;h++){const f=document.createElement("script"),C=d[h];f.text=C.text,C.parentNode.replaceChild(f,C)}t.cont_btn&&e.querySelector("#"+t.cont_btn).addEventListener("click",u),t.cont_key&&e.addEventListener("keydown",l)}).catch(a=>{console.error("Something went wrong with fetch() in plugin-external-html.",a)}),new Promise(a=>{i=a})}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={url:e.url,rt:this.jsPsych.randomization.sampleExGaussian(2e3,200,.005,!0)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e,()=>{s(),e.cont_key?this.jsPsych.pluginAPI.pressKey(e.cont_key,i.rt):e.cont_btn&&this.jsPsych.pluginAPI.clickTarget(r.querySelector("#"+e.cont_btn),i.rt)})}};Bc.info=Ax;let nu=Bc;var Dx="2.1.0";function Ox(n){let e=n.length,t,s;for(;e!==0;)s=Math.floor(Math.random()*e),e-=1,t=n[e],n[e]=n[s],n[s]=t;return n}function Gf(n,e,t){const s=(e-n)/(t-1);let i=[];for(let r=0;r<t;r++)i.push(n+s*r);return i}function Mx(n,e,t,s,i,r,a=!1){return a?Math.abs(n-t)<=i&&Math.abs(e-s)<=r:(n-t)*(n-t)*(r*r)+(e-s)*(e-s)*(i*i)<=i*i*(r*r)}function kx(n,e){const t=Math.floor(Math.random()*(n-1)),s=Math.floor(Math.random()*(e-1));return{x:t,y:s}}const Nx={name:"free-sort",version:Dx,parameters:{stimuli:{type:m.IMAGE,default:void 0,array:!0},stim_height:{type:m.INT,default:100},stim_width:{type:m.INT,default:100},scale_factor:{type:m.FLOAT,default:1.5},sort_area_height:{type:m.INT,default:700},sort_area_width:{type:m.INT,default:700},sort_area_shape:{type:m.SELECT,options:["square","ellipse"],default:"ellipse"},prompt:{type:m.HTML_STRING,default:""},prompt_location:{type:m.SELECT,options:["above","below"],default:"above"},button_label:{type:m.STRING,default:"Continue"},change_border_background_color:{type:m.BOOL,default:!0},border_color_in:{type:m.STRING,default:"#a1d99b"},border_color_out:{type:m.STRING,default:"#fc9272"},border_width:{type:m.INT,default:null},counter_text_unfinished:{type:m.HTML_STRING,default:"You still need to place %n% item%s% inside the sort area."},counter_text_finished:{type:m.HTML_STRING,default:"All items placed. Feel free to reposition items if necessary."},stim_starts_inside:{type:m.BOOL,default:!1},column_spread_factor:{type:m.FLOAT,default:1}},data:{init_locations:{type:m.STRING,array:!0},moves:{type:m.COMPLEX,array:!0,nested:{src:{type:m.STRING},x:{type:m.INT},y:{type:m.INT}}},final_locations:{type:m.COMPLEX,array:!0,nested:{src:{type:m.STRING},x:{type:m.INT},y:{type:m.INT}}},rt:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Fc=class Fc{constructor(e){this.jsPsych=e}trial(e,t){var s=performance.now(),i=t.border_color_out,r=t.border_width,a=t.stimuli;t.change_border_background_color==!1&&(i="#000000"),t.border_width==null&&(r=t.sort_area_height*.03);let o='<div id="jspsych-free-sort-arena" class="jspsych-free-sort-arena" style="position: relative; width:'+t.sort_area_width+"px; height:"+t.sort_area_height+'px; margin: auto;"</div>';o+='<div id="jspsych-free-sort-border" class="jspsych-free-sort-border" style="position: relative; width:'+t.sort_area_width*.94+"px; height:"+t.sort_area_height*.94+"px; border:"+r+"px solid "+i+"; margin: auto; line-height: 0em; ",t.sort_area_shape=="ellipse"?o+='webkit-border-radius: 50%; moz-border-radius: 50%; border-radius: 50%"></div>':o+='webkit-border-radius: 0%; moz-border-radius: 0%; border-radius: 0%"></div>';const l='<div style="line-height: 1.0em;">'+t.prompt+'<p id="jspsych-free-sort-counter" style="display: inline-block;">'+X(a.length)+"</p></div>";t.prompt_location=="below"?o+=l:o=l+o,o+='<div><button id="jspsych-free-sort-done-btn" class="jspsych-btn" style="margin-top: 5px; margin-bottom: 15px; visibility: hidden;">'+t.button_label+"</button></div>",e.innerHTML=o;let u=[];if(!t.stim_starts_inside){let N=Math.ceil(Math.sqrt(a.length));N%2!=0&&(N=N+1);var d=[],h=[];for(const W of Gf(0,t.sort_area_width-t.stim_width,N))for(const J of Gf(0,t.sort_area_height-t.stim_height,N))W>(t.sort_area_width-t.stim_width)*.5?d.push({x:W+t.sort_area_width*(.5*t.column_spread_factor),y:J}):h.push({x:W-t.sort_area_width*(.5*t.column_spread_factor),y:J});for(;d.length+h.length<a.length;)d=d.concat(d),h=h.concat(h);h=h.reverse(),a=Ox(a)}for(let N=0;N<a.length;N++){var f;t.stim_starts_inside?f=kx(t.sort_area_width-t.stim_width,t.sort_area_height-t.stim_height):N%2==0?f=d[Math.floor(N*.5)]:f=h[Math.floor(N*.5)],e.querySelector("#jspsych-free-sort-arena").innerHTML+='<img src="'+a[N]+'" data-src="'+a[N]+'" class="jspsych-free-sort-draggable" draggable="false" id="jspsych-free-sort-draggable-'+N+'" style="position: absolute; cursor: move; width:'+t.stim_width+"px; height:"+t.stim_height+"px; top:"+f.y+"px; left:"+f.x+'px;"></img>',u.push({src:a[N],x:f.x,y:f.y})}const C=a.map(()=>t.stim_starts_inside),b=[];let x=!1;const V=Array.prototype.slice.call(e.querySelectorAll(".jspsych-free-sort-draggable")),P=e.querySelector("#jspsych-free-sort-border"),M=e.querySelector("#jspsych-free-sort-done-btn");C.some(Boolean)&&t.change_border_background_color&&(P.style.borderColor=t.border_color_in),C.every(Boolean)&&(t.change_border_background_color&&(P.style.background=t.border_color_in),M.style.visibility="visible",e.querySelector("#jspsych-free-sort-counter").innerHTML=t.counter_text_finished);for(const N of V)N.addEventListener("pointerdown",function({clientX:W,clientY:J}){let ie=W-this.offsetLeft,ne=J-this.offsetTop-window.scrollY;this.style.transform="scale("+t.scale_factor+","+t.scale_factor+")";const ce=({clientX:le,clientY:be})=>{x=Mx(le-ie,be-ne,t.sort_area_width*.5-t.stim_width*.5,t.sort_area_height*.5-t.stim_height*.5,t.sort_area_width*.5,t.sort_area_height*.5,t.sort_area_shape=="square"),this.style.top=Math.min(t.sort_area_height-t.stim_height*.5,Math.max(-t.stim_height*.5,be-ne))+"px",this.style.left=Math.min(t.sort_area_width*1.5-t.stim_width,Math.max(-t.sort_area_width*.5,le-ie))+"px",t.change_border_background_color&&(x?(P.style.borderColor=t.border_color_in,P.style.background="None"):(P.style.borderColor=i,P.style.background="None"));var F=parseInt(this.id.split("jspsych-free-sort-draggable-")[1],10);C.splice(F,1,x),C.every(Boolean)?(t.change_border_background_color&&(P.style.background=t.border_color_in),M.style.visibility="visible",e.querySelector("#jspsych-free-sort-counter").innerHTML=t.counter_text_finished):(P.style.background="none",M.style.visibility="hidden",e.querySelector("#jspsych-free-sort-counter").innerHTML=X(C.length-C.filter(Boolean).length))};document.addEventListener("pointermove",ce);const ye=le=>{document.removeEventListener("pointermove",ce),this.style.transform="scale(1, 1)",t.change_border_background_color&&(C.every(Boolean)?(P.style.background=t.border_color_in,P.style.borderColor=t.border_color_in):(P.style.background="none",P.style.borderColor=i)),b.push({src:this.dataset.src,x:this.offsetLeft,y:this.offsetTop}),document.removeEventListener("pointerup",ye)};document.addEventListener("pointerup",ye)});e.querySelector("#jspsych-free-sort-done-btn").addEventListener("click",()=>{if(C.every(Boolean)){const N=performance.now(),W=Math.round(N-s),J=e.querySelectorAll(".jspsych-free-sort-draggable");let ie=[];for(let ce=0;ce<J.length;ce++)ie.push({src:J[ce].dataset.src,x:parseInt(J[ce].style.left),y:parseInt(J[ce].style.top)});const ne={init_locations:u,moves:b,final_locations:ie,rt:W};this.jsPsych.finishTrial(ne)}});function X(N){for(var W="",J=t.counter_text_unfinished.split("%"),ie=0;ie<J.length;ie++)ie%2===0?W+=J[ie]:J[ie]=="n"?W+=N.toString():J[ie]=="s"&&N>1&&(W+="s");return W}}};Fc.info=Nx;let au=Fc;var qx="2.1.0";const Bx={name:"fullscreen",version:qx,parameters:{fullscreen_mode:{type:m.BOOL,default:!0,array:!1},message:{type:m.HTML_STRING,default:"<p>The experiment will switch to full screen mode when you press the button below</p>",array:!1},button_label:{type:m.STRING,default:"Continue",array:!1},delay_after:{type:m.INT,default:1e3,array:!1}},data:{success:{type:m.BOOL,default:null,description:"True if the user entered fullscreen mode, false if not."},rt:{type:m.INT,default:null,description:"Time in milliseconds until the user entered fullscreen mode."}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Qc=class Qc{constructor(e){this.jsPsych=e,this.rt=null,this.start_time=0}trial(e,t){var s=typeof Element<"u"&&"ALLOW_KEYBOARD_INPUT"in Element;s?this.endTrial(e,!1,t):t.fullscreen_mode?this.showDisplay(e,t):(this.exitFullScreen(),this.endTrial(e,!0,t))}showDisplay(e,t){e.innerHTML=`
      ${t.message}
      <button id="jspsych-fullscreen-btn" class="jspsych-btn">${t.button_label}</button>
    `,e.querySelector("#jspsych-fullscreen-btn").addEventListener("click",()=>{this.rt=Math.round(performance.now()-this.start_time),this.enterFullScreen(),this.endTrial(e,!0,t)}),this.start_time=performance.now()}endTrial(e,t,s){e.innerHTML="",this.jsPsych.pluginAPI.setTimeout(()=>{var i={success:t,rt:this.rt};this.jsPsych.finishTrial(i)},s.delay_after)}enterFullScreen(){var e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}exitFullScreen(){(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const i={success:!0,rt:this.jsPsych.randomization.sampleExGaussian(1e3,100,.005,!0)};return this.jsPsych.pluginAPI.mergeSimulationData(i,t)}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();i.success===!1?this.endTrial(r,!1,e):(this.trial(r,e),s(),this.jsPsych.pluginAPI.clickTarget(r.querySelector("#jspsych-fullscreen-btn"),i.rt))}};Qc.info=Bx;let ou=Qc;var Fx="2.1.1";const Qx={name:"html-audio-response",version:Fx,parameters:{stimulus:{type:m.HTML_STRING,default:void 0},stimulus_duration:{type:m.INT,default:null},recording_duration:{type:m.INT,default:2e3},show_done_button:{type:m.BOOL,default:!0},done_button_label:{type:m.STRING,default:"Continue"},record_again_button_label:{type:m.STRING,default:"Record again"},accept_button_label:{type:m.STRING,default:"Continue"},allow_playback:{type:m.BOOL,default:!1},save_audio_url:{type:m.BOOL,default:!1}},data:{rt:{type:m.INT},response:{type:m.STRING},stimulus:{type:m.HTML_STRING},estimated_stimulus_onset:{type:m.INT},audio_url:{type:m.STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Hc=class Hc{constructor(e){this.jsPsych=e,this.rt=null,this.recorded_data_chunks=[]}trial(e,t){this.recorder=this.jsPsych.pluginAPI.getMicrophoneRecorder(),this.setupRecordingEvents(e,t),this.startRecording()}showDisplay(e,t){new ResizeObserver((r,a)=>{this.stimulus_start_time=performance.now(),a.unobserve(e)}).observe(e);let i=`<div id="jspsych-html-audio-response-stimulus">${t.stimulus}</div>`;t.show_done_button&&(i+=`<p><button class="jspsych-btn" id="finish-trial">${t.done_button_label}</button></p>`),e.innerHTML=i}hideStimulus(e){const t=e.querySelector("#jspsych-html-audio-response-stimulus");t&&(t.style.visibility="hidden")}addButtonEvent(e,t){const s=e.querySelector("#finish-trial");s&&s.addEventListener("click",()=>{const i=performance.now();this.rt=Math.round(i-this.stimulus_start_time),this.stopRecording().then(()=>{t.allow_playback?this.showPlaybackControls(e,t):this.endTrial(e,t)})})}setupRecordingEvents(e,t){this.data_available_handler=s=>{s.data.size>0&&this.recorded_data_chunks.push(s.data)},this.stop_event_handler=()=>{const s=new Blob(this.recorded_data_chunks,{type:this.recorded_data_chunks[0].type});this.audio_url=URL.createObjectURL(s);const i=new FileReader;i.addEventListener("load",()=>{const r=i.result.split(",")[1];this.response=r,this.load_resolver()}),i.readAsDataURL(s)},this.start_event_handler=s=>{this.recorded_data_chunks.length=0,this.recorder_start_time=s.timeStamp,this.showDisplay(e,t),this.addButtonEvent(e,t),t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{this.hideStimulus(e)},t.stimulus_duration),t.recording_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{this.recorder.state!=="inactive"&&this.stopRecording().then(()=>{t.allow_playback?this.showPlaybackControls(e,t):this.endTrial(e,t)})},t.recording_duration)},this.recorder.addEventListener("dataavailable",this.data_available_handler),this.recorder.addEventListener("stop",this.stop_event_handler),this.recorder.addEventListener("start",this.start_event_handler)}startRecording(){this.recorder.start()}stopRecording(){return this.recorder.stop(),new Promise(e=>{this.load_resolver=e})}showPlaybackControls(e,t){e.innerHTML=`
      <p><audio id="playback" src="${this.audio_url}" controls></audio></p>
      <button id="record-again" class="jspsych-btn">${t.record_again_button_label}</button>
      <button id="continue" class="jspsych-btn">${t.accept_button_label}</button>
    `,e.querySelector("#record-again").addEventListener("click",()=>{URL.revokeObjectURL(this.audio_url),this.startRecording()}),e.querySelector("#continue").addEventListener("click",()=>{this.endTrial(e,t)})}endTrial(e,t){this.recorder.removeEventListener("dataavailable",this.data_available_handler),this.recorder.removeEventListener("start",this.start_event_handler),this.recorder.removeEventListener("stop",this.stop_event_handler);var s={rt:this.rt,stimulus:t.stimulus,response:this.response,estimated_stimulus_onset:Math.round(this.stimulus_start_time-this.recorder_start_time)};t.save_audio_url?s.audio_url=this.audio_url:URL.revokeObjectURL(this.audio_url),this.jsPsych.finishTrial(s)}};Hc.info=Qx;let lu=Hc;var Hx="2.1.0";const zx={name:"html-button-response",version:Hx,parameters:{stimulus:{type:m.HTML_STRING,default:void 0},choices:{type:m.STRING,default:void 0,array:!0},button_html:{type:m.FUNCTION,default:function(n,e){return`<button class="jspsych-btn">${n}</button>`}},prompt:{type:m.HTML_STRING,default:null},stimulus_duration:{type:m.INT,default:null},trial_duration:{type:m.INT,default:null},button_layout:{type:m.STRING,default:"grid"},grid_rows:{type:m.INT,default:1},grid_columns:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0},enable_button_after:{type:m.INT,default:0}},data:{rt:{type:m.INT},response:{type:m.INT},stimulus:{type:m.HTML_STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},zc=class zc{constructor(e){this.jsPsych=e}trial(e,t){const s=document.createElement("div");s.id="jspsych-html-button-response-stimulus",s.innerHTML=t.stimulus,e.appendChild(s);const i=document.createElement("div");if(i.id="jspsych-html-button-response-btngroup",t.button_layout==="grid"){if(i.classList.add("jspsych-btn-group-grid"),t.grid_rows===null&&t.grid_columns===null)throw new Error("You cannot set `grid_rows` to `null` without providing a value for `grid_columns`.");const h=t.grid_columns===null?Math.ceil(t.choices.length/t.grid_rows):t.grid_columns,f=t.grid_rows===null?Math.ceil(t.choices.length/t.grid_columns):t.grid_rows;i.style.gridTemplateColumns=`repeat(${h}, 1fr)`,i.style.gridTemplateRows=`repeat(${f}, 1fr)`}else t.button_layout==="flex"&&i.classList.add("jspsych-btn-group-flex");for(const[h,f]of t.choices.entries()){i.insertAdjacentHTML("beforeend",t.button_html(f,h));const C=i.lastChild;C.dataset.choice=h.toString(),C.addEventListener("click",()=>{l(h)})}e.appendChild(i),t.prompt!==null&&e.insertAdjacentHTML("beforeend",t.prompt);var r=performance.now(),a={rt:null,button:null};const o=()=>{var h={rt:a.rt,stimulus:t.stimulus,response:a.button};this.jsPsych.finishTrial(h)};function l(h){var f=performance.now(),C=Math.round(f-r);a.button=parseInt(h),a.rt=C,s.classList.add("responded");for(const b of i.children)b.setAttribute("disabled","disabled");t.response_ends_trial&&o()}if(t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{s.style.visibility="hidden"},t.stimulus_duration),t.enable_button_after>0){for(var u=document.querySelectorAll("#jspsych-html-button-response-btngroup button"),d=0;d<u.length;d++)u[d].setAttribute("disabled","disabled");this.jsPsych.pluginAPI.setTimeout(()=>{for(var h=document.querySelectorAll("#jspsych-html-button-response-btngroup button"),f=0;f<h.length;f++)h[f].removeAttribute("disabled")},t.enable_button_after)}t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(o,t.trial_duration)}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={stimulus:e.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0)+e.enable_button_after,response:this.jsPsych.randomization.randomInt(0,e.choices.length-1)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),i.rt!==null&&this.jsPsych.pluginAPI.clickTarget(r.querySelector(`#jspsych-html-button-response-btngroup [data-choice="${i.response}"]`),i.rt)}};zc.info=zx;let uu=zc;var jx="2.1.0";const Ux={name:"html-keyboard-response",version:jx,parameters:{stimulus:{type:m.HTML_STRING,default:void 0},choices:{type:m.KEYS,default:"ALL_KEYS"},prompt:{type:m.HTML_STRING,default:null},stimulus_duration:{type:m.INT,default:null},trial_duration:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0}},data:{response:{type:m.STRING},rt:{type:m.INT},stimulus:{type:m.STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},jc=class jc{constructor(e){this.jsPsych=e}trial(e,t){var s='<div id="jspsych-html-keyboard-response-stimulus">'+t.stimulus+"</div>";t.prompt!==null&&(s+=t.prompt),e.innerHTML=s;var i={rt:null,key:null};const r=()=>{typeof o<"u"&&this.jsPsych.pluginAPI.cancelKeyboardResponse(o);var l={rt:i.rt,stimulus:t.stimulus,response:i.key};this.jsPsych.finishTrial(l)};var a=l=>{e.querySelector("#jspsych-html-keyboard-response-stimulus").className+=" responded",i.key==null&&(i=l),t.response_ends_trial&&r()};if(t.choices!="NO_KEYS")var o=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:a,valid_responses:t.choices,rt_method:"performance",persist:!1,allow_held_key:!1});t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector("#jspsych-html-keyboard-response-stimulus").style.visibility="hidden"},t.stimulus_duration),t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(r,t.trial_duration)}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={stimulus:e.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0),response:this.jsPsych.pluginAPI.getValidKey(e.choices)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),i.rt!==null&&this.jsPsych.pluginAPI.pressKey(i.response,i.rt)}};jc.info=Ux;let hu=jc;var Wx="2.1.0";const $x={name:"html-slider-response",version:Wx,parameters:{stimulus:{type:m.HTML_STRING,default:void 0},min:{type:m.INT,default:0},max:{type:m.INT,default:100},slider_start:{type:m.INT,default:50},step:{type:m.INT,default:1},labels:{type:m.HTML_STRING,default:[],array:!0},slider_width:{type:m.INT,default:null},button_label:{type:m.STRING,default:"Continue",array:!1},require_movement:{type:m.BOOL,default:!1},prompt:{type:m.HTML_STRING,default:null},stimulus_duration:{type:m.INT,default:null},trial_duration:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0}},data:{rt:{type:m.INT},response:{type:m.INT},stimulus:{type:m.HTML_STRING},slider_start:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Uc=class Uc{constructor(e){this.jsPsych=e}trial(e,t){var s=7.5,i='<div id="jspsych-html-slider-response-wrapper" style="margin: 100px 0px;">';i+='<div id="jspsych-html-slider-response-stimulus">'+t.stimulus+"</div>",i+='<div class="jspsych-html-slider-response-container" style="position:relative; margin: 0 auto 3em auto; ',t.slider_width!==null?i+="width:"+t.slider_width+"px;":i+="width:auto;",i+='">',i+='<input type="range" class="jspsych-slider" value="'+t.slider_start+'" min="'+t.min+'" max="'+t.max+'" step="'+t.step+'" id="jspsych-html-slider-response-response"></input>',i+="<div>";for(var r=0;r<t.labels.length;r++){var a=100/(t.labels.length-1),o=r*(100/(t.labels.length-1)),l=(o-50)/50*100,u=l*s/100;i+='<div style="border: 1px solid transparent; display: inline-block; position: absolute; left:calc('+o+"% - ("+a+"% / 2) - "+u+"px); text-align: center; width: "+a+'%;">',i+='<span style="text-align: center; font-size: 80%;">'+t.labels[r]+"</span>",i+="</div>"}i+="</div>",i+="</div>",i+="</div>",t.prompt!==null&&(i+=t.prompt),i+='<button id="jspsych-html-slider-response-next" class="jspsych-btn" '+(t.require_movement?"disabled":"")+">"+t.button_label+"</button>",e.innerHTML=i;var d={rt:null,response:null};if(t.require_movement){const C=()=>{e.querySelector("#jspsych-html-slider-response-next").disabled=!1};e.querySelector("#jspsych-html-slider-response-response").addEventListener("mousedown",C),e.querySelector("#jspsych-html-slider-response-response").addEventListener("touchstart",C),e.querySelector("#jspsych-html-slider-response-response").addEventListener("change",C)}const h=()=>{var C={rt:d.rt,stimulus:t.stimulus,slider_start:t.slider_start,response:d.response};this.jsPsych.finishTrial(C)};e.querySelector("#jspsych-html-slider-response-next").addEventListener("click",()=>{var C=performance.now();d.rt=Math.round(C-f),d.response=e.querySelector("#jspsych-html-slider-response-response").valueAsNumber,t.response_ends_trial?h():e.querySelector("#jspsych-html-slider-response-next").disabled=!0}),t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector("#jspsych-html-slider-response-stimulus").style.visibility="hidden"},t.stimulus_duration),t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(h,t.trial_duration);var f=performance.now()}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={stimulus:e.stimulus,slider_start:e.slider_start,response:this.jsPsych.randomization.randomInt(e.min,e.max),rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();if(this.trial(r,e),s(),i.rt!==null){const a=r.querySelector("input[type='range']");setTimeout(()=>{this.jsPsych.pluginAPI.clickTarget(a),a.valueAsNumber=i.response},i.rt/2),this.jsPsych.pluginAPI.clickTarget(r.querySelector("button"),i.rt)}}};Uc.info=$x;let du=Uc;var Gx="2.1.0";const Jx={name:"html-video-response",version:Gx,parameters:{stimulus:{type:m.HTML_STRING,default:void 0},stimulus_duration:{type:m.INT,default:null},recording_duration:{type:m.INT,default:2e3},show_done_button:{type:m.BOOL,default:!0},done_button_label:{type:m.STRING,default:"Continue"},record_again_button_label:{type:m.STRING,default:"Record again"},accept_button_label:{type:m.STRING,default:"Continue"},allow_playback:{type:m.BOOL,default:!1},save_video_url:{type:m.BOOL,default:!1}},data:{rt:{type:m.INT,default:null},stimulus:{type:m.HTML_STRING},response:{type:m.STRING},video_url:{type:m.STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Wc=class Wc{constructor(e){this.jsPsych=e,this.rt=null,this.recorded_data_chunks=[]}trial(e,t){this.recorder=this.jsPsych.pluginAPI.getCameraRecorder(),this.setupRecordingEvents(e,t),this.startRecording()}showDisplay(e,t){let s=`<div id="jspsych-html-video-response-stimulus">${t.stimulus}</div>`;t.show_done_button&&(s+=`<p><button class="jspsych-btn" id="finish-trial">${t.done_button_label}</button></p>`),e.innerHTML=s}hideStimulus(e){const t=e.querySelector("#jspsych-html-video-response-stimulus");t&&(t.style.visibility="hidden")}addButtonEvent(e,t){const s=e.querySelector("#finish-trial");s&&s.addEventListener("click",()=>{const i=performance.now();this.rt=Math.round(i-this.stimulus_start_time),this.stopRecording().then(()=>{t.allow_playback?this.showPlaybackControls(e,t):this.endTrial(e,t)})})}setupRecordingEvents(e,t){this.data_available_handler=s=>{s.data.size>0&&this.recorded_data_chunks.push(s.data)},this.stop_event_handler=()=>{const s=new Blob(this.recorded_data_chunks,{type:this.recorder.mimeType});this.video_url=URL.createObjectURL(s);const i=new FileReader;i.addEventListener("load",()=>{const r=i.result.split(",")[1];this.response=r,this.load_resolver()}),i.readAsDataURL(s)},this.start_event_handler=s=>{this.recorded_data_chunks.length=0,this.recorder_start_time=s.timeStamp,this.showDisplay(e,t),this.addButtonEvent(e,t),t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{this.hideStimulus(e)},t.stimulus_duration),t.recording_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{this.recorder.state!=="inactive"&&this.stopRecording().then(()=>{t.allow_playback?this.showPlaybackControls(e,t):this.endTrial(e,t)})},t.recording_duration)},this.recorder.addEventListener("dataavailable",this.data_available_handler),this.recorder.addEventListener("stop",this.stop_event_handler),this.recorder.addEventListener("start",this.start_event_handler)}startRecording(){this.recorder.start()}stopRecording(){return this.recorder.stop(),new Promise(e=>{this.load_resolver=e})}showPlaybackControls(e,t){e.innerHTML=`
      <p><video id="playback" src="${this.video_url}" controls></video></p>
      <button id="record-again" class="jspsych-btn">${t.record_again_button_label}</button>
      <button id="continue" class="jspsych-btn">${t.accept_button_label}</button>
    `,e.querySelector("#record-again").addEventListener("click",()=>{URL.revokeObjectURL(this.video_url),this.startRecording()}),e.querySelector("#continue").addEventListener("click",()=>{this.endTrial(e,t)})}endTrial(e,t){this.recorder.removeEventListener("dataavailable",this.data_available_handler),this.recorder.removeEventListener("start",this.start_event_handler),this.recorder.removeEventListener("stop",this.stop_event_handler);var s={rt:this.rt,stimulus:t.stimulus,response:this.response};t.save_video_url?s.video_url=this.video_url:URL.revokeObjectURL(this.video_url),this.jsPsych.finishTrial(s)}};Wc.info=Jx;let cu=Wc;var Kx="2.1.0";const Zx={name:"iat-html",version:Kx,parameters:{stimulus:{type:m.HTML_STRING,default:void 0},left_category_key:{type:m.KEY,default:"e"},right_category_key:{type:m.KEY,default:"i"},left_category_label:{type:m.STRING,array:!0,default:["left"]},right_category_label:{type:m.STRING,array:!0,default:["right"]},key_to_move_forward:{type:m.KEYS,default:"ALL_KEYS"},display_feedback:{type:m.BOOL,default:!1},html_when_wrong:{type:m.HTML_STRING,default:'<span style="color: red; font-size: 80px">X</span>'},bottom_instructions:{type:m.HTML_STRING,default:"<p>If you press the wrong key, a red X will appear. Press any key to continue.</p>"},force_correct_key_press:{type:m.BOOL,default:!1},stim_key_association:{type:m.SELECT,options:["left","right"],default:void 0},response_ends_trial:{type:m.BOOL,default:!0},trial_duration:{type:m.INT,default:null}},data:{stimulus:{type:m.HTML_STRING},response:{type:m.STRING},correct:{type:m.BOOL},rt:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},$c=class $c{constructor(e){this.jsPsych=e}trial(e,t){var s="";s+="<div style='position: absolute; height: 20%; width: 100%; margin-left: auto; margin-right: auto; top: 42%; left: 0; right: 0'><p id='jspsych-iat-stim'>"+t.stimulus+"</p></div>",s+="<div id='trial_left_align' style='position: absolute; top: 18%; left: 20%'>",t.left_category_label.length==1?s+="<p>Press "+t.left_category_key+" for:<br> "+t.left_category_label[0].bold()+"</p></div>":s+="<p>Press "+t.left_category_key+" for:<br> "+t.left_category_label[0].bold()+"<br>or<br>"+t.left_category_label[1].bold()+"</p></div>",s+="<div id='trial_right_align' style='position: absolute; top: 18%; right: 20%'>",t.right_category_label.length==1?s+="<p>Press "+t.right_category_key+" for:<br> "+t.right_category_label[0].bold()+"</p></div>":s+="<p>Press "+t.right_category_key+" for:<br> "+t.right_category_label[0].bold()+"<br>or<br>"+t.right_category_label[1].bold()+"</p></div>",s+="<div id='wrongImgID' style='position:relative; top: 300px; margin-left: auto; margin-right: auto; left: 0; right: 0'>",t.display_feedback===!0&&(s+="<div id='wrongImgContainer' style='visibility: hidden; position: absolute; top: -75px; margin-left: auto; margin-right: auto; left: 0; right: 0'><p>"+t.html_when_wrong+"</p></div>"),s+="<div>"+t.bottom_instructions+"</div>",s+="</div>",e.innerHTML=s;var i={rt:null,key:null,correct:!1};const r=()=>{typeof u<"u"&&this.jsPsych.pluginAPI.cancelKeyboardResponse(u);var d={rt:i.rt,stimulus:t.stimulus,response:i.key,correct:i.correct};this.jsPsych.finishTrial(d)};var a=t.left_category_key,o=t.right_category_key;const l=d=>{var h=document.getElementById("wrongImgContainer");e.querySelector("#jspsych-iat-stim").className+=" responded",i.key==null&&(i.key=d.key,i.rt=d.rt),t.stim_key_association=="right"?i.rt!==null&&this.jsPsych.pluginAPI.compareKeys(i.key,o)?(i.correct=!0,t.response_ends_trial&&r()):(i.correct=!1,!t.response_ends_trial&&t.display_feedback==!0&&(h.style.visibility="visible"),t.response_ends_trial&&t.display_feedback==!0?(h.style.visibility="visible",t.force_correct_key_press?this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:r,valid_responses:[t.right_category_key]}):this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:r,valid_responses:t.key_to_move_forward})):t.response_ends_trial&&t.display_feedback!=!0?r():!t.response_ends_trial&&t.display_feedback!=!0):t.stim_key_association=="left"&&(i.rt!==null&&this.jsPsych.pluginAPI.compareKeys(i.key,a)?(i.correct=!0,t.response_ends_trial&&r()):(i.correct=!1,!t.response_ends_trial&&t.display_feedback==!0&&(h.style.visibility="visible"),t.response_ends_trial&&t.display_feedback==!0?(h.style.visibility="visible",t.force_correct_key_press?this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:r,valid_responses:[t.left_category_key]}):this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:r,valid_responses:t.key_to_move_forward})):t.response_ends_trial&&t.display_feedback!=!0?r():!t.response_ends_trial&&t.display_feedback!=!0))};if(t.left_category_key!="NO_KEYS"&&t.right_category_key!="NO_KEYS")var u=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:l,valid_responses:[t.left_category_key,t.right_category_key],rt_method:"performance",persist:!1,allow_held_key:!1});t.trial_duration!==null&&t.response_ends_trial!=!0&&this.jsPsych.pluginAPI.setTimeout(()=>{r()},t.trial_duration)}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s=this.jsPsych.pluginAPI.getValidKey([e.left_category_key,e.right_category_key]),i=e.stim_key_association=="left"?s==e.left_category_key:s==e.right_category_key,r={stimulus:e.stimulus,response:s,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),correct:i},a=this.jsPsych.pluginAPI.mergeSimulationData(r,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,a),a}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),i.response!==null&&this.jsPsych.pluginAPI.pressKey(i.response,i.rt);const a=i.rt==null?e.trial_duration:i.rt;e.force_correct_key_press?i.correct||this.jsPsych.pluginAPI.pressKey(e.stim_key_association=="left"?e.left_category_key:e.right_category_key,a+this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0)):this.jsPsych.pluginAPI.pressKey(this.jsPsych.pluginAPI.getValidKey(e.key_to_move_forward),a+this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0))}};$c.info=Zx;let pu=$c;var Yx="2.1.0";const Xx={name:"iat-image",version:Yx,parameters:{stimulus:{type:m.IMAGE,default:void 0},left_category_key:{type:m.KEY,default:"e"},right_category_key:{type:m.KEY,default:"i"},left_category_label:{type:m.STRING,array:!0,default:["left"]},right_category_label:{type:m.STRING,array:!0,default:["right"]},key_to_move_forward:{type:m.KEYS,default:"ALL_KEYS"},display_feedback:{type:m.BOOL,default:!1},html_when_wrong:{type:m.HTML_STRING,default:'<span style="color: red; font-size: 80px">X</span>'},bottom_instructions:{type:m.HTML_STRING,default:"<p>If you press the wrong key, a red X will appear. Press any key to continue.</p>"},force_correct_key_press:{type:m.BOOL,default:!1},stim_key_association:{type:m.SELECT,options:["left","right"],default:void 0},response_ends_trial:{type:m.BOOL,default:!0},trial_duration:{type:m.INT,default:null}},data:{stimulus:{type:m.STRING},response:{type:m.STRING},correct:{type:m.BOOL},rt:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Gc=class Gc{constructor(e){this.jsPsych=e}trial(e,t){var s="";s+="<div style='position: absolute; height: 20%; width: 100%; margin-left: auto; margin-right: auto; top: 42%; left: 0; right: 0'><img src='"+t.stimulus+"' id='jspsych-iat-stim'></img></div>",s+="<div id='trial_left_align' style='position: absolute; top: 18%; left: 20%'>",t.left_category_label.length==1?s+="<p>Press "+t.left_category_key+" for:<br> "+t.left_category_label[0].bold()+"</p></div>":s+="<p>Press "+t.left_category_key+" for:<br> "+t.left_category_label[0].bold()+"<br>or<br>"+t.left_category_label[1].bold()+"</p></div>",s+="<div id='trial_right_align' style='position: absolute; top: 18%; right: 20%'>",t.right_category_label.length==1?s+="<p>Press "+t.right_category_key+" for:<br> "+t.right_category_label[0].bold()+"</p></div>":s+="<p>Press "+t.right_category_key+" for:<br> "+t.right_category_label[0].bold()+"<br>or<br>"+t.right_category_label[1].bold()+"</p></div>",s+="<div id='wrongImgID' style='position:relative; top: 300px; margin-left: auto; margin-right: auto; left: 0; right: 0'>",t.display_feedback===!0&&(s+="<div id='wrongImgContainer' style='visibility: hidden; position: absolute; top: -75px; margin-left: auto; margin-right: auto; left: 0; right: 0'><p>"+t.html_when_wrong+"</p></div>"),s+="<div>"+t.bottom_instructions+"</div>",s+="</div>",e.innerHTML=s;var i={rt:null,key:null,correct:!1};const r=()=>{typeof u<"u"&&this.jsPsych.pluginAPI.cancelKeyboardResponse(u);var d={rt:i.rt,stimulus:t.stimulus,response:i.key,correct:i.correct};this.jsPsych.finishTrial(d)};var a=t.left_category_key,o=t.right_category_key;const l=d=>{var h=document.getElementById("wrongImgContainer");e.querySelector("#jspsych-iat-stim").className+=" responded",i.key==null&&(i.key=d.key,i.rt=d.rt),t.stim_key_association=="right"?i.rt!==null&&this.jsPsych.pluginAPI.compareKeys(i.key,o)?(i.correct=!0,t.response_ends_trial&&r()):(i.correct=!1,!t.response_ends_trial&&t.display_feedback==!0&&(h.style.visibility="visible"),t.response_ends_trial&&t.display_feedback==!0?(h.style.visibility="visible",t.force_correct_key_press?this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:r,valid_responses:[t.right_category_key]}):this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:r,valid_responses:t.key_to_move_forward})):t.response_ends_trial&&t.display_feedback!=!0?r():!t.response_ends_trial&&t.display_feedback!=!0):t.stim_key_association=="left"&&(i.rt!==null&&this.jsPsych.pluginAPI.compareKeys(i.key,a)?(i.correct=!0,t.response_ends_trial&&r()):(i.correct=!1,!t.response_ends_trial&&t.display_feedback==!0&&(h.style.visibility="visible"),t.response_ends_trial&&t.display_feedback==!0?(h.style.visibility="visible",t.force_correct_key_press?this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:r,valid_responses:[t.left_category_key]}):this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:r,valid_responses:t.key_to_move_forward})):t.response_ends_trial&&t.display_feedback!=!0?r():!t.response_ends_trial&&t.display_feedback!=!0))};if(t.left_category_key!="NO_KEYS"&&t.right_category_key!="NO_KEYS")var u=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:l,valid_responses:[t.left_category_key,t.right_category_key],rt_method:"performance",persist:!1,allow_held_key:!1});t.trial_duration!==null&&t.response_ends_trial!=!0&&this.jsPsych.pluginAPI.setTimeout(()=>{r()},t.trial_duration)}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s=this.jsPsych.pluginAPI.getValidKey([e.left_category_key,e.right_category_key]),i=e.stim_key_association=="left"?s==e.left_category_key:s==e.right_category_key,r={stimulus:e.stimulus,response:s,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),correct:i},a=this.jsPsych.pluginAPI.mergeSimulationData(r,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,a),a}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),i.response!==null&&this.jsPsych.pluginAPI.pressKey(i.response,i.rt);const a=i.rt==null?e.trial_duration:i.rt;e.force_correct_key_press?i.correct||this.jsPsych.pluginAPI.pressKey(e.stim_key_association=="left"?e.left_category_key:e.right_category_key,a+this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0)):this.jsPsych.pluginAPI.pressKey(this.jsPsych.pluginAPI.getValidKey(e.key_to_move_forward),a+this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0))}};Gc.info=Xx;let gu=Gc;var eV="2.2.0";const tV={name:"image-button-response",version:eV,parameters:{stimulus:{type:m.IMAGE,default:void 0},stimulus_height:{type:m.INT,default:null},stimulus_width:{type:m.INT,default:null},maintain_aspect_ratio:{type:m.BOOL,default:!0},choices:{type:m.STRING,default:void 0,array:!0},button_html:{type:m.FUNCTION,default:function(n,e){return`<button class="jspsych-btn">${n}</button>`}},prompt:{type:m.HTML_STRING,default:null},stimulus_duration:{type:m.INT,default:null},trial_duration:{type:m.INT,default:null},button_layout:{type:m.STRING,default:"grid"},grid_rows:{type:m.INT,default:1},grid_columns:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0},render_on_canvas:{type:m.BOOL,default:!0},enable_button_after:{type:m.INT,default:0}},data:{stimulus:{type:m.STRING},response:{type:m.INT},rt:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Jc=class Jc{constructor(e){this.jsPsych=e}trial(e,t){const s=V=>{let P,M;return t.stimulus_height!==null?(M=t.stimulus_height,t.stimulus_width==null&&t.maintain_aspect_ratio&&(P=V.naturalWidth*(t.stimulus_height/V.naturalHeight))):M=V.naturalHeight,t.stimulus_width!==null?(P=t.stimulus_width,t.stimulus_height==null&&t.maintain_aspect_ratio&&(M=V.naturalHeight*(t.stimulus_width/V.naturalWidth))):t.stimulus_height!==null&&t.maintain_aspect_ratio||(P=V.naturalWidth),[P,M]};e.innerHTML="";let i,r;const a=t.render_on_canvas?new Image:document.createElement("img");t.render_on_canvas?(r=document.createElement("canvas"),r.style.margin="0",r.style.padding="0",i=r):i=a;const o=()=>{const[V,P]=s(a);t.render_on_canvas?(r.width=V,r.height=P,r.getContext("2d").drawImage(a,0,0,V,P)):(a.style.width=`${V}px`,a.style.height=`${P}px`)};let l=!1;a.onload=()=>{l||o()},a.src=t.stimulus,a.complete&&a.naturalWidth!==0&&(o(),l=!0),i.id="jspsych-image-button-response-stimulus",e.appendChild(i);const u=document.createElement("div");if(u.id="jspsych-image-button-response-btngroup",t.button_layout==="grid"){if(u.classList.add("jspsych-btn-group-grid"),t.grid_rows===null&&t.grid_columns===null)throw new Error("You cannot set `grid_rows` to `null` without providing a value for `grid_columns`.");const V=t.grid_columns===null?Math.ceil(t.choices.length/t.grid_rows):t.grid_columns,P=t.grid_rows===null?Math.ceil(t.choices.length/t.grid_columns):t.grid_rows;u.style.gridTemplateColumns=`repeat(${V}, 1fr)`,u.style.gridTemplateRows=`repeat(${P}, 1fr)`}else t.button_layout==="flex"&&u.classList.add("jspsych-btn-group-flex");for(const[V,P]of t.choices.entries()){u.insertAdjacentHTML("beforeend",t.button_html(P,V));const M=u.lastChild;M.dataset.choice=V.toString(),M.addEventListener("click",()=>{C(V)})}e.appendChild(u),t.prompt!==null&&e.insertAdjacentHTML("beforeend",t.prompt);var d=performance.now(),h={rt:null,button:null};const f=()=>{var V={rt:h.rt,stimulus:t.stimulus,response:h.button};this.jsPsych.finishTrial(V)};function C(V){var P=performance.now(),M=Math.round(P-d);h.button=parseInt(V),h.rt=M,i.classList.add("responded");for(const X of u.children)X.setAttribute("disabled","disabled");t.response_ends_trial&&f()}function b(){for(var V=document.querySelectorAll("#jspsych-image-button-response-btngroup button"),P=0;P<V.length;P++)V[P].removeAttribute("disabled")}function x(){for(var V=document.querySelectorAll("#jspsych-image-button-response-btngroup button"),P=0;P<V.length;P++)V[P].setAttribute("disabled","disabled")}t.enable_button_after>0&&(x(),this.jsPsych.pluginAPI.setTimeout(()=>{b()},t.enable_button_after)),t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{i.style.visibility="hidden"},t.stimulus_duration),t.trial_duration!==null?this.jsPsych.pluginAPI.setTimeout(()=>{f()},t.trial_duration):t.response_ends_trial===!1&&console.warn("The experiment may be deadlocked. Try setting a trial duration or set response_ends_trial to true.")}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={stimulus:e.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0)+e.enable_button_after,response:this.jsPsych.randomization.randomInt(0,e.choices.length-1)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),i.rt!==null&&this.jsPsych.pluginAPI.clickTarget(r.querySelector(`#jspsych-image-button-response-btngroup [data-choice="${i.response}"]`),i.rt)}};Jc.info=tV;let mu=Jc;var sV="2.1.0";const iV={name:"image-keyboard-response",version:sV,parameters:{stimulus:{type:m.IMAGE,default:void 0},stimulus_height:{type:m.INT,default:null},stimulus_width:{type:m.INT,default:null},maintain_aspect_ratio:{type:m.BOOL,default:!0},choices:{type:m.KEYS,default:"ALL_KEYS"},prompt:{type:m.HTML_STRING,default:null},stimulus_duration:{type:m.INT,default:null},trial_duration:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0},render_on_canvas:{type:m.BOOL,default:!0}},data:{stimulus:{type:m.STRING},response:{type:m.STRING},rt:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Kc=class Kc{constructor(e){this.jsPsych=e}trial(e,t){var s,i;if(t.render_on_canvas){var r=!1;if(e.hasChildNodes())for(;e.firstChild;)e.removeChild(e.firstChild);var a=document.createElement("canvas");a.id="jspsych-image-keyboard-response-stimulus",a.style.margin="0",a.style.padding="0";var o=a.getContext("2d"),l=new Image;l.onload=()=>{r||(b(),o.drawImage(l,0,0,i,s))},l.src=t.stimulus;const b=()=>{t.stimulus_height!==null?(s=t.stimulus_height,t.stimulus_width==null&&t.maintain_aspect_ratio&&(i=l.naturalWidth*(t.stimulus_height/l.naturalHeight))):s=l.naturalHeight,t.stimulus_width!==null?(i=t.stimulus_width,t.stimulus_height==null&&t.maintain_aspect_ratio&&(s=l.naturalHeight*(t.stimulus_width/l.naturalWidth))):t.stimulus_height!==null&&t.maintain_aspect_ratio||(i=l.naturalWidth),a.height=s,a.width=i};b(),e.insertBefore(a,null),l.complete&&Number.isFinite(i)&&Number.isFinite(s)&&(o.drawImage(l,0,0,i,s),r=!0),t.prompt!==null&&e.insertAdjacentHTML("beforeend",t.prompt)}else{var u='<img src="'+t.stimulus+'" id="jspsych-image-keyboard-response-stimulus">';t.prompt!==null&&(u+=t.prompt),e.innerHTML=u;var l=e.querySelector("#jspsych-image-keyboard-response-stimulus");t.stimulus_height!==null?(s=t.stimulus_height,t.stimulus_width==null&&t.maintain_aspect_ratio&&(i=l.naturalWidth*(t.stimulus_height/l.naturalHeight))):s=l.naturalHeight,t.stimulus_width!==null?(i=t.stimulus_width,t.stimulus_height==null&&t.maintain_aspect_ratio&&(s=l.naturalHeight*(t.stimulus_width/l.naturalWidth))):t.stimulus_height!==null&&t.maintain_aspect_ratio||(i=l.naturalWidth),l.style.height=s.toString()+"px",l.style.width=i.toString()+"px"}var d={rt:null,key:null};const h=()=>{typeof C<"u"&&this.jsPsych.pluginAPI.cancelKeyboardResponse(C);var b={rt:d.rt,stimulus:t.stimulus,response:d.key};this.jsPsych.finishTrial(b)};var f=b=>{e.querySelector("#jspsych-image-keyboard-response-stimulus").className+=" responded",d.key==null&&(d=b),t.response_ends_trial&&h()};if(t.choices!="NO_KEYS")var C=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:f,valid_responses:t.choices,rt_method:"performance",persist:!1,allow_held_key:!1});t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector("#jspsych-image-keyboard-response-stimulus").style.visibility="hidden"},t.stimulus_duration),t.trial_duration!==null?this.jsPsych.pluginAPI.setTimeout(()=>{h()},t.trial_duration):t.response_ends_trial===!1&&console.warn("The experiment may be deadlocked. Try setting a trial duration or set response_ends_trial to true.")}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),i.rt!==null&&this.jsPsych.pluginAPI.pressKey(i.response,i.rt)}create_simulation_data(e,t){const s={stimulus:e.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0),response:this.jsPsych.pluginAPI.getValidKey(e.choices)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}};Kc.info=iV;let fu=Kc;var rV="2.1.0";const nV={name:"image-slider-response",version:rV,parameters:{stimulus:{type:m.IMAGE,default:void 0},stimulus_height:{type:m.INT,default:null},stimulus_width:{type:m.INT,default:null},maintain_aspect_ratio:{type:m.BOOL,default:!0},min:{type:m.INT,default:0},max:{type:m.INT,default:100},slider_start:{type:m.INT,default:50},step:{type:m.INT,default:1},labels:{type:m.STRING,default:[],array:!0},slider_width:{type:m.INT,default:null},button_label:{type:m.STRING,default:"Continue",array:!1},require_movement:{type:m.BOOL,default:!1},prompt:{type:m.HTML_STRING,default:null},stimulus_duration:{type:m.INT,default:null},trial_duration:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0},render_on_canvas:{type:m.BOOL,default:!0}},data:{stimulus:{type:m.STRING},response:{type:m.INT},rt:{type:m.INT},slider_start:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Zc=class Zc{constructor(e){this.jsPsych=e}trial(e,t){var s,i,r,a=7.5;if(t.render_on_canvas){var o=!1;if(e.hasChildNodes())for(;e.firstChild;)e.removeChild(e.firstChild);var l=document.createElement("div");l.id="jspsych-image-slider-response-wrapper",l.style.margin="100px 0px";var u=document.createElement("canvas");u.id="jspsych-image-slider-response-stimulus",u.style.margin="0",u.style.padding="0";var d=u.getContext("2d"),h=new Image;h.onload=()=>{o||(J(),d.drawImage(h,0,0,i,s))},h.src=t.stimulus;const J=()=>{t.stimulus_height!==null?(s=t.stimulus_height,t.stimulus_width==null&&t.maintain_aspect_ratio&&(i=h.naturalWidth*(t.stimulus_height/h.naturalHeight))):s=h.naturalHeight,t.stimulus_width!==null?(i=t.stimulus_width,t.stimulus_height==null&&t.maintain_aspect_ratio&&(s=h.naturalHeight*(t.stimulus_width/h.naturalWidth))):t.stimulus_height!==null&&t.maintain_aspect_ratio||(i=h.naturalWidth),u.height=s,u.width=i};J();var f=document.createElement("div");f.classList.add("jspsych-image-slider-response-container"),f.style.position="relative",f.style.margin="0 auto 3em auto",t.slider_width!==null&&(f.style.width=t.slider_width.toString()+"px"),r='<input type="range" class="jspsych-slider" value="'+t.slider_start+'" min="'+t.min+'" max="'+t.max+'" step="'+t.step+'" id="jspsych-image-slider-response-response"></input>',r+="<div>";for(var C=0;C<t.labels.length;C++){var b=100/(t.labels.length-1),x=C*(100/(t.labels.length-1)),V=(x-50)/50*100,P=V*a/100;r+='<div style="border: 1px solid transparent; display: inline-block; position: absolute; left:calc('+x+"% - ("+b+"% / 2) - "+P+"px); text-align: center; width: "+b+'%;">',r+='<span style="text-align: center; font-size: 80%;">'+t.labels[C]+"</span>",r+="</div>"}r+="</div>",f.innerHTML=r,l.insertBefore(u,l.firstElementChild),l.insertBefore(f,u.nextElementSibling),e.insertBefore(l,null),h.complete&&Number.isFinite(i)&&Number.isFinite(s)&&(d.drawImage(h,0,0,i,s),o=!0),t.prompt!==null&&e.insertAdjacentHTML("beforeend",t.prompt);var M=document.createElement("button");M.id="jspsych-image-slider-response-next",M.classList.add("jspsych-btn"),M.disabled=!!t.require_movement,M.innerHTML=t.button_label,e.insertBefore(M,e.nextElementSibling)}else{r='<div id="jspsych-image-slider-response-wrapper" style="margin: 100px 0px;">',r+='<div id="jspsych-image-slider-response-stimulus">',r+='<img src="'+t.stimulus+'" style="',t.stimulus_height!==null&&(r+="height:"+t.stimulus_height+"px; ",t.stimulus_width==null&&t.maintain_aspect_ratio&&(r+="width: auto; ")),t.stimulus_width!==null&&(r+="width:"+t.stimulus_width+"px; ",t.stimulus_height==null&&t.maintain_aspect_ratio&&(r+="height: auto; ")),r+='"></img>',r+="</div>",r+='<div class="jspsych-image-slider-response-container" style="position:relative; margin: 0 auto 3em auto; width:',t.slider_width!==null?r+=t.slider_width+"px;":r+="auto;",r+='">',r+='<input type="range" class="jspsych-slider" value="'+t.slider_start+'" min="'+t.min+'" max="'+t.max+'" step="'+t.step+'" id="jspsych-image-slider-response-response"></input>',r+="<div>";for(var C=0;C<t.labels.length;C++){var b=100/(t.labels.length-1),x=C*(100/(t.labels.length-1)),V=(x-50)/50*100,P=V*a/100;r+='<div style="border: 1px solid transparent; display: inline-block; position: absolute; left:calc('+x+"% - ("+b+"% / 2) - "+P+"px); text-align: center; width: "+b+'%;">',r+='<span style="text-align: center; font-size: 80%;">'+t.labels[C]+"</span>",r+="</div>"}r+="</div>",r+="</div>",r+="</div>",t.prompt!==null&&(r+=t.prompt),r+='<button id="jspsych-image-slider-response-next" class="jspsych-btn" '+(t.require_movement?"disabled":"")+">"+t.button_label+"</button>",e.innerHTML=r;var h=e.querySelector("img");t.stimulus_height!==null?(s=t.stimulus_height,t.stimulus_width==null&&t.maintain_aspect_ratio&&(i=h.naturalWidth*(t.stimulus_height/h.naturalHeight))):s=h.naturalHeight,t.stimulus_width!==null?(i=t.stimulus_width,t.stimulus_height==null&&t.maintain_aspect_ratio&&(s=h.naturalHeight*(t.stimulus_width/h.naturalWidth))):t.stimulus_height!==null&&t.maintain_aspect_ratio||(i=h.naturalWidth),h.style.height=s.toString()+"px",h.style.width=i.toString()+"px"}var X={rt:null,response:null};if(t.require_movement){const J=()=>{e.querySelector("#jspsych-image-slider-response-next").disabled=!1};e.querySelector("#jspsych-image-slider-response-response").addEventListener("mousedown",J),e.querySelector("#jspsych-image-slider-response-response").addEventListener("touchstart",J),e.querySelector("#jspsych-image-slider-response-response").addEventListener("change",J)}const N=()=>{var J={rt:X.rt,stimulus:t.stimulus,slider_start:t.slider_start,response:X.response};this.jsPsych.finishTrial(J)};e.querySelector("#jspsych-image-slider-response-next").addEventListener("click",()=>{var J=performance.now();X.rt=Math.round(J-W),X.response=e.querySelector("#jspsych-image-slider-response-response").valueAsNumber,t.response_ends_trial?N():e.querySelector("#jspsych-image-slider-response-next").disabled=!0}),t.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector("#jspsych-image-slider-response-stimulus").style.visibility="hidden"},t.stimulus_duration),t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{N()},t.trial_duration);var W=performance.now()}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={stimulus:e.stimulus,slider_start:e.slider_start,response:this.jsPsych.randomization.randomInt(e.min,e.max),rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();if(this.trial(r,e),s(),i.rt!==null){const a=r.querySelector("input[type='range']");setTimeout(()=>{this.jsPsych.pluginAPI.clickTarget(a),a.valueAsNumber=i.response},i.rt/2),this.jsPsych.pluginAPI.clickTarget(r.querySelector("button"),i.rt)}}};Zc.info=nV;let yu=Zc;var aV="2.1.0";const oV={name:"initialize-camera",version:aV,parameters:{device_select_message:{type:m.HTML_STRING,default:"<p>Please select the camera you would like to use.</p>"},button_label:{type:m.STRING,default:"Use this camera"},include_audio:{type:m.BOOL,default:!1},width:{type:m.INT,default:null},height:{type:m.INT,default:null},mime_type:{type:m.STRING,default:null}},data:{device_id:{type:m.STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Yc=class Yc{constructor(e){this.jsPsych=e}trial(e,t){this.run_trial(e,t).then(s=>{this.jsPsych.finishTrial({device_id:s})})}async run_trial(e,t){await this.askForPermission(t),this.showCameraSelection(e,t),this.updateDeviceList(e),navigator.mediaDevices.ondevicechange=o=>{this.updateDeviceList(e)};const s=await this.waitForSelection(e),i={video:{deviceId:s}};t.width&&(i.video.width=t.width),t.height&&(i.video.height=t.height),t.include_audio&&(i.audio=!0);const r=await navigator.mediaDevices.getUserMedia(i),a={};return t.mime_type&&(a.mimeType=t.mime_type),this.jsPsych.pluginAPI.initializeCameraRecorder(r,a),s}async askForPermission(e){return await navigator.mediaDevices.getUserMedia({audio:e.include_audio,video:!0})}showCameraSelection(e,t){let s=`
      ${t.device_select_message}
      <select name="camera" id="which-camera" style="font-size:14px; font-family: 'Open Sans', 'Arial', sans-serif; padding: 4px;">
      </select>
      <p><button class="jspsych-btn" id="btn-select-camera">${t.button_label}</button></p>`;e.innerHTML=s}waitForSelection(e){return new Promise(t=>{e.querySelector("#btn-select-camera").addEventListener("click",()=>{const s=e.querySelector("#which-camera").value;t(s)})})}updateDeviceList(e){navigator.mediaDevices.enumerateDevices().then(t=>{const i=t.filter(r=>r.kind==="videoinput"&&r.deviceId!=="default"&&r.deviceId!=="communications").filter((r,a,o)=>o.findIndex(l=>l.groupId==r.groupId)==a);e.querySelector("#which-camera").innerHTML="",i.forEach(r=>{let a=document.createElement("option");a.value=r.deviceId,a.innerHTML=r.label,e.querySelector("#which-camera").appendChild(a)})})}};Yc.info=oV;let vu=Yc;var lV="2.1.0";const uV={name:"initialize-microphone",version:lV,parameters:{device_select_message:{type:m.HTML_STRING,default:"<p>Please select the microphone you would like to use.</p>"},button_label:{type:m.STRING,default:"Use this microphone"}},data:{device_id:{type:m.STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Xc=class Xc{constructor(e){this.jsPsych=e}trial(e,t){this.run_trial(e,t).then(s=>{this.jsPsych.finishTrial({device_id:s})})}async run_trial(e,t){await this.askForPermission(),this.showMicrophoneSelection(e,t),this.updateDeviceList(e),navigator.mediaDevices.ondevicechange=r=>{this.updateDeviceList(e)};const s=await this.waitForSelection(e),i=await navigator.mediaDevices.getUserMedia({audio:{deviceId:s}});return this.jsPsych.pluginAPI.initializeMicrophoneRecorder(i),s}async askForPermission(){return await navigator.mediaDevices.getUserMedia({audio:!0,video:!1})}showMicrophoneSelection(e,t){let s=`
      ${t.device_select_message}
      <select name="mic" id="which-mic" style="font-size:14px; font-family: 'Open Sans', 'Arial', sans-serif; padding: 4px;">
      </select>
      <p><button class="jspsych-btn" id="btn-select-mic">${t.button_label}</button></p>`;e.innerHTML=s}waitForSelection(e){return new Promise(t=>{e.querySelector("#btn-select-mic").addEventListener("click",()=>{const s=e.querySelector("#which-mic").value;t(s)})})}updateDeviceList(e){navigator.mediaDevices.enumerateDevices().then(t=>{const i=t.filter(r=>r.kind==="audioinput"&&r.deviceId!=="default"&&r.deviceId!=="communications").filter((r,a,o)=>o.findIndex(l=>l.groupId==r.groupId)==a);e.querySelector("#which-mic").innerHTML="",i.forEach(r=>{let a=document.createElement("option");a.value=r.deviceId,a.innerHTML=r.label,e.querySelector("#which-mic").appendChild(a)})})}};Xc.info=uV;let Cu=Xc;var hV="2.1.0";const dV={name:"instructions",version:hV,parameters:{pages:{type:m.HTML_STRING,default:void 0,array:!0},key_forward:{type:m.KEY,default:"ArrowRight"},key_backward:{type:m.KEY,default:"ArrowLeft"},allow_backward:{type:m.BOOL,default:!0},allow_keys:{type:m.BOOL,default:!0},show_clickable_nav:{type:m.BOOL,default:!1},show_page_number:{type:m.BOOL,default:!1},page_label:{type:m.STRING,default:"Page"},button_label_previous:{type:m.STRING,default:"Previous"},button_label_next:{type:m.STRING,default:"Next"},on_page_change:{type:m.FUNCTION,pretty_name:"Page change callback",default:function(n){}}},data:{view_history:{type:m.COMPLEX,array:!0,nested:{page_index:{type:m.INT},viewing_time:{type:m.INT}}},rt:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},ep=class ep{constructor(e){this.jsPsych=e}trial(e,t){var s=0,i=[],r=performance.now(),a=r;function o(){this.id==="jspsych-instructions-back"?d():this.id==="jspsych-instructions-next"&&u()}function l(){var x=t.pages[s],V="";if(t.show_page_number&&(V="<span style='margin: 0 1em;' class='jspsych-instructions-pagenum'>"+t.page_label+" "+(s+1)+"/"+t.pages.length+"</span>"),t.show_clickable_nav){var P="<div class='jspsych-instructions-nav' style='padding: 10px 0px;'>";if(t.allow_backward){var M=s>0?"":"disabled='disabled'";P+="<button id='jspsych-instructions-back' class='jspsych-btn' style='margin-right: 5px;' "+M+">&lt; "+t.button_label_previous+"</button>"}t.pages.length>1&&t.show_page_number&&(P+=V),P+="<button id='jspsych-instructions-next' class='jspsych-btn'style='margin-left: 5px;'>"+t.button_label_next+" &gt;</button></div>",x+=P,e.innerHTML=x,s!=0&&t.allow_backward&&e.querySelector("#jspsych-instructions-back").addEventListener("click",o,{once:!0}),e.querySelector("#jspsych-instructions-next").addEventListener("click",o,{once:!0})}else t.show_page_number&&t.pages.length>1&&(x+="<div class='jspsych-instructions-pagenum'>"+V+"</div>"),e.innerHTML=x}function u(){h(),s++,s>=t.pages.length?f():l(),t.on_page_change(s)}function d(){h(),s--,l(),t.on_page_change(s)}function h(){var x=performance.now(),V=Math.round(x-a);i.push({page_index:s,viewing_time:V}),a=x}const f=()=>{t.allow_keys&&this.jsPsych.pluginAPI.cancelKeyboardResponse(b);var x={view_history:i,rt:Math.round(performance.now()-r)};this.jsPsych.finishTrial(x)},C=x=>{b=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:C,valid_responses:[t.key_forward,t.key_backward],rt_method:"performance",persist:!1,allow_held_key:!1}),this.jsPsych.pluginAPI.compareKeys(x.key,t.key_backward)&&s!==0&&t.allow_backward&&d(),this.jsPsych.pluginAPI.compareKeys(x.key,t.key_forward)&&u()};if(l(),t.allow_keys)var b=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:C,valid_responses:[t.key_forward,t.key_backward],rt_method:"performance",persist:!1})}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){let s=0,i=0,r=[];if(!t.data?.view_history&&!t.data?.rt)for(;s!==e.pages.length;){const l=Math.round(this.jsPsych.randomization.sampleExGaussian(3e3,300,.0033333333333333335));r.push({page_index:s,viewing_time:l}),i+=l,s==0||!e.allow_backward||this.jsPsych.randomization.sampleBernoulli(.9)==1?s++:s--}if(!t.data?.view_history&&t.data?.rt){for(i=t.data.rt;s!==e.pages.length;)r.push({page_index:s,viewing_time:null}),s==0||!e.allow_backward||this.jsPsych.randomization.sampleBernoulli(.9)==1?s++:s--;const l=t.data.rt/r.length;let u=0;for(const f of r){const C=Math.round(this.jsPsych.randomization.sampleExGaussian(l,l/10,1/(l/10)));f.viewing_time=C,u+=C}const d=t.data.rt-u,h=Math.round(d/r.length);for(const f of r)f.viewing_time+=h}if(t.data?.view_history&&!t.data?.rt){r=t.data.view_history,i=0;for(const l of t.data.view_history)i+=l.viewing_time}const a={view_history:r,rt:i},o=this.jsPsych.pluginAPI.mergeSimulationData(a,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,o),o}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s();const a=d=>{e.allow_keys?this.jsPsych.pluginAPI.pressKey(e.key_forward,d):e.show_clickable_nav&&this.jsPsych.pluginAPI.clickTarget(r.querySelector("#jspsych-instructions-next"),d)},o=d=>{e.allow_keys?this.jsPsych.pluginAPI.pressKey(e.key_backward,d):e.show_clickable_nav&&this.jsPsych.pluginAPI.clickTarget(r.querySelector("#jspsych-instructions-back"),d)};let l=0,u=0;for(let d=0;d<i.view_history.length;d++)d==i.view_history.length-1?a(u+i.view_history[d].viewing_time):(i.view_history[d+1].page_index>l&&a(u+i.view_history[d].viewing_time),i.view_history[d+1].page_index<l&&o(u+i.view_history[d].viewing_time),u+=i.view_history[d].viewing_time,l=i.view_history[d+1].page_index)}};ep.info=dV;let bu=ep;var cV="2.1.0";const pV={name:"maxdiff",version:cV,parameters:{alternatives:{type:m.STRING,array:!0,default:void 0},labels:{type:m.STRING,array:!0,default:void 0},randomize_alternative_order:{type:m.BOOL,default:!1},preamble:{type:m.HTML_STRING,default:""},button_label:{type:m.STRING,default:"Continue"},required:{type:m.BOOL,default:!1}},data:{rt:{type:m.INT},labels:{type:m.COMPLEX,nested:{left:{type:m.STRING},right:{type:m.STRING}}},response:{type:m.COMPLEX,nested:{left:{type:m.STRING},right:{type:m.STRING}}}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},tp=class tp{constructor(e){this.jsPsych=e}trial(e,t){var s="";s+='<style id="jspsych-maxdiff-css">',s+=".jspsych-maxdiff-statement {display:block; font-size: 16px; padding-top: 40px; margin-bottom:10px;}table.jspsych-maxdiff-table {border-collapse: collapse; padding: 15px; margin-left: auto; margin-right: auto;}table.jspsych-maxdiff-table td, th {border-bottom: 1px solid #dddddd; text-align: center; padding: 8px;}table.jspsych-maxdiff-table tr:nth-child(even) {background-color: #dddddd;}",s+="</style>",t.preamble!==null&&(s+='<div id="jspsych-maxdiff-preamble" class="jspsych-maxdiff-preamble">'+t.preamble+"</div>"),s+='<form id="jspsych-maxdiff-form">';for(var i=[],r=0;r<t.alternatives.length;r++)i.push(r);t.randomize_alternative_order&&(i=this.jsPsych.randomization.shuffle(i));for(var a='<table class="jspsych-maxdiff-table"><tr><th id="jspsych-maxdiff-left-label">'+t.labels[0]+'</th><th></th><th id="jspsych-maxdiff-right-label">'+t.labels[1]+"</th></tr>",r=0;r<t.alternatives.length;r++){var o=t.alternatives[i[r]];a+='<tr><td><input class= "jspsych-maxdiff-alt-'+r.toString()+'" type="radio" name="left" data-name = '+i[r].toString()+" /><br></td>",a+='<td id="jspsych-maxdiff-alternative-'+r.toString()+'">'+o+"</td>",a+='<td><input class= "jspsych-maxdiff-alt-'+r.toString()+'" type="radio" name="right" data-name = '+i[r].toString()+" /><br></td></tr>"}a+="</table><br><br>",s+=a;var l=t.required==!0?'disabled = "disabled"':"";s+='<input type="submit" id="jspsych-maxdiff-next" class="jspsych-maxdiff jspsych-btn" '+l+' value="'+t.button_label+'"></input>',s+="</form>",e.innerHTML=s,["left","right"].forEach(h=>{document.getElementsByName(h).forEach(f=>{f.addEventListener("click",()=>{var C=f.name=="left"?"right":"left",b=document.getElementsByClassName(f.className).namedItem(C);if(b.checked&&(b.checked=!1),t.required){var x=Array.prototype.slice.call(document.getElementsByName("left")).some(P=>P.checked),V=Array.prototype.slice.call(document.getElementsByName("right")).some(P=>P.checked);x&&V?document.getElementById("jspsych-maxdiff-next").disabled=!1:document.getElementById("jspsych-maxdiff-next").disabled=!0}})})}),e.querySelector("#jspsych-maxdiff-form").addEventListener("submit",h=>{h.preventDefault();var f=performance.now(),C=Math.round(f-d);function b(V){var P=e.querySelectorAll('[name="'+V+'"]:checked')[0];if(P===void 0)return null;var M=parseInt(P.getAttribute("data-name"));return t.alternatives[M]}var x={rt:C,labels:{left:t.labels[0],right:t.labels[1]},response:{left:b("left"),right:b("right")}};this.jsPsych.finishTrial(x)});var d=performance.now()}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s=this.jsPsych.randomization.sampleWithoutReplacement(e.alternatives,2),i={left:null,right:null};!e.required&&this.jsPsych.randomization.sampleBernoulli(.1)&&(s.pop(),this.jsPsych.randomization.sampleBernoulli(.8)&&s.pop()),s.length==1&&(this.jsPsych.randomization.sampleBernoulli(.5)?i.left=s[0]:i.right=s[0]),s.length==2&&(i.left=s[0],i.right=s[1]);const r={rt:this.jsPsych.randomization.sampleExGaussian(3e3,300,1/300,!0),labels:e.labels,response:i},a=this.jsPsych.pluginAPI.mergeSimulationData(r,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,a),a}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s();const a=[...r.querySelectorAll("[id^=jspsych-maxdiff-alternative]")].map(o=>o.innerHTML);if(i.response.left!==null){const o=a.indexOf(i.response.left);this.jsPsych.pluginAPI.clickTarget(r.querySelector(`.jspsych-maxdiff-alt-${o}[name="left"]`),i.rt/3)}if(i.response.right!==null){const o=a.indexOf(i.response.right);this.jsPsych.pluginAPI.clickTarget(r.querySelector(`.jspsych-maxdiff-alt-${o}[name="right"]`),i.rt/3*2)}this.jsPsych.pluginAPI.clickTarget(r.querySelector("#jspsych-maxdiff-next"),i.rt)}};tp.info=pV;let wu=tp;var gV="2.1.0";const mV={name:"mirror-camera",version:gV,parameters:{prompt:{type:m.HTML_STRING,default:null},button_label:{type:m.STRING,default:"Continue"},height:{type:m.INT,default:null},width:{type:m.INT,default:null},mirror_camera:{type:m.BOOL,default:!0}},data:{rt:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},sp=class sp{constructor(e){this.jsPsych=e}trial(e,t){this.stream=this.jsPsych.pluginAPI.getCameraStream(),e.innerHTML=`
      <video autoplay playsinline id="jspsych-mirror-camera-video" width="${t.width?t.width:"auto"}" height="${t.height?t.height:"auto"}" ${t.mirror_camera?'style="transform: rotateY(180deg);"':""}></video>
      ${t.prompt?`<div id="jspsych-mirror-camera-prompt">${t.prompt}</div>`:""}
      <p><button class="jspsych-btn" id="btn-continue">${t.button_label}</button></p>
    `,e.querySelector("#jspsych-mirror-camera-video").srcObject=this.stream,e.querySelector("#btn-continue").addEventListener("click",()=>{this.finish(e)}),this.start_time=performance.now()}finish(e){this.jsPsych.finishTrial({rt:performance.now()-this.start_time})}};sp.info=mV;let xu=sp;var fV="2.1.0";const yV={name:"preload",version:fV,parameters:{auto_preload:{type:m.BOOL,default:!1},trials:{type:m.TIMELINE,default:[]},images:{type:m.STRING,default:[],array:!0},audio:{type:m.STRING,default:[],array:!0},video:{type:m.STRING,default:[],array:!0},message:{type:m.HTML_STRING,default:null},show_progress_bar:{type:m.BOOL,default:!0},continue_after_error:{type:m.BOOL,default:!1},error_message:{type:m.HTML_STRING,default:"The experiment failed to load."},show_detailed_errors:{type:m.BOOL,default:!1},max_load_time:{type:m.INT,default:null},on_error:{type:m.FUNCTION,default:null},on_success:{type:m.FUNCTION,default:null}},data:{success:{type:m.BOOL},timeout:{type:m.BOOL},failed_images:{type:m.STRING,array:!0},failed_audio:{type:m.STRING,array:!0},failed_video:{type:m.STRING,array:!0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},ip=class ip{constructor(e){this.jsPsych=e}trial(e,t){var s=null,i=!1,r=[],a=[],o=[],l=[],u=this.jsPsych.getSafeModeStatus(),d=[],h=[],f=[];if(t.auto_preload){var C=this.jsPsych.getTimeline(),b=this.jsPsych.pluginAPI.getAutoPreloadList(C);d=d.concat(b.images),h=h.concat(b.audio),f=f.concat(b.video)}if(t.trials.length>0){var x=this.jsPsych.pluginAPI.getAutoPreloadList(t.trials);d=d.concat(x.images),h=h.concat(x.audio),f=f.concat(x.video)}d=d.concat(t.images),h=h.concat(t.audio),f=f.concat(t.video),d=this.jsPsych.utils.unique(d.flat()),h=this.jsPsych.utils.unique(h.flat()),f=this.jsPsych.utils.unique(f.flat()),u&&(f=[]);var V="";t.message!==null&&(V+=t.message),t.show_progress_bar&&(V+=`
            <div id='jspsych-loading-progress-bar-container' style='height: 10px; width: 300px; background-color: #ddd; margin: auto;'>
              <div id='jspsych-loading-progress-bar' style='height: 10px; width: 0%; background-color: #777;'></div>
            </div>`),e.innerHTML=V;const P=()=>{if(ie++,t.show_progress_bar){var F=ie/J*100,Z=e.querySelector("#jspsych-loading-progress-bar");Z!==null&&(Z.style.width=F+"%")}},M=()=>{typeof i<"u"&&i===!1&&(this.jsPsych.pluginAPI.clearAllTimeouts(),this.jsPsych.pluginAPI.cancelPreloads(),s=!0,W())},X=()=>{this.jsPsych.pluginAPI.cancelPreloads(),typeof s<"u"&&(s===!1||s===null)&&(i=!0,ne<J&&(s=!1),le("timeout"),l.push("<p><strong>Loading timed out.</strong><br>Consider compressing your stimuli files, loading your files in smaller batches,<br>and/or increasing the <i>max_load_time</i> parameter.</p>"),t.continue_after_error?W():N())},N=()=>{this.jsPsych.pluginAPI.clearAllTimeouts(),this.jsPsych.pluginAPI.cancelPreloads(),e.innerHTML=t.error_message,t.show_detailed_errors&&(e.innerHTML+="<p><strong>Error details:</strong></p>",l.forEach(F=>{e.innerHTML+=F}))},W=()=>{var F={success:s,timeout:i,failed_images:r,failed_audio:a,failed_video:o};this.jsPsych.finishTrial(F)};t.max_load_time!==null&&this.jsPsych.pluginAPI.setTimeout(X,t.max_load_time);var J=d.length+h.length+f.length,ie=0,ne=0;if(J==0)M();else{const F=ue=>{this.jsPsych.pluginAPI.preloadVideo(f,ue,ye,ce)},Z=ue=>{this.jsPsych.pluginAPI.preloadAudio(h,ue,ye,ce)},ae=ue=>{this.jsPsych.pluginAPI.preloadImages(d,ue,ye,ce)};f.length>0&&F(()=>{}),h.length>0&&Z(()=>{}),d.length>0&&ae(()=>{})}function ce(F){P(),s==null&&(s=!1);var Z="unknown file";F.source&&(Z=F.source),F.error&&F.error.path&&F.error.path.length>0&&(F.error.path[0].localName=="img"?r.push(Z):F.error.path[0].localName=="audio"?a.push(Z):F.error.path[0].localName=="video"&&o.push(Z));var ae="<p><strong>Error loading file: "+Z+"</strong><br>";F.error.statusText&&(ae+="File request response status: "+F.error.statusText+"<br>"),F.error=="404"&&(ae+="404 - file not found.<br>"),typeof F.error.loaded<"u"&&F.error.loaded!==null&&F.error.loaded!==0?ae+=F.error.loaded+" bytes transferred.":ae+="File did not begin loading. Check that file path is correct and reachable by the browser,<br>and that loading is not blocked by cross-origin resource sharing (CORS) errors.",ae+="</p>",l.push(ae),le(Z),ie==J&&(t.continue_after_error?W():N())}function ye(F){P(),be(F),ne++,ne==J?M():ie==J&&(t.continue_after_error?W():N())}function le(F){t.on_error!==null&&t.on_error(F)}function be(F){t.on_success!==null&&t.on_success(F)}}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={success:!0,timeout:!1,failed_images:[],failed_audio:[],failed_video:[]};return this.jsPsych.pluginAPI.mergeSimulationData(s,t)}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.jsPsych.getDisplayElement();this.trial(i,e),s()}};ip.info=yV;let Vu=ip;var vV="2.1.0";const CV={name:"reconstruction",version:vV,parameters:{stim_function:{type:m.FUNCTION,default:void 0},starting_value:{type:m.FLOAT,default:.5},step_size:{type:m.FLOAT,default:.05},key_increase:{type:m.KEY,default:"h"},key_decrease:{type:m.KEY,default:"g"},button_label:{type:m.STRING,default:"Continue"}},data:{start_value:{type:m.INT},final_value:{type:m.INT},rt:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},rp=class rp{constructor(e){this.jsPsych=e}trial(e,t){var s=t.starting_value;const i=()=>{var u=performance.now(),d=Math.round(u-l);this.jsPsych.pluginAPI.cancelKeyboardResponse(o);var h={rt:d,final_value:s,start_value:t.starting_value};this.jsPsych.finishTrial(h)},r=u=>{e.innerHTML='<div id="jspsych-reconstruction-stim-container">'+t.stim_function(u)+"</div>",e.innerHTML+='<button id="jspsych-reconstruction-next" class="jspsych-btn jspsych-reconstruction">'+t.button_label+"</button>",e.querySelector("#jspsych-reconstruction-next").addEventListener("click",i)},a=u=>{var d=t.key_increase,h=t.key_decrease;this.jsPsych.pluginAPI.compareKeys(u.key,d)?s=s+t.step_size:this.jsPsych.pluginAPI.compareKeys(u.key,h)&&(s=s-t.step_size),s=Math.max(Math.min(1,s),0),r(s)};var o=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:a,valid_responses:[t.key_increase,t.key_decrease],rt_method:"performance",persist:!0,allow_held_key:!0});r(s);var l=performance.now()}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={rt:this.jsPsych.randomization.sampleExGaussian(2e3,200,.005,!0),start_value:e.starting_value,final_value:this.jsPsych.randomization.randomInt(0,Math.round(1/e.step_size))*e.step_size},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s();let a=Math.round((i.final_value-e.starting_value)/e.step_size);const o=(i.rt-300)/a;let l=0;for(;a!=0;)a>0?(this.jsPsych.pluginAPI.pressKey(e.key_increase,l+o),a--):(this.jsPsych.pluginAPI.pressKey(e.key_decrease,l+o),a++),l+=o;this.jsPsych.pluginAPI.clickTarget(r.querySelector("#jspsych-reconstruction-next"),i.rt)}};rp.info=CV;let Pu=rp;var bV="2.1.0";const wV={name:"resize",version:bV,parameters:{item_height:{type:m.INT,default:1},item_width:{type:m.INT,default:1},prompt:{type:m.HTML_STRING,default:null},pixels_per_unit:{type:m.INT,default:100},starting_size:{type:m.INT,default:100},button_label:{type:m.STRING,default:"Continue"}},data:{final_width_px:{type:m.INT},scale_factor:{type:m.FLOAT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},np=class np{constructor(e){this.jsPsych=e}trial(e,t){var s=t.item_width/t.item_height;if(t.item_width>=t.item_height)var i=t.starting_size,r=Math.round(t.starting_size/s);else var r=t.starting_size,i=Math.round(t.starting_size*s);var a='<div id="jspsych-resize-div" style="border: 2px solid steelblue; height: '+r+"px; width:"+i+'px; margin: 7px auto; background-color: lightsteelblue; position: relative;">';a+='<div id="jspsych-resize-handle" style="cursor: nwse-resize; background-color: steelblue; width: 10px; height: 10px; border: 2px solid lightsteelblue; position: absolute; bottom: 0; right: 0;"></div>',a+="</div>",t.prompt!==null&&(a+=t.prompt),a+='<a class="jspsych-btn" id="jspsych-resize-btn">'+t.button_label+"</a>",e.innerHTML=a;const o=()=>{document.removeEventListener("mousemove",V),document.removeEventListener("mouseup",b);var W={final_height_px:M,final_width_px:X,scale_factor:P};this.jsPsych.finishTrial(W)};document.getElementById("jspsych-resize-btn").addEventListener("click",()=>{N(),o()});var l=!1,u,d,h,f,C=W=>{W.preventDefault(),l=!0,u=W.pageX,d=W.pageY,h=parseInt(x.style.width),f=parseInt(x.style.height)};e.querySelector("#jspsych-resize-handle").addEventListener("mousedown",C);var b=W=>{l=!1};document.addEventListener("mouseup",b);var x=e.querySelector("#jspsych-resize-div"),V=W=>{if(l){var J=W.pageX-u,ie=W.pageY-d;Math.abs(J)>=Math.abs(ie)?(x.style.width=Math.round(Math.max(20,h+J*2))+"px",x.style.height=Math.round(Math.max(20,h+J*2)/s)+"px"):(x.style.height=Math.round(Math.max(20,f+ie*2))+"px",x.style.width=Math.round(s*Math.max(20,f+ie*2))+"px")}};document.addEventListener("mousemove",V);var P,M,X;function N(){X=x.offsetWidth;var W=X/t.item_width;P=W/t.pixels_per_unit,document.getElementById("jspsych-content").style.transform="scale("+P+")"}}};np.info=wV;let Su=np;var xV="2.1.0";const VV={name:"same-different-html",version:xV,parameters:{stimuli:{type:m.HTML_STRING,default:void 0,array:!0},answer:{type:m.SELECT,options:["same","different"],default:void 0},same_key:{type:m.KEY,default:"q"},different_key:{type:m.KEY,default:"p"},first_stim_duration:{type:m.INT,default:1e3},gap_duration:{type:m.INT,default:500},second_stim_duration:{type:m.INT,pretty_name:"Second stimulus duration",default:1e3},prompt:{type:m.HTML_STRING,default:null}},data:{stimulus:{type:m.HTML_STRING,array:!0},response:{type:m.STRING},rt:{type:m.INT},correct:{type:m.BOOL},answer:{type:m.STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},ap=class ap{constructor(e){this.jsPsych=e}trial(e,t){e.innerHTML='<div class="jspsych-same-different-stimulus">'+t.stimuli[0]+"</div>";var s;if(t.first_stim_duration>0)this.jsPsych.pluginAPI.setTimeout(()=>{i()},t.first_stim_duration);else{const a=o=>{s=o,i()};this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:a,valid_responses:"ALL_KEYS",rt_method:"performance",persist:!1,allow_held_key:!1})}const i=()=>{e.innerHTML="",this.jsPsych.pluginAPI.setTimeout(r,t.gap_duration)},r=()=>{var a='<div class="jspsych-same-different-stimulus">'+t.stimuli[1]+"</div>";t.prompt!==null&&(a+=t.prompt),e.innerHTML=a,t.second_stim_duration>0&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector(".jspsych-same-different-stimulus").style.visibility="hidden"},t.second_stim_duration);const o=l=>{var u=!1,d=t.same_key,h=t.different_key;this.jsPsych.pluginAPI.compareKeys(l.key,d)&&t.answer=="same"&&(u=!0),this.jsPsych.pluginAPI.compareKeys(l.key,h)&&t.answer=="different"&&(u=!0);var f={rt:l.rt,answer:t.answer,correct:u,stimulus:[t.stimuli[0],t.stimuli[1]],response:l.key};s&&(f.rt_stim1=s.rt,f.response_stim1=s.key),this.jsPsych.finishTrial(f)};this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:o,valid_responses:[t.same_key,t.different_key],rt_method:"performance",persist:!1,allow_held_key:!1})}}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s=this.jsPsych.pluginAPI.getValidKey([e.same_key,e.different_key]),i={stimuli:e.stimuli,response:s,answer:e.answer,correct:e.answer=="same"?s==e.same_key:s==e.different_key,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0)};e.first_stim_duration==null&&(i.rt_stim1=this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),i.response_stim1=this.jsPsych.pluginAPI.getValidKey([e.same_key,e.different_key]));const r=this.jsPsych.pluginAPI.mergeSimulationData(i,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,r),r}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),e.first_stim_duration==null&&this.jsPsych.pluginAPI.pressKey(i.response_stim1,i.rt_stim1),this.jsPsych.pluginAPI.pressKey(i.response,e.first_stim_duration+e.gap_duration+i.rt)}};ap.info=VV;let Iu=ap;var PV="2.1.0";const SV={name:"same-different-image",version:PV,parameters:{stimuli:{type:m.IMAGE,default:void 0,array:!0},answer:{type:m.SELECT,options:["same","different"],default:void 0},same_key:{type:m.KEY,default:"q"},different_key:{type:m.KEY,default:"p"},first_stim_duration:{type:m.INT,default:1e3},gap_duration:{type:m.INT,default:500},second_stim_duration:{type:m.INT,default:1e3},prompt:{type:m.HTML_STRING,default:null}},data:{stimulus:{type:m.STRING,array:!0},response:{type:m.STRING},rt:{type:m.INT},correct:{type:m.BOOL},answer:{type:m.STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},op=class op{constructor(e){this.jsPsych=e}trial(e,t){const s=()=>{e.innerHTML="",this.jsPsych.pluginAPI.setTimeout(r,t.gap_duration)};e.innerHTML='<img class="jspsych-same-different-stimulus" src="'+t.stimuli[0]+'"></img>';var i;if(t.first_stim_duration>0)this.jsPsych.pluginAPI.setTimeout(s,t.first_stim_duration);else{const a=o=>{i=o,s()};this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:a,valid_responses:"ALL_KEYS",rt_method:"performance",persist:!1,allow_held_key:!1})}const r=()=>{var a='<img class="jspsych-same-different-stimulus" src="'+t.stimuli[1]+'"></img>';t.prompt!==null&&(a+=t.prompt),e.innerHTML=a,t.second_stim_duration>0&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector(".jspsych-same-different-stimulus").style.visibility="hidden"},t.second_stim_duration);const o=l=>{var u=!1,d=t.same_key,h=t.different_key;this.jsPsych.pluginAPI.compareKeys(l.key,d)&&t.answer=="same"&&(u=!0),this.jsPsych.pluginAPI.compareKeys(l.key,h)&&t.answer=="different"&&(u=!0);var f={rt:l.rt,answer:t.answer,correct:u,stimulus:[t.stimuli[0],t.stimuli[1]],response:l.key};i&&(f.rt_stim1=i.rt,f.response_stim1=i.key),this.jsPsych.finishTrial(f)};this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:o,valid_responses:[t.same_key,t.different_key],rt_method:"performance",persist:!1,allow_held_key:!1})}}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s=this.jsPsych.pluginAPI.getValidKey([e.same_key,e.different_key]),i={stimuli:e.stimuli,response:s,answer:e.answer,correct:e.answer=="same"?s==e.same_key:s==e.different_key,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0)};e.first_stim_duration==null&&(i.rt_stim1=this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),i.response_stim1=this.jsPsych.pluginAPI.getValidKey([e.same_key,e.different_key]));const r=this.jsPsych.pluginAPI.mergeSimulationData(i,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,r),r}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),e.first_stim_duration==null&&this.jsPsych.pluginAPI.pressKey(i.response_stim1,i.rt_stim1),this.jsPsych.pluginAPI.pressKey(i.response,e.first_stim_duration+e.gap_duration+i.rt)}};op.info=SV;let Tu=op;var IV="2.1.0";const TV={name:"serial-reaction-time",version:IV,parameters:{grid:{type:m.BOOL,array:!0,default:[[1,1,1,1]]},target:{type:m.INT,array:!0,default:void 0},choices:{type:m.KEYS,array:!0,default:[["3","5","7","9"]]},grid_square_size:{type:m.INT,default:100},target_color:{type:m.STRING,default:"#999"},response_ends_trial:{type:m.BOOL,default:!0},pre_target_duration:{type:m.INT,default:0},trial_duration:{type:m.INT,default:null},show_response_feedback:{type:m.BOOL,default:!1},feedback_duration:{type:m.INT,default:200},fade_duration:{type:m.INT,default:null},prompt:{type:m.HTML_STRING,default:null,no_function:!1}},data:{grid:{type:m.COMPLEX,array:!0},target:{type:m.COMPLEX,array:!0},response:{type:m.STRING,array:!0},rt:{type:m.INT},correct:{type:m.BOOL}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},lp=class lp{constructor(e){this.jsPsych=e,this.stimulus=function(t,s,i,r,a){for(var o="<div id='jspsych-serial-reaction-time-stimulus' style='margin:auto; display: table; table-layout: fixed; border-spacing:"+s/4+"px'>",l=0;l<t.length;l++){o+="<div class='jspsych-serial-reaction-time-stimulus-row' style='display:table-row;'>";for(var u=0;u<t[l].length;u++)o+="<div class='jspsych-serial-reaction-time-stimulus-cell' id='jspsych-serial-reaction-time-stimulus-cell-"+l+"-"+u+"' style='width:"+s+"px; height:"+s+"px; display:table-cell; vertical-align:middle; text-align: center; font-size:"+s/2+"px;",t[l][u]==1&&(o+="border: 2px solid black;"),typeof i<"u"&&i[0]==l&&i[1]==u&&(o+="background-color: "+r+";"),o+="'>",typeof a<"u"&&a[l][u]!==!1&&(o+=a[l][u]),o+="</div>";o+="</div>"}return o+="</div>",o}}trial(e,t){for(var s=t.choices.flat();s.indexOf("")>-1;)s.splice(s.indexOf(""),1);var i,r={rt:null,key:!1,correct:!1};const a=()=>{this.jsPsych.pluginAPI.cancelKeyboardResponse(i);var h={rt:r.rt,response:r.key,correct:r.correct,grid:t.grid,target:t.target};this.jsPsych.finishTrial(h)},o=()=>{if(r.rt==null||t.show_response_feedback==!1)a();else{var h=r.correct?"#0f0":"#f00";e.querySelector("#jspsych-serial-reaction-time-stimulus-cell-"+r.responseLoc[0]+"-"+r.responseLoc[1]).style.transition="",e.querySelector("#jspsych-serial-reaction-time-stimulus-cell-"+r.responseLoc[0]+"-"+r.responseLoc[1]).style.backgroundColor=h,this.jsPsych.pluginAPI.setTimeout(a,t.feedback_duration)}},l=h=>{r=r.rt==null?h:r;for(var f=[],C=0;C<t.choices.length;C++)for(var b=0;b<t.choices[C].length;b++){var x=t.choices[C][b];if(this.jsPsych.pluginAPI.compareKeys(h.key,x)){f=[C,b];break}}r.responseLoc=f,r.correct=JSON.stringify(f)==JSON.stringify(t.target),t.response_ends_trial&&(t.show_response_feedback?o():a())},u=()=>{t.fade_duration==null||(e.querySelector("#jspsych-serial-reaction-time-stimulus-cell-"+t.target[0]+"-"+t.target[1]).style.transition="background-color "+t.fade_duration),e.querySelector("#jspsych-serial-reaction-time-stimulus-cell-"+t.target[0]+"-"+t.target[1]).style.backgroundColor=t.target_color,i=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:l,valid_responses:s,allow_held_key:!1}),t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(o,t.trial_duration)};var d=this.stimulus(t.grid,t.grid_square_size);e.innerHTML=d,t.pre_target_duration<=0?u():this.jsPsych.pluginAPI.setTimeout(u,t.pre_target_duration),t.prompt!==null&&(e.innerHTML+=t.prompt)}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){let s;if(this.jsPsych.randomization.sampleBernoulli(.8)==1)s=e.choices[e.target[0]][e.target[1]];else for(s=this.jsPsych.pluginAPI.getValidKey(e.choices);s==e.choices[e.target[0]][e.target[1]];)s=this.jsPsych.pluginAPI.getValidKey(e.choices);const i={grid:e.grid,target:e.target,response:s,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),correct:s==e.choices[e.target[0]][e.target[1]]},r=this.jsPsych.pluginAPI.mergeSimulationData(i,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,r),r}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),i.rt!==null&&this.jsPsych.pluginAPI.pressKey(i.response,i.rt)}};lp.info=TV;let Eu=lp;var EV="2.1.0";const RV={name:"serial-reaction-time-mouse",version:EV,parameters:{grid:{type:m.BOOL,array:!0,default:[[1,1,1,1]]},target:{type:m.INT,array:!0,default:void 0},grid_square_size:{type:m.INT,default:100},target_color:{type:m.STRING,default:"#999"},response_ends_trial:{type:m.BOOL,default:!0},pre_target_duration:{type:m.INT,default:0},trial_duration:{type:m.INT,default:null},fade_duration:{type:m.INT,default:null},allow_nontarget_responses:{type:m.BOOL,default:!1},prompt:{type:m.HTML_STRING,default:null,no_function:!1}},data:{grid:{type:m.COMPLEX,array:!0},target:{type:m.COMPLEX,array:!0},response:{type:m.INT,array:!0},rt:{type:m.INT},correct:{type:m.BOOL}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},up=class up{constructor(e){this.jsPsych=e}trial(e,t){var s=-1,i={rt:null,row:null,column:null};const r=()=>{var u;t.allow_nontarget_responses?u=e.querySelectorAll(".jspsych-serial-reaction-time-stimulus-cell"):u=[e.querySelector("#jspsych-serial-reaction-time-stimulus-cell-"+t.target[0]+"-"+t.target[1])];for(var d=0;d<u.length;d++)u[d].addEventListener("mousedown",h=>{if(s!=-1){var f={};f.row=h.currentTarget.getAttribute("data-row"),f.column=h.currentTarget.getAttribute("data-column"),f.rt=Math.round(performance.now()-s),l(f)}});s=performance.now(),t.fade_duration==null||(e.querySelector("#jspsych-serial-reaction-time-stimulus-cell-"+t.target[0]+"-"+t.target[1]).style.transition="background-color "+t.fade_duration),e.querySelector("#jspsych-serial-reaction-time-stimulus-cell-"+t.target[0]+"-"+t.target[1]).style.backgroundColor=t.target_color,t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(o,t.trial_duration)};var a=this.stimulus(t.grid,t.grid_square_size);e.innerHTML=a,t.pre_target_duration<=0?r():this.jsPsych.pluginAPI.setTimeout(r,t.pre_target_duration),t.prompt!==null&&e.insertAdjacentHTML("beforeend",t.prompt);const o=()=>{var u={rt:i.rt,grid:t.grid,target:t.target,response:[parseInt(i.row,10),parseInt(i.column,10)],correct:i.row==t.target[0]&&i.column==t.target[1]};this.jsPsych.finishTrial(u)};function l(u){i=i.rt==null?u:i,t.response_ends_trial&&o()}}stimulus(e,t,s,i,r){for(var a="<div id='jspsych-serial-reaction-time-stimulus' style='margin:auto; display: table; table-layout: fixed; border-spacing:"+t/4+"px'>",o=0;o<e.length;o++){a+="<div class='jspsych-serial-reaction-time-stimulus-row' style='display:table-row;'>";for(var l=0;l<e[o].length;l++){var u="jspsych-serial-reaction-time-stimulus-cell";a+="<div class='"+u+"' id='jspsych-serial-reaction-time-stimulus-cell-"+o+"-"+l+"' data-row="+o+" data-column="+l+" style='width:"+t+"px; height:"+t+"px; display:table-cell; vertical-align:middle; text-align: center; cursor: pointer; font-size:"+t/2+"px;",e[o][l]==1&&(a+="border: 2px solid black;"),typeof s<"u"&&s[0]==o&&s[1]==l&&(a+="background-color: "+i+";"),a+="'>",typeof r<"u"&&r[o][l]!==!1&&(a+=r[o][l]),a+="</div>"}a+="</div>"}return a+="</div>",a}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){let s=this.jsPsych.utils.deepCopy(e.target);if(e.allow_nontarget_responses&&this.jsPsych.randomization.sampleBernoulli(.8)!==1)for(;s[0]==e.target[0]&&s[1]==e.target[1];)s[0]==this.jsPsych.randomization.randomInt(0,e.grid.length),s[1]==this.jsPsych.randomization.randomInt(0,e.grid[s[0]].length);const i={grid:e.grid,target:e.target,response:s,rt:e.pre_target_duration+this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),correct:s[0]==e.target[0]&&s[1]==e.target[1]},r=this.jsPsych.pluginAPI.mergeSimulationData(i,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,r),r}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();if(this.trial(r,e),s(),i.rt!==null){const a=r.querySelector(`.jspsych-serial-reaction-time-stimulus-cell[data-row="${i.response[0]}"][data-column="${i.response[1]}"]`);this.jsPsych.pluginAPI.clickTarget(a,i.rt)}}};up.info=RV;let Ru=up;var _V="2.1.0";const LV={name:"sketchpad",version:_V,parameters:{canvas_shape:{type:m.STRING,default:"rectangle"},canvas_width:{type:m.INT,default:500},canvas_height:{type:m.INT,default:500},canvas_diameter:{type:m.INT,default:500},canvas_border_width:{type:m.INT,default:0},canvas_border_color:{type:m.STRING,default:"#000"},background_image:{type:m.IMAGE,default:null},background_color:{type:m.STRING,default:"#ffffff"},stroke_width:{type:m.INT,default:2},stroke_color:{type:m.STRING,default:"#000000"},stroke_color_palette:{type:m.STRING,array:!0,default:[]},prompt:{type:m.HTML_STRING,default:null},prompt_location:{type:m.STRING,default:"abovecanvas"},save_final_image:{type:m.BOOL,default:!0},save_strokes:{type:m.BOOL,default:!0},key_to_draw:{type:m.KEY,default:null},show_finished_button:{type:m.BOOL,default:!0},finished_button_label:{type:m.STRING,default:"Finished"},show_clear_button:{type:m.BOOL,default:!0},clear_button_label:{type:m.STRING,default:"Clear"},show_undo_button:{type:m.BOOL,default:!0},undo_button_label:{type:m.STRING,default:"Undo"},show_redo_button:{type:m.BOOL,default:!0},redo_button_label:{type:m.STRING,default:"Redo"},choices:{type:m.KEYS,default:"NO_KEYS"},trial_duration:{type:m.INT,default:null},show_countdown_trial_duration:{type:m.BOOL,default:!1},countdown_timer_html:{type:m.HTML_STRING,default:'<span id="sketchpad-timer"></span> remaining'}},data:{rt:{type:m.INT},response:{type:m.STRING},png:{type:m.STRING},strokes:{type:m.COMPLEX,array:!0,nested:{action:{type:m.STRING},x:{type:m.INT,optional:!0},y:{type:m.INT,optional:!0},t:{type:m.INT,optional:!0},color:{type:m.STRING,optional:!0}}}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},hp=class hp{constructor(e){this.jsPsych=e,this.is_drawing=!1,this.strokes=[],this.stroke=[],this.undo_history=[],this.mouse_position={x:0,y:0},this.draw_key_held=!1}trial(e,t,s){return this.display=e,this.params=t,this.current_stroke_color=t.stroke_color,this.init_display(),this.setup_event_listeners(),this.add_background_color(),this.add_background_image().then(()=>{s()}),this.start_time=performance.now(),this.set_trial_duration_timer(),new Promise((i,r)=>{this.trial_finished_handler=i})}init_display(){this.add_css();let e;if(this.params.canvas_shape=="rectangle")e=`
        <canvas id="sketchpad-canvas" 
        width="${this.params.canvas_width}" 
        height="${this.params.canvas_height}" 
        class="sketchpad-rectangle"></canvas>
      `;else if(this.params.canvas_shape=="circle")e=`
        <canvas id="sketchpad-canvas" 
        width="${this.params.canvas_diameter}" 
        height="${this.params.canvas_diameter}" 
        class="sketchpad-circle">
        </canvas>
      `;else throw new Error('`canvas_shape` parameter in sketchpad plugin must be either "rectangle" or "circle"');let t='<div id="sketchpad-controls">';t+='<div id="sketchpad-color-palette">';for(const a of this.params.stroke_color_palette)t+=`<button class="sketchpad-color-select" data-color="${a}" style="background-color:${a};"></button>`;t+="</div>",t+='<div id="sketchpad-actions">',this.params.show_clear_button&&(t+=`<button class="jspsych-btn" id="sketchpad-clear" disabled>${this.params.clear_button_label}</button>`),this.params.show_undo_button&&(t+=`<button class="jspsych-btn" id="sketchpad-undo" disabled>${this.params.undo_button_label}</button>`,this.params.show_redo_button&&(t+=`<button class="jspsych-btn" id="sketchpad-redo" disabled>${this.params.redo_button_label}</button>`)),t+="</div></div>",e+=t;let s="";this.params.show_finished_button&&(s=`<p id="finish-btn"><button class="jspsych-btn" id="sketchpad-end">${this.params.finished_button_label}</button></p>`);let i="";this.params.show_countdown_trial_duration&&this.params.trial_duration&&(i=`<p id="countdown-timer">${this.params.countdown_timer_html}</p>`);let r;this.params.prompt!==null?(this.params.prompt_location=="abovecanvas"&&(r=this.params.prompt+i+e+s),this.params.prompt_location=="belowcanvas"&&(r=i+e+this.params.prompt+s),this.params.prompt_location=="belowbutton"&&(r=i+e+s+this.params.prompt)):r=i+e+s,this.display.innerHTML=r,this.sketchpad=this.display.querySelector("#sketchpad-canvas"),this.ctx=this.sketchpad.getContext("2d")}setup_event_listeners(){document.addEventListener("pointermove",t=>{this.mouse_position={x:t.clientX,y:t.clientY}}),this.params.show_finished_button&&this.display.querySelector("#sketchpad-end").addEventListener("click",()=>{this.end_trial("button")}),this.sketchpad.addEventListener("pointerdown",this.start_draw.bind(this)),this.sketchpad.addEventListener("pointermove",this.move_draw.bind(this)),this.sketchpad.addEventListener("pointerup",this.end_draw.bind(this)),this.sketchpad.addEventListener("pointerleave",this.end_draw.bind(this)),this.sketchpad.addEventListener("pointercancel",this.end_draw.bind(this)),this.params.key_to_draw!==null&&(document.addEventListener("keydown",t=>{t.key==this.params.key_to_draw&&!this.is_drawing&&!this.draw_key_held&&(this.draw_key_held=!0,document.elementFromPoint(this.mouse_position.x,this.mouse_position.y)==this.sketchpad&&this.sketchpad.dispatchEvent(new PointerEvent("pointerdown",{clientX:this.mouse_position.x,clientY:this.mouse_position.y})))}),document.addEventListener("keyup",t=>{t.key==this.params.key_to_draw&&(this.draw_key_held=!1,document.elementFromPoint(this.mouse_position.x,this.mouse_position.y)==this.sketchpad&&this.sketchpad.dispatchEvent(new PointerEvent("pointerup",{clientX:this.mouse_position.x,clientY:this.mouse_position.y})))})),this.params.show_undo_button&&(this.display.querySelector("#sketchpad-undo").addEventListener("click",this.undo.bind(this)),this.params.show_redo_button&&this.display.querySelector("#sketchpad-redo").addEventListener("click",this.redo.bind(this))),this.params.show_clear_button&&this.display.querySelector("#sketchpad-clear").addEventListener("click",this.clear.bind(this));const e=Array.prototype.slice.call(this.display.querySelectorAll(".sketchpad-color-select"));for(const t of e)t.addEventListener("click",s=>{const i=s.target;this.current_stroke_color=i.getAttribute("data-color")});this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:this.after_key_response,valid_responses:this.params.choices,persist:!1,allow_held_key:!1})}add_css(){document.querySelector("head").insertAdjacentHTML("beforeend",`<style id="sketchpad-styles">
        #sketchpad-controls {
          line-height: 1; 
          width:${this.params.canvas_shape=="rectangle"?this.params.canvas_width+this.params.canvas_border_width*2:this.params.canvas_diameter+this.params.canvas_border_width*2}px; 
          display: flex; 
          justify-content: space-between; 
          flex-wrap: wrap;
          margin: auto;
        }
        #sketchpad-color-palette { 
          display: inline-block; text-align:left; flex-grow: 1;
        }
        .sketchpad-color-select { 
          cursor: pointer; height: 33px; width: 33px; border-radius: 4px; padding: 0; border: 1px solid #ccc; 
        }
        #sketchpad-actions {
          display:inline-block; text-align:right; flex-grow: 1;
        }
        #sketchpad-actions button {
          margin-left: 4px;
        }
        #sketchpad-canvas {
          touch-action: none;
          border: ${this.params.canvas_border_width}px solid ${this.params.canvas_border_color};
        }
        .sketchpad-circle {
          border-radius: ${this.params.canvas_diameter/2}px;
        }
        #countdown-timer {
          width:${this.params.canvas_shape=="rectangle"?this.params.canvas_width+this.params.canvas_border_width*2:this.params.canvas_diameter+this.params.canvas_border_width*2}px; 
          text-align: right;
          font-size: 12px; 
          margin-bottom: 0.2em;
        }
      </style>`)}add_background_color(){this.ctx.fillStyle=this.params.background_color,this.params.canvas_shape=="rectangle"&&this.ctx.fillRect(0,0,this.params.canvas_width,this.params.canvas_height),this.params.canvas_shape=="circle"&&this.ctx.fillRect(0,0,this.params.canvas_diameter,this.params.canvas_diameter)}add_background_image(){return new Promise((e,t)=>{this.params.background_image!==null?(this.background_image=new Image,this.background_image.src=this.params.background_image,this.background_image.onload=()=>{this.ctx.drawImage(this.background_image,0,0),e(!0)}):e(!1)})}start_draw(e){this.is_drawing=!0;const t=Math.round(e.clientX-this.sketchpad.getBoundingClientRect().left),s=Math.round(e.clientY-this.sketchpad.getBoundingClientRect().top);this.undo_history=[],this.set_redo_btn_state(!1),this.ctx.beginPath(),this.ctx.moveTo(t,s),this.ctx.strokeStyle=this.current_stroke_color,this.ctx.lineJoin="round",this.ctx.lineWidth=this.params.stroke_width,this.stroke=[],this.stroke.push({x:t,y:s,color:this.current_stroke_color,action:"start",t:Math.round(performance.now()-this.start_time)}),this.sketchpad.releasePointerCapture(e.pointerId)}move_draw(e){if(this.is_drawing){const t=Math.round(e.clientX-this.sketchpad.getBoundingClientRect().left),s=Math.round(e.clientY-this.sketchpad.getBoundingClientRect().top);this.ctx.lineTo(t,s),this.ctx.stroke(),this.stroke.push({x:t,y:s,action:"move"})}}end_draw(e){this.is_drawing&&(this.stroke.push({action:"end",t:Math.round(performance.now()-this.start_time)}),this.strokes.push(this.stroke),this.set_undo_btn_state(!0),this.set_clear_btn_state(!0)),this.is_drawing=!1}render_drawing(){this.ctx.clearRect(0,0,this.sketchpad.width,this.sketchpad.height),this.add_background_color(),this.background_image&&this.ctx.drawImage(this.background_image,0,0);for(const e of this.strokes)for(const t of e)t.action=="start"&&(this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.strokeStyle=t.color,this.ctx.lineJoin="round",this.ctx.lineWidth=this.params.stroke_width),t.action=="move"&&(this.ctx.lineTo(t.x,t.y),this.ctx.stroke())}undo(){this.undo_history.push(this.strokes.pop()),this.set_redo_btn_state(!0),this.strokes.length==0&&this.set_undo_btn_state(!1),this.render_drawing()}redo(){this.strokes.push(this.undo_history.pop()),this.set_undo_btn_state(!0),this.undo_history.length==0&&this.set_redo_btn_state(!1),this.render_drawing()}clear(){this.strokes=[],this.undo_history=[],this.render_drawing(),this.set_redo_btn_state(!1),this.set_undo_btn_state(!1),this.set_clear_btn_state(!1)}set_undo_btn_state(e){this.params.show_undo_button&&(this.display.querySelector("#sketchpad-undo").disabled=!e)}set_redo_btn_state(e){this.params.show_undo_button&&this.params.show_redo_button&&(this.display.querySelector("#sketchpad-redo").disabled=!e)}set_clear_btn_state(e){this.params.show_clear_button&&(this.display.querySelector("#sketchpad-clear").disabled=!e)}set_trial_duration_timer(){this.params.trial_duration!==null&&(this.jsPsych.pluginAPI.setTimeout(()=>{this.end_trial()},this.params.trial_duration),this.params.show_countdown_trial_duration&&(this.timer_interval=setInterval(()=>{const e=this.params.trial_duration-(performance.now()-this.start_time);let t=Math.floor(e/1e3/60),s=Math.ceil((e-t*1e3*60)/1e3);s==60&&(s=0,t++);const i=t.toString(),r=s.toString().padStart(2,"0"),a=this.display.querySelector("#sketchpad-timer");a&&(a.innerHTML=`${i}:${r}`),e<=0&&(a&&(a.innerHTML="0:00"),clearInterval(this.timer_interval))},250)))}after_key_response(e){this.end_trial(e.key)}end_trial(e=null){this.jsPsych.pluginAPI.cancelAllKeyboardResponses(),clearInterval(this.timer_interval);const t={};t.rt=Math.round(performance.now()-this.start_time),t.response=e,this.params.save_final_image&&(t.png=this.sketchpad.toDataURL()),this.params.save_strokes&&(t.strokes=this.strokes),document.querySelector("#sketchpad-styles").remove(),this.jsPsych.finishTrial(t),this.trial_finished_handler()}};hp.info=LV;let _u=hp;let we=class ts{static isAvailable(){return typeof window<"u"}static isFileReaderAvailable(){return ts.isAvailable()?!!window.FileReader:!1}static getLocation(){if(ts.isAvailable())return window.location}static getVisualViewport(){return ts.isAvailable()?window.visualViewport:null}static getInnerWidth(){if(ts.isAvailable())return window.innerWidth}static getInnerHeight(){return ts.isAvailable()?window.innerHeight:null}static getDevicePixelRatio(){return ts.isAvailable()?window.devicePixelRatio:null}static getWindow(){if(ts.isAvailable())return window}static hasOwn(e){if(ts.isAvailable())return e in window}static getSelection(){if(ts.isAvailable()&&window.getSelection)return window.getSelection()}static requestAnimationFrame(e){if(ts.isAvailable())return window.requestAnimationFrame(e)}static addEventListener(e,t){ts.isAvailable()&&window.addEventListener(e,t)}static removeEventListener(e,t){ts.isAvailable()&&window.removeEventListener(e,t)}static matchMedia(e){return!ts.isAvailable()||typeof window.matchMedia>"u"?null:window.matchMedia(e)}},ge=class Bs{static isAvailable(){return typeof document<"u"}static getBody(){if(Bs.isAvailable())return document.body}static getDocumentElement(){if(Bs.isAvailable())return document.documentElement}static getDocument(){if(Bs.isAvailable())return document}static getCookie(){if(Bs.isAvailable())return document.cookie}static setCookie(e){Bs.isAvailable()&&(document.cookie=e)}static activeElementBlur(){if(!Bs.isAvailable())return;const e=document.activeElement;e&&e.blur&&e.blur()}static createElement(e){if(Bs.isAvailable())return document.createElement(e)}static getComputedStyle(e){return Bs.isAvailable()?document.defaultView.getComputedStyle(e):new CSSStyleDeclaration}static addEventListener(e,t){Bs.isAvailable()&&document.addEventListener(e,t)}static removeEventListener(e,t){Bs.isAvailable()&&document.removeEventListener(e,t)}};function Rt(n,e){if(!e)return new Date;!A.storeUtcDates&&typeof e=="string"&&AV(e)&&(e+="T00:00:00");const t=new Date(e);return A.onDateCreated(t,n,e)}function AV(n){return n.indexOf("T")>0||!/\d{4}-\d{2}-\d{2}/.test(n)?!1:!isNaN(new Date(n).getTime())}let O=class Oe{static isValueEmpty(e){if(Array.isArray(e)&&e.length===0)return!0;if(e&&Oe.isValueObject(e)&&e.constructor===Object){for(var t in e)if(!Oe.isValueEmpty(e[t]))return!1;return!0}return!e&&e!==0&&e!==!1}static isValueUndefined(e){return e==null||typeof e=="number"&&isNaN(e)}static isArrayContainsEqual(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var s=0;s<e.length;s++){for(var i=0;i<t.length&&!Oe.isTwoValueEquals(e[s],t[i]);i++);if(i===t.length)return!1}return!0}static checkIfArraysEqual(e,t,s){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;if(s.ignoreOrder!==void 0?s.ignoreOrder:!1){for(var r=[],a=[],o=0;o<e.length;o++)r.push(e[o]),a.push(t[o]);r.sort(),a.sort(),e=r,t=a}for(var o=0;o<e.length;o++)if(!Oe.checkIfValuesEqual(e[o],t[o],s))return!1;return!0}static isArraysEqual(e,t,s=!1,i,r){return Oe.checkIfArraysEqual(e,t,{ignoreOrder:s,caseSensitive:i,trimStrings:r})}static compareStrings(e,t){const s=A.comparator.normalizeTextCallback;if(e&&(e=s(e,"compare").trim()),t&&(t=s(t,"compare").trim()),!e&&!t)return 0;if(!e)return-1;if(!t)return 1;if(e===t)return 0;let i=-1;for(let r=0;r<e.length&&r<t.length;r++){if(this.isCharDigit(e[r])&&this.isCharDigit(t[r])){i=r;break}if(e[r]!==t[r])break}if(i>-1){let r=this.getNumberFromStr(e,i),a=this.getNumberFromStr(t,i);if(!Number.isNaN(r)&&!Number.isNaN(a)&&r!==a)return r>a?1:-1}return e>t?1:-1}static checkIfValuesEqual(e,t,s){if(e===t||Array.isArray(e)&&e.length===0&&typeof t>"u"||Array.isArray(t)&&t.length===0&&typeof e>"u"||e==null&&t===""||t==null&&e==="")return!0;const i=s.caseSensitive!==void 0?s.caseSensitive:A.comparator.caseSensitive,r=s.trimStrings!==void 0?s.trimStrings:A.comparator.trimStrings;if(typeof e=="string"&&typeof t=="string"){const d=A.comparator.normalizeTextCallback;return e=d(e,"compare"),t=d(t,"compare"),r&&(e=e.trim(),t=t.trim()),i||(e=e.toLowerCase(),t=t.toLowerCase()),e===t}if(e instanceof Date&&t instanceof Date)return e.getTime()==t.getTime();const a=!s.doNotConvertNumbers;if(a&&Oe.isConvertibleToNumber(e)&&Oe.isConvertibleToNumber(t)&&parseInt(e)===parseInt(t)&&parseFloat(e)===parseFloat(t))return!0;if(!Oe.isValueEmpty(e)&&Oe.isValueEmpty(t)||Oe.isValueEmpty(e)&&!Oe.isValueEmpty(t))return!1;if((e===!0||e===!1)&&typeof t=="string")return e.toString()===t.toLocaleLowerCase();if((t===!0||t===!1)&&typeof e=="string")return t.toString()===e.toLocaleLowerCase();const o=Oe.isValueObject(e),l=Oe.isValueObject(t);if(!o&&!l&&(a||typeof e!="number"&&typeof t!="number"))return e==t;if(!o||!l)return!1;if(e.equals&&t.equals)return e.equals(t);if(Array.isArray(e)&&Array.isArray(t))return Oe.checkIfArraysEqual(e,t,s);for(var u in e)if(e.hasOwnProperty(u)&&(!t.hasOwnProperty(u)||!this.checkIfValuesEqual(e[u],t[u],s)))return!1;for(u in t)if(t.hasOwnProperty(u)&&!e.hasOwnProperty(u))return!1;return!0}static isTwoValueEquals(e,t,s=!1,i,r){return this.checkIfValuesEqual(e,t,{ignoreOrder:s,caseSensitive:i,trimStrings:r})}static randomizeArray(e){for(var t=e.length-1;t>0;t--){var s=Math.floor(Math.random()*(t+1)),i=e[t];e[t]=e[s],e[s]=i}return e}static getUnbindValue(e){if(Array.isArray(e)){const t=[];for(let s=0;s<e.length;s++)t.push(Oe.getUnbindValue(e[s]));return t}return e&&Oe.isValueObject(e)&&!(e instanceof Date)?JSON.parse(JSON.stringify(e)):e}static createCopy(e){return this.createCopyWithPrefix(e,void 0)}static createCopyWithPrefix(e,t){var s={};if(!e)return s;for(var i in e){const r=t?t+i:i;s[r]=e[i]}return s}static isConvertibleToNumber(e){return e!=null&&!Array.isArray(e)&&!isNaN(e)}static isValueObject(e,t){return e instanceof Object&&(!t||!Array.isArray(e))}static isNumber(e){return!isNaN(this.getNumber(e))}static getNumber(e){const t=Oe.getNumberCore(e);return A.parseNumber(e,t)}static getNumberCore(e){if(typeof e=="string"){if(e=e.trim(),!e)return NaN;if(e.indexOf("0x")==0)return e.length>32?NaN:parseInt(e);if(e.length>15&&Oe.isDigitsOnly(e))return NaN;if(Oe.isStringHasOperator(e))return NaN}e=this.prepareStringToNumber(e);const t=parseFloat(e);return isNaN(t)||!isFinite(e)?NaN:t}static isStringHasOperator(e){if(e.lastIndexOf("-")>0||e.lastIndexOf("+")>0)return!1;const t="*^/%";for(let s=0;s<t.length;s++)if(e.indexOf(t[s])>-1)return!0;return!1}static prepareStringToNumber(e){if(typeof e!="string"||!e)return e;let t=e.indexOf(",");return t>-1&&e.indexOf(",",t+1)<0?e.replace(",","."):e}static getMaxLength(e,t){return e<0&&(e=t),e>0?e:null}static getRemainingCharacterCounterText(e,t){return!t||t<=0||!A.showMaxLengthIndicator?"":[e?e.length:"0",t].join("/")}static getNumberByIndex(e,t,s){if(e<0)return"";var i=1,r="",a=t&&t[t.length-1]!=="."?"":".",o=!0,l="A",u="";const d=x=>{if(!x)return!1;for(var V=0;V<x.length;V++)if(Oe.isCharDigit(x[V]))return!0;return!1};if(t){u=t;for(var h=u.length-1,f=d(u),C=function(){return f&&!Oe.isCharDigit(u[h])||Oe.isCharNotLetterAndDigit(u[h])};h>=0&&C();)h--;var b="";for(h<u.length-1&&(b=u.substring(h+1),u=u.substring(0,h+1)),h=u.length-1;h>=0&&!(C()||(h--,!f)););l=u.substring(h+1),r=u.substring(0,h+1),parseInt(l)?i=parseInt(l):l.length==1&&(o=!1),(b||r)&&(a=b)}if(s>-1&&d(r)&&(r=this.getNumberByIndex(s,r)),o){let x=(e+i).toString();for(;x.length<l.length;)x="0"+x;return r+x+a}return r+String.fromCharCode(l.charCodeAt(0)+e)+a}static isCharNotLetterAndDigit(e){return e.toUpperCase()==e.toLowerCase()&&!Oe.isCharDigit(e)}static isCharDigit(e){return e>="0"&&e<="9"}static isDigitsOnly(e){if(!e)return!1;for(let t=0;t<e.length;t++)if(!Oe.isCharDigit(e[t]))return!1;return!0}static getNumberFromStr(e,t){if(!this.isCharDigit(e[t]))return NaN;let s="";for(;t<e.length&&this.isCharDigit(e[t]);)s+=e[t],t++;return s?this.getNumber(s):NaN}static countDecimals(e){if(Oe.isNumber(e)&&Math.floor(e)!==e){const t=e.toString().split(".");return t.length>1&&t[1].length||0}return 0}static correctAfterPlusMinis(e,t,s){const i=Oe.countDecimals(e),r=Oe.countDecimals(t);if(i>0||r>0){const a=Math.max(i,r);s=parseFloat(s.toFixed(a))}return s}static sumAnyValues(e,t){if(!Oe.isNumber(e)||!Oe.isNumber(t)){if(Array.isArray(e)&&Array.isArray(t))return[].concat(e).concat(t);if(Array.isArray(e)||Array.isArray(t)){const i=Array.isArray(e)?e:t,r=i===e?t:e;if(typeof r=="string"){const a=i.join(", ");return i===e?a+r:r+a}if(typeof r=="number"){let a=0;for(var s=0;s<i.length;s++)typeof i[s]=="number"&&(a=Oe.correctAfterPlusMinis(a,i[s],a+i[s]));return Oe.correctAfterPlusMinis(a,r,a+r)}}return e+t}return typeof e=="string"||typeof t=="string"?e+t:Oe.correctAfterPlusMinis(e,t,e+t)}static correctAfterMultiple(e,t,s){const i=Oe.countDecimals(e)+Oe.countDecimals(t);return i>0&&(s=parseFloat(s.toFixed(i))),s}static findObjByPropValue(e,t,s){for(var i=0;i<e.length;i++)if(Oe.isTwoValueEquals(e[i][t],s))return e[i]}static convertArrayObjectToValue(e,t){const s=new Array;if(!e||!Array.isArray(e))return s;for(var i=0;i<e.length;i++){const r=e[i]?e[i][t]:void 0;Oe.isValueEmpty(r)||s.push(r)}return s}static convertDateToString(e){const t=s=>s<10?"0"+s.toString():s.toString();return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())}static convertDateTimeToString(e){const t=s=>s<10?"0"+s.toString():s.toString();return this.convertDateToString(e)+" "+t(e.getHours())+":"+t(e.getMinutes())}static convertValToQuestionVal(e,t){return e instanceof Date?t==="datetime-local"?Oe.convertDateTimeToString(e):Oe.convertDateToString(e):this.getUnbindValue(e)}static compareVerions(e,t){if(!e&&!t)return 0;const s=e.split("."),i=t.split("."),r=s.length,a=i.length;for(let o=0;o<r&&o<a;o++){const l=s[o],u=i[o];if(l.length===u.length){if(l!==u)return l<u?-1:1}else return l.length<u.length?-1:1}return r===a?0:r<a?-1:1}static isUrlYoutubeVideo(e){if(!e)return!1;const t=["www.youtube.com","m.youtube.com","youtube.com","youtu.be"];e=e.toLowerCase(),e=e.replace(/^https?:\/\//,"");for(let s=0;s<t.length;s++)if(e.indexOf(t[s]+"/")===0)return!0;return!1}};String.prototype.format||(String.prototype.format=function(){var n=arguments;return this.replace(/{(\d+)}/g,function(e,t){return typeof n[t]<"u"?n[t]:e})});var DV={pagePrevText:"Previous",pageNextText:"Next",completeText:"Complete",previewText:"Preview",editText:"Edit",startSurveyText:"Start",commentText:"Please leave a comment",otherItemText:"Other (describe)",noneItemText:"None",refuseItemText:"Refuse to answer",dontKnowItemText:"Don't know",selectAllItemText:"Select All",deselectAllItemText:"Deselect all",progressText:"Page {0} of {1}",indexText:"{0} of {1}",panelDynamicProgressText:"{0} of {1}",panelDynamicTabTextFormat:"Panel {panelIndex}",questionsProgressText:"Answered {0}/{1} questions",emptySurvey:"The survey doesn't contain any visible elements.",completingSurvey:"Thank you for completing the survey",completingSurveyBefore:"You have already completed this survey.",loadingSurvey:"Loading Survey...",placeholder:"Select...",ratingOptionsCaption:"Select...",buttongroupOptionsCaption:"Select...",value:"value",requiredError:"Response required.",requiredErrorInPanel:"Response required: answer at least one question.",requiredInAllRowsError:"Response required: answer questions in all rows.",eachRowUniqueError:"Each row must have a unique value.",numericError:"The value should be numeric.",minError:"The value should not be less than {0}",stepError:"Please enter a value that matches the step size of {0}.",maxError:"The value should not be greater than {0}",textNoDigitsAllow:"Numbers are not allowed.",textMinLength:"Please enter at least {0} character(s).",textMaxLength:"Please enter no more than {0} character(s).",textMinMaxLength:"Please enter at least {0} and no more than {1} characters.",minRowCountError:"Please fill in at least {0} row(s).",minSelectError:"Please select at least {0} option(s).",maxSelectError:"Please select no more than {0} option(s).",numericMinMax:"The '{0}' should be at least {1} and at most {2}",numericMin:"The '{0}' should be at least {1}",numericMax:"The '{0}' should be at most {1}",invalidEmail:"Please enter a valid e-mail address.",invalidExpression:"The expression: {0} should return 'true'.",urlRequestError:"The request returned error '{0}'. {1}",urlGetChoicesError:"The request returned empty data or the 'path' property is incorrect",exceedMaxSize:"The file size should not exceed {0}.",exceedMaxFiles:"The maximum number of files you can upload is {0}.",noUploadFilesHandler:"Files cannot be uploaded. Please add a handler for the 'onUploadFiles' event.",otherRequiredError:"Response required: enter another value.",uploadingFile:"Your file is uploading. Please wait several seconds and try again.",loadingFile:"Loading...",chooseFile:"Choose file(s)...",noFileChosen:"No file selected",filePlaceholder:"Drag and drop a file here or click the button below to select a file to upload.",confirmDelete:"Are you sure you want to delete this record?",keyDuplicationError:"This value should be unique.",addColumn:"Add Column",addRow:"Add Row",removeRow:"Remove",noRowsText:"There are no rows.",rowIndexTemplateTitle:"Row {rowIndex}",rowNameTemplateTitle:"{rowTitle}",addPanel:"Add new",removePanel:"Remove",showDetails:"Show Details",hideDetails:"Hide Details",choices_Item:"item",choices_Choice:"Choice option",matrix_column:"Column",matrix_row:"Row",multipletext_itemname:"text",savingData:"The results are being saved on the server...",savingDataError:"An error occurred and we could not save the results.",savingDataSuccess:"The results were saved successfully!",savingExceedSize:"Your response exceeds 64KB. Please reduce the size of your file(s) and try again or contact the survey owner.",saveAgainButton:"Try again",timerMin:"min",timerSec:"sec",timerSpentAll:"You have spent {0} on this page and {1} in total.",timerSpentPage:"You have spent {0} on this page.",timerSpentSurvey:"You have spent {0} in total.",timerLimitAll:"You have spent {0} of {1} on this page and {2} of {3} in total.",timerLimitPage:"You have spent {0} of {1} on this page.",timerLimitSurvey:"You have spent {0} of {1} in total.",clearCaption:"Clear",selectCaption:"Select",signaturePlaceHolder:"Sign here",signaturePlaceHolderReadOnly:"No signature",chooseFileCaption:"Select File",takePhotoCaption:"Take Photo",photoPlaceholder:"Click the button below to take a photo using the camera.",fileOrPhotoPlaceholder:"Drag and drop or select a file to upload or take a photo using the camera.",replaceFileCaption:"Replace file",removeFileCaption:"Remove this file",booleanCheckedLabel:"Yes",booleanUncheckedLabel:"No",confirmRemoveFile:"Are you sure that you want to remove this file: {0}?",confirmRemoveAllFiles:"Are you sure that you want to remove all files?",questionTitlePatternText:"Question Title",modalCancelButtonText:"Cancel",modalApplyButtonText:"Apply",filterStringPlaceholder:"Type to search...",emptyMessage:"No data to display",loadingPage:"Loading...",loadingData:"Loading...",noEntriesText:`No entries yet.
Click the button below to add a new entry.`,noEntriesReadonlyText:"No entries",tabTitlePlaceholder:"New Panel",more:"More",tagboxDoneButtonCaption:"OK",selectToRankEmptyRankedAreaText:"All choices are selected for ranking",selectToRankEmptyUnrankedAreaText:"Drag choices here to rank them",ok:"OK",cancel:"Cancel",createCustomItem:'Create "{0}" item...',toc:"Table of contents",progressbar:"Progress bar"},is={currentLocaleValue:"",defaultLocaleValue:"en",locales:{},localeNames:{},localeNamesInEnglish:{},localeDirections:{},supportedLocales:[],useEnglishNames:!1,get showNamesInEnglish(){return this.useEnglishNames},set showNamesInEnglish(n){this.useEnglishNames=n},setupLocale(n){const e=n.localeCode;this.locales[e]=n.strings,this.localeNames[e]=n.nativeName,this.localeNamesInEnglish[e]=n.englishName,n.rtl!==void 0&&(this.localeDirections[e]=n.rtl?"rtl":"ltr")},get currentLocale(){return this.currentLocaleValue===this.defaultLocaleValue?"":this.currentLocaleValue},set currentLocale(n){this.currentLocaleValue=this.getCorrectLocaleName(n)},get defaultLocale(){return this.defaultLocaleValue},set defaultLocale(n){this.defaultLocaleValue=this.getCorrectLocaleName(n)},getCorrectLocaleName(n){return n==="cz"&&(n="cs"),n==="gr"&&(n="el"),n==="rs"&&(n="sr"),n==="ua"&&(n="uk"),n},getLocaleStrings(n){return this.locales[n]},getString:function(n,e=null){const t=new Array,s=r=>{const a=this.locales[r];a&&t.push(a)},i=r=>{if(!r)return;s(r);const a=r.indexOf("-");a<1||(r=r.substring(0,a),s(r))};i(e),i(this.currentLocale),i(this.defaultLocale),this.defaultLocale!=="en"&&s("en");for(let r=0;r<t.length;r++){const a=t[r][n];if(a!==void 0)return a}return this.onGetExternalString(n,e)},getLocaleName(n,e){if(!n)return"";e===void 0&&(e=this.showNamesInEnglish);const t=e?this.localeNamesInEnglish:this.localeNames,s=e?this.localeNames:this.localeNamesInEnglish;return t[n]||s[n]||n},getLocales:function(n=!1){var e=[];e.push("");var t=this.locales;if(this.supportedLocales&&this.supportedLocales.length>0){t={};for(var s=0;s<this.supportedLocales.length;s++)t[this.supportedLocales[s]]=!0}for(var i in t)n&&i==this.defaultLocale||e.push(i);var r=a=>this.getLocaleName(a).toLowerCase();return e.sort((a,o)=>{var l=r(a),u=r(o);return l===u?0:l<u?-1:1}),e},onGetExternalString:function(n,e){}};function Ct(n,e=null){return is.getString(n,e)}is.locales.en=DV,is.localeNames.en="english";function Lu(n,e,t){let s=n.getLocalizableString(t);if(!s){let i;typeof e.localizable=="object"&&e.localizable.defaultStr&&(i=e.localizable.defaultStr),s=n.createLocalizableString(t,n,!0,i),typeof e.localizable=="object"&&typeof e.localizable.onGetTextCallback=="function"&&(s.onGetTextCallback=e.localizable.onGetTextCallback)}}function OV(n,e,t){Lu(n,e,t);let s=n.getLocalizableStringText(t);if(s)return s;if(typeof e.localizable=="object"&&e.localizable.defaultStr){const i=n.getLocale?n.getLocale():"";return Ct(e.localizable.defaultStr,i)}return""}function E(n={}){return function(e,t){let s=(i,r)=>{if(r&&typeof r=="object"&&r.type===We.ComputedUpdaterType){Te.startCollectDependencies(()=>i[t]=r.updater(),i,t);const a=r.updater(),o=Te.finishCollectDependencies();return r.setDependencies(o),i.dependencies[t]&&i.dependencies[t].dispose(),i.dependencies[t]=r,a}return r};!n||!n.localizable?Object.defineProperty(e,t,{get:function(){let i=null;return n&&(typeof n.getDefaultValue=="function"&&(i=n.getDefaultValue(this)),n.defaultValue!==void 0&&(i=n.defaultValue)),this.getPropertyValue(t,i)},set:function(i){const r=s(this,i),a=this.getPropertyValue(t);r!==a&&(this.setPropertyValue(t,r),n&&n.onSet&&n.onSet(r,this,a))}}):(Object.defineProperty(e,t,{get:function(){return OV(this,n,t)},set:function(i){Lu(this,n,t);const r=s(this,i);this.setLocalizableStringText(t,r),n&&n.onSet&&n.onSet(r,this)}}),Object.defineProperty(e,typeof n.localizable=="object"&&n.localizable.name?n.localizable.name:"loc"+t.charAt(0).toUpperCase()+t.slice(1),{get:function(){return Lu(this,n,t),this.getLocalizableString(t)}}))}}function Jf(n,e,t){n.ensureArray(t,(s,i)=>{const r=e?e.onPush:null;r&&r(s,i,n)},(s,i)=>{const r=e?e.onRemove:null;r&&r(s,i,n)})}function Nt(n){return function(e,t){Object.defineProperty(e,t,{get:function(){return Jf(this,n,t),this.getPropertyValue(t)},set:function(s){Jf(this,n,t);const i=this.getPropertyValue(t);s!==i&&(i?i.splice(0,i.length,...s||[]):this.setPropertyValue(t,s),n&&n.onSet&&n.onSet(s,this))}})}}let gr=class Ia{constructor(e,t,s=!1){this.name=t,this.isRequiredValue=!1,this.isUniqueValue=!1,this.isSerializable=!0,this.isLightSerializable=!0,this.isCustom=!1,this.isDynamicChoices=!1,this.isBindable=!1,this.category="",this.categoryIndex=-1,this.visibleIndex=-1,this.maxLength=-1,this.isArray=!1,this.classInfoValue=e,this.isRequiredValue=s,this.idValue=Ia.Index++}get id(){return this.idValue}get classInfo(){return this.classInfoValue}get type(){return this.typeValue?this.typeValue:"string"}set type(e){e==="itemvalues"&&(e="itemvalue[]"),e==="textitems"&&(e="textitem[]"),this.typeValue=e,this.typeValue.indexOf("[]")===this.typeValue.length-2&&(this.isArray=!0,this.className=this.typeValue.substring(0,this.typeValue.length-2))}get locationInTable(){return this.locationInTableValue||"column"}set locationInTable(e){this.locationInTableValue=e}get showMode(){const e=this.locationInTableValue;return e==="detail"?"form":e==="column"?"list":""}set showMode(e){this.locationInTable=e==="form"?"detail":e==="list"?"column":void 0}get isRequired(){return this.isRequiredValue}set isRequired(e){e!==this.isRequired&&(this.isRequiredValue=e,this.classInfo&&this.classInfo.resetAllProperties())}get isUnique(){return this.isUniqueValue}set isUnique(e){this.isUniqueValue=e}get uniquePropertyName(){return this.uniquePropertyValue}set uniquePropertyName(e){this.uniquePropertyValue=e}isPropertySerializable(e){return this.isSerializableFunc?this.isSerializableFunc(e):this.isSerializable}getDefaultValue(e){let t=this.defaultValueFunc?this.defaultValueFunc(e):this.defaultValueValue;return Ia.getItemValuesDefaultValue&&q.isDescendantOf(this.className,"itemvalue")&&(t=Ia.getItemValuesDefaultValue(this.defaultValueValue||[],this.className)),t}get defaultValue(){return this.getDefaultValue(void 0)}set defaultValue(e){this.defaultValueValue=e,e!==void 0&&(this.defaultValueFunc=void 0)}isDefaultValue(e){return this.isDefaultValueByObj(void 0,e)}isDefaultValueByObj(e,t){if(this.isLocalizable)return t==null;const s=this.getDefaultValue(e);return s!==void 0?typeof s!="object"?s===t:O.isTwoValueEquals(t,s,!1,!0,!1):t===!1&&this.isBooleanType&&!this.defaultValueFunc||t===""||O.isValueEmpty(t)}getSerializableValue(e,t){if(this.onSerializeValue)return this.onSerializeValue(e);const s=this.getValue(e);if(s!=null&&!(!t&&this.isDefaultValueByObj(e,s)))return s}getValue(e){return this.onGetValue?(e=this.getOriginalObj(e),this.onGetValue(e)):this.serializationProperty&&e[this.serializationProperty]?e[this.serializationProperty].getJson():e[this.name]}getPropertyValue(e){return this.isLocalizable?e[this.serializationProperty]?e[this.serializationProperty].text:null:this.getValue(e)}get hasToUseSetValue(){return this.onSetValue||this.serializationProperty}settingValue(e,t){return!this.onSettingValue||e.isLoadingFromJson?t:this.onSettingValue(e,t)}setValue(e,t,s){if(this.onSetValue)e=this.getOriginalObj(e),this.onSetValue(e,t,s);else if(this.serializationProperty&&e[this.serializationProperty])e[this.serializationProperty].setJson(t,!0);else{if(t&&typeof t=="string"&&(this.type=="number"&&(t=parseInt(t)),this.isBooleanType)){const i=t.toLowerCase();(i==="false"||i==="true")&&(t=i==="true")}e[this.name]=t}}get isBooleanType(){return this.type==="boolean"||this.type==="switch"}validateValue(e){const t=this.choices;return!Array.isArray(t)||t.length===0?!0:t.indexOf(e)>-1}getObjType(e){return this.classNamePart?e.replace(this.classNamePart,""):e}get choices(){return this.getChoices(null)}get hasChoices(){return!!this.choicesValue||!!this.choicesfunc}getChoices(e,t=null){return this.choicesValue!=null?this.choicesValue:this.choicesfunc!=null?this.choicesfunc(e,t):null}setChoices(e,t=null){this.choicesValue=e,this.choicesfunc=t}getBaseValue(){return this.baseValue?typeof this.baseValue=="function"?this.baseValue():this.baseValue:""}setBaseValue(e){this.baseValue=e}get readOnly(){return this.readOnlyValue!=null?this.readOnlyValue:!1}set readOnly(e){this.readOnlyValue=e}isEnable(e){return this.readOnly?!1:!e||!this.enableIf?!0:this.enableIf(this.getOriginalObj(e))}isVisible(e,t=null){let s=!this.layout||!e||this.layout===e;return!this.visible||!s?!1:this.visibleIf&&t?this.visibleIf(this.getOriginalObj(t)):!0}getOriginalObj(e){if(e&&e.getOriginalObj){const t=e.getOriginalObj();if(t&&q.findProperty(t.getType(),this.name))return t}return e}get visible(){return this.visibleValue!=null?this.visibleValue:!0}set visible(e){this.visibleValue=e}isAvailableInVersion(e){return this.alternativeName||this.oldName?!0:this.isAvailableInVersionCore(e)}getSerializedName(e){return this.alternativeName?this.isAvailableInVersionCore(e)?this.name:this.alternativeName||this.oldName:this.name}getSerializedProperty(e,t){return!this.oldName||this.isAvailableInVersionCore(t)?this:!e||!e.getType?null:q.findProperty(e.getType(),this.oldName)}isAvailableInVersionCore(e){return!e||!this.version?!0:O.compareVerions(this.version,e)<=0}get isLocalizable(){return this.isLocalizableValue!=null?this.isLocalizableValue:!1}set isLocalizable(e){this.isLocalizableValue=e}get dataList(){return Array.isArray(this.dataListValue)?this.dataListValue:[]}set dataList(e){this.dataListValue=e}mergeWith(e){for(var t=Ia.mergableValues,s=0;s<t.length;s++)this.mergeValue(e,t[s]);this.isArray=e.isArray}addDependedProperty(e){this.dependedProperties||(this.dependedProperties=[]),this.dependedProperties.indexOf(e)<0&&this.dependedProperties.push(e)}getDependedProperties(){return this.dependedProperties?this.dependedProperties:[]}schemaType(){if(this.className!=="choicesByUrl")return this.className==="string"?this.className:this.className||this.baseClassName?"array":this.type=="switch"?"boolean":this.type=="boolean"||this.type=="number"?this.type:"string"}schemaRef(){if(this.className)return this.className}mergeValue(e,t){this[t]==null&&e[t]!=null&&(this[t]=e[t])}};gr.Index=1,gr.mergableValues=["typeValue","choicesValue","baseValue","readOnlyValue","visibleValue","isSerializable","isLightSerializable","isCustom","isBindable","isUnique","uniquePropertyName","isDynamicChoices","isLocalizableValue","className","alternativeName","oldName","layout","version","classNamePart","baseClassName","defaultValue","defaultValueFunc","serializationProperty","onGetValue","onSetValue","onSettingValue","displayName","category","categoryIndex","visibleIndex","nextToProperty","overridingProperty","locationInTable","dependedProperties","visibleIf","enableIf","onExecuteExpression","onPropertyEditorUpdate","maxLength","maxValue","minValue","dataListValue"];let Rs=class Kt{static addProperty(e,t){e=e.toLowerCase();var s=Kt.properties;s[e]||(s[e]=[]),s[e].push(t)}static removeProperty(e,t){e=e.toLowerCase();var s=Kt.properties;if(s[e]){for(var i=s[e],r=0;r<i.length;r++)if(i[r].name==t){s[e].splice(r,1);break}}}static removeAllProperties(e){e=e.toLowerCase(),delete Kt.properties[e]}static addClass(e,t){e=e.toLowerCase(),t&&(t=t.toLowerCase()),Kt.parentClasses[e]=t}static getProperties(e){e=e.toLowerCase();for(var t=[],s=Kt.properties;e;){var i=s[e];if(i)for(var r=0;r<i.length;r++)t.push(i[r]);e=Kt.parentClasses[e]}return t}static createProperties(e){!e||!e.getType||Kt.createPropertiesCore(e,e.getType())}static createPropertiesCore(e,t){var s=Kt.properties;s[t]&&Kt.createPropertiesInObj(e,s[t]);var i=Kt.parentClasses[t];i&&Kt.createPropertiesCore(e,i)}static createPropertiesInObj(e,t){for(var s=0;s<t.length;s++)Kt.createPropertyInObj(e,t[s])}static createPropertyInObj(e,t){if(!Kt.checkIsPropertyExists(e,t.name)&&!(t.serializationProperty&&Kt.checkIsPropertyExists(e,t.serializationProperty))){if(t.isLocalizable&&t.serializationProperty&&e.createCustomLocalizableObj){const a=e.createCustomLocalizableObj(t.name);a.defaultValue=t.getDefaultValue(e);var s={get:function(){return e.getLocalizableString(t.name)}};Object.defineProperty(e,t.serializationProperty,s);var i={get:function(){return e.getLocalizableStringText(t.name)},set:function(o){e.setLocalizableStringText(t.name,o)}};Object.defineProperty(e,t.name,i)}else{var r=t.isArray||t.type==="multiplevalues";if(typeof e.createNewArray=="function"&&(q.isDescendantOf(t.className,"itemvalue")?(e.createNewArray(t.name,function(a){a.locOwner=e,a.ownerPropertyName=t.name}),r=!0):r&&e.createNewArray(t.name),r)){const a=t.getDefaultValue(e);Array.isArray(a)&&e.setPropertyValue(t.name,a)}if(e.getPropertyValue&&e.setPropertyValue){var i={get:()=>t.onGetValue?t.onGetValue(e):e.getPropertyValue(t.name,void 0),set:function(o){t.onSetValue?t.onSetValue(e,o,null):e.setPropertyValue(t.name,o)}};Object.defineProperty(e,t.name,i)}}(t.type==="condition"||t.type==="expression")&&t.onExecuteExpression&&e.addExpressionProperty(t.name,t.onExecuteExpression)}}static checkIsPropertyExists(e,t){return e.hasOwnProperty(t)||e[t]}};Rs.properties={},Rs.parentClasses={};let Au=class cf{constructor(e,t,s=null,i=null){this.name=e,this.creator=s,this.parentName=i,e=e.toLowerCase(),this.isCustomValue=!s&&e!=="survey",this.parentName&&(this.parentName=this.parentName.toLowerCase(),Rs.addClass(e,this.parentName),s&&this.makeParentRegularClass()),this.properties=new Array;for(var r=0;r<t.length;r++)this.createProperty(t[r],this.isCustom)}find(e){for(var t=0;t<this.properties.length;t++)if(this.properties[t].name==e)return this.properties[t];return null}findProperty(e){return this.fillAllProperties(),this.hashProperties[e]}getAllProperties(){return this.fillAllProperties(),this.allProperties}getRequiredProperties(){if(this.requiredProperties)return this.requiredProperties;this.requiredProperties=[];const e=this.getAllProperties();for(let t=0;t<e.length;t++)e[t].isRequired&&this.requiredProperties.push(e[t]);return this.requiredProperties}resetAllProperties(){this.allProperties=void 0,this.requiredProperties=void 0,this.hashProperties=void 0;for(var e=q.getChildrenClasses(this.name),t=0;t<e.length;t++)e[t].resetAllProperties()}get isCustom(){return this.isCustomValue}fillAllProperties(){if(this.allProperties)return;this.allProperties=[],this.hashProperties={};const e={};this.properties.forEach(s=>e[s.name]=s);const t=this.parentName?q.findClass(this.parentName):null;t&&t.getAllProperties().forEach(i=>{const r=e[i.name];r?(r.mergeWith(i),this.addPropCore(r)):this.addPropCore(i)}),this.properties.forEach(s=>{this.hashProperties[s.name]||this.addPropCore(s)})}addPropCore(e){this.allProperties.push(e),this.hashProperties[e.name]=e,e.alternativeName&&(this.hashProperties[e.alternativeName]=e)}isOverridedProp(e){return!!this.parentName&&!!q.findProperty(this.parentName,e)}hasRegularChildClass(){if(this.isCustom){this.isCustomValue=!1;for(var e=0;e<this.properties.length;e++)this.properties[e].isCustom=!1;Rs.removeAllProperties(this.name),this.makeParentRegularClass()}}makeParentRegularClass(){if(!this.parentName)return;const e=q.findClass(this.parentName);e&&e.hasRegularChildClass()}createProperty(e,t=!1){var s=typeof e=="string"?e:e.name;if(s){var i=null,r=s.indexOf(cf.typeSymbol);r>-1&&(i=s.substring(r+1),s=s.substring(0,r));var a=this.getIsPropertyNameRequired(s)||!!e.isRequired;s=this.getPropertyName(s);var o=new gr(this,s,a);if(i&&(o.type=i),typeof e=="object"){if(e.type&&(o.type=e.type),e.default!==void 0&&(o.defaultValue=e.default),e.defaultFunc!==void 0&&(o.defaultValueFunc=e.defaultFunc),O.isValueEmpty(e.isSerializable)||(o.isSerializable=e.isSerializable),O.isValueEmpty(e.isSerializableFunc)||(o.isSerializableFunc=e.isSerializableFunc),O.isValueEmpty(e.isLightSerializable)||(o.isLightSerializable=e.isLightSerializable),O.isValueEmpty(e.maxLength)||(o.maxLength=e.maxLength),e.displayName!==void 0&&(o.displayName=e.displayName),O.isValueEmpty(e.category)||(o.category=e.category),O.isValueEmpty(e.categoryIndex)||(o.categoryIndex=e.categoryIndex),O.isValueEmpty(e.nextToProperty)||(o.nextToProperty=e.nextToProperty),O.isValueEmpty(e.overridingProperty)||(o.overridingProperty=e.overridingProperty),O.isValueEmpty(e.visibleIndex)||(o.visibleIndex=e.visibleIndex),O.isValueEmpty(e.showMode)||(o.showMode=e.showMode),O.isValueEmpty(e.locationInTable)||(o.locationInTable=e.locationInTable),O.isValueEmpty(e.maxValue)||(o.maxValue=e.maxValue),O.isValueEmpty(e.minValue)||(o.minValue=e.minValue),O.isValueEmpty(e.dataList)||(o.dataList=e.dataList),O.isValueEmpty(e.isDynamicChoices)||(o.isDynamicChoices=e.isDynamicChoices),O.isValueEmpty(e.isBindable)||(o.isBindable=e.isBindable),O.isValueEmpty(e.isUnique)||(o.isUnique=e.isUnique),O.isValueEmpty(e.uniqueProperty)||(o.uniquePropertyName=e.uniqueProperty),O.isValueEmpty(e.isArray)||(o.isArray=e.isArray),(e.visible===!0||e.visible===!1)&&(o.visible=e.visible),e.visibleIf&&(o.visibleIf=e.visibleIf),e.enableIf&&(o.enableIf=e.enableIf),e.onExecuteExpression&&(o.onExecuteExpression=e.onExecuteExpression),e.onPropertyEditorUpdate&&(o.onPropertyEditorUpdate=e.onPropertyEditorUpdate),e.readOnly===!0&&(o.readOnly=!0),e.availableInMatrixColumn===!0&&(o.availableInMatrixColumn=!0),e.choices){var l=typeof e.choices=="function"?e.choices:null,u=typeof e.choices!="function"?e.choices:null;o.setChoices(u,l)}e.baseValue&&o.setBaseValue(e.baseValue),e.onSerializeValue&&(o.onSerializeValue=e.onSerializeValue),e.onGetValue&&(o.onGetValue=e.onGetValue),e.onSetValue&&(o.onSetValue=e.onSetValue),e.onSettingValue&&(o.onSettingValue=e.onSettingValue),e.isLocalizable&&(e.serializationProperty="loc"+o.name),e.serializationProperty&&(o.serializationProperty=e.serializationProperty,o.serializationProperty&&o.serializationProperty.indexOf("loc")==0&&(o.isLocalizable=!0)),e.isLocalizable&&(o.isLocalizable=e.isLocalizable),e.className&&(o.className=e.className),e.baseClassName&&(o.baseClassName=e.baseClassName,o.isArray=!0),o.isArray===!0&&(o.isArray=!0),e.classNamePart&&(o.classNamePart=e.classNamePart),e.alternativeName&&(o.alternativeName=e.alternativeName),e.oldName&&(o.oldName=e.oldName),e.layout&&(o.layout=e.layout),e.version&&(o.version=e.version),e.dependsOn&&this.addDependsOnProperties(o,e.dependsOn)}return this.properties.push(o),t&&!this.isOverridedProp(o.name)&&(o.isCustom=!0,Rs.addProperty(this.name,o)),o}}addDependsOnProperties(e,t){const s=Array.isArray(t)?t:[t];e.dependsOn=s;for(var i=0;i<s.length;i++)this.addDependsOnProperty(e,s[i])}addDependsOnProperty(e,t){var s=this.find(t);s||(s=q.findProperty(this.parentName,t)),s&&s.addDependedProperty(e.name)}getIsPropertyNameRequired(e){return e.length>0&&e[0]==cf.requiredSymbol}getPropertyName(e){return this.getIsPropertyNameRequired(e)&&(e=e.slice(1)),e}};Au.requiredSymbol="!",Au.typeSymbol=":";let MV=class{constructor(){this.classes={},this.alternativeNames={},this.childrenClasses={},this.dynamicPropsCache={}}getObjPropertyValue(e,t){if(this.isObjWrapper(e)&&this.isNeedUseObjWrapper(e,t)){const i=e.getOriginalObj(),r=q.findProperty(i.getType(),t);if(r)return this.getObjPropertyValueCore(i,r)}const s=q.findProperty(e.getType(),t);return s?this.getObjPropertyValueCore(e,s):e[t]}setObjPropertyValue(e,t,s){if(e[t]!==s)if(e[t]&&e[t].setJson)e[t].setJson(s,!0);else{if(Array.isArray(s)){const r=[];for(var i=0;i<s.length;i++)r.push(s[i]);s=r}e[t]=s}}getObjPropertyValueCore(e,t){if(!t.isPropertySerializable(e))return e[t.name];if(t.isLocalizable){if(t.isArray)return e[t.name];const s=e.getLocalizableString(t.name);if(s)return s.isDefautlLocale?s.text:s.getValue(s.locale);if(t.serializationProperty)return e[t.serializationProperty].text}return e.getPropertyValue(t.name)}isObjWrapper(e){return!!e.getOriginalObj&&!!e.getOriginalObj()}isNeedUseObjWrapper(e,t){if(!e.getDynamicProperties)return!0;const s=e.getDynamicProperties();if(!Array.isArray(s))return!1;for(let i=0;i<s.length;i++)if(s[i].name===t)return!0;return!1}addClass(e,t,s=null,i=null){e=e.toLowerCase();var r=new Au(e,t,s,i);if(this.classes[e]=r,i){i=i.toLowerCase();var a=this.childrenClasses[i];a||(this.childrenClasses[i]=[]),this.childrenClasses[i].push(r)}return r}removeClass(e){var t=this.findClass(e);if(t&&(delete this.classes[t.name],t.parentName)){var s=this.childrenClasses[t.parentName].indexOf(t);s>-1&&this.childrenClasses[t.parentName].splice(s,1)}}overrideClassCreatore(e,t){this.overrideClassCreator(e,t)}overrideClassCreator(e,t){e=e.toLowerCase();var s=this.findClass(e);s&&(s.creator=t)}getProperties(e){var t=this.findClass(e);return t?t.getAllProperties():[]}getPropertiesByObj(e){const t=e&&e.getType?e.getType():void 0;if(!t)return[];const s=this.getProperties(t),i=this.getDynamicPropertiesByObj(e);for(let r=i.length-1;r>=0;r--)this.findProperty(t,i[r].name)&&i.splice(r,1);return i.length===0?s:[].concat(s).concat(i)}addDynamicPropertiesIntoObj(e,t,s){s.forEach(i=>{this.addDynamicPropertyIntoObj(e,t,i.name,!1),i.serializationProperty&&this.addDynamicPropertyIntoObj(e,t,i.serializationProperty,!0),i.alternativeName&&this.addDynamicPropertyIntoObj(e,t,i.alternativeName,!1)})}addDynamicPropertyIntoObj(e,t,s,i){var r={configurable:!0,get:function(){return t[s]}};i||(r.set=function(a){t[s]=a}),Object.defineProperty(e,s,r)}getDynamicPropertiesByObj(e,t=null){if(!e||!e.getType)return[];if(e.getDynamicProperties)return e.getDynamicProperties();if(!e.getDynamicType&&!t)return[];const s=t||e.getDynamicType();return this.getDynamicPropertiesByTypes(e.getType(),s)}getDynamicPropertiesByTypes(e,t,s){if(!t)return[];const i=t+"-"+e;if(this.dynamicPropsCache[i])return this.dynamicPropsCache[i];var r=this.getProperties(t);if(!r||r.length==0)return[];const a={},o=this.getProperties(e);for(var l=0;l<o.length;l++)a[o[l].name]=o[l];const u=[];s||(s=[]);for(let d=0;d<r.length;d++){let h=r[d];if(this.canAddDynamicProp(h,a[h.name])){if(s.indexOf(h.name)>-1){const f=new gr(h.classInfo,h.name,h.isRequired);f.mergeWith(h),h=f,h.visible=!1,h.isSerializable=!1}u.push(h)}}return this.dynamicPropsCache[i]=u,u}canAddDynamicProp(e,t){if(!t)return!0;if(e===t)return!1;let s=e.classInfo;for(;s&&s.parentName;){if(e=this.findProperty(s.parentName,e.name),e&&e===t)return!0;s=e?e.classInfo:void 0}return!1}hasOriginalProperty(e,t){return!!this.getOriginalProperty(e,t)}getOriginalProperty(e,t){var s=this.findProperty(e.getType(),t);return s||(this.isObjWrapper(e)?this.findProperty(e.getOriginalObj().getType(),t):null)}getProperty(e,t){const s=this.findProperty(e,t);if(!s)return s;const i=this.findClass(e);if(s.classInfo===i)return s;const r=new gr(i,s.name,s.isRequired);return r.mergeWith(s),i.properties.push(r),i.resetAllProperties(),r}findProperty(e,t){const s=this.findClass(e);return s?s.findProperty(t):null}findProperties(e,t){var s=new Array;const i=this.findClass(e);if(!i)return s;for(var r=0;r<t.length;r++){var a=i.findProperty(t[r]);a&&s.push(a)}return s}getAllPropertiesByName(e){for(var t=new Array,s=this.getAllClasses(),i=0;i<s.length;i++)for(var r=this.findClass(s[i]),a=0;a<r.properties.length;a++)if(r.properties[a].name==e){t.push(r.properties[a]);break}return t}getAllClasses(){var e=new Array;for(var t in this.classes)e.push(t);return e}createClass(e,t=void 0){e=e.toLowerCase();var s=this.findClass(e);if(!s)return null;if(s.creator)return s.creator(t);for(var i=s.parentName;i;){if(s=this.findClass(i),!s)return null;if(i=s.parentName,s.creator)return this.createCustomType(e,s.creator,t)}return null}createCustomType(e,t,s=void 0){e=e.toLowerCase();var i=t(s),r=e,a=i.getTemplate?i.getTemplate():i.getType();return i.getType=function(){return r},i.getTemplate=function(){return a},Rs.createProperties(i),i}getChildrenClasses(e,t=!1){e=e.toLowerCase();var s=[];return this.fillChildrenClasses(e,t,s),s}getRequiredProperties(e){const t=this.findClass(e);if(!t)return[];const s=t.getRequiredProperties();for(var i=[],r=0;r<s.length;r++)i.push(s[r].name);return i}addProperties(e,t){e=e.toLowerCase();for(var s=this.findClass(e),i=0;i<t.length;i++)this.addCustomPropertyCore(s,t[i])}addProperty(e,t){return this.addCustomPropertyCore(this.findClass(e),t)}addCustomPropertyCore(e,t){if(!e)return null;var s=e.createProperty(t,!0);return s&&(this.clearDynamicPropsCache(e),e.resetAllProperties()),s}removeProperty(e,t){var s=this.findClass(e);if(!s)return!1;var i=s.find(t);i&&(this.clearDynamicPropsCache(s),this.removePropertyFromClass(s,i),s.resetAllProperties(),Rs.removeProperty(s.name,t))}clearDynamicPropsCache(e){this.dynamicPropsCache={}}removePropertyFromClass(e,t){var s=e.properties.indexOf(t);s<0||e.properties.splice(s,1)}fillChildrenClasses(e,t,s){var i=this.childrenClasses[e];if(i)for(var r=0;r<i.length;r++)(!t||i[r].creator)&&s.push(i[r]),this.fillChildrenClasses(i[r].name,t,s)}findClass(e){e=e.toLowerCase();var t=this.classes[e];if(!t){var s=this.alternativeNames[e];if(s&&s!=e)return this.findClass(s)}return t}isDescendantOf(e,t){if(!e||!t)return!1;e=e.toLowerCase(),t=t.toLowerCase();var s=this.findClass(e);if(!s)return!1;var i=s;do{if(i.name===t)return!0;i=this.classes[i.parentName]}while(i);return!1}addAlterNativeClassName(e,t){this.alternativeNames[t.toLowerCase()]=e.toLowerCase()}generateSchema(e=void 0){e||(e="survey");var t=this.findClass(e);if(!t)return null;var s={$schema:"http://json-schema.org/draft-07/schema#",title:"SurveyJS Library json schema",type:"object",properties:{},definitions:{locstring:this.generateLocStrClass()}};return this.generateSchemaProperties(t,s,s.definitions,!0),s}generateLocStrClass(){const e={},t=q.findProperty("survey","locale");if(t){const s=t.getChoices(null);Array.isArray(s)&&(s.indexOf("en")<0&&s.splice(0,0,"en"),s.splice(0,0,"default"),s.forEach(i=>{i&&(e[i]={type:"string"})}))}return{$id:"locstring",type:"object",properties:e}}generateSchemaProperties(e,t,s,i){if(!e)return;const r=t.properties,a=[];e.name==="question"&&(r.type={type:"string"},a.push("type"));for(let o=0;o<e.properties.length;o++){const l=e.properties[o];l.isSerializable!==!1&&(e.parentName&&q.findProperty(e.parentName,l.name)||(r[l.name]=this.generateSchemaProperty(l,s,i),l.isRequired&&a.push(l.name)))}a.length>0&&(t.required=a)}generateSchemaProperty(e,t,s){if(e.isLocalizable)return{oneOf:[{type:"string"},{$ref:this.getChemeRefName("locstring",s)}]};const i=e.schemaType(),r=e.schemaRef();var a={};if(i&&(a.type=i),e.hasChoices){const d=e.getChoices(null);Array.isArray(d)&&d.length>0&&(a.enum=this.getChoicesValues(d))}if(r&&(i==="array"?e.className==="string"?a.items={type:e.className}:a.items={$ref:this.getChemeRefName(e.className,s)}:a.$ref=this.getChemeRefName(r,s),this.generateChemaClass(e.className,t,!1)),e.baseClassName){var o=this.getChildrenClasses(e.baseClassName,!0);e.baseClassName=="question"&&o.push(this.findClass("panel")),a.items={anyOf:[]};for(var l=0;l<o.length;l++){var u=o[l].name;a.items.anyOf.push({$ref:this.getChemeRefName(u,s)}),this.generateChemaClass(u,t,!1)}}return a}getChemeRefName(e,t){return t?"#/definitions/"+e:e}generateChemaClass(e,t,s){if(t[e])return;var i=this.findClass(e);if(!i)return;var r=!!i.parentName&&i.parentName!="base";r&&this.generateChemaClass(i.parentName,t,s);const a={type:"object",$id:e};t[e]=a;const o={properties:{}};this.generateSchemaProperties(i,o,t,s),r?a.allOf=[{$ref:this.getChemeRefName(i.parentName,s)},{properties:o.properties}]:a.properties=o.properties,Array.isArray(o.required)&&(a.required=o.required)}getChoicesValues(e){const t=new Array;return e.forEach(s=>{typeof s=="object"&&s.value!==void 0?t.push(s.value):t.push(s)}),t}},Zr=class{constructor(e,t){this.type=e,this.message=t,this.description="",this.at=-1,this.end=-1}getFullDescription(){return this.message+(this.description?`
`+this.description:"")}},kV=class extends Zr{constructor(e,t){super("unknownproperty","Unknown property in class '"+t+"': '"+e+"'."),this.propertyName=e,this.className=t}},Kf=class extends Zr{constructor(e,t,s){super(t,s),this.baseClassName=e,this.type=t,this.message=s}},NV=class extends Kf{constructor(e,t){super(t,"missingtypeproperty","The property type is missing in the object. Please take a look at property: '"+e+"'."),this.propertyName=e,this.baseClassName=t}},qV=class extends Kf{constructor(e,t){super(t,"incorrecttypeproperty","The property type is incorrect in the object. Please take a look at property: '"+e+"'."),this.propertyName=e,this.baseClassName=t}},BV=class extends Zr{constructor(e,t){super("requiredproperty","The property '"+e+"' is required in class '"+t+"'."),this.propertyName=e,this.className=t}},FV=class extends Zr{constructor(e,t){super("arrayproperty","The property '"+e+"' should be an array in '"+t+"'."),this.propertyName=e,this.className=t}},QV=class extends Zr{constructor(e,t){super("incorrectvalue","The property value: '"+t+"' is incorrect for property '"+e.name+"'."),this.property=e,this.value=t}},qt=class xi{constructor(){this.errors=new Array,this.lightSerializing=!1}static get metaData(){return xi.metaDataValue}toJsonObject(e,t){return this.toJsonObjectCore(e,null,t)}toObject(e,t,s){this.toObjectCore(e,t,s);var i=this.getRequiredError(t,e);i&&this.addNewError(i,e,t)}toObjectCore(e,t,s){if(!e)return;var i=null,r=void 0,a=!0;if(t.getType&&(r=t.getType(),i=q.getProperties(r),a=!!r&&!q.isDescendantOf(r,"itemvalue")),!i)return;t.startLoadingFromJson&&t.startLoadingFromJson(e),i=this.addDynamicProperties(t,e,i),this.options=s;const o={};o[xi.typePropertyName]=!0;const l={};for(var u in e)this.setPropertyValueToObj(e,t,u,i,o,l,r,a,s);this.options=void 0,t.endLoadingFromJson&&t.endLoadingFromJson()}setPropertyValueToObj(e,t,s,i,r,a,o,l,u){if(r[s])return;if(s===xi.positionPropertyName){t[s]=e[s];return}const d=this.findProperty(i,s);if(!d&&l&&this.addNewError(new kV(s.toString(),o),e,t),d){const h=d.dependsOn;Array.isArray(h)&&(a[s]=!0,h.forEach(f=>{a[f]||this.setPropertyValueToObj(e,t,f,i,r,a,o,!1,u)})),this.valueToObj(e[s],t,d,e,u),r[s]=!0}}toJsonObjectCore(e,t,s){if(!e||!e.getType)return e;if(!e.isSurvey&&typeof e.getData=="function")return e.getData();var i={};t!=null&&!t.className&&(i[xi.typePropertyName]=t.getObjType(e.getType()));const r=s===!0;return(!s||s===!0)&&(s={}),r&&(s.storeDefaults=r),this.propertiesToJson(e,q.getProperties(e.getType()),i,s),this.propertiesToJson(e,this.getDynamicProperties(e),i,s),i}getDynamicProperties(e){return q.getDynamicPropertiesByObj(e)}addDynamicProperties(e,t,s){if(!e.getDynamicPropertyName&&!e.getDynamicProperties)return s;if(e.getDynamicPropertyName){const r=e.getDynamicPropertyName();if(!r)return s;r&&t[r]&&(e[r]=t[r])}const i=this.getDynamicProperties(e);return i.length===0?s:[].concat(s).concat(i)}propertiesToJson(e,t,s,i){for(var r=0;r<t.length;r++)this.valueToJson(e,s,t[r],i)}valueToJson(e,t,s,i){i||(i={}),!(!s.isPropertySerializable(e)||s.isLightSerializable===!1&&this.lightSerializing)&&(i.version&&!s.isAvailableInVersion(i.version)||this.valueToJsonCore(e,t,s,i))}valueToJsonCore(e,t,s,i){const r=s.getSerializedProperty(e,i.version);if(r&&r!==s){this.valueToJsonCore(e,t,r,i);return}var a=s.getSerializableValue(e,i.storeDefaults);if(a===void 0)return;if(this.isValueArray(a)){for(var o=[],l=0;l<a.length;l++)o.push(this.toJsonObjectCore(a[l],s,i));a=o.length>0?o:null}else a=this.toJsonObjectCore(a,s,i);if(a==null)return;const u=s.getSerializedName(i.version);var d=typeof e.getPropertyValue=="function"&&e.getPropertyValue(u,null)!==null;(i.storeDefaults&&d||!s.isDefaultValueByObj(e,a))&&(!q.onSerializingProperty||!q.onSerializingProperty(e,s,a,t))&&(t[u]=this.removePosOnValueToJson(s,a))}valueToObj(e,t,s,i,r){if(e!=null){if(this.removePos(s,e),s!=null&&s.hasToUseSetValue){s.setValue(t,e,this);return}if(s.isArray&&!Array.isArray(e)&&e){e=[e];const o=i&&s.alternativeName&&i[s.alternativeName]?s.alternativeName:s.name;this.addNewError(new FV(o,t.getType()),i||e,t)}if(this.isValueArray(e)){this.valueToArray(e,t,s.name,s,r);return}var a=this.createNewObj(e,s);a.newObj&&(this.toObjectCore(e,a.newObj,r),e=a.newObj),a.error||(s!=null?(s.setValue(t,e,this),r&&r.validatePropertyValues&&(s.validateValue(e)||this.addNewError(new QV(s,e),i,t))):t[s.name]=e)}}removePosOnValueToJson(e,t){return!e.isCustom||!t||this.removePosFromObj(t),t}removePos(e,t){!e||!e.type||e.type.indexOf("value")<0||this.removePosFromObj(t)}removePosFromObj(e){if(!(!e||typeof e.getType=="function")){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.removePosFromObj(e[t]);if(typeof e=="object"){e[xi.positionPropertyName]&&delete e[xi.positionPropertyName];for(let s in e)this.removePosFromObj(e[s])}}}isValueArray(e){return e&&Array.isArray(e)}createNewObj(e,t){var s={newObj:null,error:null};const i=this.getClassNameForNewObj(e,t);return s.newObj=i?q.createClass(i,e):null,s.error=this.checkNewObjectOnErrors(s.newObj,e,t,i),s}getClassNameForNewObj(e,t){var s=t!=null&&t.className?t.className:void 0;if(s||(s=e[xi.typePropertyName]),!s)return s;s=s.toLowerCase();const i=t.classNamePart;return i&&s.indexOf(i)<0&&(s+=i),s}checkNewObjectOnErrors(e,t,s,i){var r=null;return e?r=this.getRequiredError(e,t):s.baseClassName&&(i?r=new qV(s.name,s.baseClassName):r=new NV(s.name,s.baseClassName)),r&&this.addNewError(r,t,e),r}getRequiredError(e,t){if(!e.getType||typeof e.getData=="function")return null;const s=q.findClass(e.getType());if(!s)return null;const i=s.getRequiredProperties();if(!Array.isArray(i))return null;for(var r=0;r<i.length;r++){const a=i[r];if(O.isValueEmpty(a.defaultValue)&&!t[a.name])return new BV(a.name,e.getType())}return null}addNewError(e,t,s){if(e.jsonObj=t,e.element=s,this.errors.push(e),!t)return;const i=t[xi.positionPropertyName];i&&(e.at=i.start,e.end=i.end)}valueToArray(e,t,s,i,r){if(!(t[s]&&!this.isValueArray(t[s]))){t[s]&&e.length>0&&t[s].splice(0,t[s].length);var a=t[s]?t[s]:[];this.addValuesIntoArray(e,a,i,r),t[s]||(t[s]=a)}}addValuesIntoArray(e,t,s,i){for(var r=0;r<e.length;r++){var a=this.createNewObj(e[r],s);a.newObj?(e[r].name&&(a.newObj.name=e[r].name),e[r].valueName&&(a.newObj.valueName=e[r].valueName.toString()),t.push(a.newObj),this.toObjectCore(e[r],a.newObj,i)):a.error||t.push(e[r])}}findProperty(e,t){if(!e)return null;for(var s=0;s<e.length;s++){var i=e[s];if(i.name==t||i.alternativeName==t)return i}return null}};qt.typePropertyName="type",qt.positionPropertyName="pos",qt.metaDataValue=new MV;var q=qt.metaData;let Ii=class{constructor(){}getValueInfo(e){const t=this.getValueInfoCore(e);return!t.isFound&&t.value===void 0&&e.name.endsWith(".length")&&(t.isFound=!0,t.value=0),t}getValueInfoCore(e){const t=e.name,s=e.context;let i=this.run(e.name,s,e.createObjects);if((!i||!i.isFound)&&s&&s.getRootObj){const a=s.getRootObj();if(a)return e.context=a.getValueGetterContext(),this.getValueInfo(e)}const r={isFound:!1,value:void 0};return!i||!i.isFound||(r.isFound=!0,r.value=i.value,r.strictCompare=i.requireStrictCompare,i.context&&(e.isText&&i.context.getTextValue&&(r.value=i.context.getTextValue(t,r.value,e.isDisplayValue)),i.context.getQuestion&&(r.question=i.context.getQuestion()))),r}getValue(e,t,s,i){const r=this.getValueInfo({name:e,context:t,isText:s,isDisplayValue:i});return r.isFound?r.value:void 0}getDisplayValue(e,t,s=!0){return this.getValue(e,t,!0,s)}isAnyKeyChanged(e,t){for(var s=0;s<t.length;s++){const a=t[s];if(!a)continue;const o=a.toLowerCase();if(e.hasOwnProperty(a)||a!==o&&e.hasOwnProperty(o))return!0;const l=this.getFirstNameByKeys(e,a);if(!l)continue;if(a===l)return!0;const u=e[l];if(u==null)continue;if(!u.hasOwnProperty("oldValue")||!u.hasOwnProperty("newValue"))return!0;const d={};d[l]=u.oldValue;var i=this.getValueFromObject(d,a);d[l]=u.newValue;var r=this.getValueFromObject(d,a);if(!O.isTwoValueEquals(i,r,!1,!1,!1))return!0}return!1}getFirstNameByKeys(e,t){const s=this.getPath(t);let i="";for(let r=0;r<s.length;r++)if(i+=(r>0?".":"")+s[r].name,e.hasOwnProperty(i))return i;return""}getValueFromObject(e,t){const s=this.getValueInfo({name:t,context:new fs(e)});return s.isFound?s.value:void 0}run(e,t,s){if(!t)return;let i=this.getPath(e);const r=t.getValue(i,!0,-1,s);return r&&r.isFound?r:void 0}getPath(e){const t=[],s=e.split(".");for(let i=0;i<s.length;i++)t.push(this.getValueItem(s[i]));return t}getValueItem(e){let t;if(e.lastIndexOf("]")===e.length-1){const i=e.lastIndexOf("[");if(i>-1){const r=e.substring(i+1,e.length-1);t=O.getNumber(r),(isNaN(t)||t<0)&&(t=void 0),t!==void 0&&(e=e.substring(0,i))}}const s={name:e};return t!==void 0&&(s.index=t),s}},ji=class{constructor(){}getValue(e,t,s,i){let r=0;const a={isFound:!1,value:this.getInitialvalue(),context:this};for(;r<e.length;){if(r=this.checkValueByPath(e,r,a),!a.isFound)return;const o=e[r];if(r++,a.context!==this&&a.context)return a.context.getValue([].concat(e.slice(r)),!1,o.index,i);if(o.index!==void 0&&(this.updateItemByIndex(o.index,a),!a.isFound))return}return a}isSearchNameRevert(){return!1}checkValueByPath(e,t,s){const i=this.isSearchNameRevert(),r=t,a=this.getMaxIndexByPath(e,t);for(s.isFound=!1,i&&(t=a);!s.isFound&&t<=a&&t>=r;){const o=this.getNameByPath(e,r,t+1);if(this.updateValueByItem(o,s),s.isFound)break;t+=i?-1:1}return t}getNameByPath(e,t,s){let i="";for(let r=t;r<s;r++)r>t&&(i+="."),i+=e[r].name;return i}getMaxIndexByPath(e,t){let s=t;for(;s<e.length&&e[s].index===void 0;)s++;return s<e.length?s:e.length-1}getTextValue(e,t,s){return s?t==null?"":t.toString():t}getInitialvalue(){}updateValueByItem(e,t){}updateItemByIndex(e,t){}},fs=class extends ji{constructor(e){super(),this.variables=e}getInitialvalue(){return this.variables}isSearchNameRevert(){return!0}updateValueByItem(e,t){const s=this.getValueByItemCore(t.value,e);t.isFound=s!==void 0,t.isFound&&(t.value=s)}updateItemByIndex(e,t){const s=t.value;Array.isArray(s)&&e<s.length?(t.value=s[e],t.isFound=!0):t.isFound=!1}getValueByItemCore(e,t){if(!e||!t)return;const s=t.toLowerCase();if(t==="length"&&(Array.isArray(e)||typeof e=="string"))return e.length;if(typeof e!="object")return;let i=s[0],r=t[0].toLocaleUpperCase();for(var a in e){var o=a[0];if(o===i||o===r){var l=a.toLowerCase();if(l==s)return e[a]}}}},HV=class extends fs{constructor(e){super(e),this.obj=e}getValueByItemCore(e,t){if(!(!e||!t))return e[t]}},Du=class extends fs{constructor(e,t){super(e),this.second=t}getValue(e,t,s,i){const r=super.getValue(e,t,s,i);return!this.second||r?.isFound?r:this.second.getValue(e,t,s,i)}},zV=class{constructor(e){this.properties=null,this.asyncValues={},this.contextValue=e}get context(){return this.contextValue}hasValue(e){return this.context?this.getValueInfoByContext(e).isFound:!1}getValue(e){if(this.context)return this.getValueInfoByContext(e).value}getValueInfoByContext(e){return new Ii().getValueInfo({name:e,context:this.context,isText:!1})}getValueInfo(e){if(this.context){const t=this.getValueInfoByContext(e.name);e.value=t.value,e.hasValue=t.isFound,e.strictCompare=t.strictCompare;return}return{hasValue:!1}}},ri=class pf{static disposedObjectChangedProperty(e,t){pf.warn('An attempt to set a property "'+e+'" of a disposed object "'+t+'"')}static inCorrectQuestionValue(e,t){const s=JSON.stringify(t,null,3);pf.warn("An attempt to assign an incorrect value"+s+' to the following question: "'+e+'"')}static warn(e){console.warn(e)}static error(e){console.error(e)}},_e=class{constructor(){this.functionHash={},this.isAsyncHash={}}register(e,t,s=!1){this.functionHash[e]=t,s&&(this.isAsyncHash[e]=!0)}unregister(e){delete this.functionHash[e],delete this.isAsyncHash[e]}hasFunction(e){return!!this.functionHash[e]}isAsyncFunction(e){return!!this.isAsyncHash[e]}clear(){this.functionHash={}}getAll(){var e=[];for(var t in this.functionHash)e.push(t);return e.sort()}run(e,t,s=null,i){const r=this.functionHash[e];if(!r)return ri.warn(this.getUnknownFunctionErrorText(e,s)),null;let a={func:r};if(s)for(var o in s)a[o]=s[o];return a.func(t,i)}getUnknownFunctionErrorText(e,t){return"Unknown function name: '"+e+"'."+Ua.getQuestionErrorText(t)}};_e.Instance=new _e,_e.Instance.register;function Ui(n,e){if(n!=null)if(Array.isArray(n))for(var t=0;t<n.length;t++)Ui(n[t],e);else O.isNumber(n)&&(n=O.getNumber(n)),e.push(n)}function Zf(n){var e=[];Ui(n,e);for(var t=0,s=0;s<e.length;s++)t=O.correctAfterPlusMinis(t,e[s],t+e[s]);return t}_e.Instance.register("sum",Zf);function Yf(n,e){var t=[];Ui(n,t);for(var s=void 0,i=0;i<t.length;i++)s===void 0&&(s=t[i]),e?s>t[i]&&(s=t[i]):s<t[i]&&(s=t[i]);return s}function jV(n){return Yf(n,!0)}_e.Instance.register("min",jV);function UV(n){return Yf(n,!1)}_e.Instance.register("max",UV);function WV(n){var e=[];return Ui(n,e),e.length}_e.Instance.register("count",WV);function $V(n){var e=[];Ui(n,e);const t=Zf(n);return e.length>0?t/e.length:0}_e.Instance.register("avg",$V);function GV(n){var e=[];if(Ui(n,e),e.length>0){const t=e[0],s=e[1]||0;if(O.isNumber(t)&&O.isNumber(s)){const i=Math.pow(10,s),r=t*i*(1+Number.EPSILON);return Math.round(r)/i}}return NaN}_e.Instance.register("round",GV);function JV(n){var e=[];if(Ui(n,e),e.length>0){const t=e[0],s=e[1]||-1;if(O.isNumber(t)&&O.isNumber(s)){const i=new RegExp("^-?\\d+(?:.\\d{0,"+s+"})?");return Number(t.toString().match(i)[0])}}return NaN}_e.Instance.register("trunc",JV);function KV(n,e){if(n.length<2||n.length>3)return null;const t=n[0];if(!t||!Array.isArray(t)&&!Array.isArray(Object.keys(t)))return null;const s=n[1];if(typeof s!="string"&&!(s instanceof String))return null;let i=n.length>2?n[2]:void 0;if(typeof i!="string"&&!(i instanceof String)&&(i=void 0),!i){const r=Array.isArray(e)&&e.length>2?e[2]:void 0;r&&r.toString()&&(i=r.toString())}return{data:t,name:s,expression:i}}function ZV(n){return typeof n=="string"?O.isNumber(n)?O.getNumber(n):void 0:n}function Xf(n,e,t,s,i,r,a){if(!n||O.isValueEmpty(n[e])||r&&!r.runValues(n,a))return t;const o=i?ZV(n[e]):1;return s(t,o)}function za(n,e,t,s,i=!0){var r=KV(e,t);if(!r)return;let a=r.expression?new Fs(r.expression):void 0;a&&a.isAsync&&(a=void 0);var o=void 0;if(Array.isArray(r.data))for(var l=0;l<r.data.length;l++)o=Xf(r.data[l],r.name,o,s,i,a,n);else for(var u in r.data)o=Xf(r.data[u],r.name,o,s,i,a,n);return o}function Yr(n){var e;return{survey:n.survey,question:n.question,context:(e=n.survey)===null||e===void 0?void 0:e.getValueGetterContext()}}function YV(n,e){var t=za(Yr(this),n,e,function(s,i){return s==null&&(s=0),i==null||i==null?s:O.correctAfterPlusMinis(s,i,s+i)});return t!==void 0?t:0}_e.Instance.register("sumInArray",YV);function XV(n,e){return za(Yr(this),n,e,function(t,s){return t==null?s:s==null||s==null||t<s?t:s})}_e.Instance.register("minInArray",XV);function e2(n,e){return za(Yr(this),n,e,function(t,s){return t==null?s:s==null||s==null||t>s?t:s})}_e.Instance.register("maxInArray",e2);function t2(n,e){var t=za(Yr(this),n,e,function(s,i){return s==null&&(s=0),i==null||i==null?s:s+1},!1);return t!==void 0?t:0}_e.Instance.register("countInArray",t2);function s2(n,e){const t=Yr(this),s=r=>_e.Instance.run(r,n,t,e),i=s("countInArray");return i==0?0:s("sumInArray")/i}_e.Instance.register("avgInArray",s2);function i2(n){if(!Array.isArray(n)||n.length<2)return null;const e=n.length>2?n[2]:void 0;return n[0]?n[1]:e}_e.Instance.register("iif",i2);function r2(n){return!Array.isArray(n)||n.length<1||!n[0]?null:Rt("function-getDate",n[0])}_e.Instance.register("getDate",r2);function ey(n,e,t){if(t==="days")return iy([n,e]);const s=Rt("function-dateDiffMonths",n),i=Rt("function-dateDiffMonths",e),r=i.getFullYear()-s.getFullYear();t=t||"years";let a=r*12+i.getMonth()-s.getMonth();return i.getDate()<s.getDate()&&(a-=1),t==="months"?a:~~(a/12)}function n2(n){return!Array.isArray(n)||n.length<1||!n[0]?null:ey(n[0],void 0,(n.length>1?n[1]:"")||"years")}_e.Instance.register("age",n2);function a2(n){if(!Array.isArray(n)||n.length<2||!n[0]||!n[1])return null;const e=(n.length>2?n[2]:"")||"days",t=e==="hours"||e==="minutes"||e==="seconds",s=t?"days":e;let i=ey(n[0],n[1],s);if(t){const r=Rt("function-dateDiffMonths",n[0]),a=Rt("function-dateDiffMonths",n[1]);(a.getHours()>r.getHours()||e!=="hours"&&a.getHours()===r.getHours()&&a.getMinutes()>r.getMinutes())&&(i-=1);let o=i*24+a.getHours()-r.getHours();if(e==="hours")return o;a.getMinutes()<r.getMinutes()&&(o-=1);const l=o*60+a.getMinutes()-r.getMinutes();return e==="minutes"?l:l*60+a.getSeconds()-r.getSeconds()}return i}_e.Instance.register("dateDiff",a2);function o2(n){if(!Array.isArray(n)||n.length<2||!n[0]||!n[1])return null;const e=Rt("function-dateAdd",n[0]),t=n[1],s=n[2]||"days";return s==="days"&&e.setDate(e.getDate()+t),s==="months"&&e.setMonth(e.getMonth()+t),s==="years"&&e.setFullYear(e.getFullYear()+t),e}_e.Instance.register("dateAdd",o2);function ty(n){if(!n)return!1;for(var e=n.questions,t=0;t<e.length;t++)if(!e[t].validate(!1))return!1;return!0}function l2(n){if(!n&&n.length<1||!n[0]||!this.survey)return!1;const e=n[0];let t=this.survey.getPageByName(e);if(t||(t=this.survey.getPanelByName(e)),!t){const s=this.survey.getQuestionByName(e);if(!s||!Array.isArray(s.panels))return!1;if(n.length>1)n[1]<s.panels.length&&(t=s.panels[n[1]]);else{for(let i=0;i<s.panels.length;i++)if(!ty(s.panels[i]))return!1;return!0}}return ty(t)}_e.Instance.register("isContainerReady",l2);function u2(){return this.survey&&this.survey.isDisplayMode}_e.Instance.register("isDisplayMode",u2);function h2(){return Rt("function-currentDate")}_e.Instance.register("currentDate",h2);function sy(n){var e=Rt("function-today");return A.storeUtcDates?e.setUTCHours(0,0,0,0):e.setHours(0,0,0,0),Array.isArray(n)&&n.length==1&&e.setDate(e.getDate()+n[0]),e}_e.Instance.register("today",sy);function d2(n){if(!(n.length!==1||!n[0]))return Rt("function-getYear",n[0]).getFullYear()}_e.Instance.register("getYear",d2);function c2(){return Rt("function-currentYear").getFullYear()}_e.Instance.register("currentYear",c2);function iy(n){if(!Array.isArray(n)||n.length!==2||!n[0]||!n[1])return 0;const e=Rt("function-diffDays",n[0]),t=Rt("function-diffDays",n[1]),s=Math.abs(t-e);return Math.ceil(s/(1e3*60*60*24))}_e.Instance.register("diffDays",iy);function ja(n,e){let t=sy(void 0);return e&&e[0]&&(t=Rt("function-"+n,e[0])),t}function p2(n){return ja("year",n).getFullYear()}_e.Instance.register("year",p2);function g2(n){return ja("month",n).getMonth()+1}_e.Instance.register("month",g2);function m2(n){return ja("day",n).getDate()}_e.Instance.register("day",m2);function f2(n){return ja("weekday",n).getDay()}_e.Instance.register("weekday",f2);function ry(n,e){if(!n||!e)return;let t=n.question;for(;t&&t.parent;){const i=t.parent.getQuestionByName(e);if(i)return i;t=t.parentQuestion}const s=["row","panel","survey"];for(let i=0;i<s.length;i++){const r=n[s[i]];if(r&&r.getQuestionByName){const a=r.getQuestionByName(e);if(a)return a}}return null}function ny(n,e){return e.length>1&&!O.isValueEmpty(e[1])?n.getDisplayValue(!0,e[1]):n.displayValue}function y2(n){const e=ry(this,n[0]);if(!e)return"";if(e.isReady)this.returnResult(ny(e,n));else{const t=(s,i)=>{s.isReady&&(s.onReadyChanged.remove(t),this.returnResult(ny(s,n)))};e.onReadyChanged.add(t)}}_e.Instance.register("displayValue",y2,!0);function v2(n){if(n.length!==2||!n[0]||!n[1])return;const e=ry(this,n[0]);return e?e[n[1]]:void 0}_e.Instance.register("propertyValue",v2);function C2(n){if(n.length<2)return"";const e=n[0];if(!e||typeof e!="string")return"";const t=n[1];if(!O.isNumber(t))return"";const s=n.length>2?n[2]:void 0;return O.isNumber(s)?e.substring(t,s):e.substring(t)}_e.Instance.register("substring",C2);function b2(n){if(n.length<1||!n[0]||!this.survey)return;const e=this.survey.getQuestionByName(n[0]);if(!e)return"";const t=n.length>1?n[1]:void 0;if(t!=null){const s=e.getItemByValue(t);return s?e.getCommentValue(s):void 0}return e.getCommentValue(e.otherItem)||e.comment}_e.Instance.register("getComment",b2);let mr=class Dw{constructor(){this._id=Dw.counter++}get id(){return this._id}toString(e=void 0){return""}hasFunction(){return!1}hasAsyncFunction(){return!1}addToAsyncList(e){}addOperandsToList(e){e.push(this),this.addChildrenToList(e)}isEqual(e){return!!e&&e.getType()===this.getType()&&this.isContentEqual(e)}areOperatorsEquals(e,t){return!e&&!t||!!e&&e.isEqual(t)}addChildrenToList(e){}};mr.counter=1;let w2=class extends mr{constructor(e,t=null,s=null,i=!1){super(),this.operatorName=e,this.left=t,this.right=s,this.isArithmeticValue=i,i?this.consumer=Ne.binaryFunctions.arithmeticOp(e):this.consumer=Ne.binaryFunctions[e],this.consumer==null&&Ne.throwInvalidOperatorError(e)}get requireStrictCompare(){return this.getIsOperandRequireStrict(this.left)||this.getIsOperandRequireStrict(this.right)}getIsOperandRequireStrict(e){return!!e&&e.requireStrictCompare}getType(){return"binary"}get isArithmetic(){return this.isArithmeticValue}get isConjunction(){return this.operatorName=="or"||this.operatorName=="and"}get conjunction(){return this.isConjunction?this.operatorName:""}get operator(){return this.operatorName}get leftOperand(){return this.left}get rightOperand(){return this.right}isContentEqual(e){const t=e;return t.operator===this.operator&&this.areOperatorsEquals(this.left,t.left)&&this.areOperatorsEquals(this.right,t.right)}evaluateParam(e,t){return e==null?null:e.evaluate(t)}evaluate(e){return this.consumer.call(this,this.evaluateParam(this.left,e),this.evaluateParam(this.right,e),this.requireStrictCompare)}toString(e=void 0){if(e){var t=e(this);if(t)return t}return"("+Ne.safeToString(this.left,e)+" "+Ne.operatorToString(this.operatorName)+" "+Ne.safeToString(this.right,e)+")"}setVariables(e){this.left!=null&&this.left.setVariables(e),this.right!=null&&this.right.setVariables(e)}hasFunction(){return!!this.left&&this.left.hasFunction()||!!this.right&&this.right.hasFunction()}addChildrenToList(e){this.left&&this.left.addOperandsToList(e),this.right&&this.right.addOperandsToList(e)}hasAsyncFunction(){return!!this.left&&this.left.hasAsyncFunction()||!!this.right&&this.right.hasAsyncFunction()}addToAsyncList(e){this.left&&this.left.addToAsyncList(e),this.right&&this.right.addToAsyncList(e)}},ay=class extends mr{constructor(e,t){super(),this.expressionValue=e,this.operatorName=t,this.consumer=Ne.unaryFunctions[t],this.consumer==null&&Ne.throwInvalidOperatorError(t)}get operator(){return this.operatorName}get expression(){return this.expressionValue}getType(){return"unary"}toString(e=void 0){if(e){var t=e(this);if(t)return t}const s=Ne.operatorToString(this.operator),i=this.expression.toString(e);return this.isRigtOperator?i+" "+s:s+" "+i}get isRigtOperator(){const e=this.operatorName.toLowerCase();return e==="notempty"||e==="empty"}isContentEqual(e){const t=e;return t.operator==this.operator&&this.areOperatorsEquals(this.expression,t.expression)}hasFunction(){return this.expression.hasFunction()}addChildrenToList(e){this.expression.addOperandsToList(e)}hasAsyncFunction(){return this.expression.hasAsyncFunction()}addToAsyncList(e){this.expression.addToAsyncList(e)}evaluate(e){let t=this.expression.evaluate(e);return this.consumer.call(this,t)}setVariables(e){this.expression.setVariables(e)}},Ou=class extends mr{constructor(e){super(),this.values=e}getType(){return"array"}toString(e=void 0){if(e){var t=e(this);if(t)return t}return"["+this.values.map(function(s){return s.toString(e)}).join(", ")+"]"}evaluate(e){return this.values.map(function(t){return t.evaluate(e)})}setVariables(e){this.values.forEach(t=>{t.setVariables(e)})}hasFunction(){return this.values.some(e=>e.hasFunction())}addChildrenToList(e){this.values.forEach(t=>{t.addOperandsToList(e)})}hasAsyncFunction(){return this.values.some(e=>e.hasAsyncFunction())}addToAsyncList(e){this.values.forEach(t=>t.addToAsyncList(e))}isContentEqual(e){const t=e;if(t.values.length!==this.values.length)return!1;for(var s=0;s<this.values.length;s++)if(!t.values[s].isEqual(this.values[s]))return!1;return!0}},oy=class extends mr{constructor(e){super(),this.value=e}getType(){return"const"}toString(e=void 0){if(e){var t=e(this);if(t)return t}return this.value.toString()}get correctValue(){return this.getCorrectValue(this.value)}get requireStrictCompare(){return!1}evaluate(){return this.getCorrectValue(this.value)}setVariables(e){}getCorrectValue(e){if(!e||typeof e!="string")return e;if(Ne.isBooleanValue(e))return e.toLowerCase()==="true";if(e.length>1&&this.isQuote(e[0])&&this.isQuote(e[e.length-1]))return e.substring(1,e.length-1);if(O.isNumber(e)){if(e[0]==="0"&&e.indexOf("0x")!=0){const t=e.length,s=t>1&&(e[1]==="."||e[1]===",");if(!s&&t>1||s&&t<2)return e}return O.getNumber(e)}return e}isContentEqual(e){return e.value==this.value}isQuote(e){return e=="'"||e=='"'}},x2=class gf extends oy{static get DisableConversionChar(){return A.expressionDisableConversionChar}static set DisableConversionChar(e){A.expressionDisableConversionChar=e}constructor(e){super(e),this.variableName=e,this.valueInfo={},this.useValueAsItIs=!1,this.variableName&&this.variableName.length>1&&this.variableName[0]===gf.DisableConversionChar&&(this.variableName=this.variableName.substring(1),this.useValueAsItIs=!0)}get requireStrictCompare(){return this.valueInfo.strictCompare===!0}getType(){return"variable"}toString(e=void 0){if(e){var t=e(this);if(t)return t}var s=this.useValueAsItIs?gf.DisableConversionChar:"";return"{"+s+this.variableName+"}"}get variable(){return this.variableName}evaluate(e){if(this.valueInfo.name=this.variableName,e.getValueInfo(this.valueInfo),!this.valueInfo.hasValue)return this.returnJSONObject(this.variableName);let t=this.valueInfo.value;return this.valueInfo.onProcessValue&&(t=this.valueInfo.onProcessValue(t)),this.getCorrectValue(t)}setVariables(e){e.push(this.variableName)}getCorrectValue(e){return this.useValueAsItIs?e:super.getCorrectValue(e)}isContentEqual(e){return e.variable==this.variable}returnJSONObject(e){if(!e||e.length<2||e.indexOf(":")<1)return null;try{return JSON.parse("{"+e+"}")}catch{return null}}},V2=class extends mr{constructor(e,t){super(),this.originalValue=e,this.parameters=t,Array.isArray(t)&&t.length===0&&(this.parameters=new Ou([]))}getType(){return"function"}evaluate(e){const t=this.getAsynValue(e);return t?t.value:this.evaluateCore(e)}evaluateCore(e){let t=e.properties;if(this.isAsyncFunction){t=O.createCopy(e.properties);const s=this.id,i=e.asyncValues,r=e.onCompleteAsyncFunc,a=this;t.returnResult=o=>{i[s]={value:o},r(a)}}return _e.Instance.run(this.originalValue,this.parameters.evaluate(e),t,this.parameters.values)}toString(e=void 0){if(e){var t=e(this);if(t)return t}return this.originalValue+"("+this.parameters.toString(e)+")"}setVariables(e){this.parameters.setVariables(e)}isReady(e){return!!this.getAsynValue(e)}addChildrenToList(e){this.parameters.addOperandsToList(e)}getAsynValue(e){return e.asyncValues[this.id]}hasFunction(){return!0}hasAsyncFunction(){return this.isAsyncFunction()||this.parameters.hasAsyncFunction()}isAsyncFunction(){return _e.Instance.isAsyncFunction(this.originalValue)}addToAsyncList(e){let t;if(this.isAsyncFunction()&&(t={operand:this}),this.parameters.hasAsyncFunction()){const s=new Array;this.parameters.addToAsyncList(s),s.forEach(i=>i.parent=t),t||(t={}),t.children=s}t&&e.push(t)}isContentEqual(e){const t=e;return t.originalValue==this.originalValue&&this.areOperatorsEquals(t.parameters,this.parameters)}},Ne=class Ta{static throwInvalidOperatorError(e){throw new Error("Invalid operator: '"+e+"'")}static safeToString(e,t){return e==null?"":e.toString(t)}static toOperandString(e){return e&&!O.isNumber(e)&&!Ta.isBooleanValue(e)&&(e="'"+e+"'"),e}static isBooleanValue(e){return!!e&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")}static countDecimals(e){if(O.isNumber(e)&&Math.floor(e)!==e){const t=e.toString().split(".");return t.length>1&&t[1].length||0}return 0}static plusMinus(e,t,s){const i=Ta.countDecimals(e),r=Ta.countDecimals(t);if(i>0||r>0){const a=Math.max(i,r);s=parseFloat(s.toFixed(a))}return s}static isTwoValueEquals(e,t,s=!0){return e==="undefined"&&(e=void 0),t==="undefined"&&(t=void 0),O.isTwoValueEquals(e,t,s)}static operatorToString(e){let t=Ta.signs[e];return t??e}static convertValForDateCompare(e,t){if(t instanceof Date&&typeof e=="string"){let s=Rt("expression-operand",e);return s.setHours(0,0,0),s}return e}};Ne.unaryFunctions={empty:function(n){return O.isValueEmpty(n)},notempty:function(n){return!Ne.unaryFunctions.empty(n)},negate:function(n){return!n}},Ne.binaryFunctions={arithmeticOp(n){const e=(t,s)=>O.isValueEmpty(t)?typeof s=="number"?0:typeof t=="string"?t:typeof s=="string"?"":Array.isArray(s)?[]:0:t;return function(t,s){t=e(t,s),s=e(s,t);let i=Ne.binaryFunctions[n];return i==null?null:i.call(this,t,s)}},and:function(n,e){return n&&e},or:function(n,e){return n||e},plus:function(n,e){return O.sumAnyValues(n,e)},minus:function(n,e){return O.correctAfterPlusMinis(n,e,n-e)},mul:function(n,e){return O.correctAfterMultiple(n,e,n*e)},div:function(n,e){return e?n/e:null},mod:function(n,e){return e?n%e:null},power:function(n,e){return Math.pow(n,e)},greater:function(n,e){return n==null||e==null?!1:(n=Ne.convertValForDateCompare(n,e),e=Ne.convertValForDateCompare(e,n),n>e)},less:function(n,e){return n==null||e==null?!1:(n=Ne.convertValForDateCompare(n,e),e=Ne.convertValForDateCompare(e,n),n<e)},greaterorequal:function(n,e){return Ne.binaryFunctions.equal(n,e)?!0:Ne.binaryFunctions.greater(n,e)},lessorequal:function(n,e){return Ne.binaryFunctions.equal(n,e)?!0:Ne.binaryFunctions.less(n,e)},equal:function(n,e,t){return n=Ne.convertValForDateCompare(n,e),e=Ne.convertValForDateCompare(e,n),Ne.isTwoValueEquals(n,e,t!==!0)},notequal:function(n,e,t){return!Ne.binaryFunctions.equal(n,e,t)},contains:function(n,e){return Ne.binaryFunctions.containsCore(n,e,!0)},notcontains:function(n,e){return!n&&!O.isValueEmpty(e)?!0:Ne.binaryFunctions.containsCore(n,e,!1)},anyof:function(n,e){if(O.isValueEmpty(n)&&O.isValueEmpty(e))return!0;if(O.isValueEmpty(n)||!Array.isArray(n)&&n.length===0)return!1;if(O.isValueEmpty(e))return!0;if(!Array.isArray(n))return Ne.binaryFunctions.contains(e,n);if(!Array.isArray(e))return Ne.binaryFunctions.contains(n,e);for(var t=0;t<e.length;t++)if(Ne.binaryFunctions.contains(n,e[t]))return!0;return!1},allof:function(n,e){if(!n&&!O.isValueEmpty(e))return!1;if(!Array.isArray(e))return Ne.binaryFunctions.contains(n,e);for(var t=0;t<e.length;t++)if(!Ne.binaryFunctions.contains(n,e[t]))return!1;return!0},containsCore:function(n,e,t){if(!n&&n!==0&&n!==!1)return!1;if(n.length||(n=n.toString(),(typeof e=="string"||e instanceof String)&&(n=n.toUpperCase(),e=e.toUpperCase())),typeof n=="string"||n instanceof String){if(!e)return!1;e=e.toString();var s=n.indexOf(e)>-1;return t?s:!s}for(var i=Array.isArray(e)?e:[e],r=0;r<i.length;r++){var a=0;for(e=i[r];a<n.length&&!Ne.isTwoValueEquals(n[a],e);a++);if(a==n.length)return!t}return t}},Ne.signs={less:"<",lessorequal:"<=",greater:">",greaterorequal:">=",equal:"==",notequal:"!=",plus:"+",minus:"-",mul:"*",div:"/",and:"and",or:"or",power:"^",mod:"%",negate:"!"};const Mu=(function(){class n extends SyntaxError{constructor(s,i,r,a){super(s),this.expected=i,this.found=r,this.location=a,this.name="SyntaxError"}format(s){let i="Error: "+this.message;if(this.location){let r=null;const a=s.find(d=>d.source===this.location.source);a&&(r=a.text.split(/\r\n|\n|\r/g));const o=this.location.start,l=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(o):o,u=this.location.source+":"+l.line+":"+l.column;if(r){const d=this.location.end,h="".padEnd(l.line.toString().length," "),f=r[o.line-1],b=(o.line===d.line?d.column:f.length+1)-o.column||1;i+=`
 --> `+u+`
`+h+` |
`+l.line+" | "+f+`
`+h+" | "+"".padEnd(o.column-1," ")+"".padEnd(b,"^")}else i+=`
 at `+u}return i}static buildMessage(s,i){function r(b){return b.codePointAt(0).toString(16).toUpperCase()}const a=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function o(b){return a?b.replace(a,x=>"\\u{"+r(x)+"}"):b}function l(b){return o(b.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,x=>"\\x0"+r(x)).replace(/[\x10-\x1F\x7F-\x9F]/g,x=>"\\x"+r(x)))}function u(b){return o(b.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,x=>"\\x0"+r(x)).replace(/[\x10-\x1F\x7F-\x9F]/g,x=>"\\x"+r(x)))}const d={literal(b){return'"'+l(b.text)+'"'},class(b){const x=b.parts.map(V=>Array.isArray(V)?u(V[0])+"-"+u(V[1]):u(V));return"["+(b.inverted?"^":"")+x.join("")+"]"+(b.unicode?"u":"")},any(){return"any character"},end(){return"end of input"},other(b){return b.description}};function h(b){return d[b.type](b)}function f(b){const x=b.map(h);if(x.sort(),x.length>0){let V=1;for(let P=1;P<x.length;P++)x[P-1]!==x[P]&&(x[V]=x[P],V++);x.length=V}switch(x.length){case 1:return x[0];case 2:return x[0]+" or "+x[1];default:return x.slice(0,-1).join(", ")+", or "+x[x.length-1]}}function C(b){return b?'"'+l(b)+'"':"end of input"}return"Expected "+f(s)+" but "+C(i)+" found."}}function e(t,s){s=s!==void 0?s:{};const i={},r=s.grammarSource,a={Expression:gs};let o=gs;const l="||",u="or",d="&&",h="and",f="<=",C="lessorequal",b=">=",x="greaterorequal",V="==",P="equal",M="=",X="!=",N="notequal",W="<",J="less",ie=">",ne="greater",ce="+",ye="-",le="*",be="/",F="%",Z="^",ae="power",ue="*=",me="contains",Xe="contain",xt="notcontains",si="notcontain",ii="anyof",Ts="allof",Ht="(",nr="!",Fp="negate",Qp="empty",Hp="notempty",Fn="undefined",Qn="null",zp="{",jp="}",Hn="''",zn='""',jn="'",Un='"',Up="[",Wp="]",Wn=",",$p="true",Gp="false",$n="0x",Jp=".",Kp="0",Gn="\\'",Jn='\\"',Zp=/^[\-]/,Yp=/^[^"']/,Xp=/^[^{}]/,Kn=/^[0-9]/,Zn=/^[1-9]/,Yn=/^[a-zA-Z_]/,Xn=/^[ \t\n\r]/,eg=Y("||",!1),tg=Y("or",!0),sg=Y("&&",!1),ig=Y("and",!0),rg=Y("<=",!1),ng=Y("lessorequal",!0),ag=Y(">=",!1),og=Y("greaterorequal",!0),lg=Y("==",!1),ea=Y("equal",!0),ug=Y("=",!1),hg=Y("!=",!1),dg=Y("notequal",!0),cg=Y("<",!1),pg=Y("less",!0),gg=Y(">",!1),mg=Y("greater",!0),fg=Y("+",!1),yg=Y("-",!1),vg=Y("*",!1),Cg=Y("/",!1),bg=Y("%",!1),wg=Y("^",!1),xg=Y("power",!0),Vg=Y("*=",!1),Pg=Y("contains",!0),Sg=Y("contain",!0),Ig=Y("notcontains",!0),Tg=Y("notcontain",!0),Eg=Y("anyof",!0),Rg=Y("allof",!0),ta=Y("(",!1),sa=Y(")",!1),_g=Y("!",!1),Lg=Y("negate",!0),Ag=Y("empty",!0),Dg=Y("notempty",!0),Og=Y("undefined",!1),Mg=Y("null",!1),kg=Y("{",!1),Ng=Y("}",!1),qg=Y("''",!1),Bg=Y('""',!1),ia=Y("'",!1),ra=Y('"',!1),Fg=Y("[",!1),Qg=Y("]",!1),na=Y(",",!1),Hg=Y("true",!0),zg=Y("false",!0),jg=Y("0x",!1),Ug=Gt(["-"],!1,!1,!1),Wg=Y(".",!1),$g=Y("0",!1),Gg=Y("\\'",!1),Jg=Y('\\"',!1),Kg=Gt(['"',"'"],!0,!1,!1),Zg=Gt(["{","}"],!0,!1,!1),aa=Gt([["0","9"]],!1,!1,!1),oa=Gt([["1","9"]],!1,!1,!1),la=Gt([["a","z"],["A","Z"],"_"],!1,!1,!1),ua=Gt([" ","	",`
`,"\r"],!1,!1,!1);function Yg(c,p){return Jt(c,p,!0)}function Xg(){return"or"}function em(c,p){return Jt(c,p,!0)}function tm(){return"and"}function sm(c,p){return Jt(c,p)}function im(){return"lessorequal"}function rm(){return"greaterorequal"}function nm(){return"equal"}function am(){return"equal"}function om(){return"notequal"}function lm(){return"less"}function um(){return"greater"}function hm(c,p){return Jt(c,p,!0)}function dm(){return"plus"}function cm(){return"minus"}function pm(c,p){return Jt(c,p,!0)}function gm(){return"mul"}function mm(){return"div"}function fm(){return"mod"}function ym(c,p){return Jt(c,p,!0)}function vm(){return"power"}function Cm(c,p){return Jt(c,p)}function bm(){return"contains"}function wm(){return"notcontains"}function xm(){return"anyof"}function Vm(){return"allof"}function S4(c){return c}function Pm(c,p){return new V2(c,p)}function Sm(c){return new ay(c,"negate")}function Im(c,p){return new ay(c,p)}function Tm(){return"empty"}function Em(){return"notempty"}function Rm(){return null}function _m(c){return new oy(c)}function Lm(c){return new x2(c)}function I4(c){return c}function T4(c){return c}function E4(c){return c}function Am(){return""}function Dm(){return""}function Om(c){return"'"+c+"'"}function Mm(c){return"'"+c+"'"}function R4(c){return c}function km(c,p){if(c==null)return new Ou([]);var T=[c];if(Array.isArray(p))for(var w=df(p),_=3;_<w.length;_+=4)T.push(w[_]);return new Ou(T)}function Nm(){return!0}function qm(){return!1}function Bm(){return parseInt(ps(),16)}function Fm(c,p){return c==null?p:-p}function Qm(){return parseFloat(ps())}function Hm(){return parseInt(ps(),10)}function zm(){return 0}function jm(c){return c.join("")}function Um(c){return c.join("")}function Wm(){return"'"}function $m(){return'"'}function Gm(){return ps()}function Jm(){return ps()}function Km(){return ps()}let g=s.peg$currPos|0,K=g;const cs=[{line:1,column:1}];let mt=g,bi=s.peg$maxFailExpected||[],Q=s.peg$silentFails|0,U={},Ns;if(s.startRule){if(!(s.startRule in a))throw new Error(`Can't start parsing from rule "`+s.startRule+'".');o=a[s.startRule]}function ps(){return t.substring(K,g)}function Zm(c=g){const p=t.codePointAt(c);return p===void 0?"":String.fromCodePoint(p)}function Y(c,p){return{type:"literal",text:c,ignoreCase:p}}function Gt(c,p,T,w){return{type:"class",parts:c,inverted:p,ignoreCase:T,unicode:w}}function Ym(){return{type:"end"}}function ha(c){let p=cs[c],T;if(p)return p;if(c>=cs.length)T=cs.length-1;else for(T=c;!cs[--T];);for(p=cs[T],p={line:p.line,column:p.column};T<c;)t.charCodeAt(T)===10?(p.line++,p.column=1):p.column++,T++;return cs[c]=p,p}function da(c,p,T){const w=ha(c),_=ha(p);return{source:r,start:{offset:c,line:w.line,column:w.column},end:{offset:p,line:_.line,column:_.column}}}function H(c){g<mt||(g>mt&&(mt=g,bi=[]),bi.push(c))}function Xm(c,p,T){return new n(n.buildMessage(c,p),c,p,T)}function gs(){let c,p,T,w,_,k,se,G;const ve=g*34+0,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,re(),p=ar(),p!==i){for(T=[],w=g,_=re(),k=ca(),k!==i?(se=re(),G=ar(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=ca(),k!==i?(se=re(),G=ar(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w=re(),K=c,c=Yg(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function ca(){let c,p;const T=g*34+1,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.substr(g,2)===l?(p=l,g+=2):(p=i,Q===0&&H(eg)),p===i&&(p=t.substr(g,2),p.toLowerCase()===u?g+=2:(p=i,Q===0&&H(tg))),p!==i&&(K=c,p=Xg()),c=p,U[T]={nextPos:g,result:c},c)}function ar(){let c,p,T,w,_,k,se,G;const ve=g*34+2,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,p=or(),p!==i){for(T=[],w=g,_=re(),k=pa(),k!==i?(se=re(),G=or(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=pa(),k!==i?(se=re(),G=or(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);K=c,c=em(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function pa(){let c,p;const T=g*34+3,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.substr(g,2)===d?(p=d,g+=2):(p=i,Q===0&&H(sg)),p===i&&(p=t.substr(g,3),p.toLowerCase()===h?g+=3:(p=i,Q===0&&H(ig))),p!==i&&(K=c,p=tm()),c=p,U[T]={nextPos:g,result:c},c)}function or(){let c,p,T,w,_,k,se,G;const ve=g*34+4,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,p=lr(),p!==i){for(T=[],w=g,_=re(),k=ga(),k!==i?(se=re(),G=lr(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=ga(),k!==i?(se=re(),G=lr(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);K=c,c=sm(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function ga(){let c,p;const T=g*34+5,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.substr(g,2)===f?(p=f,g+=2):(p=i,Q===0&&H(rg)),p===i&&(p=t.substr(g,11),p.toLowerCase()===C?g+=11:(p=i,Q===0&&H(ng))),p!==i&&(K=c,p=im()),c=p,c===i&&(c=g,t.substr(g,2)===b?(p=b,g+=2):(p=i,Q===0&&H(ag)),p===i&&(p=t.substr(g,14),p.toLowerCase()===x?g+=14:(p=i,Q===0&&H(og))),p!==i&&(K=c,p=rm()),c=p,c===i&&(c=g,t.substr(g,2)===V?(p=V,g+=2):(p=i,Q===0&&H(lg)),p===i&&(p=t.substr(g,5),p.toLowerCase()===P?g+=5:(p=i,Q===0&&H(ea))),p!==i&&(K=c,p=nm()),c=p,c===i&&(c=g,t.charCodeAt(g)===61?(p=M,g++):(p=i,Q===0&&H(ug)),p===i&&(p=t.substr(g,5),p.toLowerCase()===P?g+=5:(p=i,Q===0&&H(ea))),p!==i&&(K=c,p=am()),c=p,c===i&&(c=g,t.substr(g,2)===X?(p=X,g+=2):(p=i,Q===0&&H(hg)),p===i&&(p=t.substr(g,8),p.toLowerCase()===N?g+=8:(p=i,Q===0&&H(dg))),p!==i&&(K=c,p=om()),c=p,c===i&&(c=g,t.charCodeAt(g)===60?(p=W,g++):(p=i,Q===0&&H(cg)),p===i&&(p=t.substr(g,4),p.toLowerCase()===J?g+=4:(p=i,Q===0&&H(pg))),p!==i&&(K=c,p=lm()),c=p,c===i&&(c=g,t.charCodeAt(g)===62?(p=ie,g++):(p=i,Q===0&&H(gg)),p===i&&(p=t.substr(g,7),p.toLowerCase()===ne?g+=7:(p=i,Q===0&&H(mg))),p!==i&&(K=c,p=um()),c=p)))))),U[T]={nextPos:g,result:c},c)}function lr(){let c,p,T,w,_,k,se,G;const ve=g*34+6,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,p=ur(),p!==i){for(T=[],w=g,_=re(),k=ma(),k!==i?(se=re(),G=ur(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=ma(),k!==i?(se=re(),G=ur(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);K=c,c=hm(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function ma(){let c,p;const T=g*34+7,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.charCodeAt(g)===43?(p=ce,g++):(p=i,Q===0&&H(fg)),p!==i&&(K=c,p=dm()),c=p,c===i&&(c=g,t.charCodeAt(g)===45?(p=ye,g++):(p=i,Q===0&&H(yg)),p!==i&&(K=c,p=cm()),c=p),U[T]={nextPos:g,result:c},c)}function ur(){let c,p,T,w,_,k,se,G;const ve=g*34+8,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,p=hr(),p!==i){for(T=[],w=g,_=re(),k=fa(),k!==i?(se=re(),G=hr(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=fa(),k!==i?(se=re(),G=hr(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);K=c,c=pm(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function fa(){let c,p;const T=g*34+9,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.charCodeAt(g)===42?(p=le,g++):(p=i,Q===0&&H(vg)),p!==i&&(K=c,p=gm()),c=p,c===i&&(c=g,t.charCodeAt(g)===47?(p=be,g++):(p=i,Q===0&&H(Cg)),p!==i&&(K=c,p=mm()),c=p,c===i&&(c=g,t.charCodeAt(g)===37?(p=F,g++):(p=i,Q===0&&H(bg)),p!==i&&(K=c,p=fm()),c=p)),U[T]={nextPos:g,result:c},c)}function hr(){let c,p,T,w,_,k,se,G;const ve=g*34+10,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,p=dr(),p!==i){for(T=[],w=g,_=re(),k=ya(),k!==i?(se=re(),G=dr(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=ya(),k!==i?(se=re(),G=dr(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);K=c,c=ym(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function ya(){let c,p;const T=g*34+11,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.charCodeAt(g)===94?(p=Z,g++):(p=i,Q===0&&H(wg)),p===i&&(p=t.substr(g,5),p.toLowerCase()===ae?g+=5:(p=i,Q===0&&H(xg))),p!==i&&(K=c,p=vm()),c=p,U[T]={nextPos:g,result:c},c)}function dr(){let c,p,T,w,_,k,se,G;const ve=g*34+12,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,p=wi(),p!==i){for(T=[],w=g,_=re(),k=va(),k!==i?(se=re(),G=wi(),G===i&&(G=null),_=[_,k,se,G],w=_):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=va(),k!==i?(se=re(),G=wi(),G===i&&(G=null),_=[_,k,se,G],w=_):(g=w,w=i);K=c,c=Cm(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function va(){let c,p;const T=g*34+13,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.substr(g,2)===ue?(p=ue,g+=2):(p=i,Q===0&&H(Vg)),p===i&&(p=t.substr(g,8),p.toLowerCase()===me?g+=8:(p=i,Q===0&&H(Pg)),p===i&&(p=t.substr(g,7),p.toLowerCase()===Xe?g+=7:(p=i,Q===0&&H(Sg)))),p!==i&&(K=c,p=bm()),c=p,c===i&&(c=g,p=t.substr(g,11),p.toLowerCase()===xt?g+=11:(p=i,Q===0&&H(Ig)),p===i&&(p=t.substr(g,10),p.toLowerCase()===si?g+=10:(p=i,Q===0&&H(Tg))),p!==i&&(K=c,p=wm()),c=p,c===i&&(c=g,p=t.substr(g,5),p.toLowerCase()===ii?g+=5:(p=i,Q===0&&H(Eg)),p!==i&&(K=c,p=xm()),c=p,c===i&&(c=g,p=t.substr(g,5),p.toLowerCase()===Ts?g+=5:(p=i,Q===0&&H(Rg)),p!==i&&(K=c,p=Vm()),c=p))),U[T]={nextPos:g,result:c},c)}function wi(){let c,p,T;const w=g*34+14,_=U[w];return _?(g=_.nextPos,_.result):(c=g,t.charCodeAt(g)===40?(p=Ht,g++):(p=i,Q===0&&H(ta)),p!==i?(re(),T=gs(),T!==i?(re(),t.charCodeAt(g)===41?g++:Q===0&&H(sa),K=c,c=T):(g=c,c=i)):(g=c,c=i),c===i&&(c=ef(),c===i&&(c=tf(),c===i&&(c=Ca(),c===i&&(c=nf())))),U[w]={nextPos:g,result:c},c)}function ef(){let c,p,T,w;const _=g*34+15,k=U[_];return k?(g=k.nextPos,k.result):(c=g,p=Pa(),p!==i?(t.charCodeAt(g)===40?(T=Ht,g++):(T=i,Q===0&&H(ta)),T!==i?(w=ba(),t.charCodeAt(g)===41?g++:Q===0&&H(sa),K=c,c=Pm(p,w)):(g=c,c=i)):(g=c,c=i),U[_]={nextPos:g,result:c},c)}function tf(){let c,p,T;const w=g*34+16,_=U[w];return _?(g=_.nextPos,_.result):(c=g,t.charCodeAt(g)===33?(p=nr,g++):(p=i,Q===0&&H(_g)),p===i&&(p=t.substr(g,6),p.toLowerCase()===Fp?g+=6:(p=i,Q===0&&H(Lg))),p!==i?(re(),T=wi(),T!==i?(K=c,c=Sm(T)):(g=c,c=i)):(g=c,c=i),c===i&&(c=g,p=Ca(),p!==i?(re(),T=sf(),T!==i?(K=c,c=Im(p,T)):(g=c,c=i)):(g=c,c=i)),U[w]={nextPos:g,result:c},c)}function sf(){let c,p;const T=g*34+17,w=U[T];return w?(g=w.nextPos,w.result):(c=g,p=t.substr(g,5),p.toLowerCase()===Qp?g+=5:(p=i,Q===0&&H(Ag)),p!==i&&(K=c,p=Tm()),c=p,c===i&&(c=g,p=t.substr(g,8),p.toLowerCase()===Hp?g+=8:(p=i,Q===0&&H(Dg)),p!==i&&(K=c,p=Em()),c=p),U[T]={nextPos:g,result:c},c)}function Ca(){let c,p,T,w;const _=g*34+18,k=U[_];return k?(g=k.nextPos,k.result):(c=g,re(),t.substr(g,9)===Fn?(p=Fn,g+=9):(p=i,Q===0&&H(Og)),p===i&&(t.substr(g,4)===Qn?(p=Qn,g+=4):(p=i,Q===0&&H(Mg))),p!==i?(K=c,c=Rm()):(g=c,c=i),c===i&&(c=g,re(),p=rf(),p!==i?(K=c,c=_m(p)):(g=c,c=i),c===i&&(c=g,re(),t.charCodeAt(g)===123?(p=zp,g++):(p=i,Q===0&&H(kg)),p!==i?(T=uf(),T!==i?(t.charCodeAt(g)===125?(w=jp,g++):(w=i,Q===0&&H(Ng)),w!==i?(K=c,c=Lm(T)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i))),U[_]={nextPos:g,result:c},c)}function rf(){let c,p,T,w;const _=g*34+19,k=U[_];return k?(g=k.nextPos,k.result):(c=g,p=af(),p!==i&&(K=c,p=p),c=p,c===i&&(c=g,p=of(),p!==i&&(K=c,p=p),c=p,c===i&&(c=g,p=Pa(),p!==i&&(K=c,p=p),c=p,c===i&&(c=g,t.substr(g,2)===Hn?(p=Hn,g+=2):(p=i,Q===0&&H(qg)),p!==i&&(K=c,p=Am()),c=p,c===i&&(c=g,t.substr(g,2)===zn?(p=zn,g+=2):(p=i,Q===0&&H(Bg)),p!==i&&(K=c,p=Dm()),c=p,c===i&&(c=g,t.charCodeAt(g)===39?(p=jn,g++):(p=i,Q===0&&H(ia)),p!==i?(T=wa(),T!==i?(t.charCodeAt(g)===39?(w=jn,g++):(w=i,Q===0&&H(ia)),w!==i?(K=c,c=Om(T)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i),c===i&&(c=g,t.charCodeAt(g)===34?(p=Un,g++):(p=i,Q===0&&H(ra)),p!==i?(T=wa(),T!==i?(t.charCodeAt(g)===34?(w=Un,g++):(w=i,Q===0&&H(ra)),w!==i?(K=c,c=Mm(T)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i))))))),U[_]={nextPos:g,result:c},c)}function nf(){let c,p,T,w;const _=g*34+20,k=U[_];return k?(g=k.nextPos,k.result):(c=g,t.charCodeAt(g)===91?(p=Up,g++):(p=i,Q===0&&H(Fg)),p!==i?(T=ba(),t.charCodeAt(g)===93?(w=Wp,g++):(w=i,Q===0&&H(Qg)),w!==i?(K=c,c=T):(g=c,c=i)):(g=c,c=i),U[_]={nextPos:g,result:c},c)}function ba(){let c,p,T,w,_,k,se,G;const ve=g*34+21,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;for(c=g,p=gs(),p===i&&(p=null),T=[],w=g,_=re(),t.charCodeAt(g)===44?(k=Wn,g++):(k=i,Q===0&&H(na)),k!==i?(se=re(),G=gs(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),t.charCodeAt(g)===44?(k=Wn,g++):(k=i,Q===0&&H(na)),k!==i?(se=re(),G=gs(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);return K=c,c=km(p,T),U[ve]={nextPos:g,result:c},c}function af(){let c,p;const T=g*34+22,w=U[T];return w?(g=w.nextPos,w.result):(c=g,p=t.substr(g,4),p.toLowerCase()===$p?g+=4:(p=i,Q===0&&H(Hg)),p!==i&&(K=c,p=Nm()),c=p,c===i&&(c=g,p=t.substr(g,5),p.toLowerCase()===Gp?g+=5:(p=i,Q===0&&H(zg)),p!==i&&(K=c,p=qm()),c=p),U[T]={nextPos:g,result:c},c)}function of(){let c,p,T;const w=g*34+23,_=U[w];return _?(g=_.nextPos,_.result):(c=g,t.substr(g,2)===$n?(p=$n,g+=2):(p=i,Q===0&&H(jg)),p!==i?(T=ms(),T!==i?(K=c,c=Bm()):(g=c,c=i)):(g=c,c=i),c===i&&(c=g,p=t.charAt(g),Zp.test(p)?g++:(p=i,Q===0&&H(Ug)),p===i&&(p=null),T=lf(),T!==i?(K=c,c=Fm(p,T)):(g=c,c=i)),U[w]={nextPos:g,result:c},c)}function lf(){let c,p,T,w;const _=g*34+24,k=U[_];return k?(g=k.nextPos,k.result):(c=g,p=ms(),p!==i?(t.charCodeAt(g)===46?(T=Jp,g++):(T=i,Q===0&&H(Wg)),T!==i?(w=ms(),w!==i?(K=c,c=Qm()):(g=c,c=i)):(g=c,c=i)):(g=c,c=i),c===i&&(c=g,p=hf(),p!==i?(T=ms(),T===i&&(T=null),K=c,c=Hm()):(g=c,c=i),c===i&&(c=g,t.charCodeAt(g)===48?(p=Kp,g++):(p=i,Q===0&&H($g)),p!==i&&(K=c,p=zm()),c=p)),U[_]={nextPos:g,result:c},c)}function uf(){let c,p,T;const w=g*34+25,_=U[w];if(_)return g=_.nextPos,_.result;if(c=g,p=[],T=Va(),T!==i)for(;T!==i;)p.push(T),T=Va();else p=i;return p!==i&&(K=c,p=jm(p)),c=p,U[w]={nextPos:g,result:c},c}function wa(){let c,p,T;const w=g*34+26,_=U[w];if(_)return g=_.nextPos,_.result;if(c=g,p=[],T=xa(),T!==i)for(;T!==i;)p.push(T),T=xa();else p=i;return p!==i&&(K=c,p=Um(p)),c=p,U[w]={nextPos:g,result:c},c}function xa(){let c,p;const T=g*34+27,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.substr(g,2)===Gn?(p=Gn,g+=2):(p=i,Q===0&&H(Gg)),p!==i&&(K=c,p=Wm()),c=p,c===i&&(c=g,t.substr(g,2)===Jn?(p=Jn,g+=2):(p=i,Q===0&&H(Jg)),p!==i&&(K=c,p=$m()),c=p,c===i&&(c=g,p=t.charAt(g),Yp.test(p)?g++:(p=i,Q===0&&H(Kg)),p!==i&&(K=c,p=Gm()),c=p)),U[T]={nextPos:g,result:c},c)}function Va(){let c,p;const T=g*34+28,w=U[T];return w?(g=w.nextPos,w.result):(c=g,p=t.charAt(g),Xp.test(p)?g++:(p=i,Q===0&&H(Zg)),p!==i&&(K=c,p=Jm()),c=p,U[T]={nextPos:g,result:c},c)}function Pa(){let c,p,T,w,_,k,se;const G=g*34+29,ve=U[G];if(ve)return g=ve.nextPos,ve.result;if(c=g,p=qs(),p!==i){if(T=[],w=g,_=ms(),_!==i){for(k=[],se=qs();se!==i;)k.push(se),se=qs();_=[_,k],w=_}else g=w,w=i;for(;w!==i;)if(T.push(w),w=g,_=ms(),_!==i){for(k=[],se=qs();se!==i;)k.push(se),se=qs();_=[_,k],w=_}else g=w,w=i;K=c,c=Km()}else g=c,c=i;return U[G]={nextPos:g,result:c},c}function ms(){let c,p;const T=g*34+30,w=U[T];if(w)return g=w.nextPos,w.result;if(c=[],p=t.charAt(g),Kn.test(p)?g++:(p=i,Q===0&&H(aa)),p!==i)for(;p!==i;)c.push(p),p=t.charAt(g),Kn.test(p)?g++:(p=i,Q===0&&H(aa));else c=i;return U[T]={nextPos:g,result:c},c}function hf(){let c,p;const T=g*34+31,w=U[T];if(w)return g=w.nextPos,w.result;if(c=[],p=t.charAt(g),Zn.test(p)?g++:(p=i,Q===0&&H(oa)),p!==i)for(;p!==i;)c.push(p),p=t.charAt(g),Zn.test(p)?g++:(p=i,Q===0&&H(oa));else c=i;return U[T]={nextPos:g,result:c},c}function qs(){let c,p;const T=g*34+32,w=U[T];if(w)return g=w.nextPos,w.result;if(c=[],p=t.charAt(g),Yn.test(p)?g++:(p=i,Q===0&&H(la)),p!==i)for(;p!==i;)c.push(p),p=t.charAt(g),Yn.test(p)?g++:(p=i,Q===0&&H(la));else c=i;return U[T]={nextPos:g,result:c},c}function re(){let c,p;const T=g*34+33,w=U[T];if(w)return g=w.nextPos,w.result;for(Q++,c=[],p=t.charAt(g),Xn.test(p)?g++:(p=i,Q===0&&H(ua));p!==i;)c.push(p),p=t.charAt(g),Xn.test(p)?g++:(p=i,Q===0&&H(ua));return Q--,U[T]={nextPos:g,result:c},c}function Jt(c,p,T=!1){return p.reduce(function(w,_){return new w2(_[1],w,_[3],T)},c)}function df(c){return[].concat.apply([],c)}Ns=o();const cr=Ns!==i&&g===t.length;function Sa(){throw Ns!==i&&g<t.length&&H(Ym()),Xm(bi,mt<t.length?Zm(mt):null,mt<t.length?da(mt,mt+1):da(mt,mt))}if(s.peg$library)return{peg$result:Ns,peg$currPos:g,peg$FAILED:i,peg$maxFailExpected:bi,peg$maxFailPos:mt,peg$success:cr,peg$throw:cr?void 0:Sa};if(cr)return Ns;Sa()}return{StartRules:["Expression"],SyntaxError:n,parse:e}})();Mu.SyntaxError.prototype.name="PeggySyntaxError";const P2=Mu.parse,S2=Mu.SyntaxError;let I2=class{constructor(e,t){this.at=e,this.code=t}},T2=class{patchExpression(e){return e.replace(/=>/g,">=").replace(/=</g,"<=").replace(/<>/g,"!=").replace(/equals/g,"equal ").replace(/notequals/g,"notequal ")}createCondition(e){return this.parseExpression(e)}parseExpression(e){try{return P2(this.patchExpression(e))}catch(t){t instanceof S2&&(this.conditionError=new I2(t.location.start.offset,t.message))}}get error(){return this.conditionError}},E2=class{constructor(e,t,s,i,r){this.operand=e,this.id=t,this.onComplete=s,this.processValue=new zV(r),this.processValue.properties=i}run(e){if(!e)return this.runValues();this.processValue.onCompleteAsyncFunc=s=>{const i=this.getAsyncItemByOperand(s,this.asyncFuncList);i&&this.doAsyncFunctionReady(i)},this.asyncFuncList=new Array,this.operand.addToAsyncList(this.asyncFuncList);for(var t=0;t<this.asyncFuncList.length;t++)this.runAsyncItem(this.asyncFuncList[t]);return!1}getAsyncItemByOperand(e,t){if(!Array.isArray(t))return null;for(let s=0;s<t.length;s++){if(t[s].operand===e)return t[s];const i=this.getAsyncItemByOperand(e,t[s].children);if(i)return i}return null}runAsyncItem(e){e.children?e.children.forEach(t=>this.runAsyncItem(t)):this.runAsyncItemCore(e)}runAsyncItemCore(e){e.operand?e.operand.evaluate(this.processValue):this.doAsyncFunctionReady(e)}doAsyncFunctionReady(e){if(e.parent&&this.isAsyncChildrenReady(e)){this.runAsyncItemCore(e.parent);return}for(var t=0;t<this.asyncFuncList.length;t++)if(!this.isAsyncFuncReady(this.asyncFuncList[t]))return;this.runValues()}isAsyncFuncReady(e){return e.operand&&!e.operand.isReady(this.processValue)?!1:this.isAsyncChildrenReady(e)}isAsyncChildrenReady(e){if(e.children){for(let t=0;t<e.children.length;t++)if(!this.isAsyncFuncReady(e.children[t]))return!1}return!0}runValues(){var e=this.operand.evaluate(this.processValue);return this.onComplete&&this.onComplete(e,this.id),e}},Ua=class Ow{static getQuestionErrorText(e){if(e){const t=e.question;if(t&&t.name)return" It is used in the question: '"+t.name+"'."}return""}constructor(e){this.parser=new T2,this.isAsyncValue=!1,this.hasFunctionValue=!1,this.setExpression(e)}get expression(){return this.expressionValue}setExpression(e){this.expression!==e&&(this.expressionValue=e,this.operand=this.parser.parseExpression(e),this.hasFunctionValue=this.canRun()?this.operand.hasFunction():!1,this.isAsyncValue=this.hasFunction()?this.operand.hasAsyncFunction():!1)}getVariables(){if(!this.operand)return[];var e=[];return this.operand.setVariables(e),e}hasFunction(){return this.hasFunctionValue}get isAsync(){return this.isAsyncValue}canRun(){return!!this.operand}run(e,t,s){return this.runContext(new Du(e,t?.context),t,s)}runContext(e,t=null,s){return this.operand?new E2(this.operand,s,this.onComplete,t,e).run(this.isAsync):(this.expression&&ri.warn("Invalid expression: '"+this.expression+"'."+Ow.getQuestionErrorText(t)),null)}};Ua.createExpressionExecutor=n=>new Ua(n);let ku=class Mw{constructor(e){this.expression=e}get expression(){return this.expressionExecutor?this.expressionExecutor.expression:""}set expression(e){this.expressionExecutor&&e===this.expression||(this.expressionExecutor=Ua.createExpressionExecutor(e),this.expressionExecutor.onComplete=(t,s)=>{this.doOnComplete(t,s)},this.variables=void 0,this.containsFunc=void 0)}getVariables(){return this.variables===void 0&&(this.variables=this.expressionExecutor.getVariables()),this.variables}hasFunction(){return this.containsFunc===void 0&&(this.containsFunc=this.expressionExecutor.hasFunction()),this.containsFunc}get isAsync(){return this.expressionExecutor.isAsync}canRun(){return this.expressionExecutor.canRun()}runContextCore(e,t){const s=Mw.IdRunnerCounter++;return this.onBeforeAsyncRun&&this.isAsync&&this.onBeforeAsyncRun(s),this.expressionExecutor.runContext(e,t,s)}doOnComplete(e,t){this.onAfterAsyncRun&&this.isAsync&&this.onAfterAsyncRun(t)}};ku.IdRunnerCounter=1;let Fs=class extends ku{runValues(e,t){return this.runContext(new Du(e,t?.context),t)}runContext(e,t){return this.runContextCore(e,t)==!0}doOnComplete(e,t){this.onRunComplete&&this.onRunComplete(e==!0),super.doOnComplete(e,t)}},R2=class extends ku{runValues(e,t){return this.runContext(new Du(e,t?.context),t)}runContext(e,t){return this.runContextCore(e,t)}doOnComplete(e,t){this.onRunComplete&&this.onRunComplete(e),super.doOnComplete(e,t)}},_2=class{constructor(e){this.obj=e,this.properties=null,this.values=null}getType(){return"bindings"}get isSurveyObj(){return!0}getNames(){var e=[];this.fillProperties();for(var t=0;t<this.properties.length;t++)this.properties[t].isVisible("",this.obj)&&e.push(this.properties[t].name);return e}getProperties(){var e=[];this.fillProperties();for(var t=0;t<this.properties.length;t++)e.push(this.properties[t]);return e}setBinding(e,t){this.values||(this.values={});const s=this.getJson();s!==t&&(t?this.values[e]=t:(delete this.values[e],Object.keys(this.values).length==0&&(this.values=null)),this.onChangedJSON(s))}clearBinding(e){this.setBinding(e,"")}isEmpty(){if(!this.values)return!0;for(var e in this.values)return!1;return!0}getValueNameByPropertyName(e){if(this.values)return this.values[e]}getPropertiesByValueName(e){if(!this.values)return[];var t=[];for(var s in this.values)this.values[s]==e&&t.push(s);return t}getJson(){if(this.isEmpty())return;const e={};return this.getNames().forEach(t=>{this.values[t]!==void 0&&(e[t]=this.values[t])}),e}setJson(e,t){const s=this.getJson();this.values=null,e&&this.getNames().forEach(i=>{e[i]!==void 0&&(this.values||(this.values={}),this.values[i]=e[i])}),!t&&!O.isTwoValueEquals(s,this.values)&&this.onChangedJSON(s)}fillProperties(){if(this.properties===null){this.properties=[];for(var e=q.getPropertiesByObj(this.obj),t=0;t<e.length;t++)e[t].isBindable&&this.properties.push(e[t])}}onChangedJSON(e){this.obj&&this.obj.onBindingChanged(e,this.getJson())}},ly=class kw{constructor(e,t,s){this.currentDependency=e,this.target=t,this.property=s,this.dependencies=[],this.id=""+ ++kw.DependenciesCount}addDependency(e,t){this.target===e&&this.property===t||this.dependencies.some(s=>s.obj===e&&s.prop===t)||(this.dependencies.push({obj:e,prop:t,id:this.id}),e.registerPropertyChangedHandlers([t],this.currentDependency,this.id))}dispose(){this.dependencies.forEach(e=>{e.obj.unregisterPropertyChangedHandlers([e.prop],e.id)})}};ly.DependenciesCount=0;let We=class Nw{constructor(e){this._updater=e,this.dependencies=void 0,this.type=Nw.ComputedUpdaterType}get updater(){return this._updater}setDependencies(e){this.clearDependencies(),this.dependencies=e}getDependencies(){return this.dependencies}clearDependencies(){this.dependencies&&(this.dependencies.dispose(),this.dependencies=void 0)}dispose(){this.clearDependencies(),this._updater=void 0}};We.ComputedUpdaterType="__dependency_computed";let Te=class Et{static finishCollectDependencies(){const e=Et.currentDependencis;return Et.currentDependencis=void 0,e}static startCollectDependencies(e,t,s){if(Et.currentDependencis!==void 0)throw new Error("Attempt to collect nested dependencies. Nested dependencies are not supported.");Et.currentDependencis=new ly(e,t,s)}static collectDependency(e,t){Et.currentDependencis!==void 0&&Et.currentDependencis.addDependency(e,t)}static get commentSuffix(){return A.commentSuffix}static set commentSuffix(e){A.commentSuffix=e}static get commentPrefix(){return Et.commentSuffix}static set commentPrefix(e){Et.commentSuffix=e}isValueEmpty(e,t=!0){return t&&(e=this.trimValue(e)),O.isValueEmpty(e)}equals(e){return!e||this.isDisposed||e.isDisposed||this.getType()!=e.getType()?!1:this.equalsCore(e)}equalsCore(e){return this.name!==e.name?!1:O.isTwoValueEquals(this.toJSON(),e.toJSON(),!1,!0,!1)}trimValue(e){return e&&(typeof e=="string"||e instanceof String)?e.trim():e}static createPropertiesHash(){return{}}constructor(){this.uniqueIdValue=Et.UniqueId++,this.dependencies={},this.propertyHash=Et.createPropertiesHash(),this.eventList=[],this.isLoadingFromJsonValue=!1,this.loadingOwner=null,this.onPropertyChanged=this.addEvent(),this.onNestedPropertyChanged=this.addEvent(),this.onItemValuePropertyChanged=this.addEvent(),this.isCreating=!0,this.animationAllowedLock=0,this.supportOnElementRerenderedEvent=!0,this.onElementRerenderedEventEnabled=!1,this._onElementRerendered=new Zt,Rs.createProperties(this),this.onBaseCreating(),this.isCreating=!1}dispose(){for(var e=0;e<this.eventList.length;e++)this.eventList[e].clear();this.onPropertyValueChangedCallback=void 0,this.isDisposedValue=!0,Object.keys(this.dependencies).forEach(t=>this.dependencies[t].dispose()),Object.keys(this.propertyHash).forEach(t=>{const s=this.getPropertyValueCore(this.propertyHash,t);s&&s.type==We.ComputedUpdaterType&&s.dispose()})}get isDisposed(){return this.isDisposedValue===!0}get uniqueId(){return this.uniqueIdValue}get isSurveyObj(){return!0}addEvent(){const e=new Zt;return this.eventList.push(e),e}onBaseCreating(){}getType(){return"base"}isDescendantOf(e){return q.isDescendantOf(this.getType(),e)}getSurvey(e=!1){return null}getValueGetterContext(){const e=this.getSurvey();return e?e.getValueGetterContext():new fs({})}get isDesignMode(){const e=this.getSurvey();return!!e&&e.isDesignMode}get inSurvey(){return!!this.getSurvey(!0)}get bindings(){return this.bindingsValue||(this.bindingsValue=new _2(this)),this.bindingsValue}isBindingEmpty(){return!this.bindingsValue||this.bindingsValue.isEmpty()}checkBindings(e,t){}canUpdateBindings(){return!0}updateBindings(e,t){if(!(!this.bindingsValue||!this.canUpdateBindings())){var s=this.bindings.getValueNameByPropertyName(e);s&&this.updateBindingValue(s,t)}}updateBindingValue(e,t){}getTemplate(){return this.getType()}get isLoadingFromJson(){return this.isLoadingFromJsonValue||this.getIsLoadingFromJson()}getIsLoadingFromJson(){return this.loadingOwner&&this.loadingOwner.isLoadingFromJson?!0:this.isLoadingFromJsonValue}startLoadingFromJson(e){this.isLoadingFromJsonValue=!0,this.jsonObj=e}endLoadingFromJson(){this.isLoadingFromJsonValue=!1}toJSON(e){return new qt().toJsonObject(this,e)}fromJSON(e,t){new qt().toObject(e,this,t),this.onSurveyLoad()}onSurveyLoad(){}clone(){var e=q.createClass(this.getType());return e.fromJSON(this.toJSON()),e}getPropertyByName(e){const t=this.getType();return(!this.classMetaData||this.classMetaData.name!==t)&&(this.classMetaData=q.findClass(t)),this.classMetaData?this.classMetaData.findProperty(e):null}isPropertyVisible(e){const t=this.getPropertyByName(e);return t?t.isVisible("",this):!1}static createProgressInfo(){return{questionCount:0,answeredQuestionCount:0,requiredQuestionCount:0,requiredAnsweredQuestionCount:0}}getProgressInfo(){return Et.createProgressInfo()}localeChanged(){}locStrsChanged(){if(this.arraysInfo)for(let t in this.arraysInfo){let s=this.arraysInfo[t];if(s&&s.isItemValues){var e=this.getPropertyValue(t);e&&Et.itemValueLocStrChanged&&Et.itemValueLocStrChanged(e)}}if(this.localizableStrings)for(let t in this.localizableStrings){let s=this.getLocalizableString(t);s&&s.strChanged()}}getPropertyValue(e,t,s){const i=this.getPropertyValueWithoutDefault(e);if(s&&Array.isArray(i)&&i.length===0&&i.isReset===!0)return delete i.isReset,this.setArrayPropertyDirectly(e,s(),!1),i;if(this.isValueUndefined(i)){const r=this.localizableStrings?this.localizableStrings[e]:void 0;if(r)return r.text;if(!this.isValueUndefined(t))return t;if(s){const o=s();if(o!==void 0)if(Array.isArray(o)){const l=this.createNewArray(e);return l.splice(0,0,...o),l}else return this.setPropertyValueDirectly(e,o,!0),o}const a=this.getDefaultPropertyValue(e);if(a!==void 0)return a}return i}isValueUndefined(e){return O.isValueUndefined(e)}getDefaultPropertyValue(e){const t=this.getPropertyByName(e);if(!t||t.isCustom&&this.isCreating)return;if(t.defaultValueFunc)return t.defaultValueFunc(this);const s=t.getDefaultValue(this);if(!this.isValueUndefined(s)&&!Array.isArray(s))return s;const i=this.localizableStrings?this.localizableStrings[e]:void 0;if(i&&i.localizationName)return this.getLocalizationString(i.localizationName);if(t.type=="boolean"||t.type=="switch")return!1;if(t.isCustom&&t.onGetValue)return t.onGetValue(this)}hasDefaultPropertyValue(e){return this.getDefaultPropertyValue(e)!==void 0}resetPropertyValue(e){const t=this.localizableStrings?this.localizableStrings[e]:void 0;t?(this.setLocalizableStringText(e,void 0),t.clear()):this.setPropertyValue(e,void 0)}getPropertyValueWithoutDefault(e){return this.getPropertyValueCore(this.propertyHash,e)}getPropertyValueCore(e,t){return this.isLoadingFromJson||Et.collectDependency(this,t),this.getPropertyValueCoreHandler?this.getPropertyValueCoreHandler(e,t):e[t]}geValueFromHash(){return this.propertyHash.value}setPropertyValueCore(e,t,s,i){let r=!1;this.setPropertyValueCoreHandler?(r=this.isDisposedValue,r||this.setPropertyValueCoreHandler(e,t,s)):e[t]!==s&&(e[t]=s,!i&&this.onPropertyValueCoreChanged&&(r=this.isDisposedValue,r||this.onPropertyValueCoreChanged.fire(this,{name:t,newValue:s}))),r&&ri.disposedObjectChangedProperty(t,this.getType())}get isEditingSurveyElement(){var e=this.getSurvey();return!!e&&e.isEditingSurveyElement}iteratePropertiesHash(e){var t=[];for(var s in this.propertyHash)t.push(s);t.forEach(i=>e(this.propertyHash,i))}setPropertyValue(e,t){if(!this.isDisposedValue){if(!this.isLoadingFromJson){const i=this.getPropertyByName(e);i&&(t=i.settingValue(this,t))}var s=this.getPropertyValue(e);s&&Array.isArray(s)&&this.arraysInfo&&(!t||Array.isArray(t))?this.isTwoValueEquals(s,t)||this.setArrayPropertyDirectly(e,t):t!==s&&(this.setPropertyValueDirectly(e,t),this.isTwoValueEquals(s,t)||this.propertyValueChanged(e,s,t))}}setArrayPropertyDirectly(e,t,s=!0){var i=this.arraysInfo[e];this.setArray(e,this.getPropertyValue(e),t,i?i.isItemValues:!1,i?s&&i.onPush:null)}setPropertyValueDirectly(e,t,s){this.setPropertyValueCore(this.propertyHash,e,t,s)}clearPropertyValue(e){this.setPropertyValueCore(this.propertyHash,e,null),delete this.propertyHash[e]}onPropertyValueChangedCallback(e,t,s,i,r){}itemValuePropertyChanged(e,t,s,i){this.onItemValuePropertyChanged.fire(this,{obj:e,name:t,oldValue:s,newValue:i,propertyName:e.ownerPropertyName})}onPropertyValueChanged(e,t,s){}propertyValueChanged(e,t,s,i,r){if(!this.isLoadingFromJson&&(this.updateBindings(e,s),this.onPropertyValueChanged(e,t,s),this.onPropertyChanged.fire(this,{name:e,oldValue:t,newValue:s,arrayChanges:i,target:r}),this.doPropertyValueChangedCallback(e,t,s,i,this),this.checkConditionPropertyChanged(e),!!this.onPropChangeFunctions))for(var a=0;a<this.onPropChangeFunctions.length;a++)this.onPropChangeFunctions[a].name==e&&this.onPropChangeFunctions[a].func(s,i)}onBindingChanged(e,t){this.isLoadingFromJson||this.doPropertyValueChangedCallback("bindings",e,t)}get isInternal(){return!1}doPropertyValueChangedCallback(e,t,s,i,r){const a=l=>{l&&l.onPropertyValueChangedCallback&&l.onPropertyValueChangedCallback(e,t,s,r,i)};if(this.isInternal){a(this);return}r||(r=this);var o=this.getSurvey();o||(o=this),a(o),o!==this&&a(this)}addExpressionProperty(e,t,s){this.expressionInfo||(this.expressionInfo={}),this.expressionInfo[e]={onExecute:t,canRun:s}}getDataFilteredProperties(){return{}}runConditionCore(e){if(this.expressionInfo)for(var t in this.expressionInfo)this.runConditionItemCore(t,e)}canRunConditions(){return!this.isDesignMode}checkConditionPropertyChanged(e){!this.expressionInfo||!this.expressionInfo[e]||this.canRunConditions()&&this.runConditionItemCore(e,this.getDataFilteredProperties())}runConditionItemCore(e,t){const s=this.expressionInfo[e];this.getPropertyValue(e)&&(s.canRun&&!s.canRun(this)||this.runExpressionByProperty(e,t,r=>{s.onExecute(this,r)}))}doBeforeAsynRun(e){this.asynExpressionHash||(this.asynExpressionHash={});const t=!this.isAsyncExpressionRunning;this.asynExpressionHash[e]=!0,t&&this.onAsyncRunningChanged()}doAfterAsynRun(e){this.asynExpressionHash&&(delete this.asynExpressionHash[e],this.isAsyncExpressionRunning||this.onAsyncRunningChanged())}onAsyncRunningChanged(){}get isAsyncExpressionRunning(){return!!this.asynExpressionHash&&Object.keys(this.asynExpressionHash).length>0}createExpressionRunner(e){const t=new R2(e);return t.onBeforeAsyncRun=s=>{this.doBeforeAsynRun(s)},t.onAfterAsyncRun=s=>{this.doAfterAsynRun(s)},t}getExpressionFromSurvey(e){let t=this[e];if(!t)return"";const s=this.getSurvey();return s?s.beforeExpressionRunning(this,e,t):t}runExpressionByProperty(e,t,s,i){if(!this[e])return!1;const r=this.getExpressionFromSurvey(e);if(r){const a=this.getExpressionInfoByProperty(e,r),o=a.runner;!a.isRunning&&(!i||i(o))&&(a.isRunning=!0,o.onRunComplete=l=>{s(l),a.isRunning=!1},o.runContext(this.getValueGetterContext(),this.getPropertiesCopy(t,e)))}return!0}getPropertiesCopy(e,t){const s={};for(const i in e)s[i]=e[i];return t&&(s.propertyName=t),s}getExpressionByProperty(e){const t=this.getExpressionFromSurvey(e);return t?this.getExpressionInfoByProperty(e,t).runner:null}getExpressionInfoByProperty(e,t){this.runExpressionHash||(this.runExpressionHash={});let s=this.runExpressionHash[e];return s?s.runner.expression=t:(s={runner:this.createExpressionRunner(t)},this.runExpressionHash[e]=s),s}registerPropertyChangedHandlers(e,t,s=null){for(var i=0;i<e.length;i++)this.registerFunctionOnPropertyValueChanged(e[i],t,s)}unregisterPropertyChangedHandlers(e,t=null){for(var s=0;s<e.length;s++)this.unRegisterFunctionOnPropertyValueChanged(e[s],t)}registerFunctionOnPropertyValueChanged(e,t,s=null){if(this.onPropChangeFunctions||(this.onPropChangeFunctions=[]),s)for(var i=0;i<this.onPropChangeFunctions.length;i++){var r=this.onPropChangeFunctions[i];if(r.name==e&&r.key==s){r.func=t;return}}this.onPropChangeFunctions.push({name:e,func:t,key:s})}registerFunctionOnPropertiesValueChanged(e,t,s=null){this.registerPropertyChangedHandlers(e,t,s)}unRegisterFunctionOnPropertyValueChanged(e,t=null){if(this.onPropChangeFunctions)for(var s=0;s<this.onPropChangeFunctions.length;s++){var i=this.onPropChangeFunctions[s];if(i.name==e&&i.key==t)return this.onPropChangeFunctions.splice(s,1)}}unRegisterFunctionOnPropertiesValueChanged(e,t=null){this.unregisterPropertyChangedHandlers(e,t)}createCustomLocalizableObj(e){const t=this.getLocalizableString(e);return t||this.createLocalizableString(e,this,!1,!0)}getLocale(){const e=this.getSurvey();return e?e.getLocale():""}getLocalizationString(e){return Ct(e,this.getLocale())}getLocalizationFormatString(e,...t){const s=this.getLocalizationString(e);return!s||!s.format?"":s.format(...t)}createLocString(e){return e.hasTranslation&&!e.translationKey&&(e.translationKey=e.name),this.createLocalizableString(e.name,e.owner,e.supportsMarkdown,e.translationKey)}createLocalizableString(e,t,s=!1,i=!1){t||(t=this);let r;i&&(r=i===!0?e:i);const a=new At(t,s,e,r);a.onStrChanged=(l,u)=>{this.propertyValueChanged(e,l,u)},this.localizableStrings||(this.localizableStrings={}),this.localizableStrings[e]=a;const o=this.getPropertyByName(e);return a.disableLocalization=o&&o.isLocalizable===!1,a}removeLocalizableString(e){this.localizableStrings&&delete this.localizableStrings[e]}getLocalizableString(e){return this.localizableStrings?this.localizableStrings[e]:null}getLocalizableStringText(e,t=""){Et.collectDependency(this,e);var s=this.getLocalizableString(e);if(!s)return"";var i=s.text;return i||t}setLocalizableStringText(e,t){let s=this.getLocalizableString(e);if(!s)return;s.text!=t&&(s.text=t)}addUsedLocales(e){if(this.localizableStrings)for(let t in this.localizableStrings){let s=this.getLocalizableString(t);s&&this.AddLocStringToUsedLocales(s,e)}if(this.arraysInfo)for(let t in this.arraysInfo){const s=this.getPropertyByName(t);if(!s||!s.isPropertySerializable(this))continue;let i=this.getPropertyValue(t);if(!(!i||!i.length))for(let r=0;r<i.length;r++){let a=i[r];a&&a.addUsedLocales&&a.addUsedLocales(e)}}}searchText(e,t){var s=[];this.getSearchableLocalizedStrings(s);for(var i=0;i<s.length;i++)s[i].setFindText(e)&&t.push({element:this,str:s[i]})}getSearchableLocalizedStrings(e){if(this.localizableStrings){let a=[];this.getSearchableLocKeys(a);for(var t=0;t<a.length;t++){let o=this.getLocalizableString(a[t]);o&&e.push(o)}}if(!this.arraysInfo)return;let s=[];this.getSearchableItemValueKeys(s);for(var t=0;t<s.length;t++){var i=this.getPropertyValue(s[t]);if(i)for(var r=0;r<i.length;r++)e.push(i[r].locText)}}getSearchableLocKeys(e){}getSearchableItemValueKeys(e){}AddLocStringToUsedLocales(e,t){for(var s=e.getLocales(),i=0;i<s.length;i++)t.indexOf(s[i])<0&&t.push(s[i])}createItemValues(e){var t=this,s=this.createNewArray(e,function(i){if(i.locOwner=t,i.ownerPropertyName=e,typeof i.getSurvey=="function"){const r=i.getSurvey();r&&typeof r.makeReactive=="function"&&r.makeReactive(i)}});return this.arraysInfo[e].isItemValues=!0,s}addOnArrayChangedCallback(e){this.onArrayChanged||(this.onArrayChanged=new Zt),this.onArrayChanged.add(e)}removeOnArrayChangedCallback(e){this.onArrayChanged&&(this.onArrayChanged.remove(e),this.onArrayChanged.isEmpty&&(this.onArrayChanged=void 0))}notifyArrayChanged(e,t,s){this.onArrayChanged&&this.onArrayChanged.fire(this,{arrayChanges:s,name:e,newValue:t,valueFromHash:this.propertyHash[e]})}addOnPropertyValueChangedCallback(e){this.onPropertyValueCoreChanged||(this.onPropertyValueCoreChanged=new Zt),this.onPropertyValueCoreChanged.add(e)}removeOnPropertyValueChangedCallback(e){this.onPropertyValueCoreChanged&&(this.onPropertyValueCoreChanged.remove(e),this.onPropertyValueCoreChanged.isEmpty&&(this.onPropertyValueCoreChanged=void 0))}createNewArrayCore(e){var t=null;return this.createArrayCoreHandler&&(t=this.createArrayCoreHandler(this.propertyHash,e)),t||(t=new Array,this.setPropertyValueCore(this.propertyHash,e,t)),t}ensureArray(e,t=null,s=null){if(!(this.arraysInfo&&this.arraysInfo[e]))return this.createNewArray(e,t,s)}createNewArray(e,t=null,s=null){var i=this.createNewArrayCore(e);this.arraysInfo||(this.arraysInfo={}),this.arraysInfo[e]={onPush:t,isItemValues:!1};var r=this;return i.push=function(a){var o=Object.getPrototypeOf(i).push.call(i,a);if(!r.isDisposedValue){t&&t(a,i.length-1);const l=new fr(i.length-1,0,[a],[]);r.propertyValueChanged(e,i,i,l),r.notifyArrayChanged(e,i,l)}return o},i.shift=function(){var a=Object.getPrototypeOf(i).shift.call(i);if(!r.isDisposedValue&&a){s&&s(a);const o=new fr(i.length-1,1,[],[]);r.propertyValueChanged(e,i,i,o),r.notifyArrayChanged(e,i,o)}return a},i.unshift=function(a){var o=Object.getPrototypeOf(i).unshift.call(i,a);if(!r.isDisposedValue){t&&t(a,i.length-1);const l=new fr(0,0,[a],[]);r.propertyValueChanged(e,i,i,l),r.notifyArrayChanged(e,i,l)}return o},i.pop=function(){var a=Object.getPrototypeOf(i).pop.call(i);if(!r.isDisposedValue){s&&s(a);const o=new fr(i.length-1,1,[],[]);r.propertyValueChanged(e,i,i,o),r.notifyArrayChanged(e,i,o)}return a},i.splice=function(a,o,...l){a||(a=0),o||(o=0);var u=Object.getPrototypeOf(i).splice.call(i,a,o,...l);if(l||(l=[]),!r.isDisposedValue){if(s&&u)for(var d=0;d<u.length;d++)s(u[d]);if(t)for(var d=0;d<l.length;d++)t(l[d],a+d);const h=new fr(a,o,l,u);r.propertyValueChanged(e,i,i,h),r.notifyArrayChanged(e,i,h)}return u},i}getItemValueType(){}setArray(e,t,s,i,r){var a=[].concat(t);if(Object.getPrototypeOf(t).splice.call(t,0,t.length),s){for(var o=0;o<s.length;o++){var l=s[o];i&&Et.createItemValue&&(l=Et.createItemValue(l,this.getItemValueType())),Object.getPrototypeOf(t).push.call(t,l),r&&r(t[o])}delete t.isReset}else t.isReset=!0;const u=new fr(0,a.length,t,a);this.propertyValueChanged(e,a,t,u),this.notifyArrayChanged(e,t,u)}isTwoValueEquals(e,t,s=!1,i=!1){return O.checkIfValuesEqual(e,t,{ignoreOrder:!1,caseSensitive:!s,trimStrings:i,doNotConvertNumbers:!0})}static copyObject(e,t){for(var s in t){var i=t[s];typeof i=="object"&&(i={},this.copyObject(i,t[s])),e[s]=i}}copyCssClasses(e,t){t&&(typeof t=="string"||t instanceof String?e.root=t:Et.copyObject(e,t))}getValueInLowCase(e){return e&&typeof e=="string"?e.toLowerCase():e}getElementsInDesign(e=!1){return[]}get animationAllowed(){return this.getIsAnimationAllowed()}getIsAnimationAllowed(){return A.animationEnabled&&this.animationAllowedLock>=0&&!this.isLoadingFromJson&&!this.isDisposed&&(!!this.onElementRerendered||!this.supportOnElementRerenderedEvent)}blockAnimations(){this.animationAllowedLock--}releaseAnimations(){this.animationAllowedLock++}enableOnElementRerenderedEvent(){this.onElementRerenderedEventEnabled=!0}disableOnElementRerenderedEvent(){var e;(e=this.onElementRerendered)===null||e===void 0||e.fire(this,{isCancel:!0}),this.onElementRerenderedEventEnabled=!1}get onElementRerendered(){return this.supportOnElementRerenderedEvent&&this.onElementRerenderedEventEnabled?this._onElementRerendered:void 0}afterRerender(){var e;(e=this.onElementRerendered)===null||e===void 0||e.fire(this,{isCancel:!1})}};Te.UniqueId=0,Te.currentDependencis=void 0;let fr=class{constructor(e,t,s,i){this.index=e,this.deleteCount=t,this.itemsToAdd=s,this.deletedItems=i}},uy=class{get isEmpty(){return this.length===0}get length(){return this.callbacks?this.callbacks.length:0}fireByCreatingOptions(e,t){if(this.callbacks){for(var s=0;s<this.callbacks.length;s++)if(this.callbacks[s](e,t()),!this.callbacks)return}}fire(e,t){if(!this.callbacks)return;const s=[].concat(this.callbacks);for(var i=0;i<s.length;i++)if(s[i](e,t),!this.callbacks)return}clear(){this.callbacks=void 0}add(e){this.hasFunc(e)||(this.callbacks||(this.callbacks=new Array),this.callbacks.push(e),this.fireCallbackChanged())}remove(e){if(this.hasFunc(e)){var t=this.callbacks.indexOf(e,0);this.callbacks.splice(t,1),this.fireCallbackChanged()}}hasFunc(e){return this.callbacks==null?!1:this.callbacks.indexOf(e,0)>-1}fireCallbackChanged(){this.onCallbacksChanged&&this.onCallbacksChanged()}},Zt=class extends uy{};function S(n,e,t,s){var i=arguments.length,r=i<3?e:s,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,s);else for(var o=n.length-1;o>=0;o--)(a=n[o])&&(r=(i<3?a(r):i>3?a(e,t,r):a(e,t))||r);return i>3&&r&&Object.defineProperty(e,t,r),r}let L2=class{constructor(e,t,s){this.container=e,this.model=t,this.afterInitializeCallback=s,this.resizeObserver=void 0,this.isInitialized=!1,this.isResizeObserverStarted=!1,this.getComputedStyle=i=>ge.getComputedStyle(i),this.isDisposed=!1,typeof ResizeObserver<"u"&&(this.resizeObserver=new ResizeObserver(i=>{we.requestAnimationFrame(()=>{this.isResizeObserverStarted=!0,this.process()})}),this.resizeObserver.observe(this.container.parentElement))}getDimensions(e){return{scroll:e.scrollWidth,offset:e.offsetWidth}}getAvailableSpace(){const e=this.getComputedStyle(this.container);let t=this.container.offsetWidth;return e.boxSizing==="border-box"&&(t-=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight)),t}getGap(){const e=this.getComputedStyle(this.container);if(e.display=="flex"){const t=parseFloat(e.rowGap);return isNaN(t)?0:t}return 0}calcItemSize(e){return e.offsetWidth||e.getBoundingClientRect().width}updateItemsDimensions(e){if(!this.container)return;const t=this.isInitialized?this.model.renderedActions.filter(r=>r.needUpdateMaxDimension||r.needUpdateMinDimension):this.model.renderedActions;let s=t.length;s==0&&e();const i=()=>{--s<=0&&e()};t.forEach(r=>{const a=!this.isInitialized||r.needUpdateMaxDimension,l=!this.isInitialized||r.needUpdateMinDimension?a?void 0:"small":"large";r.updateDimensions(u=>this.calcItemSize(u),()=>{r.needUpdateMaxDimension=!1,r.needUpdateMinDimension=!1,i()},l)})}get isContainerVisible(){return!!this.container&&Wu(this.container)}shouldProcessResponsiveness(){return this.isContainerVisible&&!this.model.isResponsivenessDisabled&&!this.isDisposed}process(){this.shouldProcessResponsiveness()&&this.updateItemsDimensions(()=>{this.shouldProcessResponsiveness()&&this.model.fit({availableSpace:this.getAvailableSpace(),gap:this.getGap()}),this.isInitialized||(this.isInitialized=!0,this.afterInitializeCallback&&this.afterInitializeCallback())})}update(e){this.isResizeObserverStarted&&(this.model.isResponsivenessDisabled||(e&&(this.isInitialized=!1),this.process()))}dispose(){this.isDisposed=!0,this.resizeObserver&&this.resizeObserver.disconnect(),this.isResizeObserverStarted=!1,this.resizeObserver=void 0,this.container=void 0}},z=class{constructor(){this.classes=[]}isEmpty(){return this.toString()===""}append(e,t=!0){return e&&t&&(typeof e=="string"&&(e=e.trim()),this.classes.push(e)),this}toString(){return this.classes.join(" ")}};function hy(n){let e=!1,t=!1,s;const i=()=>{t=!0,s=void 0};return{run:((...r)=>{t=!1,s=r,e||(e=!0,queueMicrotask(()=>{t||n.apply(this,s),s=void 0,t=!1,e=!1}))}),cancel:i,getLastArguments:()=>s,flushSync:()=>{!t&&e&&(n.apply(this,s),i())}}}let _s={root:"sv-action-bar",defaultSizeMode:"sv-action-bar--default-size-mode",smallSizeMode:"sv-action-bar--small-size-mode",item:"sv-action-bar-item",itemWithTitle:"",itemAsIcon:"sv-action-bar-item--icon",itemActive:"sv-action-bar-item--active",itemPressed:"sv-action-bar-item--pressed",itemIcon:"sv-action-bar-item__icon",itemTitle:"sv-action-bar-item__title",itemTitleWithIcon:"sv-action-bar-item__title--with-icon"},_t=class qw extends Te{constructor(){super(...arguments),this.id=qw.ContainerID++,this.visibleActions=[],this.sizeMode="default",this.raiseUpdateCallback=hy(e=>{this.update(e)}),this.onActionPropertyChangedCallback=this.onActionPropertyChanged.bind(this)}getMarkdownHtml(e,t,s){return this.locOwner?this.locOwner.getMarkdownHtml(e,t,s):void 0}getRenderer(e){return this.locOwner?this.locOwner.getRenderer(e):null}getRendererContext(e){return this.locOwner?this.locOwner.getRendererContext(e):e}getProcessedText(e){return this.locOwner?this.locOwner.getProcessedText(e):e}getLocale(){return this.locOwner?this.locOwner.getLocale():""}getRenderedActions(){return this.visibleActions}locStrsChanged(){super.locStrsChanged(),this.actions.forEach(e=>{e.locTitle&&e.locTitle.strChanged(),e.locStrsChanged()})}flushUpdates(){this.raiseUpdateCallback.flushSync()}raiseUpdate(e){var t;const s=this.raiseUpdateCallback.getLastArguments(),i=(t=s&&s[0])!==null&&t!==void 0?t:{};this.raiseUpdateCallback.run(this.mergeUpdateOptions(e,i))}mergeUpdateOptions(e,t){const s=Object.assign({},e);return s.needUpdateActions=!!s.needUpdateActions||!!t.needUpdateActions,s.needUpdateIsEmpty=!!s.needUpdateIsEmpty||!!t.needUpdateIsEmpty,s}update(e){e?.needUpdateActions&&this.updateVisibleActions(),e?.needUpdateIsEmpty&&this.updateIsEmpty()}updateVisibleActions(){this.visibleActions=this.getVisibleActions()}updateIsEmpty(){this.isEmpty=this.getIsEmpty()}getIsEmpty(){return this.visibleActions.length<=0}getVisibleActions(){return this.actions.filter(e=>e.visible!==!1)}onSet(){this.actions.forEach(e=>{this.patchAction(e)})}onPush(e){this.patchAction(e),this.raiseUpdate({needUpdateActions:!0,needUpdateIsEmpty:!0})}onRemove(e){this.unPatchAction(e),this.raiseUpdate({needUpdateActions:!0,needUpdateIsEmpty:!0})}onActionPropertyChanged(e,t){t.name=="_visible"&&this.raiseUpdate({needUpdateActions:!0,needUpdateIsEmpty:!0})}patchAction(e){this.setActionCssClasses(e),e.owner=this,e.onPropertyChanged.add(this.onActionPropertyChangedCallback)}unPatchAction(e){e.owner=null,e.onPropertyChanged.remove(this.onActionPropertyChangedCallback)}setActionCssClasses(e){e.cssClasses=this.cssClasses}get hasActions(){return(this.actions||[]).length>0}get hasVisibleActions(){return!this.isEmpty}get renderedActions(){return this.getRenderedActions()}getRootStyle(){}getRootCss(){const e=this.sizeMode==="small"?this.cssClasses.smallSizeMode:this.cssClasses.defaultSizeMode;return new z().append(this.cssClasses.root+(e?" "+e:"")+(this.containerCss?" "+this.containerCss:"")).append(this.cssClasses.root+"--empty",this.isEmpty).toString()}getDefaultCssClasses(){return _s}getAllActions(){return this.actions}setCssClasses(e,t=!0){this.cssClassesValue={},t&&this.copyCssClasses(this.cssClassesValue,this.getDefaultCssClasses()),Xr(e,this.cssClasses),this.getAllActions().forEach(s=>{this.setActionCssClasses(s)})}set cssClasses(e){this.setCssClasses(e)}get cssClasses(){return this.cssClassesValue||(this.cssClassesValue=this.getDefaultCssClasses()),this.cssClassesValue}createAction(e){return e instanceof tt?e:this.createActionCore(e)}createActionCore(e){return new Pe(e)}addAction(e,t=!0){const s=this.createAction(e);if(t&&!this.isActionVisible(s))return s;const i=[].concat(this.actions,s);return this.sortItems(i),this.actions=i,s}removeActionById(e){const t=this.getActionIndexById(e);return t<0?!1:(this.actions.splice(t,1),!0)}setItems(e,t=!0){const s=[];e.forEach(i=>{(!t||this.isActionVisible(i))&&s.push(this.createAction(i))}),t&&this.sortItems(s),this.actions=s}sortItems(e){this.hasSetVisibleIndex(e)&&e.sort(this.compareByVisibleIndex)}hasSetVisibleIndex(e){for(let t=0;t<e.length;t++){const s=e[t].visibleIndex;if(s!==void 0&&s>=0)return!0}return!1}compareByVisibleIndex(e,t){return e.visibleIndex-t.visibleIndex}isActionVisible(e){return e.visibleIndex>=0||e.visibleIndex===void 0}popupAfterShowCallback(e){}mouseOverHandler(e){e.isHovered=!0;let t=!1,s=!1;if(this.actions.forEach(i=>{i===e&&e.popupModel&&(t=!0),i.popupModel&&i.popupModel.isVisible&&(s=!0)}),t){const i=s?Math.max(this.subItemsShowDelay,this.subItemsHideDelay):this.subItemsShowDelay;e.showPopupDelayed(i),this.popupAfterShowCallback(e)}}initResponsivityManager(e,t){}resetResponsivityManager(){}getActionById(e){const t=this.getActionIndexById(e);return t>-1?this.actions[t]:null}getActionIndexById(e){for(var t=0;t<this.actions.length;t++)if(this.actions[t].id===e)return t;return-1}dispose(){super.dispose(),this.resetResponsivityManager(),this.actions.forEach(e=>e.dispose()),this.actions.length=0}};_t.ContainerID=1,S([Nt({})],_t.prototype,"visibleActions",void 0),S([Nt({onSet:(n,e)=>{e.onSet()},onPush:(n,e,t)=>{t.onPush(n)},onRemove:(n,e,t)=>{t.onRemove(n)}})],_t.prototype,"actions",void 0),S([E({})],_t.prototype,"containerCss",void 0),S([E({defaultValue:!0})],_t.prototype,"isEmpty",void 0),S([E({defaultValue:300})],_t.prototype,"subItemsShowDelay",void 0),S([E({defaultValue:300})],_t.prototype,"subItemsHideDelay",void 0);let yr=class{static focusElement(e){e&&e.focus()}static visibility(e){var t=ge.getComputedStyle(e);return t.display==="none"||t.visibility==="hidden"?!1:e.parentElement?this.visibility(e.parentElement):!0}static getNextElementPreorder(e){const t=e.nextElementSibling?e.nextElementSibling:e.parentElement.firstElementChild;return this.visibility(t)?t:this.getNextElementPreorder(t)}static getNextElementPostorder(e){const t=e.previousElementSibling?e.previousElementSibling:e.parentElement.lastElementChild;return this.visibility(t)?t:this.getNextElementPostorder(t)}static hasHorizontalScroller(e){return e?e.scrollWidth>e.offsetWidth:!1}static hasVerticalScroller(e){return e?e.scrollHeight>e.offsetHeight:!1}},Nu=!1,dy=null;typeof navigator<"u"&&navigator&&we.isAvailable()&&(dy=navigator.userAgent||navigator.vendor||we.hasOwn("opera")),(function(n){n&&(navigator.platform==="MacIntel"&&navigator.maxTouchPoints>0||navigator.platform==="iPad"||/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substring(0,4)))&&(Nu=!0)})(dy);const qu=Nu||!1;var cy={get isTouch(){return!this.hasMouse&&this.hasTouchEvent},get hasTouchEvent(){return we.isAvailable()&&(we.hasOwn("ontouchstart")||navigator.maxTouchPoints>0)},hasMouse:!0};const A2=we.matchMedia;cy.hasMouse=O2(A2);let ft=cy.isTouch;function D2(n,e,t=600){const s=n||we.getInnerWidth(),i=e||we.getInnerHeight();return Math.min(s,i)>=t}function O2(n){if(!n||qu)return!1;const e=n("(pointer:fine)"),t=n("(any-hover:hover)");return!!e&&e.matches||!!t&&t.matches}let M2={root:"sv-list__container",item:"sv-list__item",searchClearButtonIcon:"sv-list__filter-clear-button",loadingIndicator:"sv-list__loading-indicator",itemSelected:"sv-list__item--selected",itemGroup:"sv-list__item--group",itemGroupSelected:"sv-list__item--group-selected",itemWithIcon:"sv-list__item--with-icon",itemDisabled:"sv-list__item--disabled",itemFocused:"sv-list__item--focused",itemHovered:"sv-list__item--hovered",itemTextWrap:"sv-list__item-text--wrap",itemIcon:"sv-list__item-icon",itemMarkerIcon:"sv-list-item__marker-icon",itemSeparator:"sv-list__item-separator",itemBody:"sv-list__item-body",itemsContainer:"sv-list",itemsContainerFiltering:"sv-list--filtering",filter:"sv-list__filter",filterIcon:"sv-list__filter-icon",filterInput:"sv-list__input",emptyContainer:"sv-list__empty-container",emptyText:"sv-list__empty-text"},dt=class Bw extends _t{hasText(e,t){if(!t)return!0;const s=e.title||"";if(this.onTextSearchCallback)return this.onTextSearchCallback(e,t);let i=s.toLocaleLowerCase();return i=A.comparator.normalizeTextCallback(i,"filter"),i.indexOf(t.toLocaleLowerCase())>-1}isItemVisible(e){return e.id===this.loadingIndicator.id||this.disableSearch?e.visible:e.visible&&this.hasText(e,this.filterString)}getRenderedActions(){let e=super.getRenderedActions();if(this.filterString){let t=[];return e.forEach(s=>{t.push(s),s.items&&s.items.forEach(i=>{const r=new Pe(i);r.iconName||(r.iconName=s.iconName),t.push(r)})}),t}return e}get visibleItems(){return this.actions.filter(e=>this.isItemVisible(e))}onFilterStringChanged(e){this.onFilterStringChangedCallback&&this.onFilterStringChangedCallback(e),this.raiseUpdate({needUpdateIsEmpty:!0})}getIsEmpty(){return!this.renderedActions.some(e=>this.isItemVisible(e))}scrollToItem(e,t=0){setTimeout(()=>{if(!this.listContainerHtmlElement)return;const s=this.listContainerHtmlElement.querySelector(rs(e));s&&setTimeout(()=>{s.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})},t)},t)}constructor(e,t,s,i,r){if(super(),this.onSelectionChanged=t,this.allowSelection=s,this.elementId=r,this.onItemClick=a=>{if(this.isItemDisabled(a))return;this.isExpanded=!1,this.allowSelection&&(this.selectedItem=a),this.onSelectionChanged&&this.onSelectionChanged(a);const o=a.action;o&&o(a)},this.onItemHover=a=>{this.mouseOverHandler(a)},this.isItemDisabled=a=>a.enabled!==void 0&&!a.enabled,this.getA11yItemAriaSelected=a=>{if(this.listItemRole=="option")return this.isItemSelected(a)?"true":"false"},this.getA11yItemAriaChecked=a=>{if(this.listItemRole=="menuitemradio")return this.isItemSelected(a)?"true":"false"},this.isItemSelected=a=>this.areSameItems(this.selectedItem,a),this.isItemFocused=a=>this.areSameItems(this.focusedItem,a),this.getListClass=()=>new z().append(this.cssClasses.itemsContainer).append(this.cssClasses.itemsContainerFiltering,!!this.filterString&&this.visibleActions.length!==this.visibleItems.length).toString(),this.getItemClass=a=>{const o=this.isItemSelected(a);return new z().append(this.cssClasses.item).append(this.cssClasses.itemWithIcon,!!a.iconName).append(this.cssClasses.itemDisabled,this.isItemDisabled(a)).append(this.cssClasses.itemFocused,this.isItemFocused(a)).append(this.cssClasses.itemSelected,!a.hasSubItems&&o).append(this.cssClasses.itemGroup,a.hasSubItems).append(this.cssClasses.itemGroupSelected,a.hasSubItems&&o).append(this.cssClasses.itemHovered,a.isHovered).append(this.cssClasses.itemTextWrap,this.textWrapEnabled).append(a.css).toString()},this.getItemStyle=a=>({"--sjs-list-item-level":(a.level||0)+1}),Object.keys(e).indexOf("items")!==-1){const a=e;Object.keys(a).forEach(o=>{switch(o){case"items":this.setItems(a.items);break;case"onFilterStringChangedCallback":this.setOnFilterStringChangedCallback(a.onFilterStringChangedCallback);break;case"onTextSearchCallback":this.setOnTextSearchCallback(a.onTextSearchCallback);break;default:this[o]=a[o]}}),this.updateActionsIds()}else this.setItems(e),this.selectedItem=i}setOnFilterStringChangedCallback(e){this.onFilterStringChangedCallback=e}setOnTextSearchCallback(e){this.onTextSearchCallback=e}setItems(e,t=!0){super.setItems(e,t),this.updateActionsIds(),!this.isAllDataLoaded&&this.actions.length&&this.actions.push(this.loadingIndicator)}updateActionsIds(){this.elementId&&this.actions.forEach(e=>{e.elementId=this.elementId+e.id})}setSearchEnabled(e){this.searchEnabled=e,this.showSearchClearButton=e}onSet(){this.showFilter=this.searchEnabled&&(this.forceShowFilter||(this.actions||[]).length>Bw.MINELEMENTCOUNT),super.onSet()}getDefaultCssClasses(){return M2}popupAfterShowCallback(e){this.addScrollEventListener(()=>{e.hidePopup()})}onItemLeave(e){e.hidePopupDelayed(this.subItemsHideDelay)}areSameItems(e,t){return this.areSameItemsCallback?this.areSameItemsCallback(e,t):!!e&&!!t&&e.id==t.id}get a11ya11y_input_ariaLabel(){return this.listAriaLabel}get filterStringPlaceholder(){return this.getLocalizationString("filterStringPlaceholder")}get emptyMessage(){return this.isAllDataLoaded?this.getLocalizationString("emptyMessage"):this.getLocalizationString("loadingData")}get scrollableContainer(){return this.listContainerHtmlElement.querySelector(rs(this.cssClasses.itemsContainer))}get loadingIndicator(){if(!this.loadingIndicatorValue){const e=new Pe({id:"loadingIndicator",title:this.getLocalizationString("loadingPage"),action:()=>{},css:this.cssClasses.loadingIndicator});e.initLoadingIndicatorVisibilityObserver(this.loadingIndicatorVisibilityObserver),this.loadingIndicatorValue=e}return this.loadingIndicatorValue}goToItems(e){if(e.key==="ArrowDown"||e.keyCode===40){const s=e.target.parentElement.parentElement.querySelector("ul"),i=X2(s);s&&i&&(yr.focusElement(i),e.preventDefault())}}onMouseMove(e){this.resetFocusedItem()}onKeyDown(e){const t=e.target;e.key==="ArrowDown"||e.keyCode===40?(yr.focusElement(yr.getNextElementPreorder(t)),e.preventDefault()):(e.key==="ArrowUp"||e.keyCode===38)&&(yr.focusElement(yr.getNextElementPostorder(t)),e.preventDefault())}onPointerDown(e,t){}refresh(){this.filterString==""&&this.raiseUpdate({needUpdateIsEmpty:!0}),this.resetFocusedItem()}onClickSearchClearButton(e){e.currentTarget.parentElement.querySelector("input").focus(),this.refresh()}resetFocusedItem(){this.focusedItem=void 0}focusFirstVisibleItem(){ft||(this.focusedItem=this.visibleItems[0])}focusLastVisibleItem(){this.focusedItem=this.visibleItems[this.visibleItems.length-1]}initFocusedItem(){this.focusedItem=this.visibleItems.filter(e=>e.visible&&this.isItemSelected(e))[0],this.focusedItem||this.focusFirstVisibleItem()}focusNextVisibleItem(){if(!this.focusedItem)this.initFocusedItem();else{const e=this.visibleItems,t=e.indexOf(this.focusedItem),s=e[t+1];s?this.focusedItem=s:this.focusFirstVisibleItem()}}focusPrevVisibleItem(){if(!this.focusedItem)this.initFocusedItem();else{const e=this.visibleItems,t=e.indexOf(this.focusedItem),s=e[t-1];s?this.focusedItem=s:this.focusLastVisibleItem()}}selectFocusedItem(){this.focusedItem&&this.onItemClick(this.focusedItem)}initListContainerHtmlElement(e){this.listContainerHtmlElement=e}onItemRended(e,t){this.isAllDataLoaded||(e===this.actions[this.actions.length-1]&&this.listContainerHtmlElement&&(this.hasVerticalScroller=yr.hasVerticalScroller(this.scrollableContainer)),e.id===this.loadingIndicator.id&&t&&this.loadingIndicator.intersectionVisibilityObserver&&this.loadingIndicator.intersectionVisibilityObserver.observe(t))}scrollToFocusedItem(){this.scrollToItem(this.cssClasses.itemFocused)}scrollToSelectedItem(){this.selectedItem&&this.selectedItem.items&&this.selectedItem.items.length>0?this.scrollToItem(this.cssClasses.itemGroupSelected,110):this.scrollToItem(this.cssClasses.itemSelected,110)}setLoadingIndicatorVisibilityObserver(e){e&&(this.loadingIndicatorVisibilityObserver=e)}addScrollEventListener(e){e&&(this.removeScrollEventListener(),this.scrollHandler=e),this.scrollHandler&&this.scrollableContainer.addEventListener("scroll",this.scrollHandler)}removeScrollEventListener(){this.scrollHandler&&this.scrollableContainer.removeEventListener("scroll",this.scrollHandler)}dispose(){super.dispose(),this.loadingIndicatorValue&&this.loadingIndicatorValue.dispose(),this.listContainerHtmlElement=void 0}};dt.INDENT=16,dt.MINELEMENTCOUNT=10,S([E({defaultValue:!0,onSet:(n,e)=>{e.onSet()}})],dt.prototype,"searchEnabled",void 0),S([E({defaultValue:!1})],dt.prototype,"showFilter",void 0),S([E({defaultValue:!1})],dt.prototype,"forceShowFilter",void 0),S([E({defaultValue:!1})],dt.prototype,"isExpanded",void 0),S([E({})],dt.prototype,"selectedItem",void 0),S([E()],dt.prototype,"focusedItem",void 0),S([E({onSet:(n,e)=>{e.onFilterStringChanged(e.filterString)}})],dt.prototype,"filterString",void 0),S([E({defaultValue:!1})],dt.prototype,"hasVerticalScroller",void 0),S([E({defaultValue:!0})],dt.prototype,"isAllDataLoaded",void 0),S([E({defaultValue:!1})],dt.prototype,"showSearchClearButton",void 0),S([E({defaultValue:!0})],dt.prototype,"renderElements",void 0),S([E({defaultValue:!1})],dt.prototype,"textWrapEnabled",void 0),S([E({defaultValue:"sv-list-item-content"})],dt.prototype,"itemComponent",void 0),S([E({defaultValue:"listbox"})],dt.prototype,"listRole",void 0),S([E({defaultValue:"option"})],dt.prototype,"listItemRole",void 0),S([E()],dt.prototype,"listAriaLabel",void 0),S([E({defaultValue:!1})],dt.prototype,"disableSearch",void 0);let Lt=class extends Te{refreshInnerModel(){const e=this.contentComponentData.model;e&&e.refresh&&e.refresh()}constructor(e,t,s){if(super(),this.focusFirstInputSelector="",this.onCancel=()=>{},this.onApply=()=>!0,this.onHide=()=>{},this.onShow=()=>{},this.onBlur=()=>{},this.onDispose=()=>{},this.onVisibilityChanged=this.addEvent(),this.onFooterActionsCreated=this.addEvent(),this.onRecalculatePosition=this.addEvent(),this.contentComponentName=e,this.contentComponentData=t,s)for(var i in s)this[i]=s[i]}get isVisible(){return this.getPropertyValue("isVisible",!1)}set isVisible(e){this.isVisible!==e&&(this.setPropertyValue("isVisible",e),this.onVisibilityChanged.fire(this,{model:this,isVisible:e}))}toggleVisibility(){this.isVisible=!this.isVisible}show(){this.isVisible||(this.isVisible=!0)}hide(){this.isVisible&&(this.isVisible=!1)}recalculatePosition(e){this.onRecalculatePosition.fire(this,{isResetHeight:e})}updateFooterActions(e){const t={actions:e};return this.onFooterActionsCreated.fire(this,t),t.actions}getDisplayMode(){if(this.isModal)return this.displayMode==="popup"?"modal-popup":"modal-overlay";if(this.displayMode==="popup")return"menu-popup";{let e;switch(this.overlayDisplayMode){case"plain":{e="menu-popup";break}case"dropdown-overlay":{e="menu-overlay";break}case"tablet-dropdown-overlay":{e="menu-popup-overlay";break}case"auto":{ft?e="menu-popup-overlay":e="menu-popup";break}}return e}}updateDisplayMode(e){let t,s;switch(e){case"dropdown":{t="popup",s="auto";break}case"popup":{t="overlay",s="tablet-dropdown-overlay";break}case"overlay":{t="overlay",s="dropdown-overlay";break}}if(this.displayMode!==t){const i=e==="dropdown";this.setWidthByTarget=i,this.isFocusedContent=!i}return this.displayMode!==t||this.overlayDisplayMode!==s?(this.displayMode=t,this.overlayDisplayMode=s,!0):!1}onHiding(){this.refreshInnerModel(),this.onHide()}dispose(){super.dispose(),this.onDispose()}};S([E()],Lt.prototype,"contentComponentName",void 0),S([E()],Lt.prototype,"contentComponentData",void 0),S([E({defaultValue:"bottom"})],Lt.prototype,"verticalPosition",void 0),S([E({defaultValue:"left"})],Lt.prototype,"horizontalPosition",void 0),S([E({defaultValue:!0})],Lt.prototype,"showPointer",void 0),S([E({defaultValue:!1})],Lt.prototype,"isModal",void 0),S([E({defaultValue:!0})],Lt.prototype,"canShrink",void 0),S([E({defaultValue:!0})],Lt.prototype,"isFocusedContent",void 0),S([E({defaultValue:!0})],Lt.prototype,"isFocusedContainer",void 0),S([E({defaultValue:""})],Lt.prototype,"cssClass",void 0),S([E({defaultValue:""})],Lt.prototype,"title",void 0),S([E({defaultValue:"auto"})],Lt.prototype,"overlayDisplayMode",void 0),S([E({defaultValue:"popup"})],Lt.prototype,"displayMode",void 0),S([E({defaultValue:"flex"})],Lt.prototype,"positionMode",void 0);function k2(n,e,t){var s;const i=e.onSelectionChanged;e.onSelectionChanged=(l,...u)=>{o.hasTitle&&(o.title=l.title),i&&i(l,u)};const r=py(e,t);r.getTargetCallback=N2;const a=Object.assign({},n,{component:"sv-action-bar-item-dropdown",popupModel:r,action:(l,u)=>{n.action&&n.action(),r.isFocusedContent=r.isFocusedContent||!u,r.show()}}),o=new Pe(a);return o.data=(s=r.contentComponentData)===null||s===void 0?void 0:s.model,o}function py(n,e){n.listRole||(n.listRole="menu"),n.listItemRole||(n.listItemRole=n.allowSelection?"menuitemradio":"menuitem");const t=new dt(n);t.onSelectionChanged=r=>{n.onSelectionChanged&&n.onSelectionChanged(r),i.hide()};const s=e||{};s.onDispose=()=>{t.dispose()};const i=new Lt("sv-list",{model:t},s);return i.isFocusedContent=t.showFilter,i.onShow=()=>{s.onShow&&s.onShow(),t.scrollToSelectedItem()},i.onHide=()=>{s.onHide&&s.onHide(),t.filterString=""},i}function N2(n){return n?.previousElementSibling}let tt=class mf extends Te{constructor(){super(...arguments),this.rendredIdValue=mf.getNextRendredId()}static getNextRendredId(){return mf.renderedId++}get data(){return this._data}set data(e){this._data=e}get id(){return this.getId()}set id(e){this.setId(e)}getId(){return this.idValue}setId(e){this.idValue=e}addVisibilityChangedCallback(e){}removeVisibilityChangedCallback(e){}get renderedId(){return this.rendredIdValue}get owner(){return this.ownerValue}set owner(e){e!==this.owner&&(this.ownerValue=e,this.locStrsChanged())}get visible(){return this.getVisible()}set visible(e){this.setVisible(e)}get enabled(){return this.getEnabled()}set enabled(e){this.setEnabled(e)}get component(){return this.getComponent()}set component(e){this.setComponent(e)}get locTitle(){return this.getLocTitle()}set locTitle(e){this.setLocTitle(e)}get title(){return this.getTitle()}set title(e){this.setTitle(e)}get titles(){return this.locTitle.getJson()}set titles(e){this.locTitle.setJson(e)}set cssClasses(e){this.cssClassesValue=e}get cssClasses(){return this.cssClassesValue||_s}get isVisible(){return this.visible&&this.mode!=="popup"&&this.mode!=="removed"}get disabled(){return this.enabled!==void 0&&!this.enabled}get canShrink(){return!this.disableShrink&&!!this.iconName}get hasTitle(){return(this.mode!="small"&&(this.showTitle||this.showTitle===void 0)||!this.iconName)&&!!this.title}get hasSubItems(){return!!this.items&&this.items.length>0}getActionBarItemTitleCss(){return new z().append(this.cssClasses.itemTitle).append(this.cssClasses.itemTitleWithIcon,!!this.iconName).toString()}getActionBarItemCss(){const e=this.hasTitle;return new z().append(this.cssClasses.item).append(this.cssClasses.itemWithTitle,e).append(this.cssClasses.itemAsIcon,!e).append(this.cssClasses.itemActive,!!this.active).append(this.cssClasses.itemPressed,!!this.pressed).append(this.innerCss).toString()}getActionRootCss(){return new z().append("sv-action").append(this.css).append("sv-action--space",this.needSpace).append("sv-action--hidden",!this.isVisible).toString()}getTooltip(){return this.tooltip||this.title}getIsTrusted(e){return e.originalEvent?e.originalEvent.isTrusted:e.isTrusted}showPopup(){this.popupModel&&this.popupModel.show()}hidePopup(){this.popupModel&&this.popupModel.hide()}clearPopupTimeouts(){this.showPopupTimeout&&clearTimeout(this.showPopupTimeout),this.hidePopupTimeout&&clearTimeout(this.hidePopupTimeout)}showPopupDelayed(e){this.clearPopupTimeouts(),this.showPopupTimeout=setTimeout(()=>{this.clearPopupTimeouts(),this.showPopup()},e)}hidePopupDelayed(e){var t;!((t=this.popupModel)===null||t===void 0)&&t.isVisible?(this.clearPopupTimeouts(),this.hidePopupTimeout=setTimeout(()=>{this.clearPopupTimeouts(),this.hidePopup(),this.isHovered=!1},e)):(this.clearPopupTimeouts(),this.isHovered=!1)}};tt.renderedId=1,S([E()],tt.prototype,"tooltip",void 0),S([E()],tt.prototype,"showTitle",void 0),S([E()],tt.prototype,"innerCss",void 0),S([E()],tt.prototype,"active",void 0),S([E()],tt.prototype,"pressed",void 0),S([E()],tt.prototype,"popupModel",void 0),S([E()],tt.prototype,"needSeparator",void 0),S([E()],tt.prototype,"template",void 0),S([E({defaultValue:"large"})],tt.prototype,"mode",void 0),S([E()],tt.prototype,"visibleIndex",void 0),S([E()],tt.prototype,"disableTabStop",void 0),S([E()],tt.prototype,"disableShrink",void 0),S([E()],tt.prototype,"disableHide",void 0),S([E({defaultValue:!1})],tt.prototype,"needSpace",void 0),S([E()],tt.prototype,"ariaChecked",void 0),S([E()],tt.prototype,"ariaExpanded",void 0),S([E({defaultValue:"button"})],tt.prototype,"ariaRole",void 0),S([E()],tt.prototype,"iconName",void 0),S([E({defaultValue:24})],tt.prototype,"iconSize",void 0),S([E()],tt.prototype,"markerIconName",void 0),S([E()],tt.prototype,"css",void 0),S([E({defaultValue:!1})],tt.prototype,"isPressed",void 0),S([E({defaultValue:!1})],tt.prototype,"isHovered",void 0);let Pe=class Fw extends tt{constructor(e){super(),this.locTitleChanged=()=>{const i=this.locTitle.renderedHtml;this.setPropertyValue("_title",i||void 0)},this.needUpdateMaxDimension=!1,this.needUpdateMinDimension=!1;const t=e instanceof Fw?e.innerItem:e;if(this.innerItem=t,this.locTitle=t?t.locTitle:null,t)for(var s in t)s==="locTitle"||s==="title"&&this.title||(this[s]=t[s]);this.locTitleName&&this.locTitleChanged(),this.locStrChangedInPopupModel()}createLocTitle(){return this.createLocalizableString("title",this,!0)}setSubItems(e){this.markerIconName="icon-next_16x16",this.items=[...e.items],this.popupModel?this.popupModel.contentComponentData.model.setItems(this.items):this.createPopupForSubitems(e),this.component=this.getGroupComponentName()}createPopupForSubitems(e){const t=Object.assign({},e);t.searchEnabled=!1;const s=py(t,{horizontalPosition:"right",showPointer:!1,canShrink:!1});s.cssClass="sv-popup-inner",this.popupModel=s}getId(){return this.getPropertyValue("id")}setId(e){this.setPropertyValue("id",e)}getLocTitle(){return this.locTitleValue}setLocTitle(e){!e&&!this.locTitleValue&&(e=this.createLocTitle()),this.locTitleValue&&this.locTitleValue.onStringChanged.remove(this.locTitleChanged),this.locTitleValue=e,this.locTitleValue.onStringChanged.add(this.locTitleChanged),this.locTitleChanged()}getTitle(){return this._title}setTitle(e){this._title=e}get locTitleName(){return this.locTitle.localizationName}set locTitleName(e){this.locTitle.localizationName=e}locStrsChanged(){super.locStrsChanged(),this.locTooltipChanged(),this.locStrChangedInPopupModel()}doAction(e){const t=e.originalEvent?e.originalEvent:e;return this.action(this,t.isTrusted),t.preventDefault(),t.stopPropagation(),!0}doMouseDown(e){this.isMouseDown=!0}doFocus(e){if(this.onFocus){const t=e.originalEvent?e.originalEvent:e;this.onFocus(this.isMouseDown,t)}this.isMouseDown=!1}locStrChangedInPopupModel(){if(!this.popupModel||!this.popupModel.contentComponentData||!this.popupModel.contentComponentData.model)return;const e=this.popupModel.contentComponentData.model;Array.isArray(e.actions)&&e.actions.forEach(s=>{s.locStrsChanged&&s.locStrsChanged()})}locTooltipChanged(){this.locTooltipName&&(this.tooltip=Ct(this.locTooltipName,this.locTitle.locale))}getLocale(){return this.owner?this.owner.getLocale():""}getMarkdownHtml(e,t,s){return this.owner?this.owner.getMarkdownHtml(e,t,s):void 0}getProcessedText(e){return this.owner?this.owner.getProcessedText(e):e}getRenderer(e){return this.owner?this.owner.getRenderer(e):null}getRendererContext(e){return this.owner?this.owner.getRendererContext(e):e}setVisible(e){this.visible!==e&&(this._visible=e)}getVisible(){return this._visible}setEnabled(e){this._enabled=e}getEnabled(){return this.enabledIf?this.enabledIf():this._enabled}setComponent(e){this._component=e}getComponent(){return this._component}getGroupComponentName(){return"sv-list-item-group"}initLoadingIndicatorVisibilityObserver(e){typeof IntersectionObserver<"u"&&(this.intersectionVisibilityObserver=new IntersectionObserver(t=>{t.forEach(s=>{const i=s.isIntersecting;e(i)})},{trackVisibility:!0,delay:100}))}dispose(){this.locTitleValue&&this.locTitleValue.onStringChanged.remove(this.locTitleChanged),this.locTitleChanged=void 0,this.action=void 0,super.dispose(),this.popupModel&&this.popupModel.dispose(),this.intersectionVisibilityObserver&&(this.intersectionVisibilityObserver.disconnect(),this.intersectionVisibilityObserver=void 0)}updateDimension(e,t,s){const i=e=="small"?"minDimension":"maxDimension";if(t){const r=t;r.classList.contains("sv-action--hidden")?(r.classList.remove("sv-action--hidden"),this[i]=s(t),r.classList.add("sv-action--hidden")):this[i]=s(t)}}afterRender(){this.afterRenderCallback&&this.afterRenderCallback()}updateMode(e,t){this.updateModeCallback?this.updateModeCallback(e,t):this.afterRenderCallback=()=>{this.updateModeCallback(e,t),this.afterRenderCallback=void 0}}updateDimensions(e,t,s){const i=!s||s=="large"&&this.mode!=="small"?this.mode:s;this.updateMode(i,(r,a)=>{this.updateDimension(r,a,e),s?t():this.updateMode(r!=="small"?"small":"large",(o,l)=>{this.updateDimension(o,l,e),t()})})}};S([E({defaultValue:!0})],Pe.prototype,"_visible",void 0),S([E({onSet:(n,e)=>{e.locTooltipChanged()}})],Pe.prototype,"locTooltipName",void 0),S([E()],Pe.prototype,"_enabled",void 0),S([E()],Pe.prototype,"action",void 0),S([E()],Pe.prototype,"onFocus",void 0),S([E()],Pe.prototype,"_component",void 0),S([E()],Pe.prototype,"items",void 0),S([E({onSet:(n,e)=>{e.locTitleValue.text!==n&&(e.locTitleValue.text=n)}})],Pe.prototype,"_title",void 0);let q2=class{constructor(e){this.item=e,this.funcKey="sv-dropdown-action",this.setupPopupCallbacks()}setupPopupCallbacks(){const e=this.popupModel=this.item.popupModel;e&&e.registerPropertyChangedHandlers(["isVisible"],()=>{e.isVisible?this.item.pressed=!0:this.item.pressed=!1},this.funcKey)}removePopupCallbacks(){this.popupModel&&this.popupModel.unregisterPropertyChangedHandlers(["isVisible"],this.funcKey)}dispose(){this.removePopupCallbacks()}};var Ti;(function(n){n[n.None=0]="None",n[n.Light=1]="Light",n[n.Hard=3]="Hard"})(Ti||(Ti={}));let Wa=class extends _t{hideItemsGreaterN(e){const t=this.getActionsToHide();e=Math.max(e,this.minVisibleItemsCount-(this.visibleActions.length-t.length));const s=[];t.forEach(i=>{e<=0&&(i.mode="popup",s.push(i.innerItem)),e--}),this.hiddenItemsListModel.setItems(s)}getActionsToHide(){return this.visibleActions.filter(e=>!e.disableHide)}updateItemMode(e,t){const s=this.visibleActions;for(let i=s.length-1;i>=0;i--)t>e&&!s[i].disableShrink?(t-=s[i].maxDimension-s[i].minDimension,s[i].mode="small"):s[i].mode="large"}constructor(){super(),this.minVisibleItemsCount=0,this.isResponsivenessDisabled=!1,this.isInitialized=!1,this.dotsItem=k2({id:"dotsItem-id"+this.id++,css:"sv-dots",innerCss:"sv-dots__item",iconName:"icon-more",visible:!1,tooltip:Ct("more")},{items:[],allowSelection:!1})}get hiddenItemsListModel(){return this.dotsItem.data}onSet(){super.onSet(),this.raiseUpdate({updateResponsivenessMode:Ti.Hard})}onPush(e){super.onPush(e),this.raiseUpdate({updateResponsivenessMode:Ti.Hard})}onRemove(e){super.onRemove(e),this.raiseUpdate({updateResponsivenessMode:Ti.Hard})}onActionPropertyChanged(e,t){super.onActionPropertyChanged(e,t),(t.name=="_visible"||t.name=="_title")&&(e.needUpdateMaxDimension=e.visible,e.needUpdateMinDimension=e.visible,this.raiseUpdate({updateResponsivenessMode:Ti.Light})),t.name=="disableHide"&&t.newValue&&e.mode=="popup"&&this.raiseUpdate({updateResponsivenessMode:Ti.Light})}getRenderedActions(){const e=super.getRenderedActions();return e.length==0||e.length===1&&e[0].iconName?e:e.concat([this.dotsItem])}getAllActions(){return this.actions.concat(this.dotsItem)}getActionMinDimension(e){return e.disableShrink?e.maxDimension:e.minDimension}getVisibleItemsCount(e){let{availableSpace:t,gap:s}=e;t-=this.dotsItem.minDimension+s;let i=0;this.visibleActions[0].disableHide?t+=s:i-=s,this.visibleActions.filter(a=>a.disableHide).forEach(a=>t-=this.getActionMinDimension(a)+s);const r=this.getActionsToHide();if(r.length===1&&r[0].iconName)return 1;for(let a=0;a<r.length;a++)if(i+=this.getActionMinDimension(r[a])+s,i>t)return a}fit(e){var t;if(e.availableSpace<=0)return;e.gap=(t=e.gap)!==null&&t!==void 0?t:0;const{availableSpace:s,gap:i}=e;this.dotsItem.visible=!1;const r=this.visibleActions;let a=-1*e.gap,o=-1*e.gap;r.forEach(l=>{a+=this.getActionMinDimension(l)+i,o+=l.maxDimension+i}),s>=o?this.setActionsMode("large"):s<a?(this.setActionsMode("small"),this.hideItemsGreaterN(this.getVisibleItemsCount(e)),this.dotsItem.visible=!!this.hiddenItemsListModel.actions.length):this.updateItemMode(e.availableSpace,o)}createResponsivityManager(e){return new L2(e,this)}mergeUpdateOptions(e,t){const s=super.mergeUpdateOptions(e,t);return s.updateResponsivenessMode=s.updateResponsivenessMode|t.updateResponsivenessMode,s}raiseUpdate(e){super.raiseUpdate(e)}update(e){var t;super.update(e),e.updateResponsivenessMode&&((t=this.responsivityManager)===null||t===void 0||t.update(e.updateResponsivenessMode==Ti.Hard))}initResponsivityManager(e){if(this.responsivityManager){if(this.responsivityManager.container==e)return;this.responsivityManager.dispose()}this.isInitialized=!1,this.responsivityManager=this.createResponsivityManager(e),this.responsivityManager.afterInitializeCallback=()=>{this.isInitialized=!0}}resetResponsivityManager(){this.responsivityManager&&(this.responsivityManager.dispose(),this.responsivityManager=void 0)}getRootStyle(){if(!this.isInitialized&&!this.isResponsivenessDisabled)return{opacity:0}}setActionsMode(e){this.actions.forEach(t=>{e=="small"&&t.disableShrink?t.mode="large":t.mode=e})}dispose(){super.dispose(),this.dotsItem.data.dispose(),this.dotsItem.dispose(),this.resetResponsivityManager()}};S([E()],Wa.prototype,"isInitialized",void 0);let gy=class{constructor(){this.cancelQueue=[]}getMsFromRule(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}reflow(e){return e.offsetHeight}getAnimationsCount(e){let t="";return getComputedStyle&&(t=getComputedStyle(e).animationName),t&&t!="none"?t.split(", ").length:0}getAnimationDuration(e){const t=getComputedStyle(e),s=t.animationDelay.split(", "),i=t.animationDuration.split(", ");let r=0;for(let a=0;a<Math.max(i.length,s.length);a++)r=Math.max(r,this.getMsFromRule(i[a%i.length])+this.getMsFromRule(s[a%s.length]));return r}addCancelCallback(e){this.cancelQueue.push(e)}removeCancelCallback(e){this.cancelQueue.indexOf(e)>=0&&this.cancelQueue.splice(this.cancelQueue.indexOf(e),1)}onAnimationEnd(e,t,s){let i,r=this.getAnimationsCount(e);const a=(l=!0)=>{t(l),clearTimeout(i),this.removeCancelCallback(a),e.removeEventListener("animationend",o)},o=l=>{l.target==l.currentTarget&&--r<=0&&a(!1)};r>0?(e.addEventListener("animationend",o),this.addCancelCallback(a),i=setTimeout(()=>{a(!1)},this.getAnimationDuration(e)+10)):t(!0)}afterAnimationRun(e,t){e&&t&&t.onAfterRunAnimation&&t.onAfterRunAnimation(e)}beforeAnimationRun(e,t){e&&t&&t.onBeforeRunAnimation&&t.onBeforeRunAnimation(e)}getCssClasses(e){return e.cssClass.replace(/\s+$/,"").split(/\s+/)}runAnimation(e,t,s){e&&t?.cssClass?(this.reflow(e),this.getCssClasses(t).forEach(i=>{e.classList.add(i)}),this.onAnimationEnd(e,s,t)):s(!0)}clearHtmlElement(e,t){e&&t.cssClass&&this.getCssClasses(t).forEach(s=>{e.classList.remove(s)}),this.afterAnimationRun(e,t)}onNextRender(e,t=!1){if(!t&&we.isAvailable()){let s;const i=()=>{e(!0),cancelAnimationFrame(s)};s=we.requestAnimationFrame(()=>{s=we.requestAnimationFrame(()=>{e(!1),this.removeCancelCallback(i)})}),this.addCancelCallback(i)}else e(!0)}cancel(){[].concat(this.cancelQueue).forEach(t=>t()),this.cancelQueue=[]}},B2=class extends gy{onEnter(e){const t=e.getAnimatedElement(),s=e.getEnterOptions?e.getEnterOptions():{};this.beforeAnimationRun(t,s),this.runAnimation(t,s,()=>{this.clearHtmlElement(t,s)})}onLeave(e,t){const s=e.getAnimatedElement(),i=e.getLeaveOptions?e.getLeaveOptions():{};this.beforeAnimationRun(s,i),this.runAnimation(s,i,r=>{t(),this.onNextRender(()=>{this.clearHtmlElement(s,i)},r)})}},my=class extends gy{runGroupAnimation(e,t,s,i,r){const a={isAddingRunning:t.length>0,isDeletingRunning:s.length>0,isReorderingRunning:i.length>0},o=t.map(x=>e.getAnimatedElement(x)),l=t.map(x=>e.getEnterOptions?e.getEnterOptions(x,a):{}),u=s.map(x=>e.getAnimatedElement(x)),d=s.map(x=>e.getLeaveOptions?e.getLeaveOptions(x,a):{}),h=i.map(x=>e.getAnimatedElement(x.item)),f=i.map(x=>e.getReorderOptions?e.getReorderOptions(x.item,x.movedForward,a):{});t.forEach((x,V)=>{this.beforeAnimationRun(o[V],l[V])}),s.forEach((x,V)=>{this.beforeAnimationRun(u[V],d[V])}),i.forEach((x,V)=>{this.beforeAnimationRun(h[V],f[V])});let C=t.length+s.length+h.length;const b=x=>{--C<=0&&(r&&r(),this.onNextRender(()=>{t.forEach((V,P)=>{this.clearHtmlElement(o[P],l[P])}),s.forEach((V,P)=>{this.clearHtmlElement(u[P],d[P])}),i.forEach((V,P)=>{this.clearHtmlElement(h[P],f[P])})},x))};t.forEach((x,V)=>{this.runAnimation(o[V],l[V],b)}),s.forEach((x,V)=>{this.runAnimation(u[V],d[V],b)}),i.forEach((x,V)=>{this.runAnimation(h[V],f[V],b)})}},Bu=class{constructor(e,t,s){this.animationOptions=e,this.update=t,this.getCurrentValue=s,this._debouncedSync=hy(i=>{this.cancelAnimations();try{this._sync(i)}catch{this.update(i)}})}onNextRender(e,t){const s=this.animationOptions.getRerenderEvent();if(s){const i=()=>{s.remove(r),this.cancelCallback=void 0},r=(a,o)=>{o.isCancel?t&&t():e(),i()};this.cancelCallback=()=>{t&&t(),i()},s.add(r)}else if(we.isAvailable()){const i=we.requestAnimationFrame(()=>{e(),this.cancelCallback=void 0});this.cancelCallback=()=>{t&&t(),cancelAnimationFrame(i),this.cancelCallback=void 0}}else throw new Error("Can't get next render")}sync(e){this.animationOptions.isAnimationEnabled()?this._debouncedSync.run(e):(this.cancel(),this.update(e))}cancel(){this._debouncedSync.cancel(),this.cancelAnimations()}cancelAnimations(){this.cancelCallback&&this.cancelCallback(),this.animation.cancel()}},fy=class extends Bu{constructor(){super(...arguments),this.animation=new B2}_sync(e){e!==this.getCurrentValue()?e?(this.onNextRender(()=>{this.animation.onEnter(this.animationOptions)}),this.update(e)):this.animation.onLeave(this.animationOptions,()=>{this.update(e)}):this.update(e)}},Wi=class extends Bu{constructor(){super(...arguments),this.animation=new my}_sync(e){var t,s;e=[].concat(e);const i=[].concat(this.getCurrentValue()),r=(t=this.animationOptions.allowSyncRemovalAddition)!==null&&t!==void 0?t:!0;let a=sP(i,e,(s=this.animationOptions.getKey)!==null&&s!==void 0?s:(f=>f));!r&&(a.reorderedItems.length>0||a.addedItems.length>0)&&(a.deletedItems=[],a.mergedItems=e),this.animationOptions.onCompareArrays&&this.animationOptions.onCompareArrays(a);let{addedItems:o,reorderedItems:l,deletedItems:u,mergedItems:d}=a;const h=()=>{this.animation.runGroupAnimation(this.animationOptions,o,u,l,()=>{u.length>0&&this.update(e)})};[o,u,l].some(f=>f.length>0)?u.length<=0||l.length>0||o.length>0?(this.onNextRender(h,()=>{this.update(e)}),this.update(d)):h():this.update(e)}},yy=class extends Bu{constructor(e,t,s,i){super(e,t,s),this.mergeValues=i,this.animation=new my}_sync(e){const t=[].concat(this.getCurrentValue());if(t[0]!==e[0]){const s=this.mergeValues?this.mergeValues(e,t):[].concat(t,e);this.onNextRender(()=>{this.animation.runGroupAnimation(this.animationOptions,e,t,[],()=>{this.update(e)})},()=>this.update(e)),this.update(s,!0)}else this.update(e)}},$a=class extends Te{constructor(){super(),this.createLocTitleProperty()}createLocTitleProperty(){return this.createLocalizableString("title",this,!0)}get isPage(){return!1}get isPanel(){return!1}get isQuestion(){return!1}get isSurvey(){return!1}get title(){return this.getLocalizableStringText("title",this.getDefaultTitleValue())}set title(e){this.setTitleValue(e)}get locTitle(){return this.getLocalizableString("title")}get locRenderedTitle(){return this.locTitle}getDefaultTitleValue(){}setTitleValue(e){this.setLocalizableStringText("title",e)}get hasDescription(){return this.getPropertyValue("hasDescription",void 0,()=>this.calcDescriptionVisibility())}set hasDescription(e){this.setPropertyValue("hasDescription",e)}calcDescriptionVisibility(){const e=this.description;let t=!1;if(this.isDesignMode){const s=q.findProperty(this.getType(),"description");t=!!s?.placeholder}return!!e||t&&this.isDesignMode}resetDescriptionVisibility(){this.resetPropertyValue("hasDescription")}get locDescription(){return this.getLocalizableString("description")}get titleTagName(){let e=this.getDefaultTitleTagName();const t=this.getSurvey();return t?t.getElementTitleTagName(this,e):e}getDefaultTitleTagName(){return A.titleTags[this.getType()]}get hasTitle(){return this.title.length>0}get hasTitleActions(){return!1}get hasTitleEvents(){return this.hasTitleActions}getTitleToolbar(){return null}getTitleOwner(){}get isTitleOwner(){return!!this.getTitleOwner()}get isTitleRenderedAsString(){return this.getIsTitleRenderedAsString()}toggleState(){}get cssClasses(){return{}}get cssTitle(){return""}get ariaTitleId(){}get ariaDescriptionId(){}get titleTabIndex(){}get titleAriaExpanded(){}get titleAriaRole(){}get ariaLabel(){return this.locTitle.renderedHtml}get titleAriaLabel(){return this.ariaLabel}getIsTitleRenderedAsString(){return!this.isTitleOwner}};S([E({localizable:!0,onSet:(n,e)=>{e.resetDescriptionVisibility()}})],$a.prototype,"description",void 0);let yt=class Hi extends $a{static getProgressInfoByElements(e,t){const s=Te.createProgressInfo();for(let i=0;i<e.length;i++){if(!e[i].isVisible)continue;const r=e[i].getProgressInfo();s.questionCount+=r.questionCount,s.answeredQuestionCount+=r.answeredQuestionCount,s.requiredQuestionCount+=r.requiredQuestionCount,s.requiredAnsweredQuestionCount+=r.requiredAnsweredQuestionCount}return t&&s.questionCount>0&&(s.requiredQuestionCount==0&&(s.requiredQuestionCount=1),s.answeredQuestionCount>0&&(s.requiredAnsweredQuestionCount=1)),s}static IsNeedScrollIntoView(e,t,s){const i=s?-1:e.getBoundingClientRect().top;let r=i<0,a=-1;if(!r&&t&&(a=e.getBoundingClientRect().left,r=a<0),!r&&we.isAvailable()){const o=we.getInnerHeight();if(r=o>0&&o<i,!r&&t){const l=we.getInnerWidth();r=l>0&&l<a}}return r}static ScrollIntoView(e,t,s){if(e.scrollIntoView(t),typeof s=="function"){let i=null,r=0;const a=()=>{const o=e.getBoundingClientRect().top;if(o===i){if(r++>2){s();return}}else i=o,r=0;requestAnimationFrame(a)};we.requestAnimationFrame(a)}}static ScrollElementToTop(e,t,s,i){return Hi.ScrollElementToViewCore(e,!1,t,s,i)}static ScrollElementToViewCore(e,t,s,i,r){if(!e||!e.scrollIntoView)return r&&r(),!1;const a=Hi.IsNeedScrollIntoView(e,t,s);return a?Hi.ScrollIntoView(e,i,r):r&&r(),a}static GetFirstNonTextElement(e,t=!1){if(!e||!e.length||e.length==0)return null;if(t){let s=e[0];s.nodeName==="#text"&&(s.data=""),s=e[e.length-1],s.nodeName==="#text"&&(s.data="")}for(let s=0;s<e.length;s++)if(e[s].nodeName!="#text"&&e[s].nodeName!="#comment")return e[s];return null}static FocusElement(e,t,s){if(!e||!ge.isAvailable())return!1;const i=t?!1:Hi.focusElementCore(e,s);return i||setTimeout(()=>{Hi.focusElementCore(e,s)},t?100:10),i}static focusElementCore(e,t){const{root:s}=A.environment;if(!s&&!t)return!1;const i=t?t.querySelector(`#${CSS.escape(e)}`):s.getElementById(e);return i&&!i.disabled&&i.style.display!=="none"&&i.offsetParent!==null?(Hi.ScrollElementToViewCore(i,!0,!1),i.focus(),!0):!1}get effectiveColSpan(){const e=this.getPropertyValueWithoutDefault("effectiveColSpan");return e!==void 0?e:(this.setRootStyle(),this.getPropertyValue("effectiveColSpan"))}get colSpan(){return this.getPropertyValue("colSpan",1)}set colSpan(e){this.setPropertyValue("colSpan",e)}constructor(e){super(),this.selectedElementInDesignValue=this,this.disableDesignActions=Hi.CreateDisabledDesignElements,this.parentQuestionValue=null,this.isContentElement=!1,this.isEditableTemplateElement=!1,this.isInteractiveDesignElement=!0,this.isSingleInRow=!0,this._renderedIsExpanded=!0,this._isAnimatingCollapseExpand=!1,this.animationCollapsed=new fy(this.getExpandCollapseAnimationOptions(),t=>{this._renderedIsExpanded=t,this.animationAllowed&&(t?this.isAnimatingCollapseExpand=!0:this.updateElementCss(!1))},()=>this.renderedIsExpanded),this.onAfterRenderElement=this.addEvent(),this.setPropertyValueDirectly("name",this.getValidName(e)),this.createNewArray("errors"),this.createNewArray("renderedErrors"),this.createNewArray("titleActions"),this.registerPropertyChangedHandlers(["isReadOnly"],()=>{this.onReadOnlyChanged()}),this.registerPropertyChangedHandlers(["errors"],()=>{this.updateVisibleErrors()}),this.registerPropertyChangedHandlers(["isSingleInRow"],()=>{this.updateElementCss(!1)}),this.registerPropertyChangedHandlers(["minWidth","maxWidth","renderWidth","allowRootStyle","parent"],()=>{this.updateRootStyle()}),this.registerPropertyChangedHandlers(["effectiveColSpan"],t=>{this.colSpan=t})}onPropertyValueChanged(e,t,s){super.onPropertyValueChanged(e,t,s),e==="state"&&(this.updateElementCss(!1),this.notifyStateChanged(t),this.stateChangedCallback&&this.stateChangedCallback())}getSkeletonComponentNameCore(){return this.survey?this.survey.getSkeletonComponentName(this):"sv-skeleton"}canUpdateValueOnVisibleChanged(){return!this.isLoadingFromJson&&!!this.survey&&!this.survey.isSettingData()}get parentQuestion(){return this.parentQuestionValue}setParentQuestion(e){this.parentQuestionValue=e,this.onParentQuestionChanged()}onParentQuestionChanged(){}getPanelInDesignMode(){return null}updateElementVisibility(){this.setPropertyValue("isVisible",this.isVisible)}get skeletonComponentName(){return this.getSkeletonComponentNameCore()}get state(){return this.getPropertyValue("state")}set state(e){this.setPropertyValue("state",e),this.renderedIsExpanded=!this.isCollapsed}notifyStateChanged(e){this.survey&&this.survey.elementContentVisibilityChanged(this)}get isCollapsed(){return this.state==="collapsed"&&!this.isDesignMode}get isExpanded(){return this.state==="expanded"}collapse(){this.isDesignMode||(this.state="collapsed")}expand(){this.state="expanded"}toggleState(){return this.isCollapsed?(this.expand(),!0):this.isExpanded?(this.collapse(),!1):!0}get hasStateButton(){return this.isExpanded||this.isCollapsed}get shortcutText(){return this.title||this.name}getTitleToolbar(){return this.titleToolbarValue||(this.titleToolbarValue=this.createActionContainer(!0),this.titleToolbarValue.locOwner=this,this.titleToolbarValue.containerCss=(this.isPanel?this.cssClasses.panel.titleBar:this.cssClasses.titleBar)||"sv-action-title-bar",this.titleToolbarValue.setItems(this.getTitleActions()),this.titleToolbarValue.flushUpdates()),this.titleToolbarValue}createActionContainer(e){const t=e?new Wa:new _t;return this.survey&&this.survey.getCss().actionBar&&(t.cssClasses=this.survey.getCss().actionBar),t}get titleActions(){return this.getPropertyValue("titleActions")}getTitleActions(){return this.isTitleActionRequested||(this.updateTitleActions(),this.isTitleActionRequested=!0),this.titleActions}getDefaultTitleActions(){return[]}updateTitleActions(){let e=this.getDefaultTitleActions();this.survey&&(e=this.survey.getUpdatedElementTitleActions(this,e)),this.setPropertyValue("titleActions",e)}locStrsChanged(){super.locStrsChanged(),this.titleToolbarValue&&this.titleToolbarValue.locStrsChanged()}get hasTitleActions(){return this.getTitleActions().length>0}get hasTitleEvents(){return this.state!==void 0&&this.state!=="default"}get titleTabIndex(){return!this.isPage&&this.state!=="default"?0:void 0}get titleAriaExpanded(){if(!(this.isPage||this.state==="default"))return this.state==="expanded"?"true":"false"}get titleAriaRole(){if(!(this.isPage||this.state==="default"))return"button"}setSurveyImpl(e,t){this.surveyImplValue=e,this.surveyImplValue?(this.surveyDataValue=this.surveyImplValue.getSurveyData(),this.setSurveyCore(this.surveyImplValue.getSurvey()),this.textProcessorValue=this.createTextProcessor(),this.onSetData()):(this.setSurveyCore(null),this.surveyDataValue=null,this.textProcessorValue=null),this.survey&&(this.resetDescriptionVisibility(),this.clearCssClasses()),this.blockAnimations(),this.renderedIsExpanded=!this.isCollapsed,this.releaseAnimations()}getValueGetterContext(){const e=this.data;return e?e.getValueGetterContext():super.getValueGetterContext()}createTextProcessor(){return this.surveyImplValue.getTextProcessor()}canRunConditions(){return super.canRunConditions()&&!!this.data}getDataFilteredProperties(){var e=this.data?this.data.getFilteredProperties():{};return e.question=this,e}get surveyImpl(){return this.surveyImplValue}__setData(e){this.surveyDataValue=e}get data(){return this.surveyDataValue}get survey(){return this.getSurvey()}getSurvey(e=!1){return this.surveyValue?this.surveyValue:(this.surveyImplValue&&this.setSurveyCore(this.surveyImplValue.getSurvey()),this.surveyValue)}setSurveyCore(e){this.surveyValue=e,this.surveyChangedCallback&&this.surveyChangedCallback()}get skeletonHeight(){let e;return this.survey&&this.survey.skeletonHeight&&(e=this.survey.skeletonHeight+"px"),e}get isInternal(){return this.isContentElement}get areInvisibleElementsShowing(){const e=this.parentQuestion;return e&&e.areInvisibleElementsShowing===!1?!1:!!this.survey&&this.survey.areInvisibleElementsShowing&&!this.isContentElement}get isVisible(){return!0}get isReadOnly(){return this.readOnly}get readOnly(){return this.getPropertyValue("readOnly")}set readOnly(e){this.readOnly!=e&&(this.setPropertyValue("readOnly",e),this.isLoadingFromJson||this.setPropertyValue("isReadOnly",this.isReadOnly))}onReadOnlyChanged(){this.readOnlyChangedCallback&&this.readOnlyChangedCallback()}get css(){return this.survey?this.survey.getCss():{}}get cssClassesValue(){let e=this.getPropertyValueWithoutDefault("cssClassesValue");return!e&&!this.isCssValueCalculating&&(this.isCssValueCalculating=!0,e=this.createCssClassesValue(),this.isCssValueCalculating=!1),e}createCssClassesValue(){const e=this.calcCssClasses(this.css);return this.setPropertyValue("cssClassesValue",e),this.onCalcCssClasses(e),this.updateElementCssCore(this.cssClassesValue),e}onCalcCssClasses(e){}get cssClasses(){return this.cssClassesValue,this.survey?(this.cssClassesValue||this.createCssClassesValue(),this.cssClassesValue):this.calcCssClasses(this.css)}get cssTitleNumber(){const e=this.cssClasses;return e.number?e.number:e.panel?e.panel.number:void 0}get cssRequiredMark(){const e=this.cssClasses;return e.requiredMark||e.panel&&e.panel.requiredMark}getCssTitleExpandableSvg(){return this.state==="default"?null:this.cssClasses.titleExpandableSvg}calcCssClasses(e){}updateElementCssCore(e){}get cssError(){return""}updateElementCss(e){this.clearCssClasses()}clearCssClasses(){this.resetPropertyValue("cssClassesValue")}getIsLoadingFromJson(){return super.getIsLoadingFromJson()?!0:this.surveyValue?this.surveyValue.isLoadingFromJson:!1}get name(){return this.getPropertyValue("name","")}set name(e){var t=this.name;this.setPropertyValue("name",this.getValidName(e)),!this.isLoadingFromJson&&t&&this.onNameChanged(t)}getValidName(e){if(e){e=e.trim();const t=A.itemValueSeparator;t&&e.indexOf(t)>-1&&(e=e.replace(t,""))}return e}onNameChanged(e){}updateBindingValue(e,t){this.data&&!this.isTwoValueEquals(t,this.data.getValue(e))&&this.data.setValue(e,t,!1)}get errors(){return this.getPropertyValue("errors")}set errors(e){this.setPropertyValue("errors",e)}get renderedErrors(){return this.getPropertyValue("renderedErrors")}set renderedErrors(e){this.setPropertyValue("renderedErrors",e)}calcRenderedErrors(){const e=this.currentNotificationType;return this.errors.filter((t=>t.visible&&t.notificationType===e))}get currentNotificationType(){return this.getPropertyValue("currentNotificationType",void 0,()=>this.calcCurrentNotificationType())}calcCurrentNotificationType(){let e="";const t=["info","warning","error"];for(let s=0;s<this.errors.length;s++){const i=this.errors[s];if(!i.visible)continue;const r=i.notificationType;if(!e){e=r;continue}const a=t.indexOf(r),o=t.indexOf(e);a>o&&(e=r)}return e}updateVisibleErrors(){this.resetPropertyValue("currentNotificationType");for(var e=0,t=0;t<this.errors.length;t++)this.errors[t].visible&&e++;this.hasVisibleErrors=e>0,this.renderedErrors=this.calcRenderedErrors()}get containsErrors(){return this.getPropertyValue("containsErrors",!1)}updateContainsErrors(){this.setPropertyValue("containsErrors",this.getContainsErrors())}getContainsErrors(){return this.errors.length>0}get selectedElementInDesign(){return this.selectedElementInDesignValue}set selectedElementInDesign(e){this.selectedElementInDesignValue=e}updateCustomWidgets(){}onSurveyLoad(){}get wasRendered(){return!!this.wasRenderedValue}resetWasRendered(){this.wasRenderedValue=!1}onFirstRendering(){!this.wasRendered&&!this.isLoadingFromJson&&(this.wasRenderedValue=!0,this.onFirstRenderingCore())}onFirstRenderingCore(){}endLoadingFromJson(){super.endLoadingFromJson(),this.survey||this.onSurveyLoad()}setVisibleIndex(e){return 0}getPageVisibleIndex(){return-1}getStartIndex(){return this.parent?this.parent.getQuestionStartIndex():this.survey?this.survey.getQuestionStartIndex(this.getPageVisibleIndex()):""}delete(e){}getLocale(){return this.survey?this.survey.getLocale():this.locOwner?this.locOwner.getLocale():""}getMarkdownHtml(e,t,s){return this.survey?this.survey.getSurveyMarkdownHtml(this,e,t,s):this.locOwner?this.locOwner.getMarkdownHtml(e,t,s):void 0}getRenderer(e,t){return this.survey&&typeof this.survey.getRendererForString=="function"?this.survey.getRendererForString(this,e,t):this.locOwner&&typeof this.locOwner.getRenderer=="function"?this.locOwner.getRenderer(e):null}getRendererContext(e,t){return this.survey&&typeof this.survey.getRendererContextForString=="function"?this.survey.getRendererContextForString(this,e,t):this.locOwner&&typeof this.locOwner.getRendererContext=="function"?this.locOwner.getRendererContext(e):e}getProcessedText(e){return this.isLoadingFromJson?e:this.textProcessor?this.textProcessor.processText(e,this.getUseDisplayValuesInDynamicTexts()):this.locOwner?this.locOwner.getProcessedText(e):e}getUseDisplayValuesInDynamicTexts(){return!0}removeSelfFromList(e){if(!e||!Array.isArray(e))return;const t=e.indexOf(this);t>-1&&e.splice(t,1)}get textProcessor(){return this.textProcessorValue}getProcessedHtml(e){return!e||!this.textProcessor?e:this.textProcessor.processText(e,!0)}onSetData(){}get parent(){return this.getPropertyValue("parent",null)}set parent(e){this.setPropertyValue("parent",e)}getPage(e){for(;e&&e.parent;)e=e.parent;return e&&e.isPage?e:null}moveToBase(e,t,s=null){if(!t)return!1;e.removeElement(this);let i=-1;return O.isNumber(s)&&(i=parseInt(s)),i==-1&&s&&s.getType&&(i=t.indexOf(s)),t.addElement(this,i),!0}setPage(e,t){const s=this.getPage(e);this.prevSurvey=this.survey,typeof t=="string"&&this.getSurvey().pages.forEach(r=>{t===r.name&&(t=r)}),s!==t&&(e&&e.removeElement(this),t&&t.addElement(this,-1),this.prevSurvey=void 0)}getSearchableLocKeys(e){e.push("title"),e.push("description")}get hasParent(){return this.parent&&!this.parent.isPage||this.parent===void 0}shouldAddRunnerStyles(){return!this.isDesignMode}get isCompact(){return this.survey&&this.survey.isCompact}canHaveFrameStyles(){var e;return((e=this.survey)===null||e===void 0?void 0:e.currentSingleElement)===this?!0:this.isInternalNested===!0?!1:this.parent!==void 0&&(!this.hasParent||this.parent&&this.parent.showPanelAsPage)}getHasFrameV2(){return this.shouldAddRunnerStyles()&&this.canHaveFrameStyles()}getIsNested(){return this.shouldAddRunnerStyles()&&!this.canHaveFrameStyles()}getCssRoot(e){const t=!!this.isCollapsed||!!this.isExpanded;return new z().append(e.withFrame,this.getHasFrameV2()&&!this.isCompact).append(e.compact,this.isCompact&&this.getHasFrameV2()).append(e.collapsed,!!this.isCollapsed).append(e.expandableAnimating,t&&this.isAnimatingCollapseExpand).append(e.expanded,!!this.isExpanded&&this.renderedIsExpanded).append(e.expandable,t).append(e.nested,this.getIsNested()).toString()}get width(){return this.getPropertyValue("width","")}set width(e){this.setPropertyValue("width",e)}get minWidth(){return this.getPropertyValue("minWidth")}set minWidth(e){this.setPropertyValue("minWidth",e)}get maxWidth(){return this.getPropertyValue("maxWidth")}set maxWidth(e){this.setPropertyValue("maxWidth",e)}get renderWidth(){return this.getPropertyValue("renderWidth","")}set renderWidth(e){this.setPropertyValue("renderWidth",e)}get indent(){return this.getPropertyValue("indent")}set indent(e){this.setPropertyValue("indent",e)}get rightIndent(){return this.getPropertyValue("rightIndent",0)}set rightIndent(e){this.setPropertyValue("rightIndent",e)}getRootStyle(){const e={};return this.paddingLeft&&(e["--sv-element-add-padding-left"]=this.paddingLeft),this.paddingRight&&(e["--sv-element-add-padding-right"]=this.paddingRight),e}get paddingLeft(){return this.getPropertyValue("paddingLeft",void 0,()=>this.calcPaddingLeft())}calcPaddingLeft(){return""}get paddingRight(){return this.getPropertyValue("paddingRight",void 0,()=>this.calcPaddingRight())}set paddingRight(e){this.setPropertyValue("paddingRight",e)}calcPaddingRight(){return""}resetIndents(){this.resetPropertyValue("paddingLeft"),this.resetPropertyValue("paddingRight")}get rootStyle(){return this.getPropertyValue("rootStyle",void 0,()=>this.calcRootStyle())}set rootStyle(e){this.setPropertyValue("rootStyle",e)}updateRootStyle(){this.getPropertyValueWithoutDefault("rootStyle")?this.setRootStyle():this.resetPropertyValue("effectiveColSpan")}setRootStyle(){this.rootStyle=this.calcRootStyle()}calcRootStyle(){const e={};let t;if(this.parent&&(t=this.parent.getColumsForElement(this).reduce((i,r)=>r.effectiveWidth+i,0),t&&t!==100&&(e.flexGrow=1,e.flexShrink=0,e.flexBasis=t+"%",e.minWidth=void 0,e.maxWidth=this.maxWidth)),Object.keys(e).length==0){let s=""+this.minWidth;if(s&&s!="auto"){if(s.indexOf("px")!=-1&&this.survey){s=s.replace("px","");let i=parseFloat(s);isNaN(i)||(s=i*this.survey.widthScale/100,s=""+s+"px")}s="min(100%, "+s+")"}this.allowRootStyle&&this.renderWidth&&(e.flexGrow=1,e.flexShrink=1,e.flexBasis=this.renderWidth,e.minWidth=s,e.maxWidth=this.maxWidth)}return e}isContainsSelection(e){let t;const s=ge.getDocument();if(ge.isAvailable()&&s&&s.selection)t=s.selection.createRange().parentElement();else{var i=we.getSelection();if(i&&i.rangeCount>0){const r=i.getRangeAt(0);r.startOffset!==r.endOffset&&(t=r.startContainer.parentNode)}}return t==e}get clickTitleFunction(){if(this.needClickTitleFunction())return e=>{if(!(e&&this.isContainsSelection(e.target)))return this.processTitleClick()}}needClickTitleFunction(){return this.state!=="default"}processTitleClick(){this.state!=="default"&&this.toggleState()}get hasAdditionalTitleToolbar(){return!1}get additionalTitleToolbar(){return this.getAdditionalTitleToolbar()}getAdditionalTitleToolbar(){return null}getCssTitle(e){if(!e)return"";const t=this.state!=="default";return new z().append(e.title).append(e.titleNumInline,(this.no||"").length>4||t).append(e.titleExpandable,t).append(e.titleExpanded,this.isExpanded).append(e.titleCollapsed,this.isCollapsed).append(e.titleDisabled,this.isDisabledStyle).append(e.titleReadOnly,this.isReadOnly).append(e.titleOnError,this.containsErrors).toString()}get isDisabledStyle(){return this.getIsDisableAndReadOnlyStyles(!1)[1]}get isReadOnlyStyle(){return this.getIsDisableAndReadOnlyStyles(!1)[0]}getIsDisableAndReadOnlyStyles(e){const t=this.isPreviewStyle;return[(e||this.isReadOnly)&&!t,!1]}get isPreviewStyle(){return!!this.survey&&this.survey.state==="preview"}localeChanged(){super.localeChanged(),this.resetDescriptionVisibility(),this.errors.length>0&&this.errors.forEach(e=>{e.updateText()})}setWrapperElement(e){this.wrapperElement=e}getWrapperElement(){return this.wrapperElement}set isAnimatingCollapseExpand(e){e!==this._isAnimatingCollapseExpand&&(this._isAnimatingCollapseExpand=e,this.updateElementCss(!1))}get isAnimatingCollapseExpand(){return this._isAnimatingCollapseExpand||this._renderedIsExpanded!=this.isExpanded}onElementExpanded(e){}getExpandCollapseAnimationOptions(){const e=s=>{this.isAnimatingCollapseExpand=!0,ni(s)},t=s=>{this.isAnimatingCollapseExpand=!1,ys(s)};return{getRerenderEvent:()=>this.onElementRerendered,getEnterOptions:()=>({cssClass:(this.isPanel?this.cssClasses.panel:this.cssClasses).contentEnter,onBeforeRunAnimation:e,onAfterRunAnimation:i=>{t(i),this.onElementExpanded(!0)}}),getLeaveOptions:()=>({cssClass:(this.isPanel?this.cssClasses.panel:this.cssClasses).contentLeave,onBeforeRunAnimation:e,onAfterRunAnimation:t}),getAnimatedElement:()=>{var s;const i=this.isPanel?this.cssClasses.panel:this.cssClasses;if(i.content){const r=rs(i.content);if(r)return(s=this.getWrapperElement())===null||s===void 0?void 0:s.querySelector(`:scope ${r}`)}},isAnimationEnabled:()=>this.isExpandCollapseAnimationEnabled}}get isExpandCollapseAnimationEnabled(){return this.animationAllowed&&!this.isDesignMode}set renderedIsExpanded(e){const t=this._renderedIsExpanded;this.animationCollapsed.sync(e),!this.isExpandCollapseAnimationEnabled&&!t&&this.renderedIsExpanded&&this.onElementExpanded(!1)}get renderedIsExpanded(){return!!this._renderedIsExpanded}getIsAnimationAllowed(){return super.getIsAnimationAllowed()&&!!this.survey&&!this.survey.isEndLoadingFromJson}afterRenderCore(e){this.onAfterRenderElement.fire(this,{htmlElement:e})}dispose(){super.dispose(),this.titleToolbarValue&&this.titleToolbarValue.dispose()}};yt.CreateDisabledDesignElements=!1,S([E({defaultValue:!1})],yt.prototype,"hasVisibleErrors",void 0),S([E({defaultValue:!0})],yt.prototype,"isSingleInRow",void 0),S([E({defaultValue:!0})],yt.prototype,"allowRootStyle",void 0),S([E()],yt.prototype,"_renderedIsExpanded",void 0);let F2=class{constructor(e,t,s=100){this._elements=e,this._renderedHandler=t,this._elementsToRenderCount=0,this._elementsToRenderTimer=void 0,this._elementRenderedHandler=(i,r)=>{var a;(a=i.onAfterRenderElement)===null||a===void 0||a.remove(this._elementRenderedHandler),this._elementsToRenderCount--,this._elementsToRenderCount<=0&&this.visibleElementsRendered()},this._elements.forEach(i=>{i.onAfterRenderElement&&(i.onAfterRenderElement.add(this._elementRenderedHandler),this._elementsToRenderCount++)}),this._elementsToRenderCount>0?this._elementsToRenderTimer=setTimeout(()=>{this._elementsToRenderCount>0&&this.visibleElementsRendered()},s):this.visibleElementsRendered()}stopWaitingForElementsRendering(){this._elementsToRenderTimer&&(clearTimeout(this._elementsToRenderTimer),this._elementsToRenderTimer=void 0),this._elements.forEach(e=>{var t;(t=e.onAfterRenderElement)===null||t===void 0||t.remove(this._elementRenderedHandler)}),this._elementsToRenderCount=0}visibleElementsRendered(){const e=this._renderedHandler;this.dispose(),typeof e=="function"&&e()}dispose(){this.stopWaitingForElementsRendering(),this._elements=void 0,this._renderedHandler=void 0}},At=class ff{static get defaultLocale(){return A.localization.defaultLocaleName}static set defaultLocale(e){A.localization.defaultLocaleName=e}get localizationName(){return this._localizationName}set localizationName(e){this._localizationName!=e&&(this._localizationName=e,this.strChanged())}get allowLineBreaks(){var e;return this._allowLineBreaks===void 0&&(this._allowLineBreaks=!1,this.name&&this.owner instanceof $a&&(this._allowLineBreaks=((e=q.findProperty(this.owner.getType(),this.name))===null||e===void 0?void 0:e.type)=="text")),this._allowLineBreaks}constructor(e,t=!1,s,i){this.owner=e,this.useMarkdown=t,this.name=s,this.values={},this.htmlValues={},this.onStringChanged=new Zt,this._localizationName=i,this.onCreating()}getIsMultiple(){return!1}get locale(){if(this.owner&&this.owner.getLocale){const e=this.owner.getLocale();if(e||!this.sharedData)return e}return this.sharedData?this.sharedData.locale:""}get isDefautlLocale(){const e=this.locale;return!e||e===A.defaultLocaleName}strChanged(){this.isTextRequested&&(this.searchableText=void 0,!(this.renderedText===void 0&&this.isEmpty&&!this.onGetTextCallback&&!this.localizationName)&&(this.calculatedTextValue=this.calcText(),this.renderedText!==this.calculatedTextValue&&(this.renderedText=void 0,this.calculatedTextValue=void 0),this.htmlValues={},this.onChanged(),this.onStringChanged.fire(this,{})))}get text(){return this.pureText}set text(e){this.setLocaleText(this.locale,e)}get calculatedText(){return this.renderedText=this.calculatedTextValue!==void 0?this.calculatedTextValue:this.calcText(),this.calculatedTextValue=void 0,this.renderedText}getPlaceholder(){let e="";if(!this.isDefautlLocale){const t=this.getRootDialect(this.locale);e=this.getLocaleText(t||A.defaultLocaleName)}return!e&&this.onGetTextCallback&&(e=this.onGetTextCallback("","")),e}calcText(){const e=this.pureText;let t=e;return t&&this.owner&&this.owner.getProcessedText&&t.indexOf("{")>-1&&(t=this.owner.getProcessedText(t)),this.onGetTextCallback&&(t=this.onGetTextCallback(t,e)),t}get pureText(){this.isTextRequested=!0;var e=this.locale;e||(e=this.defaultLoc);var t=this.getValue(e);if(this.isValueEmpty(t)&&e===this.defaultLoc&&(t=this.getValue(is.defaultLocale)),this.isValueEmpty(t)){const s=this.getRootDialect(e);s&&(t=this.getValue(s))}return this.isValueEmpty(t)&&e!==this.defaultLoc&&(t=this.getValue(this.defaultLoc)),this.isValueEmpty(t)&&this.getLocalizationName()&&(t=this.getLocalizationStr()),t||(t=this.defaultValue||""),t}getRootDialect(e){if(!e)return e;const t=e.indexOf("-");return t>-1?e.substring(0,t):""}getLocalizationName(){return this.sharedData?this.sharedData.localizationName:this.localizationName}getLocalizationStr(){const e=this.getLocalizationName();return e?Ct(e,this.locale):""}get hasHtml(){return this.hasHtmlValue()}get html(){return this.hasHtml?this.getHtmlValue():""}get isEmpty(){return this.getValuesKeys().length==0}get textOrHtml(){return this.hasHtml?this.getHtmlValue():this.calculatedText}get renderedHtml(){return this.textOrHtml}getLocaleText(e){const t=this.getLocaleTextCore(e);return t||""}getLocaleTextCore(e){return e||(e=this.defaultLoc),this.getValue(e)}isLocaleTextEqualsWithDefault(e,t){let s=this.getLocaleTextCore(e);return s===t?!0:this.isValueEmpty(s)&&this.isValueEmpty(t)}clear(){this.setJson(void 0)}clearLocale(e){this.setLocaleText(e,void 0)}setLocaleText(e,t){if(e=this.getValueLoc(e),this.lastChangedLoc=e,e&&t===void 0){const r=this.getValue(e);r!==void 0&&(this.deleteValue(e),this.fireStrChanged(e,r));return}if(!this.storeDefaultText&&this.isLocaleTextEqualsWithDefault(e,t)){if(!this.isValueEmpty(t)||e&&e!==this.defaultLoc)return;let r=is.defaultLocale,a=this.getValue(r);r&&!this.isValueEmpty(a)&&(this.setValue(r,t),this.fireStrChanged(r,a));return}if(!(!A.localization.storeDuplicatedTranslations&&!this.isValueEmpty(t)&&e&&e!=this.defaultLoc&&!this.getValue(e)&&t==this.getLocaleText(this.defaultLoc))){var s=this.curLocale;e||(e=this.defaultLoc);var i=this.onStrChanged&&e===s?this.pureText:void 0;delete this.htmlValues[e],this.isValueEmpty(t)?this.deleteValue(e):typeof t=="string"&&(this.canRemoveLocValue(e,t)?this.setLocaleText(e,null):(this.setValue(e,t),e==this.defaultLoc&&this.deleteValuesEqualsToDefault(t))),this.fireStrChanged(e,i)}}isValueEmpty(e){return e==null?!0:this.localizationName?!1:e===""}get curLocale(){return this.locale?this.locale:this.defaultLoc}canRemoveLocValue(e,t){if(A.localization.storeDuplicatedTranslations||e===this.defaultLoc)return!1;const s=this.getRootDialect(e);if(s){const i=this.getLocaleText(s);return i?i==t:this.canRemoveLocValue(s,t)}else return t==this.getLocaleText(this.defaultLoc)}fireStrChanged(e,t){if(this.strChanged(),!this.onStrChanged)return;const s=this.pureText;(e!==this.curLocale||t!==s)&&this.onStrChanged(t,s)}hasNonDefaultText(){var e=this.getValuesKeys();return e.length==0?!1:e.length>1||e[0]!=this.defaultLoc}getLocales(){var e=this.getValuesKeys();return e.length==0?[]:e}getJson(){if(this.sharedData)return this.sharedData.getJson();const e=this.getValuesKeys();if(e.length==0){if(this.serializeCallBackText){const s=this.calcText();if(s)return s}return null}if(e.length==1&&e[0]==A.localization.defaultLocaleName&&!A.serialization.localizableStringSerializeAsObject)return this.values[e[0]];const t={};for(let s in this.values)t[s]=this.values[s];return t}setJson(e,t){if(this.sharedData){this.sharedData.setJson(e,t);return}if(this.lastChangedLoc=void 0,this.values={},this.htmlValues={},e!=null)if(t)typeof e=="string"?this.values[A.defaultLocaleName]=e:(this.values=e,delete this.values.pos);else{if(typeof e=="string")this.setLocaleText(null,e);else for(var s in e)this.setLocaleText(s,e[s]);this.strChanged()}}get renderAs(){return!this.owner||typeof this.owner.getRenderer!="function"?ff.defaultRenderer:this.owner.getRenderer(this.name)||ff.defaultRenderer}get renderAsData(){return!this.owner||typeof this.owner.getRendererContext!="function"?this:this.owner.getRendererContext(this)||this}equals(e){return this.sharedData?this.sharedData.equals(e):!e||!e.values?!1:O.isTwoValueEquals(this.values,e.values,!1,!0,!1)}setFindText(e){if(this.searchText!=e){if(this.searchText=e,!this.searchableText){let i=this.textOrHtml;this.searchableText=i?i.toLowerCase():""}var t=this.searchableText,s=t&&e?t.indexOf(e):void 0;return s<0&&(s=void 0),(s!=null||this.searchIndex!=s)&&(this.searchIndex=s,this.onSearchChanged&&this.onSearchChanged()),this.searchIndex!=null}}onChanged(){}onCreating(){}hasHtmlValue(){if(!this.owner||!this.useMarkdown)return!1;let e=this.locale;if(e||(e=this.defaultLoc),this.htmlValues[e]!==void 0)return!!this.htmlValues[e];let t=this.calculatedText;if(!t)return this.setHtmlValue(e,""),!1;if(this.getLocalizationName()&&t===this.getLocalizationStr())return this.setHtmlValue(e,""),!1;const s=this.owner.getMarkdownHtml(t,this.name);return this.setHtmlValue(e,s),!!s}setHtmlValue(e,t){this.htmlValues[e]=t}getHtmlValue(){var e=this.locale;return e||(e=this.defaultLoc),this.htmlValues[e]}deleteValuesEqualsToDefault(e){if(!A.localization.storeDuplicatedTranslations)for(var t=this.getValuesKeys(),s=0;s<t.length;s++)t[s]!=this.defaultLoc&&this.getValue(t[s])==e&&this.deleteValue(t[s])}getValue(e){return this.sharedData?this.sharedData.getValue(e):this.values[this.getValueLoc(e)]}setValue(e,t){this.sharedData?this.sharedData.setValue(e,t):this.values[this.getValueLoc(e)]=t}deleteValue(e){this.sharedData?this.sharedData.deleteValue(e):delete this.values[this.getValueLoc(e)]}getValueLoc(e){return this.disableLocalization?A.localization.defaultLocaleName:e}getValuesKeys(){return this.sharedData?this.sharedData.getValuesKeys():Object.keys(this.values)}get defaultLoc(){return A.localization.defaultLocaleName}};At.SerializeAsObject=!1,At.defaultRenderer="sv-string-viewer",At.editableRenderer="sv-string-editor";let Q2=class{constructor(e){this.owner=e,this.values={}}getIsMultiple(){return!0}get locale(){return this.owner&&this.owner.getLocale?this.owner.getLocale():""}get value(){return this.getValue("")}set value(e){this.setValue("",e)}get text(){return Array.isArray(this.value)?this.value.join(`
`):""}set text(e){this.value=e?e.split(`
`):[]}getLocaleText(e){var t=this.getValueCore(e,!e||e===this.locale);return!t||!Array.isArray(t)||t.length==0?"":t.join(`
`)}setLocaleText(e,t){var s=t?t.split(`
`):null;this.setValue(e,s)}getValue(e){return this.getValueCore(e)}getValueCore(e,t=!0){if(e=this.getLocale(e),this.values[e])return this.values[e];if(t){var s=A.localization.defaultLocaleName;if(e!==s&&this.values[s])return this.values[s]}return[]}setValue(e,t){e=this.getLocale(e);const s=O.createCopy(this.values);!t||t.length==0?delete this.values[e]:this.values[e]=t,this.onValueChanged&&this.onValueChanged(s,this.values)}hasValue(e=""){return!this.isEmpty&&this.getValue(e).length>0}get isEmpty(){return this.getValuesKeys().length==0}getLocale(e){return e||(e=this.locale,e||A.localization.defaultLocaleName)}getLocales(){var e=this.getValuesKeys();return e.length==0?[]:e}getJson(){var e=this.getValuesKeys();return e.length==0?null:e.length==1&&e[0]==A.localization.defaultLocaleName&&!A.serialization.localizableStringSerializeAsObject?this.values[e[0]]:O.createCopy(this.values)}setJson(e){if(this.values={},!!e)if(Array.isArray(e))this.setValue(null,e);else for(var t in e)this.setValue(t,e[t])}getValuesKeys(){return Object.keys(this.values)}};function H2(n){return A&&A.confirmActionFunc?A.confirmActionFunc(n):confirm(n)}function Ga(n){const e=t=>{t?n.funcOnYes():n.funcOnNo&&n.funcOnNo()};if(A&&A.confirmActionFunc){e(H2(n.message));return}A&&A.confirmActionAsync?A.confirmActionAsync(n.message,e,n):xy(n.message,e,n)}function Ja(){if(typeof Ja.isIEOrEdge>"u"){const n=navigator.userAgent,e=n.indexOf("MSIE "),t=n.indexOf("Trident/"),s=n.indexOf("Edge/");Ja.isIEOrEdge=s>0||t>0||e>0}return Ja.isIEOrEdge}function z2(n,e){try{const t=atob(n.split(",")[1]),s=n.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),r=new Uint8Array(i);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);const a=new Blob([i],{type:s});navigator&&navigator.msSaveBlob&&navigator.msSaveOrOpenBlob(a,e)}catch{}}const Ka=n=>!!n&&!!("host"in n&&n.host),j2=n=>{const{root:e}=A.environment;return typeof n=="string"?e.getElementById(n):n};function U2(n,e=0){if(typeof A.environment>"u"||!n.offsetHeight)return!1;const{root:t}=A.environment,s=Ka(t)?t.host.clientHeight:t.documentElement.clientHeight,i=n.getBoundingClientRect(),r=Math.max(s,we.getInnerHeight()),a=-e,o=r+e,l=i.top,u=i.bottom,d=Math.max(a,l),h=Math.min(o,u);return d<=h}function Za(n){if(!n)return ge.isAvailable()?ge.getDocument().documentElement:void 0;if(n.scrollHeight>n.clientHeight&&(getComputedStyle(n).overflowY==="scroll"||getComputedStyle(n).overflowY==="auto")||n.scrollWidth>n.clientWidth&&(getComputedStyle(n).overflowX==="scroll"||getComputedStyle(n).overflowX==="auto"))return n;if(!n.parentElement){const e=n.getRootNode();if(e instanceof Document||e instanceof ShadowRoot)return Ka(e)?e.host:e.documentElement}return Za(n.parentElement)}function Fu(n){if(!n)return;const e=Za(n);e&&setTimeout(()=>e.dispatchEvent(new CustomEvent("scroll")),10)}function W2(n){const e=we.getLocation();!n||!e||(e.href=Z2(n))}function Qu(n){return n?["url(",n,")"].join(""):""}function $2(n){return typeof n=="string"?/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[^;]+?)*),(.+)$/.test(n):null}const vy={changecamera:"flip-24x24",clear:"clear-24x24",cancel:"cancel-24x24",closecamera:"close-24x24",defaultfile:"file-72x72",choosefile:"folder-24x24",file:"toolbox-file-24x24",left:"chevronleft-16x16",modernbooleancheckchecked:"plus-32x32",modernbooleancheckunchecked:"minus-32x32",more:"more-24x24",navmenu_24x24:"navmenu-24x24",removefile:"error-24x24",takepicture:"camera-32x32",takepicture_24x24:"camera-24x24",v2check:"check-16x16",checked:"check-16x16",v2check_24x24:"check-24x24","back-to-panel_16x16":"restoredown-16x16",clear_16x16:"clear-16x16",close_16x16:"close-16x16",collapsedetail:"collapsedetails-16x16",expanddetail:"expanddetails-16x16","full-screen_16x16":"maximize-16x16",loading:"loading-48x48",minimize_16x16:"minimize-16x16",next_16x16:"chevronright-16x16",previous_16x16:"chevronleft-16x16","no-image":"noimage-48x48","ranking-dash":"rankingundefined-16x16","drag-n-drop":"drag-24x24","ranking-arrows":"reorder-24x24",restore_16x16:"fullsize-16x16",reset:"restore-24x24",search:"search-24x24",average:"smiley-rate5-24x24",excellent:"smiley-rate9-24x24",good:"smiley-rate7-24x24",normal:"smiley-rate6-24x24","not-good":"smiley-rate4-24x24",perfect:"smiley-rate10-24x24",poor:"smiley-rate3-24x24",terrible:"smiley-rate1-24x24","very-good":"smiley-rate8-24x24","very-poor":"smiley-rate2-24x24",add_16x16:"add-16x16",add_24x24:"add-24x24",alert_24x24:"warning-24x24",apply:"apply-24x24","arrow-down":"arrowdown-24x24","arrow-left":"arrowleft-24x24","arrow-left_16x16":"arrowleft-16x16",arrowleft:"arrowleft-16x16","arrow-right":"arrowright-24x24","arrow-right_16x16":"arrowright-16x16",arrowright:"arrowright-16x16","arrow-up":"arrowup-24x24",boolean:"toolbox-boolean-24x24","change-question-type_16x16":"speechbubble-16x16",checkbox:"toolbox-checkbox-24x24","collapse-detail_16x16":"minusbox-16x16","collapse-panel":"collapse-pg-24x24",collapse_16x16:"collapse-16x16","color-picker":"dropper-16x16",comment:"toolbox-longtext-24x24",config:"wrench-24x24",copy:"copy-24x24",default:"toolbox-customquestion-24x24",delete_16x16:"delete-16x16",delete_24x24:"delete-24x24",delete:"delete-24x24","description-hide":"hidehint-16x16",description:"hint-16x16","device-desktop":"desktop-24x24","device-phone":"phone-24x24","device-rotate":"rotate-24x24","device-tablet":"tablet-24x24",download:"download-24x24","drag-area-indicator":"drag-24x24","drag-area-indicator_24x16":"draghorizontal-24x16",v2dragelement_16x16:"draghorizontal-24x16","drop-down-arrow":"chevrondown-24x24","drop-down-arrow_16x16":"chevrondown-16x16",chevron_16x16:"chevrondown-16x16",dropdown:"toolbox-dropdown-24x24",duplicate_16x16:"copy-16x16",edit:"edit-24x24",edit_16x16:"edit-16x16","editing-finish":"finishedit-24x24",error:"error-16x16","expand-detail_16x16":"plusbox-16x16","expand-panel":"expand-pg-24x24",expand_16x16:"expand-16x16",expression:"toolbox-expression-24x24","fast-entry":"textedit-24x24",fix:"fix-24x24",html:"toolbox-html-24x24",image:"toolbox-image-24x24",imagepicker:"toolbox-imagepicker-24x24",import:"import-24x24","invisible-items":"invisible-24x24",language:"language-24x24",load:"import-24x24","logic-collapse":"collapse-24x24","logic-expand":"expand-24x24",logo:"image-48x48",matrix:"toolbox-matrix-24x24",matrixdropdown:"toolbox-multimatrix-24x24",matrixdynamic:"toolbox-dynamicmatrix-24x24",multipletext:"toolbox-multipletext-24x24",panel:"toolbox-panel-24x24",paneldynamic:"toolbox-dynamicpanel-24x24",preview:"preview-24x24",radiogroup:"toolbox-radiogroup-24x24",ranking:"toolbox-ranking-24x24",rating:"toolbox-rating-24x24",slider:"toolbox-slider-24x24",redo:"redo-24x24",remove_16x16:"remove-16x16",required:"required-16x16",save:"save-24x24","select-page":"selectpage-24x24",settings:"settings-24x24",settings_16x16:"settings-16x16",signaturepad:"toolbox-signature-24x24","switch-active_16x16":"switchon-16x16","switch-inactive_16x16":"switchoff-16x16",tagbox:"toolbox-tagbox-24x24",text:"toolbox-singleline-24x24",theme:"theme-24x24",toolbox:"toolbox-24x24",undo:"undo-24x24",visible:"visible-24x24",wizard:"wand-24x24",searchclear:"clear-16x16","chevron-16x16":"chevrondown-16x16",chevron:"chevrondown-24x24",progressbuttonv2:"arrowleft-16x16",right:"chevronright-16x16","add-lg":"add-24x24",add:"add-24x24"};function G2(n){return J2(n)||Hu(n)}function Hu(n){const e="icon-",t=n.replace(e,""),s=vy[t]||t;return e+s}function J2(n){let e=A.customIcons[n];return e?Hu(e):(n=Hu(n),e=A.customIcons[n],e||null)}function K2(n,e,t,s,i,r){if(!i)return;n!=="auto"&&(i.style.width=(n||e||16)+"px",i.style.height=(n||t||16)+"px");const a=i.childNodes[0],o=G2(s);a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#"+o);let l=i.getElementsByTagName("title")[0];if(r)l||(l=ge.getDocument().createElementNS("http://www.w3.org/2000/svg","title"),i.appendChild(l));else{l&&i.removeChild(l);return}l.textContent=r}function Z2(n){return n&&(n.toLocaleLowerCase().indexOf("javascript:")>-1?encodeURIComponent(n):n)}function $i(n){if(typeof n=="string")if(isNaN(Number(n))){if(n.includes("px"))return parseFloat(n)}else return Number(n);if(typeof n=="number")return n}function Ya(n){if($i(n)===void 0)return n}const zu="sv-focused--by-key";function Cy(n){const e=n.target;!e||!e.classList||e.classList.remove(zu)}function ju(n,e){if(n.target&&n.target.contentEditable==="true")return;const t=n.target;if(!t)return;const s=n.which||n.keyCode;if(s===9){t.classList&&!t.classList.contains(zu)&&t.classList.add(zu);return}if(e){if(!e.__keyDownReceived)return;e.__keyDownReceived=!1}s===13||s===32?t.click&&t.click():(!e||e.processEsc)&&s===27&&t.blur&&t.blur()}function Y2(n,e={processEsc:!0}){if(e&&(e.__keyDownReceived=!0),n.target&&n.target.contentEditable==="true")return;var t=n.which||n.keyCode;const s=[13,32];e.processEsc&&s.push(27),s.indexOf(t)!==-1&&n.preventDefault()}function by(n,e){if(!n)return;e||(e=a=>ge.getComputedStyle(a));const t=parseFloat(n.getAttribute("rows")||"2"),s=e(n),i=s.overflowY,r=parseFloat(s.lineHeight);if(n.scrollHeight){const a=parseFloat(s.borderTopWidth)+parseFloat(s.borderBottomWidth)+parseFloat(s.paddingBottom)+parseFloat(s.paddingTop);let o=(n.scrollHeight-a)/r;const l=u=>{n.style.height=u*r+a+"px"};for(l(o),n.style.overflowY="hidden";n.scrollHeight<=n.offsetHeight&&o>t;)o--,l(o);n.style.overflowY=i,n.scrollHeight>n.offsetHeight&&(o++,l(o))}else n.style.height="auto"}function wy(n){n.preventDefault(),n.stopPropagation()}function rs(n){if(!n)return n;const e=/\s*?([\w-]+)\s*?/g;return n.replace(e,".$1")}function Uu(n){return getComputedStyle?Number.parseFloat(getComputedStyle(n).width):n.offsetWidth}function Wu(n){return!!(n.offsetWidth||n.offsetHeight||n.getClientRects().length)}function X2(n){let e;for(let t=0;t<n.children.length;t++)!e&&getComputedStyle(n.children[t]).display!=="none"&&(e=n.children[t]);return e}function Xr(n,e){if(!(!e||!n)&&typeof e=="object")for(var t in n){var s=n[t];!Array.isArray(s)&&s&&typeof s=="object"?((!e[t]||typeof e[t]!="object")&&(e[t]={}),Xr(s,e[t])):e[t]=s}}function Xa(n,e){const t={};Xr(e.list,t),Xr(n.list,t),n.list=t}function xy(n,e,t={}){const s=new At(void 0,!1);s.defaultValue=n||t.message;const i=A.showDialog({componentName:"sv-string-viewer",data:{locStr:s,locString:s,model:s},onApply:()=>(e(!0),!0),onCancel:()=>(e(!1),!1),displayMode:"popup",isFocusedContent:!1,cssClass:t.cssClass||"sv-popup--confirm"},t.rootElement),r=i.footerToolbar,a=r.getActionById("apply"),o=r.getActionById("cancel");return o.title=Ct("cancel",t.locale),a.title=t.applyTitle||Ct("ok",t.locale),a.innerCss="sd-btn--danger",eP(i),!0}function eP(n){n.width="min-content"}function tP(n,e){we.isFileReaderAvailable()&&(n.value="",n.onchange=t=>{if(!we.isFileReaderAvailable()||!n||!n.files||n.files.length<1)return;let s=[];for(let i=0;i<n.files.length;i++)s.push(n.files[i]);e(s)},n.click())}function sP(n,e,t){const s=new Map,i=new Map,r=new Map,a=new Map;n.forEach(V=>{const P=t(V);if(!s.has(P))s.set(t(V),V);else throw new Error("keys must be unique")}),e.forEach(V=>{const P=t(V);if(!i.has(P))i.set(P,V);else throw new Error("keys must be unique")});const o=[],l=[];i.forEach((V,P)=>{s.has(P)?r.set(P,r.size):o.push(V)}),s.forEach((V,P)=>{i.has(P)?a.set(P,a.size):l.push(V)});const u=[];r.forEach((V,P)=>{const M=a.get(P),X=i.get(P);M!==V&&u.push({item:X,movedForward:M<V})});const d=new Array(n.length);let h=0;const f=Array.from(r.keys());n.forEach((V,P)=>{r.has(t(V))?(d[P]=i.get(f[h]),h++):d[P]=V});const C=new Map;let b=[];d.forEach(V=>{const P=t(V);i.has(P)?b.length>0&&(C.set(P,b),b=[]):b.push(V)});const x=new Array;return i.forEach((V,P)=>{C.has(P)&&C.get(P).forEach(M=>{x.push(M)}),x.push(V)}),b.forEach(V=>{x.push(V)}),{reorderedItems:u,deletedItems:l,addedItems:o,mergedItems:x}}function iP(n){if(ge.isAvailable()){const{paddingTop:e,paddingBottom:t,borderTopWidth:s,borderBottomWidth:i,marginTop:r,marginBottom:a,boxSizing:o}=ge.getComputedStyle(n);let l=n.offsetHeight+"px";if(o=="content-box"){let u=n.offsetHeight;[i,s,t,e].forEach(d=>{u-=parseFloat(d)}),l=u+"px"}return{paddingTop:e,paddingBottom:t,borderTopWidth:s,borderBottomWidth:i,marginTop:r,marginBottom:a,heightFrom:"0px",heightTo:l}}else return}function en(n,e,t="--animation-"){var s;n.__sv_created_properties=(s=n.__sv_created_properties)!==null&&s!==void 0?s:[],Object.keys(e).forEach(i=>{const r=`${t}${i.split(/\.?(?=[A-Z])/).join("-").toLowerCase()}`;n.style.setProperty(r,e[i]),n.__sv_created_properties.push(r)})}function ni(n){en(n,iP(n))}function ys(n){Array.isArray(n.__sv_created_properties)&&(n.__sv_created_properties.forEach(e=>{n.style.removeProperty(e)}),delete n.__sv_created_properties)}function rP(n){return Math.floor(n*100)/100}const eo=typeof globalThis<"u"?globalThis.document:(void 0).document,nP=eo?{root:eo,_rootElement:ge.getBody(),get rootElement(){var n;return(n=this._rootElement)!==null&&n!==void 0?n:ge.getBody()},set rootElement(n){this._rootElement=n},_popupMountContainer:ge.getBody(),get popupMountContainer(){var n;return(n=this._popupMountContainer)!==null&&n!==void 0?n:ge.getBody()},set popupMountContainer(n){this._popupMountContainer=n},svgMountContainer:eo.head,stylesSheetsMountContainer:eo.head}:void 0;var A={version:"",designMode:{showEmptyDescriptions:!0,showEmptyTitles:!0},get allowShowEmptyDescriptionInDesignMode(){return this.designMode.showEmptyDescriptions},set allowShowEmptyDescriptionInDesignMode(n){this.designMode.showEmptyDescriptions=n},get allowShowEmptyTitleInDesignMode(){return this.designMode.showEmptyTitles},set allowShowEmptyTitleInDesignMode(n){this.designMode.showEmptyTitles=n},localization:{useLocalTimeZone:!0,storeDuplicatedTranslations:!1,defaultLocaleName:"default"},get useLocalTimeZone(){return this.localization.useLocalTimeZone},set useLocalTimeZone(n){this.localization.useLocalTimeZone=n},get storeDuplicatedTranslations(){return this.localization.storeDuplicatedTranslations},set storeDuplicatedTranslations(n){this.localization.storeDuplicatedTranslations=n},get defaultLocaleName(){return this.localization.defaultLocaleName},set defaultLocaleName(n){this.localization.defaultLocaleName=n},web:{onBeforeRequestChoices:(n,e)=>{},encodeUrlParams:!0,cacheLoadedChoices:!0,disableQuestionWhileLoadingChoices:!1},get webserviceEncodeParameters(){return this.web.encodeUrlParams},set webserviceEncodeParameters(n){this.web.encodeUrlParams=n},get useCachingForChoicesRestful(){return this.web.cacheLoadedChoices},set useCachingForChoicesRestful(n){this.web.cacheLoadedChoices=n},get useCachingForChoicesRestfull(){return this.web.cacheLoadedChoices},set useCachingForChoicesRestfull(n){this.web.cacheLoadedChoices=n},get disableOnGettingChoicesFromWeb(){return this.web.disableQuestionWhileLoadingChoices},set disableOnGettingChoicesFromWeb(n){this.web.disableQuestionWhileLoadingChoices=n},triggers:{changeNavigationButtonsOnComplete:!0,executeCompleteOnValueChanged:!1,executeSkipOnValueChanged:!0},get executeCompleteTriggerOnValueChanged(){return this.triggers.executeCompleteOnValueChanged},set executeCompleteTriggerOnValueChanged(n){this.triggers.executeCompleteOnValueChanged=n},get changeNavigationButtonsOnCompleteTrigger(){return this.triggers.changeNavigationButtonsOnComplete},set changeNavigationButtonsOnCompleteTrigger(n){this.triggers.changeNavigationButtonsOnComplete=n},get executeSkipTriggerOnValueChanged(){return this.triggers.executeSkipOnValueChanged},set executeSkipTriggerOnValueChanged(n){this.triggers.executeSkipOnValueChanged=n},serialization:{itemValueSerializeAsObject:!1,itemValueSerializeDisplayText:!1,localizableStringSerializeAsObject:!1,matrixDropdownColumnSerializeTitle:!1},get itemValueAlwaysSerializeAsObject(){return this.serialization.itemValueSerializeAsObject},set itemValueAlwaysSerializeAsObject(n){this.serialization.itemValueSerializeAsObject=n},get itemValueAlwaysSerializeText(){return this.serialization.itemValueSerializeDisplayText},set itemValueAlwaysSerializeText(n){this.serialization.itemValueSerializeDisplayText=n},get serializeLocalizableStringAsObject(){return this.serialization.localizableStringSerializeAsObject},set serializeLocalizableStringAsObject(n){this.serialization.localizableStringSerializeAsObject=n},lazyRender:{enabled:!1,firstBatchSize:3},get lazyRowsRendering(){return this.lazyRender.enabled},set lazyRowsRendering(n){this.lazyRender.enabled=n},get lazyRowsRenderingStartRow(){return this.lazyRender.firstBatchSize},set lazyRowsRenderingStartRow(n){this.lazyRender.firstBatchSize=n},matrix:{defaultCellType:"dropdown",defaultRowName:"default",totalsSuffix:"-total",maxRowCount:1e3,maxRowCountInCondition:1,renderRemoveAsIcon:!0,columnWidthsByType:{file:{minWidth:"240px"},comment:{minWidth:"200px"}},rateSize:"small"},get matrixDefaultRowName(){return this.matrix.defaultRowName},set matrixDefaultRowName(n){this.matrix.defaultRowName=n},get matrixDefaultCellType(){return this.matrix.defaultCellType},set matrixDefaultCellType(n){this.matrix.defaultCellType=n},get matrixTotalValuePostFix(){return this.matrix.totalsSuffix},set matrixTotalValuePostFix(n){this.matrix.totalsSuffix=n},get matrixMaximumRowCount(){return this.matrix.maxRowCount},set matrixMaximumRowCount(n){this.matrix.maxRowCount=n},get matrixMaxRowCountInCondition(){return this.matrix.maxRowCountInCondition},set matrixMaxRowCountInCondition(n){this.matrix.maxRowCountInCondition=n},get matrixRenderRemoveAsIcon(){return this.matrix.renderRemoveAsIcon},set matrixRenderRemoveAsIcon(n){this.matrix.renderRemoveAsIcon=n},panel:{maxPanelCount:100,maxPanelCountInCondition:1},get panelDynamicMaxPanelCountInCondition(){return this.panel.maxPanelCountInCondition},set panelDynamicMaxPanelCountInCondition(n){this.panel.maxPanelCountInCondition=n},get panelMaximumPanelCount(){return this.panel.maxPanelCount},set panelMaximumPanelCount(n){this.panel.maxPanelCount=n},readOnly:{enableValidation:!1,commentRenderMode:"textarea",textRenderMode:"input"},get readOnlyCommentRenderMode(){return this.readOnly.commentRenderMode},set readOnlyCommentRenderMode(n){this.readOnly.commentRenderMode=n},get readOnlyTextRenderMode(){return this.readOnly.textRenderMode},set readOnlyTextRenderMode(n){this.readOnly.textRenderMode=n},numbering:{includeQuestionsWithHiddenNumber:!1,includeQuestionsWithHiddenTitle:!1},get setQuestionVisibleIndexForHiddenTitle(){return this.numbering.includeQuestionsWithHiddenTitle},set setQuestionVisibleIndexForHiddenTitle(n){this.numbering.includeQuestionsWithHiddenTitle=n},get setQuestionVisibleIndexForHiddenNumber(){return this.numbering.includeQuestionsWithHiddenNumber},set setQuestionVisibleIndexForHiddenNumber(n){this.numbering.includeQuestionsWithHiddenNumber=n},enterKeyAction:"default",comparator:{trimStrings:!0,caseSensitive:!1,normalizeTextCallback:(n,e)=>n},expressionDisableConversionChar:"#",get commentPrefix(){return A.commentSuffix},set commentPrefix(n){A.commentSuffix=n},commentSuffix:"-Comment",itemValueSeparator:"|",ratingMaximumRateValueCount:20,tagboxCloseOnSelect:!1,dropdownSearchDelay:500,confirmActionFunc:void 0,confirmActionAsync:(n,e,t)=>{xy(n,e,t)},minWidth:"300px",maxWidth:"100%",maxConditionRunCountOnValueChanged:10,notifications:{lifetime:2e3},autoAdvanceDelay:300,itemFlowDirection:"column",get showItemsInOrder(){return A.itemFlowDirection},set showItemsInOrder(n){A.itemFlowDirection=n},noneItemValue:"none",refuseItemValue:"refused",dontKnowItemValue:"dontknow",specialChoicesOrder:{selectAllItem:[-1],noneItem:[1],refuseItem:[2],dontKnowItem:[3],otherItem:[4]},choicesSeparator:", ",supportedValidators:{question:["expression"],comment:["text","regex"],text:["numeric","text","regex","email"],checkbox:["answercount"],imagepicker:["answercount"]},expressionVariables:{question:"self",matrix:"matrix",composite:"composite",item:"item",choice:"choice",row:"row",totalRow:"totalRow",rowIndex:"rowIndex",visibleRowIndex:"visibleRowIndex",rowValue:"rowValue",rowName:"rowName",rowTitle:"rowTitle",panel:"panel",parentPanel:"parentPanel",panelIndex:"panelIndex",visiblePanelIndex:"visiblePanelIndex",unwrapPostfix:"-unwrapped"},minDate:"",maxDate:"2999-12-31",showDialog:void 0,showDefaultItemsInCreator:!0,customIcons:{},rankingDragHandleArea:"entireItem",environment:nP,showMaxLengthIndicator:!0,animationEnabled:!0,titleTags:{survey:"div",page:"div",panel:"div",question:"div"},questions:{inputTypes:["color","date","datetime-local","email","month","number","password","range","tel","text","time","url","week"],dataList:["","name","honorific-prefix","given-name","additional-name","family-name","honorific-suffix","nickname","organization-title","username","new-password","current-password","organization","street-address","address-line1","address-line2","address-line3","address-level4","address-level3","address-level2","address-level1","country","country-name","postal-code","cc-name","cc-given-name","cc-additional-name","cc-family-name","cc-number","cc-exp","cc-exp-month","cc-exp-year","cc-csc","cc-type","transaction-currency","transaction-amount","language","bday","bday-day","bday-month","bday-year","sex","url","photo","tel","tel-country-code","tel-national","tel-area-code","tel-local","tel-local-prefix","tel-local-suffix","tel-extension","email","impp"]},legacyProgressBarView:!1,maskSettings:{patternPlaceholderChar:"_",patternEscapeChar:"\\",patternDefinitions:{9:/[0-9]/,a:/[a-zA-Z]/,"#":/[a-zA-Z0-9]/}},storeUtcDates:!1,onDateCreated:(n,e,t)=>n,parseNumber:(n,e)=>e};let Yt=class{constructor(e=null,t=null){this.text=e,this.errorOwner=t,this.visible=!0,this.onUpdateErrorTextCallback=void 0}equals(e){return!e||!e.getErrorType||this.getErrorType()!==e.getErrorType()?!1:this.text===e.text&&this.visible===e.visible}get locText(){return this.locTextValue||(this.locTextValue=new At(this.errorOwner,!0),this.locTextValue.storeDefaultText=!0,this.locTextValue.text=this.getText()),this.locTextValue}get notificationType(){return this.notificationTypeValue||"error"}set notificationType(e){this.notificationTypeValue=e}get isWarning(){return this.notificationTypeValue==="warning"}get isInfo(){return this.notificationTypeValue==="info"}get isError(){return!this.isInfo&&!this.isWarning}getCssIcon(e){const t=this.getCssError(e);return(this.isWarning?t.warningIcon:this.isInfo?t.infoIcon:t.icon)||t.icon||void 0}getCssError(e){return e=e||{},e.error||{}}getText(){var e=this.text;return e||(e=this.getDefaultText()),this.errorOwner&&(e=this.errorOwner.getErrorCustomText(e,this)),e}getErrorType(){return"base"}getDefaultText(){return""}getLocale(){return this.errorOwner?this.errorOwner.getLocale():""}getLocalizationString(e){return Ct(e,this.getLocale())}updateText(){this.onUpdateErrorTextCallback&&this.onUpdateErrorTextCallback(this),this.locText.text=this.getText()}},aP=class extends Yt{constructor(e=null,t=null){super(e,t),this.text=e}getErrorType(){return"required"}getDefaultText(){return this.getLocalizationString("requiredError")}},oP=class extends Yt{constructor(e=null,t=null){super(e,t),this.text=e}getErrorType(){return"requireoneanswer"}getDefaultText(){return this.getLocalizationString("requiredErrorInPanel")}},lP=class extends Yt{constructor(e=null,t=null){super(e,t),this.text=e}getErrorType(){return"requirenumeric"}getDefaultText(){return this.getLocalizationString("numericError")}},uP=class extends Yt{constructor(e,t=null){super(null,t),this.maxSize=e,this.locText.text=this.getText()}getErrorType(){return"exceedsize"}getDefaultText(){return this.getLocalizationString("exceedMaxSize").format(this.getTextSize())}getTextSize(){var e=["Bytes","KB","MB","GB","TB"],t=[0,0,2,3,3];if(this.maxSize===0)return"0 Byte";var s=Math.floor(Math.log(this.maxSize)/Math.log(1024)),i=this.maxSize/Math.pow(1024,s);return i.toFixed(t[s])+" "+e[s]}},hP=class extends Yt{constructor(e,t=null){super(null,t),this.maxFiles=e,this.locText.text=this.getText()}getErrorType(){return"exceedfilescount"}getDefaultText(){return this.getLocalizationString("exceedMaxFiles").format(this.maxFiles)}},Vy=class extends Yt{constructor(e,t,s=null){super(null,s),this.status=e,this.response=t}getErrorType(){return"webrequest"}getDefaultText(){const e=this.getLocalizationString("urlRequestError");return e?e.format(this.status,this.response):""}},dP=class extends Yt{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"webrequestempty"}getDefaultText(){return this.getLocalizationString("urlGetChoicesError")}},cP=class extends Yt{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"otherempty"}getDefaultText(){return this.getLocalizationString("otherRequiredError")}},to=class extends Yt{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"uploadingfile"}getDefaultText(){return this.getLocalizationString("uploadingFile")}},pP=class extends Yt{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"requiredinallrowserror"}getDefaultText(){return this.getLocalizationString("requiredInAllRowsError")}},gP=class extends Yt{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"eachrowuniqueeerror"}getDefaultText(){return this.getLocalizationString("eachRowUniqueError")}},mP=class extends Yt{constructor(e,t=null){super(null,t),this.minRowCount=e}getErrorType(){return"minrowcounterror"}getDefaultText(){return this.getLocalizationString("minRowCountError").format(this.minRowCount)}},Py=class extends Yt{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"keyduplicationerror"}getDefaultText(){return this.getLocalizationString("keyDuplicationError")}},vs=class extends Yt{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"custom"}},Sy=class{constructor(e){this.onCompleted=e,this.asyncElements={},this.isRunningValue=!0}addElement(e){this.asyncElements[e]=!0}removeElement(e){delete this.asyncElements[e],this.tryComplete()}finish(){this.isRunningValue=!1,this.tryComplete()}get isRunning(){return this.isRunningValue||Object.keys(this.asyncElements).length>0}doCompleted(){this.onCompleted&&this.onCompleted()}tryComplete(){this.isRunning||this.doCompleted()}},Qs=class{constructor(e,t=null){this.value=e,this.error=t}},vr=class extends Te{constructor(){super(),this.createLocalizableString("text",this,!0)}get id(){return"svd"+this.uniqueId}get isValidator(){return!0}getSurvey(e=!1){return this.errorOwner&&this.errorOwner.getSurvey?this.errorOwner.getSurvey():null}get notificationType(){return this.getPropertyValue("notificationType")}set notificationType(e){this.setPropertyValue("notificationType",e)}get text(){return this.getLocalizableStringText("text")}set text(e){this.setLocalizableStringText("text",e)}get locText(){return this.getLocalizableString("text")}getErrorText(e){return this.text?this.text:this.getDefaultErrorText(e)}getDefaultErrorText(e){return""}validateOnCallback(e,t,s,i){const r=this.validate(e,s,i);return t&&t(r),r}validate(e,t,s){return null}getLocale(){return this.errorOwner?this.errorOwner.getLocale():""}getMarkdownHtml(e,t,s){return this.errorOwner?this.errorOwner.getMarkdownHtml(e,t,s):void 0}getRenderer(e){return this.errorOwner?this.errorOwner.getRenderer(e):null}getRendererContext(e){return this.errorOwner?this.errorOwner.getRendererContext(e):e}getProcessedText(e){return this.errorOwner?this.errorOwner.getProcessedText(e):e}createCustomError(e){const t=new vs(this.getErrorText(e),this.errorOwner);return t.onUpdateErrorTextCallback=(s=>s.text=this.getErrorText(e)),t}toString(){var e=this.getType().replace("validator","");return this.text&&(e+=", "+this.text),e}},fP=class{run(e){const t=e.getValidators(),s=new Array,i=new Sy(()=>{this.onAsyncCompleted&&this.onAsyncCompleted(s)});if(t.length>0){const a=e.getDataFilteredProperties(),o=e.validatedValue,l=e.getValidatorTitle();t.forEach(u=>{i.addElement(u.id),u.validateOnCallback(o,d=>{d&&d.error&&(d.error.notificationType=u.notificationType,s.push(d.error)),i.removeElement(u.id)},l,a)})}const r=[].concat(...s);return s.length=0,i.finish(),r}},yP=class extends vr{constructor(e=null,t=null){super(),this.minValue=e,this.maxValue=t}getType(){return"numericvalidator"}validate(e,t,s){if(this.isValueEmpty(e))return null;if(!O.isNumber(e))return new Qs(null,new lP(this.text,this.errorOwner));const i=new Qs(O.getNumber(e));return this.minValue!==null&&this.minValue>i.value?(i.error=this.createCustomError(t),i):this.maxValue!==null&&this.maxValue<i.value?(i.error=this.createCustomError(t),i):typeof e=="number"?null:i}getDefaultErrorText(e){var t=e||this.getLocalizationString("value");return this.minValue!==null&&this.maxValue!==null?this.getLocalizationFormatString("numericMinMax",t,this.minValue,this.maxValue):this.minValue!==null?this.getLocalizationFormatString("numericMin",t,this.minValue):this.getLocalizationFormatString("numericMax",t,this.maxValue)}get minValue(){return this.getPropertyValue("minValue")}set minValue(e){this.setPropertyValue("minValue",e)}get maxValue(){return this.getPropertyValue("maxValue")}set maxValue(e){this.setPropertyValue("maxValue",e)}},vP=class extends vr{constructor(){super()}getType(){return"textvalidator"}validate(e,t,s){if(this.isValueEmpty(e))return null;if(!this.allowDigits){var i=/\d+$/;if(i.test(e))return new Qs(null,this.createCustomError("textNoDigitsAllow"))}return this.minLength>0&&e.length<this.minLength?new Qs(null,this.createCustomError(t)):this.maxLength>0&&e.length>this.maxLength?new Qs(null,this.createCustomError(t)):null}getDefaultErrorText(e){return e==="textNoDigitsAllow"?this.getLocalizationString(e):this.minLength>0&&this.maxLength>0?this.getLocalizationFormatString("textMinMaxLength",this.minLength,this.maxLength):this.minLength>0?this.getLocalizationFormatString("textMinLength",this.minLength):this.getLocalizationFormatString("textMaxLength",this.maxLength)}get minLength(){return this.getPropertyValue("minLength")}set minLength(e){this.setPropertyValue("minLength",e)}get maxLength(){return this.getPropertyValue("maxLength")}set maxLength(e){this.setPropertyValue("maxLength",e)}get allowDigits(){return this.getPropertyValue("allowDigits")}set allowDigits(e){this.setPropertyValue("allowDigits",e)}},CP=class extends vr{constructor(e=null,t=null){super(),this.minCount=e,this.maxCount=t}getType(){return"answercountvalidator"}validate(e,t,s){if(e==null||e.constructor!=Array)return null;var i=e.length;return i==0?null:this.minCount&&i<this.minCount?new Qs(null,this.createCustomError(this.getLocalizationFormatString("minSelectError",this.minCount))):this.maxCount&&i>this.maxCount?new Qs(null,this.createCustomError(this.getLocalizationFormatString("maxSelectError",this.maxCount))):null}getDefaultErrorText(e){return e}get minCount(){return this.getPropertyValue("minCount")}set minCount(e){this.setPropertyValue("minCount",e)}get maxCount(){return this.getPropertyValue("maxCount")}set maxCount(e){this.setPropertyValue("maxCount",e)}},bP=class extends vr{constructor(e=null){super(),this.regex=e}getType(){return"regexvalidator"}validate(e,t,s){if(!this.regex||this.isValueEmpty(e))return null;const i=this.createRegExp();if(Array.isArray(e))for(let r=0;r<e.length;r++){const a=this.hasError(i,e[r],t);if(a)return a}return this.hasError(i,e,t)}hasError(e,t,s){return e.test(t)?null:new Qs(t,this.createCustomError(s))}get regex(){return this.getPropertyValue("regex")}set regex(e){this.setPropertyValue("regex",e)}get caseInsensitive(){return this.getPropertyValue("caseInsensitive")}set caseInsensitive(e){this.setPropertyValue("caseInsensitive",e)}get insensitive(){return this.caseInsensitive}set insensitive(e){this.caseInsensitive=e}createRegExp(){return new RegExp(this.regex,this.caseInsensitive?"i":"")}},Iy=class extends vr{constructor(){super(),this.re=/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()=[\]\.,;:\s@\"]+\.)+[^<>()=[\]\.,;:\s@\"]{2,})$/i}getType(){return"emailvalidator"}validate(e,t,s){return!e||this.re.test(e)?null:new Qs(e,this.createCustomError(t))}getDefaultErrorText(e){return this.getLocalizationString("invalidEmail")}},wP=class extends vr{constructor(e=null){super(),this.conditionRunner=null,this.expression=e}getType(){return"expressionvalidator"}validateOnCallback(e,t,s,i){this.conditionRunner&&(this.conditionRunner.onRunComplete=null);let r=null;const a=l=>{r=this.generateError(l,e,s),t&&t(r)};if(!this.ensureConditionRunner())return a(!0),null;if(this.conditionRunner.onRunComplete=l=>{a(l)},!this.conditionRunner.canRun())return a(o),r;var o=this.conditionRunner.runContext(this.getValueGetterContext(),this.getPropertiesCopy(i,"expression"));return r||this.generateError(o,e,s)}generateError(e,t,s){return e?null:new Qs(t,this.createCustomError(s))}getDefaultErrorText(e){return this.getLocalizationFormatString("invalidExpression",this.expression)}ensureConditionRunner(){const e=this.getExpressionFromSurvey("expression");return e?(this.conditionRunner=new Fs(e),!0):!1}get expression(){return this.getPropertyValue("expression")}set expression(e){this.setPropertyValue("expression",e)}getValueGetterContext(){const e=this.errorOwner;return e&&e.getValueGetterContext?e.getValueGetterContext():super.getValueGetterContext()}};q.addClass("surveyvalidator",[{name:"text",serializationProperty:"locText"},{name:"notificationType",choices:["error","warning","info"],default:"error",visible:!0,category:"general",visibleIndex:100}]),q.addClass("numericvalidator",["minValue:number","maxValue:number"],function(){return new yP},"surveyvalidator"),q.addClass("textvalidator",[{name:"minLength:number",default:0},{name:"maxLength:number",default:0},{name:"allowDigits:boolean",default:!0}],function(){return new vP},"surveyvalidator"),q.addClass("answercountvalidator",["minCount:number","maxCount:number"],function(){return new CP},"surveyvalidator"),q.addClass("regexvalidator",["regex",{name:"caseInsensitive:boolean",alternativeName:"insensitive"}],function(){return new bP},"surveyvalidator"),q.addClass("emailvalidator",[],function(){return new Iy},"surveyvalidator"),q.addClass("expressionvalidator",["expression:condition"],function(){return new wP},"surveyvalidator");let xP=class{constructor(e,t){this.name=e,this.widgetJson=t,this.htmlTemplate=t.htmlTemplate?t.htmlTemplate:""}afterRender(e,t){this.widgetJson.afterRender&&(e.localeChangedCallback=()=>{this.widgetJson.willUnmount&&this.widgetJson.willUnmount(e,t),this.widgetJson.afterRender(e,t)},this.widgetJson.afterRender(e,t))}willUnmount(e,t){this.widgetJson.willUnmount&&this.widgetJson.willUnmount(e,t)}getDisplayValue(e,t=void 0){return this.widgetJson.getDisplayValue?this.widgetJson.getDisplayValue(e,t):null}validate(e){if(this.widgetJson.validate)return this.widgetJson.validate(e)}isFit(e){return this.isLibraryLoaded()&&this.widgetJson.isFit?this.widgetJson.isFit(e):!1}get canShowInToolbox(){return this.widgetJson.showInToolbox===!1||so.Instance.getActivatedBy(this.name)!="customtype"?!1:!this.widgetJson.widgetIsLoaded||this.widgetJson.widgetIsLoaded()}get showInToolbox(){return this.widgetJson.showInToolbox!==!1}set showInToolbox(e){this.widgetJson.showInToolbox=e}init(){this.widgetJson.init&&this.widgetJson.init()}activatedByChanged(e){this.isLibraryLoaded()&&this.widgetJson.activatedByChanged&&this.widgetJson.activatedByChanged(e)}isLibraryLoaded(){return this.widgetJson.widgetIsLoaded?this.widgetJson.widgetIsLoaded()==!0:!0}get isDefaultRender(){return this.widgetJson.isDefaultRender}get pdfQuestionType(){return this.widgetJson.pdfQuestionType}get pdfRender(){return this.widgetJson.pdfRender}},so=class{constructor(){this.widgetsValues=[],this.widgetsActivatedBy={},this.onCustomWidgetAdded=new uy}get widgets(){return this.widgetsValues}add(e,t="property"){this.addCustomWidget(e,t)}addCustomWidget(e,t="property"){var s=e.name;s||(s="widget_"+this.widgets.length+1);var i=new xP(s,e);return this.widgetsValues.push(i),i.init(),this.widgetsActivatedBy[s]=t,i.activatedByChanged(t),this.onCustomWidgetAdded.fire(i,null),i}getActivatedBy(e){var t=this.widgetsActivatedBy[e];return t||"property"}setActivatedBy(e,t){if(!(!e||!t)){var s=this.getCustomWidgetByName(e);s&&(this.widgetsActivatedBy[e]=t,s.activatedByChanged(t))}}clear(){this.widgetsValues=[]}getCustomWidgetByName(e){for(var t=0;t<this.widgets.length;t++)if(this.widgets[t].name==e)return this.widgets[t];return null}getCustomWidget(e){for(var t=0;t<this.widgetsValues.length;t++)if(this.widgetsValues[t].isFit(e))return this.widgetsValues[t];return null}};so.Instance=new so;let ai=class{constructor(){this.renderersHash={},this.defaultHash={}}unregisterRenderer(e,t){delete this.renderersHash[e][t],this.defaultHash[e]===t&&delete this.defaultHash[e]}registerRenderer(e,t,s,i=!1){this.renderersHash[e]||(this.renderersHash[e]={}),this.renderersHash[e][t]=s,i&&(this.defaultHash[e]=t)}getRenderer(e,t){const s=this.renderersHash[e];if(s){if(t&&s[t])return s[t];const i=this.defaultHash[e];if(i&&s[i])return s[i]}return"default"}getRendererByQuestion(e){return this.getRenderer(e.getType(),e.renderAs)}clear(){this.renderersHash={}}};ai.Instance=new ai;let $u=class{updateElement(){this.element&&this.autoGrow&&setTimeout(()=>by(this.element),1)}constructor(e){this.options=e,this.onPropertyChangedCallback=()=>{this.element&&(this.element.value=this.getTextValue(),this.updateElement())},this.question.registerFunctionOnPropertiesValueChanged(this.options.propertyNames,this.onPropertyChangedCallback,"__textarea")}setElement(e){e&&(this.element=e,this.updateElement())}resetElement(){this.element=void 0}getTextValue(){return this.options.getTextValue&&this.options.getTextValue()||""}onTextAreaChange(e){this.options.onTextAreaChange&&this.options.onTextAreaChange(e)}onTextAreaInput(e){this.options.onTextAreaInput&&this.options.onTextAreaInput(e),this.element&&this.autoGrow&&by(this.element)}onTextAreaKeyDown(e){this.options.onTextAreaKeyDown&&this.options.onTextAreaKeyDown(e)}onTextAreaBlur(e){this.onTextAreaChange(e),this.options.onTextAreaBlur&&this.options.onTextAreaBlur(e)}onTextAreaFocus(e){var t;this.options.onTextAreaFocus&&this.options.onTextAreaFocus(e),this.isReadOnlyAttr&&((t=e?.target)===null||t===void 0||t.select())}get question(){return this.options.question}get id(){return this.options.id()}get placeholder(){return this.options.placeholder()}get className(){return this.options.className()}get maxLength(){if(this.options.maxLength)return this.options.maxLength()}get autoGrow(){if(this.options.autoGrow)return this.options.autoGrow()}get rows(){if(this.options.rows)return this.options.rows()}get cols(){if(this.options.cols)return this.options.cols()}get isDisabledAttr(){return this.options.isDisabledAttr()}get isReadOnlyAttr(){if(this.options.isReadOnlyAttr)return this.options.isReadOnlyAttr()}get ariaRequired(){if(this.options.ariaRequired)return this.options.ariaRequired()}get ariaLabel(){if(this.options.ariaLabel)return this.options.ariaLabel()}get ariaInvalid(){if(this.options.ariaInvalid)return this.options.ariaInvalid()}get ariaLabelledBy(){if(this.options.ariaLabelledBy)return this.options.ariaLabelledBy()}get ariaDescribedBy(){if(this.options.ariaDescribedBy)return this.options.ariaDescribedBy()}get ariaErrormessage(){if(this.options.ariaErrormessage)return this.options.ariaErrormessage()}dispose(){this.question&&this.question.unRegisterFunctionOnPropertiesValueChanged(this.options.propertyNames,"__textarea"),this.resetElement()}},io=class{constructor(e,t){this.question=e,this.isUnwrapped=t}getValue(e,t,s,i){const r=A.expressionVariables;if(e.length===0||e.length===1&&e[0].name===r.question)return this.getQuestionValue(s);if(e.length>1&&e[0].name===r.panel){const a=this.question.parent;if(a&&a.isPanel)return e.shift(),new Gu(a.questions).getValue(e,!1,s,i)}if(!this.question.isEmpty()){let a=this.question.value;if(s>=0){if(!Array.isArray(a||s>=a.length))return;a=a[s]}return new fs(a).getValue(e,!1,s,i)}}getTextValue(e,t,s){return s?this.question.getDisplayValue(!0,t):t}getRootObj(){return this.question.data}getQuestion(){return this.question}getSurveyValue(e,t){const s=this.question.getSurvey();if(s)return s.getValueGetterContext().getValue(e,!1,t,!1)}getQuestionValue(e){const t=this.question;let s=t.getFilteredValue(this.isUnwrapped);return e>-1&&Array.isArray(s)&&(s=e<s.length?s[e]:void 0),{isFound:!0,context:this,value:s,requireStrictCompare:t.requireStrictCompare}}},Ty=class extends ji{getValueFromBindedQuestions(e,t){typeof t!="object"&&(t=void 0);const s=e.length===1?e[0].name:"",i=this.getQuestionsBySameValueNames();for(let r=0;r<i.length;r++){const a=i[r];if(s&&a.valuePropertyName===s&&t&&t.hasOwnProperty(s))return{isFound:!0,value:t[s],context:a.getValueGetterContext()};const o=a.getValueGetterContext().getValue(e,!1,this.getIndex(),!1);if(o&&o.isFound)return o}}getQuestionsBySameValueNames(){const e=new Array,t=this.getQuestionData();return!t||!t.isQuestion||(t.parent&&t.parent.isPanel&&this.fillQuestions(t.parent.getQuestionsByValueName(t.getValueName()),t,e),e.length===0&&t.survey&&this.fillQuestions(t.survey.getQuestionsByValueName(t.getValueName()),t,e)),e}fillQuestions(e,t,s){Array.isArray(e)&&e.forEach(i=>{i!==t&&s.push(i)})}getRootObj(){return this.getQuestionData()}},Gu=class extends ji{constructor(e){super(),this.questions=e}isSearchNameRevert(){return!0}updateValueByItem(e,t){const s=e.toLocaleLowerCase(),i=A.expressionVariables.unwrapPostfix;for(let r=0;r<this.questions.length;r++){const a=this.questions[r],o=a.getFilteredName().toLocaleLowerCase();if(o.toLocaleLowerCase()===s){t.isFound=!0,t.context=a.getValueGetterContext(o.endsWith(i));break}}}},Cr=class extends Sy{constructor(e){super(()=>{this.setCallbackResult()}),this.res=!0,this.errorCountValue=0,e||(e={fireCallback:!0}),this.fireCallbackValue=e.fireCallback||!1,this.isOnValueChangedValue=e.isOnValueChanged||!1,this.focusOnFirstErrorValue=e.focusOnFirstError||!1,this.callbackResult=e.callbackResult||null,this.changeCurrentPage=e.changeCurrentPage||!1}get fireCallback(){return this.fireCallbackValue}get isOnValueChanged(){return this.isOnValueChangedValue}get focusOnFirstError(){return this.focusOnFirstErrorValue}get result(){return this.res}get runningResult(){return!this.res||!this.isRunning||!this.callbackResult?this.res:void 0}setErrorElement(e,t){Array.isArray(t)&&this.isWarningOnlyOrEmpty(t)||(this.errorCountValue++,this.res=!1,e&&(e.isQuestion?this.setQuestionError(e):e.isCollapsed&&e.expand()))}isWarningOnlyOrEmpty(e){for(let t=0;t<e.length;t++){const s=e[t];if(s.isError&&s.visible)return!1}return!0}get firstErrorQuestion(){return this.firstErrorQuestionValue}get errorCount(){return this.errorCountValue}setCallbackResult(){this.callbackResult&&!this.isCallbackFired&&(this.isCallbackFired=!0,this.callbackResult(this.res,this.firstErrorQuestion))}setQuestionError(e){if(e.expandAllParents(),!this.firstErrorQuestionValue){if(this.firstErrorQuestionValue=e,this.focusOnFirstError||this.changeCurrentPage)if(this.focusOnFirstError)e.focus(!0);else{const t=e.getSurvey();t&&e.page&&(t.currentPage=e.page)}this.setCallbackResult()}}},Dt=class extends yt{isReadOnlyRenderDiv(){return this.isReadOnly&&A.readOnly.commentRenderMode==="div"}allowMobileInDesignMode(){return!1}updateIsMobileFromSurvey(){this.setIsMobile(this.survey._isMobile)}setIsMobile(e){const t=e&&(this.allowMobileInDesignMode()||!this.isDesignMode);this.isMobile=t}getIsMobile(){return this._isMobile}get isMobile(){return this.getIsMobile()}set isMobile(e){this._isMobile=e}themeChanged(e){}get _isMobile(){return this.getPropertyValue("_isMobile",!1)}set _isMobile(e){this.setPropertyValue("_isMobile",e)}get forceIsInputReadOnly(){return this.getPropertyValue("forceIsInputReadOnly")}set forceIsInputReadOnly(e){this.setPropertyValue("forceIsInputReadOnly",e)}get ariaExpanded(){return this.isNewA11yStructure?null:this.getPropertyValue("ariaExpanded")}set ariaExpanded(e){this.setPropertyValue("ariaExpanded",e)}constructor(e){super(e),this.customWidgetData={isNeedRender:!0},this.hasCssErrorCallback=()=>!1,this.triggersInfo=[],this.isReadyValue=!0,this.dependedQuestions=[],this.onReadyChanged=this.addEvent(),this.isValueChangedInSurvey=!1,this.allowNotifyValueChanged=!0,this._syncPropertiesChanging=!1,this.setPropertyValueDirectly("id","sq_"+this.uniqueId),this.onCreating(),this.createNewArray("validators",t=>{t.errorOwner=this}),this.addExpressionProperty("visibleIf",(t,s)=>{this.visible=s===!0}),this.addExpressionProperty("enableIf",(t,s)=>{this.readOnly=s===!1}),this.addExpressionProperty("requiredIf",(t,s)=>{this.isRequired=s===!0}),this.createLocalizableString("commentText",this,!0,!0),this.createLocalizableString("requiredErrorText"),this.createLocalizableString("commentPlaceholder"),this.createLocalizableString("defaultDisplayValue"),this.addTriggersInfo(),this.registerPropertyChangedHandlers(["width"],()=>{this.updateQuestionCss(),this.parent&&this.parent.elementWidthChanged(this)}),this.registerPropertyChangedHandlers(["isRequired"],()=>{!this.isRequired&&this.errors.length>0&&this.validate(),this.locTitle.strChanged(),this.clearCssClasses()}),this.registerPropertyChangedHandlers(["indent","rightIndent"],()=>{this.resetIndents()}),this.registerPropertyChangedHandlers(["showCommentArea","showOtherItem"],()=>{this.initCommentFromSurvey()}),this.registerPropertyChangedHandlers(["commentPlaceholder"],()=>{this.resetRenderedCommentPlaceholder()}),this.registerFunctionOnPropertiesValueChanged(["no","readOnly","hasVisibleErrors","containsErrors"],()=>{this.updateQuestionCss()}),this.registerPropertyChangedHandlers(["_isMobile"],()=>{this.onMobileChanged()}),this.registerPropertyChangedHandlers(["colSpan"],()=>{var t;(t=this.parent)===null||t===void 0||t.updateColumns()})}getDefaultTitle(){return this.name}createLocTitleProperty(){const e=super.createLocTitleProperty();return e.storeDefaultText=!0,e.onGetTextCallback=(t,s)=>(!t&&!s&&(t=this.getDefaultTitle()),this.survey?this.survey.getUpdatedQuestionTitle(this,t):t),this.locProcessedTitle=new At(this,!0),this.locProcessedTitle.sharedData=e,e}get locRenderedTitle(){return this.isSingleInputActive&&this.singleInputLocTitle?this.singleInputLocTitle:this.locTitle}get commentTextAreaModel(){return this.commentTextAreaModelValue||(this.commentTextAreaModelValue=new $u(this.getCommentTextAreaOptions())),this.commentTextAreaModelValue}getCommentTextAreaOptions(){return{question:this,id:()=>this.commentId,propertyNames:["comment"],className:()=>this.cssClasses.comment,placeholder:()=>this.renderedCommentPlaceholder,isDisabledAttr:()=>this.isInputReadOnly||!1,rows:()=>this.commentAreaRows,autoGrow:()=>this.autoGrowComment,maxLength:()=>this.getOthersMaxLength(),ariaRequired:()=>this.a11y_input_ariaRequired,ariaLabel:()=>this.a11y_input_ariaLabel,getTextValue:()=>this.comment,onTextAreaChange:t=>{this.onCommentChange(t)},onTextAreaInput:t=>{this.onCommentInput(t)}}}getSurvey(e=!1){return e?this.parent?this.parent.getSurvey(e):null:this.onGetSurvey?this.onGetSurvey():super.getSurvey()}getValueName(){return this.valueName?this.valueName.toString():this.name}get valueName(){return this.getPropertyValue("valueName","")}set valueName(e){var t=this.getValueName();this.setPropertyValue("valueName",e),this.onValueNameChanged(t)}onValueNameChanged(e){this.survey&&(this.survey.questionRenamed(this,this.name,e||this.name),this.initDataFromSurvey())}onNameChanged(e){this.locTitle.strChanged(),this.survey&&this.survey.questionRenamed(this,e,this.valueName?this.valueName:e)}get isReady(){return this.isReadyValue}onAsyncRunningChanged(){this.updateIsReady()}ensureQuestionIsReady(){this.displayValue}waitForQuestionIsReady(e){return new Promise(t=>{if(this.ensureQuestionIsReady(),this.isReady)t(),e&&e();else{const s=(i,r)=>{r.isReady&&(this.onReadyChanged.remove(s),t(),e&&e())};this.onReadyChanged.add(s)}})}updateIsReady(){let e=this.getIsQuestionReady();if(e){const t=this.getIsReadyDependsOn();for(let s=0;s<t.length;s++)if(!t[s].getIsQuestionReady()){e=!1;break}}this.setIsReady(e)}getIsQuestionReady(){return!this.isAsyncExpressionRunning&&this.getAreNestedQuestionsReady()}getAreNestedQuestionsReady(){const e=this.getIsReadyNestedQuestions();if(!Array.isArray(e))return!0;for(let t=0;t<e.length;t++)if(!e[t].isReady)return!1;return!0}getIsReadyNestedQuestions(){return this.getNestedQuestions()}setIsReady(e){const t=this.isReadyValue;this.isReadyValue=e,t!=e&&(this.getIsReadyDependends().forEach(s=>s.updateIsReady()),this.onReadyChanged.fire(this,{question:this,isReady:e,oldIsReady:t}))}getIsReadyDependsOn(){return this.getIsReadyDependendCore(!0)}getIsReadyDependends(){return this.getIsReadyDependendCore(!1)}getDependedQuestionsByValueName(e){return this.survey.questionsByValueName(this.getValueName())}getIsReadyDependendCore(e){if(!this.survey)return[];const t=this.getDependedQuestionsByValueName(e),s=new Array;return t.forEach(i=>{i!==this&&s.push(i)}),e||(this.parentQuestion&&s.push(this.parentQuestion),this.dependedQuestions.length>0&&this.dependedQuestions.forEach(i=>s.push(i))),s}choicesLoaded(){}get page(){return this.parentQuestion?this.parentQuestion.page:this.getPage(this.parent)}set page(e){this.setPage(this.parent,e)}getPanels(){return null}getPageVisibleIndex(){var e;return((e=this.page)===null||e===void 0?void 0:e.visibleIndex)||-1}delete(e=!0){this.removeFromParent(),e?this.dispose():this.resetDependedQuestions()}removeFromParent(){this.parent&&this.removeSelfFromList(this.parent.elements)}addDependedQuestion(e){!e||this.dependedQuestions.indexOf(e)>-1||this.dependedQuestions.push(e)}removeDependedQuestion(e){if(e){var t=this.dependedQuestions.indexOf(e);t>-1&&this.dependedQuestions.splice(t,1)}}updateDependedQuestions(){for(var e=0;e<this.dependedQuestions.length;e++)this.dependedQuestions[e].updateDependedQuestion()}updateDependedQuestion(){}resetDependedQuestion(){}get isFlowLayout(){return this.getLayoutType()==="flow"}getLayoutType(){return this.parent?this.parent.getChildrenLayoutType():"row"}isLayoutTypeSupported(e){return e!=="flow"}get visible(){return this.getPropertyValue("visible")}set visible(e){e!=this.visible&&(this.setPropertyValue("visible",e),this.onVisibleChangedCore(),this.notifySurveyVisibilityChanged())}onVisibleChanged(){const e=this.getPropertyValue("isVisible");this.onVisibleChangedCore();const t=this.getPropertyValue("isVisible");e!==void 0&&e!==t&&this.notifySurveyVisibilityChanged()}onVisibleChangedCore(){this.updateIsVisibleProp(),!this.isVisible&&this.errors&&this.errors.length>0&&(this.errors=[])}notifyStateChanged(e){super.notifyStateChanged(e),this.isCollapsed&&this.onHidingContent()}updateElementVisibility(){this.updateIsVisibleProp()}updateIsVisibleProp(){const e=this.getPropertyValue("isVisible"),t=this.isVisible;e!==t&&(this.setPropertyValue("isVisible",t),t||this.onHidingContent()),t!==this.visible&&this.areInvisibleElementsShowing&&this.updateQuestionCss(!0)}get useDisplayValuesInDynamicTexts(){return this.getPropertyValue("useDisplayValuesInDynamicTexts")}set useDisplayValuesInDynamicTexts(e){this.setPropertyValue("useDisplayValuesInDynamicTexts",e)}getUseDisplayValuesInDynamicTexts(){return this.useDisplayValuesInDynamicTexts}get visibleIf(){return this.getPropertyValue("visibleIf","")}set visibleIf(e){this.setPropertyValue("visibleIf",e)}get isVisible(){return this.survey&&this.survey.areEmptyElementsHidden&&this.isEmpty()?!1:this.areInvisibleElementsShowing?!0:this.isVisibleCore()}get isVisibleInSurvey(){return this.isVisible&&this.isParentVisible}isVisibleCore(){return this.visible}get visibleIndex(){return this.getPropertyValue("visibleIndex",-1)}onHidingContent(){}get showNumber(){return this.getPropertyValue("showNumber")}set showNumber(e){this.setPropertyValue("showNumber",e),this.notifySurveyVisibilityChanged()}get hideNumber(){return!this.showNumber}set hideNumber(e){this.showNumber=!e}get isAllowTitleLeft(){return!0}getType(){return"question"}get isQuestion(){return!0}moveTo(e,t=null){return this.moveToBase(this.parent,e,t)}getProgressInfo(){return this.hasInput?{questionCount:1,answeredQuestionCount:this.isEmpty()?0:1,requiredQuestionCount:this.isRequired?1:0,requiredAnsweredQuestionCount:!this.isEmpty()&&this.isRequired?1:0}:super.getProgressInfo()}runTriggerInfo(e,t,s){this.runExpressionByProperty(e.name,s,i=>{e.doComplete(i,s)},i=>e.canRun()?!t||this.canExecuteTriggerByKeys(t,i,this.getExpressionByProperty(e.secondName)):!1)}canExecuteTriggerByKeys(e,t,s){!t&&s&&(t=s,s=void 0);const i=this.canExecuteTriggerByKeysCore(e,t);return i==="var"?!0:s?this.canExecuteTriggerByKeysCore(e,s)!=="":i==="func"||i==="const"}canExecuteTriggerByKeysCore(e,t){if(!t.expression)return"";const s=t.getVariables();return!Array.isArray(s)||s.length===0?t.hasFunction()?"func":"const":new Ii().isAnyKeyChanged(e,s)?"var":""}getValueGetterContext(e){return new io(this,e)}addTriggersInfo(){this.addTriggerInfo({name:"resetValueIf",canRun:()=>!this.isEmpty(),doComplete:(e,t)=>{e===!0&&(this.startSetValueOnExpression(),this.updateValueWithDefaultsOrClear(),this.finishSetValueOnExpression())}}),this.addTriggerInfo({name:"setValueIf",secondName:"setValueExpression",canRun:()=>!0,doComplete:(e,t)=>{if(e)if(!this.setValueExpression)this.clearValue();else{const s={name:"setValueExpression",canRun:()=>!0,doComplete:(i,r)=>this.runExpressionSetValue(i)};this.runTriggerInfo(s,void 0,t)}}}),this.addTriggerInfo({name:"setValueExpression",canRun:()=>!this.setValueIf,doComplete:(e,t)=>this.runExpressionSetValue(e)})}addTriggerInfo(e){this.triggersInfo.push(e)}runTriggers(e,t,s){if(this.isSettingQuestionValue||this.parentQuestion&&this.parentQuestion.getValueName()===e)return;s||(s={},s[e]=t);const i=this.getDataFilteredProperties();this.triggersInfo.forEach(r=>{this.runTriggerInfo(r,s,i)})}runConditions(){this.data&&!this.isLoadingFromJson&&(this.isDesignMode||this.runCondition(this.getDataFilteredProperties()),this.locStrsChanged())}setSurveyImpl(e,t){super.setSurveyImpl(e),this.survey&&(this.survey.questionCreated(this),t!==!0&&this.runConditions(),this.visible||this.updateIsVisibleProp(),this.updateIsMobileFromSurvey())}get parent(){return this.getPropertyValue("parent",null)}set parent(e){this.parent!==e&&(this.removeFromParent(),this.setPropertyValue("parent",e),e&&this.updateQuestionCss(),this.onParentChanged())}onParentChanged(){}calculateSingleInputQuestion(){if(!this.isSingleInputActive)return;const e=this.getSingleInputQuestions();if(Array.isArray(e)&&e.length>0){const t=e[0];return this.onBeforeSetSingleInputQuestion(t),t}}get singleInputQuestion(){const e=this.survey;if(!(!e||!e.isSingleVisibleInput))return this.getPropertyValue("singleInputQuestion",void 0,()=>this.calculateSingleInputQuestion())}get currentSingleInputQuestion(){let e=this.singleInputQuestion;for(;e&&e.singleInputQuestion&&e.singleInputQuestion!==e;)e=e.singleInputQuestion;return e}get currentSingleInputParentQuestion(){const e=this.currentSingleInputQuestion;return e?e.singleInputQuestion===e?e:e.parentQuestion||this:this}get singleInputSummary(){return this.getPropertyValue("singleInputSummary",void 0,()=>{if(!this.supportNestedSingleInput())return;const e=this.singleInputQuestion;if(!e||e!==this)return;const t=this.createSingleInputSummary();return t&&(this.calcSingleInputActions(),this.resetPropertyValue("singleInputLocTitle")),t})}createSingleInputSummary(){}get rootParentQuestion(){let e=this;for(;e.parentQuestion;)e=e.parentQuestion;return e}getParentQuestions(){const e=new Array;let t=this;for(;t.parentQuestion;)e.push(t.parentQuestion),t=t.parentQuestion;return e}resetSingleInput(){this.resetSingleInputCore()}resetSingleInputCore(){const e=this.getPropertyValue("singleInputQuestion");this.resetPropertyValue("singleInputQuestion"),e&&this.onSingleInputChanged()}onSingleInputChanged(e=!0){var t,s;e&&this.resetSingleInputSummary(),(t=this.singleInputLocTitle)===null||t===void 0||t.strChanged(),this.resetPropertyValue("singleInputLocTitle"),this.calcSingleInputActions(),(s=this.survey)===null||s===void 0||s.updateNavigationElements()}resetSingleInputSummary(){var e;(e=this.singleInputSummary)===null||e===void 0||e.dispose(),this.resetPropertyValue("singleInputSummary")}validateSingleInput(){const e=this.currentSingleInputQuestion;return e?e.validate(!0,!0):!0}getSingleInputElementPos(){if(this.singleInputQuestion===this)return 0;const e=this.currentSingleInputParentQuestion;if(e!==this&&e.getSingleInputElementPos()===2)return 2;const t=this.singleInputQuestion,s=this.getSingleInputQuestions();if(s.length<2)return 0;let i=s.indexOf(t);return i===0?-1:i>=s.length-1?1:2}get isSingleInputActive(){const e=this.survey;if(!e||!e.isSingleVisibleInput)return!1;const t=e.currentSingleQuestion;return!!t&&t===this.rootParentQuestion}singleInputOnAddItem(e){this.isSingleInputActive&&(e&&this.singleInputSummary?this.resetSingleInputSummary():this.setSingleQuestionOnChange(Number.MAX_VALUE))}singleInputOnRemoveItem(e){this.isSingleInputActive&&(this.singleInputSummary?this.onSingleInputChanged():this.setSingleQuestionOnChange(e))}getSingleQuestionOnChange(e){return null}setSingleQuestionOnChange(e){const t=this.getSingleQuestionOnChange(e);t?this.setSingleInputQuestion(t):this.resetSingleInput()}onSetAsSingleInput(){this.isSingleInputSummaryShown=!1;const e=!this.wasRendered||this.singleInputSummary;this.onFirstRendering(),e&&(this.resetSingleInputSummary(),this.resetPropertyValue("singleInputQuestion"),this.resetPropertyValue("singleInputLocTitle"))}nextSingleInput(){return this.nextPrevSingleInput(1)}prevSingleInput(){return this.nextPrevSingleInput(-1)}getSingleInputAddText(){const e=this.currentSingleInputQuestion;if(!e)return;if(e.singleInputSummary)return e.getSingleInputAddTextCore();const t=this.getSingleInputQuestions(),s=Array.isArray(t)?t.length:0;if(s>0&&t[s-1]===e)return this.getSingleInputAddTextCore()}singleInputAddItem(e){(!e||this.validateSingleInput())&&this.currentSingleInputQuestion.singleInputAddItemCore()}get singleInputLocTitle(){return this.getPropertyValue("singleInputLocTitle",void 0,()=>this.getSingleQuestionLocTitle())}get singleInputActions(){return this.getPropertyValue("singleInputActions",void 0,()=>this.createSingleInputActions())}get singleInputHasActions(){return this.getPropertyValue("singleInputHasActions",void 0,()=>this.createSingleInputActions())}get singleInputHideHeader(){var e;return!!((e=this.singleInputQuestion)===null||e===void 0?void 0:e.singleInputQuestion)&&this.singleInputQuestion!==this}set singleInputHasActions(e){this.setPropertyValue("singleInputHasActions",e)}get singleInputParentQuestion(){var e;return((e=this.singleInputQuestion)===null||e===void 0?void 0:e.parentQuestion)||this}createSingleInputActions(){var e;if(((e=this.survey)===null||e===void 0?void 0:e.currentSingleQuestion)!==this)return;const t=new _t;return t.actions=this.getSingleQuestionActions(),t}calcSingleInputActions(){if(this.parentQuestion)this.parentQuestion.calcSingleInputActions();else{const e=this.getSingleQuestionActions();this.singleInputActions&&(this.singleInputActions.actions=e),this.singleInputHasActions=e.length>0?!0:void 0}}getSingleQuestionActions(){const e=new Array,t=this.currentSingleInputParentQuestion;if(!t||t===this)return e;const s=t.getSingleInputQuestions(),i=new Array;let r;s.length>1&&s[0]===t&&(r=t,i.push(t));let a=t.parentQuestion;for(;a;)i.push(a),a=a.parentQuestion;for(let o=i.length-1;o>=0;o--){const l=i[o];if(l!==r){const u=l.singleInputLocTitle,d=new Pe({id:"single-action"+l.id,locTitle:u,css:this.cssClasses.breadcrumbsItem,innerCss:this.cssClasses.breadcrumbsItemButton,action:()=>{l.singleInputMoveToFirst()}});d.cssClasses={},e.push(d)}}return e}singleInputMoveToFirst(){const e=this.singleInputQuestion;e&&e!==this&&e.singleInputMoveToFirst(),this.singleInputMoveToFirstCore()}singleInputMoveToFirstCore(){}getSingleQuestionLocTitle(){return this.singleInputSummary?void 0:this.getSingleQuestionLocTitleCore()}getSingleQuestionLocTitleCore(){}supportNestedSingleInput(){var e;return(e=this.survey)===null||e===void 0?void 0:e.supportsNestedSingleInput(this)}getSingleInputQuestions(){if(!this.supportNestedSingleInput())return[];const e=this.getPropertyValue("singleInputQuestion");if(e===this)return[this];const t=this.getSingleInputQuestionsCore(e,!e||!this.isSingleInputSummaryShown);return this.survey&&this.survey.updateNestedSingleQuestions(this,t),t.forEach(s=>{s!==this&&this.onSingleInputQuestionAdded(s)}),t}getSingleInputQuestionsCore(e,t){return this.getNestedQuestions(!0,!1)}onSingleInputQuestionAdded(e){}fillSingleInputQuestionsInContainer(e,t){}getSingleInputQuestionsForDynamic(e,t){const s=new Array;return e&&e!==this&&t.indexOf(e)<0&&this.fillSingleInputQuestionsInContainer(s,e),t.forEach(i=>s.push(i)),this.isSingleInputSummaryShown&&s.length>0&&s.unshift(this),s.push(this),s}getSingleInputAddTextCore(){}singleInputAddItemCore(){}setSingleInputQuestionCore(e){this.onBeforeSetSingleInputQuestion(e),this.setPropertyValue("singleInputQuestion",e)}onBeforeSetSingleInputQuestion(e){e.onFirstRendering(),e===this&&(this.isSingleInputSummaryShown=!0)}setSingleInputQuestion(e,t){this.singleInputQuestion!==e&&(this.setSingleInputQuestionCore(e),this.onSingleInputChanged(!t||e!==this))}nextPrevSingleInput(e){let t=this.currentSingleInputParentQuestion;for(;t&&t!==this;){if(t.nextPrevSingleInput(e))return!0;t=t.parentQuestion}const s=this.singleInputQuestion;if(!s)return!1;const i=this.getSingleInputQuestions();let r=i.indexOf(s);if(r<0){if(i.length===0)return!1;r=0,e=0}return r+=e,r<0||r>=i.length?!1:(this.setSingleInputQuestion(i[r],e<0),!0)}get hasTitle(){return this.getTitleLocation()!=="hidden"&&!this.singleInputHideHeader}get titleLocation(){return this.getPropertyValue("titleLocation")}set titleLocation(e){var t=this.titleLocation=="hidden"||e=="hidden";this.setPropertyValue("titleLocation",e.toLowerCase()),this.updateQuestionCss(),t&&this.notifySurveyVisibilityChanged()}get showTitle(){return this.getTitleLocation()!=="hidden"}set showTitle(e){this.titleLocation=e?"default":"hidden"}getTitleOwner(){return this}getIsTitleRenderedAsString(){return this.titleLocation==="hidden"}notifySurveyOnChildrenVisibilityChanged(){return!1}notifySurveyVisibilityChanged(){if(!this.canUpdateValueOnVisibleChanged())return;this.survey.questionVisibilityChanged(this,this.isVisible,!this.parentQuestion||this.parentQuestion.notifySurveyOnChildrenVisibilityChanged());const e=this.isClearValueOnHidden;this.visible||this.clearValueOnHidding(e),e&&this.isVisibleInSurvey&&this.updateValueWithDefaults()}clearValueOnHidding(e){e&&this.clearValueIfInvisible()}get titleWidth(){if(this.parent&&this.getTitleLocation()==="left"){const e=this.parent.getColumsForElement(this),t=e.length;if(t!==0&&e[0].questionTitleWidth)return e[0].questionTitleWidth;const s=this.getQuestionParentTitleWidth(),i=this.getPercentQuestionTitleWidth(s);if(!i&&this.parent){let r=s;return r&&!isNaN(r)&&(r=r+"px"),r}return i/(t||1)+"%"}}getQuestionParentTitleWidth(){if(!this.parent)return;const e=this.parent.getQuestionTitleWidth();return!e&&this.parentQuestion?this.parentQuestion.getQuestionParentTitleWidth():e}getPercentQuestionTitleWidth(e){if(e&&e[e.length-1]==="%")return parseInt(e)}getTitleLocation(){if(this.isFlowLayout)return"hidden";var e=this.getTitleLocationCore();return e==="left"&&!this.isAllowTitleLeft&&(e="top"),e}getTitleLocationCore(){return this.titleLocation!=="default"?this.titleLocation:this.getParentTitleLocation()}getParentTitleLocation(){return this.parent?this.parent.getQuestionTitleLocation():this.survey?this.survey.questionTitleLocation:"top"}get hasTitleOnLeft(){return this.hasTitle&&this.getTitleLocation()==="left"}get hasTitleOnTop(){return this.hasTitle&&this.getTitleLocation()==="top"}get hasTitleOnBottom(){return this.hasTitle&&this.getTitleLocation()==="bottom"}get hasTitleOnLeftTop(){if(!this.hasTitle)return!1;const e=this.getTitleLocation();return e==="left"||e==="top"}get errorLocation(){return this.getPropertyValue("errorLocation")}set errorLocation(e){this.setPropertyValue("errorLocation",e)}getErrorLocation(){return this.errorLocation!=="default"?this.errorLocation:this.parentQuestion?this.parentQuestion.getChildErrorLocation(this):this.parent?this.parent.getQuestionErrorLocation():this.survey?this.survey.questionErrorLocation:"top"}getChildErrorLocation(e){return this.getErrorLocation()}get hasInput(){return!0}get hasSingleInput(){return this.hasInput&&!this.isContainer}get inputId(){return this.id+"i"}getDefaultTitleValue(){return this.name}getDefaultTitleTagName(){return A.titleTags.question}get descriptionLocation(){return this.getPropertyValue("descriptionLocation")}set descriptionLocation(e){this.setPropertyValue("descriptionLocation",e),this.updateQuestionCss()}get hasDescriptionUnderTitle(){return this.getDescriptionLocation()=="underTitle"&&this.hasDescription}get hasDescriptionUnderInput(){return this.getDescriptionLocation()=="underInput"&&this.hasDescription}getDescriptionLocation(){return this.descriptionLocation!=="default"?this.descriptionLocation:this.survey?this.survey.questionDescriptionLocation:"underTitle"}needClickTitleFunction(){return super.needClickTitleFunction()||this.hasInput}processTitleClick(){if(super.processTitleClick(),!this.isCollapsed)return setTimeout(()=>{this.focus()},1),!0}get requiredErrorText(){return this.getLocalizableStringText("requiredErrorText")}set requiredErrorText(e){this.setLocalizableStringText("requiredErrorText",e)}get locRequiredErrorText(){return this.getLocalizableString("requiredErrorText")}get commentText(){return this.getLocalizableStringText("commentText")}set commentText(e){this.setLocalizableStringText("commentText",e)}get locCommentText(){return this.getLocalizableString("commentText")}get commentPlaceholder(){return this.getLocalizableStringText("commentPlaceholder")}set commentPlaceholder(e){this.setLocalizableStringText("commentPlaceholder",e)}get locCommentPlaceholder(){return this.getLocalizableString("commentPlaceholder")}get commentPlaceHolder(){return this.commentPlaceholder}set commentPlaceHolder(e){this.commentPlaceholder=e}get renderedCommentPlaceholder(){var e;return(e=this.getPropertyValue("renderedCommentPlaceholder"))!==null&&e!==void 0?e:this.isReadOnly?void 0:this.commentPlaceholder}resetRenderedCommentPlaceholder(){this.resetPropertyValue("renderedCommentPlaceholder")}get defaultDisplayValue(){return this.getLocalizableStringText("defaultDisplayValue")}set defaultDisplayValue(e){this.setLocalizableStringText("defaultDisplayValue",e)}get locDefaultDisplayValue(){return this.getLocalizableString("defaultDisplayValue")}getAllErrors(){return this.errors.slice()}getErrorByType(e){for(let t=0;t<this.errors.length;t++)if(this.errors[t].getErrorType()===e)return this.errors[t];return null}get customWidget(){return!this.isCustomWidgetRequested&&!this.customWidgetValue&&(this.isCustomWidgetRequested=!0,this.updateCustomWidget()),this.customWidgetValue}updateCustomWidget(){this.customWidgetValue=so.Instance.getCustomWidget(this)}localeChanged(){super.localeChanged(),this.resetRenderedCommentPlaceholder(),this.localeChangedCallback&&this.localeChangedCallback()}get isCompositeQuestion(){return!1}get isContainer(){return!1}onCommentInput(e){this.isInputTextUpdate&&e.target&&(this.comment=e.target.value)}onCommentChange(e){this.comment=e.target.value,this.comment!==e.target.value&&(e.target.value=this.comment)}afterRenderQuestionElement(e){!this.survey||!this.hasSingleInput||this.survey.afterRenderQuestionInput(this,e)}afterRender(e){this.afterRenderCore(e),this.survey&&(this.survey.afterRenderQuestion(this,e),this.afterRenderQuestionCallback&&this.afterRenderQuestionCallback(this,e),(this.supportComment()||this.supportOther())&&(this.commentElements=[],this.getCommentElementsId().forEach(t=>{const s=e?.querySelector(`#${t}`);s&&this.commentElements.push(s)})),this.checkForResponsiveness(e))}afterRenderCore(e){super.afterRenderCore(e)}getCommentElementsId(){return[this.commentId]}beforeDestroyQuestionElement(e){this.commentElements=void 0}get processedTitle(){var e=this.locProcessedTitle.textOrHtml;return e||this.name}get fullTitle(){return this.locTitle.renderedHtml}get titlePattern(){return this.survey?this.survey.questionTitlePattern:"numTitleRequire"}get isRequireTextOnStart(){return this.isRequired&&this.titlePattern=="requireNumTitle"}get isRequireTextBeforeTitle(){return this.isRequired&&this.titlePattern=="numRequireTitle"&&this.requiredMark!==""}get isRequireTextAfterTitle(){return this.isRequired&&this.titlePattern=="numTitleRequire"&&this.requiredMark!==""}get startWithNewLine(){return this.getPropertyValue("startWithNewLine")}set startWithNewLine(e){this.startWithNewLine!=e&&this.setPropertyValue("startWithNewLine",e)}calcCssClasses(e){const t={error:{}};return this.copyCssClasses(t,e.question),this.copyCssClasses(t.error,e.error),this.updateCssClasses(t,e),t}onCalcCssClasses(e){super.onCalcCssClasses(e),this.survey&&this.survey.updateQuestionCssClasses(this,e),this.onUpdateCssClassesCallback&&this.onUpdateCssClassesCallback(e)}get cssRoot(){return this.ensureElementCss(),this.getPropertyValue("cssRoot","")}setCssRoot(e){this.setPropertyValue("cssRoot",e)}getCssRoot(e){const t=this.hasCssError(!0);return new z().append(super.getCssRoot(e)).append(this.isFlowLayout&&!this.isDesignMode?e.flowRoot:e.mainRoot).append(e.titleLeftRoot,!this.isFlowLayout&&this.hasTitleOnLeft).append(e.titleTopRoot,!this.isFlowLayout&&this.hasTitleOnTop).append(e.titleBottomRoot,!this.isFlowLayout&&this.hasTitleOnBottom).append(e.descriptionUnderInputRoot,!this.isFlowLayout&&this.hasDescriptionUnderInput).append(e.hasError,t).append(e.hasErrorTop,t&&this.getErrorLocation()=="top").append(e.hasErrorBottom,t&&this.getErrorLocation()=="bottom").append(e.small,!this.width).append(e.answered,this.isAnswered).append(e.noPointerEventsMode,this.isReadOnlyAttr).toString()}get cssHeader(){return this.ensureElementCss(),this.getPropertyValue("cssHeader","")}setCssHeader(e){this.setPropertyValue("cssHeader",e)}getCssHeader(e){return new z().append(e.header).append(e.headerTop,this.hasTitleOnTop).append(e.headerLeft,this.hasTitleOnLeft).append(e.headerBottom,this.hasTitleOnBottom).toString()}supportContainerQueries(){return!1}get cssContent(){return this.ensureElementCss(),this.getPropertyValue("cssContent","")}setCssContent(e){this.setPropertyValue("cssContent",e)}getCssContent(e){return new z().append(e.content).append(e.contentSupportContainerQueries,this.supportContainerQueries()).append(e.contentLeft,this.hasTitleOnLeft).toString()}get cssTitle(){return this.ensureElementCss(),this.getPropertyValue("cssTitle","")}setCssTitle(e){this.setPropertyValue("cssTitle",e)}getCssTitle(e){return new z().append(super.getCssTitle(e)).append(e.singleInputTitle,!!this.singleInputQuestion).append(e.titleOnAnswer,!this.containsErrors&&this.isAnswered).append(e.titleEmpty,!this.title.trim()).toString()}get cssDescription(){return this.ensureElementCss(),this.getPropertyValue("cssDescription","")}setCssDescription(e){this.setPropertyValue("cssDescription",e)}getCssDescription(e){return new z().append(e.description).append(e.descriptionUnderInput,this.getDescriptionLocation()=="underInput").toString()}get showErrorsAboveQuestion(){return this.getErrorLocation()==="top"}get showErrorsBelowQuestion(){return this.getErrorLocation()==="bottom"}get cssError(){return this.ensureElementCss(),this.getPropertyValue("cssError","")}setCssError(e){this.setPropertyValue("cssError",e)}getCssError(e){return new z().append(e.error.root).append(e.error.warningMode,this.currentNotificationType==="warning").append(e.error.infoMode,this.currentNotificationType==="info").append(e.errorsContainer).append(e.errorsContainerTop,this.showErrorsAboveQuestion).append(e.errorsContainerBottom,this.showErrorsBelowQuestion).toString()}hasCssError(e){const t=this.errors;for(let s=0;s<t.length;s++){const i=t[s];if(i.visible&&(e||i.isError))return!0}return this.hasCssErrorCallback()}updateVisibleErrors(){super.updateVisibleErrors(),this.updateQuestionCss()}get isSingleInputQuestionMode(){var e;return!!this.parentQuestion&&((e=this.survey)===null||e===void 0?void 0:e.isSingleVisibleInput)}getIsNested(){return this.isSingleInputQuestionMode?!1:super.getIsNested()}getHasFrameV2(){return this.isSingleInputQuestionMode?!0:super.getHasFrameV2()}getRootCss(){return new z().append(this.cssRoot,!this.singleInputQuestion).append(this.cssClasses.mobile,this.isMobile).append(this.cssClasses.readOnly,this.isReadOnlyStyle).append(this.cssClasses.disabled,this.isDisabledStyle).append(this.cssClasses.preview,this.isPreviewStyle).append(this.cssClasses.invisible,!this.isDesignMode&&this.areInvisibleElementsShowing&&!this.visible).toString()}getQuestionRootCss(){return new z().append(this.cssClasses.root).append(this.cssClasses.rootMobile,this.isMobile).toString()}updateElementCss(e){this.wasRendered?(super.updateElementCss(e),e&&this.updateQuestionCss(!0)):this.clearCssClasses(),this.resetIndents()}updateQuestionCss(e){this.isLoadingFromJson||!this.survey||(this.wasRendered?this.updateElementCssCore(this.cssClasses):this.isRequireUpdateElements=!0)}ensureElementCss(){this.cssClassesValue||this.updateQuestionCss(!0)}updateElementCssCore(e){this.setCssRoot(this.getCssRoot(e)),this.setCssHeader(this.getCssHeader(e)),this.setCssContent(this.getCssContent(e)),this.setCssTitle(this.getCssTitle(e)),this.setCssDescription(this.getCssDescription(e)),this.setCssError(this.getCssError(e))}updateCssClasses(e,t){if(!t.question)return;const s=t[this.getCssType()],i=new z().append(e.title).append(t.question.titleRequired,this.isRequired);e.title=i.toString();const r=new z().append(e.root).append(s,this.isRequired&&!!t.question.required);if(s==null)e.root=r.toString();else if(typeof s=="string"||s instanceof String)e.root=r.append(s.toString()).toString();else{e.root=r.toString();for(const a in s)e[a]=s[a]}}getCssType(){return this.getType()}get renderCssRoot(){return this.cssClasses.root||void 0}calcPaddingLeft(){return this.getIndentSize(this.indent)}calcPaddingRight(){return this.getIndentSize(this.rightIndent)}getIndentSize(e){return e<1||!this.getSurvey()||!this.cssClasses||!this.cssClasses.indent?"":e*this.cssClasses.indent+"px"}focus(e=!1,t){if(this.isDesignMode||!this.isVisible||this.isReadOnly||!this.survey)return;let s=this.page;const i=!!s&&this.survey.activePage!==s,r=this.survey.isSingleVisibleInput;if(i&&!r)this.survey.focusQuestionByInstance(this,e);else if(r){this.survey.currentSingleQuestion=this.rootParentQuestion;const a=this.getParentQuestions();for(let o=a.length-1;o>=1;o--)o===a.length-1&&a[o].setSingleInputQuestion(a[o-1]);a.length>0&&a[0].setSingleInputQuestion(this),this.focusInputElement(e)}else{this.expandAllParents();const a=this.survey.isSmoothScrollEnabled?{behavior:"smooth"}:void 0;this.survey.scrollElementToTop(this,this,null,this.id,t,a,void 0,()=>{this.focusInputElement(e)})}}focusInputElement(e){var t;const s=e?this.getFirstErrorInputElementId():this.getFirstInputElementId(),i=(t=this.survey)===null||t===void 0?void 0:t.rootElement;(yt.FocusElement(s,!1,i)||this.customWidget)&&this.fireCallback(this.focusCallback)}get isValidateVisitedEmptyFields(){return this.supportEmptyValidation()&&!!this.survey&&this.survey.getValidateVisitedEmptyFields()&&this.isEmpty()}supportEmptyValidation(){return!1}onBlur(e){this.onBlurCore(e)}onFocus(e){this.onFocusCore(e)}onBlurCore(e){this.isFocusEmpty&&this.isEmpty()&&this.validate(!0)}onFocusCore(e){this.isFocusEmpty=this.isValidateVisitedEmptyFields}expandAllParents(){this.expandAllParentsCore(this)}expandAllParentsCore(e){e&&(e.isCollapsed&&e.expand(),this.expandAllParentsCore(e.parent),this.expandAllParentsCore(e.parentQuestion))}focusIn(){!this.survey||this.isDisposed||this.isContainer||this.survey.whenQuestionFocusIn(this)}fireCallback(e){e&&e()}getOthersMaxLength(){return this.survey&&this.survey.maxCommentLength>0?this.survey.maxCommentLength:null}onCreating(){}getFirstQuestionToFocus(e){return this.hasInput&&(!e||this.currentErrorCount>0)?this:null}getFirstInputElementId(){return this.inputId}getFirstErrorInputElementId(){return this.getFirstInputElementId()}supportComment(){const e=this.getPropertyByName("showCommentArea");return!e||e.visible}supportOther(){return!1}get isRequired(){return this.getPropertyValue("isRequired")}set isRequired(e){this.setPropertyValue("isRequired",e)}get requiredIf(){return this.getPropertyValue("requiredIf","")}set requiredIf(e){this.setPropertyValue("requiredIf",e)}get showCommentArea(){return this.getPropertyValue("showCommentArea",!1)}set showCommentArea(e){this.supportComment()&&this.setPropertyValue("showCommentArea",e)}get hasComment(){return this.showCommentArea}set hasComment(e){this.showCommentArea=e}get id(){return this.getPropertyValue("id")}set id(e){this.setPropertyValue("id",e)}get ariaTitleId(){return this.id+"_ariaTitle"}get ariaDescriptionId(){return this.id+"_ariaDescription"}get commentId(){return this.id+"_comment"}get requireUpdateCommentValue(){return this.showCommentArea}get isReadOnly(){const e=!!this.parent&&this.parent.isReadOnly,t=!!this.parentQuestion&&this.parentQuestion.isReadOnly,s=!!this.survey&&this.survey.isDisplayMode,i=!!this.readOnlyCallback&&this.readOnlyCallback();return this.readOnly||e||s||t||i}get isInputReadOnly(){return this.forceIsInputReadOnly!==void 0?this.forceIsInputReadOnly:this.isReadOnly||this.isDesignMode}get renderedInputReadOnly(){return this.isInputReadOnly?"":void 0}get renderedInputDisabled(){return this.isInputReadOnly?"":void 0}get isReadOnlyAttr(){return this.isReadOnly}get isDisabledAttr(){return this.isDesignMode||!!this.readOnlyCallback&&this.readOnlyCallback()}onReadOnlyChanged(){this.setPropertyValue("isInputReadOnly",this.isInputReadOnly),super.onReadOnlyChanged(),this.isReadOnly&&this.clearErrors(),this.updateQuestionCss(),this.resetRenderedCommentPlaceholder()}get enableIf(){return this.getPropertyValue("enableIf","")}set enableIf(e){this.setPropertyValue("enableIf",e)}surveyChoiceItemVisibilityChange(){}runCondition(e){this.isDesignMode||(e||(e={}),e.question=this,this.runConditionCore(e),!this.isValueChangedDirectly&&(!this.isClearValueOnHidden||this.isVisibleInSurvey)&&this.runDefaultValueExpression(e))}get isInDesignMode(){return!this.isContentElement&&this.isDesignMode}get no(){return this.getPropertyValue("no",void 0,()=>this.calcNo())}calcNo(){let e="";const t=this.hasTitle&&this.showNumber&&this.visibleIndex>=0;return t&&(e=O.getNumberByIndex(this.visibleIndex,this.getStartIndex())),this.onGetNoCallback&&(e=this.onGetNoCallback(e)),t&&(this.parent&&(e=this.parent.addNoFromChild(e)),this.survey&&(e=this.survey.getUpdatedQuestionNo(this,e))),e}onSurveyLoad(){this.isCustomWidgetRequested=!1,this.fireCallback(this.surveyLoadCallback),this.updateValueWithDefaults(),this.isEmpty()&&this.initDataFromSurvey()}onSetData(){super.onSetData(),!this.isDesignMode&&this.survey&&!this.isLoadingFromJson&&(this.initDataFromSurvey(),this.onSurveyValueChanged(this.value),this.updateValueWithDefaults(),this.updateIsAnswered())}initDataFromSurvey(){if(this.data){const e=this.data.getValue(this.getValueName());(!O.isValueEmpty(e)||!this.isLoadingFromJson)&&this.updateValueFromSurvey(e),this.initCommentFromSurvey()}}initCommentFromSurvey(){this.data&&this.requireUpdateCommentValue?this.updateCommentFromSurvey(this.data.getComment(this.getValueName())):this.updateCommentFromSurvey("")}runExpression(e){if(!(!this.survey||!e))return this.survey.runExpression(e)}get commentAreaRows(){return this.survey&&this.survey.commentAreaRows}get autoGrowComment(){return this.survey&&this.survey.autoGrowComment}get allowResizeComment(){return this.survey&&this.survey.allowResizeComment}get questionValue(){return this.getPropertyValueWithoutDefault("value")}set questionValue(e){this.setPropertyValue("value",e)}get questionComment(){return this.getPropertyValueWithoutDefault("comment")}set questionComment(e){this.setPropertyValue("comment",e),this.fireCallback(this.commentChangedCallback)}get isValueArray(){return!1}get value(){return this.getValueCore()}set value(e){this.setNewValue(e)}getStructuredValue(e=-1){return this.value}get hasFilteredValue(){return!1}getFilteredValue(e){return this.value}getFilteredName(){return this.getValueName()}get valueForSurvey(){return this.valueForSurveyCore(this.value)}valueForSurveyCore(e){return this.valueToDataCallback?this.valueToDataCallback(e):e}valueFromDataCore(e){return this.valueFromDataCallback?this.valueFromDataCallback(e):e}clearValue(e,t){this.value!==void 0&&(this.value=void 0),this.comment&&e!==!0&&(this.comment=void 0),this.setValueChangedDirectly(t===!0)}clearValueFromUI(){this.clearValue(!0,!0)}clearValueOnly(){this.clearValue(!0)}unbindValue(){this.clearValue()}createValueCopy(){return this.getUnbindValue(this.value)}initDataUI(){}getUnbindValue(e){return this.isValueSurveyElement(e)?e:O.getUnbindValue(e)}isValueSurveyElement(e){return e?Array.isArray(e)?e.length>0?this.isValueSurveyElement(e[0]):!1:e.isSurveyObj===!0:!1}canClearValueAsInvisible(e){return e==="onHiddenContainer"&&!this.isParentVisible?!0:this.isVisibleInSurvey||this.page&&this.page.isStartPage?!1:this.survey?!this.survey.hasVisibleQuestionByValueName(this):!0}get isParentVisible(){if(this.parentQuestion&&!this.parentQuestion.isVisible)return!1;for(var e=this.parent;e;){if(!e.isVisible)return!1;e=e.parent}return!0}clearValueIfInvisible(e="onHidden"){const t=this.getClearIfInvisible();t!=="none"&&(e==="onHidden"&&t==="onComplete"||e==="onHiddenContainer"&&t!==e||this.clearValueIfInvisibleCore(e))}clearValueIfInvisibleCore(e){this.canClearValueAsInvisible(e)&&this.clearValue()}get clearIfInvisible(){return this.getPropertyValue("clearIfInvisible")}set clearIfInvisible(e){this.setPropertyValue("clearIfInvisible",e)}getClearIfInvisible(){const e=this.clearIfInvisible;return this.survey?this.survey.getQuestionClearIfInvisible(e):e!=="default"?e:"onComplete"}get displayValue(){return this.isLoadingFromJson?"":this.getDisplayValue(!0)}getDisplayValue(e,t=void 0){var s=this.calcDisplayValue(e,t);return this.survey&&(s=this.survey.getQuestionDisplayValue(this,s)),this.displayValueCallback?this.displayValueCallback(s):s}calcDisplayValue(e,t=void 0){if(this.customWidget){var s=this.customWidget.getDisplayValue(this,t);if(s)return s}return t=t??this.createValueCopy(),this.isValueEmpty(t)&&!this.locDefaultDisplayValue.isEmpty&&(t=this.defaultDisplayValue),this.isValueEmpty(t,!this.allowSpaceAsAnswer)?this.getDisplayValueEmpty():this.getDisplayValueCore(e,t)}getDisplayValueCore(e,t){return t}getDisplayValueEmpty(){return""}get defaultValue(){return this.getPropertyValue("defaultValue")}set defaultValue(e){if(this.isValueExpression(e)){this.defaultValueExpression=e.substring(1);return}this.setPropertyValue("defaultValue",this.valueToData(e)),this.updateValueWithDefaults()}get defaultValueExpression(){return this.getPropertyValue("defaultValueExpression")}set defaultValueExpression(e){this.setPropertyValue("defaultValueExpression",e),this.defaultValueRunner=void 0,this.updateValueWithDefaults()}get resetValueIf(){return this.getPropertyValue("resetValueIf")}set resetValueIf(e){this.setPropertyValue("resetValueIf",e)}get setValueIf(){return this.getPropertyValue("setValueIf")}set setValueIf(e){this.setPropertyValue("setValueIf",e)}get setValueExpression(){return this.getPropertyValue("setValueExpression")}set setValueExpression(e){this.setPropertyValue("setValueExpression",e)}get resizeStyle(){return this.allowResizeComment?"both":"none"}getPlainData(e){if(e||(e={includeEmpty:!0,includeQuestionTypes:!1}),e.includeEmpty||!this.isEmpty()){var t={name:this.name,title:this.locTitle.renderedHtml,value:this.value,displayValue:this.displayValue,isNode:!1,getString:s=>typeof s=="object"?JSON.stringify(s):s};return e.includeQuestionTypes===!0&&(t.questionType=this.getType()),(e.calculations||[]).forEach(s=>{t[s.propertyName]=this.getPlainDataCalculatedValue(s.propertyName)}),this.showCommentArea&&(t.isNode=!0,t.data=[{name:0,isComment:!0,title:"Comment",value:A.commentSuffix,displayValue:this.comment,getString:s=>typeof s=="object"?JSON.stringify(s):s,isNode:!1}]),t}}getPlainDataCalculatedValue(e){return this[e]}get correctAnswer(){return this.getPropertyValue("correctAnswer")}set correctAnswer(e){this.setPropertyValue("correctAnswer",this.valueToData(e))}get quizQuestionCount(){return this.isVisible&&this.hasInput&&!this.isValueEmpty(this.correctAnswer)?this.getQuizQuestionCount():0}get correctAnswerCount(){return!this.isEmpty()&&!this.isValueEmpty(this.correctAnswer)?this.getCorrectAnswerCount():0}getQuizQuestionCount(){return 1}getCorrectAnswerCount(){return this.checkIfAnswerCorrect()?1:0}checkIfAnswerCorrect(){const e=O.isTwoValueEquals(this.value,this.correctAnswer,this.getAnswerCorrectIgnoreOrder(),A.comparator.caseSensitive,!0),t=e?1:0,s=this.quizQuestionCount-t,i={result:e,correctAnswers:t,correctAnswerCount:t,incorrectAnswers:s,incorrectAnswerCount:s};return this.survey&&this.survey.onCorrectQuestionAnswer(this,i),i.result}getAnswerCorrectIgnoreOrder(){return!1}isAnswerCorrect(){return this.correctAnswerCount==this.quizQuestionCount}updateValueWithDefaults(){if(this.isLoadingFromJson||!this.isDesignMode&&this.isDefaultValueEmpty())return;const e=this.isEmpty();!this.isDesignMode&&!e||e&&this.isDefaultValueEmpty()||this.isClearValueOnHidden&&!this.isVisible||this.isDesignMode&&this.isContentElement&&this.isDefaultValueEmpty()||this.setDefaultValue()}get isValueDefault(){return!this.isEmpty()&&(this.isTwoValueEquals(this.defaultValue,this.value)||!this.isValueChangedDirectly&&!!this.defaultValueExpression)}get isClearValueOnHidden(){const e=this.getClearIfInvisible();return e==="none"||e==="onComplete"?!1:e==="onHidden"||e==="onHiddenContainer"}getQuestionFromArray(e,t){return null}getDefaultValue(){return this.defaultValue}isDefaultValueEmpty(){return!this.defaultValueExpression&&this.isValueEmpty(this.defaultValue,!this.allowSpaceAsAnswer)}setDefaultValue(){this.setDefaultValueCore(e=>{e=this.convertToCorrectValue(e),this.isTwoValueEquals(this.value,e)||this.setDefaultIntoValue(e)})}setDefaultIntoValue(e){this.value=e}setDefaultValueCore(e){const t=s=>{this.runExpressionSetValueCore(s,e)};this.runDefaultValueExpression(void 0,t)||t(this.getUnbindValue(this.defaultValue))}updateValueWithDefaultsOrClear(){this.isDesignMode||this.isLoadingFromJson||(this.isDefaultValueEmpty()?this.clearValue():this.setDefaultValue())}isValueExpression(e){return!!e&&typeof e=="string"&&e.length>0&&e[0]=="="}convertFuncValuetoQuestionValue(e){return O.convertValToQuestionVal(e)}runExpressionSetValueCore(e,t){t(this.convertFuncValuetoQuestionValue(e))}runExpressionSetValue(e){this.runExpressionSetValueCore(e,t=>{this.isTwoValueEquals(this.value,t)||(this.startSetValueOnExpression(),this.value=t,this.finishSetValueOnExpression())})}startSetValueOnExpression(){var e;(e=this.survey)===null||e===void 0||e.startSetValueOnExpression()}finishSetValueOnExpression(){var e;(e=this.survey)===null||e===void 0||e.finishSetValueOnExpression()}runDefaultValueExpression(e=null,t){return this.data?(t||(t=s=>{this.runExpressionSetValue(s)}),e||(e=this.defaultValueExpression?this.data.getFilteredProperties():{},e.question=this),this.runExpressionByProperty("defaultValueExpression",e,s=>{s==null&&(s=this.defaultValue),this.isChangingViaDefaultValue=!0,t(s),this.isChangingViaDefaultValue=!1})):!1}get comment(){return this.getQuestionComment()}set comment(e){if(e&&e!==this.comment){const t=e.toString().trim();t!==e&&(e=t,e===this.comment&&this.setPropertyValueDirectly("comment",e))}this.comment!=e&&this.setNewComment(e)}getCommentAreaCss(e=!1){return new z().append("form-group",e).append(this.cssClasses.formGroup,!e).append(this.cssClasses.commentArea).append(this.cssClasses.otherArea,e).toString()}getQuestionComment(){return this.questionComment}isEmpty(){return this.isValueEmpty(this.value,!this.allowSpaceAsAnswer)}get isAnswered(){return this.getPropertyValue("isAnswered")||!1}set isAnswered(e){this.setPropertyValue("isAnswered",e)}updateIsAnswered(){const e=this.isAnswered;this.setPropertyValue("isAnswered",this.getIsAnswered()),e!==this.isAnswered&&this.updateQuestionCss()}getIsAnswered(){return!this.isEmpty()}get validators(){return this.getPropertyValue("validators")}set validators(e){this.setPropertyValue("validators",e)}getValidators(){return this.validators}getSupportedValidators(){const e=[];let t=this.getType();for(;t;){const s=A.supportedValidators[t];if(s)for(let r=s.length-1;r>=0;r--)e.splice(0,0,s[r]);t=q.findClass(t).parentName}return e}addConditionObjectsByContext(e,t){e.push({name:this.getFilteredName(),text:this.processedTitle,question:this})}getNestedQuestions(e=!1,t=!0,s=!1){const i=[];return this.collectNestedQuestions(i,e,t,s),!s&&i.length===1&&i[0]===this?[]:i}collectNestedQuestions(e,t=!1,s=!0,i=!1){t&&!this.isVisible||this.collectNestedQuestionsCore(e,t,s,i)}collectNestedQuestionsCore(e,t,s,i){e.push(this)}addNestedQuestion(e,t,s,i){s?this.collectNestedQuestions(e,t,s,i):(!t||this.isVisible)&&e.push(this)}getConditionJson(e=null,t=null){const s=new qt().toJsonObject(this);return s.type=this.getType(),s}hasErrors(e=!0,t=!1){return!this.validateCore(e,!1,t)}validate(e=!0,t=!1,s=!1,i){return this.validateCore(e,!0,t,s,i)}validateCore(e,t,s=!1,i=!1,r){t&&i&&this.parent&&this.parent.validateContainerOnly();const a=new Cr({isOnValueChanged:i,focusOnFirstError:s,fireCallback:e,callbackResult:r});return this.validateElement(a),a.finish(),a.runningResult}validateElement(e){return this.validateElementCore(e)}validateElementCore(e){const t=this.checkForErrors(e);return e.fireCallback&&(this.errors=t,this.errors!==t&&this.errors.forEach(s=>s.locText.strChanged())),e.setErrorElement(this,t),this.updateContainsErrors(),this.isCollapsed&&e.fireCallback&&t.length>0&&this.expand(),t.length===0}get currentErrorCount(){return this.errors.length}get requiredMark(){return this.survey!=null&&this.isRequired?this.survey.requiredMark:""}get requiredText(){return this.requiredMark}addError(e){if(!e)return;let t=null;typeof e=="string"||e instanceof String?t=this.addCustomError(e):t=e,this.errors.push(t)}addCustomError(e){return new vs(e,this.survey)}removeError(e){if(!e)return!1;const t=this.errors,s=t.indexOf(e);return s!==-1&&t.splice(s,1),s!==-1}checkForErrors(e){var t=new Array;if(this.isVisible&&this.canCollectErrors()&&this.collectErrors(t,e),this.survey){if(this.validateValueCallback&&t.length===0){const s=this.validateValueCallback();s&&t.push(s)}this.survey.validateQuestion(this,t,e.fireCallback)}return t}canCollectErrors(){return!this.isReadOnly||A.readOnly.enableValidation}collectErrors(e,t){if(this.onCheckForErrors(e,t.isOnValueChanged,t.fireCallback),e.length>0||!this.canRunValidators(t.isOnValueChanged))return;const s=this.runValidators(t);if(s.length>0){e.length=0;for(var i=0;i<s.length;i++)e.push(s[i])}}canRunValidators(e){return!0}onCheckForErrors(e,t,s){if((!t||this.isOldAnswered)&&this.hasRequiredError()){const i=new aP(this.requiredErrorText,this);i.onUpdateErrorTextCallback=r=>{r.text=this.requiredErrorText},e.push(i)}if(!this.isEmpty()&&this.customWidget){const i=this.customWidget.validate(this);i&&e.push(this.addCustomError(i))}}hasRequiredError(){return this.isRequired&&this.isEmpty()}get isRunningValidators(){return this.getIsRunningValidators()}getIsRunningValidators(){return!!this.validatorRunner}runValidators(e){return this.validatorRunner&&(this.validatorRunner.onAsyncCompleted=null),this.validatorRunner=new fP,this.validatorRunner.onAsyncCompleted=t=>{this.doOnAsyncCompleted(e.fireCallback,t),e.setErrorElement(this,t),e.removeElement(this.id)},e.addElement(this.id),this.validatorRunner.run(this)}doOnAsyncCompleted(e,t){e&&t.forEach(s=>{this.errors.indexOf(s)<0&&this.errors.push(s)}),this.validatorRunner=null}setNewValue(e){if(this.survey&&(e=this.survey.questionValueChanging(this,e)),this.isNewValueEqualsToValue(e)||!this.checkIsValueCorrect(e))return;const t=this.getUnbindValue(this.value);this.isOldAnswered=this.isAnswered,this.isSettingQuestionValue=!0,this.setNewValueInData(e),this.allowNotifyValueChanged&&this.onValueChanged(),this.isSettingQuestionValue=!1,this.isAnswered!==this.isOldAnswered&&this.updateQuestionCss(),this.isOldAnswered=void 0,this.parent&&this.parent.onQuestionValueChanged(this),this.survey&&this.survey.questionValueChanged(this,t)}getValueChangingOptions(e){}checkIsValueCorrect(e){const t=this.isValueEmpty(e,!this.allowSpaceAsAnswer)||this.isNewValueCorrect(e);return t||ri.inCorrectQuestionValue(this.name,e),t}isNewValueCorrect(e){return!0}isNewValueEqualsToValue(e){const t=this.value;return this.isTwoValueEquals(e,t,!1,!1)?!(e===t&&!!t&&(Array.isArray(t)||typeof t=="object")):!1}isTextValue(){return!1}getIsInputTextUpdate(){return this.survey?this.survey.isUpdateValueTextOnTyping:!1}get requireStrictCompare(){return!1}getExpressionValue(e){return e}getDataLocNotification(){return this.isInputTextUpdate?"text":!1}get isInputTextUpdate(){return this.getIsInputTextUpdate()&&this.isTextValue()}setNewValueInData(e){e=this.valueToData(e),this.isValueChangedInSurvey||this.setValueCore(e)}getValueCore(){return this.questionValue}setValueCore(e){this.setQuestionValue(e),this.data!=null&&this.canSetValueToSurvey()&&(e=this.valueForSurvey,this.data.setValue(this.getValueName(),e,this.getDataLocNotification(),this.allowNotifyValueChanged,this.name)),this.isMouseDown=!1}canSetValueToSurvey(){return!0}valueFromData(e){return e}valueToData(e){return e}convertToCorrectValue(e){return e}onValueChanged(){}onMouseDown(){this.isMouseDown=!0}setNewComment(e){this.questionComment!==e&&(this.questionComment=e,this.setCommentIntoData(e))}setCommentIntoData(e){this.data!=null&&this.data.setComment(this.getValueName(),e,this.getIsInputTextUpdate()?"text":!1)}getValidName(e){return Ju(super.getValidName(e))}updateValueFromSurvey(e,t=!1){if(e=this.getUnbindValue(e),e=this.valueFromDataCore(e),!this.checkIsValueCorrect(e))return;const s=this.isValueEmpty(e);this.isUpdateingValueFromSurvey=!0,!s&&this.defaultValueExpression?this.setDefaultValueCore(i=>{this.updateValueFromSurveyCore(e,this.isTwoValueEquals(e,i))}):(this.updateValueFromSurveyCore(e,this.data!==this.getSurvey()),t&&s&&(this.isValueChangedDirectly=!1),s&&this.updateBindingsOnClearFromSurveyCore()),this.isUpdateingValueFromSurvey=!1,this.updateDependedQuestions(),this.updateIsAnswered()}canUpdateBindings(){return!this.isUpdateingValueFromSurvey}updateBindingsOnClearFromSurveyCore(){const e=this.data;e&&!this.isBindingEmpty()&&this.bindings.getNames().forEach(t=>{const s=this.bindings.getValueNameByPropertyName(t),i=e.getValue(s);this.isValueEmpty(i)||this.updateBindingProp(t,i)})}updateValueFromSurveyCore(e,t){this.isChangingViaDefaultValue=t,e=this.valueFromData(e);const s=this.isTwoValueEquals(this.questionValue,this.convertToCorrectValue(e));this.setQuestionValue(e),s||this.resetSingleInput(),this.isChangingViaDefaultValue=!1}updateCommentFromSurvey(e){this.questionComment=e}onChangeQuestionValue(e){}setValueChangedDirectly(e){this.isValueChangedDirectly=e,this.setValueChangedDirectlyCallback&&this.setValueChangedDirectlyCallback(e)}setQuestionValue(e,t=!0){e=this.convertToCorrectValue(e);const s=this.isTwoValueEquals(this.questionValue,e);!s&&!this.isChangingViaDefaultValue&&!this.isParentChangingViaDefaultValue&&this.setValueChangedDirectly(!0),this.questionValue=e,s||this.onChangeQuestionValue(e),!s&&this.allowNotifyValueChanged&&this.fireCallback(this.valueChangedCallback),t&&this.updateIsAnswered()}get isParentChangingViaDefaultValue(){var e;return((e=this.data)===null||e===void 0?void 0:e.isChangingViaDefaultValue)===!0}onSurveyValueChanged(e){}setVisibleIndex(e){return this.isVisibleIndexNegative(e)&&(e=-1),this.setPropertyValue("visibleIndex",e),this.resetPropertyValue("no"),e<0?0:1}isVisibleIndexNegative(e){return e<0||!this.isVisible||!this.hasTitle&&!A.numbering.includeQuestionsWithHiddenTitle||!this.showNumber&&!A.numbering.includeQuestionsWithHiddenNumber}removeElement(e){return!1}supportGoNextPageAutomatic(){return this.supportAutoAdvance()}supportAutoAdvance(){return!1}supportGoNextPageError(){return!0}clearIncorrectValues(){}clearOnDeletingContainer(){}clearErrors(){this.errors=[]}clearUnusedValues(){}onAnyValueChanged(e,t){}checkBindings(e,t){if(!(this.bindings.isEmpty()||!this.data))for(var s=this.bindings.getPropertiesByValueName(e),i=0;i<s.length;i++){const r=s[i];this.isValueEmpty(t)&&O.isNumber(this[r])&&(t=0),this.updateBindingProp(r,t)}}updateBindingProp(e,t){this[e]=t}getComponentName(){return ai.Instance.getRendererByQuestion(this)}isDefaultRendering(){return!!this.customWidget||this.getComponentName()==="default"}get renderAs(){return this.getPropertyValue("renderAs")}set renderAs(e){this.setPropertyValue("renderAs",e)}get inMatrixMode(){return this.getPropertyValue("inMatrixMode",!1)}set inMatrixMode(e){this.setPropertyValue("inMatrixMode",e)}getErrorCustomText(e,t){return this.survey?this.survey.getSurveyErrorCustomText(this,e,t):e}getValidatorTitle(){return null}get validatedValue(){return this.value}set validatedValue(e){this.value=e}getAllValues(){return this.data?this.data.getAllValues():null}processPopupVisiblilityChanged(e,t){this.survey.processPopupVisiblityChanged(this,e,t)}processOpenDropdownMenu(e){this.survey.processOpenDropdownMenu(this,e)}onTextKeyDownHandler(e){e.keyCode===13&&this.survey.questionEditFinishCallback(this,e)}transformToMobileView(){}transformToDesktopView(){}needResponsiveWidth(){return!1}supportResponsiveness(){return!1}needResponsiveness(){return this.supportResponsiveness()&&!this.isDesignMode}checkForResponsiveness(e){if(this.needResponsiveness())if(this.isCollapsed){const t=()=>{this.isExpanded&&(this.initResponsiveness(e),this.unregisterPropertyChangedHandlers(["state"],"for-responsiveness"))};this.registerPropertyChangedHandlers(["state"],t,"for-responsiveness")}else this.initResponsiveness(e)}getObservedElementSelector(){return".sd-scrollable-container"}onMobileChanged(){this.onMobileChangedCallback&&this.onMobileChangedCallback()}triggerResponsiveness(e=!0){this.triggerResponsivenessCallback&&this.triggerResponsivenessCallback(e)}initResponsiveness(e){if(ge.isAvailable()&&(this.destroyResizeObserver(),e&&this.isDefaultRendering())){const t=this.getObservedElementSelector();if(!t||!e.querySelector(t))return;let i=!1,r;this.triggerResponsivenessCallback=a=>{a&&(r=void 0,this.renderAs="default",i=!1);const o=()=>{const l=e.querySelector(t);if(this.isDefaultRendering()&&(r=l.scrollWidth),i||!Wu(l))i=!1;else{const u=Uu(l);i=this.processResponsiveness(r,u)}};a?setTimeout(o,1):o()},this.resizeObserver=new ResizeObserver(a=>{we.requestAnimationFrame(()=>{this.triggerResponsiveness(!1)})}),this.onMobileChangedCallback=()=>{setTimeout(()=>{const a=e.querySelector(t);this.processResponsiveness(r,Uu(a))},0)},this.resizeObserver.observe(e)}}getCompactRenderAs(){return"default"}getDesktopRenderAs(){return"default"}onBeforeSetCompactRenderer(){}onBeforeSetDesktopRenderer(){}processResponsiveness(e,t){if(t=Math.round(t),Math.abs(e-t)>2){const s=this.renderAs;return e>t?(this.onBeforeSetCompactRenderer(),this.renderAs=this.getCompactRenderAs()):(this.onBeforeSetDesktopRenderer(),this.renderAs=this.getDesktopRenderAs()),s!==this.renderAs}return!1}destroyResizeObserver(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=void 0,this.onMobileChangedCallback=void 0,this.triggerResponsivenessCallback=void 0,this.renderAs=this.getDesktopRenderAs())}dispose(){super.dispose(),this.resetDependedQuestions(),this.destroyResizeObserver()}resetDependedQuestions(){for(var e=0;e<this.dependedQuestions.length;e++)this.dependedQuestions[e].resetDependedQuestion()}get isNewA11yStructure(){return!1}get ariaLabel(){return this.isNewA11yStructure||this.hasTitle&&!this.parentQuestion?null:this.locTitle.renderedHtml}get ariaRole(){return this.isNewA11yStructure?null:"textbox"}get ariaRequired(){return this.isNewA11yStructure?null:this.isRequired?"true":"false"}get ariaInvalid(){return this.isNewA11yStructure?null:this.hasCssError()?"true":"false"}get ariaLabelledBy(){return this.isNewA11yStructure||!this.hasTitle||this.parentQuestion?null:this.ariaTitleId}get ariaDescribedBy(){return this.isNewA11yStructure?null:this.hasTitle&&this.hasDescription?this.ariaDescriptionId:null}getContentAriaHidden(){return null}get contentAriaHidden(){return this.getContentAriaHidden()}get ariaErrormessage(){return this.isNewA11yStructure?null:this.hasCssError()?this.id+"_errors":null}get a11y_input_ariaRole(){return null}get a11y_input_ariaRequired(){return this.isRequired?"true":"false"}get a11y_input_ariaInvalid(){return this.hasCssError()?"true":"false"}get a11y_input_ariaLabel(){return this.hasTitle&&!this.parentQuestion?null:this.locTitle.renderedHtml}get a11y_input_ariaLabelledBy(){return this.hasTitle&&!this.parentQuestion?this.ariaTitleId:null}get a11y_input_ariaDescribedBy(){let e=null;return this.hasCssError()?e=this.id+"_errors":this.hasTitle&&!this.parentQuestion&&this.hasDescription&&this.descriptionLocation!=="hidden"&&(e=this.ariaDescriptionId),e}get a11y_input_ariaErrormessage(){return null}get a11y_input_ariaExpanded(){return this.getPropertyValue("ariaExpanded")}get dragDropMatrixAttribute(){return null}registerSychProperties(e,t){this.registerFunctionOnPropertiesValueChanged(e,()=>{this._syncPropertiesChanging||(this._syncPropertiesChanging=!0,t(),this._syncPropertiesChanging=!1)})}};function Ju(n){if(!n)return n;for(n=n.trim().replace(/[\{\}]+/g,"");n&&n[0]===A.expressionDisableConversionChar;)n=n.substring(1);return n}q.addClass("question",[{name:"!name",onSettingValue:(n,e)=>Ju(e)},{name:"state",default:"default",choices:["default","collapsed","expanded"]},{name:"visible:switch",default:!0,overridingProperty:"visibleIf"},{name:"useDisplayValuesInDynamicTexts:boolean",alternativeName:"useDisplayValuesInTitle",default:!0,layout:"row"},"visibleIf:condition",{name:"width"},{name:"minWidth",defaultFunc:()=>A.minWidth},{name:"maxWidth",defaultFunc:()=>A.maxWidth},{name:"colSpan:number",visible:!1,onSerializeValue:n=>n.getPropertyValue("colSpan")},{name:"effectiveColSpan:number",minValue:1,isSerializable:!1,visibleIf:function(n){return!!n&&!!n.survey&&n.survey.gridLayoutEnabled}},{name:"startWithNewLine:boolean",default:!0,layout:"row"},{name:"indent:number",default:0,choices:[0,1,2,3],layout:"row"},{name:"page",isSerializable:!1,visibleIf:function(n){var e=n?n.survey:null;return!e||!e.pages||e.pages.length>1},choices:function(n){var e=n?n.survey:null;return e?e.pages.map(t=>({value:t.name,text:t.title})):[]}},{name:"title:text",serializationProperty:"locTitle",layout:"row",dependsOn:"name",onPropertyEditorUpdate:function(n,e){n&&e&&(e.placeholder=n.locTitle.getPlaceholder())}},{name:"titleLocation",default:"default",choices:["default","top","bottom","left","hidden"],layout:"row"},{name:"showTitle:boolean",isSerializable:!1,dependsOn:"titleLocation"},{name:"description:text",serializationProperty:"locDescription",layout:"row"},{name:"descriptionLocation",default:"default",choices:["default","underInput","underTitle"]},{name:"showNumber:boolean",dependsOn:"titleLocation",default:!0,visibleIf:function(n){if(!n)return!0;if(n.titleLocation==="hidden")return!1;var e=n?n.parent:null,t=!e||e.showQuestionNumbers!=="off";if(!t)return!1;var s=n?n.survey:null;return!s||s.showQuestionNumbers!=="off"||!!e&&e.showQuestionNumbers==="onpanel"}},{name:"hideNumber:boolean",visible:!1,isSerializable:!1},{name:"valueName",onSettingValue:(n,e)=>Ju(e)},"enableIf:condition","resetValueIf:condition","setValueIf:condition","setValueExpression:expression","defaultValue:value",{name:"defaultValueExpression:expression",category:"logic"},"correctAnswer:value",{name:"clearIfInvisible",default:"default",choices:["default","none","onComplete","onHidden","onHiddenContainer"]},{name:"isRequired:switch",overridingProperty:"requiredIf"},"requiredIf:condition",{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText"},{name:"errorLocation",default:"default",choices:["default","top","bottom"]},{name:"readOnly:switch",overridingProperty:"enableIf"},{name:"validators:validators",baseClassName:"surveyvalidator",classNamePart:"validator"},{name:"bindings:bindings",serializationProperty:"bindings",isSerializableFunc:n=>!n.isBindingEmpty(),visibleIf:function(n){return n.bindings.getNames().length>0}},{name:"renderAs",default:"default",visible:!1},{name:"showCommentArea:switch",visible:!1,default:!1,alternativeName:"hasComment",category:"general"},{name:"commentText",dependsOn:"showCommentArea",visibleIf:function(n){return n.showCommentArea},serializationProperty:"locCommentText"},{name:"commentPlaceholder",alternativeName:"commentPlaceHolder",serializationProperty:"locCommentPlaceholder",dependsOn:"showCommentArea",visibleIf:function(n){return n.showCommentArea}},{name:"defaultDisplayValue",serializationProperty:"locDefaultDisplayValue"}]),q.addAlterNativeClassName("question","questionbase");let VP=class{constructor(e){this.item=e}getValue(e,t,s,i){const r=e.length>0?e[0].name:"";if(e.length===1&&(r==="item"||r==="choice"))return{isFound:!0,value:this.item.value,context:this};if(e.length>1&&(r==="$item"||r==="$choice"))return new HV(this.item).getValue(e.slice(1),!0,-1,!1);const a=this.item.locOwner;if(a&&a.getValueGetterContext)return a.getValueGetterContext().getValue(e,t,s,i)}getRootObj(){const e=this.item.locOwner;return e&&e.getValueGetterContext?e:this.item.getSurvey()}getTextValue(e,t,s){return s&&t===this.item.value?this.item.textOrHtml:t!=null?t.toString():""}},Ce=class Dl extends tt{getMarkdownHtml(e,t,s){return this.locOwner?this.locOwner.getMarkdownHtml(e,t,s||this):void 0}getRenderer(e){return this.locOwner?this.locOwner.getRenderer(e,this):null}getRendererContext(e){return this.locOwner?this.locOwner.getRendererContext(e,this):e}getProcessedText(e){return this.locOwner?this.locOwner.getProcessedText(e):e}static get Separator(){return A.itemValueSeparator}static set Separator(e){A.itemValueSeparator=e}static setData(e,t,s){e.length=0;for(let i=0;i<t.length;i++){const r=t[i],a=r&&typeof r.getType=="function"?r.getType():s??"itemvalue",o=q.createClass(a);o.setData(r),r.originalItem&&(o.originalItem=r.originalItem),r.data&&(o.data=r.data),e.push(o)}}static getData(e){for(var t=[],s=0;s<e.length;s++)t.push(e[s].getData());return t}static getItemByValue(e,t){if(!Array.isArray(e))return null;const s=O.isValueEmpty(t);for(var i=0;i<e.length;i++)if(s&&O.isValueEmpty(e[i].value)||O.isTwoValueEquals(e[i].value,t,!1,!0,!1))return e[i];return null}static getTextOrHtmlByValue(e,t){var s=Dl.getItemByValue(e,t);return s!==null?s.textOrHtml:""}static locStrsChanged(e){for(var t=0;t<e.length;t++)e[t].locStrsChanged()}static runConditionsForItems(e,t,s,i,r=!0,a){return Dl.runConditionsForItemsCore(e,t,s,i,!0,r,a)}static runEnabledConditionsForItems(e,t,s,i){return Dl.runConditionsForItemsCore(e,null,t,s,!1,!0,i)}static runConditionsForItemsCore(e,t,s,i,r,a=!0,o){for(var l=!1,u=0;u<e.length;u++){var d=e[u],h=a&&d.getConditionRunner?d.getConditionRunner(r):!1;h||(h=s);var f=!0;h&&(f=h.runContext(d.getValueGetterContext(),i)),o&&(f=o(d,f)),t&&f&&t.push(d);var C=r?d.isVisible:d.isEnabled;f!=C&&(l=!0,r?d.setIsVisible&&d.setIsVisible(f):d.setIsEnabled&&d.setIsEnabled(f))}return l}constructor(e,t,s){super(),this.typeName=s,this.ownerPropertyName="",t&&(this.locText.text=t),e&&typeof e=="object"?this.setData(e,!0):this.setValue(e,!0),this.getType()!=this.getBaseType()&&Rs.createProperties(this),this.onCreating()}onCreating(){}getType(){return this.typeName||this.getBaseType()}getBaseType(){return"itemvalue"}getSurvey(e=!1){return this.locOwner&&this.locOwner.getSurvey?this.locOwner.getSurvey():null}getLocale(){return this.locOwner&&this.locOwner.getLocale?this.locOwner.getLocale():""}getLocalizableString(e){return e==="text"?this.locText:super.getLocalizableString(e)}getValueGetterContext(){return new VP(this)}get isInternal(){return this.isGhost===!0}createLocText(){const e=new At(this,!0,"text");return e.onStrChanged=(t,s)=>{this.propertyValueChanged("text",t,s)},e.onGetTextCallback=t=>this.onGetText(t),e}onGetText(e){return e||this.getValueText()}getValueText(){const e=this.value;return O.isValueEmpty(e)?null:e.toString()}get locText(){return this.locTextValue||(this.locTextValue=this.createLocText()),this.locTextValue}setLocText(e){this.locTextValue=e}get locOwner(){return this._locOwner}set locOwner(e){this._locOwner=e,this.onLocOwnerChanged()}onLocOwnerChanged(){}get value(){return this.getPropertyValue("value")}set value(e){this.setValue(e,!1)}setValue(e,t){let s;e=this.getCorrectValue(e);const i=A.itemValueSeparator;if(i&&!O.isValueEmpty(e)){var r=e.toString(),a=r.indexOf(i);a>-1&&(e=r.slice(0,a),s=r.slice(a+1))}t?this.setPropertyValueDirectly("value",e):this.setPropertyValue("value",e),s&&(this.text=s),this.id=this.value}getCorrectValue(e){return e}get hasText(){return!!this.pureText}get pureText(){var e;return((e=this.locTextValue)===null||e===void 0?void 0:e.pureText)||""}set pureText(e){this.text=e}get text(){return this.calculatedText}set text(e){this.locText.text=e}get textOrHtml(){return this.locTextValue?this.locText.textOrHtml:this.getValueText()}get calculatedText(){return this.locTextValue?this.locText.calculatedText:this.getValueText()}get shortcutText(){return this.text}canSerializeValue(){const e=this.value;return e==null?!1:!Array.isArray(e)&&typeof e!="object"}getData(){var e=this.toJSON();if(e.value&&e.value.pos&&delete e.value.pos,O.isValueEmpty(e.value))return e;const t=this.canSerializeValue();return(!t||!A.serialization.itemValueSerializeAsObject&&!A.serialization.itemValueSerializeDisplayText)&&Object.keys(e).length==1?this.value:(A.serialization.itemValueSerializeDisplayText&&e.text===void 0&&t&&(e.text=this.value.toString()),e)}toJSON(){var e={},t=q.getProperties(this.getType());(!t||t.length==0)&&(t=q.getProperties(this.getBaseType()));for(var s=new qt,i=0;i<t.length;i++){const r=t[i];this.canAddPpropertyToJSON(r)&&s.valueToJson(this,e,r)}return e}canAddPpropertyToJSON(e){return!(e.name==="text"&&(!this.locTextValue||!this.locTextValue.hasNonDefaultText()&&O.isTwoValueEquals(this.value,this.locTextValue.getLocaleText(""),!1,!0,!1)))}setData(e,t){var s;if(!O.isValueEmpty(e)){if(typeof e.value>"u"&&typeof e.text<"u"&&Object.keys(e).length===1&&(e.value=e.text),typeof e.value<"u"){let r;if(typeof e.toJSON=="function")r=e.toJSON();else if(Array.isArray(e.elements)){r={};for(var i in e)i!=="elements"&&(r[i]=e[i])}else r=e;new qt().toObject(r,this)}else this.setValue(e,t);t||(s=this.locTextValue)===null||s===void 0||s.strChanged()}}get visibleIf(){return this.getPropertyValueWithoutDefault("visibleIf")||""}set visibleIf(e){this.setPropertyValue("visibleIf",e)}get enableIf(){return this.getPropertyValueWithoutDefault("enableIf")||""}set enableIf(e){this.setPropertyValue("enableIf",e)}get isVisible(){const e=this.getPropertyValueWithoutDefault("isVisible");return e!==void 0?e:!0}setIsVisible(e){this.setPropertyValue("isVisible",e)}get isEnabled(){const e=this.getPropertyValueWithoutDefault("isEnabled");return e!==void 0?e:!0}setIsEnabled(e){this.setPropertyValue("isEnabled",e)}addUsedLocales(e){this.locTextValue&&this.AddLocStringToUsedLocales(this.locTextValue,e)}locStrsChanged(){var e;super.locStrsChanged(),(e=this.locTextValue)===null||e===void 0||e.strChanged()}onPropertyValueChanged(e,t,s){var i;e==="value"&&!this.hasText&&((i=this.locTextValue)===null||i===void 0||i.strChanged());var r="itemValuePropertyChanged";!this.locOwner||!this.locOwner[r]||this.locOwner[r](this,e,t,s)}getConditionRunner(e){return e?this.getVisibleConditionRunner():this.getEnableConditionRunner()}getVisibleConditionRunner(){const e=this.getExpressionFromSurvey("visibleIf");return e?(this.visibleConditionRunner||(this.visibleConditionRunner=new Fs(e)),this.visibleConditionRunner.expression=e,this.visibleConditionRunner):null}getEnableConditionRunner(){const e=this.getExpressionFromSurvey("enableIf");return e?(this.enableConditionRunner||(this.enableConditionRunner=new Fs(e)),this.enableConditionRunner.expression=e,this.enableConditionRunner):null}get selected(){const e=this._locOwner;return e instanceof Dt&&e.isItemSelected&&this.selectedValue===void 0&&(this.selectedValue=new We(()=>e.isItemSelected(this))),this.selectedValue}getComponent(){return this._locOwner instanceof Dt?this.componentValue||this._locOwner.itemComponent:this.componentValue}setComponent(e){this.componentValue=e}setRootElement(e){this._htmlElement=e}getRootElement(){return this._htmlElement}getEnabled(){return this.isEnabled}setEnabled(e){this.setIsEnabled(e)}getVisible(){const e=this.isVisible===void 0?!0:this.isVisible,t=this._visible===void 0?!0:this._visible;return e&&t}setVisible(e){this.visible!==e&&(this._visible=e)}get _visible(){return this.getPropertyValue("visible",!0)}set _visible(e){this.setPropertyValue("visible",e)}getLocTitle(){return this.locText}getTitle(){return this.text}setLocTitle(e){}setTitle(e){}get icon(){return this.getPropertyValue("icon","")}set icon(e){this.setPropertyValue("icon",e)}};S([E()],Ce.prototype,"selectedValue",void 0),Te.createItemValue=function(n,e){var t=null;return e?t=qt.metaData.createClass(e,{}):typeof n.getType=="function"?t=new Ce(null,void 0,n.getType()):t=new Ce(null),t.setData(n),t},Te.itemValueLocStrChanged=function(n){Ce.locStrsChanged(n)},gr.getItemValuesDefaultValue=(n,e)=>{const t=new Array;return Ce.setData(t,Array.isArray(n)?n:[],e),t},q.addClass("itemvalue",[{name:"!value",isUnique:!0},{name:"text",serializationProperty:"locText"},{name:"visibleIf:condition",locationInTable:"detail"},{name:"enableIf:condition",locationInTable:"detail",visibleIf:n=>!n||n.ownerPropertyName!=="rateValues"}],n=>new Ce(n));let PP=class extends Te{constructor(e=null,t=null){super(),this.expressionIsRunning=!1,this.isCalculated=!1,e&&(this.name=e),t&&(this.expression=t)}setOwner(e){this.data=e,this.rerunExpression()}getType(){return"calculatedvalue"}getSurvey(e=!1){return this.data&&this.data.getSurvey?this.data.getSurvey():null}get owner(){return this.data}get name(){return this.getPropertyValue("name")||""}set name(e){this.setPropertyValue("name",e)}get includeIntoResult(){return this.getPropertyValue("includeIntoResult")}set includeIntoResult(e){this.setPropertyValue("includeIntoResult",e)}get expression(){return this.getPropertyValue("expression")||""}set expression(e){this.setPropertyValue("expression",e),this.rerunExpression()}locCalculation(){this.expressionIsRunning=!0}unlocCalculation(){this.expressionIsRunning=!1}resetCalculation(){this.isCalculated=!1}doCalculation(e,t){this.isCalculated||(this.runExpressionCore(e,t),this.isCalculated=!0)}runExpression(e){this.runExpressionCore(null,e)}get value(){if(this.data)return this.data.getVariable(this.name)}setValue(e){this.data&&this.data.setVariable(this.name,e)}get canRunExpression(){return!!this.data&&!this.isLoadingFromJson&&!!this.expression&&!this.expressionIsRunning&&!!this.name}rerunExpression(){this.canRunExpression&&this.runExpression(this.data.getFilteredProperties())}runExpressionCore(e,t){!this.canRunExpression||!this.ensureExpression()||(this.locCalculation(),e&&this.runDependentExpressions(e,t),this.expressionRunner.runContext(this.getValueGetterContext(),this.getPropertiesCopy(t,"expression")))}runDependentExpressions(e,t){var s=this.expressionRunner.getVariables();if(s)for(var i=0;i<e.length;i++){var r=e[i];r===this||s.indexOf(r.name)<0||r.doCalculation(e,t)}}ensureExpression(){const e=this.getExpressionFromSurvey("expression");return e?(this.expressionRunner?this.expressionRunner.expression=e:(this.expressionRunner=this.createExpressionRunner(e),this.expressionRunner.onRunComplete=t=>{O.isTwoValueEquals(t,this.value,!1,!0,!1)||this.setValue(t),this.unlocCalculation()}),!0):!1}};q.addClass("calculatedvalue",[{name:"!name",isUnique:!0},"expression:expression","includeIntoResult:boolean"],function(){return new PP},"base");let Ku=class extends Te{constructor(e=null){super(),this.expression=e}getType(){return"expressionitem"}runCondition(e){let t=!1;return this.runExpressionByProperty("expression",e,s=>{t=s===!0}),t}get expression(){return this.getPropertyValue("expression","")}set expression(e){this.setPropertyValue("expression",e)}get locHtml(){return this.getLocalizableString("html")}getLocale(){return this.locOwner?this.locOwner.getLocale():""}getMarkdownHtml(e,t,s){return this.locOwner?this.locOwner.getMarkdownHtml(e,t,s):void 0}getRenderer(e){return this.locOwner?this.locOwner.getRenderer(e):null}getRendererContext(e){return this.locOwner?this.locOwner.getRendererContext(e):e}getProcessedText(e){return this.locOwner?this.locOwner.getProcessedText(e):e}getSurvey(e=!1){return this.locOwner}},SP=class extends Ku{constructor(e=null,t=null){super(e),this.createLocalizableString("html"),this.html=t}getType(){return"htmlconditionitem"}get html(){return this.getLocalizableStringText("html")}set html(e){this.setLocalizableStringText("html",e)}get locHtml(){return this.getLocalizableString("html")}},IP=class extends Ku{constructor(e=null,t=null){super(e),this.createLocalizableString("url"),this.url=t}getType(){return"urlconditionitem"}get url(){return this.getLocalizableStringText("url")}set url(e){this.setLocalizableStringText("url",e)}get locUrl(){return this.getLocalizableString("url")}};q.addClass("expressionitem",["expression:condition"],function(){return new Ku},"base"),q.addClass("htmlconditionitem",[{name:"html:html",serializationProperty:"locHtml"}],function(){return new SP},"expressionitem"),q.addClass("urlconditionitem",[{name:"url:string",serializationProperty:"locUrl"}],function(){return new IP},"expressionitem");let TP=class{constructor(){this.parser=new DOMParser}assignValue(e,t,s){Array.isArray(e[t])?e[t].push(s):e[t]!==void 0?e[t]=[e[t]].concat(s):typeof s=="object"&&Object.keys(s).length===1&&Object.keys(s)[0]===t?e[t]=s[t]:e[t]=s}xml2Json(e,t){if(e.children&&e.children.length>0)for(let s=0;s<e.children.length;s++){let i=e.children[s],r={};this.xml2Json(i,r),this.assignValue(t,i.nodeName,r)}else this.assignValue(t,e.nodeName,e.textContent)}parseXmlString(e){let t=this.parser.parseFromString(e,"text/xml"),s={};return this.xml2Json(t,s),s}},br=class zt extends Te{static get EncodeParameters(){return A.web.encodeUrlParams}static set EncodeParameters(e){A.web.encodeUrlParams=e}static clearCache(){zt.itemsResult={},zt.sendingSameRequests={}}static addSameRequest(e){if(!e.isUsingCache)return!1;var t=e.objHash,s=zt.sendingSameRequests[t];return s?(s.push(e),e.isRunningValue=!0,!0):(zt.sendingSameRequests[e.objHash]=[],!1)}static unregisterSameRequests(e,t){if(e.isUsingCache){var s=zt.sendingSameRequests[e.objHash];if(delete zt.sendingSameRequests[e.objHash],!!s)for(var i=0;i<s.length;i++)s[i].isRunningValue=!1,s[i].getResultCallback&&s[i].getResultCallback(t)}}static get onBeforeSendRequest(){return A.web.onBeforeRequestChoices}static set onBeforeSendRequest(e){A.web.onBeforeRequestChoices=e}static getCachedItemsResult(e){var t=e.objHash,s=zt.itemsResult[t];return s?(e.getResultCallback&&e.getResultCallback(s),!0):!1}constructor(){super(),this.lastObjHash="",this.isRunningValue=!1,this.processedUrl="",this.processedPath="",this.isUsingCacheFromUrl=void 0,this.error=null,this.createItemValue=e=>new Ce(e),this.registerPropertyChangedHandlers(["url"],()=>{this.owner&&this.owner.setPropertyValue("isUsingRestful",!!this.url)})}getSurvey(e=!1){return this.owner?this.owner.survey:null}run(e=null){if(!(!this.url||!this.getResultCallback)){if(this.processedText(e),!this.processedUrl){this.doEmptyResultCallback({}),this.lastObjHash=this.objHash;return}this.lastObjHash!==this.objHash&&(this.lastObjHash=this.objHash,this.error=null,!this.useChangedItemsResults()&&(zt.addSameRequest(this)||this.sendRequest()))}}get isUsingCache(){return this.isUsingCacheFromUrl===!0?!0:this.isUsingCacheFromUrl===!1?!1:A.web.cacheLoadedChoices}get isRunning(){return this.getIsRunning()}getIsRunning(){return this.isRunningValue}get isWaitingForParameters(){return this.url&&!this.processedUrl}useChangedItemsResults(){return zt.getCachedItemsResult(this)}doEmptyResultCallback(e){var t=[];this.updateResultCallback&&(t=this.updateResultCallback(t,e)),this.getResultCallback(t)}processedText(e){var t=this.url;if(t&&(t=t.replace(zt.cacheText,"").replace(zt.noCacheText,"")),e){var s=e.processTextEx({text:t,runAtDesign:!0}),i=e.processTextEx({text:this.path,runAtDesign:!0});!s.hasAllValuesOnLastRun||!i.hasAllValuesOnLastRun?(this.processedUrl="",this.processedPath=""):(this.processedUrl=s.text,this.processedPath=i.text)}else this.processedUrl=t,this.processedPath=this.path;this.onProcessedUrlCallback&&this.onProcessedUrlCallback(this.processedUrl,this.processedPath)}parseResponse(e){let t;if(e&&typeof e.indexOf=="function"&&e.indexOf("<")===0){var s=new TP;t=s.parseXmlString(e)}else try{t=JSON.parse(e)}catch{t=(e||"").split(`
`).map(r=>r.trim(" ")).filter(r=>!!r)}return t}sendRequest(){typeof XMLHttpRequest<"u"?this.sendXmlHttpRequest():typeof fetch<"u"?this.sendFetchRequest():(this.error=new Vy("The browser does not support XMLHttpRequest or fetch API","",this.owner),this.doEmptyResultCallback(""))}sendXmlHttpRequest(){var e=new XMLHttpRequest;e.open("GET",this.processedUrl),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var t=this,s=this.objHash;e.onload=function(){t.beforeLoadRequest(),e.status===200?t.onLoad(t.parseResponse(e.response),s):t.onError(e.statusText,e.responseText)};var i={url:this.processedUrl,request:e};A.web.onBeforeRequestChoices&&A.web.onBeforeRequestChoices(this,i),this.beforeSendRequest(),i.request.send()}sendFetchRequest(){const e=this,t=this.objHash,r={url:this.processedUrl,fetchOptions:{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded"}}};A.web.onBeforeRequestChoices&&A.web.onBeforeRequestChoices(this,r),this.beforeSendRequest(),fetch(r.url,r.fetchOptions).then(a=>(e.beforeLoadRequest(),a.status===200?a.text().then(o=>{e.onLoad(e.parseResponse(o),t)}):a.text().then(o=>{e.onError(a.statusText,o)}))).catch(a=>{e.onError(a.message,"")})}getType(){return"choicesByUrl"}get isEmpty(){return!this.url&&!this.path}getCustomPropertiesNames(){for(var e=this.getCustomProperties(),t=new Array,s=0;s<e.length;s++)t.push(this.getCustomPropertyName(e[s].name));return t}getCustomPropertyName(e){return e+"Name"}getCustomProperties(){for(var e=q.getProperties(this.itemValueType),t=[],s=0;s<e.length;s++)e[s].name==="value"||e[s].name==="text"||e[s].name==="visibleIf"||e[s].name==="enableIf"||t.push(e[s]);return t}getAllPropertiesNames(){const e=new Array;return q.getPropertiesByObj(this).forEach(t=>e.push(t.name)),this.getCustomPropertiesNames().forEach(t=>e.push(t)),e}setData(e){e||(e={}),this.getAllPropertiesNames().forEach(s=>{this[s]=e[s]});const t=e.attachData||e.attachOriginalItems;t!==void 0&&(this.attachData=t)}getData(){const e={};let t=!1;return this.getAllPropertiesNames().forEach(s=>{const i=this[s];!this.isValueEmpty(i)&&i!==this.getDefaultPropertyValue(s)&&(e[s]=i,t=!0)}),t?e:null}get url(){return this.getPropertyValue("url")||""}set url(e){this.setPropertyValue("url",e),this.isUsingCacheFromUrl=void 0,e&&(e.indexOf(zt.cacheText)>-1?this.isUsingCacheFromUrl=!0:e.indexOf(zt.noCacheText)>-1&&(this.isUsingCacheFromUrl=!1))}get path(){return this.getPropertyValue("path")||""}set path(e){this.setPropertyValue("path",e)}get valueName(){return this.getPropertyValue("valueName")||""}set valueName(e){this.setPropertyValue("valueName",e)}get titleName(){return this.getPropertyValue("titleName")||""}set titleName(e){this.setPropertyValue("titleName",e)}get imageLinkName(){return this.getPropertyValue("imageLinkName")||""}set imageLinkName(e){this.setPropertyValue("imageLinkName",e)}get allowEmptyResponse(){return this.getPropertyValue("allowEmptyResponse")}set allowEmptyResponse(e){this.setPropertyValue("allowEmptyResponse",e)}get attachOriginalItems(){return this.attachData}set attachOriginalItems(e){this.attachData=e}get attachData(){return this.getPropertyValue("attachData")}set attachData(e){this.setPropertyValue("attachData",e)}get itemValueType(){if(!this.owner)return"itemvalue";var e=q.findProperty(this.owner.getType(),"choices");return!e||e.type=="itemvalue[]"?"itemvalue":e.type}clear(){this.setData(void 0)}beforeSendRequest(){this.isRunningValue=!0,this.beforeSendRequestCallback&&this.beforeSendRequestCallback()}beforeLoadRequest(){this.isRunningValue=!1}onLoad(e,t=null){t||(t=this.objHash);var s=new Array,i=this.getResultAfterPath(e);if(i&&i.length)for(var r=0;r<i.length;r++){var a=i[r];if(a){var o=this.getItemValueCallback?this.getItemValueCallback(a):this.getValue(a),l=this.createItemValue(o);this.setTitle(l,a),this.setCustomProperties(l,a),this.attachData&&(l.originalItem=a,l.data=a);var u=this.getImageLink(a);u&&(l.imageLink=u),s.push(l)}}else this.allowEmptyResponse||(this.error=new dP(null,this.owner));this.updateResultCallback&&(s=this.updateResultCallback(s,e)),this.isUsingCache&&(zt.itemsResult[t]=s),this.callResultCallback(s,t),zt.unregisterSameRequests(this,s)}callResultCallback(e,t){t==this.objHash&&this.getResultCallback(e)}setCustomProperties(e,t){for(var s=this.getCustomProperties(),i=0;i<s.length;i++){var r=s[i],a=this.getValueCore(t,this.getPropertyBinding(r.name));this.isValueEmpty(a)||(e[r.name]=a)}}getPropertyBinding(e){return this[this.getCustomPropertyName(e)]?this[this.getCustomPropertyName(e)]:this[e]?this[e]:e}onError(e,t){this.error=new Vy(e,t,this.owner),this.doEmptyResultCallback(t),zt.unregisterSameRequests(this,[])}getResultAfterPath(e){if(!e||!this.processedPath)return e;for(var t=this.getPathes(),s=0;s<t.length;s++)if(e=e[t[s]],!e)return null;return e}getPathes(){var e=[];return this.processedPath.indexOf(";")>-1?e=this.path.split(";"):this.processedPath.indexOf(",")>-1?e=this.processedPath.split(","):e=this.processedPath.split("."),e.length==0&&e.push(this.processedPath),e}getValue(e){if(!e)return null;if(this.valueName)return this.getValueCore(e,this.valueName);if(!(e instanceof Object))return e;var t=Object.keys(e).length;return t<1?null:e[Object.keys(e)[0]]}setTitle(e,t){var s=this.titleName?this.titleName:"title",i=this.getValueCore(t,s);i&&(typeof i=="string"?e.text=i:e.locText.setJson(i))}getImageLink(e){var t=this.imageLinkName?this.imageLinkName:"imageLink";return this.getValueCore(e,t)}getValueCore(e,t){if(!e)return null;if(t.indexOf(".")<0)return e[t];for(var s=t.split("."),i=0;i<s.length;i++)if(e=e[s[i]],!e)return null;return e}get objHash(){return this.processedUrl+";"+this.processedPath+";"+this.valueName+";"+this.titleName+";"+this.imageLinkName+";"+this.attachData}};br.cacheText="{CACHE}",br.noCacheText="{NOCACHE}",br.itemsResult={},br.sendingSameRequests={},q.addClass("choicesByUrl",["url","path","valueName","titleName",{name:"imageLinkName",visibleIf:function(n){return!!n&&!!n.owner&&n.owner.getType()=="imagepicker"}},{name:"allowEmptyResponse:boolean"},{name:"attachData:boolean",alternativeName:"attachOriginalItems",visible:!1}],function(){return new br});let ro=class extends Dt{createColumnValues(){return this.createItemValues("columns")}constructor(e){super(e),this.generatedVisibleRows=null,this.generatedTotalRow=null,this.columns=this.createColumnValues(),this.rows=this.createItemValues("rows")}getType(){return"matrixbase"}endLoadingFromJson(){super.endLoadingFromJson(),this.updateVisibilityBasedOnRows()}get isCompositeQuestion(){return!0}get showHeader(){return this.getPropertyValue("showHeader")}set showHeader(e){this.setPropertyValue("showHeader",e)}get columns(){return this.getPropertyValue("columns")}set columns(e){this.setPropertyValue("columns",e)}get visibleColumns(){const e=[];return this.columns.forEach(t=>{this.isColumnVisible(t)&&e.push(t)}),e}isColumnVisible(e){return e.isVisible}get rows(){return this.getPropertyValue("rows")}set rows(e){var t=this.processRowsOnSet(e);this.setPropertyValue("rows",t)}processRowsOnSet(e){return e}getVisibleRows(){return[]}get visibleRows(){return this.getVisibleRows()}get rowsVisibleIf(){return this.getPropertyValue("rowsVisibleIf","")}set rowsVisibleIf(e){this.setPropertyValue("rowsVisibleIf",e),this.isLoadingFromJsonValue||this.runCondition(this.getDataFilteredProperties())}get columnsVisibleIf(){return this.getPropertyValue("columnsVisibleIf","")}set columnsVisibleIf(e){this.setPropertyValue("columnsVisibleIf",e),this.isLoadingFromJson||this.runCondition(this.getDataFilteredProperties())}runConditionCore(e){super.runConditionCore(e),this.runItemsCondition(e)}onColumnsChanged(){}onRowsChanged(){this.updateVisibilityBasedOnRows(),this.fireCallback(this.visibleRowsChangedCallback)}updateVisibilityBasedOnRows(){this.hideIfRowsEmpty&&this.onVisibleChanged()}isVisibleCore(){var e;const t=super.isVisibleCore();return!t||!this.hideIfRowsEmpty?t:((e=this.visibleRows)===null||e===void 0?void 0:e.length)>0}shouldRunColumnExpression(){return!this.survey||!this.survey.areInvisibleElementsShowing}hasRowsAsItems(){return!0}runItemsCondition(e){let t=this.hasRowsAsItems()&&this.runConditionsForRows(e);const s=this.runConditionsForColumns(e);t=s||t,t&&(this.isClearValueOnHidden&&s&&this.clearInvisibleColumnValues(),this.clearGeneratedRows(),s&&this.onColumnsChanged(),this.onRowsChanged())}clearGeneratedRows(){this.generatedVisibleRows=null}createRowsVisibleIfRunner(){return null}runConditionsForRows(e){const t=!!this.survey&&this.survey.areInvisibleElementsShowing,s=t?null:this.createRowsVisibleIfRunner(),i=Ce.runConditionsForItems(this.rows,void 0,s,e,!t);return Ce.runEnabledConditionsForItems(this.rows,void 0,e),i}runConditionsForColumns(e){const t=!!this.survey&&!this.survey.areInvisibleElementsShowing,s=this.getExpressionFromSurvey("columnsVisibleIf"),i=t&&s?new Fs(s):null;return Ce.runConditionsForItems(this.columns,void 0,i,e,this.shouldRunColumnExpression())}clearInvisibleColumnValues(){}clearInvisibleValuesInRows(){}needResponsiveWidth(){return!0}get columnsAutoWidth(){return!this.isMobile&&!this.columns.some(e=>!!e.width)}getTableCss(){var e;return new z().append(this.cssClasses.root).append(this.cssClasses.columnsAutoWidth,this.columnsAutoWidth).append(this.cssClasses.noHeader,!this.showHeader).append(this.cssClasses.hasFooter,!!(!((e=this.renderedTable)===null||e===void 0)&&e.showAddRowOnBottom)).append(this.cssClasses.rootAlternateRows,this.alternateRows).append(this.cssClasses.rootVerticalAlignTop,this.verticalAlign==="top").append(this.cssClasses.rootVerticalAlignMiddle,this.verticalAlign==="middle").toString()}get columnMinWidth(){return this.getPropertyValue("columnMinWidth")||""}set columnMinWidth(e){this.setPropertyValue("columnMinWidth",e)}get rowTitleWidth(){return this.getPropertyValue("rowTitleWidth")||""}set rowTitleWidth(e){this.setPropertyValue("rowTitleWidth",e)}set displayMode(e){this.setPropertyValue("displayMode",e)}get displayMode(){return this.getPropertyValue("displayMode")}getCellAriaLabel(e,t,s){let i=e.locText&&e.locText.renderedHtml?e.locText.renderedHtml:"";s&&(i=s);const r=t.locTitle&&t.locTitle.renderedHtml?t.locTitle.renderedHtml:"",a=(this.getLocalizationString("matrix_row")||"row").toLocaleLowerCase(),o=(this.getLocalizationString("matrix_column")||"column").toLocaleLowerCase();return`${a} ${i}, ${o} ${r}`}get isNewA11yStructure(){return!0}getIsMobile(){return this.displayMode=="auto"?super.getIsMobile():this.displayMode==="list"}};S([E()],ro.prototype,"verticalAlign",void 0),S([E()],ro.prototype,"alternateRows",void 0),q.addClass("matrixbase",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},"columnsVisibleIf:condition","rowsVisibleIf:condition","columnMinWidth",{name:"showHeader:boolean",default:!0},{name:"verticalAlign",choices:["top","middle"],default:"middle"},{name:"alternateRows:boolean",default:!1},{name:"displayMode",default:"auto",choices:["auto","table","list"],visible:!1}],void 0,"question");let EP=class{},Ey=class{constructor(e,t){this.name=e,this.returnDisplayValue=t,this.isExists=!1}},Ry=class{constructor(){this._unObservableValues=[void 0]}get hasAllValuesOnLastRunValue(){return this._unObservableValues[0]}set hasAllValuesOnLastRunValue(e){this._unObservableValues[0]=e}process(e,t,s,i){if(this.hasAllValuesOnLastRunValue=!0,!e||!this.onProcess)return e;const r=this.getItems(e);for(let o=r.length-1;o>=0;o--){const l=r[o],u=this.getName(e.substring(l.start+1,l.end));if(u){const d=new Ey(u,t===!0);if(this.onProcess(d),d.isExists||(this.hasAllValuesOnLastRunValue=!1),d.isExists||i){O.isValueEmpty(d.value)&&(this.hasAllValuesOnLastRunValue=!1);var a=O.isValueEmpty(d.value)?"":d.value;s&&(a=encodeURIComponent(a)),e=e.substring(0,l.start)+a+e.substring(l.end+1)}}}return e}processValue(e,t){var s=new Ey(e,t);return this.onProcess&&this.onProcess(s),s}get hasAllValuesOnLastRun(){return!!this.hasAllValuesOnLastRunValue}processText(e,t){return this.process(e,t)}processTextEx(e){const t={hasAllValuesOnLastRun:!0,text:e.text};return t.text=this.process(e.text,e.returnDisplayValue,e.doEncoding,e.replaceUndefinedValues),t.hasAllValuesOnLastRun=this.hasAllValuesOnLastRun,t}getItems(e){for(var t=[],s=e.length,i=-1,r="",a=0;a<s;a++)if(r=e[a],r=="{"&&(i=a),r=="}"){if(i>-1){var o=new EP;o.start=i,o.end=a,this.isValidItemName(e.substring(i+1,a))&&t.push(o)}i=-1}return t}isValidItemName(e){return!!e&&e.indexOf(":")<0}getName(e){if(e)return e.trim()}},no=class{constructor(e){this.obj=e,this.textPreProcessor=new Ry,this.textPreProcessor.onProcess=t=>{this.getProcessedTextValue(t)}}processText(e,t){const s={text:e,returnDisplayValue:t};return this.processTextEx(s).text}processTextEx(e){var t;return!e.runAtDesign&&(!((t=this.survey)===null||t===void 0)&&t.isDesignMode)?{hasAllValuesOnLastRun:!0,text:e.text}:this.textPreProcessor.processTextEx(e)}get survey(){const e=this.obj;return e.getSurvey?e.getSurvey():null}getProcessedTextValue(e){const t=e.name.toLocaleLowerCase(),s=new Ii().getValueInfo({name:t,context:this.obj.getValueGetterContext(),isText:!0,isDisplayValue:e.returnDisplayValue});s.isFound&&(e.isExists=s.isFound,e.value=s.value)}},RP=class{constructor(e,t){this.name=e,this.json=t;var s=this;q.addClass(e,[],function(i){return tn.Instance.createQuestion(i?i.name:"",s)},"question"),this.onInit()}onInit(){this.json.onInit&&this.json.onInit()}onCreated(e){this.json.onCreated&&this.json.onCreated(e)}onLoaded(e){this.json.onLoaded&&this.json.onLoaded(e)}onAfterRender(e,t){this.json.onAfterRender&&this.json.onAfterRender(e,t)}onAfterRenderContentElement(e,t,s){this.json.onAfterRenderContentElement&&this.json.onAfterRenderContentElement(e,t,s)}onUpdateQuestionCssClasses(e,t,s){this.json.onUpdateQuestionCssClasses&&this.json.onUpdateQuestionCssClasses(e,t,s)}onSetQuestionValue(e,t){this.json.onSetQuestionValue&&this.json.onSetQuestionValue(e,t),this.json.onValueSet&&this.json.onValueSet(e,t)}onPropertyChanged(e,t,s){this.json.onPropertyChanged&&this.json.onPropertyChanged(e,t,s)}onValueChanged(e,t,s){this.json.onValueChanged&&this.json.onValueChanged(e,t,s)}onValueChanging(e,t,s){return this.json.onValueChanging?this.json.onValueChanging(e,t,s):s}onGetErrorText(e){if(this.json.getErrorText)return this.json.getErrorText(e)}onItemValuePropertyChanged(e,t,s,i,r){this.json.onItemValuePropertyChanged&&this.json.onItemValuePropertyChanged(e,{obj:t,propertyName:s,name:i,newValue:r})}getDisplayValue(e,t,s){return this.json.getDisplayValue?this.json.getDisplayValue(s):s.getDisplayValue(e,t)}get defaultQuestionTitle(){return this.json.defaultQuestionTitle}setValueToQuestion(e){const t=this.json.valueToQuestion||this.json.setValue;return t?t(e):e}getValueFromQuestion(e){const t=this.json.valueFromQuestion||this.json.getValue;return t?t(e):e}get isComposite(){return!!this.json.elementsJSON||!!this.json.createElements}getDynamicProperties(){return Array.isArray(this.dynamicProperties)||(this.dynamicProperties=this.calcDynamicProperties()),this.dynamicProperties}calcDynamicProperties(){const e=this.json.inheritBaseProps;if(!e||!this.json.questionJSON)return[];const t=this.json.questionJSON.type;if(!t)return[];if(Array.isArray(e)){const i=[];return e.forEach(r=>{const a=q.findProperty(t,r);a&&i.push(a)}),i}const s=[];for(let i in this.json.questionJSON)s.push(i);return q.getDynamicPropertiesByTypes(this.name,t,s)}},tn=class{constructor(){this.customQuestionValues=[]}add(e){if(!e)return;let t=e.name;if(!t)throw"Attribute name is missed";if(t=t.toLowerCase(),this.getCustomQuestionByName(t))throw"There is already registered custom question with name '"+t+"'";if(q.findClass(t))throw"There is already class with name '"+t+"'";var s=new RP(t,e);this.onAddingJson&&this.onAddingJson(t,s.isComposite),this.customQuestionValues.push(s)}remove(e){if(!e)return!1;const t=this.getCustomQuestionIndex(e.toLowerCase());return t<0?!1:(this.removeByIndex(t),!0)}get items(){return this.customQuestionValues}getCustomQuestionByName(e){const t=this.getCustomQuestionIndex(e);return t>=0?this.customQuestionValues[t]:void 0}getCustomQuestionIndex(e){for(var t=0;t<this.customQuestionValues.length;t++)if(this.customQuestionValues[t].name===e)return t;return-1}removeByIndex(e){q.removeClass(this.customQuestionValues[e].name),this.customQuestionValues.splice(e,1)}clear(e){for(let t=this.customQuestionValues.length-1;t>=0;t--)(e||!this.customQuestionValues[t].json.internal)&&this.removeByIndex(t)}createQuestion(e,t){return t.isComposite?this.createCompositeModel(e,t):this.createCustomModel(e,t)}createCompositeModel(e,t){return this.onCreateComposite?this.onCreateComposite(e,t):new AP(e,t)}createCustomModel(e,t){return this.onCreateCustom?this.onCreateCustom(e,t):new _P(e,t)}};tn.Instance=new tn;let _y=class extends Dt{constructor(e,t){super(e),this.customQuestion=t,Rs.createProperties(this),yt.CreateDisabledDesignElements=!0,this.locQuestionTitle=this.createLocalizableString("questionTitle"),this.locQuestionTitle.setJson(this.customQuestion.defaultQuestionTitle),this.createWrapper(),yt.CreateDisabledDesignElements=!1,this.customQuestion&&this.customQuestion.onCreated(this)}getType(){return this.customQuestion?this.customQuestion.name:"custom"}locStrsChanged(){super.locStrsChanged(),this.getElement()&&this.getElement().locStrsChanged()}localeChanged(){super.locStrsChanged(),this.getElement()&&this.getElement().localeChanged()}getDefaultTitle(){return this.locQuestionTitle.isEmpty?super.getDefaultTitle():this.getProcessedText(this.locQuestionTitle.textOrHtml)}addUsedLocales(e){super.addUsedLocales(e),this.getElement()&&this.getElement().addUsedLocales(e)}needResponsiveWidth(){const e=this.getElement();return e?e.needResponsiveWidth():!1}createWrapper(){}onPropertyValueChanged(e,t,s){super.onPropertyValueChanged(e,t,s),this.customQuestion&&!this.isLoadingFromJson&&this.customQuestion.onPropertyChanged(this,e,s)}itemValuePropertyChanged(e,t,s,i){super.itemValuePropertyChanged(e,t,s,i),this.customQuestion&&!this.isLoadingFromJson&&this.customQuestion.onItemValuePropertyChanged(this,e,e.ownerPropertyName,t,i)}onFirstRenderingCore(){super.onFirstRenderingCore();const e=this.getElement();e&&e.onFirstRendering()}onHidingContent(){super.onHidingContent();const e=this.getElement();e&&e.onHidingContent()}getProgressInfo(){let e=super.getProgressInfo();return this.getElement()&&(e=this.getElement().getProgressInfo()),this.isRequired&&e.requiredQuestionCount==0&&(e.requiredQuestionCount=1,this.isEmpty()||(e.answeredQuestionCount=1)),e}initElement(e){e&&(e.setSurveyImpl(this),e.disableDesignActions=!0)}setSurveyImpl(e,t){this.isSettingValOnLoading=!0,super.setSurveyImpl(e,t),this.initElement(this.getElement()),this.isSettingValOnLoading=!1}onCustomQuestionLoaded(){!this.isLoadedCalled&&this.customQuestion&&this.survey&&(this.customQuestion.onLoaded(this),this.isLoadedCalled=!0)}onSurveyLoad(){super.onSurveyLoad(),this.isLoadedCalled=!1,this.getElement()&&this.getElement().onSurveyLoad(),this.onCustomQuestionLoaded()}setSurveyCore(e){super.setSurveyCore(e),this.isLoadedCalled===!1&&e&&this.onCustomQuestionLoaded()}afterRenderQuestionElement(e){}afterRenderCore(e){super.afterRenderCore(e),this.customQuestion&&this.customQuestion.onAfterRender(this,e)}onUpdateQuestionCssClasses(e,t){this.customQuestion&&this.customQuestion.onUpdateQuestionCssClasses(this,e,t)}setQuestionValue(e,t=!0){super.setQuestionValue(e,t),this.updateElementCss(),this.customQuestion&&this.customQuestion.onSetQuestionValue(this,e)}setNewValue(e){super.setNewValue(e),this.updateElementCss()}onCheckForErrors(e,t,s){if(super.onCheckForErrors(e,t,s),this.customQuestion){const i=this.customQuestion.onGetErrorText(this);i&&e.push(new vs(i,this))}}getSurveyData(){return this}getTextProcessor(){return this.textProcessor}getValue(e){return this.value}setValue(e,t,s,i){if(!this.data)return;this.customQuestion&&this.customQuestion.onValueChanged(this,e,t);var r=this.convertDataName(e);let a=this.convertDataValue(e,t);this.valueToDataCallback&&(a=this.valueToDataCallback(a)),this.data.setValue(r,a,s,i),this.updateIsAnswered(),this.updateElementCss()}getQuestionByName(e){}isValueChanging(e,t){if(this.customQuestion){const s=t;if(t=this.customQuestion.onValueChanging(this,e,t),!O.isTwoValueEquals(t,s)){const i=this.getQuestionByName(e);if(i)return i.value=t,!0}}return!1}convertDataName(e){return this.getValueName()}convertDataValue(e,t){return t}getVariable(e){return this.data?this.data.getVariable(e):null}setVariable(e,t){this.data&&this.data.setVariable(e,t)}getComment(e){return this.data?this.data.getComment(this.getValueName()):""}setComment(e,t,s){this.data&&this.data.setComment(this.getValueName(),t,s)}getAllValues(){return this.data?this.data.getAllValues():{}}getFilteredProperties(){return this.data?this.data.getFilteredProperties():{}}findQuestionByName(e){return this.data?this.data.findQuestionByName(e):null}getEditingSurveyElement(){}addElement(e,t){}removeElement(e){return!1}getQuestionTitleLocation(){return"left"}getQuestionTitleWidth(){}getColumsForElement(e){return[]}updateColumns(){}getQuestionStartIndex(){return this.getStartIndex()}getChildrenLayoutType(){return"row"}elementWidthChanged(e){}get elements(){return[]}indexOf(e){return-1}ensureRowsVisibility(){}validateContainerOnly(){}onQuestionValueChanged(e){}getQuestionErrorLocation(){return this.getErrorLocation()}getContentAriaHidden(){return this.isDesignMode||super.getContentAriaHidden()}getContentDisplayValueCore(e,t,s){return s?this.customQuestion.getDisplayValue(e,t,s):super.getDisplayValueCore(e,t)}},_P=class extends _y{getTemplate(){return"custom"}getDynamicProperties(){return this.customQuestion.getDynamicProperties()||[]}getDynamicType(){return this.questionWrapper?this.questionWrapper.getType():"question"}getOriginalObj(){return this.questionWrapper}createWrapper(){this.questionWrapper=this.createQuestion(),this.createDynamicProperties(this.questionWrapper),this.getDynamicProperties().length>0&&(this.questionWrapper.onPropertyValueChangedCallback=(e,t,s,i,r)=>{this.getDynamicProperty(e)&&this.propertyValueChanged(e,t,s,r)})}getDynamicProperty(e){const t=this.getDynamicProperties();for(let s=0;s<t.length;s++)if(t[s].name===e)return t[s];return null}getElement(){return this.contentQuestion}supportAutoAdvance(){return!!this.contentQuestion&&this.contentQuestion.supportAutoAdvance()}onAnyValueChanged(e,t){super.onAnyValueChanged(e,t),this.contentQuestion&&this.contentQuestion.onAnyValueChanged(e,t)}getQuestionByName(e){return this.contentQuestion}getDefaultTitle(){return this.hasJSONTitle&&this.contentQuestion?this.getProcessedText(this.contentQuestion.title):super.getDefaultTitle()}setValue(e,t,s,i){this.isValueChanging(e,t)||super.setValue(e,t,s,i)}updateCommentFromSurvey(e){super.updateCommentFromSurvey(e);const t=this.contentQuestion;t&&t.updateCommentFromSurvey(e)}get requireUpdateCommentValue(){var e;return(e=this.contentQuestion)===null||e===void 0?void 0:e.requireUpdateCommentValue}onSetData(){super.onSetData(),this.survey&&!this.isEmpty()&&this.setValue(this.name,this.value,!1,this.allowNotifyValueChanged)}validateElementCore(e){if(!this.contentQuestion)return!0;var t=this.contentQuestion.validateElement(e);this.errors=[];for(var s=0;s<this.contentQuestion.errors.length;s++)this.errors.push(this.contentQuestion.errors[s]);return t=t&&super.validateElementCore(e),this.updateElementCss(),t}focus(e=!1){this.contentQuestion?this.contentQuestion.focus(e):super.focus(e)}afterRenderCore(e){super.afterRenderCore(e),this.contentQuestion&&this.contentQuestion.afterRender(e)}get contentQuestion(){return this.questionWrapper}createQuestion(){var e=this.customQuestion.json,t=null;if(e.questionJSON){this.hasJSONTitle=!!e.questionJSON.title;let s=e.questionJSON.type;if(!s||!q.findClass(s))throw"type attribute in questionJSON is empty or incorrect";t=q.createClass(s),t.fromJSON(e.questionJSON),t=this.checkCreatedQuestion(t)}else e.createQuestion&&(t=this.checkCreatedQuestion(e.createQuestion()));return this.initElement(t),t&&(t.isContentElement=!0,t.name||(t.name="question"),t.onUpdateCssClassesCallback=s=>{this.onUpdateQuestionCssClasses(t,s)},t.hasCssErrorCallback=()=>this.errors.length>0,t.setValueChangedDirectlyCallback=s=>{this.setValueChangedDirectly(s)}),t}checkCreatedQuestion(e){return e&&(e.isQuestion||(Array.isArray(e.questions)&&e.questions.length>0?e=e.questions[0]:e=q.createClass("text"),ri.error("Could not create component: '"+this.getType()+"'. questionJSON should be a question.")),e)}onSurveyLoad(){super.onSurveyLoad(),this.contentQuestion&&this.isEmpty()&&!this.contentQuestion.isEmpty()&&(this.value=this.getContentQuestionValue())}runConditionCore(e){super.runConditionCore(e),this.contentQuestion&&this.contentQuestion.runCondition(e)}convertDataName(e){const t=this.contentQuestion;if(!t||e===this.getValueName())return super.convertDataName(e);var s=e.replace(t.getValueName(),this.getValueName());return s.indexOf(this.getValueName())==0?s:super.convertDataName(e)}convertDataValue(e,t){return this.convertDataName(e)==super.convertDataName(e)?this.getContentQuestionValue():t}getContentQuestionValue(){if(!this.contentQuestion)return;let e=this.contentQuestion.value;return this.customQuestion&&(e=this.customQuestion.getValueFromQuestion(e)),e}setContentQuestionValue(e){this.contentQuestion&&(this.customQuestion&&(e=this.customQuestion.setValueToQuestion(e)),this.contentQuestion.value=e)}canSetValueToSurvey(){return!1}setQuestionValue(e,t=!0){super.setQuestionValue(e,t),!this.isLoadingFromJson&&this.contentQuestion&&!this.isTwoValueEquals(this.getContentQuestionValue(),e)&&this.setContentQuestionValue(this.getUnbindValue(e))}onSurveyValueChanged(e){super.onSurveyValueChanged(e),this.contentQuestion&&this.contentQuestion.onSurveyValueChanged(e)}getValueCore(){return this.contentQuestion?this.getContentQuestionValue():super.getValueCore()}setValueChangedDirectly(e){this.isSettingValueChanged||(this.isSettingValueChanged=!0,super.setValueChangedDirectly(e),this.contentQuestion&&this.contentQuestion.setValueChangedDirectly(e),this.isSettingValueChanged=!1)}createDynamicProperties(e){if(!e)return;const t=this.getDynamicProperties();Array.isArray(t)&&q.addDynamicPropertiesIntoObj(this,e,t)}initElement(e){super.initElement(e),e&&(e.parent=this,e.afterRenderQuestionCallback=(t,s)=>{this.customQuestion&&this.customQuestion.onAfterRenderContentElement(this,t,s)},e.onGetNoCallback=t=>this.no)}updateElementCss(e){this.contentQuestion&&this.questionWrapper.updateElementCss(e),super.updateElementCss(e)}setIsMobile(e){super.setIsMobile(e),this.contentQuestion&&this.contentQuestion.setIsMobile(e)}updateElementCssCore(e){this.contentQuestion&&(e=this.contentQuestion.cssClasses),super.updateElementCssCore(e)}getDisplayValueCore(e,t){return super.getContentDisplayValueCore(e,t,this.contentQuestion)}},LP=class extends io{constructor(e){super(e),this.question=e}getValue(e,t,s,i){const r=this.question;return e.length>0&&(e.length>1||!t)?(e[0].name===A.expressionVariables.composite&&e.shift(),new Gu(r.contentPanel.questions).getValue(e,!1,s,i)):{isFound:!1}}},AP=class extends _y{constructor(e,t){super(e,t),this.customQuestion=t,this.settingNewValue=!1,this.textProcessing=new no(this)}createWrapper(){this.panelWrapper=this.createPanel()}getTemplate(){return"composite"}getElement(){return this.contentPanel}getCssRoot(e){return new z().append(super.getCssRoot(e)).append(e.composite).toString()}get contentPanel(){return this.panelWrapper}validateElementCore(e){const t=super.validateElementCore(e),s=this.contentPanel;return s?s.validateElement(e)&&t:t}updateElementCss(e){super.updateElementCss(e),this.contentPanel&&this.contentPanel.updateElementCss(e)}dispose(){this.unConnectEditingObj(),super.dispose()}updateEditingObj(){var e;const t=(e=this.data)===null||e===void 0?void 0:e.getEditingSurveyElement();if(!t)return;let s=t[this.getValueName()];return s&&!s.onPropertyChanged&&(s=void 0),s!==this.editingObjValue&&(this.unConnectEditingObj(),this.editingObjValue=s,s&&(this.onEditingObjPropertyChanged=(i,r)=>{this.setNewValueIntoQuestion(r.name,this.editingObjValue[r.name])},s.onPropertyChanged.add(this.onEditingObjPropertyChanged))),this.editingObjValue}unConnectEditingObj(){this.editingObjValue&&!this.editingObjValue.isDisposed&&this.editingObjValue.onPropertyChanged.remove(this.onEditingObjPropertyChanged)}getEditingSurveyElement(){return this.editingObjValue}getTextProcessor(){return this.textProcessing}findQuestionByName(e){const t=this.getQuestionByName(e);return t||super.findQuestionByName(e)}clearValueIfInvisibleCore(e){super.clearValueIfInvisibleCore(e);const t=this.contentPanel.questions;for(var s=0;s<t.length;s++)t[s].clearValueIfInvisible(e)}onAnyValueChanged(e,t){super.onAnyValueChanged(e,t);for(var s=this.contentPanel.questions,i=0;i<s.length;i++)s[i].onAnyValueChanged(e,t)}get isContainer(){return!0}createPanel(){var e=q.createClass("panel");e.showQuestionNumbers="off",e.renderWidth="100%";var t=this.customQuestion.json;return t.elementsJSON&&e.fromJSON({elements:t.elementsJSON}),t.createElements&&t.createElements(e,this),this.initElement(e),this.setIsContentElement(e),e.readOnly=this.isReadOnly,e.onGetNoCallback=s=>this.no,e.questions.forEach(s=>{s.setParentQuestion(this),s.onUpdateCssClassesCallback=i=>{this.onUpdateQuestionCssClasses(s,i)}}),this.setAfterRenderCallbacks(e),e}onReadOnlyChanged(){this.contentPanel&&(this.contentPanel.readOnly=this.isReadOnly),super.onReadOnlyChanged()}updateValueFromSurvey(e,t=!1){this.updateEditingObj(),super.updateValueFromSurvey(e,t)}onSurveyLoad(){if(this.isSettingValOnLoading=!0,this.contentPanel&&(this.contentPanel.readOnly=this.isReadOnly,this.setIsContentElement(this.contentPanel)),super.onSurveyLoad(),this.contentPanel){const e=this.getContentPanelValue();O.isValueEmpty(e)||(this.value=e)}this.isSettingValOnLoading=!1}setIsContentElement(e){e.isContentElement=!0;for(var t=e.elements,s=0;s<t.length;s++){var i=t[s];i.isPanel?this.setIsContentElement(i):i.isContentElement=!0}}setVisibleIndex(e){if(this.isVisibleIndexNegative(e))return super.setVisibleIndex(-1);let t=super.setVisibleIndex(e);return this.isVisible&&this.contentPanel&&(t+=this.contentPanel.setVisibleIndex(e+1)),t}runConditionCore(e){super.runConditionCore(e),this.contentPanel&&this.contentPanel.runCondition(e)}onSurveyValueChanged(e){super.onSurveyValueChanged(e);const t=e||{};this.contentPanel&&this.contentPanel.questions.forEach(s=>{s.onSurveyValueChanged(t[s.getValueName()])})}getValue(e){var t=this.value;return t?t[e]:null}getQuestionByName(e){return this.contentPanel?this.contentPanel.getQuestionByName(e):void 0}setValue(e,t,s,i){if(this.settingNewValue){this.setNewValueIntoQuestion(e,t);return}if(!this.isValueChanging(e,t)){if(this.settingNewValue=!0,!this.isEditingSurveyElement&&this.contentPanel){let r=0;const a=this.contentPanel.questions.length+1;for(;r<a&&this.updateValueCoreWithPanelValue();)r++}this.setNewValueIntoQuestion(e,t),super.setValue(e,t,s,i),this.settingNewValue=!1,this.runPanelTriggers(A.expressionVariables.composite+"."+e,t),this.isEditingSurveyElement&&this.runCondition(this.getFilteredProperties())}}setComment(e,t,s){let i=this.getUnbindValue(this.value);const r=this.getCommentName(e);if(!i&&!t||t&&i&&i[r]===t)return;t?(i||(i={}),i[r]=t):delete i[r];const a=this.getQuestionByName(e);a&&a.comment!==t&&(a.comment=t),this.settingNewValue||(this.value=i)}getComment(e){const t=this.getQuestionByName(e);if(t)return t.comment;const s=this.value;return!!s&&s[this.getCommentName(e)]||""}getCommentName(e){return e+A.commentSuffix}runPanelTriggers(e,t){this.contentPanel&&this.contentPanel.questions.forEach(s=>{s.runTriggers(e,t)})}updateValueCoreWithPanelValue(){const e=this.getContentPanelValue();return this.isTwoValueEquals(this.getValueCore(),e)?!1:(this.setValueCore(e),!0)}getContentPanelValue(e){return e||(e=this.contentPanel.getValue()),this.customQuestion.setValueToQuestion(e)}getValueForContentPanel(e){return this.customQuestion.getValueFromQuestion(e)}setNewValueIntoQuestion(e,t){var s=this.getQuestionByName(e);s&&!this.isTwoValueEquals(t,s.value)&&(s.value=t)}addConditionObjectsByContext(e,t){if(this.contentPanel)for(var s=this.contentPanel.questions,i=this.name,r=this.title,a=0;a<s.length;a++)e.push({name:i+"."+s[a].name,text:r+"."+s[a].title,question:s[a]})}collectNestedQuestionsCore(e,t,s,i){this.contentPanel&&(i&&e.push(this),this.contentPanel.questions.forEach(r=>r.addNestedQuestion(e,t,s,i)))}convertDataValue(e,t){var s=this.contentPanel&&!this.isEditingSurveyElement?this.contentPanel.getValue():this.getValueForContentPanel(this.value);return s||(s={}),s.getType||(s=O.getUnbindValue(s)),this.isValueEmpty(t)&&!this.isEditingSurveyElement?delete s[e]:s[e]=t,this.getContentPanelValue(s)}setQuestionValue(e,t=!0){this.setValuesIntoQuestions(e),!this.isEditingSurveyElement&&this.contentPanel&&(e=this.getContentPanelValue()),super.setQuestionValue(e,t)}setValuesIntoQuestions(e){if(!this.contentPanel||this.settingNewValue)return;e=this.getValueForContentPanel(e);const t=this.settingNewValue;this.settingNewValue=!0;const s=this.contentPanel.questions;for(var i=0;i<s.length;i++){const r=s[i],a=r.getValueName(),o=this.getCommentName(a),l=e?e[a]:void 0,u=!!e&&e[o]||"";!this.isTwoValueEquals(r.value,l)&&(l!==void 0||!r.isEmpty())&&(r.value=l),r.comment!==u&&(r.comment=u)}this.settingNewValue=t}getValueGetterContext(){return new LP(this)}getDisplayValueCore(e,t){return super.getContentDisplayValueCore(e,t,this.contentPanel)}setAfterRenderCallbacks(e){if(!(!e||!this.customQuestion))for(var t=e.questions,s=0;s<t.length;s++)t[s].afterRenderQuestionCallback=(i,r)=>{this.customQuestion.onAfterRenderContentElement(this,i,r)}}get ariaRole(){return"group"}setIsMobile(e){super.setIsMobile(e),this.contentPanel&&this.contentPanel.questions.forEach(t=>{t.setIsMobile(e)})}},qe=class{static get DefaultChoices(){const e=Ct("choices_Item");return[e+"1",e+"2",e+"3"]}static get DefaultColums(){var e=Ct("matrix_column")+" ";return[e+"1",e+"2",e+"3"]}static get DefaultRows(){var e=Ct("matrix_row")+" ";return[e+"1",e+"2"]}static get DefaultMutlipleTextItems(){var e=Ct("multipletext_itemname");return[e+"1",e+"2"]}registerQuestion(e,t,s=!0){oi.Instance.registerElement(e,t,s)}registerCustomQuestion(e){oi.Instance.registerCustomQuestion(e)}unregisterElement(e,t=!1){oi.Instance.unregisterElement(e,t)}clear(){oi.Instance.clear()}getAllTypes(){return oi.Instance.getAllTypes()}createQuestion(e,t){return oi.Instance.createElement(e,t)}};qe.Instance=new qe;let oi=class{constructor(){this.creatorHash={},this.registerCustomQuestion=(e,t=!0)=>{const s=i=>{const r=q.createClass(e);return r&&(r.name=i),r};this.registerElement(e,s,t)}}registerElement(e,t,s=!0){this.creatorHash[e]={showInToolbox:s,creator:t}}clear(){this.creatorHash={}}unregisterElement(e,t=!1){delete this.creatorHash[e],t&&q.removeClass(e)}getAllToolboxTypes(){return this.getAllTypesCore(!0)}getAllTypes(){return this.getAllTypesCore(!1)}createElement(e,t){var s=this.creatorHash[e];if(s&&s.creator)return s.creator(t);const i=tn.Instance.getCustomQuestionByName(e);return i?tn.Instance.createQuestion(t,i):null}getAllTypesCore(e){var t=new Array;for(var s in this.creatorHash)(!e||this.creatorHash[s].showInToolbox)&&t.push(s);return t.sort()}};oi.Instance=new oi;let Ly=class extends Dt{constructor(e){super(e),this.createLocalizableString("format"),this.registerPropertyChangedHandlers(["format","currency","displayStyle"],()=>{this.updateFormatedValue()})}getType(){return"expression"}get hasInput(){return!1}get format(){return this.getLocalizableStringText("format","")}set format(e){this.setLocalizableStringText("format",e)}get locFormat(){return this.getLocalizableString("format")}get expression(){return this.getPropertyValue("expression","")}set expression(e){this.setPropertyValue("expression",e)}locCalculation(){this.isExecutionLocked=!0}unlocCalculation(){this.isExecutionLocked=!1}runConditionCore(e){super.runConditionCore(e),!(this.isExecutionLocked||!this.runIfReadOnly&&this.isReadOnly)&&this.runExpressionByProperty("expression",e,t=>{this.value=this.roundValue(t)})}canCollectErrors(){return!0}hasRequiredError(){return!1}get maximumFractionDigits(){return this.getPropertyValue("maximumFractionDigits")}set maximumFractionDigits(e){e<-1||e>20||this.setPropertyValue("maximumFractionDigits",e)}get minimumFractionDigits(){return this.getPropertyValue("minimumFractionDigits")}set minimumFractionDigits(e){e<-1||e>20||this.setPropertyValue("minimumFractionDigits",e)}get runIfReadOnly(){return this.runIfReadOnlyValue===!0}set runIfReadOnly(e){this.runIfReadOnlyValue=e}get formatedValue(){return this.getPropertyValue("formatedValue","")}updateFormatedValue(){this.setPropertyValue("formatedValue",this.getDisplayValueCore(!1,this.value))}onValueChanged(){this.updateFormatedValue()}updateValueFromSurvey(e,t){super.updateValueFromSurvey(e,t),this.updateFormatedValue()}getDisplayValueCore(e,t){var s=t??this.defaultValue,i="";if(!this.isValueEmpty(s)){var r=this.getValueAsStr(s);i=this.format?this.format.format(r):r}return this.survey&&(i=this.survey.getExpressionDisplayValue(this,s,i)),i}get displayStyle(){return this.getPropertyValue("displayStyle")}set displayStyle(e){this.setPropertyValue("displayStyle",e)}get currency(){return this.getPropertyValue("currency")}set currency(e){ao().indexOf(e)<0||this.setPropertyValue("currency",e)}get useGrouping(){return this.getPropertyValue("useGrouping")}set useGrouping(e){this.setPropertyValue("useGrouping",e)}get precision(){return this.getPropertyValue("precision")}set precision(e){this.setPropertyValue("precision",e)}roundValue(e){if(e!==1/0)return this.precision<0||!O.isNumber(e)?e:parseFloat(e.toFixed(this.precision))}getValueAsStr(e){if(this.displayStyle=="date"){const i=Rt("question-expression",e);if(i&&i.toLocaleDateString)return i.toLocaleDateString()}if(this.displayStyle!="none"&&O.isNumber(e)){var t=this.getLocale();t||(t="en");var s={style:this.displayStyle,currency:this.currency,useGrouping:this.useGrouping};return this.maximumFractionDigits>-1&&(s.maximumFractionDigits=this.maximumFractionDigits),this.minimumFractionDigits>-1&&(s.minimumFractionDigits=this.minimumFractionDigits),e.toLocaleString(t,s)}return e.toString()}get ariaRole(){return"presentation"}};function ao(){return["AED","AFN","ALL","AMD","ANG","AOA","ARS","AUD","AWG","AZN","BAM","BBD","BDT","BGN","BHD","BIF","BMD","BND","BOB","BOV","BRL","BSD","BTN","BWP","BYN","BZD","CAD","CDF","CHE","CHF","CHW","CLF","CLP","CNY","COP","COU","CRC","CUC","CUP","CVE","CZK","DJF","DKK","DOP","DZD","EGP","ERN","ETB","EUR","FJD","FKP","GBP","GEL","GHS","GIP","GMD","GNF","GTQ","GYD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","INR","IQD","IRR","ISK","JMD","JOD","JPY","KES","KGS","KHR","KMF","KPW","KRW","KWD","KYD","KZT","LAK","LBP","LKR","LRD","LSL","LYD","MAD","MDL","MGA","MKD","MMK","MNT","MOP","MRO","MUR","MVR","MWK","MXN","MXV","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","PYG","QAR","RON","RSD","RUB","RWF","SAR","SBD","SCR","SDG","SEK","SGD","SHP","SLL","SOS","SRD","SSP","STD","SVC","SYP","SZL","THB","TJS","TMT","TND","TOP","TRY","TTD","TWD","TZS","UAH","UGX","USD","USN","UYI","UYU","UZS","VEF","VND","VUV","WST","XAF","XAG","XAU","XBA","XBB","XBC","XBD","XCD","XDR","XOF","XPD","XPF","XPT","XSU","XTS","XUA","XXX","YER","ZAR","ZMW","ZWL"]}function Ay(n,e,t){let s=t?e:n;return n==-1||e==-1?s:n>e?t?n:e:s}q.addClass("expression",["expression:expression",{name:"format",serializationProperty:"locFormat"},{name:"displayStyle",default:"none",choices:["none","decimal","currency","percent","date"]},{name:"currency",choices:()=>ao(),default:"USD",visibleIf:n=>n.displayStyle==="currency"},{name:"maximumFractionDigits:number",onSettingValue:(n,e)=>Ay(n.minimumFractionDigits,e,!0),default:-1},{name:"minimumFractionDigits:number",onSettingValue:(n,e)=>Ay(e,n.maximumFractionDigits,!1),default:-1},{name:"useGrouping:boolean",default:!0},{name:"precision:number",default:-1,category:"data"},{name:"enableIf",visible:!1,isSerializable:!1},{name:"isRequired",visible:!1,isSerializable:!1},{name:"readOnly",visible:!1,isSerializable:!1},{name:"requiredErrorText",visible:!1,isSerializable:!1},{name:"resetValueIf",visible:!1,isSerializable:!1},{name:"setValueIf",visible:!1,isSerializable:!1},{name:"setValueExpression",visible:!1,isSerializable:!1},{name:"defaultValueExpression",visible:!1,isSerializable:!1},{name:"defaultValue",visible:!1,isSerializable:!1},{name:"correctAnswer",visible:!1,isSerializable:!1},{name:"requiredIf",visible:!1,isSerializable:!1}],function(){return new Ly("")},"question"),qe.Instance.registerQuestion("expression",n=>new Ly(n));let DP=class{constructor(e){this.column=e}getValue(e,t,s,i){if(e.length===1&&["name","item"].indexOf(e[0].name)>-1)return{isFound:!0,value:this.column.name}}getRootObj(){return this.column.colOwner}};function oo(n,e,t,s){n.storeOthersAsComment=t?t.storeOthersAsComment:!1,(!n.choices||n.choices.length==0)&&n.choicesByUrl.isEmpty&&(n.choices=t.choices),n.choicesByUrl.isEmpty||n.choicesByUrl.run(s.getTextProcessor())}function OP(n,e,t,s){oo(n,e,t,s),n.locPlaceholder&&n.locPlaceholder.isEmpty&&!t.locPlaceholder.isEmpty&&(n.placeholder=t.placeholder)}var Dy={dropdown:{onCellQuestionUpdate:(n,e,t,s)=>{OP(n,e,t,s)}},checkbox:{onCellQuestionUpdate:(n,e,t,s)=>{oo(n,e,t,s),n.colCount=e.colCount>-1?e.colCount:t.columnColCount}},radiogroup:{onCellQuestionUpdate:(n,e,t,s)=>{oo(n,e,t,s),n.colCount=e.colCount>-1?e.colCount:t.columnColCount}},tagbox:{onCellQuestionUpdate:(n,e,t,s)=>{oo(n,e,t,s)}},text:{},comment:{},boolean:{onCellQuestionUpdate:(n,e,t,s)=>{n.renderAs=e.renderAs}},expression:{},rating:{},slider:{}};let lo=class extends Te{static getColumnTypes(){var e=[];for(var t in Dy)e.push(t);return e}constructor(e,t,s){super(),this.indexValue=-1,this._hasVisibleCell=!0,this.isColumnsVisibleIf=!0,this.previousChoicesId=void 0,this.colOwnerValue=s,this.createLocalizableString("totalFormat"),this.createLocalizableString("cellHint"),this.registerPropertyChangedHandlers(["showInMultipleColumns"],()=>{this.doShowInMultipleColumnsChanged()}),this.registerPropertyChangedHandlers(["visible"],()=>{this.doColumnVisibilityChanged()}),this.updateTemplateQuestion(void 0,e,t)}getOriginalObj(){return this.templateQuestion}getClassNameProperty(){return"cellType"}getSurvey(e=!1){return this.colOwner?this.colOwner.survey:null}endLoadingFromJson(){super.endLoadingFromJson(),this.templateQuestion.autoOtherMode=this.isShowInMultipleColumns,this.templateQuestion.endLoadingFromJson(),this.templateQuestion.onGetSurvey=()=>this.getSurvey()}getDynamicPropertyName(){return"cellType"}getDynamicType(){return this.cellType==="default"?"question":this.calcCellQuestionType(null)}get colOwner(){return this.colOwnerValue}set colOwner(e){this.colOwnerValue=e,e&&(this.updateTemplateQuestion(),this.setParentQuestionToTemplate(this.templateQuestion))}getValueGetterContext(){return new DP(this)}locStrsChanged(){super.locStrsChanged(),this.locTitle.strChanged()}addUsedLocales(e){super.addUsedLocales(e),this.templateQuestion.addUsedLocales(e)}get index(){return this.indexValue}setIndex(e){this.indexValue=e}getType(){return"matrixdropdowncolumn"}get cellType(){return this.getPropertyValue("cellType")}set cellType(e){e=e.toLocaleLowerCase(),this.updateTemplateQuestion(e),this.setPropertyValue("cellType",e),this.colOwner&&this.colOwner.onColumnCellTypeChanged(this)}get templateQuestion(){return this.templateQuestionValue}get value(){return this.templateQuestion.name}get isVisible(){return!0}get isColumnVisible(){return this.isDesignMode?!0:this.visible&&this.hasVisibleCell}get visible(){return this.templateQuestion.visible}set visible(e){this.templateQuestion.visible=e}get hasVisibleCell(){return this._hasVisibleCell}set hasVisibleCell(e){this._hasVisibleCell=e}getVisibleMultipleChoices(){const e=this.templateQuestion.visibleChoices;if(!Array.isArray(e))return[];if(!Array.isArray(this._visiblechoices))return e;const t=new Array;for(let s=0;s<e.length;s++){const i=e[s];this._visiblechoices.indexOf(i.value)>-1&&t.push(i)}return t}get getVisibleChoicesInCell(){if(Array.isArray(this._visiblechoices))return this._visiblechoices;const e=this.templateQuestion.visibleChoices;return Array.isArray(e)?e:[]}setVisibleChoicesInCell(e){this._visiblechoices=e}get isFilteredMultipleColumns(){if(!this.showInMultipleColumns)return!1;const e=this.templateQuestion.choices;if(!Array.isArray(e))return!1;for(let t=0;t<e.length;t++)if(e[t].visibleIf)return!0;return!1}get name(){return this.templateQuestion.name}set name(e){this.templateQuestion.name=e}get title(){return this.templateQuestion.title}set title(e){this.templateQuestion.title=e}get locTitle(){return this.templateQuestion.locTitle}get fullTitle(){return this.locTitle.textOrHtml}get defaultDisplayValue(){return this.templateQuestion.defaultDisplayValue}set defaultDisplayValue(e){this.templateQuestion.defaultDisplayValue=e}get locDefaultDisplayValue(){return this.templateQuestion.locDefaultDisplayValue}get isRequired(){return this.getPropertyValue("isRequired")}set isRequired(e){this.setPropertyValue("isRequired",e),this.templateQuestion.isRequired=e}get isRenderedRequired(){return this.getPropertyValue("isRenderedRequired",this.isRequired)}set isRenderedRequired(e){this.setPropertyValue("isRenderedRequired",e)}updateIsRenderedRequired(e){this.isRenderedRequired=e||this.isRequired}get requiredMark(){return this.isRenderedRequired&&this.getSurvey()?this.getSurvey().requiredMark:this.templateQuestion.requiredMark}get requiredErrorText(){return this.templateQuestion.requiredErrorText}set requiredErrorText(e){this.templateQuestion.requiredErrorText=e}get locRequiredErrorText(){return this.templateQuestion.locRequiredErrorText}get readOnly(){return this.templateQuestion.readOnly}set readOnly(e){this.templateQuestion.readOnly=e}get hasOther(){return this.showOtherItem}set hasOther(e){this.showOtherItem=e}get showOtherItem(){return this.templateQuestion.showOtherItem}set showOtherItem(e){this.templateQuestion.showOtherItem=e}get visibleIf(){return this.templateQuestion.visibleIf}set visibleIf(e){this.templateQuestion.visibleIf=e}get enableIf(){return this.templateQuestion.enableIf}set enableIf(e){this.templateQuestion.enableIf=e}get requiredIf(){return this.templateQuestion.requiredIf}set requiredIf(e){this.templateQuestion.requiredIf=e}get resetValueIf(){return this.templateQuestion.resetValueIf}set resetValueIf(e){this.templateQuestion.resetValueIf=e}get defaultValueExpression(){return this.templateQuestion.defaultValueExpression}set defaultValueExpression(e){this.templateQuestion.defaultValueExpression=e}get setValueIf(){return this.templateQuestion.setValueIf}set setValueIf(e){this.templateQuestion.setValueIf=e}get setValueExpression(){return this.templateQuestion.setValueExpression}set setValueExpression(e){this.templateQuestion.setValueExpression=e}get isUnique(){return this.getPropertyValue("isUnique")}set isUnique(e){this.setPropertyValue("isUnique",e)}get showInMultipleColumns(){return this.getPropertyValue("showInMultipleColumns")}set showInMultipleColumns(e){this.setPropertyValue("showInMultipleColumns",e)}get isSupportMultipleColumns(){return["checkbox","radiogroup"].indexOf(this.cellType)>-1}get isShowInMultipleColumns(){return this.showInMultipleColumns&&this.isSupportMultipleColumns}get validators(){return this.templateQuestion.validators}set validators(e){this.templateQuestion.validators=e}get totalType(){return this.getPropertyValue("totalType")}set totalType(e){this.setPropertyValue("totalType",e)}get totalExpression(){return this.getPropertyValue("totalExpression")}set totalExpression(e){this.setPropertyValue("totalExpression",e)}get hasTotal(){return this.totalType!="none"||!!this.totalExpression}get totalFormat(){return this.getLocalizableStringText("totalFormat","")}set totalFormat(e){this.setLocalizableStringText("totalFormat",e)}get locTotalFormat(){return this.getLocalizableString("totalFormat")}get cellHint(){return this.getLocalizableStringText("cellHint","")}set cellHint(e){this.setLocalizableStringText("cellHint",e)}get locCellHint(){return this.getLocalizableString("cellHint")}get renderAs(){return this.getPropertyValue("renderAs")}set renderAs(e){this.setPropertyValue("renderAs",e),this.templateQuestion&&(this.templateQuestion.renderAs=e)}get totalMaximumFractionDigits(){return this.getPropertyValue("totalMaximumFractionDigits")}set totalMaximumFractionDigits(e){e<-1||e>20||this.setPropertyValue("totalMaximumFractionDigits",e)}get totalMinimumFractionDigits(){return this.getPropertyValue("totalMinimumFractionDigits")}set totalMinimumFractionDigits(e){e<-1||e>20||this.setPropertyValue("totalMinimumFractionDigits",e)}get totalDisplayStyle(){return this.getPropertyValue("totalDisplayStyle")}set totalDisplayStyle(e){this.setPropertyValue("totalDisplayStyle",e)}get totalAlignment(){return this.getPropertyValue("totalAlignment")}set totalAlignment(e){this.setPropertyValue("totalAlignment",e)}get totalCurrency(){return this.getPropertyValue("totalCurrency")}set totalCurrency(e){ao().indexOf(e)<0||this.setPropertyValue("totalCurrency",e)}get minWidth(){return this.getPropertyValue("minWidth","")}set minWidth(e){this.setPropertyValue("minWidth",e)}get width(){return this.templateQuestion.width}set width(e){this.templateQuestion.width=e}get colCount(){return this.getPropertyValue("colCount")}set colCount(e){e<-1||e>4||this.setPropertyValue("colCount",e)}getLocale(){return this.colOwner?this.colOwner.getLocale():""}getMarkdownHtml(e,t,s){return this.colOwner?this.colOwner.getMarkdownHtml(e,t,s):void 0}getRenderer(e){return this.colOwner?this.colOwner.getRenderer(e):null}getRendererContext(e){return this.colOwner?this.colOwner.getRendererContext(e):e}getProcessedText(e){return this.colOwner?this.colOwner.getProcessedText(e):e}createCellQuestion(e){var t=this.calcCellQuestionType(e),s=this.createNewQuestion(t);return this.callOnCellQuestionUpdate(s,e),s}startLoadingFromJson(e){super.startLoadingFromJson(e),e&&!e.cellType&&e.choices&&(e.cellType=this.colOwner.getCellType())}updateCellQuestion(e,t,s=null){this.setQuestionProperties(e,s)}callOnCellQuestionUpdate(e,t){var s=e.getType(),i=Dy[s];i&&i.onCellQuestionUpdate&&i.onCellQuestionUpdate(e,this,this.colOwner,t)}defaultCellTypeChanged(){this.updateTemplateQuestion()}calcCellQuestionType(e){let t=this.getDefaultCellQuestionType();return e&&this.colOwner&&(t=this.colOwner.getCustomCellType(this,e,t)),t}getDefaultCellQuestionType(e){return e||(e=this.cellType),e!=="default"?e:this.colOwner?this.colOwner.getCellType():A.matrix.defaultCellType}updateTemplateQuestion(e,t,s){const i=this.getDefaultCellQuestionType(e),r=this.templateQuestion?this.templateQuestion.getType():"";i!==r&&(this.templateQuestion&&this.removeProperties(r),this.templateQuestionValue=this.createNewQuestion(i),this.templateQuestion.locOwner=this,this.addProperties(i),t&&(this.name=t),s?this.title=s:this.templateQuestion.locTitle.strChanged(),A.serialization.matrixDropdownColumnSerializeTitle&&(this.templateQuestion.locTitle.serializeCallBackText=!0),this.templateQuestion.onPropertyChanged.add((a,o)=>{this.propertyValueChanged(o.name,o.oldValue,o.newValue,o.arrayChanges,o.target)}),this.templateQuestion.onNestedPropertyChanged.add((a,o)=>{this.colOwner&&!this.isLoadingFromJson&&this.colOwner.onColumnNestedPropertyChanged(this,o.name,o.nestedName,o.newValue)}),this.templateQuestion.onItemValuePropertyChanged.add((a,o)=>{this.doItemValuePropertyChanged(o.propertyName,o.obj,o.name,o.newValue,o.oldValue)}),this.templateQuestion.isContentElement=!0,this.isLoadingFromJson||(this.templateQuestion.onGetSurvey=()=>this.getSurvey()),this.templateQuestion.locTitle.strChanged())}createNewQuestion(e){var t=q.createClass(e);return t||(t=q.createClass("text")),t.loadingOwner=this,t.isEditableTemplateElement=!0,t.autoOtherMode=this.isShowInMultipleColumns,this.setQuestionProperties(t),this.setParentQuestionToTemplate(t),t}setParentQuestionToTemplate(e){this.colOwner&&this.colOwner.isQuestion&&e.setParentQuestion(this.colOwner)}setQuestionProperties(e,t=null){if(this.templateQuestion){var s=new qt().toJsonObject(this.templateQuestion,!0);if(t&&t(s),s.type=e.getType(),this.cellType==="default"&&this.colOwner&&this.colOwner.hasChoices()&&delete s.choices,delete s.itemComponent,this.jsonObj&&s.type==="rating"&&this.isLoadingFromJson&&Object.keys(this.jsonObj).forEach(i=>{s[i]=this.jsonObj[i]}),s.choicesOrder==="random"){s.choicesOrder="none";const i=this.templateQuestion.visibleChoices;Array.isArray(i)&&(s.choices=i)}new qt().toObject(s,e),e.isContentElement=this.templateQuestion.isContentElement,this.previousChoicesId=void 0,e.loadedChoicesFromServerCallback=()=>{if(!this.isShowInMultipleColumns||this.previousChoicesId&&this.previousChoicesId!==e.id)return;this.previousChoicesId=e.id;const i=e.visibleChoices;this.templateQuestion.choices=i,this.propertyValueChanged("choices",i,i)}}}propertyValueChanged(e,t,s,i,r){if(super.propertyValueChanged(e,t,s,i,r),e==="isRequired"&&this.updateIsRenderedRequired(s),!(!this.colOwner||this.isLoadingFromJson)){if(this.isShowInMultipleColumns){if(e==="choicesOrder")return;["visibleChoices","choices"].indexOf(e)>-1&&this.colOwner.onShowInMultipleColumnsChanged(this)}q.hasOriginalProperty(this,e)&&this.colOwner.onColumnPropertyChanged(this,e,s)}}doItemValuePropertyChanged(e,t,s,i,r){q.hasOriginalProperty(t,s)&&this.colOwner!=null&&!this.isLoadingFromJson&&this.colOwner.onColumnItemValuePropertyChanged(this,e,t,s,i,r)}doShowInMultipleColumnsChanged(){this.colOwner!=null&&this.colOwner.onShowInMultipleColumnsChanged(this),this.templateQuestion&&(this.templateQuestion.autoOtherMode=this.isShowInMultipleColumns)}doColumnVisibilityChanged(){this.colOwner!=null&&!this.isDesignMode&&this.colOwner.onColumnVisibilityChanged(this)}getProperties(e){return q.getDynamicPropertiesByObj(this,e)}removeProperties(e){for(var t=this.getProperties(e),s=0;s<t.length;s++){var i=t[s];delete this[i.name],i.serializationProperty&&delete this[i.serializationProperty]}}addProperties(e){const t=this.getProperties(e);q.addDynamicPropertiesIntoObj(this,this.templateQuestion,t)}};q.addClass("matrixdropdowncolumn",[{name:"!name",isUnique:!0},{name:"title",serializationProperty:"locTitle",dependsOn:"name",onPropertyEditorUpdate:function(n,e){n&&e&&(e.placeholder=n.locTitle.getPlaceholder())}},{name:"cellHint",serializationProperty:"locCellHint",visible:!1},{name:"cellType",default:"default",choices:()=>{var n=lo.getColumnTypes();return n.splice(0,0,"default"),n}},{name:"colCount",default:-1,choices:[-1,0,1,2,3,4]},{name:"isRequired:boolean",defaultFunc:n=>{const e=n?.templateQuestion;return e&&q.findProperty(e.getType(),"isRequired").getDefaultValue(e)||!1}},"isUnique:boolean",{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText"},"readOnly:boolean",{name:"minWidth",onPropertyEditorUpdate:function(n,e){n&&e&&(e.value=n.minWidth)}},"width",{name:"visible:switch",default:!0,overridingProperty:"visibleIf"},"visibleIf:condition","enableIf:condition","requiredIf:condition","resetValueIf:condition","setValueIf:condition","setValueExpression:expression",{name:"showInMultipleColumns:boolean",dependsOn:"cellType",visibleIf:n=>n.isSupportMultipleColumns},{name:"validators:validators",baseClassName:"surveyvalidator",classNamePart:"validator"},{name:"totalType",visibleIf:n=>!n.isShowInMultipleColumns,default:"none",choices:["none","sum","count","min","max","avg"]},{name:"totalExpression:expression",visibleIf:n=>!n.isShowInMultipleColumns},{name:"totalFormat",serializationProperty:"locTotalFormat",visibleIf:n=>n.hasTotal},{name:"totalDisplayStyle",visibleIf:n=>n.hasTotal,default:"none",choices:["none","decimal","currency","percent"]},{name:"totalAlignment",visibleIf:n=>n.hasTotal,default:"auto",choices:["auto","left","center","right"]},{name:"totalCurrency",visibleIf:n=>n.hasTotal,choices:()=>ao(),default:"USD"},{name:"totalMaximumFractionDigits:number",default:-1,visibleIf:n=>n.hasTotal},{name:"totalMinimumFractionDigits:number",default:-1,visibleIf:n=>n.hasTotal},{name:"renderAs",default:"default",visible:!1},{name:"defaultDisplayValue",serializationProperty:"locDefaultDisplayValue"}],function(){return new lo("")});function Oy(n,e,t){return n+(e?"-error":"")+(t?"-detail":"")}let Hs=class Qw{constructor(){this.minWidth="",this.width="",this.colSpans=1,this.isActionsCell=!1,this.isErrorsCell=!1,this.isDragHandlerCell=!1,this.isDetailRowCell=!1,this.classNameValue="",this.idValue=Qw.counter++}get requiredMark(){return this.column&&this.column.isRenderedRequired?this.column.requiredMark:void 0}get hasQuestion(){return!!this.question&&!this.isErrorsCell}get hasTitle(){return!!this.locTitle}get hasPanel(){return!!this.panel}get id(){let e=this.question?this.question.id:this.idValue.toString();return this.isChoice&&(e+="-"+(Number.isInteger(this.choiceIndex)?"index"+this.choiceIndex.toString():this.item.id)),Oy(e,this.isErrorsCell,this.isDetailRowCell)}get item(){return this.itemValue}set item(e){this.itemValue=e,e&&(e.hideCaption=!0)}get isChoice(){return!!this.item}get isItemChoice(){return this.isChoice&&!this.isOtherChoice}get choiceValue(){return this.isChoice?this.item.value:null}get isCheckbox(){return this.isItemChoice&&this.question.isDescendantOf("checkbox")}get isRadio(){return this.isItemChoice&&this.question.isDescendantOf("radiogroup")}get isFirstChoice(){return this.choiceIndex===0}set className(e){this.classNameValue=e}get className(){const e=new z().append(this.classNameValue);return this.hasQuestion&&e.append(this.question.cssClasses.hasError,this.question.errors.length>0).append(this.question.cssClasses.answered,this.question.isAnswered),e.toString()}get cellQuestionWrapperClassName(){return this.cell.getQuestionWrapperClassName(this.matrix.cssClasses.cellQuestionWrapper)}get isVisible(){var e;return!this.hasQuestion&&!this.isErrorsCell||!(!((e=this.matrix)===null||e===void 0)&&e.isMobile)||this.question.isVisible}get showResponsiveTitle(){var e;return this.hasQuestion&&((e=this.matrix)===null||e===void 0?void 0:e.isMobile)}get responsiveTitleCss(){return new z().append(this.matrix.cssClasses.cellResponsiveTitle).toString()}get responsiveLocTitle(){return this.cell.column.locTitle}get headers(){if(this.cell&&this.cell.column){if(this.matrix.IsMultiplyColumn(this.cell.column))return this.item?this.item.locText.renderedHtml:"";let e=this.cell.column.cellHint;return e?e.trim()===""?"":this.cell.column.locCellHint.renderedHtml:this.hasQuestion&&this.question.isVisible&&this.question.title?this.question.title:this.cell.column.title}return this.hasQuestion&&this.question.isVisible?this.question.locTitle.renderedHtml:this.hasTitle&&this.locTitle.renderedHtml||""}getTitle(){return this.matrix&&this.matrix.showHeader?this.headers:""}calculateFinalClassName(e){const t=this.cell.question.cssClasses,s=new z().append(t.itemValue,!!t).append(t.asCell,!!t);return s.append(e.cell,s.isEmpty()&&!!e).append(e.choiceCell,this.isChoice).toString()}focusIn(){this.question&&this.question.focusIn()}};Hs.counter=1;let wr=class extends Te{constructor(e,t=!1){super(),this.cssClasses=e,this.isDetailRow=t,this.hasEndActions=!1,this.isErrorsRow=!1,this.cells=[]}get id(){var e;return Oy(((e=this.row)===null||e===void 0?void 0:e.id)||this.uniqueId.toString(),this.isErrorsRow,this.isDetailRow)}get dropTargetId(){var e;return(e=this.row)===null||e===void 0?void 0:e.id}get attributes(){return this.row?{"data-sv-drop-target-matrix-row":this.row.id}:{}}get className(){var e,t;return new z().append(this.cssClasses.row).append(this.cssClasses.detailRow,this.isDetailRow).append(this.cssClasses.rowHasPanel,(e=this.row)===null||e===void 0?void 0:e.hasPanel).append(this.cssClasses.expandedRow,((t=this.row)===null||t===void 0?void 0:t.isDetailPanelShowing)&&!this.isDetailRow).append(this.cssClasses.rowHasEndActions,this.hasEndActions).append(this.cssClasses.ghostRow,this.isGhostRow).append(this.cssClasses.rowAdditional,this.isAdditionalClasses).toString()}setRootElement(e){this.rootElement=e}getRootElement(){return this.rootElement}focusCell(e){if(this.rootElement){const t=`:scope td:nth-of-type(${e+1}) input, :scope td:nth-of-type(${e+1}) button`,s=this.rootElement.querySelectorAll(t)[0];s&&s.focus()}}};S([E({defaultValue:!1})],wr.prototype,"isGhostRow",void 0),S([E({defaultValue:!1})],wr.prototype,"isAdditionalClasses",void 0),S([E({defaultValue:!0})],wr.prototype,"visible",void 0);let MP=class extends wr{constructor(e){super(e),this.isErrorsRow=!0}get attributes(){return{}}get className(){return new z().append(this.cssClasses.row).append(this.cssClasses.errorRow).toString()}onAfterCreated(){const e=()=>{this.visible=this.cells.some(t=>t.question&&t.question.hasVisibleErrors)};this.cells.forEach(t=>{t.question&&t.question.registerFunctionOnPropertyValueChanged("hasVisibleErrors",e)}),e()}},kP=class extends wr{constructor(e,t){super(e),this.customId=t,this.isErrorsRow=!1}get attributes(){return{}}get dropTargetId(){return this.customId}get className(){return new z().append(this.cssClasses.row).append(this.cssClasses.rowEmpty).toString()}},uo=class extends Te{getIsAnimationAllowed(){return super.getIsAnimationAllowed()&&this.matrix.animationAllowed}getRenderedRowsAnimationOptions(){const e=s=>{s.querySelectorAll(":scope > td > *").forEach(i=>{ni(i)})},t=s=>{s.querySelectorAll(":scope > td > *").forEach(i=>{ys(i)})};return{isAnimationEnabled:()=>this.animationAllowed,getRerenderEvent:()=>this.onElementRerendered,getAnimatedElement(s){return s.getRootElement()},getLeaveOptions:()=>({cssClass:this.cssClasses.rowLeave,onBeforeRunAnimation:e,onAfterRunAnimation:t}),getEnterOptions:(s,i)=>({cssClass:this.cssClasses.rowEnter,onBeforeRunAnimation:e,onAfterRunAnimation:t}),getKey:s=>s.id}}updateRenderedRows(){this.renderedRows=this.rows}get renderedRows(){return this._renderedRows}set renderedRows(e){this.renderedRowsAnimation.sync(e)}get wrapperDropTargetId(){var e;return(e=this.renderedRows[this.renderedRows.length-1])===null||e===void 0?void 0:e.dropTargetId}constructor(e){super(),this.matrix=e,this._renderedRows=[],this.renderedRowsAnimation=new Wi(this.getRenderedRowsAnimationOptions(),t=>{this._renderedRows=t},()=>this._renderedRows),this.hasActionCellInRowsValues={},this.build()}get showTable(){return this.getPropertyValue("showTable",!0)}get showHeader(){return this.getPropertyValue("showHeader")}get showAddRow(){return this.getPropertyValue("showAddRow",!1)}get showAddRowOnTop(){return this.getPropertyValue("showAddRowOnTop",!1)}get showAddRowOnBottom(){return this.getPropertyValue("showAddRowOnBottom",!1)}get showFooter(){return this.matrix.hasFooter&&this.matrix.isColumnLayoutHorizontal}get hasFooter(){return!!this.footerRow}get hasRemoveRows(){return this.hasRemoveRowsValue}isRequireReset(){return this.isRequireResetValue||this.hasRemoveRows!=this.matrix.canRemoveRows||!this.matrix.isColumnLayoutHorizontal}requireReset(){this.isRequireResetValue=!0}get headerRow(){return this.headerRowValue}get footerRow(){return this.footerRowValue}get isRowsDragAndDrop(){return this.matrix.isRowsDragAndDrop&&this.matrix.isColumnLayoutHorizontal}get showCellErrorsTop(){return this.matrix.getErrorLocation()==="top"}get showCellErrorsBottom(){return this.matrix.getErrorLocation()==="bottom"}build(){this.hasRemoveRowsValue=this.matrix.canRemoveRows,this.matrix.visibleRows,this.cssClasses=this.matrix.cssClasses,this.buildRowsActions(),this.buildHeader(),this.buildRows(),this.buildFooter(),this.updateShowTableAndAddRow()}updateShowTableAndAddRow(){const e=this.rows.length>0||this.matrix.isDesignMode||!this.matrix.getShowColumnsIfEmpty();this.setPropertyValue("showTable",e);const t=this.matrix.isDesignMode,s=!t&&this.matrix.canAddRow&&e;let i=s,r=s;i&&(this.matrix.getAddRowLocation()==="default"?i=!this.matrix.isColumnLayoutHorizontal:i=this.matrix.getAddRowLocation()!=="bottom"),r&&this.matrix.getAddRowLocation()!=="topBottom"&&(r=!i),this.setPropertyValue("showAddRow",!t&&this.matrix.canAddRow),this.setPropertyValue("showAddRowOnTop",i),this.setPropertyValue("showAddRowOnBottom",r)}onAddedRow(e,t){if(this.getRenderedDataRowCount()>=this.matrix.visibleRows.length)return;let s=this.getRenderedRowIndexByIndex(t);this.rowsActions.splice(t,0,this.buildRowActions(e)),this.addHorizontalRow(this.rows,e,s),this.updateShowTableAndAddRow()}getRenderedRowIndexByIndex(e){let t=0,s=0;for(var i=0;i<this.rows.length;i++){if(s===e){(this.rows[i].isErrorsRow||this.rows[i].isDetailRow)&&(t++,i+1<this.rows.length&&this.rows[i+1].isDetailRow&&t++);break}t++,!this.rows[i].isErrorsRow&&!this.rows[i].isDetailRow&&s++}return s<e?this.rows.length:t}getRenderedDataRowCount(){for(var e=0,t=0;t<this.rows.length;t++)!this.rows[t].isErrorsRow&&!this.rows[t].isDetailRow&&e++;return e}onRemovedRow(e){var t=this.getRenderedRowIndex(e);if(!(t<0)){this.rowsActions.splice(t,1);var s=1;t<this.rows.length-1&&this.showCellErrorsBottom&&this.rows[t+1].isErrorsRow&&s++,t<this.rows.length-1&&(this.rows[t+1].isDetailRow||this.showCellErrorsBottom&&t+1<this.rows.length-1&&this.rows[t+2].isDetailRow)&&s++,t>0&&this.showCellErrorsTop&&this.rows[t-1].isErrorsRow&&(t--,s++),this.rows.splice(t,s),this.updateShowTableAndAddRow()}}onDetailPanelChangeVisibility(e,t){const s=this.getRenderedRowIndex(e);if(s<0)return;let i=s;this.showCellErrorsBottom&&i++;var r=i<this.rows.length-1&&this.rows[i+1].isDetailRow?i+1:-1;if(!(t&&r>-1||!t&&r<0))if(t){var a=this.createDetailPanelRow(e,this.rows[s]);this.rows.splice(i+1,0,a)}else this.rows.splice(r,1)}focusActionCell(e,t){let s=this.rows[this.rows.length-1];if(this.matrix.isColumnLayoutHorizontal){const i=this.getRenderedRowIndex(e);s=this.rows[i]}s?.focusCell(t)}getRenderedRowIndex(e){for(var t=0;t<this.rows.length;t++)if(this.rows[t].row==e)return t;return-1}buildRowsActions(){this.rowsActions=[];for(var e=this.matrix.visibleRows,t=0;t<e.length;t++)this.rowsActions.push(this.buildRowActions(e[t]))}createRenderedRow(e,t=!1){return new wr(e,t)}createErrorRenderedRow(e){return new MP(e)}createEmptyRenderedRow(e){return new kP(e,this.matrix.id)}buildHeader(){var e=this.matrix.isColumnLayoutHorizontal&&this.matrix.showHeader,t=e||this.matrix.hasRowText&&!this.matrix.isColumnLayoutHorizontal;if(this.setPropertyValue("showHeader",t),!!t){if(this.headerRowValue=this.createRenderedRow(this.cssClasses),this.isRowsDragAndDrop&&this.headerRow.cells.push(this.createHeaderCell(null,"action",this.cssClasses.actionsCellDrag)),this.hasActionCellInRows("start")&&this.headerRow.cells.push(this.createHeaderCell(null,"action")),this.matrix.hasRowText&&this.matrix.showHeader&&this.headerRow.cells.push(this.createHeaderCell(null)),this.matrix.isColumnLayoutHorizontal)for(var s=0;s<this.matrix.columns.length;s++){var i=this.matrix.columns[s];i.isColumnVisible&&(this.matrix.IsMultiplyColumn(i)?this.createMutlipleColumnsHeader(i):this.headerRow.cells.push(this.createHeaderCell(i)))}else{for(var r=this.matrix.visibleRows,s=0;s<r.length;s++){const o=this.createTextCell(r[s].locText);this.setHeaderCellCssClasses(o),o.row=r[s],this.headerRow.cells.push(o)}if(this.matrix.hasFooter){const a=this.createTextCell(this.matrix.getFooterText());this.setHeaderCellCssClasses(a),this.headerRow.cells.push(a)}}this.hasActionCellInRows("end")&&this.headerRow.cells.push(this.createHeaderCell(null,"action"))}}buildFooter(){if(this.showFooter){if(this.footerRowValue=this.createRenderedRow(this.cssClasses),this.isRowsDragAndDrop&&this.footerRow.cells.push(this.createHeaderCell(null)),this.hasActionCellInRows("start")&&this.footerRow.cells.push(this.createHeaderCell(null,"action")),this.matrix.hasRowText){const r=this.createTextCell(this.matrix.getFooterText());r.className=new z().append(r.className).append(this.cssClasses.footerTotalCell).toString(),this.footerRow.cells.push(r)}for(var e=this.matrix.visibleTotalRow.cells,t=0;t<e.length;t++){var s=e[t];if(s.column.isColumnVisible)if(this.matrix.IsMultiplyColumn(s.column))this.createMutlipleColumnsFooter(this.footerRow,s);else{var i=this.createEditCell(s);s.column&&this.setCellWidth(s.column,i),i.className=new z().append(i.className).append(this.cssClasses.footerCell).toString(),this.footerRow.cells.push(i)}}this.hasActionCellInRows("end")&&this.footerRow.cells.push(this.createHeaderCell(null,"action"))}}buildRows(){this.blockAnimations();var e=this.matrix.isColumnLayoutHorizontal?this.buildHorizontalRows():this.buildVerticalRows();this.rows=e,this.releaseAnimations()}hasActionCellInRows(e){return this.hasActionCellInRowsValues[e]===void 0&&(this.hasActionCellInRowsValues[e]=this.hasActionsCellInLocaltion(e)),this.hasActionCellInRowsValues[e]}hasActionsCellInLocaltion(e){return e=="end"&&this.hasRemoveRows?!0:this.matrix.visibleRows.some((t,s)=>!this.isValueEmpty(this.getRowActions(s,e)))}canRemoveRow(e){return this.matrix.canRemoveRow(e)}buildHorizontalRows(){var e=this.matrix.visibleRows,t=[];if(e.length==0&&this.matrix.allowRowReorder&&this.matrix.allowRowDragIn){const i=this.createEmptyRow(),r=this.createTextCell(this.matrix.locNoRowsText);r.colSpans=this.headerRow&&this.headerRow.cells.length||1,i.cells.push(r),t.push(i)}for(var s=0;s<e.length;s++)this.addHorizontalRow(t,e[s]);return t}addHorizontalRow(e,t,s=-1){const i=this.createHorizontalRow(t),r=this.createErrorRow(i);if(i.row=t,s<0&&(s=e.length),this.matrix.isMobile){const a=[];for(let o=0;o<i.cells.length;o++)this.showCellErrorsTop&&!r.cells[o].isEmpty&&a.push(r.cells[o]),a.push(i.cells[o]),this.showCellErrorsBottom&&!r.cells[o].isEmpty&&a.push(r.cells[o]);i.cells=a,e.splice(s,0,i)}else e.splice(s,0,...this.showCellErrorsTop?[r,i]:[i,r]),s++;t.isDetailPanelShowing&&e.splice(s+1,0,this.createDetailPanelRow(t,i))}getRowDragCell(e){const t=new Hs,s=this.matrix.lockedRowCount;return t.isDragHandlerCell=s<1||e>=s,t.isEmpty=!t.isDragHandlerCell,t.className=this.getActionsCellClassName(t),t.row=this.matrix.visibleRows[e],t}getActionsCellClassName(e=null){const t=new z().append(this.cssClasses.actionsCell).append(this.cssClasses.actionsCellDrag,e?.isDragHandlerCell).append(this.cssClasses.detailRowCell,e?.isDetailRowCell).append(this.cssClasses.verticalCell,!this.matrix.isColumnLayoutHorizontal);if(e.isActionsCell){const s=e.item.value.actions;this.cssClasses.actionsCellPrefix&&s.forEach(i=>{t.append(this.cssClasses.actionsCellPrefix+"--"+i.id)})}return t.toString()}getRowActionsCell(e,t,s=!1){const i=this.getRowActions(e,t);if(!this.isValueEmpty(i)){const r=new Hs,a=this.matrix.allowAdaptiveActions?new Wa:new _t;this.matrix.survey&&this.matrix.survey.getCss().actionBar&&(a.cssClasses=this.matrix.survey.getCss().actionBar),a.setItems(i);const o=new Ce(a);return r.item=o,r.isActionsCell=!0,r.isDragHandlerCell=!1,r.isDetailRowCell=s,r.className=this.getActionsCellClassName(r),r.row=this.matrix.visibleRows[e],r}return null}getRowActions(e,t){var s=this.rowsActions[e];return Array.isArray(s)?s.filter(i=>(i.location||(i.location="start"),i.location===t)):[]}buildRowActions(e){var t=[];return this.setDefaultRowActions(e,t),this.matrix.survey&&(t=this.matrix.survey.getUpdatedMatrixRowActions(this.matrix,e,t)),t}get showRemoveButtonAsIcon(){return A.matrix.renderRemoveAsIcon&&this.matrix.survey&&this.matrix.survey.css.root==="sd-root-modern"}setDefaultRowActions(e,t){const s=this.matrix;this.hasRemoveRows&&this.canRemoveRow(e)&&(this.showRemoveButtonAsIcon?t.push(new Pe({id:"remove-row",iconName:"icon-delete-24x24",iconSize:"auto",component:"sv-action-bar-item",innerCss:new z().append(this.matrix.cssClasses.button).append(this.matrix.cssClasses.buttonRemove).toString(),location:"end",showTitle:!1,title:s.removeRowText,enabled:!s.isInputReadOnly,data:{row:e,question:s},action:()=>{s.removeRowUI(e)}})):t.push(new Pe({id:"remove-row",location:"end",enabled:!this.matrix.isInputReadOnly,component:"sv-matrix-remove-button",data:{row:e,question:this.matrix}}))),e.hasPanel&&(this.matrix.isMobile?t.unshift(new Pe({id:"show-detail-mobile",title:new We(()=>e.isDetailPanelShowing?this.matrix.getLocalizationString("hideDetails"):this.matrix.getLocalizationString("showDetails")),showTitle:!0,location:"end",action:i=>{e.showHideDetailPanelClick()}})):t.push(new Pe({id:"show-detail",title:new We(()=>e.isDetailPanelShowing?this.matrix.getLocalizationString("hideDetails"):this.matrix.getLocalizationString("showDetails")),showTitle:!1,location:"start",component:"sv-matrix-detail-button",data:{row:e,question:this.matrix}})))}createErrorRow(e){const t=this.createErrorRenderedRow(this.cssClasses);for(let s=0;s<e.cells.length;s++){const i=e.cells[s];i.hasQuestion?this.matrix.IsMultiplyColumn(i.cell.column)?i.isFirstChoice?t.cells.push(this.createErrorCell(i.cell)):t.cells.push(this.createEmptyCell(!0)):t.cells.push(this.createErrorCell(i.cell)):t.cells.push(this.createEmptyCell(!0))}return t.onAfterCreated(),t}createEmptyRow(){return this.createEmptyRenderedRow(this.cssClasses)}createHorizontalRow(e){var t=this.createRenderedRow(this.cssClasses);if(this.isRowsDragAndDrop){var s=this.matrix.visibleRows.indexOf(e);t.cells.push(this.getRowDragCell(s))}if(this.addRowActionsCell(e,t,"start"),this.matrix.hasRowText){var i=this.createTextCell(e.locText);i.row=e,t.cells.push(i),this.setCellWidth(null,i),i.className=new z().append(i.className).append(this.cssClasses.rowTextCell).append(this.cssClasses.columnTitleCell,!this.matrix.isColumnLayoutHorizontal).append(this.cssClasses.detailRowText,e.hasPanel).toString()}for(var r=0;r<e.cells.length;r++){let a=e.cells[r];if(a.column.isColumnVisible)if(this.matrix.IsMultiplyColumn(a.column))this.createMutlipleEditCells(t,a);else{a.column.isShowInMultipleColumns&&a.question.visibleChoices.map(l=>l.hideCaption=!1);var i=this.createEditCell(a);t.cells.push(i),this.setCellWidth(a.column,i)}}return this.addRowActionsCell(e,t,"end"),t}addRowActionsCell(e,t,s){var i=this.matrix.visibleRows.indexOf(e);if(this.hasActionCellInRows(s)){const a=this.getRowActionsCell(i,s,t.isDetailRow);if(a)t.cells.push(a),t.hasEndActions=!0;else{var r=new Hs;r.isEmpty=!0,r.isDetailRowCell=t.isDetailRow,t.cells.push(r)}}}createDetailPanelRow(e,t){const s=this.matrix.isDesignMode;var i=this.createRenderedRow(this.cssClasses,!0);i.row=e;var r=new Hs;this.matrix.hasRowText&&(r.colSpans=2),r.isEmpty=!0,s||i.cells.push(r);var a=null;this.hasActionCellInRows("end")&&(a=new Hs,a.isEmpty=!0);var o=new Hs;return o.panel=e.detailPanel,o.colSpans=t.cells.length-(s?0:r.colSpans)-(a?a.colSpans:0),o.className=this.cssClasses.detailPanelCell,i.cells.push(o),a&&(this.matrix.isMobile?this.addRowActionsCell(e,i,"end"):i.cells.push(a)),typeof this.matrix.onCreateDetailPanelRenderedRowCallback=="function"&&this.matrix.onCreateDetailPanelRenderedRowCallback(i),i}buildVerticalRows(){for(var e=this.matrix.columns,t=[],s=0;s<e.length;s++){var i=e[s];if(i.isColumnVisible)if(this.matrix.IsMultiplyColumn(i))this.createMutlipleVerticalRows(t,i,s);else{const r=this.createVerticalRow(i,s),a=this.createErrorRow(r);this.showCellErrorsTop?(t.push(a),t.push(r)):(t.push(r),t.push(a))}}return this.hasActionCellInRows("end")&&t.push(this.createEndVerticalActionRow()),t}createMutlipleVerticalRows(e,t,s){var i=this.getMultipleColumnChoices(t);if(i)for(var r=0;r<i.length;r++){const a=this.createVerticalRow(t,s,i[r],r),o=this.createErrorRow(a);this.showCellErrorsTop?(e.push(o),e.push(a)):(e.push(a),e.push(o))}}createVerticalRow(e,t,s=null,i=-1){var r=this.createRenderedRow(this.cssClasses);if(this.matrix.showHeader){var a=s?s.locText:e.locTitle,o=this.createTextCell(a);o.column=e,o.className=new z().append(o.className).append(this.cssClasses.rowTextCell).append(this.cssClasses.columnTitleCell).toString(),r.cells.push(o)}for(var l=this.matrix.visibleRows,u=0;u<l.length;u++){var d=s,h=i>=0?i:u,f=l[u].cells[t],C=s?f.question.visibleChoices:void 0;C&&h<C.length&&(d=C[h]);var b=this.createEditCell(f,d);b.item=d,b.choiceIndex=h,r.cells.push(b)}return this.matrix.hasTotal&&r.cells.push(this.createEditCell(this.matrix.visibleTotalRow.cells[t])),r}createEndVerticalActionRow(){var e=this.createRenderedRow(this.cssClasses);this.matrix.showHeader&&e.cells.push(this.createEmptyCell());for(var t=this.matrix.visibleRows,s=0;s<t.length;s++)e.cells.push(this.getRowActionsCell(s,"end"));return this.matrix.hasTotal&&e.cells.push(this.createEmptyCell()),e}createMutlipleEditCells(e,t,s=!1){var i=s?this.getMultipleColumnChoices(t.column):t.question.visibleChoices;if(i)for(var r=0;r<i.length;r++){var a=this.createEditCell(t,s?void 0:i[r]);s||(this.setItemCellCssClasses(a),a.choiceIndex=r),e.cells.push(a)}}setItemCellCssClasses(e){e.className=new z().append(this.cssClasses.cell).append(this.cssClasses.itemCell).append(this.cssClasses.radioCell,e.isRadio).append(this.cssClasses.checkboxCell,e.isCheckbox).toString()}createEditCell(e,t=void 0){var s=new Hs;return s.cell=e,s.row=e.row,s.column=e.column,s.question=e.question,s.matrix=this.matrix,s.item=t,s.isOtherChoice=!!t&&!!e.question&&e.question.otherItem===t,s.className=s.calculateFinalClassName(this.cssClasses),s}createErrorCell(e,t=void 0){var s=new Hs;return s.question=e.question,s.row=e.row,s.matrix=this.matrix,s.isErrorsCell=!0,s.className=new z().append(this.cssClasses.cell).append(this.cssClasses.errorsCell).append(this.cssClasses.errorsCellTop,this.showCellErrorsTop).append(this.cssClasses.errorsCellBottom,this.showCellErrorsBottom).toString(),s}createMutlipleColumnsFooter(e,t){this.createMutlipleEditCells(e,t,!0)}createMutlipleColumnsHeader(e){var t=this.getMultipleColumnChoices(e);if(t)for(var s=0;s<t.length;s++){var i=this.createTextCell(t[s].locText);this.setHeaderCell(e,i),this.setHeaderCellCssClasses(i),this.headerRow.cells.push(i)}}getMultipleColumnChoices(e){var t=e.templateQuestion.choices;return t&&Array.isArray(t)&&t.length==0?[].concat(this.matrix.choices,e.getVisibleMultipleChoices()):(t=e.getVisibleMultipleChoices(),!t||!Array.isArray(t)?null:t)}setHeaderCellCssClasses(e,t,s){e.className=new z().append(this.cssClasses.headerCell).append(this.cssClasses.columnTitleCell,this.matrix.isColumnLayoutHorizontal).append(this.cssClasses.emptyCell,!!e.isEmpty).append(this.cssClasses.cell+"--"+t,!!t).append(s,!!s).toString()}createHeaderCell(e,t=null,s){let i=e?this.createTextCell(e.locTitle):this.createEmptyCell();return i.column=e,this.setHeaderCell(e,i),t||(t=e&&e.cellType!=="default"?e.cellType:this.matrix.cellType),this.setHeaderCellCssClasses(i,t,s),i}setHeaderCell(e,t){this.setCellWidth(e,t)}setCellWidth(e,t){t.minWidth=e!=null?this.matrix.getColumnWidth(e):this.matrix.getRowTitleWidth(),t.width=e!=null?e.width:this.matrix.getRowTitleWidth()}createTextCell(e){var t=new Hs;return t.locTitle=e,this.cssClasses.cell&&(t.className=this.cssClasses.cell),t}createEmptyCell(e=!1){const t=this.createTextCell(null);return t.isEmpty=!0,t.className=new z().append(this.cssClasses.cell).append(this.cssClasses.emptyCell).append(this.cssClasses.errorsCell,e).toString(),t}};S([Nt({onPush:(n,e,t)=>{t.updateRenderedRows()},onRemove:(n,e,t)=>{t.updateRenderedRows()}})],uo.prototype,"rows",void 0),S([Nt()],uo.prototype,"_renderedRows",void 0);let My=class{constructor(e,t,s){this.column=e,this.row=t,this.data=s,this.questionValue=this.createQuestion(e,t,s),this.questionValue.updateCustomWidget(),this.updateCellQuestionTitleDueToAccessebility(t)}updateCellQuestionTitleDueToAccessebility(e){this.questionValue.locTitle.onGetTextCallback=t=>{const s=e?.getSurvey();if(!s||s.isSingleVisibleInput)return this.questionValue.title;const i=e.getAccessbilityText();return i?this.column.colOwner.getCellAriaLabel(e,this.column,i):this.questionValue.title}}locStrsChanged(){this.question.locStrsChanged()}createQuestion(e,t,s){const i=s.createQuestion(this.row,this.column);return i.onFirstRendering(),i.readOnlyCallback=()=>!this.row.isRowEnabled(),i.validateValueCallback=function(){return s.validateCell(t,e.name,t.value)},Rs.getProperties(e.getType()).forEach(r=>{let a=r.name;e[a]!==void 0&&(i[a]=e[a])}),i}get question(){return this.questionValue}get value(){return this.question.value}set value(e){this.question.value=e}getQuestionWrapperClassName(e){return e}runCondition(e){this.question.runCondition(e)}},NP=class extends My{constructor(e,t,s){super(e,t,s),this.column=e,this.row=t,this.data=s,this.updateCellQuestion()}createQuestion(e,t,s){var i=q.createClass("expression");return i.setSurveyImpl(t),i}locStrsChanged(){this.updateCellQuestion(),super.locStrsChanged()}updateCellQuestion(){this.question.locCalculation(),this.column.updateCellQuestion(this.question,null,function(e){delete e.defaultValue}),this.question.expression=this.getTotalExpression(),this.question.format=this.column.totalFormat,this.question.currency=this.column.totalCurrency,this.question.displayStyle=this.column.totalDisplayStyle,this.question.maximumFractionDigits=this.column.totalMaximumFractionDigits,this.question.minimumFractionDigits=this.column.totalMinimumFractionDigits,this.question.unlocCalculation(),this.question.runIfReadOnly=!0}getQuestionWrapperClassName(e){let t=super.getQuestionWrapperClassName(e);if(!t)return t;this.question.expression&&this.question.expression!="''"&&(t+=" "+e+"--expression");let s=this.column.totalAlignment;return s==="auto"&&this.column.cellType==="dropdown"&&(s="left"),t+" "+e+"--"+s}getTotalExpression(){if(this.column.totalExpression)return this.column.totalExpression;if(this.column.totalType=="none")return"''";var e=this.column.totalType+"InArray";return _e.Instance.hasFunction(e)?e+"({matrix}, '"+this.column.name+"')":""}},qP=class extends Ty{constructor(e){super(),this.row=e}getIndex(){return this.row.rowIndex-1}getQuestionData(){return this.row.data}getValue(e,t,s,i){if(e.length===0)return;const r=A.expressionVariables;if(e.length===1){const o=this.getRowValue(e[0].name);if(o!==void 0)return{isFound:!0,value:o};if(e[0].name===r.matrix){const l=this.row.data;return{isFound:!0,context:l.getValueGetterContext(),value:l.getFilteredData()}}}if(e.length>1&&e[0].name===r.totalRow){const o=this.row.data.visibleTotalRow;if(o)return e[0].name="row",o.getValueGetterContext().getValue(e,t,s,i)}const a=e[0].name===r.row;if(a||!t){a&&e.shift();let o=super.getValue(e,t,s,i);if(o&&o.isFound)return o;const l=this.row.getAllValues();return t&&(o=this.getValueFromBindedQuestions(e,l),o)?o:new fs(l).getValue(e,t,s,i)}}getRootObj(){return this.row.data}updateValueByItem(e,t){const s=this.row.getQuestionsByValueName(e,!0);s.length>0&&(t.isFound=!0,t.context=s[0].getValueGetterContext())}getRowValue(e){const t=A.expressionVariables;if(e=e.toLocaleLowerCase(),e===t.rowIndex.toLocaleLowerCase())return this.row.rowIndex;if(e===t.visibleRowIndex.toLocaleLowerCase())return this.getQuestionData().visibleRows.indexOf(this.row)+1;if([t.item,t.rowName.toLocaleLowerCase(),t.rowValue.toLocaleLowerCase()].indexOf(e)>-1)return this.row.rowName;if(e==t.rowTitle.toLocaleLowerCase())return this.row.rowTitle}},sn=class yf{static getId(){return"srow_"+yf.idCounter++}constructor(e,t){this.data=e,this.isSettingValue=!1,this.detailPanelValue=null,this.visibleValue=!0,this.cells=[],this.visibleIndex=-1,this.isCreatingDetailPanel=!1,this.data=e,this.subscribeToChanges(t),this.textPreProcessor=new no(this),this.showHideDetailPanelClick=()=>{if(this.getSurvey().isDesignMode)return!0;this.showHideDetailPanel()},this.idValue=yf.getId()}get id(){return this.idValue}get rowName(){return null}get rowTitle(){return this.rowName}get dataName(){return this.rowName}get text(){return this.rowName}getValueGetterContext(){return new qP(this)}isRowEnabled(){return!0}isRowHasEnabledCondition(){return!1}get isVisible(){return this.visible&&this.isItemVisible()}get visible(){return this.visibleValue}set visible(e){var t;this.visible!==e&&(this.visibleValue=e,(t=this.data)===null||t===void 0||t.onRowVisibilityChanged(this))}isItemVisible(){return!0}get value(){return this.getValueCore(!1)}set value(e){this.isSettingValue=!0,this.subscribeToChanges(e);for(var t=this.questions,s=0;s<t.length;s++){var i=t[s],r=this.getCellValue(e,i.getValueName()),a=i.comment,o=e?e[i.getValueName()+Te.commentSuffix]:"";o==null&&(o=""),i.updateValueFromSurvey(r),(o||this.isTwoValueEquals(a,i.comment))&&i.updateCommentFromSurvey(o),i.onSurveyValueChanged(r)}this.isSettingValue=!1}get filteredValue(){return this.getValueCore(!0)}getValueCore(e){for(var t={},s=this.questions,i=0;i<s.length;i++){var r=s[i];r.isEmpty()||(t[r.getValueName()]=e?r.getFilteredValue():r.value),r.comment&&this.getSurvey()&&this.getSurvey().storeOthersAsComment&&(t[r.getValueName()+Te.commentSuffix]=r.comment)}return t}get locText(){return null}getAccessbilityText(){return this.locText&&this.locText.renderedHtml}get hasPanel(){return this.data?this.data.hasDetailPanel(this):!1}get detailPanel(){return this.detailPanelValue}get detailPanelId(){return this.detailPanel?this.detailPanel.id:""}get isDetailPanelShowing(){return this.data?this.data.getIsDetailPanelShowing(this):!1}setIsDetailPanelShowing(e){!e&&this.detailPanel&&this.detailPanel.onHidingContent(),this.data&&this.data.setIsDetailPanelShowing(this,e),e&&this.detailPanel&&this.detailPanel.onFirstRendering(),this.onDetailPanelShowingChanged&&this.onDetailPanelShowingChanged()}showHideDetailPanel(){this.isDetailPanelShowing?this.hideDetailPanel():this.showDetailPanel()}showDetailPanel(){this.ensureDetailPanel(),this.detailPanelValue&&this.setIsDetailPanelShowing(!0)}hideDetailPanel(e=!1){this.setIsDetailPanelShowing(!1),e&&(this.detailPanelValue=null)}ensureDetailPanel(){if(!this.isCreatingDetailPanel&&!(this.detailPanelValue||!this.hasPanel||!this.data)){this.isCreatingDetailPanel=!0,this.detailPanelValue=this.data.createRowDetailPanel(this);var e=this.detailPanelValue.questions,t=this.getDataRowValue();if(!O.isValueEmpty(t))for(var s=0;s<e.length;s++){const i=e[s].getValueName(),r=this.editingObj?q.getObjPropertyValue(this.editingObj,i):t[i];O.isValueEmpty(r)||(e[s].value=r)}this.detailPanelValue.setSurveyImpl(this),this.isCreatingDetailPanel=!1}}getAllValues(){const e=this.value;if(this.data){const s=this.getDataRowValue();if(s)for(var t in s)e[t]===void 0&&(e[t]=s[t])}return e}getFilteredProperties(){return{survey:this.getSurvey(),row:this}}getDataRowValue(){return this.data?this.data.getRowValue(this.data.getRowIndex(this)):null}runCondition(e,t){if(!this.data)return;const s=O.createCopy(e);s[A.expressionVariables.row]=this,t?this.visible=new Fs(t).runContext(this.getValueGetterContext(),e):this.visible=!0;for(var i=0;i<this.cells.length;i++)this.cells[i].runCondition(s);this.detailPanel&&this.detailPanel.runCondition(s),this.isRowHasEnabledCondition()&&this.onQuestionReadOnlyChanged()}updateElementVisibility(){this.cells.forEach(e=>e.question.updateElementVisibility()),this.detailPanel&&this.detailPanel.updateElementVisibility()}getNamesWithDefaultValues(){const e=[];return this.questions.forEach(t=>{t.isValueDefault&&e.push(t.getValueName())}),e}clearValue(e,t){for(var s=this.questions,i=0;i<s.length;i++)s[i].clearValue(e,t)}onAnyValueChanged(e,t){for(var s=this.questions,i=0;i<s.length;i++)s[i].onAnyValueChanged(e,t)}getDataValueCore(e,t){var s=this.getSurvey();return s?s.getDataValueCore(e,t):e[t]}getValue(e){var t=this.getQuestionByName(e);return t?t.value:null}setValue(e,t){this.setValueCore(e,t,!1)}getVariable(e){}setVariable(e,t){}getComment(e){var t=this.getQuestionByName(e);return t?t.comment:""}setComment(e,t,s){this.setValueCore(e,t,!0)}findQuestionByName(e){if(!e)return;const t=A.expressionVariables.row+".";if(e.indexOf(t)===0)return this.getQuestionByName(e.substring(t.length));const s=this.getSurvey();return s?s.getQuestionByName(e):null}getEditingSurveyElement(){}setValueCore(e,t,s){if(this.isSettingValue||this.isCreatingDetailPanel)return;this.updateQuestionsValue(e,t,s),s||this.updateSharedQuestionsValue(e,t);var i=this.value,r=s?e+Te.commentSuffix:e,a=t,o=this.getQuestionByName(e),l=this.data.onRowChanging(this,r,i);if(o&&!this.isTwoValueEquals(l,a)&&(this.isSettingValue=!0,s?o.comment=l:o.value=l,this.isSettingValue=!1,i=this.value),this.data.isValidateOnValueChanging&&!this.validateCellQuestion(o))return;const u=t==null&&!o||s&&!t&&!!o;this.data.onRowChanged(this,r,i,u);const d=A.expressionVariables.row;if(r){const h=d+"."+r;this.runTriggers(h,i),this.data.runTriggersInRow(this,h,i)}this.onAnyValueChanged(d,"")}updateQuestionsValue(e,t,s){if(this.detailPanel){var i=this.getQuestionByColumnName(e),r=this.detailPanel.getQuestionByName(e);if(!(!i||!r)){var a=this.isTwoValueEquals(t,s?i.comment:i.value),o=a?r:i;this.isSettingValue=!0,s?o.comment=t:o.value=t,this.isSettingValue=!1}}}updateSharedQuestionsValue(e,t){const s=this.getQuestionsByValueName(e);if(s.length>1)for(let i=0;i<s.length;i++)O.isTwoValueEquals(s[i].value,t)||(this.isSettingValue=!0,s[i].updateValueFromSurvey(t),this.isSettingValue=!1)}runTriggers(e,t,s){!e&&!s||this.questions.forEach(i=>i.runTriggers(e,t,s))}validateCellQuestion(e){if(!e)return!0;if(!e.validateElement(new Cr({fireCallback:!0,isOnValueChanged:!this.data.isValidateOnValueChanging})))return!1;if(e.isEmpty())return!0;var t=this.getCellByColumnName(e.name);return!t||!t.column||!t.column.isUnique?!0:!this.data.checkIfValueInRowDuplicated(this,e)}get isEmpty(){var e=this.value;if(O.isValueEmpty(e))return!0;for(var t in e)if(e[t]!==void 0&&e[t]!==null)return!1;return!0}hasValueAnyQuestion(e){const t=e?this.visibleQuestions:this.questions;for(let s=0;s<t.length;s++)if(!t[s].isEmpty())return!0;return!1}getQuestionByColumn(e){var t=this.getCellByColumn(e);return t?t.question:null}getCellByColumn(e){for(var t=0;t<this.cells.length;t++)if(this.cells[t].column==e)return this.cells[t];return null}getCellByColumnName(e){for(var t=0;t<this.cells.length;t++)if(this.cells[t].column.name==e)return this.cells[t];return null}getQuestionByColumnName(e){var t=this.getCellByColumnName(e);return t?t.question:null}get questions(){for(var e=[],t=0;t<this.cells.length;t++)e.push(this.cells[t].question);for(var s=this.detailPanel?this.detailPanel.questions:[],t=0;t<s.length;t++)e.push(s[t]);return e}get visibleQuestions(){const e=[];return this.questions.forEach(t=>{t.isVisible&&e.push(t)}),e}getQuestionByName(e){var t=this.getQuestionByColumnName(e);return t||(this.detailPanel?this.detailPanel.getQuestionByName(e):null)}getQuestionsByName(e){let t=[],s=this.getQuestionByColumnName(e);return s&&t.push(s),this.detailPanel&&(s=this.detailPanel.getQuestionByName(e),s&&t.push(s)),t}getQuestionsByValueName(e,t){t&&(e=e.toLocaleLowerCase());let s=[];for(var i=0;i<this.cells.length;i++){const r=this.cells[i],a=r.question;if(!a)continue;let o=a.getValueName();t&&(o=o.toLocaleLowerCase()),o===e&&s.push(r.question)}return this.detailPanel&&(s=s.concat(this.detailPanel.getQuestionsByValueName(e,t))),s}getSharedQuestionByName(e){return this.data?this.data.getSharedQuestionByName(e,this):null}clearIncorrectValues(e){for(var t in e){var s=this.getQuestionByName(t);if(s){var i=s.value;s.clearIncorrectValues(),this.isTwoValueEquals(i,s.value)||this.setValue(t,s.value)}else!this.getSharedQuestionByName(t)&&t.indexOf(A.matrix.totalsSuffix)<0&&this.setValue(t,null)}}getLocale(){return this.data?this.data.getLocale():""}getMarkdownHtml(e,t,s){return this.data?this.data.getMarkdownHtml(e,t,s):void 0}getRenderer(e){return this.data?this.data.getRenderer(e):null}getRendererContext(e){return this.data?this.data.getRendererContext(e):e}getProcessedText(e){return this.data?this.data.getProcessedText(e):e}locStrsChanged(){for(var e=0;e<this.cells.length;e++)this.cells[e].locStrsChanged();this.detailPanel&&this.detailPanel.locStrsChanged()}updateCellQuestionOnColumnChanged(e,t,s){var i=this.getCellByColumn(e);i&&this.updateCellOnColumnChanged(i,t,s)}updateCellQuestionOnColumnItemValueChanged(e,t,s,i,r,a){var o=this.getCellByColumn(e);o&&this.updateCellOnColumnItemValueChanged(o,t,s,i,r,a)}onQuestionReadOnlyChanged(){const e=this.questions;for(var t=0;t<e.length;t++){const s=e[t];s.setPropertyValue("isReadOnly",s.isReadOnly)}if(this.detailPanel){const s=!!this.data&&this.data.isMatrixReadOnly();this.detailPanel.readOnly=s||!this.isRowEnabled()}}validate(e){let t=!0;const s=this.cells;if(!s)return t;for(let i=0;i<s.length;i++){if(!s[i])continue;const r=s[i].question;!r||!r.visible||e&&e.isOnValueChanged===!0&&r.isEmpty()||(t=r.validateElement(e)&&t)}if(this.hasPanel){this.ensureDetailPanel();const i=this.detailPanel.validateElement(e),r=e;!r.hideErroredPanel&&!i&&e.fireCallback&&(r.isSingleDetailPanel&&(r.hideErroredPanel=!0),this.showDetailPanel()),t=i&&t}return t}updateCellOnColumnChanged(e,t,s){t==="choices"&&Array.isArray(s)&&s.length===0&&this.data&&(s=this.data.choices),e.question[t]=s}updateCellOnColumnItemValueChanged(e,t,s,i,r,a){var o=e.question[t];if(Array.isArray(o)){var l=i==="value"?a:s.value,u=Ce.getItemByValue(o,l);u&&(u[i]=r)}}buildCells(e){this.isSettingValue=!0;for(var t=this.data.columns,s=0;s<t.length;s++){var i=t[s],r=this.createCell(i);this.cells.push(r);var a=this.getCellValue(e,i.name);if(!O.isValueEmpty(a)){r.question.value=a;var o=i.name+Te.commentSuffix;e&&!O.isValueEmpty(e[o])&&(r.question.comment=e[o])}}this.isSettingValue=!1}isTwoValueEquals(e,t){return O.isTwoValueEquals(e,t,!1,!0,!1)}getCellValue(e,t){return this.editingObj?q.getObjPropertyValue(this.editingObj,t):e?e[t]:void 0}createCell(e){return new My(e,this,this.data)}getSurveyData(){return this}getSurvey(){return this.data?this.data.getSurvey():null}getTextProcessor(){return this.textPreProcessor}get rowIndex(){return this.getRowIndex()}getRowIndex(){return this.data?this.data.getRowIndex(this)+1:-1}get editingObj(){return this.editingObjValue}dispose(){this.editingObj&&(this.editingObj.onPropertyChanged.remove(this.onEditingObjPropertyChanged),this.editingObjValue=null)}subscribeToChanges(e){!e||!e.getType||!e.onPropertyChanged||e!==this.editingObj&&(this.editingObjValue=e,this.onEditingObjPropertyChanged=(t,s)=>{this.updateOnSetValue(s.name,s.newValue)},this.editingObj.onPropertyChanged.add(this.onEditingObjPropertyChanged))}updateOnSetValue(e,t){this.isSettingValue=!0;let s=this.getQuestionsByName(e);for(let i=0;i<s.length;i++)s[i].value=t;this.isSettingValue=!1}};sn.idCounter=1;let Zu=class extends sn{constructor(e){super(e,null),this.buildCells(null)}createCell(e){return new NP(e,this,this.data)}setValue(e,t){this.data&&!this.isSettingValue&&this.data.onTotalValueChanged()}runCondition(e,t){var s=0,i;do i=O.getUnbindValue(this.value),super.runCondition(e,""),s++;while(!O.isTwoValueEquals(i,this.value)&&s<3)}updateCellOnColumnChanged(e,t,s){e.updateCellQuestion()}},ky=class{constructor(e,t){this.matrix=e,this.row=t}getLocale(){return this.matrix.getLocale()}getMarkdownHtml(e,t,s){return this.matrix.getMarkdownHtml(e,t,s)}getProcessedText(e){return this.matrix.processSingleInputTitle(e,this.row)}getRenderer(e){return this.matrix.getRenderer(e)}getRendererContext(e){return this.matrix.getRendererContext(e)}},rn=class extends ro{static get defaultCellType(){return A.matrix.defaultCellType}static set defaultCellType(e){A.matrix.defaultCellType=e}static addDefaultColumns(e){for(var t=qe.DefaultColums,s=0;s<t.length;s++)e.addColumn(t[s])}createColumnValues(){return this.createNewArray("columns",e=>{e.colOwner=this,this.onAddColumn&&this.onAddColumn(e),this.survey&&this.survey.matrixColumnAdded(this,e)},e=>{e.colOwner=null,this.onRemoveColumn&&this.onRemoveColumn(e)})}constructor(e){super(e),this.isRowChanging=!1,this.lockResetRenderedTable=!1,this.createItemValues("choices"),this.createLocString({name:"placeholder",hasTranslation:!0}),this.createLocString({name:"keyDuplicationError",hasTranslation:!0}),this.createLocalizableString("singleInputTitleTemplate",new ky(this),!0,this.getSingleInputTitleTemplate()),this.detailPanelValue=this.createNewDetailPanel(),this.detailPanel.selectedElementInDesign=this,this.detailPanel.renderWidth="100%",this.detailPanel.isInteractiveDesignElement=!1,this.detailPanel.showTitle=!1,this.registerPropertyChangedHandlers(["columns","cellType"],()=>{this.updateColumnsAndRows()}),this.registerPropertyChangedHandlers(["placeholder","columnColCount","rowTitleWidth","choices"],()=>{this.clearRowsAndResetRenderedTable()}),this.registerPropertyChangedHandlers(["transposeData","addRowButtonLocation","hideColumnsIfEmpty","showHeader","minRowCount","isReadOnly","rowCount","hasFooter","detailPanelMode","displayMode"],()=>{this.resetRenderedTable()})}getType(){return"matrixdropdownbase"}dispose(){super.dispose(),this.clearGeneratedRows()}get isContainer(){return!0}get isRowsDynamic(){return!1}get isUpdateLocked(){return this.isLoadingFromJson||this.isUpdating}beginUpdate(){this.isUpdating=!0}endUpdate(){this.isUpdating=!1,this.updateColumnsAndRows()}updateColumnsAndRows(){this.updateColumnsIndexes(this.columns),this.updateColumnsCellType(),this.generatedTotalRow=null,this.clearRowsAndResetRenderedTable()}itemValuePropertyChanged(e,t,s,i){super.itemValuePropertyChanged(e,t,s,i),e.ownerPropertyName==="choices"&&this.clearRowsAndResetRenderedTable()}get transposeData(){return this.getPropertyValue("transposeData")}set transposeData(e){this.setPropertyValue("transposeData",e)}get columnLayout(){return this.transposeData?"vertical":"horizontal"}set columnLayout(e){this.transposeData=e==="vertical"}get columnsLocation(){return this.columnLayout}set columnsLocation(e){this.columnLayout=e}get detailErrorLocation(){return this.getPropertyValue("detailErrorLocation")}set detailErrorLocation(e){this.setPropertyValue("detailErrorLocation",e.toLowerCase())}get cellErrorLocation(){return this.getPropertyValue("cellErrorLocation")}set cellErrorLocation(e){this.setPropertyValue("cellErrorLocation",e.toLowerCase())}getChildErrorLocation(e){const t=e.parent?this.detailErrorLocation:this.cellErrorLocation;return t!=="default"?t:super.getChildErrorLocation(e)}get isColumnLayoutHorizontal(){return this.isMobile?!0:!this.transposeData}get useCaseSensitiveComparison(){return this.useCaseSensitiveComparisonValue!==void 0?this.useCaseSensitiveComparisonValue:A.comparator.caseSensitive}set useCaseSensitiveComparison(e){this.useCaseSensitiveComparisonValue=e}get isUniqueCaseSensitive(){return this.useCaseSensitiveComparison}set isUniqueCaseSensitive(e){this.useCaseSensitiveComparison=e}get detailPanelMode(){return this.getPropertyValue("detailPanelMode")}set detailPanelMode(e){this.setPropertyValue("detailPanelMode",e)}get detailPanel(){return this.detailPanelValue}getPanels(){const e=this.getPanelInDesignMode();return e?[e]:null}getPanelInDesignMode(){return this.detailPanelMode!=="none"?this.detailPanel:null}get detailElements(){return this.detailPanel.elements}createNewDetailPanel(){return q.createClass("panel")}get hasRowText(){return!0}getFooterText(){return null}get canAddRow(){return!1}get canRemoveRows(){return!1}canRemoveRow(e){return!0}onPointerDown(e,t){}onRowsChanged(){this.clearVisibleRows(),this.resetRenderedTable(),super.onRowsChanged(),this.updateRowsVisibleIndexes()}updateRowsVisibleIndexes(){const e=this.visibleRows;if(!Array.isArray(e))return;const t=A.expressionVariables.visibleRowIndex,s={};s[t]=0;for(let i=0;i<e.length;i++)e[i].visibleIndex=i,s[t]=i+1,e[i].runTriggers(t,i+1,s)}onStartRowAddingRemoving(){this.lockResetRenderedTable=!0,this.setValueChangedDirectly(!0)}onEndRowAdding(){if(this.lockResetRenderedTable=!1,!!this.renderedTable)if(this.renderedTable.isRequireReset())this.resetRenderedTable();else{const e=this.visibleRows.length-1;this.renderedTable.onAddedRow(this.visibleRows[e],e)}}onEndRowRemoving(e){this.lockResetRenderedTable=!1,this.renderedTable.isRequireReset()?this.resetRenderedTable():e&&this.renderedTable.onRemovedRow(e)}get renderedTableValue(){return this.getPropertyValue("renderedTable",null)}set renderedTableValue(e){this.setPropertyValue("renderedTable",e)}clearRowsAndResetRenderedTable(){this.clearGeneratedRows(),this.resetRenderedTable(),this.fireCallback(this.columnsChangedCallback)}resetRenderedTable(e){this.renderedTableValue&&(this.lockResetRenderedTable||this.isUpdateLocked?e&&this.renderedTableValue.requireReset():(this.renderedTableValue=null,this.fireCallback(this.onRenderedTableResetCallback)))}clearGeneratedRows(){if(this.clearVisibleRows(),!!this.generatedVisibleRows){for(var e=0;e<this.generatedVisibleRows.length;e++)this.generatedVisibleRows[e].dispose();super.clearGeneratedRows()}}get isRendredTableCreated(){return!!this.renderedTableValue}get renderedTable(){return!this.renderedTableValue&&!this.isDisposed&&(this.renderedTableValue=this.createRenderedTable(),this.onRenderedTableCreatedCallback&&this.onRenderedTableCreatedCallback(this.renderedTableValue)),this.renderedTableValue}createRenderedTable(){return new uo(this)}getRowByQuestion(e){if(e)return e.data}onMatrixRowCreated(e){if(this.survey)for(var t={rowValue:e.value,row:e,column:null,columnName:null,cell:null,cellQuestion:null,value:null},s=0;s<this.columns.length;s++){t.column=this.columns[s],t.columnName=t.column.name;var i=e.cells[s];t.cell=i,t.cellQuestion=i.question,t.value=i.value,this.onCellCreatedCallback&&this.onCellCreatedCallback(t),this.survey.matrixCellCreated(this,t)}}get cellType(){return this.getPropertyValue("cellType",A.matrix.defaultCellType)}set cellType(e){e=e.toLowerCase(),this.setPropertyValue("cellType",e)}isSelectCellType(){return q.isDescendantOf(this.cellType,"selectbase")}updateColumnsCellType(){for(var e=0;e<this.columns.length;e++)this.columns[e].defaultCellTypeChanged()}updateColumnsIndexes(e){for(var t=0;t<e.length;t++)e[t].setIndex(t)}get columnColCount(){return this.getPropertyValue("columnColCount")}set columnColCount(e){e<0||e>4||this.setPropertyValue("columnColCount",e)}get horizontalScroll(){return this.getPropertyValue("horizontalScroll")}set horizontalScroll(e){this.setPropertyValue("horizontalScroll",e)}get allowAdaptiveActions(){return this.getPropertyValue("allowAdaptiveActions")}set allowAdaptiveActions(e){this.setPropertyValue("allowAdaptiveActions",e),this.detailPanel&&(this.detailPanel.allowAdaptiveActions=e)}hasChoices(){return this.choices.length>0}onColumnPropertyChanged(e,t,s){if(this.updateHasFooter(),!!this.generatedVisibleRows){for(var i=0;i<this.generatedVisibleRows.length;i++)this.generatedVisibleRows[i].updateCellQuestionOnColumnChanged(e,t,s);this.generatedTotalRow&&this.generatedTotalRow.updateCellQuestionOnColumnChanged(e,t,s),this.onColumnsChanged(),t=="isRequired"&&this.resetRenderedTable()}}onColumnNestedPropertyChanged(e,t,s,i){if(this.generatedVisibleRows)for(var r=0;r<this.generatedVisibleRows.length;r++){const o=this.generatedVisibleRows[r].getQuestionByColumn(e);o&&o[t]&&(o[t][s]=i)}}onColumnItemValuePropertyChanged(e,t,s,i,r,a){if(this.generatedVisibleRows)for(var o=0;o<this.generatedVisibleRows.length;o++)this.generatedVisibleRows[o].updateCellQuestionOnColumnItemValueChanged(e,t,s,i,r,a)}onShowInMultipleColumnsChanged(e){this.resetTableAndRows()}onColumnVisibilityChanged(e){this.resetTableAndRows()}onColumnCellTypeChanged(e){this.updateDefaultRowValue(e),this.resetTableAndRows()}updateDefaultRowValue(e){let t=this.defaultRowValue;t&&e.cellType==="file"&&t[e.name]&&(delete t[e.name],Object.keys(t).length===0&&(t=void 0),this.defaultRowValue=t)}resetTableAndRows(){this.clearGeneratedRows(),this.resetRenderedTable()}getRowTitleWidth(){return""}get hasFooter(){return this.getPropertyValue("hasFooter",!1)}getAddRowLocation(){return"default"}getShowColumnsIfEmpty(){return!1}updateShowTableAndAddRow(){this.renderedTable&&this.renderedTable.updateShowTableAndAddRow()}updateHasFooter(){this.setPropertyValue("hasFooter",this.hasTotal)}get hasTotal(){for(var e=0;e<this.columns.length;e++)if(this.columns[e].hasTotal)return!0;return!1}getCellType(){return this.cellType}getCustomCellType(e,t,s){if(!this.survey)return s;var i={rowValue:t.value,row:t,column:e,columnName:e.name,cellType:s};return this.survey.matrixCellCreating(this,i),i.cellType}getConditionJson(e=null,t=null){if(!t)return super.getConditionJson(e);let s="";for(let a=t.length-1;a>=0&&t[a]!=".";a--)s=t[a]+s;let i,r=this.getColumnByName(s);return r?i=r.createCellQuestion(null):this.detailPanelMode!=="none"&&(i=this.detailPanel.getQuestionByName(s)),i?i.getConditionJson(e):null}clearIncorrectValues(){if(!Array.isArray(this.visibleRows))return;const e=this.generatedVisibleRows;for(let t=0;t<e.length;t++)e[t].clearIncorrectValues(this.getRowValue(t))}clearErrors(){super.clearErrors(),this.runFuncForCellQuestions(e=>{e.clearErrors()})}localeChanged(){super.localeChanged(),this.runFuncForCellQuestions(e=>{e.localeChanged()})}runFuncForCellQuestions(e){const t=this.generatedVisibleRows;if(t)for(let s=0;s<t.length;s++){const i=t[s];if(i.isVisible)for(let r=0;r<i.cells.length;r++)e(i.cells[r].question)}}runConditionCore(e){super.runConditionCore(e);var t=0,s;do s=O.getUnbindValue(this.totalValue),this.runCellsCondition(e),this.runTotalsCondition(e),t++;while(!O.isTwoValueEquals(s,this.totalValue)&&t<3);this.updateVisibilityBasedOnRows()}runTriggers(e,t,s){super.runTriggers(e,t,s),this.runFuncForCellQuestions(i=>{i.runTriggers(e,t,s)})}updateElementVisibility(){super.updateElementVisibility();const e=this.generatedVisibleRows;e&&e.forEach(t=>t.updateElementVisibility()),this.updateShowTableAndAddRow()}shouldRunColumnExpression(){return!1}runCellsCondition(e){if(this.isDesignMode)return;const t=this.getExpressionFromSurvey("rowsVisibleIf"),s=this.generatedVisibleRows;if(s)for(var i=0;i<s.length;i++)s[i].runCondition(e,t);this.checkColumnsVisibility(),this.checkColumnsRenderedRequired()}runConditionsForColumns(e){const t=this.getExpressionFromSurvey("columnsVisibleIf");return this.columns.forEach(s=>{if(!t)s.isColumnsVisibleIf=!0;else{const i=new Fs(t);s.isColumnsVisibleIf=i.runContext(s.getValueGetterContext(),e)===!0}}),!1}checkColumnsVisibility(){if(!this.isDesignMode){for(var e=!1,t=0;t<this.columns.length;t++){const s=this.columns[t],i=!!s.visibleIf||s.isFilteredMultipleColumns;!i&&!this.columnsVisibleIf&&s.isColumnVisible||(e=this.isColumnVisibilityChanged(s,i)||e)}e&&this.resetRenderedTable(!0)}}checkColumnsRenderedRequired(){const e=this.generatedVisibleRows;if(e)for(var t=0;t<this.columns.length;t++){const i=this.columns[t];if(!i.requiredIf||!i.isColumnVisible)continue;let r=e.length>0;for(var s=0;s<e.length;s++)if(!e[s].cells[t].question.isRequired){r=!1;break}i.updateIsRenderedRequired(r)}}isColumnVisibilityChanged(e,t){const s=e.isColumnVisible;let i=!t;const r=this.generatedVisibleRows,a=t&&r,o=a&&e.isFilteredMultipleColumns,l=o?e.getVisibleChoicesInCell:[],u=new Array;if(a)for(let d=0;d<r.length;d++){const h=r[d].cells[e.index],f=h?.question;if(f&&f.isVisible)if(i=!0,o)this.updateNewVisibleChoices(f,u);else break}return e.hasVisibleCell=i&&e.isColumnsVisibleIf,o&&(e.setVisibleChoicesInCell(u),!O.isArraysEqual(l,u,!0,!1,!1))?!0:s!==e.isColumnVisible}updateNewVisibleChoices(e,t){const s=e.visibleChoices;if(Array.isArray(s))for(let i=0;i<s.length;i++){const r=s[i];t.indexOf(r.value)<0&&t.push(r.value)}}runTotalsCondition(e){this.generatedTotalRow&&this.generatedTotalRow.runCondition(e)}IsMultiplyColumn(e){return e.isShowInMultipleColumns&&!this.isMobile}locStrsChanged(){super.locStrsChanged();for(var e=this.columns,t=0;t<e.length;t++)e[t].locStrsChanged();var s=this.generatedVisibleRows;if(s){for(var t=0;t<s.length;t++)s[t].locStrsChanged();this.generatedTotalRow&&this.generatedTotalRow.locStrsChanged()}}getColumnByName(e){for(var t=0;t<this.columns.length;t++)if(this.columns[t].name==e)return this.columns[t];return null}getColumnName(e){return this.getColumnByName(e)}getColumnWidth(e){var t;return e.minWidth?e.minWidth:this.columnMinWidth?this.columnMinWidth:((t=A.matrix.columnWidthsByType[e.cellType])===null||t===void 0?void 0:t.minWidth)||""}get choices(){return this.getPropertyValue("choices")}set choices(e){this.setPropertyValue("choices",e)}get placeholder(){return this.getLocalizableStringText("placeholder")}set placeholder(e){this.setLocalizableStringText("placeholder",e)}get locPlaceholder(){return this.getLocalizableString("placeholder")}get optionsCaption(){return this.placeholder}set optionsCaption(e){this.placeholder=e}get keyDuplicationError(){return this.getLocalizableStringText("keyDuplicationError")}set keyDuplicationError(e){this.setLocalizableStringText("keyDuplicationError",e)}get locKeyDuplicationError(){return this.getLocalizableString("keyDuplicationError")}get singleInputTitleTemplate(){return this.getLocalizableStringText("singleInputTitleTemplate")}set singleInputTitleTemplate(e){this.setLocalizableStringText("singleInputTitleTemplate",e)}get locSingleInputTitleTemplate(){return this.getLocalizableString("singleInputTitleTemplate")}getSingleQuestionLocTitleCore(){return this.locSingleInputTitleTemplate}getSingleInputTitleTemplate(){return""}processSingleInputTitle(e,t){t||(t=this.getRowByQuestion(this.singleInputQuestion));const s=t?t.getTextProcessor():this.textProcessor;return s?s.processText(e,!0):e}singleInputMoveToFirstCore(){var e;const t=(e=this.singleInputQuestion)===null||e===void 0?void 0:e.data;this.singleInputEditRow(t)}singleInputEditRow(e){if(!e)return;const t=e.visibleQuestions;Array.isArray(t)&&t.length>0&&this.setSingleInputQuestion(t[0])}get storeOthersAsComment(){return this.survey?this.survey.storeOthersAsComment:!1}addColumn(e,t){var s=new lo(e,t,this);return this.columns.push(s),s}clearVisibleRows(){this.visibleRowsArray=null}isColumnVisible(e){return e.isColumnVisible}getVisibleRows(){return this.isUpdateLocked?null:this.isGenereatingRows?[]:this.visibleRowsArray?this.visibleRowsArray:(this.generateVisibleRowsIfNeeded(),this.visibleRowsArray=this.getVisibleFromGenerated(this.generatedVisibleRows),this.updateRowsVisibleIndexes(),this.visibleRowsArray)}get allRows(){return this.isGenereatingRows?[]:(this.generateVisibleRowsIfNeeded(),this.generatedVisibleRows)}generateVisibleRowsIfNeeded(){if(!this.isUpdateLocked&&!this.generatedVisibleRows){this.isGenereatingRows=!0,this.generatedVisibleRows=this.generateRows(),this.isGenereatingRows=!1;for(var e=0;e<this.generatedVisibleRows.length;e++){const t=this.generatedVisibleRows[e];t.visibleIndex=e,this.onMatrixRowCreated(t)}this.data&&(this.runCellsCondition(this.data.getFilteredProperties()),this.isValueChangedWithoutRows&&(this.isValueChangedWithoutRows=!1,this.runTriggersOnNewRows())),this.generatedVisibleRows&&(this.updateValueOnRowsGeneration(this.generatedVisibleRows),this.updateIsAnswered())}}runTriggersOnNewRows(){const e=this.value;this.generatedVisibleRows.forEach(t=>{const s=this.getRowValueCore(t,e);if(!O.isValueEmpty(s)){const i=O.createCopyWithPrefix(s,A.expressionVariables.row+".");t.runTriggers("",void 0,i)}})}getVisibleFromGenerated(e){const t=[];return e?(e.forEach(s=>{s.isVisible&&t.push(s)}),t.length===e.length?e:t):t}updateValueOnRowsGeneration(e){for(var t=this.createNewValue(!0),s=this.createNewValue(),i=0;i<e.length;i++){var r=e[i];if(!r.editingObj){var a=this.getRowValue(i),o=r.value;this.isTwoValueEquals(a,o)||(s=this.getNewValueOnRowChanged(r,"",o,!1,s).value)}}this.isTwoValueEquals(t,s)||(this.isRowChanging=!0,this.setNewValue(s),this.isRowChanging=!1)}get totalValue(){return!this.hasTotal||!this.visibleTotalRow?{}:this.visibleTotalRow.value}getVisibleTotalRow(){return this.isUpdateLocked?null:(this.hasTotal?this.generatedTotalRow||(this.generatedTotalRow=this.generateTotalRow(),this.data&&this.runTotalsCondition({survey:this.survey})):this.generatedTotalRow=null,this.generatedTotalRow)}get visibleTotalRow(){return this.getVisibleTotalRow()}onSurveyLoad(){super.onSurveyLoad(),this.updateColumnsIndexes(this.columns),this.clearGeneratedRows(),this.generatedTotalRow=null,this.updateHasFooter()}getRowValue(e){if(e<0||!Array.isArray(this.visibleRows))return null;var t=this.generatedVisibleRows;if(e>=t.length)return null;const s=this.value,i=this.getRowValueCore(t[e],s);return this.isValueSurveyElement(s)?i:O.getUnbindValue(i)}checkIfValueInRowDuplicated(e,t){return this.generatedVisibleRows?this.isValueInColumnDuplicated(t.name,!0,e):!1}setRowValue(e,t){if(e<0)return null;var s=this.visibleRows;if(e>=s.length)return null;s[e].value=t,this.onRowChanged(s[e],"",t,!1)}generateRows(){return null}generateTotalRow(){return new Zu(this)}createNewValue(e=!1){var t=this.value?this.createValueCopy():{};return e&&this.isMatrixValueEmpty(t)?null:t}getRowValueCore(e,t,s=!1){var i=t&&t[e.rowName]?t[e.rowName]:null;return!i&&s&&(i={},t&&(t[e.rowName]=i)),i}getRowObj(e){var t=this.getRowValueCore(e,this.value);return t&&t.getType?t:null}getRowDisplayValue(e,t,s){if(!s||t.editingObj)return s;for(var i=Object.keys(s),r=0;r<i.length;r++){var a=i[r],o=t.getQuestionByName(a);if(o||(o=this.getSharedQuestionByName(a,t)),o){var l=o.getDisplayValue(e,s[a]);e&&o.title&&o.title!==a?(s[o.title]=l,delete s[a]):s[a]=l}}return s}getPlainData(e={includeEmpty:!0}){var t=super.getPlainData(e);if(t){t.isNode=!0;const s=Array.isArray(t.data)?[].concat(t.data):[];t.data=this.visibleRows.map(i=>{var r={name:i.dataName,title:i.text,value:i.value,displayValue:this.getRowDisplayValue(!1,i,i.value),getString:a=>typeof a=="object"?JSON.stringify(a):a,isNode:!0,data:i.cells.map(a=>a.question.getPlainData(e)).filter(a=>!!a)};return(e.calculations||[]).forEach(a=>{r[a.propertyName]=i[a.propertyName]}),r}),t.data=t.data.concat(s)}return t}addConditionObjectsByContext(e,t){let s=[].concat(this.columns);this.detailPanelMode!=="none"&&(s=s.concat(this.detailPanel.questions));const i=!!t&&s.indexOf(t)>-1,r=t===!0||i,a=this.getConditionObjectsRowIndeces();r&&a.push(-1);for(var o=0;o<a.length;o++){const u=a[o],d=u>-1?this.getConditionObjectRowName(u):"row";if(!d)continue;const h=u>-1?this.getConditionObjectRowText(u):"row",f=u>-1||t===!0,C=f&&u===-1?".":"",b=(f?this.getValueName():"")+C+d+".",x=(f?this.processedTitle:"")+C+h+".";for(var l=0;l<s.length;l++){const V=s[l];if(u===-1&&t===V)continue;const P={name:b+V.name,text:x+V.fullTitle,question:this};u===-1&&t===!0?P.context=this:i&&b.startsWith("row.")&&(P.context=t),e.push(P)}}}onHidingContent(){if(super.onHidingContent(),!this.generatedVisibleRows)return;const e=[];this.collectNestedQuestions(e,!0),e.forEach(t=>t.onHidingContent())}getIsReadyNestedQuestions(){if(!this.generatedVisibleRows)return[];const e=new Array;return this.collectNestedQuestonsInRows(this.generatedVisibleRows,e,!1,!0,!1),this.generatedTotalRow&&this.collectNestedQuestonsInRows([this.generatedTotalRow],e,!1,!0,!1),e}collectNestedQuestionsCore(e,t,s,i){i&&e.push(this),this.collectNestedQuestonsInRows(this.visibleRows,e,t,s,i)}collectNestedQuestonsInRows(e,t,s,i,r){Array.isArray(e)&&e.forEach(a=>{a.questions.forEach(o=>o.addNestedQuestion(t,s,i,r))})}getConditionObjectRowName(e){return""}getConditionObjectRowText(e){return this.getConditionObjectRowName(e)}getConditionObjectsRowIndeces(){return[]}getProgressInfo(){if(this.getIsRequireToGenerateRows()&&this.generateVisibleRowsIfNeeded(),this.generatedVisibleRows)return yt.getProgressInfoByElements(this.getCellQuestions(),this.isRequired);const e=Te.createProgressInfo();return this.updateProgressInfoByValues(e),e.requiredQuestionCount===0&&this.isRequired&&(e.requiredQuestionCount=1,e.requiredAnsweredQuestionCount=this.isEmpty()?0:1),e}getIsRequireToGenerateRows(){return!!this.rowsVisibleIf}updateProgressInfoByValues(e){}updateProgressInfoByRow(e,t){for(var s=0;s<this.columns.length;s++){const i=this.columns[s];if(!i.templateQuestion.hasInput)continue;const r=!O.isValueEmpty(t[i.name]);!r&&i.templateQuestion.visibleIf||(e.questionCount+=1,e.requiredQuestionCount+=i.isRequired,e.answeredQuestionCount+=r?1:0,e.requiredAnsweredQuestionCount+=r&&i.isRequired?1:0)}}getCellQuestions(){const e=[];return this.runFuncForCellQuestions(t=>{e.push(t)}),e}onBeforeValueChanged(e){}onSetQuestionValue(){if(!this.isRowChanging&&(this.onBeforeValueChanged(this.value),!(!this.generatedVisibleRows||this.generatedVisibleRows.length==0))){this.isRowChanging=!0;for(var e=this.createNewValue(),t=0;t<this.generatedVisibleRows.length;t++){var s=this.generatedVisibleRows[t];this.generatedVisibleRows[t].value=this.getRowValueCore(s,e)}this.isRowChanging=!1}}setQuestionValue(e){super.setQuestionValue(e,!1),this.onSetQuestionValue(),this.updateIsAnswered()}supportAutoAdvance(){var e=this.generatedVisibleRows;if(e||(e=this.visibleRows),!e)return!0;for(var t=0;t<e.length;t++){var s=this.generatedVisibleRows[t].cells;if(s)for(var i=0;i<s.length;i++){var r=s[i].question;if(r&&(!r.supportAutoAdvance()||!r.value))return!1}}return!0}getContainsErrors(){return super.getContainsErrors()||this.checkForAnswersOrErrors(e=>e.containsErrors,!1)}getIsAnswered(){return super.getIsAnswered()&&this.checkForAnswersOrErrors(e=>e.isAnswered,!0)}checkForAnswersOrErrors(e,t=!1){var s=this.generatedVisibleRows;if(!s)return!1;for(var i=0;i<s.length;i++){var r=s[i].cells;if(r){for(var a=0;a<r.length;a++)if(r[a]){var o=r[a].question;if(o&&o.isVisible){if(e(o)){if(!t)return!0}else if(t)return!1}}}}return!!t}validateElementCore(e){const t=this.validateRows(e),s=this.isValueDuplicated(e);return super.validateElementCore(e)&&t&&!s}getIsRunningValidators(){if(super.getIsRunningValidators())return!0;if(!this.generatedVisibleRows)return!1;for(var e=0;e<this.generatedVisibleRows.length;e++){var t=this.generatedVisibleRows[e].cells;if(t){for(var s=0;s<t.length;s++)if(t[s]){var i=t[s].question;if(i&&i.isRunningValidators)return!0}}}return!1}getAllErrors(){var e=super.getAllErrors(),t=this.generatedVisibleRows;if(t===null)return e;for(var s=0;s<t.length;s++)for(var i=t[s],r=0;r<i.cells.length;r++){var a=i.cells[r].question.getAllErrors();a&&a.length>0&&(e=e.concat(a))}return e}validateRows(e){let t=this.generatedVisibleRows;t||(t=this.visibleRows);var s=!0;e.isSingleDetailPanel=this.detailPanelMode==="underRowSingle";for(var i=0;i<t.length;i++)t[i].isVisible&&(s=t[i].validate(e)&&s);return s}isValueDuplicated(e){if(!this.generatedVisibleRows)return!1;for(var t=this.getUniqueColumnsNames(),s=!1,i=0;i<t.length;i++){const r=this.getDuplicatedRowAndShowErrors(t[i],!0);r&&r.length>0&&(e.setErrorElement(r[0].getQuestionByColumnName(t[i])),s=!0)}return s}getUniqueColumnsNames(){for(var e=new Array,t=0;t<this.columns.length;t++)this.columns[t].isUnique&&e.push(this.columns[t].name);return e}isValueInColumnDuplicated(e,t,s){const i=this.getDuplicatedRowAndShowErrors(e,t,s);return s?i.indexOf(s)>-1:i.length>0}getDuplicatedRowAndShowErrors(e,t,s){const i=this.getDuplicatedRows(e);return t&&this.showDuplicatedErrorsInRows(i,e),this.removeDuplicatedErrorsInRows(i,e),i}getDuplicatedRows(e){const t={},s=[],i=this.generatedVisibleRows;for(var r=0;r<i.length;r++){let a;const o=i[r].getQuestionByName(e);if(o)a=o.value;else{const l=this.getRowValue(r);a=l?l[e]:void 0}this.isValueEmpty(a)||(!this.useCaseSensitiveComparison&&typeof a=="string"&&(a=a.toLocaleLowerCase()),t[a]||(t[a]=[]),t[a].push(i[r]))}for(let a in t)t[a].length>1&&t[a].forEach(o=>s.push(o));return s}showDuplicatedErrorsInRows(e,t){e.forEach(s=>{let i=s.getQuestionByName(t);const r=this.detailPanel.getQuestionByName(t);!i&&r&&(s.showDetailPanel(),s.detailPanel&&(i=s.detailPanel.getQuestionByName(t))),i&&(r&&s.showDetailPanel(),this.addDuplicationError(i))})}removeDuplicatedErrorsInRows(e,t){this.generatedVisibleRows.forEach(s=>{if(e.indexOf(s)<0){const i=s.getQuestionByName(t);i&&this.removeDuplicationError(s,i)}})}getDuplicationError(e){const t=e.errors;for(let s=0;s<t.length;s++)if(t[s].getErrorType()==="keyduplicationerror")return t[s];return null}addDuplicationError(e){this.getDuplicationError(e)||e.addError(new Py(this.keyDuplicationError,this))}removeDuplicationError(e,t){t.removeError(this.getDuplicationError(t))&&t.errors.length===0&&e.editingObj&&(e.editingObj[t.getValueName()]=t.value)}getFirstQuestionToFocus(e){return this.getFirstCellQuestion(e)}getFirstInputElementId(){var e=this.getFirstCellQuestion(!1);return e?e.inputId:super.getFirstInputElementId()}getFirstErrorInputElementId(){var e=this.getFirstCellQuestion(!0);return e?e.inputId:super.getFirstErrorInputElementId()}getFirstCellQuestion(e){if(!this.generatedVisibleRows)return null;for(var t=0;t<this.generatedVisibleRows.length;t++)for(var s=this.generatedVisibleRows[t].cells,i=0;i<s.length;i++)if(!e||s[i].question.currentErrorCount>0)return s[i].question;return null}onReadOnlyChanged(){if(super.onReadOnlyChanged(),!!this.generateRows)for(var e=0;e<this.visibleRows.length;e++)this.visibleRows[e].onQuestionReadOnlyChanged()}createQuestion(e,t){return this.createQuestionCore(e,t)}createQuestionCore(e,t){var s=t.createCellQuestion(e);return s.setSurveyImpl(e),s.setParentQuestion(this),s.inMatrixMode=!0,s}deleteRowValue(e,t){return e&&(delete e[t.rowName],this.isObject(e)&&Object.keys(e).length==0?null:e)}onAnyValueChanged(e,t){if(!(this.isUpdateLocked||this.isDoingonAnyValueChanged)){if(!this.generatedVisibleRows){e===this.getValueName()&&(this.isValueChangedWithoutRows=!0);return}this.isDoingonAnyValueChanged=!0;for(var s=this.generatedVisibleRows,i=0;i<s.length;i++)s[i].onAnyValueChanged(e,t);var r=this.visibleTotalRow;r&&r.onAnyValueChanged(e,t),this.isDoingonAnyValueChanged=!1}}isObject(e){return e!==null&&typeof e=="object"}getOnCellValueChangedOptions(e,t,s){const i=r=>e.getQuestionByName(r);return{row:e,columnName:t,rowValue:s,value:s?s[t]:null,getCellQuestion:i,cellQuestion:e.getQuestionByName(t),column:this.getColumnByName(t)}}onCellValueChanged(e,t,s){if(this.survey){var i=this.getOnCellValueChangedOptions(e,t,s);this.onCellValueChangedCallback&&this.onCellValueChangedCallback(i),this.survey.matrixCellValueChanged(this,i)}}validateCell(e,t,s){if(this.survey){var i=this.getOnCellValueChangedOptions(e,t,s);return this.survey.matrixCellValidate(this,i)}}get isValidateOnValueChanging(){return this.survey?this.survey.isValidateOnValueChanging:!1}get hasInvisibleRows(){const e=this.generatedVisibleRows;if(!Array.isArray(e))return!1;for(let t=0;t<e.length;t++)if(!e[t].isVisible)return!0;return!1}getFilteredData(){return this.isEmpty()||!this.generatedVisibleRows||this.isEditingSurveyElement?this.value:this.getFilteredDataCore()}getFilteredDataCore(){return this.value}onRowChanging(e,t,s){if(!this.survey&&!this.cellValueChangingCallback)return s?s[t]:null;var i=this.getOnCellValueChangedOptions(e,t,s),r=this.getRowValueCore(e,this.createNewValue(),!0);return i.oldValue=r?r[t]:null,this.cellValueChangingCallback&&(i.value=this.cellValueChangingCallback(e,t,i.value,i.oldValue)),this.survey&&this.survey.matrixCellValueChanging(this,i),i.value}getSharedQuestionFromArray(e,t){return this.survey&&this.valueName?this.survey.getQuestionByValueNameFromArray(this.valueName,e,t):null}onRowChanged(e,t,s,i){var r=t?this.getRowObj(e):null;if(r){var a=null;s&&!i&&(a=s[t]),this.isRowChanging=!0,q.setObjPropertyValue(r,t,a),this.isRowChanging=!1,this.onCellValueChanged(e,t,r)}else{var o=this.createNewValue(!0),l=this.getNewValueOnRowChanged(e,t,s,i,this.createNewValue());if(this.isTwoValueEquals(o,l.value))return;this.isRowChanging=!0,this.setNewValue(l.value),this.isRowChanging=!1,t&&this.onCellValueChanged(e,t,l.rowValue)}this.getUniqueColumnsNames().indexOf(t)>-1&&this.isValueInColumnDuplicated(t,!!r)}getNewValueOnRowChanged(e,t,s,i,r){const a=this.getRowValueCore(e,r,!0);if(i&&delete a[t],e.questions.forEach(l=>{delete a[l.getValueName()]}),s){s=JSON.parse(JSON.stringify(s));for(var o in s)this.isValueEmpty(s[o])||(a[o]=s[o])}return this.isObject(a)&&Object.keys(a).length===0&&(r=this.deleteRowValue(r,e)),r=this.correctValueForMinMaxRows(r),{value:r,rowValue:a}}correctValueForMinMaxRows(e){return e}getRowIndex(e){return Array.isArray(this.generatedVisibleRows)?this.generatedVisibleRows.indexOf(e):-1}getElementsInDesign(e=!1){let t;return this.detailPanelMode=="none"?t=super.getElementsInDesign(e):t=e?[this.detailPanel]:this.detailElements,this.columns.concat(t)}hasDetailPanel(e){return this.detailPanelMode=="none"?!1:this.isDesignMode?!0:this.onHasDetailPanelCallback?this.onHasDetailPanelCallback(e):this.detailElements.length>0}getIsDetailPanelShowing(e){if(this.detailPanelMode=="none")return!1;if(this.isDesignMode){var t=this.visibleRows.indexOf(e)==0;return t&&(e.detailPanel||e.showDetailPanel()),t}return this.getPropertyValue("isRowShowing"+e.id,!1)}setIsDetailPanelShowing(e,t){if(t!=this.getIsDetailPanelShowing(e)&&(this.setPropertyValue("isRowShowing"+e.id,t),this.updateDetailPanelButtonCss(e),this.renderedTable&&this.renderedTable.onDetailPanelChangeVisibility(e,t),this.survey&&this.survey.matrixDetailPanelVisibleChanged(this,e.rowIndex-1,e,t),t&&this.detailPanelMode==="underRowSingle"))for(var s=this.visibleRows,i=0;i<s.length;i++)s[i].id!==e.id&&s[i].isDetailPanelShowing&&s[i].hideDetailPanel()}getDetailPanelButtonCss(e){const t=new z().append(this.getPropertyValue("detailButtonCss"+e.id));return t.append(this.cssClasses.detailButton,t.toString()==="").toString()}getDetailPanelIconCss(e){const t=new z().append(this.getPropertyValue("detailIconCss"+e.id));return t.append(this.cssClasses.detailIcon,t.toString()==="").toString()}getDetailPanelIconId(e){return this.getIsDetailPanelShowing(e)?this.cssClasses.detailIconExpandedId:this.cssClasses.detailIconId}updateDetailPanelButtonCss(e){const t=this.cssClasses,s=this.getIsDetailPanelShowing(e),i=new z().append(t.detailIcon).append(t.detailIconExpanded,s);this.setPropertyValue("detailIconCss"+e.id,i.toString());const r=new z().append(t.detailButton).append(t.detailButtonExpanded,s);this.setPropertyValue("detailButtonCss"+e.id,r.toString())}createRowDetailPanel(e){if(this.isDesignMode)return this.detailPanel;var t=this.createNewDetailPanel();t.readOnly=this.isReadOnly||!e.isRowEnabled(),t.setSurveyImpl(e);var s=this.detailPanel.toJSON();return new qt().toObject(s,t),t.renderWidth="100%",t.updateCustomWidgets(),this.onCreateDetailPanelCallback&&this.onCreateDetailPanelCallback(e,t),t.questions.forEach(i=>i.setParentQuestion(this)),t.onSurveyLoad(),t}getSharedQuestionByName(e,t){if(!this.survey||!this.valueName)return null;var s=this.getRowIndex(t);return s<0?null:this.survey.getQuestionByValueNameFromArray(this.valueName,e,s)}runTriggersInRow(e,t,s){if(!(!this.survey||!this.valueName)){var i=this.getRowIndex(e);i<0||this.survey.getQuestionsByValueName(this.valueName).forEach(r=>{const a=r.visibleRows;Array.isArray(a)&&i<a.length&&a[0]instanceof sn&&a[i].runTriggers(t,s)})}}onTotalValueChanged(){this.data&&this.visibleTotalRow&&!this.isUpdateLocked&&!this.isSett&&this.data.setValue(this.getValueName()+A.matrix.totalsSuffix,this.totalValue,!1)}getParentTextProcessor(){if(!this.parentQuestion||!this.parent)return null;const e=this.parent.data;return e&&e.getTextProcessor?e.getTextProcessor():null}isMatrixReadOnly(){return this.isReadOnly}onRowVisibilityChanged(e){this.clearVisibleRows(),this.resetRenderedTable(),this.resetSingleInput()}clearValueIfInvisibleCore(e){super.clearValueIfInvisibleCore(e),this.clearInvisibleValuesInRows()}clearInvisibleValuesInRows(){var e;if(this.isEmpty()||!this.isRowsFiltered())return;(((e=this.survey)===null||e===void 0?void 0:e.questionsByValueName(this.getValueName()))||[]).length<2&&(this.value=this.getFilteredData())}isRowsFiltered(){return this.visibleRows!==this.generatedVisibleRows}getQuestionFromArray(e,t){return t>=this.visibleRows.length?null:this.visibleRows[t].getQuestionByName(e)}isMatrixValueEmpty(e){if(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)if(this.isObject(e[t])&&Object.keys(e[t]).length>0)return!1;return!0}return Object.keys(e).length==0}}get SurveyModel(){return this.survey}getCellTemplateData(e){return this.SurveyModel.getMatrixCellTemplateData(e)}getCellWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName(e,e.row instanceof Zu?"row-footer":"cell")}getCellWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData(e,e.row instanceof Zu?"row-footer":"cell")}getColumnHeaderWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName(e,"column-header")}getColumnHeaderWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData(e,"column-header")}getRowHeaderWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName(e,"row-header")}getRowHeaderWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData(e,"row-header")}onMobileChanged(){super.onMobileChanged(),this.resetRenderedTable()}getRootCss(){return new z().append(super.getRootCss()).append(this.cssClasses.rootScroll,this.horizontalScroll).toString()}afterRenderQuestionElement(e){super.afterRenderQuestionElement(e),this.setRootElement(e?.parentElement)}beforeDestroyQuestionElement(e){super.beforeDestroyQuestionElement(e),this.setRootElement(void 0)}setRootElement(e){this.rootElement=e}getRootElement(){return this.rootElement}get dragDropMatrixAttribute(){return this.renderedTable.wrapperDropTargetId}};q.addClass("matrixdropdownbase",[{name:"columns:matrixdropdowncolumns",uniqueProperty:"name",className:"matrixdropdowncolumn",isArray:!0},{name:"columnLayout",alternativeName:"columnsLocation",choices:["horizontal","vertical"],visible:!1,isSerializable:!1},{name:"transposeData:boolean",version:"1.9.130",oldName:"columnLayout"},{name:"detailElements",baseClassName:"question",visible:!1,isLightSerializable:!1},{name:"detailPanelMode",choices:["none","underRow","underRowSingle"],default:"none"},{name:"cellErrorLocation",default:"default",choices:["default","top","bottom"]},{name:"detailErrorLocation",default:"default",choices:["default","top","bottom"],visibleIf:n=>!!n&&n.detailPanelMode!="none"},{name:"horizontalScroll:boolean",visible:!1},{name:"choices:itemvalue[]",uniqueProperty:"value",visibleIf:n=>n.isSelectCellType()},{name:"placeholder",alternativeName:"optionsCaption",serializationProperty:"locPlaceholder"},{name:"keyDuplicationError",serializationProperty:"locKeyDuplicationError"},{name:"singleInputTitleTemplate",serializationProperty:"locSingleInputTitleTemplate",visibleIf(n){var e;return((e=n.survey)===null||e===void 0?void 0:e.questionsOnPageMode)==="inputPerPage"}},{name:"cellType",default:"dropdown",choices:()=>lo.getColumnTypes()},{name:"columnColCount",default:0,choices:[0,1,2,3,4]},"columnMinWidth",{name:"allowAdaptiveActions:boolean",default:!1,visible:!1}],function(){return new rn("")},"matrixbase");let BP=class extends ji{constructor(e){super(),this.question=e}getValue(e,t,s,i){if(!i&&this.question.isEmpty())return{isFound:e.length===0,value:void 0};if(e.length>0){const r=super.getValue(e,t,s,i);if(r&&r.isFound)return r}return new fs(this.question.value).getValue(e,t,s,i)}getRootObj(){return this.question.data}updateValueByItem(e,t){var s;const i=this.question.visibleRows;e=e.toLocaleLowerCase();for(let r=0;r<i.length;r++){const a=i[r];if((((s=a.rowName)===null||s===void 0?void 0:s.toString())||"").toLocaleLowerCase()===e){t.isFound=!0,t.context=a.getValueGetterContext();return}}}},FP=class extends sn{constructor(e,t,s,i){super(s,i),this.name=e,this.item=t,this.buildCells(i)}get rowName(){return this.name}get rowTitle(){return this.text}get text(){return this.item.text}get locText(){return this.item.locText}isItemVisible(){return this.item.isVisible}isRowEnabled(){return this.item.isEnabled}isRowHasEnabledCondition(){return!!this.item.enableIf}},Ny=class extends rn{constructor(e){super(e),this.defaultValuesInRows={},this.createLocalizableString("totalText",this,!0),this.registerPropertyChangedHandlers(["rows"],()=>{this.generatedVisibleRows&&(this.clearGeneratedRows(),this.resetRenderedTable(),this.getVisibleRows(),this.clearIncorrectValues())}),this.registerPropertyChangedHandlers(["hideIfRowsEmpty"],()=>{this.updateVisibilityBasedOnRows()})}getType(){return"matrixdropdown"}get totalText(){return this.getLocalizableStringText("totalText","")}set totalText(e){this.setLocalizableStringText("totalText",e)}get locTotalText(){return this.getLocalizableString("totalText")}getFooterText(){return this.locTotalText}getRowTitleWidth(){return this.rowTitleWidth}get hideIfRowsEmpty(){return this.getPropertyValue("hideIfRowsEmpty")}set hideIfRowsEmpty(e){this.setPropertyValue("hideIfRowsEmpty",e)}getSingleInputTitleTemplate(){return"rowNameTemplateTitle"}getValueGetterContext(){return new BP(this)}getDisplayValueCore(e,t){if(!t)return t;var s=this.visibleRows,i={};if(!s)return i;for(var r=0;r<s.length;r++){var a=s[r].rowName,o=t[a];if(o){if(e){var l=Ce.getTextOrHtmlByValue(this.rows,a);l&&(a=l)}i[a]=this.getRowDisplayValue(e,s[r],o)}}return i}getConditionObjectRowName(e){return"."+this.rows[e].value}getConditionObjectRowText(e){return"."+this.rows[e].calculatedText}getConditionObjectsRowIndeces(){const e=[];for(var t=0;t<this.rows.length;t++)e.push(t);return e}isNewValueCorrect(e){return O.isValueObject(e,!0)}clearIncorrectValues(){if(!this.isEmpty()){this.getVisibleRows();const e={},t=this.value;for(let s in t){const i=this.getRowByKey(s);i&&i.isVisible&&(e[s]=t[s])}this.value=e}super.clearIncorrectValues()}getRowByKey(e){const t=this.generatedVisibleRows;if(!t)return null;for(let s=0;s<t.length;s++)if(t[s].rowName===e)return t[s];return null}clearGeneratedRows(){this.generatedVisibleRows&&(this.isDisposed||this.generatedVisibleRows.forEach(e=>{this.defaultValuesInRows[e.rowName]=e.getNamesWithDefaultValues()}),super.clearGeneratedRows())}getRowValueForCreation(e,t){const s=e[t];if(!s)return s;const i=this.defaultValuesInRows[t];return!Array.isArray(i)||i.length===0||i.forEach(r=>{delete s[r]}),s}generateRows(){var e=new Array,t=this.rows;if(!t||t.length===0)return e;var s=this.value;s||(s={});for(var i=0;i<t.length;i++){const r=t[i];this.isValueEmpty(r.value)||e.push(this.createMatrixRow(r,this.getRowValueForCreation(s,r.value)))}return e}createMatrixRow(e,t){return new FP(e.value,e,this,t)}getFilteredDataCore(){const e={};return this.generatedVisibleRows.forEach(t=>{t.isVisible&&!t.isEmpty&&(e[t.rowName]=t.filteredValue)}),e}getSearchableItemValueKeys(e){e.push("rows")}getIsRequireToGenerateRows(){if(super.getIsRequireToGenerateRows())return!0;for(let e=0;e<this.rows.length;e++)if(this.rows[e].visibleIf)return!0;return!1}updateProgressInfoByValues(e){let t=this.value;t||(t={});for(var s=0;s<this.rows.length;s++){const i=this.rows[s],r=t[i.value];this.updateProgressInfoByRow(e,r||{})}}};q.addClass("matrixdropdown",[{name:"rows:itemvalue[]",uniqueProperty:"value"},"rowsVisibleIf:condition","rowTitleWidth",{name:"totalText",serializationProperty:"locTotalText"},"hideIfRowsEmpty:boolean"],function(){return new Ny("")},"matrixdropdownbase"),qe.Instance.registerQuestion("matrixdropdown",n=>{var e=new Ny(n);return e.choices=[1,2,3,4,5],e.rows=qe.DefaultRows,rn.addDefaultColumns(e),e}),typeof window<"u"&&window.addEventListener("touchmove",n=>{Yu.PreventScrolling&&n.preventDefault()},{passive:!1});let Yu=class vf{constructor(e,t=!0,s=!1){this.dd=e,this.longTap=t,this.fitToContainer=s,this.scrollIntervalId=null,this.stopLongTapIfMoveEnough=i=>{i.preventDefault(),this.currentX=i.pageX,this.currentY=i.pageY,!this.isMicroMovement&&(this.returnUserSelectBack(),this.stopLongTap())},this.stopLongTap=i=>{clearTimeout(this.timeoutID),this.timeoutID=null,document.removeEventListener("pointerup",this.stopLongTap),document.removeEventListener("pointermove",this.stopLongTapIfMoveEnough)},this.handlePointerCancel=i=>{this.clear()},this.handleEscapeButton=i=>{i.keyCode==27&&this.clear()},this.onContextMenu=i=>{i.preventDefault(),i.stopPropagation()},this.dragOver=i=>{this.moveShortcutElement(i),this.draggedElementShortcut.style.cursor="grabbing",this.dd.dragOver(i)},this.clear=()=>{cancelAnimationFrame(this.scrollIntervalId),document.removeEventListener("pointermove",this.dragOver),document.removeEventListener("pointercancel",this.handlePointerCancel),document.removeEventListener("keydown",this.handleEscapeButton),document.removeEventListener("pointerup",this.drop),this.draggedElementShortcut.removeEventListener("pointerup",this.drop),ft&&this.draggedElementShortcut.removeEventListener("contextmenu",this.onContextMenu),this.draggedElementShortcut.parentElement.removeChild(this.draggedElementShortcut),this.dd.clear(),this.draggedElementShortcut=null,this.scrollIntervalId=null,ft&&(this.savedTargetNode.style.cssText=null,this.savedTargetNode&&this.savedTargetNode.parentElement.removeChild(this.savedTargetNode),this.insertNodeToParentAtIndex(this.savedTargetNodeParent,this.savedTargetNode,this.savedTargetNodeIndex),vf.PreventScrolling=!1),this.savedTargetNode=null,this.savedTargetNodeParent=null,this.savedTargetNodeIndex=null,this.returnUserSelectBack()},this.drop=()=>{this.dd.drop(),this.clear()},this.draggedElementShortcut=null}get documentOrShadowRoot(){const e=this.rootElement.getRootNode();return e instanceof Document||e instanceof ShadowRoot?e:void 0}get rootElement(){return Ka(A.environment.root)?this.rootContainer||A.environment.root:this.rootContainer||A.environment.root.documentElement||document.body}get viewRootElement(){return Ka(this.rootElement)?this.rootElement.host:this.rootElement}get isMicroMovement(){const t=Math.abs(this.currentX-this.startX),s=Math.abs(this.currentY-this.startY);return t<5&&s<5}startLongTapProcessing(e,t,s,i,r=!1){this.startX=e.pageX,this.startY=e.pageY,document.body.style.setProperty("touch-action","none","important"),this.timeoutID=setTimeout(()=>{this.doStartDrag(e,t,s,i),r||(this.savedTargetNode=e.target,this.savedTargetNode.style.cssText=`
          position: absolute;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden;
          clip: rect(1px 1px 1px 1px);
          clip: rect(1px, 1px, 1px, 1px);
        `,this.savedTargetNodeParent=this.savedTargetNode.parentElement,this.savedTargetNodeIndex=this.getNodeIndexInParent(this.savedTargetNode),this.rootElement.appendChild(this.savedTargetNode)),this.stopLongTap()},this.longTap?500:0),document.addEventListener("pointerup",this.stopLongTap),document.addEventListener("pointermove",this.stopLongTapIfMoveEnough)}moveShortcutElement(e){let t=this.viewRootElement.getBoundingClientRect().x,s=this.viewRootElement.getBoundingClientRect().y,i=this.viewRootElement.scrollLeft,r=this.viewRootElement.scrollTop;this.doScroll(e.clientY,e.clientX);const a=this.draggedElementShortcut.offsetHeight,o=this.draggedElementShortcut.offsetWidth;let l=this.draggedElementShortcut.shortcutXOffset||o/2,u=this.draggedElementShortcut.shortcutYOffset||a/2;document.querySelectorAll("[dir='rtl']").length!==0&&(l=o/2,u=a/2);const d=document.documentElement.clientHeight,h=document.documentElement.clientWidth,f=e.pageX,C=e.pageY,b=e.clientX,x=e.clientY;t-=i,s-=r;const V=this.getShortcutBottomCoordinate(x,a,u);if(this.getShortcutRightCoordinate(b,o,l)>=h){this.draggedElementShortcut.style.left=h-o-t+"px",this.draggedElementShortcut.style.top=x-u-s+"px";return}if(b-l<=0){this.draggedElementShortcut.style.left=f-b-t+"px",this.draggedElementShortcut.style.top=x-s-u+"px";return}if(V>=d){this.draggedElementShortcut.style.left=b-l-t+"px",this.draggedElementShortcut.style.top=d-a-s+"px";return}if(x-u<=0){this.draggedElementShortcut.style.left=b-l-t+"px",this.draggedElementShortcut.style.top=C-x-s+"px";return}this.draggedElementShortcut.style.left=b-t-l+"px",this.draggedElementShortcut.style.top=x-s-u+"px"}getShortcutBottomCoordinate(e,t,s){return e+t-s}getShortcutRightCoordinate(e,t,s){return e+t-s}requestAnimationFrame(e){return requestAnimationFrame(e)}scrollByDrag(e,t,s){let r,a,o,l;e.tagName==="HTML"?(r=0,a=document.documentElement.clientHeight,o=0,l=document.documentElement.clientWidth):(r=e.getBoundingClientRect().top,a=e.getBoundingClientRect().bottom,o=e.getBoundingClientRect().left,l=e.getBoundingClientRect().right);const u=()=>{const d=t-r<=100,h=a-t<=100,f=s-o<=100,C=l-s<=100;d&&!f&&!C?e.scrollTop-=15:h&&!f&&!C?e.scrollTop+=15:C&&!d&&!h?e.scrollLeft+=15:f&&!d&&!h&&(e.scrollLeft-=15),this.scrollIntervalId=this.requestAnimationFrame(u)};this.scrollIntervalId=this.requestAnimationFrame(u)}doScroll(e,t){cancelAnimationFrame(this.scrollIntervalId);const s=this.draggedElementShortcut.style.display;this.draggedElementShortcut.style.display="none";let i=this.documentOrShadowRoot.elementFromPoint(t,e);this.draggedElementShortcut.style.display=s||"block";let r=Za(i);this.scrollByDrag(r,e,t)}doStartDrag(e,t,s,i){ft&&(vf.PreventScrolling=!0),e.which!==3&&(this.dd.dragInit(e,t,s,i),this.rootElement.append(this.draggedElementShortcut),this.moveShortcutElement(e),document.addEventListener("pointermove",this.dragOver),document.addEventListener("pointercancel",this.handlePointerCancel),document.addEventListener("keydown",this.handleEscapeButton),document.addEventListener("pointerup",this.drop),ft?this.draggedElementShortcut.addEventListener("contextmenu",this.onContextMenu):this.draggedElementShortcut.addEventListener("pointerup",this.drop))}returnUserSelectBack(){document.body.style.setProperty("touch-action","auto"),document.body.style.setProperty("user-select","auto"),document.body.style.setProperty("-webkit-user-select","auto")}startDrag(e,t,s,i,r=!1){if(document.body.style.setProperty("user-select","none","important"),document.body.style.setProperty("-webkit-user-select","none","important"),ft){this.startLongTapProcessing(e,t,s,i,r);return}this.doStartDrag(e,t,s,i)}getNodeIndexInParent(e){return[...e.parentElement.childNodes].indexOf(e)}insertNodeToParentAtIndex(e,t,s){e.insertBefore(t,e.childNodes[s])}};Yu.PreventScrolling=!1;let qy=class{get isBottom(){return!!this._isBottom}set isBottom(e){this._isBottom=e,this.ghostPositionChanged()}ghostPositionChanged(){this.onGhostPositionChanged.fire({},{})}get dropTargetDataAttributeName(){return`[data-sv-drop-target-${this.draggedElementType}]`}get survey(){var e;return this.surveyValue||((e=this.creator)===null||e===void 0?void 0:e.survey)}constructor(e,t,s,i){var r;this.surveyValue=e,this.creator=t,this._isBottom=null,this.onGhostPositionChanged=new Zt,this.onDragStart=new Zt,this.onDragEnd=new Zt,this.onDragClear=new Zt,this.onBeforeDrop=this.onDragStart,this.onAfterDrop=this.onDragEnd,this.draggedElement=null,this.dropTarget=null,this.prevDropTarget=null,this.allowDropHere=!1,this.banDropHere=()=>{this.allowDropHere=!1,this.doBanDropHere(),this.dropTarget=null,this.domAdapter.draggedElementShortcut.style.cursor="not-allowed",this.isBottom=null},this.doBanDropHere=()=>{},this.domAdapter=i||new Yu(this,s,(r=this.survey)===null||r===void 0?void 0:r.fitToContainer)}startDrag(e,t,s,i,r=!1){this.domAdapter.rootContainer=this.getRootElement(this.survey,this.creator),this.domAdapter.startDrag(e,t,s,i,r)}getRootElement(e,t){return t?t.rootElement:e.rootElement}dragInit(e,t,s,i){this.draggedElement=t,this.parentElement=s;const r=this.getShortcutText(this.draggedElement);this.domAdapter.draggedElementShortcut=this.createDraggedElementShortcut(r,i,e),this.onStartDrag(e);const a=this.draggedElement&&this.draggedElement.parent;this.onDragStart.fire(this,{fromElement:a,draggedElement:this.draggedElement})}onStartDrag(e){}isDropTargetDoesntChanged(e){return this.dropTarget===this.prevDropTarget&&e===this.isBottom}getShortcutText(e){return e?.shortcutText}createDraggedElementShortcut(e,t,s){const i=ge.createElement("div");return i&&(i.innerText=e,i.className=this.getDraggedElementClass()),i}getDraggedElementClass(){return"sv-dragged-element-shortcut"}doDragOver(){}afterDragOver(e){}findDropTargetNodeFromPoint(e,t){const s=this.domAdapter.draggedElementShortcut.style.display;if(this.domAdapter.draggedElementShortcut.style.display="none",!ge.isAvailable())return null;let i=this.domAdapter.documentOrShadowRoot.elementsFromPoint(e,t);this.domAdapter.draggedElementShortcut.style.display=s||"block";let r=0,a=i[r];for(;a&&a.className&&typeof a.className.indexOf=="function"&&a.className.indexOf("sv-drag-target-skipped")!=-1;)r++,a=i[r];return a?this.findDropTargetNodeByDragOverNode(a):null}getDataAttributeValueByNode(e){let t="svDropTarget";return this.draggedElementType.split("-").forEach(i=>{t+=this.capitalizeFirstLetter(i)}),e.dataset[t]}getDropTargetByNode(e,t){let s=this.getDataAttributeValueByNode(e);return this.getDropTargetByDataAttributeValue(s,e,t)}capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}calculateVerticalMiddleOfHTMLElement(e){const t=e.getBoundingClientRect();return t.y+t.height/2}calculateHorizontalMiddleOfHTMLElement(e){const t=e.getBoundingClientRect();return t.x+t.width/2}calculateIsBottom(e,t){return!1}findDropTargetNodeByDragOverNode(e){return e.closest(this.dropTargetDataAttributeName)}dragOver(e){const t=this.findDropTargetNodeFromPoint(e.clientX,e.clientY);if(!t){this.banDropHere();return}this.dropTarget=this.getDropTargetByNode(t,e);const s=this.isDropTargetValid(this.dropTarget,t);if(this.doDragOver(),!s){this.banDropHere();return}let i=this.calculateIsBottom(e.clientY,t);this.allowDropHere=!0,!this.isDropTargetDoesntChanged(i)&&(this.isBottom=null,this.isBottom=i,this.draggedElement!=this.dropTarget&&this.afterDragOver(t),this.prevDropTarget=this.dropTarget)}drop(){if(this.allowDropHere){const e=this.draggedElement.parent,t=this.doDrop();this.onDragEnd.fire(this,{fromElement:e,draggedElement:t,toElement:this.dropTarget})}}clear(){const e={draggedElement:this.draggedElement};this.dropTarget=null,this.prevDropTarget=null,this.draggedElement=null,this.isBottom=null,this.parentElement=null,this.onDragClear.fire(this,e)}},QP=class extends qy{constructor(){super(...arguments),this.dropIsBanned=!1,this.matrixRowMap={},this.fromIndex=null,this.toIndex=null,this.toMatrix=null,this.expandCollapseTimer=null,this.expandCollapseHandlingRow=null,this.doBanDropHere=()=>{this.dropIsBanned||(this.removeGhost(),this.parentElement.renderedTable.rows.splice(this.initialDraggedElementIndex,0,this.draggedRenderedRow),this.dropIsBanned=!0,this.lastDropTargetParentElement=this.parentElement)},this.doDrop=()=>{if(this.parentElement==this.toMatrix)this.fromIndex<this.toIndex&&this.toIndex--,this.parentElement.moveRowByIndex(this.fromIndex,this.toIndex);else if(this.toMatrix){const e=Object.assign({},this.parentElement.value[this.fromIndex]);this.parentElement.removeRowByIndex(this.fromIndex),this.toMatrix.addRowByIndex(e,this.toIndex)}return this.parentElement}}get draggedElementType(){return"matrix-row"}patchUserSelect(){const e=ge.getBody();e&&(this.restoreUserSelectValue=e.style.userSelect,e.style.userSelect="none")}onStartDrag(){this.patchUserSelect();const e=this.parentElement.renderedTable.rows;let t=e.findIndex(i=>i.row===this.draggedElement);t>=0&&(this.draggedRenderedRow=e[t],this.initialDraggedElementIndex=t,this.draggedRenderedRow.isGhostRow=!0,this.lastDropTargetParentElement=this.parentElement);const s=[];this.survey.onMatrixRowDragOver.isEmpty?s.push(this.parentElement):this.fillMatricies(this.survey.getAllQuestions(),s),this.fillMatrixRowMap(s),this.fromIndex=this.parentElement.visibleRows.indexOf(this.draggedElement)}fillMatricies(e,t){e.filter(i=>i.isDescendantOf("matrixdynamic")&&i.allowRowReorder).forEach(i=>{t.push(i),i.detailPanelMode!=="none"&&i.visibleRows.forEach(r=>{r.isDetailPanelShowing&&this.fillMatricies(r.questions,t)})})}fillMatrixRowMap(e){e.forEach(t=>{t.visibleRows.forEach(s=>{this.matrixRowMap[s.id]={row:s,matrix:t}}),t.visibleRows.length==0&&(this.matrixRowMap[t.id]={row:t,matrix:t})})}get shortcutClass(){return new z().append(this.parentElement.cssClasses.draggedRow).toString()}createDraggedElementShortcut(e,t,s){const i=ge.createElement("div");if(!i)return;i.className=this.shortcutClass;const r=!0;if(t){const a=t.closest("[data-sv-drop-target-matrix-row]"),o=a.cloneNode(r);o.style.cssText=`
        width: ${a.offsetWidth}px;
      `,o.classList.remove("sv-matrix__drag-drop--moveup"),o.classList.remove("sv-matrix__drag-drop--movedown"),this.draggedElement.isDragDropMoveDown=!1,this.draggedElement.isDragDropMoveUp=!1,i.appendChild(o);const l=t.getBoundingClientRect();i.shortcutXOffset=s.clientX-l.x,i.shortcutYOffset=s.clientY-l.y}return i}getDropTargetByDataAttributeValue(e){const t=this.matrixRowMap[e];return t?.row||t?.matrix}canInsertIntoThisRow(e){const t=this.parentElement.lockedRowCount;return t<=0||e.rowIndex>t}isDropTargetValid(e,t){return this.canInsertIntoThisRow(e)}calculateIsBottom(e,t){if(!!t.dataset.svDropTargetMatrix)return!0;const i=t.getBoundingClientRect();return e>=i.y+i.height/2}doDragOver(){var e,t,s,i,r,a,o,l;if(!this.survey.onMatrixRowDragOver.isEmpty&&this.dropTarget&&typeof this.dropTarget.isDetailPanelShowing<"u"&&this.dropTarget.isDetailPanelShowing===!1){const u=this.dropTarget,d=u.data,h=d.renderedTable.rows.filter(b=>b.row==u)[0],f=(i=(s=(t=(e=h?.cells[1])===null||e===void 0?void 0:e.item)===null||t===void 0?void 0:t.value)===null||s===void 0?void 0:s.actions)===null||i===void 0?void 0:i.filter(b=>b.id=="show-detail")[0],C=(l=(o=(a=(r=h?.cells[h.cells.length-1])===null||r===void 0?void 0:r.item)===null||a===void 0?void 0:a.value)===null||o===void 0?void 0:o.actions)===null||l===void 0?void 0:l.filter(b=>b.id=="show-detail")[0];f?.visible||C?.visible?this.expandCollapseHandlingRow!==u.id&&(this.expandCollapseHandlingRow=u.id,this.clearExpandCollapseTimeout(),this.expandCollapseTimer=setTimeout(()=>{const b=[];u.showDetailPanel(),this.fillMatricies([d],b),this.fillMatrixRowMap(b)},500)):this.clearExpandCollapseTimeout()}}removeGhost(){const e=this.lastDropTargetParentElement.renderedTable.rows,t=e.indexOf(this.draggedRenderedRow);t>=0&&e.splice(t,1)}afterDragOver(e){if(!this.dropTarget)return;const t=this.matrixRowMap[this.dropTarget.id].matrix,s=this.matrixRowMap[this.dropTarget.id].row,i=this.isBottom&&!s.isDetailPanelShowing?1:0;let r=0;const a={allow:t==this.parentElement,row:s,fromMatrix:this.parentElement,toMatrix:t};if(this.survey.onMatrixRowDragOver.fire(this.survey,a),!a.allow)return;this.removeGhost(),this.lastDropTargetParentElement=t;const o=t.renderedTable.rows;if(t.visibleRows.length>0){const l=o.findIndex(u=>u.row==this.dropTarget);l>=0&&o.splice(l+i,0,this.draggedRenderedRow),r=t.visibleRows.indexOf(this.dropTarget)+i}else t.renderedTable.headerRow||(o[0].cells[0].colSpans=this.draggedRenderedRow.cells.length),o.splice(0,0,this.draggedRenderedRow);this.toIndex=r,this.toMatrix=t,this.dropIsBanned=!1,super.ghostPositionChanged()}clear(){this.matrixRowMap={},this.parentElement.renderedTable.rows.forEach(s=>{s.isGhostRow=!1}),this.parentElement.clearOnDrop(),this.toMatrix&&this.toMatrix.clearOnDrop(),this.fromIndex=null,this.toIndex=null;const t=ge.getBody();t&&(t.style.userSelect=this.restoreUserSelectValue||"initial"),super.clear(),this.clearExpandCollapseTimeout()}clearExpandCollapseTimeout(){clearTimeout(this.expandCollapseTimer),this.expandCollapseTimer=null,this.expandCollapseHandlingRow=null}},Xu=class{constructor(e,t=!0){this.dragHandler=e,this.preventOnTouch=t,this.onPointerUp=s=>{this.clearListeners()},this.tryToStartDrag=s=>{if(this.currentX=s.pageX,this.currentY=s.pageY,!this.isMicroMovement)return this.clearListeners(),this.dragHandler(this.pointerDownEvent,this.targets,this.itemModel),!0}}onPointerDown(e,t){if(this.targets={currentTarget:e.currentTarget,target:e.target},ft&&this.preventOnTouch){this.dragHandler(e,this.targets,t);return}this.pointerDownEvent=e,this.startX=e.pageX,this.startY=e.pageY,this.targets.currentTarget.getRootNode().addEventListener("pointermove",this.tryToStartDrag),this.targets.currentTarget.addEventListener("pointerup",this.onPointerUp),this.itemModel=t}get isMicroMovement(){const t=Math.abs(this.currentX-this.startX),s=Math.abs(this.currentY-this.startY);return t<10&&s<10}clearListeners(){this.pointerDownEvent&&(this.targets.currentTarget.getRootNode().removeEventListener("pointermove",this.tryToStartDrag),this.targets.currentTarget.removeEventListener("pointerup",this.onPointerUp))}},By=class{constructor(e,t,s){this.locText=e,this.btnEdit=t,this.btnRemove=s}get showRemove(){return!!this.btnRemove}},Fy=class{constructor(e,t){this.question=e,this.noEntry=t,this.items=[]}isEmpty(){return this.items.length==0}dispose(){this.items.forEach(e=>{var t,s;(t=e.btnEdit)===null||t===void 0||t.dispose(),(s=e.btnRemove)===null||s===void 0||s.dispose()})}},HP=class extends io{constructor(e){super(e),this.question=e}getValue(e,t,s,i){if(!i&&this.question.isEmpty())return{isFound:e.length===0,value:void 0};if(s>-1){const a=this.question.allRows;return s>=0&&s<a.length?a[s].getValueGetterContext().getValue(e,!1,s,i):{isFound:!1,value:void 0,context:this}}return super.getValue(e,t,s,i)}},zP=class extends sn{constructor(e,t,s){super(t,s),this.index=e,this.buildCells(s)}getRowIndex(){const e=super.getRowIndex();return e>0?e:this.index+1}get rowName(){return this.id}get dataName(){return"row"+(this.index+1)}get text(){return"row "+(this.visibleIndex+1)}getAccessbilityText(){return(this.visibleIndex+1).toString()}get shortcutText(){const t=this.data.visibleRows.indexOf(this)+1,s=this.cells.length>1?this.cells[1].questionValue:void 0,i=this.cells.length>0?this.cells[0].questionValue:void 0;return s&&s.value||i&&i.value||""+t}},Qy=class extends rn{constructor(e){super(e),this.rowCounter=0,this.setRowCountValueFromData=!1,this.startDragMatrixRow=(t,s)=>{this.dragDropMatrixRows.startDrag(t,this.draggedRow,this,s.target)},this.initialRowCount=this.getDefaultPropertyValue("rowCount"),this.createLocString({name:"confirmDeleteText",translationKey:"confirmDelete"}),this.createLocalizableString("addRowText").onGetTextCallback=t=>t||this.defaultAddRowText,this.createLocString({name:"removeRowText",translationKey:"removeRow"}),this.createLocString({name:"noRowsText",hasTranslation:!0}),this.createLocString({name:"editRowText",translationKey:"editText"}),this.registerPropertyChangedHandlers(["hideColumnsIfEmpty","allowAddRows"],()=>{this.updateShowTableAndAddRow()}),this.registerPropertyChangedHandlers(["allowRowReorder","isReadOnly","lockedRowCount"],()=>{this.resetRenderedTable()}),this.registerPropertyChangedHandlers(["minRowCount"],()=>{this.onMinRowCountChanged()}),this.registerPropertyChangedHandlers(["maxRowCount"],()=>{this.onMaxRowCountChanged()}),this.dragOrClickHelper=new Xu(this.startDragMatrixRow)}setSurveyImpl(e,t){super.setSurveyImpl(e,t),this.dragDropMatrixRows=new QP(this.survey,null,!0)}isBanStartDrag(e){const t=e.target;return t.getAttribute("contenteditable")==="true"||t.nodeName==="INPUT"||!this.isDragHandleAreaValid(t)}isDragHandleAreaValid(e){return this.survey.matrixDragHandleArea==="icon"?e.classList.contains(this.cssClasses.dragElementDecorator):!0}onPointerDown(e,t){!t||!this.isRowsDragAndDrop||this.isDesignMode||this.isBanStartDrag(e)||t.isDetailPanelShowing||(this.draggedRow=t,this.dragOrClickHelper.onPointerDown(e))}getType(){return"matrixdynamic"}get isRowsDynamic(){return!0}get confirmDelete(){return this.getPropertyValue("confirmDelete")}set confirmDelete(e){this.setPropertyValue("confirmDelete",e)}get isValueArray(){return!0}get keyName(){return this.getPropertyValue("keyName","")}set keyName(e){this.setPropertyValue("keyName",e)}get defaultRowValue(){return this.getPropertyValue("defaultRowValue")}set defaultRowValue(e){this.setPropertyValue("defaultRowValue",e)}get copyDefaultValueFromLastEntry(){return this.getPropertyValue("copyDefaultValueFromLastEntry")}set copyDefaultValueFromLastEntry(e){this.setPropertyValue("copyDefaultValueFromLastEntry",e)}get defaultValueFromLastRow(){return this.copyDefaultValueFromLastEntry}set defaultValueFromLastRow(e){this.copyDefaultValueFromLastEntry=e}isDefaultValueEmpty(){return super.isDefaultValueEmpty()&&this.isValueEmpty(this.defaultRowValue)}valueFromData(e){return this.minRowCount<1||this.isEmpty()?super.valueFromData(e):this.correctValueForMinMaxRows(e)}correctValueForMinMaxRows(e){Array.isArray(e)||(e=[]);for(var t=e.length;t<this.minRowCount;t++)e.push({});return e}isNewValueCorrect(e){return Array.isArray(e)}setDefaultValue(){if(this.isValueEmpty(this.defaultRowValue)||!this.isValueEmpty(this.defaultValue)){super.setDefaultValue();return}if(!(!this.isEmpty()||this.rowCount==0)){for(var e=[],t=0;t<this.rowCount;t++)e.push(this.defaultRowValue);this.value=e}}moveRowByIndex(e,t){const s=this.createNewValue(),i=Math.max(e,t);if(!Array.isArray(s)&&i>=s.length)return;const r=s[e];s.splice(e,1),s.splice(t,0,r);const a=this.generatedVisibleRows;if(Array.isArray(a)&&i<a.length){const o=a[t],l=a[e];if(this.getIsDetailPanelShowing(l)!==this.getIsDetailPanelShowing(o)){const u=this.getIsDetailPanelShowing(o);this.setIsDetailPanelShowing(o,this.getIsDetailPanelShowing(l)),this.setIsDetailPanelShowing(l,u)}}this.value=s}addRowByIndex(e,t){const s=this.createNewValue();!Array.isArray(s)&&t>=s.length||(s.splice(t,0,e),this.rowCount++,this.value=s)}removeRowByIndex(e){const t=this.createNewValue();!Array.isArray(t)&&e>=t.length||(t.splice(e,1),this.rowCount--,this.value=t)}clearOnDrop(){this.isEditingSurveyElement||this.resetRenderedTable()}initDataUI(){this.generatedVisibleRows||this.getVisibleRows()}get rowCount(){return this.rowCountValue}set rowCount(e){if(e=O.getNumber(e),!(e<0||e>A.matrix.maxRowCount||e===this.rowCount)){this.setRowCountValueFromData=!1;var t=this.rowCountValue;if(this.rowCountValue=e,this.value&&this.value.length>e){var s=this.value;s.splice(e),this.value=s}if(this.isUpdateLocked){this.initialRowCount=e;return}if(this.generatedVisibleRows||t==0){this.generatedVisibleRows||(this.clearGeneratedRows(),this.generatedVisibleRows=[]),this.generatedVisibleRows.splice(e);for(var i=t;i<e;i++){var r=this.createMatrixRow(this.getValueForNewRow());this.generatedVisibleRows.push(r),this.onMatrixRowCreated(r)}this.runCondition(this.getDataFilteredProperties())}this.onRowsChanged()}}updateBindingProp(e,t){super.updateBindingProp(e,t);const s=this.generatedVisibleRows;if(e!=="rowCount"||!Array.isArray(s))return;const i=this.getUnbindValue(this.value)||[];if(i.length<s.length){let r=!1;for(let a=i.length;a<s.length;a++)r||(r=!s[a].isEmpty),i.push(s[a].value||{});r&&(this.value=i)}}updateProgressInfoByValues(e){let t=this.value;Array.isArray(t)||(t=[]);for(var s=0;s<this.rowCount;s++){const i=s<t.length?t[s]:{};this.updateProgressInfoByRow(e,i)}}getValueForNewRow(){var e=null;return this.onGetValueForNewRowCallBack&&(e=this.onGetValueForNewRowCallBack(this)),e}get allowRowReorder(){return this.getPropertyValue("allowRowReorder")}set allowRowReorder(e){this.setPropertyValue("allowRowReorder",e)}get allowRowsDragAndDrop(){return this.allowRowReorder}set allowRowsDragAndDrop(e){this.allowRowReorder=e}get allowRowDragIn(){var e,t;return!(!((t=(e=this.survey)===null||e===void 0?void 0:e.onMatrixRowDragOver)===null||t===void 0)&&t.isEmpty)}get isRowsDragAndDrop(){return this.allowRowReorder&&!this.isReadOnly}get lockedRowCount(){return this.getPropertyValue("lockedRowCount",0)}set lockedRowCount(e){this.setPropertyValue("lockedRowCount",e)}get iconDragElement(){return this.cssClasses.iconDragElement}createRenderedTable(){return new jP(this)}get rowCountValue(){return this.getPropertyValue("rowCount")}set rowCountValue(e){this.setPropertyValue("rowCount",e)}get minRowCount(){return this.getPropertyValue("minRowCount")}set minRowCount(e){e<0&&(e=0),this.setPropertyValue("minRowCount",e)}onMinRowCountChanged(){const e=this.minRowCount;e>this.maxRowCount&&(this.maxRowCount=e),this.initialRowCount<e&&(this.initialRowCount=e),this.rowCount<e&&(this.rowCount=e)}get maxRowCount(){return this.getPropertyValue("maxRowCount")}set maxRowCount(e){e<=0||(e>A.matrix.maxRowCount&&(e=A.matrix.maxRowCount),e!=this.maxRowCount&&this.setPropertyValue("maxRowCount",e))}onMaxRowCountChanged(){const e=this.maxRowCount;e<this.minRowCount&&(this.minRowCount=e),this.rowCount>e&&(this.rowCount=e)}get allowAddRows(){return this.getPropertyValue("allowAddRows")}set allowAddRows(e){this.setPropertyValue("allowAddRows",e)}get allowRemoveRows(){return this.getPropertyValue("allowRemoveRows")}set allowRemoveRows(e){this.setPropertyValue("allowRemoveRows",e),this.isUpdateLocked||this.resetRenderedTable()}get canAddRow(){return this.allowAddRows&&!this.isReadOnly&&this.rowCount<this.maxRowCount}get canRemoveRows(){var e=this.allowRemoveRows&&!this.isReadOnly&&this.rowCount>this.minRowCount;return this.canRemoveRowsCallback?this.canRemoveRowsCallback(e):e}canRemoveRow(e){if(!this.survey)return!0;const t=e.rowIndex-1;return this.lockedRowCount>0&&t<this.lockedRowCount?!1:this.survey.matrixAllowRemoveRow(this,t,e)}addRowUI(){this.addRow(!0)}getQuestionToFocusOnAddingRow(){if(this.visibleRows.length===0)return null;for(var e=this.visibleRows[this.visibleRows.length-1],t=0;t<e.cells.length;t++){var s=e.cells[t].question;if(s&&s.isVisible&&!s.isReadOnly)return s}return null}addRow(e){const t=this.rowCount,s=this.canAddRow;var i={question:this,canAddRow:s,allow:s};if(this.survey&&this.survey.matrixBeforeRowAdded(i),!!(s!==i.allow?i.allow:s!==i.canAddRow?i.canAddRow:s)&&(this.onStartRowAddingRemoving(),this.addRowCore(),this.onEndRowAdding(),this.singleInputOnAddItem(!1),this.detailPanelShowOnAdding&&this.visibleRows.length>0&&this.visibleRows[this.visibleRows.length-1].showDetailPanel(),e&&t!==this.rowCount)){const a=this.getQuestionToFocusOnAddingRow();a&&a.focus()}}get detailPanelShowOnAdding(){return this.getPropertyValue("detailPanelShowOnAdding")}set detailPanelShowOnAdding(e){this.setPropertyValue("detailPanelShowOnAdding",e)}hasRowsAsItems(){return!1}unbindValue(){this.clearGeneratedRows(),this.clearPropertyValue("value"),this.rowCountValue=0,super.unbindValue()}isValueSurveyElement(e){return this.isEditingSurveyElement||super.isValueSurveyElement(e)}addRowCore(){var e=this.rowCount;this.rowCount=this.rowCount+1;var t=this.getDefaultRowValue(!0),s=null;if(this.isValueEmpty(t)||(s=this.createNewValue(),s.length==this.rowCount&&(s[s.length-1]=t,this.value=s)),this.data){this.runCellsCondition(this.getDataFilteredProperties());const i=this.generatedVisibleRows;if(this.isValueEmpty(t)&&i.length>0){const r=i[i.length-1];this.isValueEmpty(r.value)||(s||(s=this.createNewValue()),!this.isValueSurveyElement(s)&&!this.isTwoValueEquals(s[s.length-1],r.value)&&(s[s.length-1]=r.value,this.value=s))}}if(this.survey){const i=this.visibleRows;if(e+1==this.rowCount&&i.length>0){const r=i[i.length-1];this.survey.matrixRowAdded(this,r),this.onRowsChanged()}}}getDefaultRowValue(e){for(var t=null,s=0;s<this.columns.length;s++){var i=this.columns[s].templateQuestion;i&&!this.isValueEmpty(i.getDefaultValue())&&(t=t||{},t[this.columns[s].name]=i.getDefaultValue())}if(!this.isValueEmpty(this.defaultRowValue))for(var r in this.defaultRowValue)t=t||{},t[r]=this.defaultRowValue[r];if(e&&this.copyDefaultValueFromLastEntry){var a=this.value;if(a&&Array.isArray(a)&&a.length>=this.rowCount-1){var o=a[this.rowCount-2];for(var r in o)t=t||{},t[r]=o[r]}}return t}focusAddBUtton(){const e=this.getRootElement();if(e&&this.cssClasses.buttonAdd){const t=e.querySelectorAll("."+this.cssClasses.buttonAdd)[0];t&&t.focus()}}getActionCellIndex(e){const t=this.showHeader?1:0;return this.isColumnLayoutHorizontal?e.cells.length:this.visibleRows.indexOf(e)+t}removeRowUI(e){if(e&&e.rowName){var t=this.visibleRows.indexOf(e);if(t<0)return;e=t}this.removeRow(e,void 0,()=>{const s=this.visibleRows.length,i=t>=s?s-1:t,r=i>-1?this.visibleRows[i]:void 0;setTimeout(()=>{r?this.renderedTable.focusActionCell(r,this.getActionCellIndex(r)):this.focusAddBUtton()},10)})}isRequireConfirmOnRowDelete(e){if(!this.confirmDelete||e<0||e>=this.rowCount)return!1;var t=this.createNewValue();return this.isValueEmpty(t)||!Array.isArray(t)||e>=t.length?!1:!this.isValueEmpty(t[e])}removeRow(e,t,s){if(this.canRemoveRows&&!(e<0||e>=this.rowCount)){var i=this.visibleRows&&e<this.visibleRows.length?this.visibleRows[e]:null;if(t===void 0&&(t=this.isRequireConfirmOnRowDelete(e)),t){Ga({message:this.confirmDeleteText,funcOnYes:()=>{this.removeRowAsync(e,i),s&&s()},locale:this.getLocale(),rootElement:this.survey.rootElement,cssClass:this.cssClasses.confirmDialog});return}this.removeRowAsync(e,i),s&&s()}}removeRowAsync(e,t){t&&this.survey&&!this.survey.matrixRowRemoving(this,e,t)||(this.onStartRowAddingRemoving(),this.removeRowCore(e),this.singleInputOnRemoveItem(e),this.onEndRowRemoving(t))}removeRowCore(e){var t=this.visibleRows?this.visibleRows[e]:null;if(e=this.generatedVisibleRows.indexOf(t),!(e<0)){if(this.generatedVisibleRows&&e<this.generatedVisibleRows.length&&this.generatedVisibleRows.splice(e,1),this.rowCountValue--,this.value){var s=[];Array.isArray(this.value)&&e<this.value.length?s=this.createValueCopy():s=this.createNewValue(),s.splice(e,1),s=this.deleteRowValue(s,null),this.isRowChanging=!0,this.value=s,this.isRowChanging=!1}this.onRowsChanged(),this.survey&&this.survey.matrixRowRemoved(this,e,t)}}onSingleInputQuestionAdded(e){this.showHeader||(e.titleLocation="hidden")}getSingleInputQuestionsCore(e,t){const s=new Array,i=this.visibleRows;if(t)for(let r=0;r<i.length;r++){const a=i[r];(!a.hasValueAnyQuestion(!0)||!a.validate(new Cr))&&this.fillSingleInputQuestionsByRow(s,a)}return this.getSingleInputQuestionsForDynamic(e,s)}fillSingleInputQuestionsInContainer(e,t){const s=this.getRowByQuestion(t);this.fillSingleInputQuestionsByRow(e,s)}fillSingleInputQuestionsByRow(e,t){t&&t.questions.forEach(s=>s.addNestedQuestion(e,!0,!1,!1))}getSingleInputAddTextCore(){if(this.canAddRow)return this.addRowText}singleInputAddItemCore(){this.addRowUI()}getSingleQuestionOnChange(e){const t=this.visibleRows;if(t.length>0){(e<0||e>=t.length)&&(e=t.length-1);const i=t[e].visibleQuestions;if(i.length>0)return i[0]}return null}createSingleInputSummary(){const e=new Fy(this,this.locNoRowsText),t=new Array,s=this.canRemoveRows;return this.visibleRows.forEach(i=>{const r=new At(new ky(this,i),!0,void 0,this.getSingleInputTitleTemplate());r.setJson(this.locSingleInputTitleTemplate.getJson());const a=new Pe({locTitle:this.getLocalizableString("editRowText"),action:()=>{this.singleInputEditRow(i)}}),o=s&&this.canRemoveRow(i)?new Pe({locTitle:this.locRemoveRowText,action:()=>{this.removeRowUI(i)}}):void 0;t.push(new By(r,a,o))}),e.items=t,e}get confirmDeleteText(){return this.getLocalizableStringText("confirmDeleteText")}set confirmDeleteText(e){this.setLocalizableStringText("confirmDeleteText",e)}get locConfirmDeleteText(){return this.getLocalizableString("confirmDeleteText")}get addRowText(){return this.getLocalizableStringText("addRowText",this.defaultAddRowText)}set addRowText(e){this.setLocalizableStringText("addRowText",e)}get locAddRowText(){return this.getLocalizableString("addRowText")}get defaultAddRowText(){return this.getLocalizationString(this.isColumnLayoutHorizontal?"addRow":"addColumn")}getSingleInputTitleTemplate(){return"rowIndexTemplateTitle"}get addRowButtonLocation(){return this.getPropertyValue("addRowButtonLocation")}set addRowButtonLocation(e){this.setPropertyValue("addRowButtonLocation",e)}get addRowLocation(){return this.addRowButtonLocation}set addRowLocation(e){this.addRowButtonLocation=e}getAddRowLocation(){return this.addRowButtonLocation}get hideColumnsIfEmpty(){return this.getPropertyValue("hideColumnsIfEmpty")}set hideColumnsIfEmpty(e){this.setPropertyValue("hideColumnsIfEmpty",e)}getShowColumnsIfEmpty(){return this.hideColumnsIfEmpty}get removeRowText(){return this.getLocalizableStringText("removeRowText")}set removeRowText(e){this.setLocalizableStringText("removeRowText",e)}get locRemoveRowText(){return this.getLocalizableString("removeRowText")}get noRowsText(){return this.getLocalizableStringText("noRowsText")}set noRowsText(e){this.setLocalizableStringText("noRowsText",e)}get locNoRowsText(){return this.getLocalizableString("noRowsText")}get emptyRowsText(){return this.noRowsText}set emptyRowsText(e){this.noRowsText=e}get locEmptyRowsText(){return this.locNoRowsText}getValueGetterContext(){return new HP(this)}getDisplayValueCore(e,t){if(!t||!Array.isArray(t))return t;for(var s=this.getUnbindValue(t),i=this.visibleRows,r=0;r<i.length&&r<s.length;r++){var a=s[r];a&&(s[r]=this.getRowDisplayValue(e,i[r],a))}return s}getConditionObjectRowName(e){return"["+e.toString()+"]"}getConditionObjectsRowIndeces(){const e=[],t=Math.max(this.rowCount,1);for(var s=0;s<Math.min(A.matrix.maxRowCountInCondition,t);s++)e.push(s);return e}supportAutoAdvance(){return!1}get hasRowText(){return!1}onCheckForErrors(e,t,s){super.onCheckForErrors(e,t,s),!t&&!this.validateMinRows()&&e.push(new mP(this.minRowCount,this))}validateMinRows(){if(this.minRowCount<=0||!this.isRequired||!this.generatedVisibleRows)return!0;let e=0;return this.generatedVisibleRows.forEach(t=>{t.isEmpty||e++}),e>=this.minRowCount}getUniqueColumnsNames(){var e=super.getUniqueColumnsNames();const t=this.keyName;return t&&e.indexOf(t)<0&&e.push(t),e}generateRows(){var e=new Array;if(this.rowCount===0)return e;for(var t=this.createNewValue(),s=0;s<this.rowCount;s++)e.push(this.createMatrixRow(this.getRowValueByIndex(t,s)));return this.isValueEmpty(this.getDefaultRowValue(!1))||(this.value=t),e}createMatrixRow(e){return new zP(this.rowCounter++,this,e)}getInsertedDeletedIndex(e,t){const s=Math.min(e.length,t.length);for(let i=0;i<s;i++)if(t[i]!==e[i].editingObj)return i;return s}isEditingObjectValueChanged(){const e=this.value;if(!this.generatedVisibleRows||!this.isValueSurveyElement(e))return!1;let t=this.lastDeletedRow;this.lastDeletedRow=void 0;const s=this.generatedVisibleRows;if(!Array.isArray(e)||Math.abs(s.length-e.length)>1||s.length===e.length)return!1;const i=this.getInsertedDeletedIndex(s,e);if(s.length>e.length){this.lastDeletedRow=s[i];const r=s[i];s.splice(i,1),this.isRendredTableCreated&&this.renderedTable.onRemovedRow(r)}else{let r;t&&t.editingObj===e[i]?r=t:(t=void 0,r=this.createMatrixRow(e[i])),s.splice(i,0,r),t||this.onMatrixRowCreated(r),this.isRendredTableCreated&&this.renderedTable.onAddedRow(r,i)}return this.setPropertyValueDirectly("rowCount",e.length),!0}updateValueFromSurvey(e,t=!1){if(this.setRowCountValueFromData=!0,this.minRowCount>0&&O.isValueEmpty(e)&&!O.isValueEmpty(this.defaultRowValue)){e=[];for(let s=0;s<this.minRowCount;s++)e.push(O.createCopy(this.defaultRowValue))}super.updateValueFromSurvey(e,t),this.setRowCountValueFromData=!1}getFilteredDataCore(){const e=[];return this.generatedVisibleRows.forEach(t=>{t.isVisible&&!t.isEmpty&&e.push(t.filteredValue)}),e}onBeforeValueChanged(e){if(!(!e||!Array.isArray(e))){var t=e.length;if(t!=this.rowCount&&!(!this.setRowCountValueFromData&&t<this.initialRowCount)&&!this.isEditingObjectValueChanged()&&(this.setRowCountValueFromData=!0,this.rowCountValue=t,!!this.generatedVisibleRows)){if(t==this.generatedVisibleRows.length+1){this.onStartRowAddingRemoving();const s=this.getRowValueByIndex(e,t-1),i=this.createMatrixRow(s);this.generatedVisibleRows.push(i),this.onMatrixRowCreated(i),this.onEndRowAdding()}else this.clearGeneratedRows(),this.getVisibleRows(),this.onRowsChanged();this.setRowCountValueFromData=!1}}}createNewValue(){var e=this.createValueCopy();(!e||!Array.isArray(e))&&(e=[]),e.length>this.rowCount&&e.splice(this.rowCount);var t=this.getDefaultRowValue(!1);t=t||{};for(var s=e.length;s<this.rowCount;s++)e.push(this.getUnbindValue(t));return e}deleteRowValue(e,t){if(!Array.isArray(e))return e;for(var s=!0,i=0;i<e.length;i++)if(this.isObject(e[i])&&Object.keys(e[i]).length>0){s=!1;break}return s?null:e}getRowValueByIndex(e,t){return Array.isArray(e)&&t>=0&&t<e.length?e[t]:null}getRowValueCore(e,t,s=!1){if(!this.generatedVisibleRows)return{};var i=this.getRowValueByIndex(t,this.generatedVisibleRows.indexOf(e));return!i&&s&&(i={}),i}getAddRowButtonCss(e=!1){return new z().append(this.cssClasses.button).append(this.cssClasses.buttonAdd).append(this.cssClasses.emptyRowsButton,e).toString()}getRemoveRowButtonCss(){return new z().append(this.cssClasses.button).append(this.cssClasses.buttonRemove).toString()}getRootCss(){var e;return new z().append(super.getRootCss()).append(this.cssClasses.empty,!(!((e=this.renderedTable)===null||e===void 0)&&e.showTable)).toString()}},jP=class extends uo{setDefaultRowActions(e,t){super.setDefaultRowActions(e,t)}};q.addClass("matrixdynamic",[{name:"allowAddRows:boolean",default:!0},{name:"allowRemoveRows:boolean",default:!0},{name:"rowCount:number",default:2,minValue:0,isBindable:!0},{name:"minRowCount:number",default:0,minValue:0},{name:"maxRowCount:number",default:A.matrix.maxRowCount},{name:"keyName"},"defaultRowValue:rowvalue",{name:"copyDefaultValueFromLastEntry:boolean",alternativeName:"defaultValueFromLastRow"},{name:"confirmDelete:boolean"},{name:"confirmDeleteText",dependsOn:"confirmDelete",visibleIf:function(n){return!n||n.confirmDelete},serializationProperty:"locConfirmDeleteText"},{name:"addRowButtonLocation",alternativeName:"addRowLocation",default:"default",choices:["default","top","bottom","topBottom"]},{name:"addRowText",serializationProperty:"locAddRowText"},{name:"removeRowText",serializationProperty:"locRemoveRowText"},"hideColumnsIfEmpty:boolean",{name:"noRowsText:text",alternativeName:"emptyRowsText",serializationProperty:"locNoRowsText",dependsOn:"hideColumnsIfEmpty",visibleIf:function(n){return!n||n.hideColumnsIfEmpty}},{name:"detailPanelShowOnAdding:boolean",dependsOn:"detailPanelMode",visibleIf:function(n){return n.detailPanelMode!=="none"}},{name:"allowRowReorder:switch",alternativeName:"allowRowsDragAndDrop"}],function(){return new Qy("")},"matrixdropdownbase"),qe.Instance.registerQuestion("matrixdynamic",n=>{var e=new Qy(n);return e.choices=[1,2,3,4,5],rn.addDefaultColumns(e),e});var xr={currentType:"default",getCss:function(){var n=this.currentType?this[this.currentType]:eh;return n||(n=eh),n},getAvailableThemes:function(){return Object.keys(this).filter(n=>["currentType","getCss","getAvailableThemes"].indexOf(n)===-1)}},eh={root:"sd-root-modern",rootProgress:"sd-progress",rootMobile:"sd-root-modern--mobile",rootAnimationDisabled:"sd-root-modern--animation-disabled",rootReadOnly:"sd-root--readonly",rootCompact:"sd-root--compact",rootFitToContainer:"sd-root-modern--full-container",rootWrapper:"sd-root-modern__wrapper",rootWrapperFixed:"sd-root-modern__wrapper--fixed",rootWrapperHasImage:"sd-root-modern__wrapper--has-image",rootBackgroundImage:"sd-root_background-image",container:"sd-container-modern",header:"sd-title sd-container-modern__title",bodyContainer:"sv-components-row",body:"sd-body",bodyWithTimer:"sd-body--with-timer",clockTimerRoot:"sd-timer",clockTimerRootTop:"sd-timer--top",clockTimerRootBottom:"sd-timer--bottom",clockTimerProgress:"sd-timer__progress",clockTimerProgressAnimation:"sd-timer__progress--animation",clockTimerTextContainer:"sd-timer__text-container",clockTimerMinorText:"sd-timer__text--minor",clockTimerMajorText:"sd-timer__text--major",bodyEmpty:"sd-body sd-body--empty",bodyLoading:"sd-body--loading",footer:"sd-footer sd-body__navigation sd-clearfix",title:"sd-title",description:"sd-description",logo:"sd-logo",logoImage:"sd-logo__image",headerText:"sd-header__text",headerClose:"sd-hidden",navigationButton:"",bodyNavigationButton:"sd-btn",completedPage:"sd-completedpage",completedBeforePage:"sd-completed-before-page",timerRoot:"sd-body__timer",navigation:{complete:"sd-btn--action sd-navigation__complete-btn",prev:"sd-navigation__prev-btn",next:"sd-navigation__next-btn",start:"sd-navigation__start-btn",preview:"sd-navigation__preview-btn",edit:"sd-btn sd-btn--small"},panel:{contentEnter:"sd-element__content--enter",contentLeave:"sd-element__content--leave",enter:"sd-element-wrapper--enter",leave:"sd-element-wrapper--leave",asPage:"sd-panel--as-page",number:"sd-element__num",title:"sd-title sd-element__title sd-panel__title",titleExpandable:"sd-element__title--expandable",titleExpandableSvg:"sd-element__title-expandable-svg",titleNumInline:"sd-element__title--num-inline",titleExpanded:"sd-element__title--expanded",titleCollapsed:"sd-element__title--collapsed",titleDisabled:"sd-element__title--disabled",titleOnExpand:"sd-panel__title--expanded",titleOnError:"sd-panel__title--error",titleBar:"sd-action-title-bar",description:"sd-description sd-panel__description",container:"sd-element sd-element--complex sd-panel sd-row__panel",withFrame:"sd-element--with-frame",content:"sd-element__content sd-panel__content",icon:"sd-panel__icon",iconExpanded:"sd-panel__icon--expanded",footer:"sd-panel__footer",requiredMark:"sd-panel__required-text",header:"sd-panel__header sd-element__header sd-element__header--location-top",collapsed:"sd-element--collapsed",expanded:"sd-element--expanded",expandable:"sd-element--expandable",expandableAnimating:"sd-elemenet--expandable--animating",nested:"sd-element--nested sd-element--nested-with-borders",invisible:"sd-element--invisible",navigationButton:"",compact:"sd-element--with-frame sd-element--compact",errorsContainer:"sd-panel__errbox sd-element__erbox sd-element__erbox--above-element"},paneldynamic:{mainRoot:"sd-element  sd-question sd-question--paneldynamic sd-element--complex sd-question--complex sd-row__question",empty:"sd-question--empty",root:"sd-paneldynamic",iconRemove:"sd-hidden",navigation:"sd-paneldynamic__navigation",title:"sd-title sd-element__title sd-question__title",header:"sd-paneldynamic__header sd-element__header",headerTab:"sd-paneldynamic__header-tab",button:"sd-action sd-paneldynamic__btn",buttonRemove:"sd-action--negative sd-paneldynamic__remove-btn",buttonAdd:"sd-paneldynamic__add-btn",buttonPrev:"sd-paneldynamic__prev-btn sd-action--icon sd-action",buttonPrevDisabled:"sd-action--disabled",buttonNextDisabled:"sd-action--disabled",buttonNext:"sd-paneldynamic__next-btn sd-action--icon sd-action",progressContainer:"sd-paneldynamic__progress-container",progress:"sd-progress",progressBar:"sd-progress__bar",nested:"sd-element--nested sd-element--nested-with-borders",progressText:"sd-paneldynamic__progress-text",separator:"sd-paneldynamic__separator",panelWrapper:"sd-paneldynamic__panel-wrapper",footer:"sd-paneldynamic__footer",panelFooter:"sd-paneldynamic__panel-footer",footerButtonsContainer:"sd-paneldynamic__buttons-container",panelsContainer:"sd-paneldynamic__panels-container",panelWrapperInRow:"sd-paneldynamic__panel-wrapper--in-row",panelWrapperEnter:"sd-paneldynamic__panel-wrapper--enter",panelWrapperLeave:"sd-paneldynamic__panel-wrapper--leave",panelWrapperList:"sd-paneldynamic__panel-wrapper--list",progressBtnIcon:"icon-progressbuttonv2",noEntriesPlaceholder:"sd-paneldynamic__placeholder sd-question__placeholder",compact:"sd-element--with-frame sd-element--compact",tabsContainer:"sd-paneldynamic__tabs-container",tabsContainerWithHeader:"sd-paneldynamic__tabs-container--with-header",tabsRoot:"sd-tabs-toolbar",tabsLeft:"sd-tabs-toolbar--left",tabsRight:"sd-tabs-toolbar--right",tabsCenter:"sd-tabs-toolbar--center",tabs:{item:"sd-tab-item",itemPressed:"sd-tab-item--pressed",itemAsIcon:"sd-tab-item--icon",itemIcon:"sd-tab-item__icon",itemTitle:"sd-tab-item__title"}},progress:"sd-progress sd-body__progress",progressTop:"sd-body__progress--top",progressBottom:"sd-body__progress--bottom",progressBar:"sd-progress__bar",progressText:"sd-progress__text",progressButtonsRoot:"sd-progress-buttons",progressButtonsNumbered:"sd-progress-buttons--numbered",progressButtonsFitSurveyWidth:"sd-progress-buttons--fit-survey-width",progressButtonsContainerCenter:"sd-progress-buttons__container-center",progressButtonsContainer:"sd-progress-buttons__container",progressButtonsConnector:"sd-progress-buttons__connector",progressButtonsButton:"sd-progress-buttons__button",progressButtonsButtonBackground:"sd-progress-buttons__button-background",progressButtonsButtonContent:"sd-progress-buttons__button-content",progressButtonsHeader:"sd-progress-buttons__header",progressButtonsFooter:"sd-progress-buttons__footer",progressButtonsImageButtonLeft:"sd-progress-buttons__image-button-left",progressButtonsImageButtonRight:"sd-progress-buttons__image-button-right",progressButtonsImageButtonHidden:"sd-progress-buttons__image-button--hidden",progressButtonsListContainer:"sd-progress-buttons__list-container",progressButtonsList:"sd-progress-buttons__list",progressButtonsListElementPassed:"sd-progress-buttons__list-element--passed",progressButtonsListElementCurrent:"sd-progress-buttons__list-element--current",progressButtonsListElementNonClickable:"sd-progress-buttons__list-element--nonclickable",progressButtonsPageTitle:"sd-progress-buttons__page-title",progressButtonsPageDescription:"sd-progress-buttons__page-description",progressTextInBar:"sd-hidden",page:{root:"sd-page sd-body__page",emptyHeaderRoot:"sd-page__empty-header",title:"sd-title sd-page__title",description:"sd-description sd-page__description",number:"sd-page__num",errorsContainer:"sd-page__errbox"},pageTitle:"sd-title sd-page__title",pageDescription:"sd-description sd-page__description",row:"sd-row sd-clearfix",rowMultiple:"sd-row--multiple",rowCompact:"sd-row--compact",rowEnter:"sd-row--enter",rowDelayedEnter:"sd-row--delayed-enter",rowLeave:"sd-row--leave",rowReplace:"sd-row--replace",pageRow:"sd-page__row",question:{contentEnter:"sd-element__content--enter",contentLeave:"sd-element__content--leave",enter:"sd-element-wrapper--enter",leave:"sd-element-wrapper--leave",mobile:"sd-question--mobile",mainRoot:"sd-element sd-question sd-row__question",flowRoot:"sd-element sd-question sd-row__question sd-row__question--flow",withFrame:"sd-element--with-frame",asCell:"sd-table__cell",answered:"sd-question--answered",header:"sd-question__header sd-element__header",headerLeft:"sd-question__header--location--left",headerTop:"sd-question__header--location-top sd-element__header--location-top",headerBottom:"sd-question__header--location--bottom",content:"sd-element__content sd-question__content",contentSupportContainerQueries:"sd-question__content--support-container-queries",contentLeft:"sd-question__content--left",titleNumInline:"sd-element__title--num-inline",titleLeftRoot:"sd-question--left",titleTopRoot:"sd-question--title-top",descriptionUnderInputRoot:"sd-question--description-under-input",titleBottomRoot:"sd-question--title-bottom",titleOnAnswer:"sd-question__title--answer",titleEmpty:"sd-question__title--empty",titleOnError:"sd-question__title--error",title:"sd-title sd-element__title sd-question__title",titleExpandable:"sd-element__title--expandable",titleExpandableSvg:"sd-element__title-expandable-svg",titleExpanded:"sd-element__title--expanded",titleCollapsed:"sd-element__title--collapsed",titleDisabled:"sd-element__title--disabled",titleReadOnly:"sd-element__title--readonly",titleBar:"sd-action-title-bar",requiredMark:"sd-question__required-text",number:"sd-element__num",description:"sd-description sd-question__description",descriptionUnderInput:"sd-question__description--under-input",comment:"sd-input sd-comment",required:"sd-question--required",titleRequired:"sd-question__title--required",indent:20,footer:"sd-question__footer",commentArea:"sd-question__comment-area",formGroup:"sd-question__form-group",hasError:"sd-question--error",hasErrorTop:"sd-question--error-top",hasErrorBottom:"sd-question--error-bottom",collapsed:"sd-element--collapsed",expandable:"sd-element--expandable",expandableAnimating:"sd-elemenet--expandable--animating",expanded:"sd-element--expanded",nested:"sd-element--nested",invisible:"sd-element--invisible",composite:"sd-element--complex sd-composite",disabled:"sd-question--disabled",readOnly:"sd-question--readonly",preview:"sd-question--preview",noPointerEventsMode:"sd-question--no-pointer-events",errorsContainer:"sd-element__erbox sd-question__erbox",errorsContainerTop:"sd-element__erbox--above-element sd-question__erbox--above-question",errorsContainerBottom:"sd-question__erbox--below-question",confirmDialog:"sd-popup--confirm sv-popup--confirm",singleInputTitle:"sd-element__title--singleinput",singleInputWrapper:"sd-question__singleinput-wrapper",breadcrumbsRoot:"sd-breadcrumbs",breadcrumbsItem:"sd-breadcrumbs-item",breadcrumbsItemButton:"sd-breadcrumbs-item__button",breadcrumbsSeparator:"sd-breadcrumbs-separator",summary:"sd-summary",summaryRow:"sd-summary-row",summaryRowContent:"sd-summary-row__content",summaryRowActions:"sd-summary-row__actions",summaryRowAction:"sd-summary-row-action",summaryRowActionEdit:"sd-summary-row-action sd-summary-row-action--edit",summaryRowActionDelete:"sd-summary-row-action sd-summary-row-action--delete"},image:{mainRoot:"sd-element sd-question sd-question--image",root:"sd-image",image:"sd-image__image",adaptive:"sd-image__image--adaptive",noImage:"sd-image__no-image",noImageSvgIconId:"icon-no-image",withFrame:""},html:{mainRoot:"sd-element sd-question sd-row__question sd-question--html",root:"sd-html",withFrame:"",nested:"sd-element--nested sd-html--nested"},error:{root:"sd-error",warningMode:"sd-error--warning",infoMode:"sd-error--info",icon:"",item:"sd-error__item",locationTop:"",locationBottom:""},checkbox:{root:"sd-selectbase",rootMobile:"sd-selectbase--mobile",rootRow:"sd-selectbase--row",rootMultiColumn:"sd-selectbase--multi-column",item:"sd-item sd-checkbox sd-selectbase__item",itemEnter:"sd-item--enter",itemLeave:"sd-item--leave",itemOnError:"sd-item--error",itemSelectAll:"sd-checkbox--selectall",itemNone:"sd-checkbox--none",itemDisabled:"sd-item--disabled sd-checkbox--disabled",itemReadOnly:"sd-item--readonly sd-checkbox--readonly",itemPreview:"sd-item--preview sd-checkbox--preview",itemPreviewSvgIconId:"#icon-check-16x16",itemChecked:"sd-item--checked sd-checkbox--checked",itemHover:"sd-item--allowhover sd-checkbox--allowhover",itemInline:"sd-selectbase__item--inline",label:"sd-selectbase__label",labelChecked:"",itemControl:"sd-visuallyhidden sd-item__control sd-checkbox__control",itemDecorator:"sd-item__svg sd-checkbox__svg",itemSvgIconId:"#icon-check-16x16",controlLabel:"sd-item__control-label",materialDecorator:"sd-item__decorator sd-checkbox__decorator",otherArea:"sd-selectbase__other",column:"sd-selectbase__column"},radiogroup:{root:"sd-selectbase",rootMobile:"sd-selectbase--mobile",rootRow:"sd-selectbase--row",rootMultiColumn:"sd-selectbase--multi-column",item:"sd-item sd-radio sd-selectbase__item",itemOnError:"sd-item--error",itemInline:"sd-selectbase__item--inline",label:"sd-selectbase__label",labelChecked:"",itemEnter:"sd-item--enter",itemLeave:"sd-item--leave",itemDisabled:"sd-item--disabled sd-radio--disabled",itemReadOnly:"sd-item--readonly sd-radio--readonly",itemPreview:"sd-item--preview sd-radio--preview",itemPreviewSvgIconId:"#icon-check-16x16",itemChecked:"sd-item--checked sd-radio--checked",itemHover:"sd-item--allowhover sd-radio--allowhover",itemControl:"sd-visuallyhidden sd-item__control sd-radio__control",itemDecorator:"sd-item__svg sd-radio__svg",controlLabel:"sd-item__control-label",materialDecorator:"sd-item__decorator sd-radio__decorator",otherArea:"sd-selectbase__other",clearButton:"",column:"sd-selectbase__column"},boolean:{mainRoot:"sd-element sd-question sd-row__question sd-question--boolean",root:"sv_qcbc sv_qbln sd-scrollable-container sd-boolean-root",rootRadio:"sv_qcbc sv_qbln sd-scrollable-container sd-scrollable-container--compact",item:"sd-boolean",itemOnError:"sd-boolean--error",control:"sd-boolean__control sd-visuallyhidden",itemChecked:"sd-boolean--checked",itemExchanged:"sd-boolean--exchanged",itemIndeterminate:"sd-boolean--indeterminate",itemDisabled:"sd-boolean--disabled",itemReadOnly:"sd-boolean--readonly",itemPreview:"sd-boolean--preview",itemHover:"sd-boolean--allowhover",label:"sd-boolean__label",labelTrue:"sd-boolean__label--true",labelFalse:"sd-boolean__label--false",switch:"sd-boolean__switch",disabledLabel:"sd-checkbox__label--disabled",labelReadOnly:"sd-checkbox__label--readonly",labelPreview:"sd-checkbox__label--preview",sliderText:"sd-boolean__thumb-text",slider:"sd-boolean__thumb",sliderGhost:"sd-boolean__thumb-ghost",radioItem:"sd-item",radioItemChecked:"sd-item--checked sd-radio--checked",radioItemDisabled:"sd-item--disabled sd-radio--disabled",radioItemReadOnly:"sd-item--readonly sd-radio--readonly",radioItemPreview:"sd-item--preview sd-radio--preview",itemPreviewSvgIconId:"#icon-check-16x16",radioLabel:"sd-selectbase__label",radioControlLabel:"sd-item__control-label",radioFieldset:"sd-selectbase",itemRadioDecorator:"sd-item__svg sd-radio__svg",materialRadioDecorator:"sd-item__decorator sd-radio__decorator",itemRadioControl:"sd-visuallyhidden sd-item__control sd-radio__control",rootCheckbox:"sd-selectbase",checkboxItem:"sd-item sd-selectbase__item sd-checkbox",checkboxLabel:"sd-selectbase__label",checkboxItemOnError:"sd-item--error",checkboxItemIndeterminate:"sd-checkbox--intermediate",checkboxItemChecked:"sd-item--checked sd-checkbox--checked",checkboxItemDecorator:"sd-item__svg sd-checkbox__svg",checkboxItemDisabled:"sd-item--disabled sd-checkbox--disabled",checkboxItemReadOnly:"sd-item--readonly sd-checkbox--readonly",checkboxItemPreview:"sd-item--preview sd-checkbox--preview",controlCheckbox:"sd-visuallyhidden sd-item__control sd-checkbox__control",checkboxMaterialDecorator:"sd-item__decorator sd-checkbox__decorator",checkboxControlLabel:"sd-item__control-label",checkboxIsLabelRendered:"sd-checkbox--label-rendered",svgIconCheckedId:"#icon-check-16x16"},text:{root:"sd-input sd-text",small:"sd-row__question--small",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",constrolWithCharacterCounter:"sd-text__character-counter",characterCounterBig:"sd-text__character-counter--big",content:"sd-text__content sd-question__content",remainingCharacterCounter:"sd-remaining-character-counter",onError:"sd-input--error"},multipletext:{root:"sd-multipletext",rootMobile:"sd-multipletext--mobile",itemLabel:"sd-multipletext__item-container sd-input",itemLabelReadOnly:"sd-input--readonly",itemLabelDisabled:"sd-input--disabled",itemLabelPreview:"sd-input--preview",itemLabelOnError:"sd-multipletext__item-container--error",itemLabelAllowFocus:"sd-multipletext__item-container--allow-focus",itemLabelAnswered:"sd-multipletext__item-container--answered",itemWithCharacterCounter:"sd-multipletext-item__character-counter",item:"sd-multipletext__item",itemTitle:"sd-multipletext__item-title",content:"sd-multipletext__content sd-question__content",row:"sd-multipletext__row",cell:"sd-multipletext__cell",cellError:"sd-multipletext__cell--error",cellErrorTop:"sd-multipletext__cell--error-top",cellErrorBottom:"sd-multipletext__cell--error-bottom"},dropdown:{root:"sd-selectbase",popup:"sv-dropdown-popup",small:"sd-row__question--small",selectWrapper:"sv-dropdown_select-wrapper",onError:"sd-input--error",label:"sd-selectbase__label",itemEnter:"sd-item--enter",itemLeave:"sd-item--leave",item:"sd-item sd-radio sd-selectbase__item",itemDisabled:"sd-item--disabled sd-radio--disabled",itemChecked:"sd-item--checked sd-radio--checked",itemHover:"sd-item--allowhover sd-radio--allowhover",itemControl:"sd-visuallyhidden sd-item__control sd-radio__control",itemDecorator:"sd-item__svg sd-radio__svg",cleanButtonIconId:"icon-cancel",chevronButton:"sd-dropdown_chevron-button",chevronButtonSvg:"sd-dropdown_chevron-button-svg",chevronButtonIconId:"icon-chevron",control:"sd-input sd-dropdown",controlInputFieldComponent:"sd-dropdown__input-field-component",controlValue:"sd-dropdown__value",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",controlEmpty:"sd-dropdown--empty",controlLabel:"sd-item__control-label",filterStringInput:"sd-dropdown__filter-string-input",materialDecorator:"sd-item__decorator sd-radio__decorator",hintPrefix:"sd-dropdown__hint-prefix",hintSuffix:"sd-dropdown__hint-suffix"},imagepicker:{mainRoot:"sd-element sd-question sd-row__question",root:"sd-selectbase sd-imagepicker",rootResponsive:"sd-imagepicker--responsive",rootStatic:"sd-imagepicker--static",rootColumn:"sd-imagepicker--column",item:"sd-imagepicker__item",itemOnError:"sd-imagepicker__item--error",itemInline:"sd-imagepicker__item--inline",itemChecked:"sd-imagepicker__item--checked",itemDisabled:"sd-imagepicker__item--disabled",itemReadOnly:"sd-imagepicker__item--readonly",itemPreview:"sd-imagepicker__item--preview",itemHover:"sd-imagepicker__item--allowhover",label:"sd-imagepicker__label",itemDecorator:"sd-imagepicker__item-decorator",imageContainer:"sd-imagepicker__image-container",itemControl:"sd-imagepicker__control sd-visuallyhidden",image:"sd-imagepicker__image",itemText:"sd-imagepicker__text",itemNoImage:"sd-imagepicker__no-image",itemNoImageSvgIcon:"sd-imagepicker__no-image-svg",itemNoImageSvgIconId:"icon-no-image",column:"sd-selectbase__column sd-imagepicker__column",checkedItemDecorator:"sd-imagepicker__check-decorator",checkedItemSvgIcon:"sd-imagepicker__check-icon",checkedItemSvgIconId:"icon-check-24x24"},matrix:{mainRoot:"sd-element sd-question sd-row__question sd-element--complex sd-question--complex sd-question--table",tableWrapper:"sd-matrix sd-table-wrapper",root:"sd-table sd-matrix__table",columnsAutoWidth:"sd-table--columnsautowidth",noHeader:"sd-table--no-header",rootVerticalAlignTop:"sd-table--align-top",rootVerticalAlignMiddle:"sd-table--align-middle",rootAlternateRows:"sd-table--alternate-rows",rowError:"sd-matrix__row--error",cell:"sd-table__cell sd-matrix__cell",row:"sd-table__row",rowDisabled:"sd-table__row-disabled",rowReadOnly:"sd-table__row-readonly",headerCell:"sd-table__cell sd-table__cell--header",rowTextCell:"sd-table__cell sd-matrix__cell sd-table__cell--row-text",label:"sd-item sd-{type} sd-matrix__label",itemOnError:"sd-item--error",itemValue:"sd-visuallyhidden sd-item__control sd-{type}__control",itemChecked:"sd-item--checked sd-{type}--checked",itemDisabled:"sd-item--disabled sd-{type}--disabled",itemReadOnly:"sd-item--readonly sd-{type}--readonly",itemPreview:"sd-item--preview sd-{type}--preview",itemPreviewSvgIconId:"#icon-check-16x16",itemHover:"sd-{type}--allowhover",materialDecorator:"sd-item__decorator sd-{type}__decorator",itemDecorator:"sd-item__svg sd-{type}__svg",cellText:"sd-matrix__text",cellTextSelected:"sd-matrix__text--checked",cellTextDisabled:"sd-matrix__text--disabled",cellResponsiveTitle:"sd-matrix__responsive-title",compact:"sd-element--with-frame sd-element--compact"},matrixdropdown:{mainRoot:"sd-element sd-question sd-row__question sd-element--complex sd-question--complex sd-question--table",rootScroll:"sd-question--scroll",root:"sd-table sd-matrixdropdown",columnsAutoWidth:"sd-table--columnsautowidth",noHeader:"sd-table--no-header",hasFooter:"sd-table--has-footer",rootVerticalAlignTop:"sd-table--align-top",rootVerticalAlignMiddle:"sd-table--align-middle",tableWrapper:"sd-table-wrapper",rootAlternateRows:"sd-table--alternate-rows",cell:"sd-table__cell",cellResponsiveTitle:"sd-table__responsive-title",errorsCell:"sd-table__cell--error",errorsCellTop:"sd-table__cell--error-top",errorsCellBottom:"sd-table__cell--error-bottom",itemCell:"sd-table__cell--item",row:"sd-table__row",rowDelayedEnter:"sd-table__row--delayed-enter",rowEnter:"sd-table__row--enter",rowLeave:"sd-table__row--leave",expandedRow:"sd-table__row--expanded",rowHasPanel:"sd-table__row--has-panel",rowHasEndActions:"sd-table__row--has-end-actions",headerCell:"sd-table__cell sd-table__cell--header",rowTextCell:"sd-table__cell sd-table__cell--row-text",footerCell:"sd-table__cell sd-table__cell--footer",footerTotalCell:"sd-table__cell sd-table__cell--footer-total",columnTitleCell:"sd-table__cell--column-title",cellRequiredMark:"sd-question__required-text",detailButton:"sd-table__cell--detail-button",detailButtonExpanded:"sd-table__cell--detail-button--expanded",detailIcon:"sd-detail-panel__icon",detailIconExpanded:"sd-detail-panel__icon--expanded",detailIconId:"icon-expanddetail",detailIconExpandedId:"icon-collapsedetail",detailPanelCell:"sd-table__cell--detail-panel",detailRowCell:"sd-table__cell--detail",actionsCellPrefix:"sd-table__cell-action",actionsCell:"sd-table__cell sd-table__cell--actions",actionsCellDrag:"sd-table__cell--drag",emptyCell:"sd-table__cell--empty",verticalCell:"sd-table__cell--vertical",cellQuestionWrapper:"sd-matrix__question-wrapper sd-table__question-wrapper",compact:"sd-element--with-frame sd-element--compact"},matrixdynamic:{mainRoot:"sd-element sd-question sd-row__question sd-element--complex sd-question--complex sd-question--table",rootScroll:"sd-question--scroll",empty:"sd-question--empty",root:"sd-table sd-matrixdynamic",columnsAutoWidth:"sd-table--columnsautowidth",noHeader:"sd-table--no-header",hasFooter:"sd-table--has-footer",tableWrapper:"sd-table-wrapper",rootAlternateRows:"sd-table--alternate-rows",content:"sd-matrixdynamic__content sd-question__content",cell:"sd-table__cell",cellResponsiveTitle:"sd-table__responsive-title",row:"sd-table__row",rowEmpty:"sd-table__row--empty",rowDelayedEnter:"sd-table__row--delayed-enter",rowEnter:"sd-table__row--enter",rowLeave:"sd-table__row--leave",rowHasPanel:"sd-table__row--has-panel",rowHasEndActions:"sd-table__row--has-end-actions",expandedRow:"sd-table__row--expanded",itemCell:"sd-table__cell--item",headerCell:"sd-table__cell sd-table__cell--header",rowTextCell:"sd-table__cell sd-table__cell--row-text",footerCell:"sd-table__cell sd-table__cell--footer",columnTitleCell:"sd-table__cell--column-title",cellRequiredMark:"sd-question__required-text",button:"sd-action sd-matrixdynamic__btn",detailRow:"sd-table__row sd-table__row--detail",detailButton:"sd-table__cell--detail-button",detailButtonExpanded:"sd-table__cell--detail-button--expanded",detailIcon:"sd-detail-panel__icon",detailIconExpanded:"sd-detail-panel__icon--expanded",detailIconId:"icon-expanddetail",detailIconExpandedId:"icon-collapsedetail",detailPanelCell:"sd-table__cell--detail-panel",detailRowCell:"sd-table__cell--detail",actionsCellPrefix:"sd-table__cell-action",actionsCell:"sd-table__cell sd-table__cell--actions",actionsCellDrag:"sd-table__cell--drag",buttonAdd:"sd-matrixdynamic__add-btn",buttonRemove:"sd-action--negative sd-matrixdynamic__remove-btn",iconAdd:"sd-hidden",iconRemove:"",dragElementDecorator:"sd-drag-element__svg",iconDragElement:"#icon-drag-24x24",footer:"sd-matrixdynamic__footer",footerTotalCell:"sd-table__cell sd-table__cell--footer-total",noRowsSection:"sd-matrixdynamic__placeholder sd-question__placeholder",iconDrag:"sv-matrixdynamic__drag-icon",ghostRow:"sv-matrix-row--drag-drop-ghost-mod",draggedRow:"sv-matrixdynamic-dragged-row",emptyCell:"sd-table__cell--empty",verticalCell:"sd-table__cell--vertical",cellQuestionWrapper:"sd-matrix__question-wrapper sd-table__question-wrapper",errorsCell:"sd-table__cell--error",errorsCellTop:"sd-table__cell--error-top",errorsCellBottom:"sd-table__cell--error-bottom",compact:"sd-element--with-frame sd-element--compact"},rating:{rootDropdown:"sd-scrollable-container sd-scrollable-container--compact sd-selectbase",root:"sd-scrollable-container sd-rating",rootWrappable:"sd-rating--wrappable",rootLabelsTop:"sd-rating--labels-top",rootLabelsBottom:"sd-rating--labels-bottom",rootLabelsDiagonal:"sd-rating--labels-diagonal",item:"sd-rating__item",itemOnError:"sd-rating__item--error",itemHover:"sd-rating__item--allowhover",selected:"sd-rating__item--selected",itemStar:"sd-rating__item-star",itemStarOnError:"sd-rating__item-star--error",itemStarHover:"sd-rating__item-star--allowhover",itemStarSelected:"sd-rating__item-star--selected",itemStarDisabled:"sd-rating__item-star--disabled",itemStarReadOnly:"sd-rating__item-star--readonly",itemStarPreview:"sd-rating__item-star--preview",itemStarHighlighted:"sd-rating__item-star--highlighted",itemStarUnhighlighted:"sd-rating__item-star--unhighlighted",itemStarSmall:"sd-rating__item-star--small",itemSmiley:"sd-rating__item-smiley",itemSmileyOnError:"sd-rating__item-smiley--error",itemSmileyHover:"sd-rating__item-smiley--allowhover",itemSmileySelected:"sd-rating__item-smiley--selected",itemSmileyDisabled:"sd-rating__item-smiley--disabled",itemSmileyReadOnly:"sd-rating__item-smiley--readonly",itemSmileyPreview:"sd-rating__item-smiley--preview",itemSmileyHighlighted:"sd-rating__item-star--highlighted",itemSmileyScaleColored:"sd-rating__item-smiley--scale-colored",itemSmileyRateColored:"sd-rating__item-smiley--rate-colored",itemSmileySmall:"sd-rating__item-smiley--small",minText:"sd-rating__item-text sd-rating__min-text",itemText:"sd-rating__item-text",maxText:"sd-rating__item-text sd-rating__max-text",itemDisabled:"sd-rating__item--disabled",itemReadOnly:"sd-rating__item--readonly",itemPreview:"sd-rating__item--preview",itemFixedSize:"sd-rating__item--fixed-size",control:"sd-input sd-dropdown",itemSmall:"sd-rating--small",selectWrapper:"sv-dropdown_select-wrapper",controlValue:"sd-dropdown__value",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",controlEmpty:"sd-dropdown--empty",filterStringInput:"sd-dropdown__filter-string-input",chevronButtonIconId:"icon-chevron",popup:"sv-dropdown-popup",onError:"sd-input--error"},slider:{root:"sd-slider",rootSingleMode:"sd-slider--single",rootNegativeScaleMode:"sd-slider--negative-scale-mode",rootDesignMode:"sd-slider--design-mode",rootAnimatedThumbMode:"sd-slider--animated-thumb-mode",rootTooltipsAlwaysMode:"sd-slider--tooltips-always-mode",rootLabelsShowValueTextMode:"sd-slider--labels-show-value-text-mode",visualContainer:"sd-slider-container",visualContainerSlider:"sd-slider-container__slider",rangeTrack:"sd-slider__track sd-slider__range-track",inverseTrackLeft:"sd-slider__track sd-slider__inverse-track sd-slider__inverse-track--left",inverseTrackRight:"sd-slider__track sd-slider__inverse-track sd-slider__inverse-track--right",thumbContainer:"sd-slider__thumb-container",thumbContainerIndeterminateMode:"sd-slider__thumb-container--indeterminate",thumbContainerFocusedMode:"sd-slider__thumb-container--focused",thumb:"sd-slider__thumb",thumbDot:"sd-slider__thumb-dot",tooltip:"sd-slider__tooltip",tooltipPanel:"sd-slider__tooltip-panel",tooltipOnHoverMode:"sd-slider__tooltip--on-hover",tooltipValue:"sd-slider__tooltip-value",input:"sd-slider__input",labelsContainer:"sd-slider-labels-container",label:"sd-slider__label",labelLongMod:"sd-slider__label--long",labelTick:"sd-slider__label-tick",labelTextContainer:"sd-slider__label-text-container",labelText:"sd-slider__label-text",labelTextSecondaryMode:"sd-slider__label-text sd-slider__label-text--secondary",clearButton:""},comment:{root:"sd-input sd-comment",small:"sd-row__question--small",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",content:"sd-comment__content sd-question__content",remainingCharacterCounter:"sd-remaining-character-counter",onError:"sd-input--error"},expression:"sd-expression",file:{root:"sd-file",rootDragging:"sd-file--dragging",rootAnswered:"sd-file--answered",rootDisabled:"sd-file--disabled",rootReadOnly:"sd-file--readonly",rootPreview:"sd-file--preview",placeholderInput:"sd-visuallyhidden",previewItem:"sd-file__preview-item",fileSign:"",fileList:"sd-file__list",fileSignBottom:"sd-file__sign",dragArea:"sd-file__drag-area",dragAreaActive:"sd-file__drag-area--active",fileDecorator:"sd-file__decorator",onError:"sd-file__decorator--error",fileDecoratorDrag:"sd-file__decorator--drag",fileInput:"sd-visuallyhidden",chooseFile:"sd-file__choose-btn",chooseFileAsText:"sd-action sd-file__choose-btn--text",chooseFileAsTextDisabled:"sd-action--disabled",chooseFileAsIcon:"sd-file__choose-btn--icon",chooseFileIconId:"icon-choosefile",disabled:"sd-file__choose-btn--disabled",controlDisabled:"sd-file__choose-file-btn--disabled",removeButton:"sd-context-btn--negative",removeButtonBottom:"",removeButtonIconId:"icon-clear",removeFile:"sd-hidden",removeFileSvg:"",removeFileSvgIconId:"icon-close_16x16",wrapper:"sd-file__wrapper",defaultImage:"sd-file__default-image",defaultImageIconId:"icon-defaultfile",leftIconId:"icon-arrowleft",rightIconId:"icon-arrowright",removeFileButton:"sd-context-btn--small sd-context-btn--with-border sd-context-btn--colorful sd-context-btn--negative sd-file__remove-file-button",dragAreaPlaceholder:"sd-file__drag-area-placeholder",imageWrapper:"sd-file__image-wrapper",imageWrapperDefaultImage:"sd-file__image-wrapper--default-image",single:"sd-file--single",singleImage:"sd-file--single-image",mobile:"sd-file--mobile",videoContainer:"sd-file__video-container",contextButton:"sd-context-btn",video:"sd-file__video",actionsContainer:"sd-file__actions-container",closeCameraButton:"sd-file__close-camera-button",changeCameraButton:"sd-file__change-camera-button",takePictureButton:"sd-file__take-picture-button",loadingIndicator:"sd-file__loading-indicator",page:"sd-file__page"},signaturepad:{mainRoot:"sd-element sd-question sd-question--signature sd-row__question",root:"sd-signaturepad sjs_sp_container",small:"sd-row__question--small",controls:"sjs_sp_controls sd-signaturepad__controls",placeholder:"sjs_sp_placeholder",canvas:"sjs_sp_canvas sd-signaturepad__canvas",backgroundImage:"sjs_sp__background-image sd-signaturepad__background-image",clearButton:"sjs_sp_clear sd-context-btn sd-context-btn--negative sd-signaturepad__clear",clearButtonIconId:"icon-clear",loadingIndicator:"sd-signaturepad__loading-indicator"},saveData:{root:"sv-save-data_root",rootWithButtons:"sv-save-data_root--with-buttons",info:"sv-save-data_info",error:"sv-save-data_error",success:"sv-save-data_success",button:"sv-save-data_button",shown:"sv-save-data_root--shown"},window:{root:"sv_window",rootCollapsedMod:"sv_window--collapsed",rootFullScreenMode:"sv_window--full-screen",rootContent:"sv_window_root-content",body:"sv_window_content",header:{root:"sv_window_header",titleCollapsed:"sv_window_header_title_collapsed",buttonsContainer:"sv_window_buttons_container",button:"sv_window_button",buttonExpanded:"",buttonCollapsed:"",collapseButton:"sv_window_button sv_window_button_collapse",closeButton:"sv_window_button sv_window_button_close",fullScreenButton:"sv_window_button sv_window_button_full_screen"}},ranking:{root:"sv-ranking",rootMobileMod:"sv-ranking--mobile",rootDragMod:"sv-ranking--drag",rootDisabled:"sd-ranking--disabled",rootReadOnly:"sd-ranking--readonly",rootPreview:"sd-ranking--preview",rootDesignMode:"sv-ranking--design-mode",rootDragHandleAreaIcon:"sv-ranking--drag-handle-area-icon",rootSelectToRankMod:"sv-ranking--select-to-rank",rootSelectToRankEmptyValueMod:"sv-ranking--select-to-rank-empty-value",rootSelectToRankAlignVertical:"sv-ranking--select-to-rank-vertical",rootSelectToRankAlignHorizontal:"sv-ranking--select-to-rank-horizontal",rootSelectToRankSwapAreas:"sv-ranking--select-to-rank-swap-areas",item:"sv-ranking-item",itemContent:"sv-ranking-item__content sd-ranking-item__content",itemIndex:"sv-ranking-item__index sd-ranking-item__index",itemIndexEmptyMode:"sv-ranking-item__index--empty sd-ranking-item__index--empty",itemDisabled:"sv-ranking-item--disabled",itemReadOnly:"sv-ranking-item--readonly",itemPreview:"sv-ranking-item--preview",controlLabel:"sv-ranking-item__text",itemGhostNode:"sv-ranking-item__ghost",itemIconContainer:"sv-ranking-item__icon-container",itemIcon:"sv-ranking-item__icon",itemIconHoverMod:"sv-ranking-item__icon--hover",itemIconFocusMod:"sv-ranking-item__icon--focus",itemGhostMod:"sv-ranking-item--ghost",itemDragMod:"sv-ranking--drag",itemOnError:"sv-ranking-item--error",container:"sv-ranking__container",containerEmptyMode:"sv-ranking__container--empty",containerFromMode:"sv-ranking__container--from",containerToMode:"sv-ranking__container--to",containerPlaceholder:"sv-ranking__container-placeholder",containersDivider:"sv-ranking__containers-divider"},buttongroup:{root:"sd-button-group-scrollable-container sv-button-group",item:"sv-button-group__item",itemIcon:"sv-button-group__item-icon",itemDecorator:"sv-button-group__item-decorator",itemCaption:"sv-button-group__item-caption",itemHover:"sv-button-group__item--hover",itemSelected:"sv-button-group__item--selected",itemDisabled:"sv-button-group__item--disabled",itemControl:"sv-visuallyhidden",rootDropdown:"sd-button-group-scrollable-container sd-scrollable-container--compact sd-selectbase",selectWrapper:"sv-dropdown_select-wrapper",control:"sd-input sd-dropdown",controlEmpty:"sd-dropdown--empty",controlValue:"sd-dropdown__value",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",controlLabel:"sd-item__control-label",filterStringInput:"sd-dropdown__filter-string-input",chevronButtonIconId:"icon-chevron",popup:"sv-dropdown-popup",cleanButtonIconId:"icon-cancel",hintPrefix:"sd-dropdown__hint-prefix",hintSuffix:"sd-dropdown__hint-suffix"},list:{root:"sv-list__container sd-list",item:"sv-list__item sd-list__item",itemBody:"sv-list__item-body sd-list__item-body",itemSelected:"sv-list__item--selected sd-list__item--selected",itemFocused:"sv-list__item--focused sd-list__item--focused",itemHovered:"sv-list__item--hovered sd-list__item--hovered"},actionBar:{root:"sd-action-bar",item:"sd-action",defaultSizeMode:"",smallSizeMode:"",itemPressed:"sd-action--pressed",itemAsIcon:"sd-action--icon",itemIcon:"sd-action__icon",itemTitle:"sd-action__title"},variables:{mobileWidth:"--sd-mobile-width",themeMark:"--sv-defaultV2-mark"},tagbox:{root:"sd-selectbase",popup:"sv-dropdown-popup",small:"sd-row__question--small",selectWrapper:"sv-dropdown_select-wrapper",onError:"sd-input--error",label:"sd-selectbase__label",itemSvgIconId:"#icon-check-16x16",item:"sd-item sd-checkbox sd-selectbase__item",itemDisabled:"sd-item--disabled sd-checkbox--disabled",itemChecked:"sd-item--checked sd-checkbox--checked",itemHover:"sd-item--allowhover sd-checkbox--allowhover",itemControl:"sd-visuallyhidden sd-item__control sd-checkbox__control",itemDecorator:"sd-item__svg sd-checkbox__svg",itemEnter:"sd-item--enter",itemLeave:"sd-item--leave",cleanButtonIconId:"icon-cancel-24x24",cleanItemButton:"sd-tagbox-item_clean-button",cleanItemButtonSvg:"sd-tagbox-item_clean-button-svg",cleanItemButtonIconId:"icon-clear_16x16",chevronButtonIconId:"icon-chevron",control:"sd-input sd-tagbox sd-dropdown",controlValue:"sd-tagbox__value sd-dropdown__value",controlValueItems:"sd-tagbox__value-items",placeholderInput:"sd-tagbox__placeholder",controlEditable:"sd-input--editable",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",controlEmpty:"sd-dropdown--empty sd-tagbox--empty",controlLabel:"sd-item__control-label",filterStringInput:"sd-tagbox__filter-string-input sd-dropdown__filter-string-input",materialDecorator:"sd-item__decorator sd-checkbox__decorator",hint:"sd-tagbox__hint",hintPrefix:"sd-dropdown__hint-prefix sd-tagbox__hint-prefix",hintSuffix:"sd-dropdown__hint-suffix sd-tagbox__hint-suffix",hintSuffixWrapper:"sd-tagbox__hint-suffix-wrapper"}};const UP="default";xr[UP]=eh;var Ei={setTimeout:n=>Ei.safeTimeOut(n,1e3),clearTimeout:n=>{clearTimeout(n)},safeTimeOut:(n,e)=>e<=0?(n(),0):setTimeout(n,e),now(){return Date.now()}};let th=class Ea{constructor(){this.listenerCounter=0,this.timerId=-1,this.onTimerTick=new Zt,this.onTimer=this.onTimerTick}static get instance(){return Ea.instanceValue||(Ea.instanceValue=new Ea),Ea.instanceValue}start(e=null){e&&this.onTimerTick.add(e),this.prevTimeInMs=Ei.now(),this.timerId<0&&(this.timerId=Ei.setTimeout(()=>{this.doTimer()})),this.listenerCounter++}stop(e=null){e&&this.onTimerTick.remove(e),this.listenerCounter--,this.listenerCounter==0&&this.timerId>-1&&(Ei.clearTimeout(this.timerId),this.timerId=-1)}doTimer(){if((this.onTimerTick.isEmpty||this.listenerCounter==0)&&(this.timerId=-1),this.timerId<0)return;const e=Ei.now();let t=Math.floor((e-this.prevTimeInMs)/1e3);this.prevTimeInMs=e,t<0&&(t=1);const s=this.timerId;this.onTimerTick.fire(this,{seconds:t}),s===this.timerId&&(this.timerId=Ei.setTimeout(()=>{this.doTimer()}))}};th.instanceValue=null;let Vr=class extends Te{constructor(e){super(),this.timerFunc=null,this.surveyValue=e,this.onCreating()}get survey(){return this.surveyValue}onCreating(){}start(){this.survey&&(this.isRunning||this.isDesignMode||(this.survey.onCurrentPageChanged.add(()=>{this.update()}),this.timerFunc=(e,t)=>{this.doTimer(t.seconds)},this.setIsRunning(!0),this.update(),th.instance.start(this.timerFunc)))}stop(){this.isRunning&&(this.setIsRunning(!1),th.instance.stop(this.timerFunc))}get isRunning(){return this.getPropertyValue("isRunning",!1)}setIsRunning(e){this.setPropertyValue("isRunning",e)}update(){this.updateText(),this.updateProgress()}doTimer(e){var t=this.survey.currentPage;if(t){const s=t.getMaxTimeToFinish();s>0&&s<t.timeSpent+e&&(e=s-t.timeSpent),t.timeSpent=t.timeSpent+e}this.spent=this.spent+e,this.update(),this.onTimerTick&&this.onTimerTick(t)}updateProgress(){let{spent:e,limit:t}=this.survey.timerInfo;t?(e==0?(this.progress=0,setTimeout(()=>{this.progress=Math.floor((e+1)/t*100)/100},0)):e<=t&&(this.progress=Math.floor((e+1)/t*100)/100),this.progress>1&&(this.progress=void 0)):this.progress=void 0}updateText(){let e=this.survey.timerClock;this.clockMajorText=e.majorText,this.clockMinorText=e.minorText,this.text=this.survey.timerInfoText}get showProgress(){return this.progress!==void 0}get showTimerAsClock(){return!!this.survey.getCss().clockTimerRoot}get rootCss(){return new z().append(this.survey.getCss().clockTimerRoot).append(this.survey.getCss().clockTimerRootTop,this.survey.isTimerPanelShowingOnTop).append(this.survey.getCss().clockTimerRootBottom,this.survey.isTimerPanelShowingOnBottom).toString()}getProgressCss(){return new z().append(this.survey.getCss().clockTimerProgress).append(this.survey.getCss().clockTimerProgressAnimation,this.progress>0).toString()}get textContainerCss(){return this.survey.getCss().clockTimerTextContainer}get minorTextCss(){return this.survey.getCss().clockTimerMinorText}get majorTextCss(){return this.survey.getCss().clockTimerMajorText}};S([E()],Vr.prototype,"text",void 0),S([E()],Vr.prototype,"progress",void 0),S([E()],Vr.prototype,"clockMajorText",void 0),S([E()],Vr.prototype,"clockMinorText",void 0),S([E({defaultValue:0})],Vr.prototype,"spent",void 0);let nn=class extends Te{constructor(e){super(),this.cssClasses=e,this.timeout=A.notifications.lifetime,this.timer=void 0,this.actionsVisibility={},this.showActions=!0,this.actionBar=new _t,this.actionBar.setCssClasses({root:_s.root,defaultSizeMode:_s.defaultSizeMode,smallSizeMode:_s.smallSizeMode},!1),this.css=this.cssClasses.root}getCssClass(e){return new z().append(this.cssClasses.root).append(this.cssClasses.rootWithButtons,this.actionBar.getVisibleActions().length>0).append(this.cssClasses.info,e!=="error"&&e!=="success").append(this.cssClasses.error,e==="error").append(this.cssClasses.success,e==="success").append(this.cssClasses.shown,this.active).toString()}updateActionsVisibility(e){this.actionBar.actions.forEach(t=>t.visible=this.showActions&&this.actionsVisibility[t.id]===e)}notify(e,t="info",s=!1){this.isDisplayed=!0,setTimeout(()=>{this.updateActionsVisibility(t),this.message=e,this.active=!0,this.css=this.getCssClass(t),this.timer&&(clearTimeout(this.timer),this.timer=void 0),s||(this.timer=setTimeout(()=>{this.timer=void 0,this.active=!1,this.css=this.getCssClass(t)},this.timeout))},1)}addAction(e,t){e.visible=!1,e.innerCss=this.cssClasses.button;const s=this.actionBar.addAction(e);this.actionsVisibility[s.id]=t}};S([E({defaultValue:!1})],nn.prototype,"active",void 0),S([E({defaultValue:!1})],nn.prototype,"isDisplayed",void 0),S([E()],nn.prototype,"message",void 0),S([E()],nn.prototype,"css",void 0);let Hy=class Ra{calcRow(e){return e==="top"?1:e==="middle"?2:3}calcColumn(e){return e==="left"?1:e==="center"?2:3}calcAlignItems(e){return e==="left"?"flex-start":e==="center"?"center":"flex-end"}calcAlignText(e){return e==="left"?"start":e==="center"?"center":"end"}calcJustifyContent(e){return e==="top"?"flex-start":e==="middle"?"center":"flex-end"}calcGridRow(){const e=this.calcRow(this.positionY);if(this.cover.renderedHeight)return e;const t=this.cover.getVisibleRows(),s=t.indexOf(e);if(s===-1)return 0;const i=t.length;return i===3?e:i===1?1:s+1}constructor(e,t,s){this.cover=e,this.positionX=t,this.positionY=s}get survey(){return this.cover.survey}get css(){return new z().append(Ra.CLASSNAME).append(`${Ra.CLASSNAME}--${this.positionX}`).append(`${Ra.CLASSNAME}--${this.positionY}`).append(Ra.CLASSNAME+"--empty",this.isEmpty).toString()}get style(){const e=this.calcGridRow(),t={};return t.gridRow=e,t.gridColumn=e!==0?this.calcColumn(this.positionX):0,t.width=this.width?this.width+"px":void 0,e===0&&(t.display="none"),t}get contentStyle(){const e={};return e.textAlign=this.calcAlignText(this.positionX),e.alignItems=this.calcAlignItems(this.positionX),e.justifyContent=this.calcJustifyContent(this.positionY),e.maxWidth=this.contentMaxWidth,e}get showLogo(){return this.survey.hasLogo&&this.positionX===this.cover.logoPositionX&&this.positionY===this.cover.logoPositionY}get showTitle(){return this.survey.hasTitle&&this.positionX===this.cover.titlePositionX&&this.positionY===this.cover.titlePositionY}get showDescription(){return this.survey.renderedHasDescription&&this.positionX===this.cover.descriptionPositionX&&this.positionY===this.cover.descriptionPositionY}get isEmpty(){return!this.showLogo&&!this.showTitle&&!this.showDescription}get textAreaWidth(){return this.cover.renderedTextAreaWidth}get width(){if(this.cover.width)return Math.ceil(this.cover.width/3)}get contentMaxWidth(){return this.cover.getContentMaxWidth(this)}};Hy.CLASSNAME="sv-header__cell";let $e=class extends Te{calcBackgroundSize(e){return e==="fill"?"100% 100%":e==="tile"?"auto":e}updateHeaderClasses(){const e=!this.backgroundColor||this.backgroundColor==="transparent",t=this.backgroundColor==="var(--sjs-primary-backcolor)",s=!e&&!t;this.headerClasses=new z().append("sv-header").append("sv-header--height-auto",!this.renderedHeight).append("sv-header__without-background",e&&!this.backgroundImage).append("sv-header__background-color--none",e&&!this.titleColor&&!this.descriptionColor).append("sv-header__background-color--accent",t&&!this.titleColor&&!this.descriptionColor).append("sv-header__background-color--custom",s&&!this.titleColor&&!this.descriptionColor).append("sv-header__overlap",this.overlapEnabled).toString()}updateContentClasses(){const e=!!this.survey&&this.survey.calculateWidthMode(),t=this.inheritWidthFrom==="survey"&&!!e&&e==="static";if(this.maxWidth=t?this.survey.width:void 0,this.maxWidth){const s=this.maxWidth.toString();s.indexOf("px")===-1&&s.indexOf("%")===-1&&(this.maxWidth=parseFloat(s)+"px")}this.contentClasses=new z().append("sv-header__content").append("sv-header__content--static",t).append("sv-header__content--responsive",this.inheritWidthFrom==="container"||!!e&&e==="responsive").toString()}updateBackgroundImageClasses(){this.backgroundImageClasses=new z().append("sv-header__background-image").append("sv-header__background-image--contain",this.backgroundImageFit==="contain").append("sv-header__background-image--tile",this.backgroundImageFit==="tile").toString()}fromTheme(e){super.fromJSON(e.header||{}),e.cssVariables&&(this.backgroundColor=e.cssVariables["--sjs-header-backcolor"],this.titleColor=e.cssVariables["--sjs-font-headertitle-color"],this.descriptionColor=e.cssVariables["--sjs-font-headerdescription-color"]),this.init()}init(){this.renderBackgroundImage=Qu(this.backgroundImage),this.updateHeaderClasses(),this.updateContentClasses(),this.updateBackgroundImageClasses()}constructor(){super(),this.cells=[],["top","middle","bottom"].forEach(e=>["left","center","right"].forEach(t=>this.cells.push(new Hy(this,t,e)))),this.init()}getType(){return"cover"}get renderedHeight(){if(this.survey&&!this.survey.isMobile||!this.survey)return this.height?this.height+"px":void 0;if(this.survey&&this.survey.isMobile)return this.mobileHeight?this.mobileHeight+"px":void 0}get renderedTextAreaWidth(){return this.textAreaWidth?this.textAreaWidth+"px":void 0}get isEmpty(){return!this.survey.hasLogo&&!this.survey.hasTitle&&!this.survey.renderedHasDescription}get survey(){return this._survey}set survey(e){this._survey!==e&&(this._survey=e,e&&(this.updateContentClasses(),this._survey.onPropertyChanged.add((t,s)=>{(s.name=="widthMode"||s.name=="width")&&this.updateContentClasses()})))}get backgroundImageStyle(){return this.backgroundImage?{opacity:this.backgroundImageOpacity,backgroundImage:this.renderBackgroundImage,backgroundSize:this.calcBackgroundSize(this.backgroundImageFit)}:null}propertyValueChanged(e,t,s,i,r){super.propertyValueChanged(e,t,s),(e==="height"||e==="backgroundColor"||e==="backgroundImage"||e==="overlapEnabled")&&this.updateHeaderClasses(),e==="inheritWidthFrom"&&this.updateContentClasses(),e==="backgroundImageFit"&&this.updateBackgroundImageClasses()}getVisibleRows(){const e=[];for(let t=0;t<3;t++){const s=t*3;(!this.cells[s].isEmpty||!this.cells[s+1].isEmpty||!this.cells[s+2].isEmpty)&&e.push(t+1)}return e.length!==0?e:[1,2,3]}getContentMaxWidth(e){if(e.isEmpty||e.showLogo)return;const t=this.cells.indexOf(e),s=Math.floor(t/3),i=t%3;if(i==1){if(!this.cells[s*3].isEmpty||!this.cells[s*3+2].isEmpty)return"100%"}else if(i==0){let r=0,a=i+1;for(;a<3&&this.cells[s*3+a].isEmpty;)this.cells[s*3+a].isEmpty&&r++,a++;return 100*(r+1)+"%"}else if(i==2){let r=0,a=i-1;for(;a>0&&this.cells[s*3+a].isEmpty;)this.cells[s*3+a].isEmpty&&r++,a--;return 100*(r+1)+"%"}}processResponsiveness(){if(this.survey&&this.survey.rootElement&&!this.survey.isMobile){const e=this.survey.rootElement.querySelectorAll(".sv-header__content")[0];if(!e)return;let t=e.getBoundingClientRect().width;const s=ge.getComputedStyle(e),i=parseFloat(s.paddingLeft)||0,r=parseFloat(s.paddingRight)||0,a=parseFloat(s.columnGap)||0;this.width=t-i-r-2*a}}get hasBackground(){return!!this.backgroundImage||this.backgroundColor!=="transparent"}};S([E()],$e.prototype,"height",void 0),S([E()],$e.prototype,"mobileHeight",void 0),S([E()],$e.prototype,"inheritWidthFrom",void 0),S([E()],$e.prototype,"textAreaWidth",void 0),S([E()],$e.prototype,"textGlowEnabled",void 0),S([E()],$e.prototype,"overlapEnabled",void 0),S([E({defaultValue:"transparent"})],$e.prototype,"backgroundColor",void 0),S([E()],$e.prototype,"titleColor",void 0),S([E()],$e.prototype,"descriptionColor",void 0),S([E({onSet:(n,e)=>{e.renderBackgroundImage=Qu(n)}})],$e.prototype,"backgroundImage",void 0),S([E()],$e.prototype,"renderBackgroundImage",void 0),S([E()],$e.prototype,"backgroundImageFit",void 0),S([E()],$e.prototype,"backgroundImageOpacity",void 0),S([E()],$e.prototype,"logoPositionX",void 0),S([E()],$e.prototype,"logoPositionY",void 0),S([E()],$e.prototype,"titlePositionX",void 0),S([E()],$e.prototype,"titlePositionY",void 0),S([E()],$e.prototype,"descriptionPositionX",void 0),S([E()],$e.prototype,"descriptionPositionY",void 0),S([E()],$e.prototype,"logoStyle",void 0),S([E()],$e.prototype,"titleStyle",void 0),S([E()],$e.prototype,"descriptionStyle",void 0),S([E()],$e.prototype,"headerClasses",void 0),S([E()],$e.prototype,"contentClasses",void 0),S([E()],$e.prototype,"width",void 0),S([E()],$e.prototype,"maxWidth",void 0),S([E()],$e.prototype,"backgroundImageClasses",void 0),q.addClass("cover",[{name:"height:number",minValue:0,default:0},{name:"mobileHeight:number",minValue:0,default:0},{name:"inheritWidthFrom",default:"survey"},{name:"textAreaWidth:number",minValue:0,default:0},{name:"textGlowEnabled:boolean"},{name:"overlapEnabled:boolean"},{name:"backgroundImage:file"},{name:"backgroundImageOpacity:number",minValue:0,maxValue:1,default:1},{name:"backgroundImageFit",default:"cover",choices:["cover","fill","contain"]},{name:"logoPositionX",default:"left"},{name:"logoPositionY",default:"top"},{name:"titlePositionX",default:"left"},{name:"titlePositionY",default:"bottom"},{name:"descriptionPositionX",default:"left"},{name:"descriptionPositionY",default:"bottom"}],function(){return new $e});let WP=class{constructor(e){this.type=e,this.timestamp=new Date}},zy=class extends Te{constructor(){super(),this.taskList=[],this.onAllTasksCompleted=this.addEvent()}runTask(e,t){const s=new WP(e);return this.taskList.push(s),this.hasActiveTasks=!0,t(()=>this.taskFinished(s)),s}waitAndExecute(e){if(!this.hasActiveTasks){e();return}this.onAllTasksCompleted.add(()=>{e()})}taskFinished(e){const t=this.taskList.indexOf(e);t>-1&&this.taskList.splice(t,1),this.hasActiveTasks&&this.taskList.length==0&&(this.hasActiveTasks=!1,this.onAllTasksCompleted.fire(this,{}))}};S([E({defaultValue:!1})],zy.prototype,"hasActiveTasks",void 0);let an=class extends Te{constructor(e,t){super(),this.effectiveWidth=e,this.questionTitleWidth=t}getType(){return"panellayoutcolumn"}isEmpty(){return!this.width&&!this.questionTitleWidth}};S([E()],an.prototype,"width",void 0),S([E({onSet:(n,e,t)=>{n!==t&&(e.width=n)}})],an.prototype,"effectiveWidth",void 0),S([E()],an.prototype,"questionTitleWidth",void 0),q.addClass("panellayoutcolumn",[{name:"effectiveWidth:number",isSerializable:!1,minValue:0},{name:"width:number",visible:!1},"questionTitleWidth"],n=>new an);let $P=class extends Te{get allowRendering(){return!this.panel||!this.panel.survey||!this.panel.survey.isLazyRenderingSuspended}startLazyRendering(e,t=Za){if(!ge.isAvailable())return;this._scrollableParent=t(e),this._scrollableParent===ge.getDocumentElement()&&(this._scrollableParent=we.getWindow());const s=this._scrollableParent.scrollHeight>this._scrollableParent.clientHeight;this.isNeedRender=!s,s&&(this._updateVisibility=()=>{if(this.allowRendering){var i=U2(e,50);!this.isNeedRender&&i&&(this.isNeedRender=!0,this.stopLazyRendering())}},this.lazyRenderingTimeout=setTimeout(()=>{this._scrollableParent&&this._scrollableParent.addEventListener&&this._scrollableParent.addEventListener("scroll",this._updateVisibility),this.ensureVisibility()},10))}ensureVisibility(){this._updateVisibility&&this._updateVisibility()}stopLazyRendering(){this._scrollableParent&&this._updateVisibility&&this._scrollableParent.removeEventListener&&this._scrollableParent.removeEventListener("scroll",this._updateVisibility),clearTimeout(this.lazyRenderingTimeout),this._scrollableParent=void 0,this._updateVisibility=void 0}constructor(e){super(),this.panel=e,this._scrollableParent=void 0,this._updateVisibility=void 0,this.visibleElementsAnimation=new Wi(this.getVisibleElementsAnimationOptions(),t=>{this.setWidth(t),this.setPropertyValue("visibleElements",t)},()=>this.visibleElements),this.visible=e.areInvisibleElementsShowing,this.createNewArray("elements"),this.createNewArray("visibleElements")}setIsLazyRendering(e){this.isLazyRenderingValue=e,this.isNeedRender=!e}isLazyRendering(){return this.isLazyRenderingValue===!0}get id(){return"pr_"+this.uniqueId}equalsCore(e){return this==e}get elements(){return this.getPropertyValue("elements")}getIsAnimationAllowed(){var e;return super.getIsAnimationAllowed()&&this.visible&&((e=this.panel)===null||e===void 0?void 0:e.animationAllowed)}getVisibleElementsAnimationOptions(){const e=t=>{ni(t),en(t,{width:Uu(t)+"px"})};return{getRerenderEvent:()=>this.onElementRerendered,isAnimationEnabled:()=>this.animationAllowed,allowSyncRemovalAddition:!1,getAnimatedElement:t=>t.getWrapperElement(),getLeaveOptions:t=>{const s=t;return{cssClass:(t.isPanel?s.cssClasses.panel:s.cssClasses).leave,onBeforeRunAnimation:e,onAfterRunAnimation:ys}},getEnterOptions:t=>{const s=t;return{cssClass:(t.isPanel?s.cssClasses.panel:s.cssClasses).enter,onBeforeRunAnimation:e,onAfterRunAnimation:ys}}}}set visibleElements(e){if(e.length)this.visible=!0;else{this.visible=!1,this.visibleElementsAnimation.cancel();return}this.visibleElementsAnimation.sync(e)}get visibleElements(){return this.getPropertyValue("visibleElements")}get visible(){return this.getPropertyValue("visible",!0)}set visible(e){this.setPropertyValue("visible",e),this.onVisibleChangedCallback&&this.onVisibleChangedCallback()}get isNeedRender(){return this.getPropertyValue("isneedrender",!0)}set isNeedRender(e){this.setPropertyValue("isneedrender",e)}updateVisible(){for(var e=[],t=0;t<this.elements.length;t++)this.elements[t].isVisible&&e.push(this.elements[t]),(this.elements[t].isPanel||this.elements[t].getType()==="paneldynamic")&&(this.setIsLazyRendering(!1),this.stopLazyRendering());this.visibleElements=e}addElement(e){this.elements.push(e),this.updateVisible()}get index(){return this.panel.rows.indexOf(this)}setWidth(e){var t=e.length;if(t==0)return;const s=e.length===1;for(var i=[],r=0;r<this.elements.length;r++){var a=this.elements[r];if(a.isVisible){a.isSingleInRow=s;var o=this.getElementWidth(a);o&&(a.renderWidth=this.getRenderedWidthFromWidth(o),i.push(a)),a.rightIndent=0}else a.renderWidth=""}for(var r=0;r<this.elements.length;r++){var a=this.elements[r];!a.isVisible||i.indexOf(a)>-1||(i.length==0?a.renderWidth=`${Number.parseFloat((100/t).toFixed(6))}%`:a.renderWidth=this.getRenderedCalcWidth(a,i,t))}}getRenderedCalcWidth(e,t,s){for(var i="100%",r=0;r<t.length;r++)i+=" - "+t[r].renderWidth;var a=s-t.length;return a>1&&(i="("+i+")/"+a.toString()),"calc("+i+")"}getElementWidth(e){var t=e.width;return!t||typeof t!="string"?"":t.trim()}getRenderedWidthFromWidth(e){return O.isNumber(e)?e+"px":e}dispose(){super.dispose(),this.stopLazyRendering()}getRowCss(){return new z().append(this.panel.cssClasses.row).append(this.panel.cssClasses.rowCompact,this.panel.isCompact).append(this.panel.cssClasses.pageRow,this.panel.isPage||this.panel.showPanelAsPage).append(this.panel.cssClasses.rowMultiple,this.visibleElements.length>1).toString()}setRootElement(e){this.rootElement=e}getRootElement(){return this.rootElement}},on=class Hw extends yt{get gridLayoutColumns(){let e=this.getPropertyValue("gridLayoutColumns");return this._columns||(this.generateColumns([].concat(e)),e=this._columns,this.gridLayoutColumns=e),e}set gridLayoutColumns(e){this.setPropertyValue("gridLayoutColumns",e)}onAddRow(e){this.onRowVisibleChanged(),e.onVisibleChangedCallback=()=>this.onRowVisibleChanged()}getRowsAnimationOptions(){return{getRerenderEvent:()=>this.onElementRerendered,isAnimationEnabled:()=>this.animationAllowed,getAnimatedElement:e=>e.getRootElement(),getLeaveOptions:(e,t)=>({cssClass:this.cssClasses.rowLeave,onBeforeRunAnimation:ni,onAfterRunAnimation:ys}),getEnterOptions:(e,t)=>{const s=this.cssClasses;return{cssClass:new z().append(s.rowEnter).append(s.rowDelayedEnter,t.isDeletingRunning).toString(),onBeforeRunAnimation:ni,onAfterRunAnimation:ys}}}}get visibleRows(){return this.getPropertyValue("visibleRows")}set visibleRows(e){this.rowsAnimation.sync(e)}onRemoveRow(e){e.visibleElementsAnimation.cancel(),this.visibleRows=this.rows.filter(t=>t.visible),e.onVisibleChangedCallback=void 0}onRowVisibleChanged(){this.visibleRows=this.rows.filter(e=>e.visible)}constructor(e=""){super(e),this.isQuestionsReady=!1,this.questionsValue=new Array,this._columns=void 0,this._columnsReady=!1,this.rowsAnimation=new Wi(this.getRowsAnimationOptions(),t=>{this.setPropertyValue("visibleRows",t)},()=>this.visibleRows),this.isRandomizing=!1,this.onColumnPropertyValueChangedCallback=(t,s,i,r,a)=>{this._columnsReady&&(this.updateColumnWidth(this.gridLayoutColumns),this.updateRootStyle())},this.locCountRowUpdates=0,this.createNewArray("rows",(t,s)=>{this.onAddRow(t)},t=>{this.onRemoveRow(t)}),this.createNewArray("visibleRows"),this.createNewArray("gridLayoutColumns",t=>{t.onPropertyValueChangedCallback=this.onColumnPropertyValueChangedCallback}),this.elementsValue=this.createNewArray("elements",this.onAddElement.bind(this),this.onRemoveElement.bind(this)),this.setPropertyValueDirectly("id","sp_"+this.uniqueId),this.addExpressionProperty("visibleIf",(t,s)=>{this.visible=s===!0},t=>!this.areInvisibleElementsShowing),this.addExpressionProperty("enableIf",(t,s)=>{this.readOnly=s===!1}),this.addExpressionProperty("requiredIf",(t,s)=>{this.isRequired=s===!0}),this.createLocalizableString("requiredErrorText"),this.createLocalizableString("navigationTitle",this,!0).onGetTextCallback=t=>t||this.title||this.name,this.registerPropertyChangedHandlers(["questionTitleLocation"],()=>{this.onVisibleChanged.bind(this),this.updateElementCss(!0)}),this.registerPropertyChangedHandlers(["questionStartIndex","showQuestionNumbers"],()=>{this.updateVisibleIndexes()}),this.registerPropertyChangedHandlers(["title"],()=>{this.resetHasTextInTitle()})}getType(){return"panelbase"}setSurveyImpl(e,t){this.blockAnimations(),super.setSurveyImpl(e,t),this.isDesignMode&&this.onVisibleChanged();for(var s=0;s<this.elements.length;s++)this.elements[s].setSurveyImpl(e,t);this.releaseAnimations()}endLoadingFromJson(){super.endLoadingFromJson(),this.markQuestionListDirty(),this.onRowsChanged()}get hasTextInTitle(){return this.getPropertyValue("hasTextInTitle",void 0,()=>!!this.title)}resetHasTextInTitle(){this.resetPropertyValue("hasTextInTitle")}get hasTitle(){return this.canShowTitle(this.survey)&&(this.hasTextInTitle||this.locTitle.textOrHtml.length>0)||this.isDesignMode&&!this.isPanel&&this.showTitle&&A.designMode.showEmptyTitles}delete(e=!0){this.deletePanel(),this.removeFromParent(),e&&this.dispose()}deletePanel(){const e=this.elements;for(let t=0;t<e.length;t++){const s=e[t];s.isPanel&&s.deletePanel(),this.onRemoveElementNotifySurvey(s)}}removeFromParent(){}canShowTitle(e){return!0}getDefaultTitleTagName(){return A.titleTags.panel}get _showDescription(){return!this.hasTitle&&this.isDesignMode?!1:this.survey&&this.survey.showPageTitles&&this.hasDescription||this.showDescription&&this.isDesignMode&&A.designMode.showEmptyDescriptions}localeChanged(){super.localeChanged();for(var e=0;e<this.elements.length;e++)this.elements[e].localeChanged()}locStrsChanged(){super.locStrsChanged();for(var e=0;e<this.elements.length;e++)this.elements[e].locStrsChanged()}getMarkdownHtml(e,t,s){return t==="navigationTitle"&&this.locNavigationTitle.isEmpty?this.locTitle.renderedHtml||this.name:super.getMarkdownHtml(e,t,s)}get locNavigationTitle(){return this.getLocalizableString("navigationTitle")}get renderedNavigationTitle(){return this.locNavigationTitle.renderedHtml}get requiredMark(){return this.survey&&this.isRequired?this.survey.requiredMark:""}get requiredText(){return this.requiredMark}get titlePattern(){return this.survey?this.survey.questionTitlePattern:"numTitleRequire"}get isRequireTextOnStart(){return this.isRequired&&this.titlePattern=="requireNumTitle"}get isRequireTextBeforeTitle(){return this.isRequired&&this.titlePattern=="numRequireTitle"}get isRequireTextAfterTitle(){return this.isRequired&&this.titlePattern=="numTitleRequire"}get requiredErrorText(){return this.getLocalizableStringText("requiredErrorText")}set requiredErrorText(e){this.setLocalizableStringText("requiredErrorText",e)}get locRequiredErrorText(){return this.getLocalizableString("requiredErrorText")}get questionOrder(){return this.getPropertyValue("questionOrder")}set questionOrder(e){this.setPropertyValue("questionOrder",e)}get questionsOrder(){return this.questionOrder}set questionsOrder(e){this.questionOrder=e}get questionStartIndex(){return this.getPropertyValue("questionStartIndex","")}set questionStartIndex(e){this.setPropertyValue("questionStartIndex",e)}addNoFromChild(e){return e}canRandomize(e){return e&&this.questionOrder!=="initial"||this.questionOrder==="random"}randomizeElements(e){if(!this.canRandomize(e)||this.isRandomizing)return!1;this.isRandomizing=!0;for(var t=[],s=this.elements,i=0;i<s.length;i++)t.push(s[i]);const r=O.randomizeArray(t);return this.setArrayPropertyDirectly("elements",r,!1),this.updateRows(),this.updateVisibleIndexes(),this.isRandomizing=!1,!0}get areQuestionsRandomized(){var e=this.questionOrder=="default"&&this.survey?this.survey.questionOrder:this.questionOrder;return e=="random"}get parent(){return this.getPropertyValue("parent",null)}set parent(e){this.setPropertyValue("parent",e)}get depth(){return this.parent==null?0:this.parent.depth+1}get visibleIf(){return this.getPropertyValue("visibleIf","")}set visibleIf(e){this.setPropertyValue("visibleIf",e)}calcCssClasses(e){var t={panel:{},error:{},row:"",rowEnter:"",rowLeave:"",rowDelayedEnter:"",rowMultiple:"",pageRow:"",rowCompact:""};return this.copyCssClasses(t.panel,e.panel),this.copyCssClasses(t.error,e.error),e.pageRow&&(t.pageRow=e.pageRow),e.rowCompact&&(t.rowCompact=e.rowCompact),e.row&&(t.row=e.row),e.rowEnter&&(t.rowEnter=e.rowEnter),e.rowLeave&&(t.rowLeave=e.rowLeave),e.rowDelayedEnter&&(t.rowDelayedEnter=e.rowDelayedEnter),e.rowMultiple&&(t.rowMultiple=e.rowMultiple),this.survey&&this.survey.updatePanelCssClasses(this,t),t}get id(){return this.getPropertyValue("id")}set id(e){this.setPropertyValue("id",e)}get isPanel(){return!1}getPanels(){return[this]}getLayoutType(){return"row"}isLayoutTypeSupported(e){return e!=="flow"}get questions(){return this.isQuestionsReady||(this.questionsValue=this.getQuestionsCore(!1),this.isQuestionsReady=!0),this.questionsValue}get visibleQuestions(){return this.getQuestionsCore(!0)}getQuestionsCore(e){const t=new Array;for(let i=0;i<this.elements.length;i++){const r=this.elements[i];if(!(e&&!r.isVisible))if(r.isPanel){var s=r.getQuestionsCore(e);for(let a=0;a<s.length;a++)t.push(s[a])}else t.push(r)}return t}getQuestions(e){const t=this.questions;if(!e)return t;const s=[];return t.forEach(i=>{s.push(i),i.getNestedQuestions().forEach(r=>s.push(r))}),s}getQuestionByName(e){for(var t=this.questions,s=0;s<t.length;s++)if(t[s].name==e)return t[s];return null}getElementByName(e){if(e==this.name)return this;for(var t=this.elements,s=0;s<t.length;s++){var i=t[s];if(i.name==e)return i;const r=i.getPanels();if(Array.isArray(r))for(let a=0;a<r.length;a++){const o=r[a].getElementByName(e);if(o)return o}}return null}getQuestionByValueName(e,t=!1){const s=this.getQuestionsByValueName(e,t);return s.length>0?s[0]:null}getQuestionsByValueName(e,t=!1){const s=[];t&&(e=e.toLowerCase());for(var i=this.questions,r=0;r<i.length;r++){let a=i[r].getValueName();t&&(a=a.toLowerCase()),a==e&&s.push(i[r])}return s}getValue(){var e={};return this.collectValues(e,0),O.getUnbindValue(e)}hasValueAnyQuestion(e){const t=e?this.visibleQuestions:this.questions;for(let s=0;s<t.length;s++)if(!t[s].isEmpty())return!0;return!1}collectValues(e,t){let s=this.elements;t===0&&(s=this.questions);for(var i=0;i<s.length;i++){const o=s[i];if(o.isPanel||o.isPage){const l={};o.collectValues(l,t-1)&&(e[o.name]=l)}else{const l=o;if(!l.isEmpty()){var r=l.getValueName();if(e[r]=l.getStructuredValue(t-1),this.data){var a=this.data.getComment(r);a&&(e[r+Te.commentSuffix]=a)}}}}return!0}getDisplayValue(e){for(var t={},s=this.questions,i=0;i<s.length;i++){var r=s[i];if(!r.isEmpty()){var a=e?r.title:r.getValueName();t[a]=r.getDisplayValue(e)}}return t}getComments(){var e={};if(!this.data)return e;for(var t=this.questions,s=0;s<t.length;s++){var i=t[s],r=this.data.getComment(i.getValueName());r&&(e[i.getValueName()]=r)}return e}clearIncorrectValues(){for(var e=0;e<this.elements.length;e++)this.elements[e].clearIncorrectValues()}clearErrors(){for(var e=0;e<this.elements.length;e++)this.elements[e].clearErrors();this.errors=[]}markQuestionListDirty(){this.isQuestionsReady=!1,this.parent&&this.parent.markQuestionListDirty()}get elements(){return Te.collectDependency(this,"elements"),this.elementsValue}getElementsInDesign(e=!1){return this.elements}containsElement(e){for(var t=0;t<this.elements.length;t++){var s=this.elements[t];if(s==e)return!0;var i=s.getPanels();if(Array.isArray(i)){for(let r=0;r<i.length;r++)if(i[r].containsElement(e))return!0}}return!1}get isRequired(){return this.getPropertyValue("isRequired")}set isRequired(e){this.setPropertyValue("isRequired",e)}get requiredIf(){return this.getPropertyValue("requiredIf","")}set requiredIf(e){this.setPropertyValue("requiredIf",e)}searchText(e,t){super.searchText(e,t);for(var s=0;s<this.elements.length;s++)this.elements[s].searchText(e,t)}hasErrors(e=!0,t=!1){return!this.validate(e,t)}validate(e=!0,t=!1,s){const i=new Cr({fireCallback:e,focusOnFirstError:t,callbackResult:s});return this.validateCore(i),i.finish(),i.runningResult}validateContainerOnly(){this.validateInPanels(new Cr({fireCallback:!0,isOnValueChanged:!1})),this.parent&&this.parent.validateContainerOnly()}onQuestionValueChanged(e){const t=this.questions.indexOf(e);if(t<0)return;const s=5,i=this.questions.length-1,r=t-s>0?t-s:0,a=t+s<i?t+s:i;for(let o=r;o<=a;o++){if(o===t)continue;const l=this.questions[o];l.errors.length>0&&l.validate(!1)&&l.validate(!0)}}validateInPanels(e){var t=[];this.validateRequired(e,t),this.survey&&(this.survey.validatePanel(this,t,e.fireCallback),e.setErrorElement(this,t)),e.fireCallback&&(this.errors=t)}getErrorCustomText(e,t){return this.survey?this.survey.getSurveyErrorCustomText(this,e,t):e}validateRequired(e,t){if(!this.isRequired)return;var s=[];if(this.addQuestionsToList(s,!0),s.length==0)return;for(var i=0;i<s.length;i++)if(!s[i].isEmpty())return;const r=new oP(this.requiredErrorText,this);t.push(r),e.setErrorElement(s[0],[r])}validateElement(e){const t=e.errorCount;return this.validateCore(e),e.errorCount<=t}validateCore(e){var t;let s=(t=this.survey)===null||t===void 0?void 0:t.currentSingleQuestion;s&&this.questions.indexOf(s)<0&&(s=void 0);const i=s?[s]:this.elements;let r=null;for(var a=0;a<i.length;a++)if(r=i[a],!!r.isVisible)if(r.isPanel)r.validateCore(e);else{var o=r;o.validateElement(e)}s||(this.validateInPanels(e),this.updateContainsErrors())}getContainsErrors(){var e=super.getContainsErrors();if(e)return e;for(var t=this.elements,s=0;s<t.length;s++)if(t[s].containsErrors)return!0;return!1}updateElementVisibility(){for(let e=0;e<this.elements.length;e++)this.elements[e].updateElementVisibility();super.updateElementVisibility()}getFirstQuestionToFocus(e=!1,t=!1){if(!e&&!t&&this.isCollapsed)return null;for(var s=this.elements,i=0;i<s.length;i++){var r=s[i];if(!(!r.isVisible||!t&&r.isCollapsed))if(r.isPanel){var a=r.getFirstQuestionToFocus(e,t);if(a)return a}else{const o=r.getFirstQuestionToFocus(e);if(o)return o}}return null}getFirstVisibleQuestion(){const e=this.questions;for(let t=0;t<e.length;t++)if(e[t].isVisible)return e[t];return null}getFirstVisibleElement(){const e=this.elements;for(let t=0;t<e.length;t++)if(e[t].isVisible)return e[t];return null}focusFirstQuestion(){const e=this.getFirstQuestionToFocus();e&&e.focus()}focusFirstErrorQuestion(){var e=this.getFirstQuestionToFocus(!0);e&&e.focus()}addQuestionsToList(e,t=!1,s=!1){this.addElementsToList(e,t,s,!1)}addPanelsIntoList(e,t=!1,s=!1){this.addElementsToList(e,t,s,!0)}addElementsToList(e,t,s,i){t&&!this.visible||this.addElementsToListCore(e,this.elements,t,s,i)}addElementsToListCore(e,t,s,i,r){for(var a=0;a<t.length;a++){var o=t[a];s&&!o.visible||((r&&o.isPanel||!r&&!o.isPanel)&&e.push(o),o.isPanel?o.addElementsToListCore(e,o.elements,s,i,r):i&&this.addElementsToListCore(e,o.getElementsInDesign(!1),s,i,r))}}calcMaxRowColSpan(){let e=0;return this.rows.forEach(t=>{let s=0,i=!1;t.elements.forEach(r=>{r.width&&(i=!0),s+=r.colSpan||1}),!i&&s>e&&(e=s)}),e}updateColumnWidth(e){let t=0,s=0;if(e.forEach(i=>{i.width?(t+=i.width,i.setPropertyValue("effectiveWidth",i.width)):s++}),s){const i=rP((100-t)/s);for(let r=0;r<e.length;r++)e[r].width||e[r].setPropertyValue("effectiveWidth",i)}}updateColumns(){this._columns=void 0,this.updateRootStyle()}updateRootStyle(){var e;super.updateRootStyle(),(e=this.elements)===null||e===void 0||e.forEach(t=>t.updateRootStyle())}updateCustomWidgets(){for(var e=0;e<this.elements.length;e++)this.elements[e].updateCustomWidgets()}get questionTitleLocation(){return this.getPropertyValue("questionTitleLocation")}set questionTitleLocation(e){this.setPropertyValue("questionTitleLocation",e.toLowerCase())}getQuestionTitleLocation(){return this.onGetQuestionTitleLocation?this.onGetQuestionTitleLocation():this.questionTitleLocation!="default"?this.questionTitleLocation:this.parent?this.parent.getQuestionTitleLocation():this.survey?this.survey.questionTitleLocation:"top"}availableQuestionTitleWidth(){return this.getQuestionTitleLocation()==="left"||this.hasElementWithTitleLocationLeft()}hasElementWithTitleLocationLeft(){return this.elements.some(t=>{if(t instanceof Hw)return t.hasElementWithTitleLocationLeft();if(t instanceof Dt)return t.getTitleLocation()==="left"})}getQuestionTitleWidth(){return(this.onGetQuestionTitleWidth?this.onGetQuestionTitleWidth():this.questionTitleWidth)||this.parent&&this.parent.getQuestionTitleWidth()}get columns(){return this._columns||(this.generateColumns(this.gridLayoutColumns),this.gridLayoutColumns=this._columns),this._columns||[]}generateColumns(e){var t;const s=(t=this.survey)===null||t===void 0?void 0:t.gridLayoutEnabled;let i=[].concat(e);if(s){let r=this.calcMaxRowColSpan();if(r<=e.length)i=e.slice(0,r);else for(let a=e.length;a<r;a++){const o=new an;i.push(o)}}this._columns=i;try{this._columnsReady=!1,this.updateColumnWidth(i)}finally{this._columnsReady=!0}}createGridLayoutColumns(){return this.generateColumns([]),this._columns}updateGridColumns(){this.updateColumns(),this.elements.forEach(e=>{e.isPanel&&e.updateGridColumns()})}getColumsForElement(e){const t=this.findRowByElement(e);if(!t||!this.survey||!this.survey.gridLayoutEnabled)return[];let s=t.elements.length-1;for(;s>=0&&t.elements[s].getPropertyValueWithoutDefault("colSpan");)s--;const i=t.elements.indexOf(e);let r=0;for(let l=0;l<i;l++)r+=t.elements[l].colSpan;let a=e.getPropertyValueWithoutDefault("colSpan");if(!a&&i===s){let l=0;for(let u=0;u<t.elements.length;u++)u!==s&&(l+=t.elements[u].colSpan);a=this.columns.length-l}const o=this.columns.slice(r,r+(a||1));return e.setPropertyValueDirectly("effectiveColSpan",o.length),o}isQuestionIndexRecursive(){return!!this.survey&&this.survey.showQuestionNumbers==="recursive"}getQuestionStartIndex(){const e=this.getStartIndex();return this.isQuestionIndexRecursive()?this.getStartIndexSubs(e,!0):e}getStartIndexSubs(e,t){if(!e||!this.isComplexIndex(e))return e;const s=e[e.length-1]==="."?".":"";s&&(e=e.substring(0,e.length-1));const i=e.lastIndexOf(".");return e+=s,t?e.substring(i+1):e.substring(0,i+1)}getQuestionStartIndexVsVisibleIndex(e,t){const s=this.getStartIndexSubs(e,!1),i=this.getStartIndexSubs(e,!0);return O.getNumberByIndex(t,s)+i}isComplexIndex(e){const t=e.indexOf(".");return t>-1&&t<e.length-1}getChildrenLayoutType(){return"row"}getProgressInfo(){return yt.getProgressInfoByElements(this.elements,this.isRequired)}get root(){for(var e=this;e.parent;)e=e.parent;return e}childVisibilityChanged(){if(!this.isRunningConditions){var e=this.getIsPageVisible(null),t=this.getPropertyValue("isVisible",!0);e!==t&&this.onVisibleChanged()}}canRenderFirstRows(){return this.isPage}isLazyRenderInRow(e){return!this.survey||!this.survey.isLazyRendering?!1:e>=this.survey.lazyRenderFirstBatchSize||!this.canRenderFirstRows()}createRowAndSetLazy(e){const t=this.createRow();return t.setIsLazyRendering(this.isLazyRenderInRow(e)),t}createRow(){return new $P(this)}onSurveyLoad(){this.blockAnimations(),super.onSurveyLoad();for(var e=0;e<this.elements.length;e++)this.elements[e].onSurveyLoad();this.onElementVisibilityChanged(this),this.releaseAnimations()}onFirstRenderingCore(){super.onFirstRenderingCore(),this.onRowsChanged(),this.elements.forEach(e=>e.onFirstRendering())}updateRows(){this.isLoadingFromJson||(this.getElementsForRows().forEach(e=>{e.isPanel&&e.updateRows()}),this.onRowsChanged())}get rows(){return this.getPropertyValue("rows")}ensureRowsVisibility(){this.rows.forEach(e=>{e.ensureVisibility()})}onRowsChanged(){this.isLoadingFromJson||!this.wasRendered||(this.blockAnimations(),this.setArrayPropertyDirectly("rows",this.buildRows()),this.updateColumns(),this.releaseAnimations())}blockRowsUpdates(){this.locCountRowUpdates++}releaseRowsUpdates(){this.locCountRowUpdates--}updateRowsBeforeElementRemoved(e){if(!this.wasRendered&&this.rows.length===0)return;const t=this.findRowByElement(e),s=this.rows.indexOf(t),i=t.elements.indexOf(e);t.elements.splice(i,1),t.elements.length==0?this.rows.splice(s,1):!t.elements[0].startWithNewLine&&this.rows[s-1]?(t.elements.forEach(r=>this.rows[s-1].addElement(r)),this.rows.splice(s,1)):t.updateVisible()}updateRowsOnElementAdded(e){if(!this.wasRendered&&this.rows.length===0&&this.elements.length>1)return;const t=this.elements.indexOf(e),s=this.elements[t+1],i=u=>{const d=this.createRowAndSetLazy(u);return this.isDesignMode&&d.setIsLazyRendering(!1),this.rows.splice(u,0,d),d},r=(u,d,h,...f)=>{const C=u.elements.splice(d,h,...f);return u.updateVisible(),C};if(!s){t==0||e.startWithNewLine?r(i(this.rows.length),0,0,e):this.rows[this.rows.length-1].addElement(e);return}const a=this.findRowByElement(s);if(!a)return;const o=this.rows.indexOf(a),l=a.elements.indexOf(s);l==0?s.startWithNewLine?e.startWithNewLine||o<1?i(o).addElement(e):this.rows[o-1].addElement(e):r(a,0,0,e):e.startWithNewLine?r(i(o+1),0,0,...[e].concat(r(a,l,a.elements.length))):r(a,l,0,e)}canFireAddRemoveNotifications(e){return!!this.survey&&e.prevSurvey!==this.survey}onAddElement(e,t){const s=this.survey,i=this.canFireAddRemoveNotifications(e);this.surveyImpl&&e.setSurveyImpl(this.surveyImpl),e.parent=this,this.markQuestionListDirty(),this.canBuildRows()&&this.updateRowsOnElementAdded(e),i&&(e.isPanel?s.panelAdded(e,t,this,this.root):s.questionAdded(e,t,this,this.root)),this.addElementCallback&&this.addElementCallback(e),e.registerPropertyChangedHandlers(["visible","isVisible"],()=>{this.onElementVisibilityChanged(e)},this.id),e.registerPropertyChangedHandlers(["startWithNewLine"],()=>{this.onElementStartWithNewLineChanged(e)},this.id),this.onElementVisibilityChanged(this)}onRemoveElement(e){e.parent=null,this.unregisterElementPropertiesChanged(e),this.markQuestionListDirty(),this.updateRowsOnElementRemoved(e),!this.isRandomizing&&(this.onRemoveElementNotifySurvey(e),this.removeElementCallback&&this.removeElementCallback(e),this.onElementVisibilityChanged(this))}unregisterElementPropertiesChanged(e){e.unregisterPropertyChangedHandlers(["visible","isVisible","startWithNewLine"],this.id)}onRemoveElementNotifySurvey(e){this.canFireAddRemoveNotifications(e)&&(e.isPanel?this.survey.panelRemoved(e):this.survey.questionRemoved(e))}onElementVisibilityChanged(e){this.isLoadingFromJson||this.isRandomizing||(this.updateRowsVisibility(e),this.childVisibilityChanged(),this.parent&&this.parent.onElementVisibilityChanged(this))}onElementStartWithNewLineChanged(e){this.locCountRowUpdates>0||(this.blockAnimations(),this.updateRowsBeforeElementRemoved(e),this.updateRowsOnElementAdded(e),this.releaseAnimations())}updateRowsVisibility(e){for(var t=this.rows,s=0;s<t.length;s++){var i=t[s];if(i.elements.indexOf(e)>-1){i.updateVisible(),i.visible&&!i.isNeedRender&&(i.isNeedRender=!0);break}}}canBuildRows(){return!this.isLoadingFromJson&&this.getChildrenLayoutType()=="row"}buildRows(){if(!this.canBuildRows())return[];const e=new Array,t=this.getElementsForRows();for(let s=0;s<t.length;s++){const i=t[s],r=s==0||i.startWithNewLine,a=r?this.createRowAndSetLazy(e.length):e[e.length-1];r&&e.push(a),a.addElement(i)}return e.forEach(s=>s.updateVisible()),e}getElementsForRows(){return this.elements}getDragDropInfo(){const e=this.getPage(this.parent);return e?e.getDragDropInfo():void 0}updateRowsOnElementRemoved(e){this.canBuildRows()&&(this.updateRowsRemoveElementFromRow(e,this.findRowByElement(e)),this.updateColumns())}updateRowsRemoveElementFromRow(e,t){if(!(!t||!t.panel)){var s=t.elements.indexOf(e);s<0||(t.elements.splice(s,1),t.elements.length>0?(this.blockRowsUpdates(),t.elements[0].startWithNewLine=!0,this.releaseRowsUpdates(),t.updateVisible()):t.index>=0&&t.panel.rows.splice(t.index,1))}}getAllRows(){const e=[];return this.rows.forEach(t=>{const s=[];t.elements.forEach(i=>{i.isPanel?s.push(...i.getAllRows()):i.getType()=="paneldynamic"&&(this.isDesignMode?s.push(...i.template.getAllRows()):i.panels.forEach(r=>s.push(...r.getAllRows())))}),e.push(t),e.push(...s)}),e}findRowAndIndexByElement(e,t){if(!e)return{row:void 0,index:this.rows.length-1};t=t||this.rows;for(var s=0;s<t.length;s++)if(t[s].elements.indexOf(e)>-1)return{row:t[s],index:s};return{row:null,index:-1}}forceRenderRow(e){e&&!e.isNeedRender&&(e.isNeedRender=!0,e.stopLazyRendering())}forceRenderElement(e,t=()=>{},s=0){const i=this.getAllRows(),{row:r,index:a}=this.findRowAndIndexByElement(e,i);if(a>=0&&a<i.length){const o=[];o.push(r);for(let l=a-1;l>=a-s&&l>=0;l--)o.push(i[l]);this.forceRenderRows(o,t)}}forceRenderRows(e,t=()=>{}){const s=(i=>()=>{i--,i<=0&&t()})(e.length);e.forEach(i=>new F2(i.visibleElements,s)),e.forEach(i=>this.forceRenderRow(i))}findRowByElement(e){return this.findRowAndIndexByElement(e).row}elementWidthChanged(e){if(!this.isLoadingFromJson){var t=this.findRowByElement(e);t&&t.updateVisible()}}get ariaTitleId(){return this.id+"_ariaTitle"}get ariaLabelledBy(){return this.hasTitle?this.ariaTitleId:null}get ariaLabel(){return this.hasTitle?null:this.title||this.name||null}get ariaRole(){return"group"}get processedTitle(){return this.getRenderedTitle(this.locTitle.textOrHtml)}getRenderedTitle(e){return this.textProcessor!=null?this.textProcessor.processText(e,!0):e}get visible(){return this.getPropertyValue("visible")}set visible(e){e!==this.visible&&(this.setPropertyValue("visible",e),this.setPropertyValue("isVisible",this.isVisible),this.isLoadingFromJson||this.onVisibleChanged())}onHidingContent(){this.questions.forEach(e=>e.onHidingContent())}onVisibleChanged(){if(!this.isRandomizing&&(this.setPropertyValue("isVisible",this.isVisible),this.canUpdateValueOnVisibleChanged())){const t=this.questions,s=this.isVisible;for(var e=0;e<t.length;e++){const i=t[e];s?i.updateValueWithDefaults():(i.clearValueIfInvisible("onHiddenContainer"),i.onHidingContent())}}}notifyStateChanged(e){super.notifyStateChanged(e),this.isCollapsed&&this.questions.forEach(t=>t.onHidingContent())}get isVisible(){return this.areInvisibleElementsShowing||this.getIsPageVisible(null)}getIsContentVisible(e){if(this.areInvisibleElementsShowing)return!0;for(var t=0;t<this.elements.length;t++)if(this.elements[t]!=e&&this.elements[t].isVisible)return!0;return!1}getIsPageVisible(e){const t=this.getIsContentVisible(e);return this.visible&&t}setVisibleIndex(e){if(!this.isVisible||e<0)return this.resetVisibleIndexes(),0;this.lastVisibleIndex=e;var t=e;e+=this.beforeSetVisibleIndex(e);var s=this.getPanelStartIndex(e),i=s;const r=this.elements;for(var a=0;a<r.length;a++)i+=r[a].setVisibleIndex(i);return this.isContinueNumbering()&&(e+=i-s),e-t}updateVisibleIndexes(){this.lastVisibleIndex!==void 0&&(this.resetVisibleIndexes(),this.setVisibleIndex(this.lastVisibleIndex))}resetVisibleIndexes(){const e=this.elements;for(var t=0;t<e.length;t++)e[t].setVisibleIndex(-1)}beforeSetVisibleIndex(e){return 0}getPanelStartIndex(e){return e}isContinueNumbering(){return!0}get isReadOnly(){var e=!!this.parent&&this.parent.isReadOnly,t=!!this.survey&&this.survey.isDisplayMode;return this.readOnly||e||t}onReadOnlyChanged(){for(var e=0;e<this.elements.length;e++){var t=this.elements[e];t.setPropertyValue("isReadOnly",t.isReadOnly)}super.onReadOnlyChanged()}updateElementCss(e){super.updateElementCss(e);for(let t=0;t<this.elements.length;t++)this.elements[t].updateElementCss(e)}get enableIf(){return this.getPropertyValue("enableIf","")}set enableIf(e){this.setPropertyValue("enableIf",e)}addElement(e,t=-1){return this.canAddElement(e)?(t<0||t>=this.elements.length?this.elements.push(e):this.elements.splice(t,0,e),this.wasRendered&&e.onFirstRendering(),this.updateColumns(),!0):!1}insertElement(e,t,s="bottom"){if(!t){this.addElement(e);return}this.blockRowsUpdates();let i=this.elements.indexOf(t);const r=this.findRowByElement(t);s=="left"||s=="right"?s=="right"?(e.startWithNewLine=!1,i++):r.elements.indexOf(t)==0?(t.startWithNewLine=!1,e.startWithNewLine=!0):e.startWithNewLine=!1:(e.startWithNewLine=!0,s=="top"?i=this.elements.indexOf(r.elements[0]):i=this.elements.indexOf(r.elements[r.elements.length-1])+1),this.releaseRowsUpdates(),this.addElement(e,i)}insertElementAfter(e,t){const s=this.elements.indexOf(t);s>=0&&this.addElement(e,s+1)}insertElementBefore(e,t){const s=this.elements.indexOf(t);s>=0&&this.addElement(e,s)}canAddElement(e){return!!e&&e.isLayoutTypeSupported(this.getChildrenLayoutType())}addQuestion(e,t=-1){return this.addElement(e,t)}addPanel(e,t=-1){return this.addElement(e,t)}addNewQuestion(e,t=null,s=-1){var i=qe.Instance.createQuestion(e,t);return this.addQuestion(i,s)?i:null}addNewPanel(e=null){var t=this.createNewPanel(e);return this.addPanel(t)?t:null}indexOf(e){return this.elements.indexOf(e)}createNewPanel(e){var t=q.createClass("panel");return t.name=e,t}removeElement(e){var t=this.elements.indexOf(e);if(t<0){for(var s=0;s<this.elements.length;s++)if(this.elements[s].removeElement(e))return!0;return!1}return this.elements.splice(t,1),this.updateColumns(),!0}removeQuestion(e){this.removeElement(e)}runCondition(e){if(this.isDesignMode||this.isLoadingFromJson)return;var t=this.elements.slice();const s=this.getIsPageVisible();this.isRunningConditions=!0;for(var i=0;i<t.length;i++)t[i].runCondition(e);this.runConditionCore(e);const r=this.getIsPageVisible();this.isRunningConditions=!1,s!==r&&this.childVisibilityChanged()}onAnyValueChanged(e,t){for(var s=this.elements,i=0;i<s.length;i++)s[i].onAnyValueChanged(e,t)}checkBindings(e,t){for(var s=this.elements,i=0;i<s.length;i++)s[i].checkBindings(e,t)}needResponsiveWidth(){let e=!1;return this.elements.forEach(t=>{t.needResponsiveWidth()&&(e=!0)}),this.rows.forEach(t=>{t.elements.length>1&&(e=!0)}),e}get hasDescriptionUnderTitle(){return this.hasDescription}get cssHeader(){return this.cssClasses.panel.header}get cssDescription(){return this.cssClasses.panel.description}get questionErrorLocation(){return this.getPropertyValue("questionErrorLocation")}set questionErrorLocation(e){this.setPropertyValue("questionErrorLocation",e)}getQuestionErrorLocation(){return this.questionErrorLocation!=="default"?this.questionErrorLocation:this.parent?this.parent.getQuestionErrorLocation():this.survey?this.survey.questionErrorLocation:"top"}getTitleOwner(){return this}get no(){return""}get cssTitleNumber(){return this.cssClasses.panel.number}get cssRequiredMark(){return this.cssClasses.panel.requiredMark}get cssError(){return this.getCssError(this.cssClasses)}getCssError(e){return new z().append(e.error.root).toString()}getSerializableColumnsValue(){let e=-1;for(let t=this.gridLayoutColumns.length-1;t>=0;t--)if(!this.gridLayoutColumns[t].isEmpty()){e=t;break}return this.gridLayoutColumns.slice(0,e+1)}afterRender(e){this.afterRenderCore(e)}dispose(){if(super.dispose(),this.rows){for(let e=0;e<this.rows.length;e++)this.rows[e].dispose();this.rows.splice(0,this.rows.length)}this.disposeElements(),this.elements.splice(0,this.elements.length)}disposeElements(){for(let e=0;e<this.elements.length;e++)this.elements[e].dispose()}};S([E({defaultValue:!0})],on.prototype,"showTitle",void 0),S([E({defaultValue:!0})],on.prototype,"showDescription",void 0),S([E()],on.prototype,"questionTitleWidth",void 0);let ho=class zw extends on{constructor(e=""){super(e),this.forcusFirstQuestionOnExpand=!0,this.createNewArray("footerActions"),this.registerPropertyChangedHandlers(["width"],()=>{this.parent&&this.parent.elementWidthChanged(this)}),this.registerPropertyChangedHandlers(["indent","innerIndent","rightIndent"],()=>{this.resetIndents()}),this.registerPropertyChangedHandlers(["colSpan"],()=>{var t;(t=this.parent)===null||t===void 0||t.updateColumns()})}getType(){return"panel"}get contentId(){return this.id+"_content"}getSurvey(e=!1){return e&&this.isPanel?this.parent?this.parent.getSurvey(e):null:super.getSurvey(e)}get isPanel(){return!0}get page(){return this.getPage(this.parent)}set page(e){this.setPage(this.parent,e)}removeFromParent(){this.parent&&this.removeSelfFromList(this.parent.elements)}moveTo(e,t=null){return this.moveToBase(this.parent,e,t)}getPanelInDesignMode(){return this}get visibleIndex(){return this.getPropertyValue("visibleIndex",-1)}get showNumber(){return this.getPropertyValue("showNumber")}set showNumber(e){this.setPropertyValue("showNumber",e),this.notifySurveyOnVisibilityChanged()}addNoFromChild(e){let t=this.getRecursiveNo();return t?(t[t.length-1]!=="."&&this.canAddDot(e)&&(t+="."),t+e):super.addNoFromChild(e)}getRecursiveNo(){return this.recursiveNoCallback?this.recursiveNoCallback():this.isQuestionIndexRecursive()?this.calcNo():""}canAddDot(e){return!!e&&new RegExp("^[\\p{L}\\d]","u").test(e[0])}get showQuestionNumbers(){return this.getPropertyValue("showQuestionNumbers")}set showQuestionNumbers(e){this.setPropertyValue("showQuestionNumbers",e),this.notifySurveyOnVisibilityChanged()}getPageVisibleIndex(){var e;return((e=this.page)===null||e===void 0?void 0:e.visibleIndex)||-1}getQuestionStartIndex(){const e=this.questionStartIndex;return e&&this.isQuestionIndexOnPanel&&this.isComplexIndex(e)?this.getQuestionStartIndexVsVisibleIndex(e,this.visibleIndex):e||super.getQuestionStartIndex()}get no(){return this.getPropertyValue("no",void 0,()=>this.calcNo())}calcNo(){let e=this.hasTitle?O.getNumberByIndex(this.visibleIndex,this.getStartIndex()):"";return this.onGetNoCallback&&(e=this.onGetNoCallback(e)),this.parent&&(e=this.parent.addNoFromChild(e)),this.survey&&(e=this.survey.getUpdatedPanelNo(this,e)),e||""}notifyStateChanged(e){this.isLoadingFromJson||this.locTitle.strChanged(),super.notifyStateChanged(e)}createLocTitleProperty(){const e=super.createLocTitleProperty();return e.onGetTextCallback=t=>(!t&&this.state!=="default"&&(t=this.name),t),e}beforeSetVisibleIndex(e){if(this.isPage||!this.parent)return super.beforeSetVisibleIndex(e);let t=-1;return(this.showNumber||this.isQuestionIndexRecursive())&&(this.isDesignMode||!this.locTitle.isEmpty||this.hasParentInQuestionIndex())&&(t=e),this.setPropertyValue("visibleIndex",t),this.resetPropertyValue("no"),t<0?0:1}getPanelStartIndex(e){return this.showQuestionNumbers==="off"?-1:this.isQuestionIndexOnPanel?0:e}get isQuestionIndexOnPanel(){return this.showQuestionNumbers==="onpanel"||this.isQuestionIndexRecursive()}isQuestionIndexRecursive(){const e=this.showQuestionNumbers;return e!=="default"?e==="recursive":super.isQuestionIndexRecursive()}hasParentInQuestionIndex(){if(!this.isQuestionIndexOnPanel)return!1;const e=this.questionStartIndex,t=e.indexOf(".");return t>-1&&t<e.length-1}isContinueNumbering(){return this.showQuestionNumbers!=="off"&&!this.isQuestionIndexOnPanel}notifySurveyOnVisibilityChanged(){this.survey!=null&&!this.isLoadingFromJson&&this.survey.panelVisibilityChanged(this,this.isVisible)}getRenderedTitle(e){if(this.isPanel&&!e){if(this.isCollapsed||this.isExpanded)return this.name;if(this.isDesignMode)return"["+this.name+"]"}return super.getRenderedTitle(e)}get innerIndent(){return this.getPropertyValue("innerIndent")}set innerIndent(e){this.setPropertyValue("innerIndent",e)}get startWithNewLine(){return this.getPropertyValue("startWithNewLine")}set startWithNewLine(e){this.setPropertyValue("startWithNewLine",e)}get allowAdaptiveActions(){return this.getPropertyValue("allowAdaptiveActions")}set allowAdaptiveActions(e){this.setPropertyValue("allowAdaptiveActions",e)}get innerPaddingLeft(){const e=()=>this.getIndentSize(this.innerIndent);return this.getPropertyValue("innerPaddingLeft",void 0,e)}set innerPaddingLeft(e){this.setPropertyValue("innerPaddingLeft",e)}calcPaddingLeft(){return this.getIndentSize(this.indent)}calcPaddingRight(){return this.getIndentSize(this.rightIndent)}resetIndents(){this.resetPropertyValue("innerPaddingLeft"),super.resetIndents()}getIndentSize(e){if(this.survey){if(e<1)return"";var t=this.survey.css;return!t||!t.question||!t.question.indent?"":e*t.question.indent+"px"}}clearOnDeletingContainer(){this.elements.forEach(e=>{(e instanceof Dt||e instanceof zw)&&e.clearOnDeletingContainer()})}get footerActions(){return this.getPropertyValue("footerActions")}getFooterToolbar(){var e,t;if(!this.footerToolbarValue){var s=this.footerActions;this.hasEditButton&&s.push({id:"cancel-preview",locTitle:this.survey.locEditText,innerCss:this.survey.cssNavigationEdit,component:"sv-nav-btn",action:()=>{this.cancelPreview()}}),this.onGetFooterActionsCallback?s=this.onGetFooterActionsCallback():s=(e=this.survey)===null||e===void 0?void 0:e.getUpdatedPanelFooterActions(this,s),this.footerToolbarValue=this.createActionContainer(this.allowAdaptiveActions);let i=this.onGetFooterToolbarCssCallback?this.onGetFooterToolbarCssCallback():"";i||(i=(t=this.cssClasses.panel)===null||t===void 0?void 0:t.footer),i&&(this.footerToolbarValue.containerCss=i),this.footerToolbarValue.setItems(s),this.footerToolbarValue.flushUpdates()}return this.footerToolbarValue}get hasEditButton(){return!1}cancelPreview(){this.hasEditButton&&this.survey.cancelPreviewByPage(this)}get cssTitle(){return this.getCssPanelTitle()}getCssPanelTitle(){return this.getCssTitle(this.cssClasses.panel)}getCssTitleExpandableSvg(){return this.state==="default"?null:this.cssClasses.panel.titleExpandableSvg}get showErrorsAbovePanel(){return!this.showPanelAsPage}getCssError(e){if(this.isPage)return super.getCssError(e);const t=new z().append(super.getCssError(e)).append(e.panel.errorsContainer);return t.append("panel-error-root",t.isEmpty()).toString()}onVisibleChanged(){super.onVisibleChanged(),this.notifySurveyOnVisibilityChanged()}needResponsiveWidth(){return this.startWithNewLine?super.needResponsiveWidth():!0}focusIn(){this.survey&&this.survey.whenPanelFocusIn(this)}getHasFrameV2(){return super.getHasFrameV2()&&!this.showPanelAsPage}getIsNested(){return super.getIsNested()&&this.parent!==void 0}get showPanelAsPage(){return!1}expand(e=!0){this.forcusFirstQuestionOnExpand=e,super.expand()}onElementExpanded(e){if(this.forcusFirstQuestionOnExpand&&this.survey!=null&&!this.isLoadingFromJson){const t=this.getFirstQuestionToFocus(!1);t&&setTimeout(()=>{!this.isDisposed&&this.survey&&this.survey.scrollElementToTop(t,t,null,t.inputId,!1,{behavior:"smooth"})},e?0:15)}}getCssRoot(e){return new z().append(super.getCssRoot(e)).append(e.container).append(e.asPage,this.showPanelAsPage).append(e.invisible,!this.isDesignMode&&this.areInvisibleElementsShowing&&!this.visible).toString()}getContainerCss(){return this.getCssRoot(this.cssClasses.panel)}afterRenderCore(e){var t;super.afterRenderCore(e),this.isPanel&&((t=this.survey)===null||t===void 0||t.afterRenderPanel(this,e))}};q.addClass("panelbase",["name",{name:"elements",alternativeName:"questions",baseClassName:"question",visible:!1,isLightSerializable:!1},{name:"visible:switch",default:!0,overridingProperty:"visibleIf"},{name:"readOnly:boolean",overridingProperty:"enableIf"},"visibleIf:condition","enableIf:condition","requiredIf:condition",{name:"questionTitleWidth",visibleIf:function(n){return!!n&&n.availableQuestionTitleWidth()}},{name:"questionTitleLocation",default:"default",choices:["default","top","bottom","left","hidden"]},{name:"gridLayoutColumns:panellayoutcolumns",className:"panellayoutcolumn",isArray:!0,onSerializeValue:n=>n.getSerializableColumnsValue(),visibleIf:function(n){return!!n&&!!n.survey&&n.survey.gridLayoutEnabled}},{name:"title:text",serializationProperty:"locTitle"},{name:"description:text",serializationProperty:"locDescription"},{name:"questionOrder",alternativeName:"questionsOrder",default:"default",choices:["default","initial","random"]},{name:"questionErrorLocation",default:"default",choices:["default","top","bottom"]}],function(){return new on}),q.addClass("panel",[{name:"state",default:"default",choices:["default","collapsed","expanded"]},{name:"isRequired:switch",overridingProperty:"requiredIf"},{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText"},{name:"startWithNewLine:boolean",default:!0},{name:"width"},{name:"minWidth",defaultFunc:()=>"auto"},{name:"maxWidth",defaultFunc:()=>A.maxWidth},{name:"colSpan:number",visible:!1,onSerializeValue:n=>n.getPropertyValue("colSpan")},{name:"effectiveColSpan:number",minValue:1,isSerializable:!1,visibleIf:function(n){return!!n.survey&&n.survey.gridLayoutEnabled}},{name:"innerIndent:number",default:0,choices:[0,1,2,3]},{name:"indent:number",default:0,choices:[0,1,2,3],visible:!1},{name:"page",isSerializable:!1,visibleIf:function(n){var e=n?n.survey:null;return!e||!e.pages||e.pages.length>1},choices:function(n){var e=n?n.survey:null;return e?e.pages.map(t=>({value:t.name,text:t.title})):[]}},{name:"showNumber:boolean"},{name:"showQuestionNumbers",default:"default",choices:["default","onpanel","recursive","off"]},{name:"questionStartIndex",visibleIf:n=>n.isPanel},{name:"allowAdaptiveActions:boolean",default:!0,visible:!1}],function(){return new ho},"panelbase"),oi.Instance.registerElement("panel",n=>new ho(n));let sh=class extends ho{constructor(e=""){super(e),this.timeSpent=0,this._isReadyForClean=!0,this.createLocalizableString("navigationDescription",this,!0)}getType(){return"page"}toString(){return this.name}get isPage(){return!this.isPanel}get isPanel(){return!!this.parent}get showPanelAsPage(){return!0}get hasEditButton(){return this.isPanel&&this.survey&&this.survey.state==="preview"&&!!this.parent&&!this.parent.isPanel}getElementsForRows(){var e;if(!this.isStartPage){const t=(e=this.survey)===null||e===void 0?void 0:e.currentSingleElement;if(t)return t.page===this?[t]:[]}return super.getElementsForRows()}disposeElements(){this.isPageContainer||super.disposeElements()}onRemoveElement(e){this.isPageContainer?(e.parent=null,this.unregisterElementPropertiesChanged(e)):super.onRemoveElement(e)}getTemplate(){return this.isPanel?"panel":super.getTemplate()}getPanelInDesignMode(){return null}get no(){if(!this.canShowPageNumber()||!this.survey)return"";let e=this.isStartPage?"":this.num+". ";return this.survey.getUpdatedPageNo(this,e)}addNoFromChild(e){return e}get cssTitleNumber(){return this.isPanel?this.cssClasses.panel.number:this.cssClasses.page.number}getCssTitleExpandableSvg(){return null}get cssRequiredMark(){return""}canShowPageNumber(){return this.survey&&this.survey.showPageNumbers}canShowTitle(e){return!e||e.showPageTitles}setTitleValue(e){super.setTitleValue(e),this.navigationLocStrChanged()}getDefaultTitleTagName(){return A.titleTags.page}get navigationTitle(){return this.getLocalizableStringText("navigationTitle")}set navigationTitle(e){this.setLocalizableStringText("navigationTitle",e)}get navigationDescription(){return this.getLocalizableStringText("navigationDescription")}set navigationDescription(e){this.setLocalizableStringText("navigationDescription",e)}get locNavigationDescription(){return this.getLocalizableString("navigationDescription")}navigationLocStrChanged(){this.locNavigationTitle.isEmpty&&this.locTitle.strChanged(),this.locNavigationTitle.strChanged(),this.locNavigationDescription.strChanged()}getMarkdownHtml(e,t,s){const i=super.getMarkdownHtml(e,t,s);return t==="navigationTitle"&&this.canShowPageNumber()&&i?this.num+". "+i:i}get passed(){return this.getPropertyValue("passed",!1)}set passed(e){this.setPropertyValue("passed",e)}removeFromParent(){this.survey&&this.removeSelfFromList(this.survey.pages)}get visibleIndex(){return this.getPropertyValue("visibleIndex",-1)}set visibleIndex(e){this.setPropertyValue("visibleIndex",e)}canRenderFirstRows(){return!this.isDesignMode||this.visibleIndex==0}isQuestionIndexRecursive(){return super.isQuestionIndexRecursive()&&this.isComplexIndex(this.getStartIndex())}getPanelStartIndex(e){return this.isQuestionIndexRecursive()?0:e}getPageVisibleIndex(){return this.visibleIndex}getQuestionStartIndex(){const e=this.getStartIndex();return this.isQuestionIndexRecursive()?this.getQuestionStartIndexVsVisibleIndex(e,this.num-1):e}get isStartPage(){return this.survey&&this.survey.isPageStarted(this)}get isStarted(){return this.isStartPage}calcCssClasses(e){if(this.isPanel)return super.calcCssClasses(e);const t={page:{},error:{},pageTitle:"",pageDescription:"",row:"",rowMultiple:"",pageRow:"",rowCompact:"",rowEnter:"",rowLeave:"",rowDelayedEnter:"",rowReplace:""};return this.copyCssClasses(t.page,e.page),this.copyCssClasses(t.error,e.error),e.pageTitle&&(t.pageTitle=e.pageTitle),e.pageDescription&&(t.pageDescription=e.pageDescription),e.row&&(t.row=e.row),e.pageRow&&(t.pageRow=e.pageRow),e.rowMultiple&&(t.rowMultiple=e.rowMultiple),e.rowCompact&&(t.rowCompact=e.rowCompact),e.rowEnter&&(t.rowEnter=e.rowEnter),e.rowDelayedEnter&&(t.rowDelayedEnter=e.rowDelayedEnter),e.rowLeave&&(t.rowLeave=e.rowLeave),e.rowReplace&&(t.rowReplace=e.rowReplace),this.survey&&this.survey.updatePageCssClasses(this,t),t}getCssPanelTitle(){return this.isPanel?super.getCssPanelTitle():this.cssClasses.page?new z().append(this.cssClasses.page.title).toString():""}get cssRoot(){return this.isPanel||!this.cssClasses.page||!this.survey?"":new z().append(this.cssClasses.page.root).append(this.cssClasses.page.emptyHeaderRoot,!this.survey.renderedHasHeader&&!(this.survey.isShowProgressBarOnTop&&!this.survey.isStaring)).toString()}getCssError(e){return this.isPanel?super.getCssError(e):new z().append(super.getCssError(e)).append(e.page.errorsContainer).toString()}get navigationButtonsVisibility(){const e=this.showNavigationButtons;return e==null?"inherit":e?"show":"hide"}set navigationButtonsVisibility(e){this.showNavigationButtons=e}get showNavigationButtons(){return this.getPropertyValue("showNavigationButtons",void 0)}set showNavigationButtons(e){this.setShowNavigationButtonsProperty(e)}setShowNavigationButtonsProperty(e){typeof e=="string"&&(e=e.toLowerCase()),e===!0||e===!1?this.setPropertyValue("showNavigationButtons",e):e==="show"?this.setPropertyValue("showNavigationButtons",!0):e==="hide"?this.setPropertyValue("showNavigationButtons",!1):this.setPropertyValue("showNavigationButtons",void 0)}get isActive(){return!!this.survey&&this.survey.currentPage===this}get wasShown(){return this.wasRendered}get hasShown(){return this.wasRendered}setWasShown(e){e||this.resetWasRendered()}onFirstRenderingCore(){var e;if(super.onFirstRenderingCore(),!this.isDesignMode){for(var t=this.elements,s=0;s<t.length;s++)t[s].isPanel&&t[s].randomizeElements(this.areQuestionsRandomized);if(this.randomizeElements(this.areQuestionsRandomized)){const i=(e=this.survey)===null||e===void 0?void 0:e.currentSingleElement;i?.page===this&&(this.survey.currentSingleElement=this.getFirstVisibleElement())}}}scrollToTop(){this.survey&&this.survey.scrollElementToTop(this,null,this,this.id,!1,{block:"start"})}getAllPanels(e=!1,t=!1){var s=new Array;return this.addPanelsIntoList(s,e,t),s}getPanels(e=!1,t=!1){return this.getAllPanels(e,t)}get timeLimit(){return this.getPropertyValue("timeLimit",0)}set timeLimit(e){this.setPropertyValue("timeLimit",e)}get maxTimeToFinish(){return this.timeLimit}set maxTimeToFinish(e){this.timeLimit=e}getMaxTimeToFinish(){if(this.timeLimit!==0)return this.timeLimit;const e=this.survey?this.survey.timeLimitPerPage:0;return e>0?e:0}onNumChanged(e){}onVisibleChanged(){this.isRandomizing||(super.onVisibleChanged(),this.survey!=null&&this.survey.pageVisibilityChanged(this,this.isVisible))}ensureRowsVisibility(){super.ensureRowsVisibility(),this.getPanels().forEach(e=>e.ensureRowsVisibility())}get isReadyForClean(){return this._isReadyForClean}set isReadyForClean(e){const t=this._isReadyForClean;this._isReadyForClean=e,this._isReadyForClean!==t&&this.isReadyForCleanChangedCallback&&this.isReadyForCleanChangedCallback()}enableOnElementRerenderedEvent(){super.enableOnElementRerenderedEvent(),this.isReadyForClean=!1}disableOnElementRerenderedEvent(){super.disableOnElementRerenderedEvent(),this.isReadyForClean=!0}};S([E({defaultValue:-1,onSet:(n,e)=>e.onNumChanged(n)})],sh.prototype,"num",void 0),q.addClass("page",[{name:"showNavigationButtons:boolean",defaultFunc:()=>{},onSetValue:function(n,e){n&&n.setShowNavigationButtonsProperty(e)},alternativeName:"navigationButtonsVisibility"},{name:"timeLimit:number",alternativeName:"maxTimeToFinish",default:0,minValue:0,visibleIf:n=>!!n.survey&&n.survey.showTimer},{name:"navigationTitle",serializationProperty:"locNavigationTitle"},{name:"navigationDescription",visibleIf:function(n){return!!n.survey&&n.survey.progressBarType==="buttons"},serializationProperty:"locNavigationDescription"},{name:"title:text",serializationProperty:"locTitle"},{name:"description:text",serializationProperty:"locDescription"},{name:"state",visible:!1},{name:"isRequired",visible:!1},{name:"startWithNewLine",visible:!1},{name:"width",visible:!1},{name:"minWidth",visible:!1},{name:"maxWidth",visible:!1},{name:"colSpan",visible:!1,isSerializable:!1},{name:"effectiveColSpan:number",visible:!1,isSerializable:!1},{name:"innerIndent",visible:!1},{name:"indent",visible:!1},{name:"page",visible:!1,isSerializable:!1},{name:"showNumber",visible:!1},{name:"showQuestionNumbers",visible:!1},{name:"allowAdaptiveActions",visible:!1},{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText",visible:!1}],function(){return new sh},"panel");let GP=class extends Te{constructor(e){super(),this.survey=e,this.onResize=this.addEvent()}isListElementClickable(e){return!this.survey.onServerValidateQuestions||this.survey.onServerValidateQuestions.isEmpty||this.survey.checkErrorsMode==="onComplete"?!0:e<=this.survey.currentPageNo+1}getRootCss(e="center"){let t=this.survey.css.progressButtonsContainerCenter;return this.survey.css.progressButtonsRoot&&(t+=" "+this.survey.css.progressButtonsRoot+" "+this.survey.css.progressButtonsRoot+"--"+(["footer","contentBottom"].indexOf(e)!==-1?"bottom":"top"),t+=" "+this.survey.css.progressButtonsRoot+"--"+(this.showItemTitles?"with-titles":"no-titles")),this.showItemNumbers&&this.survey.css.progressButtonsNumbered&&(t+=" "+this.survey.css.progressButtonsNumbered),this.isFitToSurveyWidth&&(t+=" "+this.survey.css.progressButtonsFitSurveyWidth),t}getListElementCss(e){if(!(e>=this.survey.visiblePages.length))return new z().append(this.survey.css.progressButtonsListElementPassed,this.survey.visiblePages[e].passed).append(this.survey.css.progressButtonsListElementCurrent,this.survey.currentPageNo===e).append(this.survey.css.progressButtonsListElementNonClickable,!this.isListElementClickable(e)).toString()}getScrollButtonCss(e,t){return new z().append(this.survey.css.progressButtonsImageButtonLeft,t).append(this.survey.css.progressButtonsImageButtonRight,!t).append(this.survey.css.progressButtonsImageButtonHidden,!e).toString()}clickListElement(e){e instanceof sh||(e=this.survey.visiblePages[e]),this.survey.tryNavigateToPage(e)}isListContainerHasScroller(e){const t=e.querySelector("."+this.survey.css.progressButtonsListContainer);return t?t.scrollWidth>t.offsetWidth:!1}isCanShowItemTitles(e){const t=e.querySelector("ul");if(!t||t.children.length<2)return!0;if(t.clientWidth>t.parentElement.clientWidth)return!1;const s=t.children[0].clientWidth;for(let i=0;i<t.children.length;i++)if(Math.abs(t.children[i].clientWidth-s)>5)return!1;return!0}clearConnectorsWidth(e){const t=e.querySelectorAll(".sd-progress-buttons__connector");for(let s=0;s<t.length;s++)t[s].style.width=""}adjustConnectors(e){const t=e.querySelector("ul");if(!t)return;const s=e.querySelectorAll(".sd-progress-buttons__connector"),i=this.showItemNumbers?36:20,r=(t.clientWidth-i)/(t.children.length-1)-i;for(let a=0;a<s.length;a++)s[a].style.width=r+"px"}get isFitToSurveyWidth(){return xr.currentType!=="default"?!1:this.survey.progressBarInheritWidthFrom==="survey"&&this.survey.widthMode=="static"}get progressWidth(){return this.isFitToSurveyWidth?this.survey.renderedWidth:""}get showItemNumbers(){return xr.currentType!=="default"?!1:this.survey.progressBarShowPageNumbers}get showItemTitles(){return xr.currentType!=="default"?!0:this.survey.progressBarShowPageTitles}getItemNumber(e){let t="";return this.showItemNumbers&&(t+=this.survey.visiblePages.indexOf(e)+1),t}get headerText(){return this.survey.currentPage?this.survey.currentPage.renderedNavigationTitle:""}get footerText(){return this.progressText}get progressText(){return this.getPropertyValue("progressText",void 0,()=>this.survey.getProgressText())}get progressBarAriaLabel(){return Ct("progressbar",this.survey.getLocale())}resetProgressText(){this.resetPropertyValue("progressText")}processResponsiveness(e){this.onResize.fire(this,{width:e})}},JP=class{constructor(e,t,s){this.model=e,this.element=t,this.viewModel=s,this.criticalProperties=["progressBarType","progressBarShowPageTitles"],this.canShowItemTitles=!0,this.processResponsiveness=(i,r)=>{if(this.viewModel.onUpdateScroller(i.isListContainerHasScroller(this.element)),this.model.clearConnectorsWidth(this.element),!i.showItemTitles){this.model.adjustConnectors(this.element);return}if(i.survey.isMobile){this.prevWidth=r.width,this.canShowItemTitles=!1,this.model.adjustConnectors(this.element),this.viewModel.onResize(this.canShowItemTitles);return}this.timer!==void 0&&clearTimeout(this.timer),this.timer=setTimeout(()=>{(this.prevWidth===void 0||this.prevWidth<r.width&&!this.canShowItemTitles||this.prevWidth>r.width&&this.canShowItemTitles)&&(this.prevWidth=r.width,this.canShowItemTitles=i.isCanShowItemTitles(this.element),this.viewModel.onResize(this.canShowItemTitles),this.timer=void 0)},10)},this.model.survey.registerFunctionOnPropertiesValueChanged(this.criticalProperties,()=>this.forceUpdate(),"ProgressButtonsResponsivityManager"+this.viewModel.container),this.model.onResize.add(this.processResponsiveness),this.forceUpdate()}forceUpdate(){this.viewModel.onUpdateSettings(),this.processResponsiveness(this.model,{})}dispose(){clearTimeout(this.timer),this.model.onResize.remove(this.processResponsiveness),this.model.survey.unRegisterFunctionOnPropertiesValueChanged(this.criticalProperties,"ProgressButtonsResponsivityManager"+this.viewModel.container),this.element=void 0,this.model=void 0}};function KP(n,e){return n.isDesignMode||e.focusFirstQuestion(),!0}function jy(n){if(n.parentQuestion)return jy(n.parentQuestion);let e=n.parent;for(;e&&e.getType()!=="page"&&e.parent;)e=e.parent;return e&&e.getType()==="page"?e:null}function ZP(n,e){var t=Uy(n,e);const s={items:t,searchEnabled:!1,locOwner:n,listRole:"menu",listItemRole:"menuitemradio",listAriaLabel:Ct("toc",n.getLocale())};var i=new dt(s);i.allowSelection=!1;const r=(o,l)=>{i.selectedItem=!!o&&i.actions.filter(u=>u.id===o.name)[0]||l};r(n.currentPage,t[0]),n.onCurrentPageChanged.add((o,l)=>{r(n.currentPage)}),n.onFocusInQuestion.add((o,l)=>{r(jy(l.question))});const a=()=>{i.setItems(Uy(n,e))};return n.registerFunctionOnPropertyValueChanged("pages",a,"toc"),n.onEndLoadingFromJson.add(a),i}function Uy(n,e){var s=(n.pages||[]).map(i=>new Pe({id:i.name,locTitle:i.locNavigationTitle,action:()=>{if(ge.activeElementBlur(),e&&e(),i.isPage)return n.tryNavigateToPage(i);if(i.isPanel)return KP(n,i)},visible:new We(()=>i.isVisible&&!i.isStartPage)}));return s}function YP(n,e=!1){let t=Ri.RootStyle;return e?t+" "+Ri.RootStyle+"--mobile":(t+=" "+Ri.RootStyle+"--"+(n.tocLocation||"").toLowerCase(),Ri.StickyPosition&&(t+=" "+Ri.RootStyle+"--sticky"),t)}let Ri=class _a{constructor(e){this.survey=e,this.icon="icon-navmenu_24x24",this.togglePopup=()=>{this.popupModel.toggleVisibility()},this.listModel=ZP(e,()=>{this.popupModel.isVisible=!1}),this.popupModel=new Lt("sv-list",{model:this.listModel}),this.popupModel.overlayDisplayMode="tablet-dropdown-overlay",this.popupModel.displayMode=new We(()=>this.isMobile?"overlay":"popup"),_a.StickyPosition&&(e.onAfterRenderSurvey.add((t,s)=>this.initStickyTOCSubscriptions(s.htmlElement)),this.initStickyTOCSubscriptions(e.rootElement))}initStickyTOCSubscriptions(e){_a.StickyPosition&&e&&(e.addEventListener("scroll",t=>{this.updateStickyTOCSize(e)}),this.updateStickyTOCSize(e))}updateStickyTOCSize(e){if(!e)return;const t=e.querySelector("."+_a.RootStyle);if(t&&(t.style.height="",!this.isMobile&&_a.StickyPosition&&e)){const s=e.getBoundingClientRect().height,i=this.survey.findLayoutElement("advanced-header"),r=i&&i.data;let a=!r||r.hasBackground;const o=this.survey.headerView==="advanced"?".sv-header":".sv_custom_header+div div."+(this.survey.css.title||"sd-title"),l=e.querySelector(o),u=l&&a?l.getBoundingClientRect().height:0,d=e.querySelector(".sv-scroll__scroller")||e,h=d.scrollTop>u?0:u-d.scrollTop;t.style.height=s-h-1+"px"}}get isMobile(){return this.survey.isMobile}get containerCss(){return YP(this.survey,this.isMobile)}dispose(){const[e]=this.survey.unRegisterFunctionOnPropertyValueChanged("pages","toc");this.survey.onEndLoadingFromJson.remove(e),this.survey.onPageAdded.remove(e),this.popupModel.dispose(),this.listModel.dispose()}};Ri.RootStyle="sv_progress-toc",Ri.StickyPosition=!0;let XP=class extends ji{constructor(e,t,s){super(),this.survey=e,this.valuesHash=t,this.variablesHash=s}getValue(e,t,s,i){if(e.length===1){const a=e[0].name;let o=this.getBuiltInVariableValue(a);if(a==="locale"&&(o=this.survey.locale||is.defaultLocale),o!==void 0)return{value:o,isFound:!0}}let r=new fs(this.variablesHash).getValue(e,t,s,i);return r&&r.isFound||(r=super.getValue(e,t,s,i),r&&r.isFound)?r:new fs(this.valuesHash).getValue(e,t,s,i)}updateValueByItem(e,t){const s=A.expressionVariables.unwrapPostfix,i=e.endsWith(s);i&&(e=e.substring(0,e.length-s.length));const r=this.survey.getQuestionByValueName(e,!0);r&&(t.isFound=!0,t.context=r.getValueGetterContext(i))}isSearchNameRevert(){return!0}getBuiltInVariableValue(e){const t=this.survey;if(e=e.toLocaleLowerCase(),e==="pageno"){var s=t.currentPage;return s!=null?t.visiblePages.indexOf(s)+1:0}if(e==="pagecount")return t.visiblePageCount;if(e==="correctedanswers"||e==="correctanswers"||e==="correctedanswercount")return t.getCorrectedAnswerCount();if(e==="incorrectedanswers"||e==="incorrectanswers"||e==="incorrectedanswercount")return t.getInCorrectedAnswerCount();if(e==="questioncount")return t.getQuizQuestionCount()}},Ee=class Kr extends $a{get platformName(){return Kr.platform}get commentSuffix(){return A.commentSuffix}set commentSuffix(e){A.commentSuffix=e}get commentPrefix(){return this.commentSuffix}set commentPrefix(e){this.commentSuffix=e}constructor(e=null,t=null){super(),this.valuesHash={},this.variablesHash={},this.onEndLoadingFromJson=this.addEvent(),this.onTriggerExecuted=this.addEvent(),this.onCompleting=this.addEvent(),this.onComplete=this.addEvent(),this.onShowingPreview=this.addEvent(),this.onNavigateToUrl=this.addEvent(),this.onStarted=this.addEvent(),this.onPartialSend=this.addEvent(),this.onCurrentPageChanging=this.addEvent(),this.onCurrentPageChanged=this.addEvent(),this.onValueChanging=this.addEvent(),this.onValueChanged=this.addEvent(),this.onVariableChanged=this.addEvent(),this.onQuestionVisibleChanged=this.addEvent(),this.onVisibleChanged=this.onQuestionVisibleChanged,this.onPageVisibleChanged=this.addEvent(),this.onPanelVisibleChanged=this.addEvent(),this.onQuestionCreated=this.addEvent(),this.onQuestionAdded=this.addEvent(),this.onQuestionRemoved=this.addEvent(),this.onPanelAdded=this.addEvent(),this.onPanelRemoved=this.addEvent(),this.onPageAdded=this.addEvent(),this.onValidateQuestion=this.addEvent(),this.onSettingQuestionErrors=this.addEvent(),this.onServerValidateQuestions=this.addEvent(),this.onValidatePanel=this.addEvent(),this.onErrorCustomText=this.addEvent(),this.onValidatePage=this.addEvent(),this.onValidatedErrorsOnCurrentPage=this.onValidatePage,this.onProcessHtml=this.addEvent(),this.onGetQuestionDisplayValue=this.addEvent(),this.onGetQuestionTitle=this.addEvent(),this.onGetTitleTagName=this.addEvent(),this.onGetQuestionNumber=this.addEvent(),this.onGetQuestionNo=this.onGetQuestionNumber,this.onGetPanelNumber=this.addEvent(),this.onGetPageNumber=this.addEvent(),this.onGetProgressText=this.addEvent(),this.onProgressText=this.onGetProgressText,this.onTextMarkdown=this.addEvent(),this.onTextRenderAs=this.addEvent(),this.onSendResult=this.addEvent(),this.onGetResult=this.addEvent(),this.onOpenFileChooser=this.addEvent(),this.onUploadFiles=this.addEvent(),this.onDownloadFile=this.addEvent(),this.onClearFiles=this.addEvent(),this.onChoicesLoaded=this.addEvent(),this.onLoadChoicesFromServer=this.onChoicesLoaded,this.onLoadedSurveyFromService=this.addEvent(),this.onProcessDynamicText=this.addEvent(),this.onProcessTextValue=this.onProcessDynamicText,this.onUpdateQuestionCssClasses=this.addEvent(),this.onUpdatePanelCssClasses=this.addEvent(),this.onUpdatePageCssClasses=this.addEvent(),this.onUpdateChoiceItemCss=this.addEvent(),this.onAfterRenderSurvey=this.addEvent(),this.onAfterRenderHeader=this.addEvent(),this.onAfterRenderPage=this.addEvent(),this.onAfterRenderQuestion=this.addEvent(),this.onAfterRenderQuestionInput=this.addEvent(),this.onAfterRenderPanel=this.addEvent(),this.onFocusInQuestion=this.addEvent(),this.onFocusInPanel=this.addEvent(),this.onShowingChoiceItem=this.addEvent(),this.onChoicesLazyLoad=this.addEvent(),this.onChoicesSearch=this.addEvent(),this.onGetChoiceDisplayValue=this.addEvent(),this.onMatrixRowAdded=this.addEvent(),this.onMatrixRowAdding=this.addEvent(),this.onMatrixBeforeRowAdded=this.onMatrixRowAdding,this.onMatrixRowRemoving=this.addEvent(),this.onMatrixRowRemoved=this.addEvent(),this.onMatrixRenderRemoveButton=this.addEvent(),this.onMatrixAllowRemoveRow=this.onMatrixRenderRemoveButton,this.onMatrixDetailPanelVisibleChanged=this.addEvent(),this.onMatrixCellCreating=this.addEvent(),this.onMatrixCellCreated=this.addEvent(),this.onAfterRenderMatrixCell=this.addEvent(),this.onMatrixAfterCellRender=this.onAfterRenderMatrixCell,this.onMatrixCellValueChanged=this.addEvent(),this.onMatrixCellValueChanging=this.addEvent(),this.onMatrixCellValidate=this.addEvent(),this.onMatrixColumnAdded=this.addEvent(),this.onMultipleTextItemAdded=this.addEvent(),this.onDynamicPanelAdded=this.addEvent(),this.onDynamicPanelRemoved=this.addEvent(),this.onDynamicPanelRemoving=this.addEvent(),this.onTimerTick=this.addEvent(),this.onTimer=this.onTimerTick,this.onTimerPanelInfoText=this.addEvent(),this.onDynamicPanelValueChanged=this.addEvent(),this.onDynamicPanelItemValueChanged=this.onDynamicPanelValueChanged,this.onDynamicPanelValueChanging=this.addEvent(),this.onGetDynamicPanelTabTitle=this.addEvent(),this.onDynamicPanelCurrentIndexChanged=this.addEvent(),this.onCheckAnswerCorrect=this.addEvent(),this.onIsAnswerCorrect=this.onCheckAnswerCorrect,this.onDragDropAllow=this.addEvent(),this.onMatrixRowDragOver=this.addEvent(),this.onExpressionRunning=this.addEvent(),this.onScrollToTop=this.addEvent(),this.onScrollingElementToTop=this.onScrollToTop,this.onLocaleChangedEvent=this.addEvent(),this.onGetQuestionTitleActions=this.addEvent(),this.onGetPanelTitleActions=this.addEvent(),this.onGetPageTitleActions=this.addEvent(),this.onGetPanelFooterActions=this.addEvent(),this.onGetMatrixRowActions=this.addEvent(),this.onElementContentVisibilityChanged=this.addEvent(),this.onGetExpressionDisplayValue=this.addEvent(),this.onCheckSingleInputPerPageMode=this.addEvent(),this.onGetLoopQuestions=this.addEvent(),this.onPopupVisibleChanged=this.addEvent(),this.onOpenDropdownMenu=this.addEvent(),this.onElementWrapperComponentName=this.addEvent(),this.onElementWrapperComponentData=this.addEvent(),this.onCreateCustomChoiceItem=this.addEvent(),this.jsonErrors=null,this.cssValue=null,this.showHeaderOnCompletePage="auto",this._isLazyRenderingSuspended=!1,this.hideRequiredErrors=!1,this.cssVariables={},this._isMobile=!1,this._isCompact=!1,this.setValueOnExpressionCounter=0,this._isDesignMode=!1,this.validationAllowSwitchPages=!1,this.validationAllowComplete=!1,this.isNavigationButtonPressed=!1,this.mouseDownPage=null,this.isSmoothScrollEnabled=!1,this.onResize=new Zt,this.isCurrentPageRendering=!0,this.isCurrentPageRendered=void 0,this.skeletonHeight=void 0,this.isTriggerIsRunning=!1,this.triggerKeys=null,this.isValueChangedOnRunningCondition=!1,this.conditionRunnerCounter=0,this.conditionUpdateVisibleIndexes=!1,this.conditionNotifyElementsOnAnyValueOrVariableChanged=!1,this.isEndLoadingFromJson=null,this.nofifyQuesitonHash={},this.questionHashes={names:{},namesInsensitive:{},valueNames:{},valueNamesInsensitive:{}},this.setValueFromTriggerCounter=0,this.isMovingPage=!1,this.needRenderIcons=!0,this.skippedPages=[],this.skeletonComponentName="sv-skeleton",this.taskManager=new zy,this.questionErrorComponent="sv-question-error",this.onBeforeRunConstructor(),this.createHtmlLocString("completedHtml","completingSurvey"),this.createHtmlLocString("completedBeforeHtml","completingSurveyBefore","completed-before"),this.createHtmlLocString("loadingHtml","loadingSurvey","loading"),this.createLocalizableString("emptySurveyText",this,!0,"emptySurvey"),this.createLocalizableString("logo"),this.createLocString({name:"startSurveyText",hasTranslation:!0}),this.createLocString({name:"pagePrevText",hasTranslation:!0}),this.createLocString({name:"pageNextText",hasTranslation:!0}),this.createLocString({name:"completeText",hasTranslation:!0}),this.createLocString({name:"previewText",hasTranslation:!0}),this.createLocString({name:"editText",hasTranslation:!0}),this.createLocalizableString("questionTitleTemplate",this,!0),this.timerModelValue=new Vr(this),this.timerModelValue.onTimerTick=s=>{this.doTimer(s)},this.createNewArray("pages",s=>{s.isReadyForCleanChangedCallback&&s.isReadyForCleanChangedCallback(),this.doOnPageAdded(s)},s=>{s.isReadyForClean?this.doOnPageRemoved(s):s.isReadyForCleanChangedCallback=()=>{this.doOnPageRemoved(s),s.isReadyForCleanChangedCallback=void 0}}),this.createNewArray("triggers",s=>{s.setOwner(this)}),this.createNewArray("calculatedValues",s=>{s.setOwner(this)}),this.createNewArray("completedHtmlOnCondition",s=>{s.locOwner=this}),this.createNewArray("navigateToUrlOnCondition",s=>{s.locOwner=this}),this.registerPropertyChangedHandlers(["locale"],()=>{this.onSurveyLocaleChanged()}),this.registerPropertyChangedHandlers(["firstPageIsStartPage"],()=>{this.onFirstPageIsStartedChanged()}),this.registerPropertyChangedHandlers(["readOnly"],()=>{this.onReadOnlyChanged()}),this.registerPropertyChangedHandlers(["progressBarType"],()=>{this.updateProgressText()}),this.registerPropertyChangedHandlers(["questionStartIndex","requiredMark","questionTitlePattern"],()=>{this.resetVisibleIndexes()}),this.registerPropertyChangedHandlers(["isLoading","isCompleted","isCompletedBefore","readOnly","isStartedState","currentPage","isShowingPreview"],()=>{this.updateState()}),this.registerPropertyChangedHandlers(["state","currentPage","showPreviewBeforeComplete"],()=>{this.onStateAndCurrentPageChanged()}),this.registerPropertyChangedHandlers(["logo","logoPosition"],()=>{this.resetHasLogo()}),this.registerPropertyChangedHandlers(["backgroundImage"],()=>{this.resetPropertyValue("renderBackgroundImage")}),this.registerPropertyChangedHandlers(["backgroundImage","backgroundOpacity","backgroundImageFit","fitToContainer","backgroundImageAttachment"],()=>{this.resetPropertyValue("backgroundImageStyle")}),this.registerPropertyChangedHandlers(["showPrevButton","showCompleteButton"],()=>{this.updateButtonsVisibility()}),this.onGetQuestionNumber.onCallbacksChanged=()=>{this.resetVisibleIndexes()},this.onGetPanelNumber.onCallbacksChanged=()=>{this.resetVisibleIndexes()},this.onGetProgressText.onCallbacksChanged=()=>{this.updateProgressText()},this.onTextMarkdown.onCallbacksChanged=()=>{this.locStrsChanged()},this.onProcessHtml.onCallbacksChanged=()=>{this.locStrsChanged()},this.onGetQuestionTitle.onCallbacksChanged=()=>{this.locStrsChanged()},this.onUpdatePageCssClasses.onCallbacksChanged=()=>{this.currentPage&&this.currentPage.updateElementCss()},this.onUpdatePanelCssClasses.onCallbacksChanged=()=>{this.currentPage&&this.currentPage.updateElementCss()},this.onUpdateQuestionCssClasses.onCallbacksChanged=()=>{this.currentPage&&this.currentPage.updateElementCss()},this.onShowingChoiceItem.onCallbacksChanged=()=>{this.rebuildQuestionChoices()},this.locTitle.onStringChanged.add(()=>this.resetPropertyValue("titleIsEmpty")),this.onBeforeCreating(),e&&((typeof e=="string"||e instanceof String)&&(e=JSON.parse(e)),e&&e.clientId&&(this.clientId=e.clientId),this.fromJSON(e),this.surveyId&&this.loadSurveyFromService(this.surveyId,this.clientId)),this.onCreating(),t&&this.render(t),this.updateCss(),this.setCalculatedWidthModeUpdater(),this.notifier=new nn(this.css.saveData),this.notifier.addAction(this.createTryAgainAction(),"error"),this.onPopupVisibleChanged.add((s,i)=>{i.visible?this.onScrollCallback=()=>{i.popup.hide()}:this.onScrollCallback=void 0}),this.layoutElements.push({id:"timerpanel",template:"survey-timerpanel",component:"sv-timerpanel",data:this.timerModel}),this.layoutElements.push({id:"progress-buttons",component:"sv-progress-buttons",getData:()=>this.progressBar,processResponsiveness:s=>this.progressBar.processResponsiveness&&this.progressBar.processResponsiveness(s)}),this.layoutElements.push({id:"progress-questions",component:"sv-progress-questions",data:this}),this.layoutElements.push({id:"progress-pages",component:"sv-progress-pages",data:this}),this.layoutElements.push({id:"progress-correctquestions",component:"sv-progress-correctquestions",data:this}),this.layoutElements.push({id:"progress-requiredquestions",component:"sv-progress-requiredquestions",data:this}),this.addLayoutElement({id:"toc-navigation",component:"sv-navigation-toc",getData:()=>this.tocModel,processResponsiveness:s=>this.tocModel.updateStickyTOCSize(this.rootElement)}),this.layoutElements.push({id:"buttons-navigation",component:"sv-action-bar",getData:()=>this.navigationBar}),this.layoutElements.push({id:"buttons-navigation-top",component:"sv-action-bar",getData:()=>this.navigationBar})}get tocModel(){return this.tocModelValue||(this.tocModelValue=new Ri(this)),this.tocModelValue}get sjsVersion(){return this.getPropertyValue("sjsVersion")}set sjsVersion(e){this.setPropertyValue("sjsVersion",e)}processClosedPopup(e,t){throw new Error("Method not implemented.")}createTryAgainAction(){return{id:"save-again",title:this.getLocalizationString("saveAgainButton"),action:()=>{this.isCompleted?this.saveDataOnComplete():this.doComplete()}}}createHtmlLocString(e,t,s){const i=this.createLocalizableString(e,this,!1,t);s&&(i.onGetTextCallback=r=>this.processHtml(r,s))}getType(){return"survey"}onPropertyValueChanged(e,t,s){e==="questionsOnPageMode"&&this.onQuestionsOnPageModeChanged(t)}get pages(){return this.getPropertyValue("pages")}render(e=null){this.renderCallback&&this.renderCallback()}updateSurvey(e,t){for(var s in e)if(!(s=="model"||s=="children"))if(s.indexOf("on")==0&&this[s]&&this[s].add){let i=e[s],r=function(a,o){i(a,o)};this[s].add(r)}else this[s]=e[s];e&&e.data&&this.onValueChanged.add((i,r)=>{e.data[r.name]=r.value})}getCss(){return this.css}updateCompletedPageCss(){this.containerCss=this.css.container,this.completedCss=new z().append(this.css.body).append(this.css.completedPage).toString(),this.completedBeforeCss=new z().append(this.css.body).append(this.css.completedBeforePage).toString(),this.loadingBodyCss=new z().append(this.css.body).append(this.css.bodyLoading).toString()}updateCss(){this.rootCss=this.getRootCss(),this.updateNavigationCss(),this.updateCompletedPageCss(),this.updateWrapperFormCss()}get css(){return this.cssValue||(this.cssValue={},this.copyCssClasses(this.cssValue,xr.getCss())),this.cssValue}set css(e){this.setCss(e)}setCss(e,t=!0){t?this.mergeValues(e,this.css):this.cssValue=e,this.updateElementCss(!1)}get cssTitle(){return this.css.title}get bodyCss(){return new z().append(this.css.body).append(this.css.bodyWithTimer,this.showTimer&&this.state==="running").append(this.css.body+"--"+this.calculatedWidthMode).toString()}get bodyContainerCss(){return this.css.bodyContainer}get cssNavigationComplete(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.complete)}get cssNavigationPreview(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.preview)}get cssNavigationEdit(){return this.getNavigationCss(this.css.navigationButton,this.css.navigation.edit)}get cssNavigationPrev(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.prev)}get cssNavigationStart(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.start)}get cssNavigationNext(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.next)}get cssSurveyNavigationButton(){return new z().append(this.css.navigationButton).append(this.css.bodyNavigationButton).toString()}insertAdvancedHeader(e){e.survey=this,this.layoutElements.push({id:"advanced-header",container:"header",component:"sv-header",index:-100,data:e,processResponsiveness:t=>e.processResponsiveness()})}get lazyRenderEnabled(){return this.lazyRenderEnabledValue===!0}set lazyRenderEnabled(e){if(this.lazyRenderEnabled===e)return;this.lazyRenderEnabledValue=e;const t=this.currentPage;t&&t.updateRows()}get lazyRendering(){return this.lazyRenderEnabled}set lazyRendering(e){this.lazyRenderEnabled=e}get isLazyRendering(){return this.lazyRenderEnabled||A.lazyRender.enabled}get lazyRenderFirstBatchSize(){return this.lazyRenderFirstBatchSizeValue||A.lazyRender.firstBatchSize}set lazyRenderFirstBatchSize(e){this.lazyRenderFirstBatchSizeValue=e}get isLazyRenderingSuspended(){return this._isLazyRenderingSuspended}suspendLazyRendering(){this.isLazyRendering&&(this._isLazyRenderingSuspended=!0)}releaseLazyRendering(){this.isLazyRendering&&(this._isLazyRenderingSuspended=!1)}updateLazyRenderingRowsOnRemovingElements(){var e,t;if(this.isLazyRendering){var s=this.currentPage;if(s){const i=(t=this.rootElement||((e=this.creator)===null||e===void 0?void 0:e.rootElement))===null||t===void 0?void 0:t.querySelector(`#${s.id}`);Fu(i)}}}get triggers(){return this.getPropertyValue("triggers")}set triggers(e){this.setPropertyValue("triggers",e)}get calculatedValues(){return this.getPropertyValue("calculatedValues")}set calculatedValues(e){this.setPropertyValue("calculatedValues",e)}get surveyId(){return this.getPropertyValue("surveyId","")}set surveyId(e){this.setPropertyValue("surveyId",e)}get surveyPostId(){return this.getPropertyValue("surveyPostId","")}set surveyPostId(e){this.setPropertyValue("surveyPostId",e)}get clientId(){return this.getPropertyValue("clientId","")}set clientId(e){this.setPropertyValue("clientId",e)}get cookieName(){return this.getPropertyValue("cookieName","")}set cookieName(e){this.setPropertyValue("cookieName",e)}get partialSendEnabled(){return this.getPropertyValue("partialSendEnabled")}set partialSendEnabled(e){this.setPropertyValue("partialSendEnabled",e)}get sendResultOnPageNext(){return this.partialSendEnabled}set sendResultOnPageNext(e){this.partialSendEnabled=e}get surveyShowDataSaving(){return this.getPropertyValue("surveyShowDataSaving")}set surveyShowDataSaving(e){this.setPropertyValue("surveyShowDataSaving",e)}get autoFocusFirstQuestion(){return this.getPropertyValue("autoFocusFirstQuestion")}set autoFocusFirstQuestion(e){this.setPropertyValue("autoFocusFirstQuestion",e)}get focusFirstQuestionAutomatic(){return this.autoFocusFirstQuestion}set focusFirstQuestionAutomatic(e){this.autoFocusFirstQuestion=e}get autoFocusFirstError(){return this.getPropertyValue("autoFocusFirstError")}set autoFocusFirstError(e){this.setPropertyValue("autoFocusFirstError",e)}get focusOnFirstError(){return this.autoFocusFirstError}set focusOnFirstError(e){this.autoFocusFirstError=e}get showNavigationButtons(){return this.getPropertyValue("showNavigationButtons")}set showNavigationButtons(e){e==="both"&&(e="topBottom");const t=["top","bottom","topBottom"].indexOf(e)>-1,s=e===!0||t;this.setPropertyValue("showNavigationButtons",s),t&&(this.navigationButtonsLocation=e)}get navigationButtonsLocation(){return this.getPropertyValue("navigationButtonsLocation")}set navigationButtonsLocation(e){this.setPropertyValue("navigationButtonsLocation",e)}get showPrevButton(){return this.getPropertyValue("showPrevButton")}set showPrevButton(e){this.setPropertyValue("showPrevButton",e)}get showCompleteButton(){return this.getPropertyValue("showCompleteButton",!0)}set showCompleteButton(e){this.setPropertyValue("showCompleteButton",e)}get showTOC(){return this.getPropertyValue("showTOC")}set showTOC(e){this.setPropertyValue("showTOC",e)}get tocLocation(){return this.getPropertyValue("tocLocation")}set tocLocation(e){this.setPropertyValue("tocLocation",e)}get showTitle(){return this.getPropertyValue("showTitle")}set showTitle(e){this.setPropertyValue("showTitle",e)}get showPageTitles(){return this.getPropertyValue("showPageTitles")}set showPageTitles(e){this.setPropertyValue("showPageTitles",e)}get showCompletePage(){return this.getPropertyValue("showCompletePage")}set showCompletePage(e){this.setPropertyValue("showCompletePage",e)}get showCompletedPage(){return this.showCompletePage}set showCompletedPage(e){this.showCompletePage=e}get navigateToUrl(){return this.getPropertyValue("navigateToUrl")}set navigateToUrl(e){this.setPropertyValue("navigateToUrl",e)}get navigateToUrlOnCondition(){return this.getPropertyValue("navigateToUrlOnCondition")}set navigateToUrlOnCondition(e){this.setPropertyValue("navigateToUrlOnCondition",e)}getNavigateToUrl(){var e=this.getExpressionItemOnRunCondition(this.navigateToUrlOnCondition),t=e?e.url:this.navigateToUrl;return t&&(t=this.processText(t,!1)),t}navigateTo(){var e=this.getNavigateToUrl(),t={url:e,allow:!0};this.onNavigateToUrl.fire(this,t),!(!t.url||!t.allow)&&W2(t.url)}get requiredMark(){return this.getPropertyValue("requiredMark")}set requiredMark(e){this.setPropertyValue("requiredMark",e)}get requiredText(){return this.requiredMark}set requiredText(e){this.requiredMark=e}beforeSettingQuestionErrors(e,t){this.makeRequiredErrorsInvisible(t),this.onSettingQuestionErrors.fire(this,{question:e,errors:t})}makeRequiredErrorsInvisible(e){if(this.hideRequiredErrors)for(var t=0;t<e.length;t++){var s=e[t].getErrorType();(s=="required"||s=="requireoneanswer")&&(e[t].visible=!1)}}get questionStartIndex(){return this.getPropertyValue("questionStartIndex")||""}set questionStartIndex(e){this.setPropertyValue("questionStartIndex",e)}getQuestionStartIndex(e){if(e>=0&&e<this.visiblePages.length)for(let t=e;t>=0;t--){const s=this.visiblePages[t];if(s.questionStartIndex)return s.questionStartIndex}return this.questionStartIndex}get storeOthersAsComment(){return this.getPropertyValue("storeOthersAsComment")}set storeOthersAsComment(e){this.setPropertyValue("storeOthersAsComment",e)}get maxTextLength(){return this.getPropertyValue("maxTextLength")}set maxTextLength(e){this.setPropertyValue("maxTextLength",e)}get maxCommentLength(){return this.getPropertyValue("maxCommentLength")}set maxCommentLength(e){this.setPropertyValue("maxCommentLength",e)}get maxOthersLength(){return this.maxCommentLength}set maxOthersLength(e){this.maxCommentLength=e}get autoAdvanceEnabled(){return this.getPropertyValue("autoAdvanceEnabled")}set autoAdvanceEnabled(e){this.setPropertyValue("autoAdvanceEnabled",e)}get goNextPageAutomatic(){return this.autoAdvanceEnabled}set goNextPageAutomatic(e){this.autoAdvanceEnabled=e}get autoAdvanceAllowComplete(){return this.getPropertyValue("autoAdvanceAllowComplete")}set autoAdvanceAllowComplete(e){this.setPropertyValue("autoAdvanceAllowComplete",e)}get allowCompleteSurveyAutomatic(){return this.autoAdvanceAllowComplete}set allowCompleteSurveyAutomatic(e){this.autoAdvanceAllowComplete=e}get checkErrorsMode(){return this.getPropertyValue("checkErrorsMode")}set checkErrorsMode(e){this.setPropertyValue("checkErrorsMode",e)}get validateVisitedEmptyFields(){return this.getPropertyValue("validateVisitedEmptyFields")}set validateVisitedEmptyFields(e){this.setPropertyValue("validateVisitedEmptyFields",e)}getValidateVisitedEmptyFields(){return this.validateVisitedEmptyFields&&this.isValidateOnValueChange}get autoGrowComment(){return this.getPropertyValue("autoGrowComment")}set autoGrowComment(e){this.setPropertyValue("autoGrowComment",e)}get allowResizeComment(){return this.getPropertyValue("allowResizeComment")}set allowResizeComment(e){this.setPropertyValue("allowResizeComment",e)}get commentAreaRows(){return this.getPropertyValue("commentAreaRows")}set commentAreaRows(e){this.setPropertyValue("commentAreaRows",e)}get textUpdateMode(){return this.getPropertyValue("textUpdateMode")}set textUpdateMode(e){this.setPropertyValue("textUpdateMode",e)}get clearInvisibleValues(){return this.getPropertyValue("clearInvisibleValues")}set clearInvisibleValues(e){e===!0&&(e="onComplete"),e===!1&&(e="none"),this.setPropertyValue("clearInvisibleValues",e)}clearIncorrectValues(e=!1){for(var t=0;t<this.pages.length;t++)this.pages[t].clearIncorrectValues();if(e){var s=this.data,i=!1;for(var r in s)if(!this.getQuestionByValueName(r)&&!(this.iscorrectValueWithPostPrefix(r,A.commentSuffix)||this.iscorrectValueWithPostPrefix(r,A.matrix.totalsSuffix))){var a=this.getCalculatedValueByName(r);a&&a.includeIntoResult||(i=!0,delete s[r])}i&&(this.data=s)}}iscorrectValueWithPostPrefix(e,t){return e.indexOf(t)!==e.length-t.length?!1:!!this.getQuestionByValueName(e.substring(0,e.indexOf(t)))}get keepIncorrectValues(){return this.getPropertyValue("keepIncorrectValues")}set keepIncorrectValues(e){this.setPropertyValue("keepIncorrectValues",e)}get locale(){return this.getPropertyValueWithoutDefault("locale")||is.currentLocale}set locale(e){e===is.defaultLocale&&!is.currentLocale&&(e=""),this.setPropertyValue("locale",e)}onSurveyLocaleChanged(){this.notifyElementsOnAnyValueOrVariableChanged("locale"),this.localeChanged(),this.onLocaleChangedEvent.fire(this,this.locale)}get localeDir(){return is.localeDirections[this.locale]}getUsedLocales(){var e=new Array;this.addUsedLocales(e);var t=e.indexOf("default");if(t>-1){var s=is.defaultLocale,i=e.indexOf(s);i>-1&&e.splice(i,1),t=e.indexOf("default"),e[t]=s}return e}localeChanged(){for(var e=0;e<this.pages.length;e++)this.pages[e].localeChanged()}getLocale(){return this.locale}locStrsChanged(){var e;if(!this.isClearingUnsedValues&&(super.locStrsChanged(),!!this.currentPage)){if(this.isDesignMode)this.pages.forEach(i=>i.locStrsChanged());else{var t=this.activePage;t&&t.locStrsChanged();const i=this.visiblePages;for(var s=0;s<i.length;s++)i[s].navigationLocStrChanged()}this.isStartPageActive||this.updateProgressText(),(e=this.navigationBarValue)===null||e===void 0||e.locStrsChanged()}}getMarkdownHtml(e,t,s){return this.getSurveyMarkdownHtml(this,e,t,s)}getRenderer(e){return this.getRendererForString(this,e)}getRendererContext(e){return this.getRendererContextForString(this,e)}getRendererForString(e,t,s){let i=this.getBuiltInRendererForString(e,t,s);i=this.elementWrapperComponentNameCore(i,e,"string",t);const r={element:e,name:t,renderAs:i};return this.onTextRenderAs.fire(this,r),r.renderAs}getRendererContextForString(e,t,s){return this.elementWrapperDataCore(t,e,"string")}getExpressionDisplayValue(e,t,s){const i={question:e,value:t,displayValue:s};return this.onGetExpressionDisplayValue.fire(this,i),i.displayValue}getBuiltInRendererForString(e,t,s){if(this.isDesignMode)return At.editableRenderer}getProcessedText(e){return this.processText(e,!0)}getLocString(e){return this.getLocalizationString(e)}getErrorCustomText(e,t){return this.getSurveyErrorCustomText(this,e,t)}getSurveyErrorCustomText(e,t,s){const i={text:t,name:s.getErrorType(),obj:e,error:s};return this.onErrorCustomText.fire(this,i),i.text}getQuestionDisplayValue(e,t){const s={question:e,displayValue:t};return this.onGetQuestionDisplayValue.fire(this,s),s.displayValue}get emptySurveyText(){return this.getLocalizableStringText("emptySurveyText")}set emptySurveyText(e){this.setLocalizableStringText("emptySurveyText",e)}get logo(){return this.getLocalizableStringText("logo")}set logo(e){this.setLocalizableStringText("logo",e)}get locLogo(){return this.getLocalizableString("logo")}get logoWidth(){return this.getPropertyValue("logoWidth")}set logoWidth(e){this.setPropertyValue("logoWidth",e)}get renderedLogoWidth(){return this.logoWidth?$i(this.logoWidth):void 0}get renderedStyleLogoWidth(){return this.logoWidth?Ya(this.logoWidth):void 0}get logoHeight(){return this.getPropertyValue("logoHeight")}set logoHeight(e){this.setPropertyValue("logoHeight",e)}get renderedLogoHeight(){return this.logoHeight?$i(this.logoHeight):void 0}get renderedStyleLogoHeight(){return this.logoHeight?Ya(this.logoHeight):void 0}get logoPosition(){return this.getPropertyValue("logoPosition")}set logoPosition(e){this.setPropertyValue("logoPosition",e)}get hasLogo(){return this.getPropertyValue("hasLogo",void 0,()=>!!this.logo&&this.logoPosition!=="none")}resetHasLogo(){this.resetPropertyValue("hasLogo")}get isLogoBefore(){return this.isDesignMode?!1:this.renderedHasLogo&&(this.logoPosition==="left"||this.logoPosition==="top")}get isLogoAfter(){return this.isDesignMode?this.renderedHasLogo:this.renderedHasLogo&&(this.logoPosition==="right"||this.logoPosition==="bottom")}get logoClassNames(){const e={left:"sv-logo--left",right:"sv-logo--right",top:"sv-logo--top",bottom:"sv-logo--bottom"};return new z().append(this.css.logo).append(e[this.logoPosition]).toString()}get titleIsEmpty(){return this.getPropertyValue("titleIsEmpty",void 0,()=>this.locTitle.isEmpty)}get renderedHasTitle(){return this.isDesignMode?this.isPropertyVisible("title"):!this.titleIsEmpty&&this.showTitle}get renderedHasDescription(){return this.isDesignMode?this.isPropertyVisible("description"):!!this.hasDescription&&this.showTitle}get hasTitle(){return this.renderedHasTitle}get renderedHasLogo(){return this.isDesignMode?this.isPropertyVisible("logo"):this.hasLogo}get renderedHasHeader(){return this.renderedHasTitle||this.renderedHasLogo}get logoFit(){return this.getPropertyValue("logoFit")}set logoFit(e){this.setPropertyValue("logoFit",e)}get themeVariables(){return Object.assign({},this.cssVariables)}setIsMobile(e=!0){this._isMobile!==e&&(this._isMobile=e,this.updateCss(),this.getAllQuestions().forEach(t=>t.setIsMobile(e)))}get isMobile(){return this._isMobile&&!this.isDesignMode}set isCompact(e){e!==this._isCompact&&(this._isCompact=e,this.updateElementCss(),this.triggerResponsiveness(!0))}get isCompact(){return this._isCompact}isLogoImageChoosen(){return this.locLogo.renderedHtml}get titleMaxWidth(){return""}get renderBackgroundImage(){return this.getPropertyValue("renderBackgroundImage",void 0,()=>Qu(this.backgroundImage))}get backgroundOpacity(){return this.getPropertyValue("backgroundOpacity")}set backgroundOpacity(e){this.setPropertyValue("backgroundOpacity",e)}get backgroundImageStyle(){return this.getPropertyValue("backgroundImageStyle",void 0,()=>this.calcBackgroundImageStyle())}calcBackgroundImageStyle(){return{opacity:this.backgroundOpacity,backgroundImage:this.renderBackgroundImage,backgroundSize:this.backgroundImageFit,backgroundAttachment:this.fitToContainer?void 0:this.backgroundImageAttachment}}updateWrapperFormCss(){this.wrapperFormCss=new z().append(this.css.rootWrapper).append(this.css.rootWrapperHasImage,!!this.backgroundImage).append(this.css.rootWrapperFixed,!this.formScrollDisabled).toString()}get completedHtml(){return this.getLocalizableStringText("completedHtml")}set completedHtml(e){this.setLocalizableStringText("completedHtml",e)}get locCompletedHtml(){return this.getLocalizableString("completedHtml")}get completedHtmlOnCondition(){return this.getPropertyValue("completedHtmlOnCondition")}set completedHtmlOnCondition(e){this.setPropertyValue("completedHtmlOnCondition",e)}runExpression(e,t){if(!e)return null;var s=this.getFilteredProperties();const i=this.createExpressionRunner(e);let r;return i.onRunComplete=a=>{r=a,t&&t(a)},i.runContext(this.getValueGetterContext(),s)||r}beforeExpressionRunning(e,t,s){const i={element:e,propertyName:t,expression:s,allow:!0};return this.onExpressionRunning.fire(this,i),i.allow?i.expression:""}get isSettingValueOnExpression(){return this.setValueOnExpressionCounter>0}startSetValueOnExpression(){this.setValueOnExpressionCounter++}finishSetValueOnExpression(){this.setValueOnExpressionCounter--}runCondition(e){if(!e)return!1;const t=this.getFilteredProperties();return new Fs(e).runContext(this.getValueGetterContext(),t)}runTriggers(){this.checkTriggers(this.getFilteredValues(),!1)}get renderedCompletedHtml(){var e=this.getExpressionItemOnRunCondition(this.completedHtmlOnCondition);return e?e.html:this.completedHtml}getExpressionItemOnRunCondition(e){if(e.length==0)return null;for(var t=this.getFilteredProperties(),s=0;s<e.length;s++)if(e[s].runCondition(t))return e[s];return null}get completedBeforeHtml(){return this.getLocalizableStringText("completedBeforeHtml")}set completedBeforeHtml(e){this.setLocalizableStringText("completedBeforeHtml",e)}get locCompletedBeforeHtml(){return this.getLocalizableString("completedBeforeHtml")}get loadingHtml(){return this.getLocalizableStringText("loadingHtml")}set loadingHtml(e){this.setLocalizableStringText("loadingHtml",e)}get locLoadingHtml(){return this.getLocalizableString("loadingHtml")}getNavigationCss(e,t){return new z().append(e).append(t).toString()}get navigationBar(){return this.navigationBarValue||(this.navigationBarValue=this.createNavigationBar(),this.navigationBarValue.locOwner=this,this.updateNavigationCss()),this.navigationBarValue}createNavigationBar(){if(this.createNavigationBarCallback)return this.createNavigationBarCallback();const e=new _t;return e.setItems(this.createNavigationActions()),e}addNavigationItem(e){e.component||(e.component="sv-nav-btn"),e.innerCss||(e.innerCss=this.cssSurveyNavigationButton);const t=e.action;return e.action=()=>{this.waitAndExecute(()=>t())},this.navigationBar.addAction(e)}removeNavigationItem(e){var t;(t=this.navigationBarValue)===null||t===void 0||t.removeActionById(e)}createNavigationActions(){const e="sv-nav-btn",t=new Pe({id:"sv-nav-start",visible:new We(()=>this.isStartPageActive),visibleIndex:10,locTitle:this.locStartSurveyText,action:()=>this.start(),component:e}),s=new Pe({id:"sv-nav-prev",visible:new We(()=>this.isShowPrevButton),visibleIndex:20,data:{mouseDown:()=>this.navigationMouseDown()},locTitle:this.locPagePrevText,action:()=>this.performPrevious(),component:e}),i=new Pe({id:"sv-nav-next",visible:new We(()=>this.isShowNextButton),visibleIndex:30,data:{mouseDown:()=>this.nextPageMouseDown()},locTitle:this.locPageNextText,action:()=>this.nextPageUIClick(),component:e}),r=new Pe({id:"sv-nav-preview",visible:new We(()=>this.isPreviewButtonVisible),visibleIndex:40,data:{mouseDown:()=>this.navigationMouseDown()},locTitle:this.locPreviewText,action:()=>this.showPreview(),component:e}),a=new Pe({id:"sv-nav-complete",visible:new We(()=>this.isCompleteButtonVisible),visibleIndex:50,data:{mouseDown:()=>this.navigationMouseDown()},locTitle:this.locCompleteText,action:()=>this.taskManager.waitAndExecute(()=>this.tryComplete()),component:e});return this._updateNavigationItemCssCallback=()=>{t.innerCss=this.cssNavigationStart,s.innerCss=this.cssNavigationPrev,i.innerCss=this.cssNavigationNext,r.innerCss=this.cssNavigationPreview,a.innerCss=this.cssNavigationComplete},[t,s,i,r,a]}updateNavigationCss(){const e=this.navigationBarValue;e&&(e.cssClasses=this.css.actionBar,e.containerCss=this.css.footer,this._updateNavigationItemCssCallback&&this._updateNavigationItemCssCallback())}get startSurveyText(){return this.getLocalizableStringText("startSurveyText")}set startSurveyText(e){this.setLocalizableStringText("startSurveyText",e)}get locStartSurveyText(){return this.getLocalizableString("startSurveyText")}get pagePrevText(){return this.getLocalizableStringText("pagePrevText")}set pagePrevText(e){this.setLocalizableStringText("pagePrevText",e)}get locPagePrevText(){return this.getLocalizableString("pagePrevText")}get pageNextText(){return this.getLocalizableStringText("pageNextText")}set pageNextText(e){this.setLocalizableStringText("pageNextText",e)}get locPageNextText(){return this.getLocalizableString("pageNextText")}get completeText(){return this.getLocalizableStringText("completeText")}set completeText(e){this.setLocalizableStringText("completeText",e)}get locCompleteText(){return this.getLocalizableString("completeText")}get previewText(){return this.getLocalizableStringText("previewText")}set previewText(e){this.setLocalizableStringText("previewText",e)}get locPreviewText(){return this.getLocalizableString("previewText")}get editText(){return this.getLocalizableStringText("editText")}set editText(e){this.setLocalizableStringText("editText",e)}get locEditText(){return this.getLocalizableString("editText")}getElementTitleTagName(e,t){if(this.onGetTitleTagName.isEmpty)return t;const s={element:e,tagName:t};return this.onGetTitleTagName.fire(this,s),s.tagName}get questionTitlePattern(){return this.getPropertyValue("questionTitlePattern","numTitleRequire")}set questionTitlePattern(e){e!=="numRequireTitle"&&e!=="requireNumTitle"&&e!="numTitle"&&(e="numTitleRequire"),this.setPropertyValue("questionTitlePattern",e)}getQuestionTitlePatternOptions(){const e=new Array,t=this.getLocalizationString("questionTitlePatternText"),s=this.questionStartIndex?this.questionStartIndex:"1.";return e.push({value:"numTitleRequire",text:s+" "+t+" "+this.requiredMark}),e.push({value:"numRequireTitle",text:s+" "+this.requiredMark+" "+t}),e.push({value:"numTitle",text:s+" "+t}),e}get questionTitleTemplate(){return this.getLocalizableStringText("questionTitleTemplate")}set questionTitleTemplate(e){this.setLocalizableStringText("questionTitleTemplate",e),this.questionTitlePattern=this.getNewTitlePattern(e),this.questionStartIndex=this.getNewQuestionTitleElement(e,"no",this.questionStartIndex,"1"),this.requiredMark=this.getNewQuestionTitleElement(e,"require",this.requiredMark,"*")}getNewTitlePattern(e){if(e){for(var t=[];e.indexOf("{")>-1;){e=e.substring(e.indexOf("{")+1);var s=e.indexOf("}");if(s<0)break;t.push(e.substring(0,s)),e=e.substring(s+1)}if(t.length>1){if(t[0]=="require")return"requireNumTitle";if(t[1]=="require"&&t.length==3)return"numRequireTitle";if(t.indexOf("require")<0)return"numTitle"}if(t.length==1&&t[0]=="title")return"numTitle"}return"numTitleRequire"}getNewQuestionTitleElement(e,t,s,i){if(t="{"+t+"}",!e||e.indexOf(t)<0)return s;for(var r=e.indexOf(t),a="",o="",l=r-1;l>=0&&e[l]!="}";l--);for(l<r-1&&(a=e.substring(l+1,r)),r+=t.length,l=r;l<e.length&&e[l]!="{";l++);for(l>r&&(o=e.substring(r,l)),l=0;l<a.length&&a.charCodeAt(l)<33;)l++;for(a=a.substring(l),l=o.length-1;l>=0&&o.charCodeAt(l)<33;)l--;if(o=o.substring(0,l+1),!a&&!o)return s;var u=s||i;return a+u+o}get locQuestionTitleTemplate(){return this.getLocalizableString("questionTitleTemplate")}getUpdatedQuestionTitle(e,t){if(this.onGetQuestionTitle.isEmpty)return t;const s={question:e,title:t};return this.onGetQuestionTitle.fire(this,s),s.title}getUpdatedQuestionNo(e,t){if(this.onGetQuestionNumber.isEmpty)return t;const s={question:e,number:t,no:t};return this.onGetQuestionNumber.fire(this,s),s.no===t?s.number:s.no}getUpdatedPanelNo(e,t){if(this.onGetPanelNumber.isEmpty)return t;const s={panel:e,number:t};return this.onGetPanelNumber.fire(this,s),s.number}getUpdatedPageNo(e,t){if(this.onGetPageNumber.isEmpty)return t;const s={page:e,number:t};return this.onGetPageNumber.fire(this,s),s.number}get showPageNumbers(){return this.getPropertyValue("showPageNumbers")}set showPageNumbers(e){e!==this.showPageNumbers&&(this.setPropertyValue("showPageNumbers",e),this.updateVisibleIndexes())}get showQuestionNumbers(){return this.getPropertyValue("showQuestionNumbers")}set showQuestionNumbers(e){e===!0&&(e="on"),e===!1&&(e="off"),e=e.toLowerCase(),e=e==="onpage"?"onPage":e,e!==this.showQuestionNumbers&&(this.setPropertyValue("showQuestionNumbers",e),this.updateVisibleIndexes())}get progressBar(){return this.progressBarValue||(this.progressBarValue=new GP(this)),this.progressBarValue}get showProgressBar(){return this.getPropertyValue("showProgressBar")}set showProgressBar(e){this.setShowProgressBar(e)}setShowProgressBar(e){e==="off"&&(e=!1),e===!0||e===!1?this.setPropertyValue("showProgressBar",e):(this.setPropertyValue("showProgressBar",!0),this.progressBarLocation=e)}get progressBarLocation(){return this.getPropertyValue("progressBarLocation")}set progressBarLocation(e){this.setPropertyValue("progressBarLocation",e.toLowerCase())}get progressBarType(){return this.getPropertyValue("progressBarType")}set progressBarType(e){e==="correctquestion"&&(e="correctQuestion"),e==="requiredquestion"&&(e="requiredQuestion"),this.setPropertyValue("progressBarType",e)}get progressBarComponentName(){let e=this.progressBarType;return!A.legacyProgressBarView&&xr.currentType==="default"&&li(e,"pages")&&(e="buttons"),"progress-"+e}get isShowProgressBarOnTop(){return!this.canShowProgressBar()||!this.showProgressBar?!1:["auto","aboveheader","belowheader","topbottom","top","both"].indexOf(this.progressBarLocation)!==-1}get isShowProgressBarOnBottom(){return!this.canShowProgressBar()||!this.showProgressBar?!1:this.progressBarLocation==="bottom"||this.progressBarLocation==="both"||this.progressBarLocation==="topbottom"}getProgressTypeComponent(){return"sv-progress-"+this.progressBarType.toLowerCase()}getProgressCssClasses(e=""){return new z().append(this.css.progress).append(this.css.progressTop,this.isShowProgressBarOnTop&&(!e||e=="header")).append(this.css.progressBottom,this.isShowProgressBarOnBottom&&(!e||e=="footer")).toString()}canShowProgressBar(){return!this.isShowingPreview||!this.showPreviewBeforeComplete||this.previewMode!="allQuestions"}get processedTitle(){return this.locTitle.renderedHtml}get questionTitleLocation(){return this.getPropertyValue("questionTitleLocation")}set questionTitleLocation(e){this.setPropertyValue("questionTitleLocation",e.toLowerCase()),this.isLoadingFromJson||this.updateElementCss(!0)}updateElementCss(e){this.startPage&&this.startPage.updateElementCss(e);for(var t=this.visiblePages,s=0;s<t.length;s++)t[s].updateElementCss(e);this.updateCss()}get questionErrorLocation(){return this.getPropertyValue("questionErrorLocation")}set questionErrorLocation(e){this.setPropertyValue("questionErrorLocation",e.toLowerCase())}get questionDescriptionLocation(){return this.getPropertyValue("questionDescriptionLocation")}set questionDescriptionLocation(e){this.setPropertyValue("questionDescriptionLocation",e)}get mode(){return this.readOnly?"display":"edit"}set mode(e){e=e.toLowerCase(),e!=this.mode&&(e!="edit"&&e!="display"||(this.readOnly=e=="display"))}get readOnly(){return this.getPropertyValue("readOnly")}set readOnly(e){this.setPropertyValue("readOnly",e)}onReadOnlyChanged(){for(var e=0;e<this.pages.length;e++){var t=this.pages[e];t.setPropertyValue("isReadOnly",t.isReadOnly)}this.updateButtonsVisibility(),this.updateCss()}get data(){for(var e={},t=this.getValuesKeys(),s=0;s<t.length;s++){var i=t[s],r=this.getDataValueCore(this.valuesHash,i);r!==void 0&&(e[i]=r)}return this.setCalculatedValuesIntoResult(e),e}set data(e){this.valuesHash={},this.setDataCore(e,!e)}mergeData(e){if(!e)return;const t=this.data;this.mergeValues(e,t),this.setDataCore(t)}setDataCore(e,t=!1){if(t&&(this.valuesHash={}),e)for(var s in e){const i=typeof s=="string"?s.trim():s;this.setDataValueCore(this.valuesHash,i,e[s])}this.isSettingDataValue=!0,this.updateAllQuestionsValue(t),this.notifyAllQuestionsOnValueChanged(),this.notifyElementsOnAnyValueOrVariableChanged(""),this.isSettingDataValue=!1,this.runConditions(),this.updateAllQuestionsValue(t)}isSettingData(){return this.isSettingDataValue===!0}get isSurvey(){return!0}getData(e){const t=e||{includePages:!1,includePanels:!1};return!t.includePages&&!t.includePanels?this.data:this.getStructuredData(!!t.includePages,t.includePanels?100:t.includePages?1:0)}getStructuredData(e=!0,t=-1){if(t===0)return this.data;const s={};return this.pages.forEach(i=>{if(e){const r={};i.collectValues(r,t-1)&&(s[i.name]=r)}else i.collectValues(s,t)}),s}setStructuredData(e,t=!1){if(!e)return;const s={};for(let i in e)if(this.getQuestionByValueName(i))s[i]=e[i];else{let a=this.getPageByName(i);a||(a=this.getPanelByName(i)),a&&this.collectDataFromPanel(a,s,e[i])}t?this.mergeData(s):this.data=s}collectDataFromPanel(e,t,s){for(let i in s){let r=e.getElementByName(i);r&&(r.isPanel?this.collectDataFromPanel(r,t,s[i]):t[i]=s[i])}}get editingObj(){return this.editingObjValue}set editingObj(e){if(this.editingObj!=e&&(this.unConnectEditingObj(),this.editingObjValue=e,!this.isDisposed)){if(!e)for(var t=this.getAllQuestions(),s=0;s<t.length;s++)t[s].unbindValue();this.editingObj&&(this.setDataCore({}),this.onEditingObjPropertyChanged=(i,r)=>{q.hasOriginalProperty(this.editingObj,r.name)&&(r.name==="locale"&&this.setDataCore({}),this.updateOnSetValue(r.name,this.editingObj[r.name],r.oldValue))},this.editingObj.onPropertyChanged.add(this.onEditingObjPropertyChanged))}}unConnectEditingObj(){this.editingObj&&!this.editingObj.isDisposed&&this.editingObj.onPropertyChanged.remove(this.onEditingObjPropertyChanged)}get isEditingSurveyElement(){return!!this.editingObj}setCalculatedValuesIntoResult(e){for(var t=0;t<this.calculatedValues.length;t++){var s=this.calculatedValues[t];s.includeIntoResult&&s.name&&this.getVariable(s.name)!==void 0&&(e[s.name]=this.getVariable(s.name))}}getAllValues(){return this.data}getPlainData(e){e||(e={includeEmpty:!0,includeQuestionTypes:!1,includeValues:!1});const t=[],s=[];if(this.getAllQuestions().forEach(o=>{var l=o.getPlainData(e);l&&(t.push(l),s.push(o.valueName||o.name))}),e.includeValues){const o=this.getValuesKeys();for(var i=0;i<o.length;i++){var r=o[i];if(s.indexOf(r)==-1){var a=this.getDataValueCore(this.valuesHash,r);a&&t.push({name:r,title:r,value:a,displayValue:a,isNode:!1,getString:l=>typeof l=="object"?JSON.stringify(l):l})}}}return t}getFilteredValues(){const e={};for(var t in this.variablesHash)e[t]=this.variablesHash[t];if(this.addCalculatedValuesIntoFilteredValues(e),!this.isDesignMode){const i=this.getValuesKeys();for(var s=0;s<i.length;s++){var t=i[s];e[t]=this.getDataValueCore(this.valuesHash,t)}this.getAllQuestions().forEach(r=>{r.hasFilteredValue&&(e[r.getFilteredName()]=r.getFilteredValue(!0))})}return e}addCalculatedValuesIntoFilteredValues(e){for(var t=this.calculatedValues,s=0;s<t.length;s++)e[t[s].name]=t[s].value}getFilteredProperties(){return{survey:this}}getValuesKeys(){if(!this.editingObj)return Object.keys(this.valuesHash);for(var e=q.getPropertiesByObj(this.editingObj),t=[],s=0;s<e.length;s++)t.push(e[s].name);return t}getDataValueCore(e,t){return this.editingObj?q.getObjPropertyValue(this.editingObj,t):this.getDataFromValueHash(e,t)}setDataValueCore(e,t,s){this.editingObj?q.setObjPropertyValue(this.editingObj,t,s):this.setDataToValueHash(e,t,s)}deleteDataValueCore(e,t){this.editingObj?this.editingObj[t]=null:this.deleteDataFromValueHash(e,t)}getDataFromValueHash(e,t){return this.valueHashGetDataCallback?this.valueHashGetDataCallback(e,t):e[t]}setDataToValueHash(e,t,s){this.valueHashSetDataCallback?this.valueHashSetDataCallback(e,t,s):e[t]=s}deleteDataFromValueHash(e,t){this.valueHashDeleteDataCallback?this.valueHashDeleteDataCallback(e,t):delete e[t]}get comments(){for(var e={},t=this.getValuesKeys(),s=0;s<t.length;s++){var i=t[s];i.indexOf(this.commentSuffix)>0&&(e[i]=this.getDataValueCore(this.valuesHash,i))}return e}get visiblePages(){if(this.isDesignMode)return this.pages;if(this.pageContainerValue&&(this.isShowingPreview||this.isSinglePage))return[this.pageContainerValue];for(var e=new Array,t=0;t<this.pages.length;t++)this.isPageInVisibleList(this.pages[t])&&e.push(this.pages[t]);return e}isPageInVisibleList(e){return this.isDesignMode||e.isVisible&&!e.isStartPage}get isEmpty(){return this.pages.length==0}get PageCount(){return this.pageCount}get pageCount(){return this.pages.length}get visiblePageCount(){return this.visiblePages.length}get startPage(){var e=this.firstPageIsStartPage&&this.pages.length>1?this.pages[0]:null;return e&&e.onFirstRendering(),e}get startedPage(){return this.startPage}get currentPage(){return this.getPropertyValue("currentPage",null)}set currentPage(e){if(this.isLoadingFromJson)return;var t=this.getPageByObject(e);if(e&&!t||!t&&this.isCurrentPageAvailable)return;var s=this.visiblePages;if(t!=null&&s.indexOf(t)<0||t==this.currentPage)return;const i=this.currentSingleElement;if(!this.isShowingPreview&&i&&t!==i.page){this.currentSingleElement=t.getFirstVisibleElement();return}var r=this.currentPage;!this.isShowingPreview&&!i&&!this.currentPageChanging(t,r)||(this.setPropertyValue("currentPage",t),t&&(t.onFirstRendering(),t.updateCustomWidgets()),this.locStrsChanged(),this.isShowingPreview||this.currentPageChanged(t,r))}get currentElementName(){var e;return((e=this.currentElement)===null||e===void 0?void 0:e.name)||""}set currentElementName(e){e&&(this.currentElement=this.getElementByName(e))}get currentElement(){return this.currentSingleElement||this.currentPage}set currentElement(e){if(e)if(e.isPage)this.currentPage=e;else{const t=e.page;t&&!this.isSingleVisibleQuestion?this.currentPage=t:this.currentSingleElement=e}}getElementByName(e){return e?this.getPageByName(e)||this.getPanelByName(e)||this.getQuestionByName(e):null}tryNavigateToPage(e){if(!this.performValidationOnPageChanging(e))return!1;const s=this.visiblePages.indexOf(e)<this.currentPageNo||!this.doServerValidation(!1,!1,e);return s&&(this.currentPage=e),s}performValidationOnPageChanging(e){if(this.isDesignMode)return!1;if(this.canGoTroughValidation())return!0;const t=this.visiblePages.indexOf(e);if(t<0||t>=this.visiblePageCount||t===this.currentPageNo)return!1;if(t<this.currentPageNo||this.checkErrorsMode==="onComplete"||this.validationAllowSwitchPages)return!0;if(!this.validateCurrentPage())return!1;for(let s=this.currentPageNo+1;s<t;s++){const i=this.visiblePages[s];if(!i.validate(!0,!0))return!1;i.passed=!0}return!0}updateCurrentPage(){this.isCurrentPageAvailable||(this.currentPage=this.firstVisiblePage)}get isCurrentPageAvailable(){const e=this.currentPage;return!!e&&this.isPageInVisibleList(e)&&this.isPageExistsInSurvey(e)}isPageExistsInSurvey(e){return this.pages.indexOf(e)>-1?!0:!!this.onContainsPageCallback&&this.onContainsPageCallback(e)}get activePage(){return this.getPropertyValue("activePage")}get isStartPageActive(){return this.state==="starting"}get isShowStartingPage(){return this.isStartPageActive}get matrixDragHandleArea(){return this.getPropertyValue("matrixDragHandleArea","entireItem")}set matrixDragHandleArea(e){this.setPropertyValue("matrixDragHandleArea",e)}get isShowingPage(){return this.state=="running"||this.state=="preview"||this.isStartPageActive}updateActivePage(){const e=this.isStartPageActive?this.startPage:this.currentPage;e!==this.activePage&&this.setPropertyValue("activePage",e)}onStateAndCurrentPageChanged(){this.updateActivePage(),this.updateButtonsVisibility()}getPageByObject(e){if(!e)return null;if(e.getType&&e.getType()=="page")return e;if(typeof e=="string"||e instanceof String)return this.getPageByName(String(e));if(!isNaN(e)){var t=Number(e),s=this.visiblePages;return e<0||e>=s.length?null:s[t]}return e}get currentPageNo(){return this.visiblePages.indexOf(this.currentPage)}set currentPageNo(e){var t=this.visiblePages;e<0||e>=t.length||(this.currentPage=t[e])}get questionOrder(){return this.getPropertyValue("questionOrder")}set questionOrder(e){this.setPropertyValue("questionOrder",e)}get questionsOrder(){return this.questionOrder}set questionsOrder(e){this.questionOrder=e}focusFirstQuestion(){if(!this.focusingQuestionInfo){var e=this.activePage;e&&(e.scrollToTop(),e.focusFirstQuestion())}}scrollToTopOnPageChange(e=!0){var t=this.activePage;t&&(e&&t.scrollToTop(),this.isCurrentPageRendering&&this.autoFocusFirstQuestion&&!this.focusingQuestionInfo&&(t.focusFirstQuestion(),this.isCurrentPageRendering=!1))}get state(){return this.getPropertyValue("state","empty")}updateState(){this.setPropertyValue("state",this.calcState())}calcState(){return this.isLoading?"loading":this.isCompleted?"completed":this.isCompletedBefore?"completedbefore":!this.isDesignMode&&this.isEditMode&&this.isStartedState&&this.startPage?"starting":this.isShowingPreview?this.currentPage?"preview":"empty":this.currentPage?"running":"empty"}get isCompleted(){return this.getPropertyValue("isCompleted",!1)}set isCompleted(e){this.setPropertyValue("isCompleted",e)}get isShowingPreview(){return this.getPropertyValue("isShowingPreview",!1)}set isShowingPreview(e){this.isShowingPreview!=e&&(this.setPropertyValue("isShowingPreview",e),this.onShowingPreviewChanged())}get isStartedState(){return this.getPropertyValue("isStartedState",!1)}set isStartedState(e){this.setPropertyValue("isStartedState",e)}get isCompletedBefore(){return this.getPropertyValue("isCompletedBefore",!1)}set isCompletedBefore(e){this.setPropertyValue("isCompletedBefore",e)}get isLoading(){return this.getPropertyValue("isLoading",!1)}set isLoading(e){this.setPropertyValue("isLoading",e)}beginLoading(){this.isLoading=!0}endLoading(){this.isLoading=!1}get completedState(){return this.getPropertyValue("completedState","")}get completedStateText(){return this.getPropertyValue("completedStateText","")}setCompletedState(e,t){this.setPropertyValue("completedState",e),t||(e=="saving"&&(t=this.getLocalizationString("savingData")),e=="error"&&(t=this.getLocalizationString("savingDataError")),e=="success"&&(t=this.getLocalizationString("savingDataSuccess"))),this.setPropertyValue("completedStateText",t),this.state==="completed"&&this.showCompletePage&&this.completedState&&this.notify(this.completedStateText,this.completedState,e==="error")}notify(e,t,s=!1){this.notifier.showActions=s,this.notifier.notify(e,t,s)}clear(e=!0,t=!0){this.isCompleted=!1,this.isCompletedBefore=!1,this.isLoading=!1,this.completedByTriggers=void 0,this.skippedPages=[],e&&this.setDataCore(null,!0),this.timerModel.spent=0;for(var s=0;s<this.pages.length;s++)this.pages[s].timeSpent=0,this.pages[s].setWasShown(!1),this.pages[s].passed=!1;if(this.onFirstPageIsStartedChanged(),t&&(this.currentPage=this.firstVisiblePage,this.currentSingleElement)){const i=this.getSingleElements();this.currentSingleElement=i.length>0?i[0]:void 0}e&&this.updateValuesWithDefaults()}mergeValues(e,t){Xr(e,t)}updateValuesWithDefaults(){if(!(this.isDesignMode||this.isLoading))for(var e=0;e<this.pages.length;e++)for(var t=this.pages[e].questions,s=0;s<t.length;s++)t[s].updateValueWithDefaults()}updateCustomWidgets(e){e&&e.updateCustomWidgets()}currentPageChanging(e,t,s,i){const r=this.createPageChangeEventOptions(e,t,s,i);return this.currentPageChangingFromOptions(r)}currentPageChangingFromOptions(e){e.allow=!0,e.allowChanging=!0,this.onCurrentPageChanging.fire(this,e);const t=e.allowChanging&&e.allow;return t&&e.newCurrentPage!==e.oldCurrentPage&&(this.isCurrentPageRendering=!0),t}currentPageChanged(e,t){if(this.notifyQuestionsOnHidingContent(t),t&&!t.isDisposed&&!t.passed&&t.validate(!1)&&(t.passed=!0),this.isCurrentPageRendered===!0&&(this.isCurrentPageRendered=!1),!this.currentSingleElement){const s=this.createPageChangeEventOptions(e,t);this.onCurrentPageChanged.fire(this,s)}}notifyQuestionsOnHidingContent(e){e&&!e.isDisposed&&e.questions.forEach(t=>t.onHidingContent())}createPageChangeEventOptions(e,t,s,i){const r=e&&t?e.visibleIndex-t.visibleIndex:0;let a=r;return a===0&&i&&s&&(a=e.elements.indexOf(s)-e.elements.indexOf(i)),{oldCurrentQuestion:i,newCurrentQuestion:s,oldCurrentPage:t,newCurrentPage:e,isNextPage:r===1,isPrevPage:r===-1,isGoingForward:a>0,isGoingBackward:a<0,isAfterPreview:this.changeCurrentPageFromPreview===!0}}getProgress(){if(this.currentPage==null)return 0;if(this.progressBarType!=="pages"){var e=this.getProgressInfo();return this.progressBarType==="requiredQuestions"?e.requiredQuestionCount>=1?Math.ceil(e.requiredAnsweredQuestionCount*100/e.requiredQuestionCount):100:e.questionCount>=1?Math.ceil(e.answeredQuestionCount*100/e.questionCount):100}const t=this.visiblePages;var s=t.indexOf(this.currentPage);return Math.ceil(s*100/t.length)}get isNavigationButtonsShowing(){if(this.isDesignMode)return"none";var e=this.activePage;return!e||e.showNavigationButtons===!1?"none":e.showNavigationButtons===!0?this.showNavigationButtons?this.navigationButtonsLocation:"bottom":this.showNavigationButtons?this.navigationButtonsLocation:"none"}get isNavigationButtonsShowingOnTop(){return this.getIsNavigationButtonsShowingOn("top")}get isNavigationButtonsShowingOnBottom(){return this.getIsNavigationButtonsShowingOn("bottom")}getIsNavigationButtonsShowingOn(e){var t=this.isNavigationButtonsShowing;return t=="both"||t=="topBottom"||t==e}get isEditMode(){return!this.readOnly}get isDisplayMode(){return this.readOnly&&!this.isDesignMode||this.state=="preview"}get isUpdateValueTextOnTyping(){return this.textUpdateMode=="onTyping"}get isDesignMode(){return this._isDesignMode}setDesignMode(e){!!this._isDesignMode!=!!e&&(this._isDesignMode=!!e,this.onQuestionsOnPageModeChanged("standard"))}get showInvisibleElements(){return this.getPropertyValue("showInvisibleElements",!1)}set showInvisibleElements(e){var t=this.visiblePages;this.setPropertyValue("showInvisibleElements",e),!this.isLoadingFromJson&&(this.runConditions(),this.updateAllElementsVisibility(t))}updateAllElementsVisibility(e){for(var t=0;t<this.pages.length;t++){var s=this.pages[t];s.updateElementVisibility(),e.indexOf(s)>-1!=s.isVisible&&this.onPageVisibleChanged.fire(this,{page:s,visible:s.isVisible})}}get areInvisibleElementsShowing(){return this.isDesignMode||this.showInvisibleElements}get areEmptyElementsHidden(){return this.isShowingPreview&&this.showPreviewBeforeComplete&&this.previewMode=="answeredQuestions"&&this.isAnyQuestionAnswered}get isAnyQuestionAnswered(){const e=this.getAllQuestions(!0);for(let t=0;t<e.length;t++)if(!e[t].isEmpty())return!0;return!1}get hasCookie(){if(!this.cookieName)return!1;var e=ge.getCookie();return e&&e.indexOf(this.cookieName+"=true")>-1}setCookie(){this.cookieName&&ge.setCookie(this.cookieName+"=true; expires=Fri, 31 Dec 9999 0:0:0 GMT")}deleteCookie(){this.cookieName&&ge.setCookie(this.cookieName+"=;")}get ignoreValidation(){return!this.validationEnabled}set ignoreValidation(e){this.validationEnabled=!e}nextPage(){return this.currentSingleElement?this.performNext():this.isLastPage?!1:this.doCurrentPageComplete(!1)}performNext(){const e=this.currentSingleElement;if(!e)return this.nextPage();if(this.resetNavigationButton(),this.isSingleVisibleInput){if(!e.validateSingleInput())return!1;if(e.nextSingleInput())return this.updateButtonsVisibility(),!0}return this.validationEnabled?this.validateElements([e],!0,!1,s=>{s||this.performNextAfterValidation(e)})===!0:(this.performNextAfterValidation(e),!0)}performNextAfterValidation(e){this.sendPartialResult();const t=this.getSingleElements(),s=t.indexOf(e);if(s<0||s===t.length-1)return!1;let i={};e.isQuestion?i[e.name]=e.value:e.isPanel&&(i=e.getValue()),this.checkTriggers(i,!0,!1,!0,e.name),e===this.currentSingleElement&&(this.currentSingleElement=t[s+1])}performPrevious(){return this.prevPage()}validateOnNavigate(e,t){const s=this.canGoTroughValidation()||e&&this.validationAllowComplete||!e&&(this.validationAllowSwitchPages||this.isValidateOnComplete)||t&&this.isValidateOnComplete,i=()=>{t?this.showPreviewCore():this.doCurrentPageCompleteCore(e)};if(s)return i(),!0;const r=a=>{a||i()};return this.isValidateOnComplete?this.isLastPage?this.validate(!0,this.autoFocusFirstError,r,!0)!==!0:(i(),!0):this.validateCurrentPage(r)!==!1}canGoTroughValidation(){return!this.isEditMode||!this.validationEnabled}get isCurrentPageHasErrors(){return this.validateActivePage()===!1}get isCurrentPageValid(){return this.validateActivePage()}hasCurrentPageErrors(e){return this.hasPageErrors(void 0,e)}validateCurrentPage(e){return this.validatePage(void 0,e)}hasPageErrors(e,t){const s=this.validatePage(e,t);return s===void 0?s:!s}validatePage(e,t){return e||(e=this.activePage),e?this.validatePageCore(e,!0,t):!0}hasErrors(e=!0,t=!1,s){const i=this.validate(e,t,s);return i===void 0?i:!i}validate(e=!0,t=!1,s,i){return this.validateElements(this.visiblePages,e,t,s,i)}validateElements(e,t=!0,s=!1,i,r){i&&(t=!0);const a=i?l=>{i(!l)}:void 0,o=new Cr({fireCallback:t,focusOnFirstError:s,callbackResult:a,changeCurrentPage:!!r});for(const l of e)l.validateElement(o);return o.finish(),o.runningResult}ensureUniqueNames(e=null){if(e==null)for(var t=0;t<this.pages.length;t++)this.ensureUniqueName(this.pages[t]);else this.ensureUniqueName(e)}ensureUniqueName(e){if(e.isPage&&this.ensureUniquePageName(e),e.isPanel&&this.ensureUniquePanelName(e),e.isPage||e.isPanel)for(var t=e.elements,s=0;s<t.length;s++)this.ensureUniqueNames(t[s]);else this.ensureUniqueQuestionName(e)}ensureUniquePageName(e){return this.ensureUniqueElementName(e,t=>this.getPageByName(t))}ensureUniquePanelName(e){return this.ensureUniqueElementName(e,t=>this.getPanelByName(t))}ensureUniqueQuestionName(e){return this.ensureUniqueElementName(e,t=>this.getQuestionByName(t))}ensureUniqueElementName(e,t){var s=t(e.name);if(!(!s||s==e)){for(var i=this.getNewName(e.name);t(i);)var i=this.getNewName(e.name);e.name=i}}getNewName(e){for(var t=e.length;t>0&&e[t-1]>="0"&&e[t-1]<="9";)t--;var s=e.substring(0,t),i=0;return t<e.length&&(i=parseInt(e.substring(t))),i++,s+i}validateActivePage(e){return this.validatePageCore(this.activePage,e)}validatePageCore(e,t,s){if(t===void 0&&(t=this.focusOnFirstError),!e)return!0;let i;s&&(i=a=>{s(!a)});const r=e.validate(!0,t,i);return this.fireValidatedErrorsOnPage(e),r}fireValidatedErrorsOnPage(e){if(this.onValidatePage.isEmpty||!e)return;const t=this.getNestedQuestionsByQuestionArray(e.questions,!0);for(var s=new Array,i=new Array,r=0;r<t.length;r++){var a=t[r];if(a.errors.length>0){s.push(a);for(var o=0;o<a.errors.length;o++)i.push(a.errors[o])}}this.onValidatePage.fire(this,{questions:s,errors:i,page:e})}prevPage(){if(this.isFirstPage||this.state==="starting")return!1;this.resetNavigationButton();const e=this.currentSingleElement;if(this.doSkipOnPrevPage(e))return!0;if(e)return this.prevPageSingleElement(e);const t=this.visiblePages,s=t.indexOf(this.currentPage);return this.currentPage=t[s-1],!0}doSkipOnPrevPage(e){const t=e||this.currentPage,s=this.skippedPages.find(r=>r.to===t);let i;if(s){this.skippedPages.splice(this.skippedPages.indexOf(s),1);const r=s.from;!r.isDisposed&&r.isVisible&&(i=r)}return i&&(e?this.currentSingleElement=i:this.currentPage=i),!!i}prevPageSingleElement(e){if(this.isSingleVisibleInput&&e.prevSingleInput())return this.updateButtonsVisibility(),!0;const t=this.getSingleElements(),s=t.indexOf(e);return s===0?!1:(this.currentSingleElement=t[s-1],!0)}tryComplete(){return this.isValidateOnComplete&&this.cancelPreview(),this.doCurrentPageComplete(!0),this.isCompleted}completeLastPage(){return this.tryComplete()}navigationMouseDown(){return this.isNavigationButtonPressed=!0,!0}resetNavigationButton(){this.isNavigationButtonPressed=!1}nextPageUIClick(){return this.mouseDownPage&&this.mouseDownPage!==this.activePage?!1:(this.mouseDownPage=null,this.performNext())}nextPageMouseDown(){return this.mouseDownPage=this.activePage,this.navigationMouseDown()}showPreview(){return this.resetNavigationButton(),!this.isValidateOnComplete&&this.doServerValidation(!0,!0)||!this.validateOnNavigate(!0,!0)?!1:this.isShowingPreview}showPreviewCore(){var e={allowShowPreview:!0,allow:!0};this.onShowingPreview.fire(this,e),this.isShowingPreview=e.allowShowPreview&&e.allow}cancelPreview(e=null){var t;if(!this.isShowingPreview)return;this.gotoPageFromPreview=e,this.isShowingPreview=!1;const s=(t=this.currentSingleElement)===null||t===void 0?void 0:t.page;s&&(s.updateRows(),this.currentPage=s)}cancelPreviewByPage(e){this.cancelPreview(e)}doCurrentPageComplete(e){return this.isValidatingOnServer?!1:(this.resetNavigationButton(),this.validateOnNavigate(e)===!0)}doCurrentPageCompleteCore(e){if(this.doServerValidation(e))return!1;if(e){this.currentPage.passed=!0;const t=this.doComplete(this.canBeCompletedByTrigger,this.completedTrigger);return t&&this.cancelPreview(),t}return this.doNextPage(),!0}get isSinglePage(){return this.questionsOnPageMode=="singlePage"}set isSinglePage(e){this.questionsOnPageMode=e?"singlePage":"standard"}get isSingleVisibleQuestion(){return!this.isDesignMode&&(this.isSingleVisibleQuestionVal(this.questionsOnPageMode)||this.isSingleVisibleInput)}get isSingleVisibleInput(){return!this.isDesignMode&&this.questionsOnPageMode=="inputPerPage"}isSingleVisibleQuestionVal(e){return e==="questionPerPage"||e==="questionOnPage"}get questionsOnPageMode(){return this.getPropertyValue("questionsOnPageMode")}set questionsOnPageMode(e){this.setPropertyValue("questionsOnPageMode",e)}get firstPageIsStartPage(){return this.getPropertyValue("firstPageIsStartPage")}set firstPageIsStartPage(e){this.setPropertyValue("firstPageIsStartPage",e)}get firstPageIsStarted(){return this.firstPageIsStartPage}set firstPageIsStarted(e){this.firstPageIsStartPage=e}isPageStarted(e){return this.firstPageIsStartPage&&this.pages.length>1&&this.pages[0]===e}get showPreviewBeforeComplete(){return this.getPropertyValue("showPreviewBeforeComplete")}set showPreviewBeforeComplete(e){this.setShowPreviewBeforeComplete(e)}setShowPreviewBeforeComplete(e){e===void 0||e==="noPreview"||e===!1?this.setPropertyValue("showPreviewBeforeComplete",!1):(this.setPropertyValue("showPreviewBeforeComplete",!0),e==="showAllQuestions"&&(this.previewMode="allQuestions"),e==="showAnsweredQuestions"&&(this.previewMode="answeredQuestions"))}get previewMode(){return this.getPropertyValue("previewMode")}set previewMode(e){this.setPropertyValue("previewMode",e)}onFirstPageIsStartedChanged(){this.isStartedState=this.firstPageIsStartPage&&this.pages.length>1,this.pageVisibilityChanged(this.pages[0],!this.isStartedState)}onShowingPreviewChanged(){this.updatePagesContainer()}createRootPage(e,t){const s=q.createClass("page");return s.name=e,s.isPageContainer=!0,t.forEach(i=>{i.isStartPage||s.addElement(i)}),s}disposeContainerPage(){let e=this.pageContainerValue;[].concat(e.elements).forEach(s=>e.removeElement(s)),e.dispose(),this.pageContainerValue=void 0}updatePagesContainer(){if(this.isDesignMode)return;this.getAllQuestions().forEach(i=>i.updateElementVisibility()),this.setPropertyValue("currentPage",void 0);const e="single-page",t="preview-page";let s;if(this.isSinglePage){const i=this.pageContainerValue;i&&i.name===t?(s=i.elements[0],this.disposeContainerPage()):s=this.createRootPage(e,this.pages)}if(this.isShowingPreview&&(s=this.createRootPage(t,s?[s]:this.pages)),s&&(s.setSurveyImpl(this),this.pageContainerValue=s,this.currentPage=s,this.currentSingleElementValue&&this.visiblePages.forEach(i=>i.updateRows())),!this.isSinglePage&&!this.isShowingPreview){this.disposeContainerPage();let i=this.gotoPageFromPreview;this.gotoPageFromPreview=null,O.isValueEmpty(i)&&this.visiblePageCount>0&&(i=this.visiblePages[this.visiblePageCount-1]),i&&(this.changeCurrentPageFromPreview=!0,this.currentPage=i,this.changeCurrentPageFromPreview=!1)}!this.currentPage&&this.visiblePageCount>0&&(this.currentPage=this.visiblePages[0]),this.isShowingPreview&&this.pages.forEach(i=>{i.onFirstRendering()}),this.pages.forEach(i=>{i.wasRendered&&i.updateElementCss(!0)}),this.updateButtonsVisibility()}getSingleElements(e){const t=new Array,s=this.pages,i=this.isSingleVisibleInput;for(var r=0;r<s.length;r++){const a=s[r];if(!a.isStartPage&&a.isVisible){const o=[];i?a.addQuestionsToList(o,!0):a.elements.forEach(l=>o.push(l)),o.forEach(l=>{(l===e||l.isVisible)&&t.push(l)})}}return t}get currentSingleElement(){return this.isShowingPreview?void 0:this.currentSingleElementValue}set currentSingleElement(e){if(e&&e.isQuestion&&this.isSingleVisibleQuestionVal(this.questionsOnPageMode))for(;e.parent&&e.parent.isPanel;)e=e.parent;const t=this.currentSingleElement;if(e!==t&&!this.isCompleted){const s=e?.isQuestion?e:void 0,i=t?.isQuestion?t:void 0,r=e?.page,a=r&&t?this.createPageChangeEventOptions(r,t.page,s,i):void 0;if(a&&!this.currentPageChangingFromOptions(a))return;this.currentSingleElementValue=e,e?(this.isSingleVisibleInput&&e.isQuestion&&e.onSetAsSingleInput(),r.updateRows(),r!==this.currentPage?this.currentPage=r:s&&this.autoFocusFirstQuestion&&s.focus(),this.updateButtonsVisibility(),a&&this.onCurrentPageChanged.fire(this,a)):this.visiblePages.forEach(o=>o.updateRows())}}get currentSingleQuestion(){const e=this.currentSingleElement;return e&&e.isQuestion?e:void 0}set currentSingleQuestion(e){this.currentSingleElement=e}supportsNestedSingleInput(e){const t={question:e,enabled:!0};return this.onCheckSingleInputPerPageMode.fire(this,t),t.enabled}updateNestedSingleQuestions(e,t){const s={question:e,nestedQuestions:t};this.onGetLoopQuestions.fire(this,s)}changeCurrentSingleElementOnVisibilityChanged(){const e=this.currentSingleElement;if(!e||e.isVisible)return;const t=this.getSingleElements(e),s=t.indexOf(e),i=s>0?t[s-1]:s<t.length-1?t[s+1]:void 0;this.currentSingleElement=i}onQuestionsOnPageModeChanged(e){if(!(this.isShowingPreview||this.isDesignMode)&&(this.skippedPages=[],this.currentSingleElement=void 0,e==="singlePage"&&this.updatePagesContainer(),e==="inputPerPage"&&this.getAllQuestions().forEach(t=>t.resetSingleInput()),this.isSinglePage&&this.updatePagesContainer(),this.setupSingleInputNavigationActions(),this.isSingleVisibleQuestion)){const t=this.getSingleElements();t.length>0&&(this.currentSingleElement=t[0])}}setupSingleInputNavigationActions(){const e="sv-singleinput-add";if(this.isSingleVisibleInput){const t=()=>{this.currentSingleQuestion.singleInputAddItem(!0),this.resetNavigationButton()};this.addNavigationItem({id:e,visible:!1,action:()=>t()})}else this.removeNavigationItem(e)}getPageStartIndex(){return this.firstPageIsStartPage&&this.pages.length>0?1:0}get isFirstPage(){return this.getPropertyValue("isFirstPage")}get isLastPage(){return this.getPropertyValue("isLastPage")}updateNavigationElements(){this.updateButtonsVisibility()}updateButtonsVisibility(){this.updateIsFirstLastPageState(),this.setPropertyValue("isShowPrevButton",this.calcIsShowPrevButton()),this.setPropertyValue("isShowNextButton",this.calcIsShowNextButton()),this.setPropertyValue("isCompleteButtonVisible",this.calcIsCompleteButtonVisible()),this.setPropertyValue("isPreviewButtonVisible",this.calcIsPreviewButtonVisible()),this.setPropertyValue("isCancelPreviewButtonVisible",this.calcIsCancelPreviewButtonVisible()),this.updateSingleInputActions()}updateSingleInputActions(){if(!this.isSingleVisibleInput)return;const e=this.currentSingleQuestion;if(!e)return;function t(s){s&&(s.title=e.getSingleInputAddText(),s.visible=!!s.title)}t(this.navigationBar.getActionById("sv-singleinput-add"))}get isShowPrevButton(){return this.getPropertyValue("isShowPrevButton")}get isShowNextButton(){return this.getPropertyValue("isShowNextButton")}get isCompleteButtonVisible(){return this.getPropertyValue("isCompleteButtonVisible")}get isPreviewButtonVisible(){return this.getPropertyValue("isPreviewButtonVisible")}get isCancelPreviewButtonVisible(){return this.getPropertyValue("isCancelPreviewButtonVisible")}get isFirstElement(){return this.getPropertyValue("isFirstElement")}get isLastElement(){return this.getPropertyValue("isLastElement")}updateIsFirstLastPageState(){const e=this.currentPage;let t,s;const i=this.currentSingleElement;if(i){let r=!0,a=!0;if(this.isSingleVisibleInput){const u=i.getSingleInputElementPos();u!==0&&(r=u===-1,a=u===1)}const o=this.getSingleElements(),l=o.indexOf(i);l>=0&&(t=r&&l===0,s=a&&l===o.length-1)}this.setPropertyValue("isFirstPage",!!e&&e===this.firstVisiblePage&&(!i||t===!0)),this.setPropertyValue("isLastPage",!!e&&e===this.lastVisiblePage&&(!i||s===!0)),this.setPropertyValue("isFirstElement",t),this.setPropertyValue("isLastElement",s)}get isLastPageOrElement(){return this.isLastElement!==void 0?this.isLastElement:this.isLastPage}get isFirstPageOrElement(){return this.isFirstElement!==void 0?this.isFirstElement:this.isFirstPage}calcIsShowPrevButton(){if(this.isFirstPageOrElement||!this.showPrevButton||this.state!=="running")return!1;if(this.isFirstElement!==void 0)return!0;const e=this.visiblePages[this.currentPageNo-1];return e&&e.getMaxTimeToFinish()<=0}calcIsShowNextButton(){return this.state==="running"&&!this.isLastPageOrElement&&!this.canBeCompletedByTrigger}calcIsCompleteButtonVisible(){const e=this.state;return this.isEditMode&&(this.state==="running"&&(this.isLastPageOrElement&&!this.showPreviewBeforeComplete||this.canBeCompletedByTrigger)||e==="preview")&&this.showCompleteButton}calcIsPreviewButtonVisible(){return this.isEditMode&&this.showPreviewBeforeComplete&&this.state=="running"&&this.isLastPageOrElement}calcIsCancelPreviewButtonVisible(){return this.isEditMode&&this.showPreviewBeforeComplete&&this.state=="preview"}get firstVisiblePage(){if(this.visiblePageCount===1)return this.visiblePages[0];const e=this.pages;for(let t=0;t<e.length;t++)if(this.isPageInVisibleList(e[t]))return e[t];return null}get lastVisiblePage(){if(this.visiblePageCount===1)return this.visiblePages[0];const e=this.pages;for(let t=e.length-1;t>=0;t--)if(this.isPageInVisibleList(e[t]))return e[t];return null}doComplete(e=!1,t){if(!this.isCompleted)return this.checkOnCompletingEvent(e,t)?(this.checkOnPageTriggers(!0),this.stopTimer(),this.notifyQuestionsOnHidingContent(this.currentPage),this.isCompleted=!0,this.clearUnusedValues(),this.saveDataOnComplete(e,t),this.setCookie(),!0):(this.isCompleted=!1,!1)}saveDataOnComplete(e=!1,t){let s=this.hasCookie;const i=d=>{l=!0,this.setCompletedState("saving",d)},r=d=>{this.setCompletedState("error",d)},a=d=>{this.setCompletedState("success",d),this.navigateTo()},o=d=>{this.setCompletedState("","")};var l=!1,u={isCompleteOnTrigger:e,completeTrigger:t,showSaveInProgress:i,showSaveError:r,showSaveSuccess:a,clearSaveMessages:o,showDataSaving:i,showDataSavingError:r,showDataSavingSuccess:a,showDataSavingClear:o};this.onComplete.fire(this,u),!s&&this.surveyPostId&&this.sendResult(),l||this.navigateTo()}checkOnCompletingEvent(e,t){var s={allowComplete:!0,allow:!0,isCompleteOnTrigger:e,completeTrigger:t};return this.onCompleting.fire(this,s),s.allowComplete&&s.allow}start(){return!this.firstPageIsStartPage||(this.isCurrentPageRendering=!0,!this.validatePageCore(this.startPage,!0))?!1:(this.isStartedState=!1,this.notifyQuestionsOnHidingContent(this.pages[0]),this.startTimerFromUI(),this.onStarted.fire(this,{}),this.updateVisibleIndexes(),this.currentPageNo=0,this.currentPage&&this.currentPage.locStrsChanged(),!0)}get isValidatingOnServer(){return this.getPropertyValue("isValidatingOnServer",!1)}setIsValidatingOnServer(e){e!=this.isValidatingOnServer&&(this.setPropertyValue("isValidatingOnServer",e),this.onIsValidatingOnServerChanged())}createServerValidationOptions(e,t,s){var i=this;const r={data:{},errors:{},survey:this,complete:function(){i.completeServerValidation(r,t,s)}};if(e&&this.isValidateOnComplete)r.data=this.data;else for(var a=this.activePage.questions,o=0;o<a.length;o++){var l=a[o];if(l.visible){var u=this.getValue(l.getValueName());this.isValueEmpty(u)||(r.data[l.getValueName()]=u)}}return r}onIsValidatingOnServerChanged(){}doServerValidation(e,t=!1,s){if(!this.onServerValidateQuestions||this.onServerValidateQuestions.isEmpty||!e&&this.isValidateOnComplete)return!1;this.setIsValidatingOnServer(!0);const i=typeof this.onServerValidateQuestions=="function";return this.serverValidationEventCount=i?1:this.onServerValidateQuestions.length,i?this.onServerValidateQuestions(this,this.createServerValidationOptions(e,t,s)):this.onServerValidateQuestions.fireByCreatingOptions(this,()=>this.createServerValidationOptions(e,t,s)),!0}completeServerValidation(e,t,s){if(this.serverValidationEventCount>1&&(this.serverValidationEventCount--,e&&e.errors&&Object.keys(e.errors).length===0)||(this.serverValidationEventCount=0,this.setIsValidatingOnServer(!1),!e&&!e.survey))return;var i=e.survey;let r=!0;if(e.errors){var a=this.autoFocusFirstError;for(var o in e.errors){var l=i.getQuestionByName(o);l&&l.errors&&(r=!1,l.addError(new vs(e.errors[o],this)),a&&(a=!1,l.page&&(this.currentPage=l.page),l.focus(!0)))}this.fireValidatedErrorsOnPage(this.currentPage)}r&&(t?this.showPreviewCore():s?this.currentPage=s:i.isLastPage?i.doComplete():i.doNextPage())}doNextPage(){var e=this.currentPage;if(this.checkOnPageTriggers(!1),this.sendPartialResult(),this.isCompleted)this.doComplete(!0);else if(e===this.currentPage){var t=this.visiblePages,s=t.indexOf(this.currentPage);this.currentPage=t[s+1]}}setCompleted(e){this.doComplete(!0,e)}sendPartialResult(){this.partialSendEnabled&&!this.isCompleted&&this.sendResult(this.surveyPostId,this.clientId,!0)}canBeCompleted(e,t){var s;if(!A.triggers.changeNavigationButtonsOnComplete)return;const i=this.canBeCompletedByTrigger;this.completedByTriggers||(this.completedByTriggers={}),t?this.completedByTriggers[e.id]={trigger:e,pageId:(s=this.currentPage)===null||s===void 0?void 0:s.id}:delete this.completedByTriggers[e.id],i!==this.canBeCompletedByTrigger&&this.updateButtonsVisibility()}get canBeCompletedByTrigger(){var e;if(!this.completedByTriggers)return!1;const t=Object.keys(this.completedByTriggers);if(t.length===0)return!1;const s=(e=this.currentPage)===null||e===void 0?void 0:e.id;if(!s)return!0;for(let i=0;i<t.length;i++)if(s===this.completedByTriggers[t[i]].pageId)return!0;return!1}get completedTrigger(){if(!this.canBeCompletedByTrigger)return;const e=Object.keys(this.completedByTriggers)[0];return this.completedByTriggers[e].trigger}get processedCompletedHtml(){var e=this.renderedCompletedHtml;return e?this.processHtml(e,"completed"):""}get processedCompletedBeforeHtml(){return this.locCompletedBeforeHtml.textOrHtml}get processedLoadingHtml(){return this.locLoadingHtml.textOrHtml}getProgressInfo(){var e=this.isDesignMode?this.pages:this.visiblePages;return yt.getProgressInfoByElements(e,!1)}get progressBarAriaLabel(){return Ct("progressbar",this.getLocale())}get progressText(){return this.progressBar.progressText}get progressValue(){return this.getPropertyValue("progressValue",void 0,()=>this.getProgress())}updateProgressText(e=!1){this.isShowingPreview||e&&this.progressBarType=="pages"&&this.onGetProgressText.isEmpty||(this.progressBarValue&&this.progressBarValue.resetProgressText(),this.resetPropertyValue("progressValue"))}getProgressText(){if(!this.isDesignMode&&this.currentPage==null)return"";const e={questionCount:0,answeredQuestionCount:0,requiredQuestionCount:0,requiredAnsweredQuestionCount:0,text:""};var t=this.progressBarType.toLowerCase();if(t==="questions"||t==="requiredquestions"||t==="correctquestions"||!this.onGetProgressText.isEmpty){var s=this.getProgressInfo();e.questionCount=s.questionCount,e.answeredQuestionCount=s.answeredQuestionCount,e.requiredQuestionCount=s.requiredQuestionCount,e.requiredAnsweredQuestionCount=s.requiredAnsweredQuestionCount}return e.text=this.getProgressTextCore(e),this.onGetProgressText.fire(this,e),e.text}getProgressTextCore(e){var t=this.progressBarType.toLowerCase();if(t==="questions")return this.getLocalizationFormatString("questionsProgressText",e.answeredQuestionCount,e.questionCount);if(t==="requiredquestions")return this.getLocalizationFormatString("questionsProgressText",e.requiredAnsweredQuestionCount,e.requiredQuestionCount);if(t==="correctquestions"){var s=this.getCorrectedAnswerCount();return this.getLocalizationFormatString("questionsProgressText",s,e.questionCount)}var i=this.isDesignMode?this.pages:this.visiblePages,r=i.indexOf(this.currentPage)+1;return this.getLocalizationFormatString("progressText",r,i.length)}getRootCss(){return new z().append(this.css.root).append(this.css.rootProgress+"--"+this.progressBarType).append(this.css.rootMobile,this.isMobile).append(this.css.rootAnimationDisabled,!A.animationEnabled).append(this.css.rootReadOnly,this.readOnly&&!this.isDesignMode).append(this.css.rootCompact,this.isCompact).append(this.css.rootFitToContainer,this.fitToContainer).toString()}afterRenderSurvey(e){if(!we.isAvailable())return;this.destroyResizeObserver(),Array.isArray(e)&&(e=yt.GetFirstNonTextElement(e));let t=e;const s=this.css.variables;if(s){const i=Number.parseFloat(ge.getComputedStyle(t).getPropertyValue(s.mobileWidth));if(i){let r=!1;this.resizeObserver=new ResizeObserver(a=>{we.requestAnimationFrame(()=>{r||!Wu(t)?r=!1:r=this.processResponsiveness(t.offsetWidth,i,t.offsetHeight)})}),this.resizeObserver.observe(t)}}this.onAfterRenderSurvey.fire(this,{survey:this,htmlElement:e}),this.rootElement=e,this.scrollerElement=e.getElementsByClassName("sv-scroll__scroller")[0],this.addScrollEventListener()}beforeDestroySurveyElement(){this.destroyResizeObserver(),this.removeScrollEventListener(),this.rootElement=void 0,this.scrollerElement=void 0}processResponsiveness(e,t,s){const i=e<t,r=this.isMobile!==i;this.setIsMobile(i),this.layoutElements.forEach(o=>o.processResponsiveness&&o.processResponsiveness(e));const a={height:s,width:e};return this.onResize.fire(this,a),r}triggerResponsiveness(e){this.getAllQuestions().forEach(t=>{t.triggerResponsiveness(e)})}destroyResizeObserver(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=void 0)}updateQuestionCssClasses(e,t){this.onUpdateQuestionCssClasses.fire(this,{question:e,cssClasses:t})}updatePanelCssClasses(e,t){this.onUpdatePanelCssClasses.fire(this,{panel:e,cssClasses:t})}updatePageCssClasses(e,t){this.onUpdatePageCssClasses.fire(this,{page:e,cssClasses:t})}updateChoiceItemCss(e,t){t.question=e,this.onUpdateChoiceItemCss.fire(this,t)}afterRenderPage(e){if(!this.isDesignMode&&!this.focusingQuestionInfo){const t=this.isCurrentPageRendered===!1;setTimeout(()=>this.scrollToTopOnPageChange(t),1)}this.focusQuestionInfo(),this.isCurrentPageRendered=!0,!this.onAfterRenderPage.isEmpty&&this.onAfterRenderPage.fire(this,{page:this.activePage,htmlElement:e})}afterRenderHeader(e){this.onAfterRenderHeader.isEmpty||this.onAfterRenderHeader.fire(this,{htmlElement:e})}afterRenderQuestion(e,t){this.onAfterRenderQuestion.fire(this,{question:e,htmlElement:t})}afterRenderQuestionInput(e,t){if(this.onAfterRenderQuestionInput.isEmpty)return;let s=e.inputId;const{root:i}=A.environment;if(s&&(!t||t.id!==s)&&typeof i<"u"){let r=i.getElementById(s);r&&(t=r)}this.onAfterRenderQuestionInput.fire(this,{question:e,htmlElement:t})}afterRenderPanel(e,t){this.onAfterRenderPanel.fire(this,{panel:e,htmlElement:t})}whenQuestionFocusIn(e){this.onFocusInQuestion.fire(this,{question:e})}whenPanelFocusIn(e){this.onFocusInPanel.fire(this,{panel:e})}rebuildQuestionChoices(){this.getAllQuestions().forEach(e=>e.surveyChoiceItemVisibilityChange())}canChangeChoiceItemsVisibility(){return!this.onShowingChoiceItem.isEmpty}getChoiceItemVisibility(e,t,s){const i={question:e,item:t,visible:s};return this.onShowingChoiceItem.fire(this,i),i.visible}loadQuestionChoices(e){this.onChoicesLazyLoad.fire(this,e)}getChoiceDisplayValue(e){this.onGetChoiceDisplayValue.isEmpty?e.setItems(null):this.onGetChoiceDisplayValue.fire(this,e)}matrixBeforeRowAdded(e){this.onMatrixRowAdding.fire(this,e)}matrixRowAdded(e,t){this.onMatrixRowAdded.fire(this,{question:e,row:t})}matrixColumnAdded(e,t){this.onMatrixColumnAdded.fire(this,{question:e,column:t})}multipleTextItemAdded(e,t){this.onMultipleTextItemAdded.fire(this,{question:e,item:t})}getQuestionByValueNameFromArray(e,t,s){var i=this.getQuestionsByValueName(e);if(i){for(var r=0;r<i.length;r++){var a=i[r].getQuestionFromArray(t,s);if(a)return a}return null}}matrixRowRemoved(e,t,s){this.onMatrixRowRemoved.fire(this,{question:e,rowIndex:t,row:s})}matrixRowRemoving(e,t,s){var i={question:e,rowIndex:t,row:s,allow:!0};return this.onMatrixRowRemoving.fire(this,i),i.allow}matrixAllowRemoveRow(e,t,s){const i={question:e,rowIndex:t,row:s,allow:!0};return this.onMatrixRenderRemoveButton.fire(this,i),i.allow}matrixDetailPanelVisibleChanged(e,t,s,i){const r={question:e,rowIndex:t,row:s,visible:i,detailPanel:s.detailPanel};this.onMatrixDetailPanelVisibleChanged.fire(this,r)}matrixCellCreating(e,t){t.question=e,this.onMatrixCellCreating.fire(this,t)}matrixCellCreated(e,t){t.question=e,this.onMatrixCellCreated.fire(this,t)}matrixAfterCellRender(e){var t;const s=this.onAfterRenderMatrixCell;s.isEmpty||(e.question=(t=e.cellQuestion)===null||t===void 0?void 0:t.parentQuestion,s.fire(this,e))}matrixCellValueChanged(e,t){t.question=e,this.onMatrixCellValueChanged.fire(this,t)}matrixCellValueChanging(e,t){t.question=e,this.onMatrixCellValueChanging.fire(this,t)}get isValidateOnValueChanging(){return this.checkErrorsMode==="onValueChanging"}get isValidateOnValueChanged(){return this.checkErrorsMode==="onValueChanged"}get isValidateOnValueChange(){return this.isValidateOnValueChanged||this.isValidateOnValueChanging}get isValidateOnComplete(){return this.checkErrorsMode==="onComplete"||this.validationAllowSwitchPages&&!this.validationAllowComplete}matrixCellValidate(e,t){return t.question=e,this.onMatrixCellValidate.fire(this,t),t.error?new vs(t.error,this):null}dynamicPanelAdded(e,t,s,i){!this.isLoadingFromJson&&i&&this.updateVisibleIndexes(e.page),this.onDynamicPanelAdded.fire(this,{question:e,panel:s,panelIndex:t})}dynamicPanelRemoved(e,t,s,i){for(var r=s?s.questions:[],a=0;a<r.length;a++)r[a].clearOnDeletingContainer();i&&this.updateVisibleIndexes(e.page),this.onDynamicPanelRemoved.fire(this,{question:e,panelIndex:t,panel:s})}dynamicPanelRemoving(e,t,s){const i={question:e,panelIndex:t,panel:s,allow:!0};return this.onDynamicPanelRemoving.fire(this,i),i.allow}dynamicPanelGetTabTitle(e,t){t.question=e,this.onGetDynamicPanelTabTitle.fire(this,t)}dynamicPanelCurrentIndexChanged(e,t){t.question=e,this.onDynamicPanelCurrentIndexChanged.fire(this,t)}dragAndDropAllow(e){return this.onDragDropAllow.fire(this,e),e.allow}elementContentVisibilityChanged(e){this.currentPage&&this.currentPage.ensureRowsVisibility(),this.onElementContentVisibilityChanged.fire(this,{element:e})}getUpdatedPanelFooterActions(e,t,s){const i={question:s,panel:e,actions:t};return this.onGetPanelFooterActions.fire(this,i),i.actions}getUpdatedElementTitleActions(e,t){return e.isPage?this.getUpdatedPageTitleActions(e,t):e.isPanel?this.getUpdatedPanelTitleActions(e,t):this.getUpdatedQuestionTitleActions(e,t)}getTitleActionsResult(e,t){return e!=t.actions?t.actions:e!=t.titleActions?t.titleActions:e}getUpdatedQuestionTitleActions(e,t){const s={question:e,actions:t,titleActions:t};return this.onGetQuestionTitleActions.fire(this,s),this.getTitleActionsResult(t,s)}getUpdatedPanelTitleActions(e,t){const s={panel:e,actions:t,titleActions:t};return this.onGetPanelTitleActions.fire(this,s),this.getTitleActionsResult(t,s)}getUpdatedPageTitleActions(e,t){var s={page:e,actions:t,titleActions:t};return this.onGetPageTitleActions.fire(this,s),this.getTitleActionsResult(t,s)}getUpdatedMatrixRowActions(e,t,s){const i={question:e,actions:s,row:t};return this.onGetMatrixRowActions.fire(this,i),i.actions}scrollElementToTop(e,t,s,i,r,a,o,l){const u={element:e,question:t,page:s,elementId:i,cancel:!1,allow:!0};if(this.onScrollToTop.fire(this,u),!u.cancel&&u.allow){const d=this.getPageByElement(e),{rootElement:h}=A.environment,f=this.rootElement||o||h;if(this.isLazyRendering&&d){let C=1;this.skeletonHeight&&f&&typeof f.getBoundingClientRect=="function"&&(C=f.getBoundingClientRect().height/this.skeletonHeight-1),d.forceRenderElement(e,()=>{const b=f?.querySelector(`#${u.elementId}`);this.suspendLazyRendering(),yt.ScrollElementToTop(b,r,a,()=>{this.releaseLazyRendering();const x=f.querySelector(`#${d.id}`);Fu(x),l&&l()})},C)}else if(e.isPage&&!this.isSinglePage&&!this.isDesignMode&&this.rootElement){const C=f.querySelector(rs(this.css.rootWrapper));yt.ScrollElementToViewCore(C,!1,r,a,l)}else{const C=f?.querySelector(`#${u.elementId}`);this.suspendLazyRendering(),yt.ScrollElementToTop(C,r,a,()=>{this.releaseLazyRendering(),Fu(C),l&&l()})}}}chooseFiles(e,t,s){this.onOpenFileChooser.isEmpty?tP(e,t):this.onOpenFileChooser.fire(this,{input:e,element:s&&s.element||this.survey,elementType:s&&s.elementType,item:s&&s.item,propertyName:s&&s.propertyName,callback:t,context:s})}uploadFiles(e,t,s,i,r){this.onUploadFiles.isEmpty?i("error",this.getLocString("noUploadFilesHandler")):this.taskManager.runTask("file",a=>{this.onUploadFiles.fire(this,{question:e,name:t,sourceType:r,files:s||[],callback:(o,l)=>{i(o,l),a()}})}),this.surveyPostId&&this.uploadFilesCore(t,s,i)}downloadFile(e,t,s,i){this.onDownloadFile.isEmpty&&i&&i("skipped",s.content||s),this.onDownloadFile.fire(this,{question:e,name:t,content:s.content||s,fileValue:s,callback:i})}clearFiles(e,t,s,i,r){this.onClearFiles.isEmpty&&r&&r("success",s),this.onClearFiles.fire(this,{question:e,name:t,value:s,fileName:i,callback:r})}updateChoicesFromServer(e,t,s){var i={question:e,choices:t,serverResult:s};return this.onChoicesLoaded.fire(this,i),i.choices}loadedChoicesFromServer(e){this.locStrsChanged()}uploadFilesCore(e,t,s){this.reportWarningOnUsingService()}getPage(e){return this.pages[e]}addPage(e,t=-1){e!=null&&(t<0||t>=this.pages.length?this.pages.push(e):this.pages.splice(t,0,e))}addNewPage(e=null,t=-1){var s=this.createNewPage(e);return this.addPage(s,t),s}removePage(e){var t=this.pages.indexOf(e);t<0||(this.pages.splice(t,1),this.currentPage==e&&(this.currentPage=this.pages.length>0?this.pages[0]:null))}getQuestionByName(e,t=!1){const s=this.getQuestionsFromHash(this.questionHashes.names,this.questionHashes.namesInsensitive,e,t);return s?s[0]:null}findQuestionByName(e){return this.getQuestionByName(e)}getEditingSurveyElement(){return this.editingObjValue}getQuestionByValueName(e,t=!1){var s=this.getQuestionsByValueName(e,t);return s?s[0]:null}getQuestionsByValueName(e,t=!1){return this.getQuestionsFromHash(this.questionHashes.valueNames,this.questionHashes.valueNamesInsensitive,e,t)}getCalculatedValueByName(e){for(var t=0;t<this.calculatedValues.length;t++)if(e==this.calculatedValues[t].name)return this.calculatedValues[t];return null}getQuestionsFromHash(e,t,s,i){if(!s)return null;let r=e[s];return r||i&&(s=s.toLowerCase(),r=t[s],r)?r:null}getQuestionsByNames(e,t=!1){var s=[];if(!e)return s;for(var i=0;i<e.length;i++)if(e[i]){var r=this.getQuestionByName(e[i],t);r&&s.push(r)}return s}getPageByElement(e){for(var t=0;t<this.pages.length;t++){var s=this.pages[t];if(s.containsElement(e))return s}return null}getPageByQuestion(e){return this.getPageByElement(e)}getPageByName(e){for(var t=0;t<this.pages.length;t++)if(this.pages[t].name==e)return this.pages[t];return null}getPagesByNames(e){var t=[];if(!e)return t;for(var s=0;s<e.length;s++)if(e[s]){var i=this.getPageByName(e[s]);i&&t.push(i)}return t}getAllQuestions(e=!1,t=!1,s=!1){s&&(t=!1,(e?this.visiblePages:this.pages).forEach(o=>o.onFirstRendering()));for(var i=[],r=0;r<this.pages.length;r++)this.pages[r].addQuestionsToList(i,e,t);return s?this.getNestedQuestionsByQuestionArray(i,e):i}getNestedQuestionsByQuestionArray(e,t){const s=[];return e.forEach(i=>{i.getNestedQuestions(t,!0,!0).forEach(r=>s.push(r))}),s}getQuizQuestions(){for(var e=new Array,t=this.getPageStartIndex(),s=t;s<this.pages.length;s++)if(this.pages[s].isVisible)for(var i=this.pages[s].questions,r=0;r<i.length;r++){var a=i[r];a.quizQuestionCount>0&&e.push(a)}return e}getPanelByName(e,t=!1){var s=this.getAllPanels();t&&(e=e.toLowerCase());for(var i=0;i<s.length;i++){var r=s[i].name;if(t&&(r=r.toLowerCase()),r==e)return s[i]}return null}getAllPanels(e=!1,t=!1){for(var s=new Array,i=0;i<this.pages.length;i++)this.pages[i].addPanelsIntoList(s,e,t);return s}createNewPage(e){const t=q.createClass("page");return t.name=e,t}getValueChangeReason(){return this.isSettingValueOnExpression?"expression":this.isSettingValueFromTrigger?"trigger":void 0}questionOnValueChanging(e,t,s){if(this.editingObj){const r=q.findProperty(this.editingObj.getType(),e);r&&(t=r.settingValue(this.editingObj,t))}if(this.onValueChanging.isEmpty)return t;var i={name:e,question:this.getQuestionByValueName(s||e),value:this.getUnbindValue(t),oldValue:this.getValue(e),reason:this.getValueChangeReason()};return this.onValueChanging.fire(this,i),i.value}getLocNotification(e,t,s){return e||O.isTwoValueEquals(t,s,!1,!0,!1)}updateQuestionValue(e,t){if(!this.isLoadingFromJson){var s=this.getQuestionsByValueName(e);if(s)for(var i=0;i<s.length;i++){var r=s[i].value;(r===t&&Array.isArray(r)&&this.editingObj||!this.isTwoValueEquals(r,t))&&s[i].updateValueFromSurvey(t,!1)}}}validateQuestionOnValueChanged(e){!this.isNavigationButtonPressed&&(this.isValidateOnValueChanged||e.getAllErrors().length>0)&&this.validateQuestionOnValueChangedCore(e)}validateQuestionOnValueChangedCore(e){var t=e.getAllErrors().length;let s=e.validate(!0,!1,!this.isValidateOnValueChanging);return e.page&&this.isValidateOnValueChange&&(t>0||e.getAllErrors().length>0)&&this.fireValidatedErrorsOnPage(e.page),s}validateOnValueChanging(e,t){if(this.isLoadingFromJson)return!1;const s=this.getQuestionsByValueName(e);if(!s)return!1;let i=!0;for(let r=0;r<s.length;r++){const a=s[r];this.isTwoValueEquals(a.valueForSurvey,t)||(a.value=t),i=this.validateQuestionOnValueChangedCore(a)&&i&&a.errors.length==0}return i}fireOnValueChanged(e,t,s){this.onValueChanged.fire(this,{name:e,question:s,value:t,reason:this.getValueChangeReason()})}notifyQuestionOnValueChanged(e,t,s){if(!this.isLoadingFromJson){var i=this.getQuestionsByValueName(e);if(i)for(var r=0;r<i.length;r++){var a=i[r];this.validateQuestionOnValueChanged(a),a.onSurveyValueChanged(t)}this.updateProgressText(!0),this.fireOnValueChanged(e,t,s?this.getQuestionByName(s):void 0),!this.isDisposed&&(this.checkElementsBindings(e,t),this.notifyElementsOnAnyValueOrVariableChanged(e,s))}}checkElementsBindings(e,t){this.isRunningElementsBindings=!0;for(var s=0;s<this.pages.length;s++)this.pages[s].checkBindings(e,t);this.isRunningElementsBindings=!1,this.updateVisibleIndexAfterBindings&&(this.updateVisibleIndexes(),this.updateVisibleIndexAfterBindings=!1)}notifyElementsOnAnyValueOrVariableChanged(e,t){if(this.isEndLoadingFromJson!=="processing"){if(this.isRunningConditions){this.conditionNotifyElementsOnAnyValueOrVariableChanged=!0;return}for(var s=0;s<this.pages.length;s++)this.pages[s].onAnyValueChanged(e,t);this.isEndLoadingFromJson||this.locStrsChanged()}}updateAllQuestionsValue(e){for(var t=this.getAllQuestions(),s=0;s<t.length;s++){var i=t[s],r=i.getValueName();i.updateValueFromSurvey(this.getValue(r),e),i.requireUpdateCommentValue&&i.updateCommentFromSurvey(this.getComment(r))}}notifyAllQuestionsOnValueChanged(){for(var e=this.getAllQuestions(),t=0;t<e.length;t++)e[t].onSurveyValueChanged(this.getValue(e[t].getValueName()))}checkOnPageTriggers(e){for(var t=this.getCurrentPageQuestions(!0),s={},i=0;i<t.length;i++){var r=t[i],a=r.getValueName();s[a]=this.getValue(a)}this.addCalculatedValuesIntoFilteredValues(s),this.checkTriggers(s,!0,e)}getCurrentPageQuestions(e=!1){var t=[],s=this.currentPage;if(!s)return t;for(var i=0;i<s.questions.length;i++){var r=s.questions[i];!e&&!r.visible||!r.name||t.push(r)}return t}checkTriggers(e,t,s=!1,i=!1,r){if(this.isCompleted||this.triggers.length==0||this.isDisplayMode)return;if(this.isTriggerIsRunning){for(var a in e)this.triggerKeys[a]=e[a];return}let o=!1;if(!s&&r&&this.hasRequiredValidQuestionTrigger){const d=this.getQuestionByValueName(r);o=d&&!d.validate(!1)}this.isTriggerIsRunning=!0,this.triggerKeys=e;var l=this.getFilteredProperties();let u=this.canBeCompletedByTrigger;for(let d=0;d<this.triggers.length;d++){const h=this.triggers[d];if(o&&h.requireValidQuestion)continue;const f={isOnNextPage:t,isOnComplete:s,isOnNavigation:i,keys:this.triggerKeys,properties:l};h.checkExpression(f)}u!==this.canBeCompletedByTrigger&&this.updateButtonsVisibility(),this.isTriggerIsRunning=!1}checkTriggersAndRunConditions(e,t,s){var i={};i[e]={newValue:t,oldValue:s},this.runConditionOnValueChanged(e,t),this.checkTriggers(i,!1,!1,!1,e)}get hasRequiredValidQuestionTrigger(){for(let e=0;e<this.triggers.length;e++)if(this.triggers[e].requireValidQuestion)return!0;return!1}doElementsOnLoad(){for(var e=0;e<this.pages.length;e++)this.pages[e].onSurveyLoad()}get isRunningConditions(){return this.isRunningConditionsValue}runExpressions(){this.runConditions()}runConditions(){if(!(this.isCompleted||this.isEndLoadingFromJson==="processing"||this.isRunningConditions)){this.isRunningConditionsValue=!0;var e=this.getFilteredProperties();this.runConditionsCore(e),this.isRunningConditionsValue=!1,this.isValueChangedOnRunningCondition&&this.conditionRunnerCounter<A.maxConditionRunCountOnValueChanged?(this.isValueChangedOnRunningCondition=!1,this.conditionRunnerCounter++,this.runConditions()):(this.isValueChangedOnRunningCondition=!1,this.conditionRunnerCounter=0,this.conditionUpdateVisibleIndexes&&(this.conditionUpdateVisibleIndexes=!1,this.updateVisibleIndexes()),this.conditionNotifyElementsOnAnyValueOrVariableChanged&&(this.conditionNotifyElementsOnAnyValueOrVariableChanged=!1,this.notifyElementsOnAnyValueOrVariableChanged("")))}}runConditionOnValueChanged(e,t){this.questionTriggersKeys||(this.questionTriggersKeys={}),this.questionTriggersKeys[e]=t,this.isRunningConditions?this.isValueChangedOnRunningCondition=!0:(this.runConditions(),this.runQuestionsTriggers(e,t),this.questionTriggersKeys=void 0)}runConditionsCore(e){for(var t=this.pages,s=0;s<this.calculatedValues.length;s++)this.calculatedValues[s].resetCalculation();for(var s=0;s<this.calculatedValues.length;s++)this.calculatedValues[s].doCalculation(this.calculatedValues,e);super.runConditionCore(e);for(let i=0;i<t.length;i++)t[i].runCondition(e)}runQuestionsTriggers(e,t){if(this.isDisplayMode||this.isDesignMode)return;this.getAllQuestions().forEach(i=>{i.runTriggers(e,t,this.questionTriggersKeys)})}sendResult(e=null,t=null,s=!1){this.isEditMode&&(s&&this.onPartialSend&&this.onPartialSend.fire(this,null),!e&&this.surveyPostId&&(e=this.surveyPostId),e&&(t&&(this.clientId=t),!(s&&!this.clientId)&&this.reportWarningOnUsingService()))}getResult(e,t){this.reportWarningOnUsingService()}loadSurveyFromService(e=null,t=null){e&&(this.surveyId=e),t&&(this.clientId=t),this.reportWarningOnUsingService()}reportWarningOnUsingService(){ri.warn("Self-hosted Form Library no longer supports integration with SurveyJS Demo Service. Learn more: https://surveyjs.io/stay-updated/release-notes/v2.0.0#form-library-removes-apis-for-integration-with-surveyjs-demo-service")}loadSurveyFromServiceJson(e){e&&(this.fromJSON(e),this.notifyAllQuestionsOnValueChanged(),this.onLoadSurveyFromService(),this.onLoadedSurveyFromService.fire(this,{}))}onLoadingSurveyFromService(){}onLoadSurveyFromService(){}resetVisibleIndexes(){for(var e=this.getAllQuestions(!0),t=0;t<e.length;t++)e[t].setVisibleIndex(-1);this.updateVisibleIndexes()}updateVisibleIndexes(e){if(!(this.isLoadingFromJson||this.isEndLoadingFromJson)){if(this.isRunningConditions&&this.onQuestionVisibleChanged.isEmpty&&this.onPageVisibleChanged.isEmpty){this.conditionUpdateVisibleIndexes=!0;return}if(this.isRunningElementsBindings){this.updateVisibleIndexAfterBindings=!0;return}this.updatePageVisibleIndexes(),this.updatePageElementsVisibleIndexes(e),this.updateProgressText(!0)}}updatePageElementsVisibleIndexes(e){if(this.showQuestionNumbers=="onPage")for(var t=e?[e]:this.visiblePages,s=0;s<t.length;s++)t[s].setVisibleIndex(0);else{let i=this.getStartVisibleIndex();const r=this.pages;for(let a=0;a<r.length;a++)i+=r[a].setVisibleIndex(i)}}getStartVisibleIndex(){const e=this.showQuestionNumbers;return e==="on"||e==="recursive"?0:-1}updatePageVisibleIndexes(){this.updateButtonsVisibility();let e=0,t=1;this.pages.forEach(i=>{});for(var s=0;s<this.pages.length;s++){const i=this.pages[s],r=i.isVisible&&(s>0||!i.isStartPage);i.questionStartIndex&&(t=1),i.visibleIndex=r?e++:-1,i.num=r?t++:-1}}fromJSON(e,t){if(!e)return;this.resetHasLogo(),this.resetPropertyValue("titleIsEmpty"),this.questionHashesClear(),this.jsonErrors=null,this.sjsVersion=void 0;const s=new qt;s.toObject(e,this,t),s.errors.length>0&&(this.jsonErrors=s.errors),this.onStateAndCurrentPageChanged(),this.endLoading(),this.updateState(),this.sjsVersion&&A.version&&O.compareVerions(this.sjsVersion,A.version)>0&&ri.warn("The version of the survey JSON schema (v"+this.sjsVersion+") is newer than your current Form Library version ("+A.version+"). Please update the Form Library to make sure that all survey features work as expected.")}startLoadingFromJson(e){super.startLoadingFromJson(e),e&&e.locale&&(this.locale=e.locale)}setJsonObject(e){this.fromJSON(e)}endLoadingFromJson(){this.isEndLoadingFromJson="processing",this.onFirstPageIsStartedChanged(),super.endLoadingFromJson(),this.hasCookie&&(this.isCompletedBefore=!0),this.doElementsOnLoad(),this.onQuestionsOnPageModeChanged("standard"),this.isEndLoadingFromJson="conditions",this.runConditions(),this.notifyElementsOnAnyValueOrVariableChanged(""),this.isEndLoadingFromJson=null,this.updateVisibleIndexes(),this.updateCurrentPage(),this.setCalculatedWidthModeUpdater(),this.onEndLoadingFromJson.fire(this,{})}onBeforeRunConstructor(){}onBeforeCreating(){}onCreating(){}getProcessedTextValue(e){if(this.getProcessedTextValueCore(e),!this.onProcessDynamicText.isEmpty){var t=this.isValueEmpty(e.value);this.onProcessDynamicText.fire(this,e),e.isExists=e.isExists||t&&!this.isValueEmpty(e.value)}}getProcessedTextValueCore(e){const t=e.name.toLocaleLowerCase();if(["no","require","title"].indexOf(t)!==-1)return;const s=new Ii().getValueInfo({name:t,context:this.getValueGetterContext(),isText:!0,isDisplayValue:e.returnDisplayValue});s.isFound&&(e.isExists=!0,e.value=s.value)}clearUnusedValues(){this.isClearingUnsedValues=!0;for(var e=this.getAllQuestions(),t=0;t<e.length;t++)e[t].clearUnusedValues();this.clearInvisibleQuestionValues(),this.isClearingUnsedValues=!1}hasVisibleQuestionByValueName(e){const t=e;var s=this.getQuestionsByValueName(t.getValueName());if(!Array.isArray(s)||s.length<2)return!1;for(var i=0;i<s.length;i++){const r=s[i];if(r!==t&&r.isVisible&&r.isParentVisible&&!r.parentQuestion&&r.parentQuestion===t.parentQuestion)return!0}return!1}questionsByValueName(e){var t=this.getQuestionsByValueName(e);return t||[]}clearInvisibleQuestionValues(){const e=this.clearInvisibleValues==="none"?"none":"onComplete",t=this.getAllQuestions();for(var s=0;s<t.length;s++)t[s].clearValueIfInvisible(e)}getVariable(e){if(!e)return null;e=e.toLowerCase();var t=this.variablesHash[e];return this.isValueEmpty(t)&&(e.indexOf(".")>-1||e.indexOf("[")>-1)?new Ii().getValue(e,new fs(this.variablesHash)):t}setVariable(e,t){if(!e)return;const s=this.getVariable(e);this.valuesHash&&delete this.valuesHash[e],e=e.toLowerCase(),this.variablesHash[e]=t,this.notifyElementsOnAnyValueOrVariableChanged(e),O.isTwoValueEquals(s,t)||(this.checkTriggersAndRunConditions(e,t,s),this.onVariableChanged.fire(this,{name:e,value:t}))}getVariableNames(){var e=[];for(var t in this.variablesHash)e.push(t);return e}getUnbindValue(e){return this.editingObj?e:O.getUnbindValue(e)}getValue(e){if(!e||e.length==0)return null;var t=this.getDataValueCore(this.valuesHash,e);return this.getUnbindValue(t)}setValue(e,t,s=!1,i=!0,r){var a=t;if(i&&(a=this.questionOnValueChanging(e,t)),!(this.isValidateOnValueChanging&&!this.validateOnValueChanging(e,a))&&!(!this.editingObj&&this.isValueEqual(e,a)&&this.isTwoValueEquals(a,t))){var o=this.getValue(e);this.isValueEmpyOnSetValue(e,a)?this.deleteDataValueCore(this.valuesHash,e):(a=this.getUnbindValue(a),this.setDataValueCore(this.valuesHash,e,a)),s=this.getLocNotification(s,a,o),this.updateOnSetValue(e,a,o,s,i,r)}}questionValueChanging(e,t){const s=e,i=s.parentQuestion;if(!i)return t;if(i.isDescendantOf("paneldynamic")&&!this.onDynamicPanelValueChanging.isEmpty){const r=i.getValueChangingOptions(s);if(r)return r.value=t,this.onDynamicPanelValueChanging.fire(this,r),r.value}return t}questionValueChanged(e,t){const s=e,i=s.parentQuestion;if(i&&i.isDescendantOf("paneldynamic")&&!this.onDynamicPanelValueChanged.isEmpty){const r=i.getValueChangingOptions(s);r&&(r.value=s.value,r.oldValue=t,this.onDynamicPanelValueChanged.fire(this,r))}}isValueEmpyOnSetValue(e,t){return this.isValueEmpty(t,!1)?!this.editingObj||t===null||t===void 0?!0:this.editingObj.getDefaultPropertyValue(e)===t:!1}updateOnSetValue(e,t,s,i=!1,r=!0,a){this.updateQuestionValue(e,t),!(i===!0||this.isDisposed||this.isRunningElementsBindings)&&(a=a||e,this.nofifyQuesitonHash[e]=!0,this.checkTriggersAndRunConditions(e,t,s),this.nofifyQuesitonHash[e]&&(r&&this.notifyQuestionOnValueChanged(e,t,a),i!=="text"&&this.tryGoNextPageAutomatic(e),delete this.nofifyQuesitonHash[e]))}isValueEqual(e,t){(t===""||t===void 0)&&(t=null);var s=this.getValue(e);return(s===""||s===void 0)&&(s=null),t===null||s===null?t===s:this.isTwoValueEquals(t,s)}doOnPageAdded(e){if(e.setSurveyImpl(this),e.name||(e.name=this.generateNewName(this.pages,"page")),this.questionHashesPanelAdded(e),this.updateVisibleIndexes(),!this.runningPages&&(this.isLoadingFromJson||(this.updateProgressText(),this.updateCurrentPage()),this.canFireAddPage())){var t={page:e};this.onPageAdded.fire(this,t)}}canFireAddPage(){return!this.isMovingPage}doOnPageRemoved(e){e.setSurveyImpl(null),!this.runningPages&&(e===this.currentPage&&this.updateCurrentPage(),this.updateVisibleIndexes(),this.updateProgressText(),this.updateLazyRenderingRowsOnRemovingElements())}generateNewName(e,t){for(var s={},i=0;i<e.length;i++)s[e[i].name]=!0;for(var r=1;s[t+r];)r++;return t+r}tryGoNextPageAutomatic(e){if(this.isEndLoadingFromJson||!this.autoAdvanceEnabled||!this.currentPage)return;const t=this.getQuestionByValueName(e);if(!t||t&&(!t.visible||!t.supportAutoAdvance())||!t.validate(!1)&&!t.supportGoNextPageError())return;if(this.currentSingleElement){const o=this.currentSingleElement,l=()=>{o===this.currentSingleElement&&(this.isLastElement?this.autoAdvanceAllowComplete&&this.tryCompleteOrShowPreview():this.performNext())};Ei.safeTimeOut(l,A.autoAdvanceDelay)}var s=this.getCurrentPageQuestions();if(s.indexOf(t)<0)return;for(var i=0;i<s.length;i++)if(s[i].hasInput&&s[i].isEmpty())return;if(this.isLastPage&&(this.autoAdvanceEnabled!==!0||!this.autoAdvanceAllowComplete)||!this.validateActivePage(!1))return;const r=this.currentPage,a=()=>{r===this.currentPage&&(this.isLastPage?this.tryCompleteOrShowPreview():this.nextPage())};Ei.safeTimeOut(a,A.autoAdvanceDelay)}tryCompleteOrShowPreview(){this.showPreviewBeforeComplete?this.showPreview():this.tryComplete()}getComment(e){return this.getValue(e+this.commentSuffix)||""}setComment(e,t,s=!1){if(t||(t=""),this.isTwoValueEquals(t,this.getComment(e)))return;const i=e+this.commentSuffix;t=this.questionOnValueChanging(i,t,e),s=this.getLocNotification(s,t,this.getComment(e)),this.isValueEmpty(t)?this.deleteDataValueCore(this.valuesHash,i):this.setDataValueCore(this.valuesHash,i,t);var r=this.getQuestionsByValueName(e);if(r)for(var a=0;a<r.length;a++)r[a].updateCommentFromSurvey(t),this.validateQuestionOnValueChanged(r[a]);s||this.checkTriggersAndRunConditions(e,this.getValue(e),void 0),s!=="text"&&this.tryGoNextPageAutomatic(e);var o=this.getQuestionByValueName(e);o&&(this.fireOnValueChanged(i,t,o),o.comment=t,o.comment!=t&&(o.comment=t))}clearValue(e){this.setValue(e,null),this.setComment(e,null)}get clearDisabledChoices(){return this.getPropertyValue("clearDisabledChoices",!1)}set clearDisabledChoices(e){this.setPropertyValue("clearDisabledChoices",e)}get clearValueOnDisableItems(){return this.clearDisabledChoices}set clearValueOnDisableItems(e){this.clearDisabledChoices=e}getQuestionClearIfInvisible(e){return this.isShowingPreview||this.runningPages?"none":e!=="default"?e:this.clearInvisibleValues}questionVisibilityChanged(e,t,s){s&&this.updateVisibleIndexes(e.page),t||this.changeCurrentSingleElementOnVisibilityChanged(),this.onQuestionVisibleChanged.fire(this,{question:e,name:e.name,visible:t})}pageVisibilityChanged(e,t){if(this.isLoadingFromJson)return;(t&&!this.currentPage||e===this.currentPage)&&this.updateCurrentPage(),this.updateVisibleIndexes(),t||this.changeCurrentSingleElementOnVisibilityChanged();const s=this.currentSingleElement,i=this.currentPage;s&&i&&s.page!==i&&(this.currentSingleElement=i.getFirstVisibleElement()),this.onPageVisibleChanged.fire(this,{page:e,visible:t})}panelVisibilityChanged(e,t){e.page&&(this.updateVisibleIndexes(e.page),t||this.changeCurrentSingleElementOnVisibilityChanged()),this.onPanelVisibleChanged.fire(this,{panel:e,visible:t})}questionCreated(e){this.onQuestionCreated.fire(this,{question:e})}questionAdded(e,t,s,i){e.name||(e.name=this.generateNewName(this.getAllQuestions(!1,!0),"question")),e.page&&this.questionHashesAdded(e),this.isLoadingFromJson||(this.currentPage||this.updateCurrentPage(),this.updateVisibleIndexes(e.page),this.setCalculatedWidthModeUpdater()),this.canFireAddElement()&&this.onQuestionAdded.fire(this,{question:e,name:e.name,index:t,parent:s,page:i,parentPanel:s,rootPanel:i})}canFireAddElement(){return!this.isMovingQuestion}questionRemoved(e){this.questionHashesRemoved(e,e.name,e.getValueName()),this.updateVisibleIndexes(e.page),this.onQuestionRemoved.fire(this,{question:e,name:e.name}),this.updateLazyRenderingRowsOnRemovingElements()}questionRenamed(e,t,s){this.questionHashesRemoved(e,t,s),this.questionHashesAdded(e)}questionHashesClear(){this.questionHashes.names={},this.questionHashes.namesInsensitive={},this.questionHashes.valueNames={},this.questionHashes.valueNamesInsensitive={}}questionHashesPanelAdded(e){if(!this.isLoadingFromJson)for(var t=e.questions,s=0;s<t.length;s++)this.questionHashesAdded(t[s])}questionHashesAdded(e){this.questionHashAddedCore(this.questionHashes.names,e,e.name),this.questionHashAddedCore(this.questionHashes.namesInsensitive,e,e.name.toLowerCase()),this.questionHashAddedCore(this.questionHashes.valueNames,e,e.getValueName()),this.questionHashAddedCore(this.questionHashes.valueNamesInsensitive,e,e.getValueName().toLowerCase())}questionHashesRemoved(e,t,s){t&&(this.questionHashRemovedCore(this.questionHashes.names,e,t),this.questionHashRemovedCore(this.questionHashes.namesInsensitive,e,t.toLowerCase())),s&&(this.questionHashRemovedCore(this.questionHashes.valueNames,e,s),this.questionHashRemovedCore(this.questionHashes.valueNamesInsensitive,e,s.toLowerCase()))}questionHashAddedCore(e,t,s){var i=e[s];if(i){var i=e[s];i.indexOf(t)<0&&i.push(t)}else e[s]=[t]}questionHashRemovedCore(e,t,s){var i=e[s];if(i){var r=i.indexOf(t);r>-1&&i.splice(r,1),i.length==0&&delete e[s]}}panelAdded(e,t,s,i){e.name||(e.name=this.generateNewName(this.getAllPanels(!1,!0),"panel")),this.questionHashesPanelAdded(e),this.updateVisibleIndexes(e.page),this.canFireAddElement()&&this.onPanelAdded.fire(this,{panel:e,name:e.name,index:t,parent:s,page:i,parentPanel:s,rootPanel:i})}panelRemoved(e){this.updateVisibleIndexes(e.page),this.onPanelRemoved.fire(this,{panel:e,name:e.name}),this.updateLazyRenderingRowsOnRemovingElements()}validateQuestion(e,t,s){if(!this.onValidateQuestion.isEmpty){var i={name:e.name,question:e,value:e.value,errors:t,error:null};this.onValidateQuestion.fire(this,i),i.error&&t.push(new vs(i.error,this))}s&&this.beforeSettingQuestionErrors(e,t)}validatePanel(e,t,s){if(e.isPanel&&!this.onValidatePanel.isEmpty){const i={name:e.name,panel:e,error:null,errors:t};this.onValidatePanel.fire(this,i),i.error&&t.push(new vs(i.error,this))}s&&this.makeRequiredErrorsInvisible(t)}processHtml(e,t){t||(t="");var s={html:e,reason:t};return this.onProcessHtml.fire(this,s),this.processText(s.html,!0)}getValueGetterContext(){return new XP(this,this.valuesHash,this.variablesHash)}processText(e,t){return this.processTextEx({text:e,returnDisplayValue:t,doEncoding:!1}).text}processTextEx(e){const t=e.doEncoding===void 0?A.web.encodeUrlParams:e.doEncoding;let s=e.text;(e.runAtDesign||!this.isDesignMode)&&(s=this.textPreProcessor.process(s,e.returnDisplayValue===!0,t,e.replaceUndefinedValues));const i={text:s,hasAllValuesOnLastRun:!0};return i.hasAllValuesOnLastRun=this.textPreProcessor.hasAllValuesOnLastRun,i}get textPreProcessor(){return this.textPreProcessorValue||(this.textPreProcessorValue=new Ry,this.textPreProcessorValue.onProcess=e=>{this.getProcessedTextValue(e)}),this.textPreProcessorValue}getSurveyMarkdownHtml(e,t,s,i){const r={element:e,text:t,name:s,item:i,html:null};return this.onTextMarkdown.fire(this,r),r.html}getCorrectedAnswerCount(){return this.getCorrectAnswerCount()}getCorrectAnswerCount(){return this.getCorrectedAnswerCountCore(!0)}getQuizQuestionCount(){for(var e=this.getQuizQuestions(),t=0,s=0;s<e.length;s++)t+=e[s].quizQuestionCount;return t}getInCorrectedAnswerCount(){return this.getIncorrectAnswerCount()}getInCorrectAnswerCount(){return this.getIncorrectAnswerCount()}getIncorrectAnswerCount(){return this.getCorrectedAnswerCountCore(!1)}onCorrectQuestionAnswer(e,t){this.onIsAnswerCorrect.isEmpty||(t.question=e,this.onIsAnswerCorrect.fire(this,t))}getCorrectedAnswerCountCore(e){var t=this.getQuizQuestions(),s=0;for(let i=0;i<t.length;i++){const r=t[i],a=r.correctAnswerCount;e?s+=a:s+=r.quizQuestionCount-a}return s}getCorrectedAnswers(){return this.getCorrectedAnswerCount()}getInCorrectedAnswers(){return this.getInCorrectedAnswerCount()}get showTimerPanel(){return this.showTimer?this.timerLocation:"none"}set showTimerPanel(e){this.showTimer=e!=="none",this.showTimer&&(this.timerLocation=e)}get showTimer(){return this.getPropertyValue("showTimer")}set showTimer(e){this.setPropertyValue("showTimer",e)}get timerLocation(){return this.getPropertyValue("timerLocation")}set timerLocation(e){this.setPropertyValue("timerLocation",e)}get isTimerPanelShowingOnTop(){return this.showTimer&&this.timerLocation==="top"}get isTimerPanelShowingOnBottom(){return this.showTimer&&this.timerLocation==="bottom"}get timerInfoMode(){return this.getTimerInfoVal(this.getPropertyValue("timerInfoMode"))}set timerInfoMode(e){this.setPropertyValue("timerInfoMode",e)}getTimerInfoVal(e){return e==="all"?"combined":e}get showTimerPanelMode(){const e=this.timerInfoMode;return e==="combined"?"all":e}set showTimerPanelMode(e){this.timerInfoMode=this.getTimerInfoVal(e)}updateGridColumns(){this.pages.forEach(e=>e.updateGridColumns())}get widthMode(){return this.getPropertyValue("widthMode")}set widthMode(e){this.setPropertyValue("widthMode",e)}setCalculatedWidthModeUpdater(){this.isLoadingFromJson||(this.calculatedWidthModeUpdater&&this.calculatedWidthModeUpdater.dispose(),this.calculatedWidthModeUpdater=new We(()=>this.calculateWidthMode()),this.calculatedWidthMode=this.calculatedWidthModeUpdater)}calculateWidthMode(){if(this.widthMode=="auto"){let e=!1;return this.isSingleVisibleInput||this.pages.forEach(t=>{t.needResponsiveWidth()&&(e=!0)}),e?"responsive":"static"}return this.widthMode}get width(){return this.getPropertyValue("width")}set width(e){this.setPropertyValue("width",e)}get renderedWidth(){const e=this.getPropertyValue("calculatedWidthMode")=="static";let t=this.getPropertyValue("width");if(this.isScaled&&this.responsiveStartWidth>1){let s=this.responsiveStartWidth;try{t=t||this.staticStartWidth,s=isNaN(t)?parseFloat(t.toString().replace("px","")):t}catch{}return(e?s:this.responsiveStartWidth)*this.widthScale/100+"px"}return t&&!isNaN(t)&&(t=t+"px"),e&&t||void 0}setStaticStartWidth(e){this.staticStartWidth=e}setResponsiveStartWidth(e){this.responsiveStartWidth=e}get isScaled(){return Math.abs(this.widthScale-100)>.001}get timerInfo(){return this.getTimerInfo()}get timerClock(){let e,t;if(this.currentPage){let{spent:s,limit:i,minorSpent:r,minorLimit:a}=this.getTimerInfo();i>0?e=this.getDisplayClockTime(i-s):e=this.getDisplayClockTime(s),r!==void 0&&(a>0?t=this.getDisplayClockTime(a-r):t=this.getDisplayClockTime(r))}return{majorText:e,minorText:t}}get timerInfoText(){const e={text:this.getTimerInfoText()};this.onTimerPanelInfoText.fire(this,e);var t=new At(this,!0);return t.text=e.text,t.textOrHtml}getTimerInfo(){let e=this.currentPage;if(!e)return{spent:0,limit:0};let t=e.timeSpent,s=this.timeSpent,i=e.getMaxTimeToFinish(),r=this.timeLimit;return this.timerInfoMode=="page"?{spent:t,limit:i}:this.timerInfoMode=="survey"?{spent:s,limit:r}:i>0&&r>0?{spent:t,limit:i,minorSpent:s,minorLimit:r}:i>0?{spent:t,limit:i,minorSpent:s}:r>0?{spent:s,limit:r,minorSpent:t}:{spent:t,minorSpent:s}}getTimerInfoText(){var e=this.currentPage;if(!e)return"";var t=this.getDisplayTime(e.timeSpent),s=this.getDisplayTime(this.timeSpent),i=e.getMaxTimeToFinish(),r=this.getDisplayTime(i),a=this.getDisplayTime(this.timeLimit);if(this.timerInfoMode=="page")return this.getTimerInfoPageText(e,t,r);if(this.timerInfoMode=="survey")return this.getTimerInfoSurveyText(s,a);if(this.timerInfoMode=="combined"){if(i<=0&&this.timeLimit<=0)return this.getLocalizationFormatString("timerSpentAll",t,s);if(i>0&&this.timeLimit>0)return this.getLocalizationFormatString("timerLimitAll",t,r,s,a);let o=this.getTimerInfoPageText(e,t,r),l=this.getTimerInfoSurveyText(s,a);return o+" "+l}return""}getTimerInfoPageText(e,t,s){return e&&e.getMaxTimeToFinish()>0?this.getLocalizationFormatString("timerLimitPage",t,s):this.getLocalizationFormatString("timerSpentPage",t,s)}getTimerInfoSurveyText(e,t){const s=this.timeLimit>0?"timerLimitSurvey":"timerSpentSurvey";return this.getLocalizationFormatString(s,e,t)}getDisplayClockTime(e){e<0&&(e=0);const t=Math.floor(e/60),s=e%60;let i=s.toString();return s<10&&(i="0"+i),`${t}:${i}`}getDisplayTime(e){const t=Math.floor(e/60),s=e%60;let i="";return t>0&&(i+=t+" "+this.getLocalizationString("timerMin")),i&&s==0?i:(i&&(i+=" "),i+s+" "+this.getLocalizationString("timerSec"))}get timerModel(){return this.timerModelValue}startTimer(){this.isEditMode&&this.timerModel.start()}startTimerFromUI(){this.showTimer&&this.state==="running"&&this.startTimer()}stopTimer(){this.timerModel.stop()}get timeSpent(){return this.timerModel.spent}set timeSpent(e){this.timerModel.spent=e}get timeLimit(){return this.getPropertyValue("timeLimit",0)}set timeLimit(e){this.setPropertyValue("timeLimit",e)}get maxTimeToFinish(){return this.timeLimit}set maxTimeToFinish(e){this.timeLimit=e}get timeLimitPerPage(){return this.getPropertyValue("timeLimitPerPage",0)}set timeLimitPerPage(e){this.setPropertyValue("timeLimitPerPage",e)}get maxTimeToFinishPage(){return this.timeLimitPerPage}set maxTimeToFinishPage(e){this.timeLimitPerPage=e}doTimer(e){if(this.onTimerTick.fire(this,{}),this.timeLimit>0&&this.timeLimit<=this.timeSpent&&(this.timeSpent=this.timeLimit,this.tryComplete()),e){var t=e.getMaxTimeToFinish();t>0&&t==e.timeSpent&&(this.isLastPage?this.tryComplete():this.nextPage())}}get inSurvey(){return!0}getSurveyData(){return this}getSurvey(){return this}getTextProcessor(){return this}getObjects(e,t){var s=[];return Array.prototype.push.apply(s,this.getPagesByNames(e)),Array.prototype.push.apply(s,this.getQuestionsByNames(t)),s}setTriggerValue(e,t,s){if(e)if(s)this.setVariable(e,t);else{this.startSetValueFromTrigger();const i=new Ii().getValueInfo({name:e,context:this.getValueGetterContext(),createObjects:!0});i.isFound&&i.question?i.question.value=t:e.indexOf(".")<0&&this.setValue(e,t),this.finishSetValueFromTrigger()}}copyTriggerValue(e,t,s){if(!e||!t)return;const i=new Ii().getValueInfo({name:t,context:this.getValueGetterContext(),createObjects:!0,isText:s,isDisplayValue:s});i.isFound&&this.setTriggerValue(e,O.getUnbindValue(i.value),!1)}triggerExecuted(e){this.onTriggerExecuted.fire(this,{trigger:e})}get isSettingValueFromTrigger(){return this.setValueFromTriggerCounter>0}startSetValueFromTrigger(){this.setValueFromTriggerCounter++}finishSetValueFromTrigger(){this.setValueFromTriggerCounter--}startMovingQuestion(){this.isMovingQuestion=!0}stopMovingQuestion(){this.isMovingQuestion=!1}get isQuestionDragging(){return this.isMovingQuestion}startMovingPage(){this.isMovingPage=!0}stopMovingPage(){this.isMovingPage=!1}focusQuestion(e){return this.focusQuestionByInstance(this.getQuestionByName(e,!0))}focusQuestionByInstance(e,t=!1){var s;if(!e||!e.isVisible||!e.page||((s=this.focusingQuestionInfo)===null||s===void 0?void 0:s.question)===e)return!1;this.focusingQuestionInfo={question:e,onError:t};const r=this.currentSingleElement;this.skippedPages.push({from:r||this.currentPage,to:r?e:e.page});const a=this.activePage!==e.page&&!e.page.isStartPage;return a&&(this.currentPage=e.page),this.isSingleVisibleQuestion&&!this.isDesignMode&&(this.currentSingleElement=e),a||this.focusQuestionInfo(),!0}focusQuestionInfo(){var e;const t=(e=this.focusingQuestionInfo)===null||e===void 0?void 0:e.question;t&&!t.isDisposed&&t.focus(this.focusingQuestionInfo.onError),this.focusingQuestionInfo=void 0}questionEditFinishCallback(e,t){const s=this.enterKeyAction||A.enterKeyAction;if(s=="loseFocus"&&t.target.blur(),s=="moveToNextEditor"){const i=this.currentPage.questions,r=i.indexOf(e);r>-1&&r<i.length-1?i[r+1].focus():t.target.blur()}}elementWrapperComponentNameCore(e,t,s,i,r){if(this.onElementWrapperComponentName.isEmpty)return e;const a={componentName:e,element:t,wrapperName:s,reason:i,item:r};return this.onElementWrapperComponentName.fire(this,a),a.componentName}elementWrapperDataCore(e,t,s,i,r){if(this.onElementWrapperComponentData.isEmpty)return e;const a={data:e,element:t,wrapperName:s,reason:i,item:r};return this.onElementWrapperComponentData.fire(this,a),a.data}getElementWrapperComponentName(e,t){const s=t==="logo-image"?"sv-logo-image":Kr.TemplateRendererComponentName;return this.elementWrapperComponentNameCore(s,e,"component",t)}getQuestionContentWrapperComponentName(e){return this.elementWrapperComponentNameCore(Kr.TemplateRendererComponentName,e,"content-component")}getRowWrapperComponentName(e){return this.elementWrapperComponentNameCore(Kr.TemplateRendererComponentName,e,"row")}getItemValueWrapperComponentName(e,t){return this.elementWrapperComponentNameCore(Kr.TemplateRendererComponentName,t,"itemvalue",void 0,e)}getElementWrapperComponentData(e,t){return this.elementWrapperDataCore(e,e,"component",t)}getRowWrapperComponentData(e){return this.elementWrapperDataCore(e,e,"row")}getItemValueWrapperComponentData(e,t){return this.elementWrapperDataCore(e,t,"itemvalue",void 0,e)}getMatrixCellTemplateData(e){const t=e.question;return this.elementWrapperDataCore(t,t,"cell")}searchText(e){e&&(e=e.toLowerCase());for(var t=[],s=0;s<this.pages.length;s++)this.pages[s].searchText(e,t);return t}getSkeletonComponentName(e){return this.skeletonComponentName}addLayoutElement(e){const t=this.removeLayoutElement(e.id);return this.layoutElements.push(e),t}findLayoutElement(e){return this.layoutElements.filter(s=>s.id===e)[0]}removeLayoutElement(e){const t=this.findLayoutElement(e);if(t){const s=this.layoutElements.indexOf(t);this.layoutElements.splice(s,1)}return t}getContainerContent(e){const t=new Array;for(let s of this.layoutElements)if(this.mode!=="display"&&li(s.id,"timerpanel"))e==="header"&&this.isTimerPanelShowingOnTop&&!this.isStartPageActive&&t.push(s),e==="footer"&&this.isTimerPanelShowingOnBottom&&!this.isStartPageActive&&t.push(s);else if(this.state==="running"&&li(s.id,this.progressBarComponentName)){if(this.questionsOnPageMode!="singlePage"||this.progressBarType=="questions"){const i=this.findLayoutElement("advanced-header"),r=i&&i.data;let a=!r||r.hasBackground;li(this.progressBarLocation,"aboveHeader")&&(a=!1),li(this.progressBarLocation,"belowHeader")&&(a=!0),this.showTOC&&!(r&&r.hasBackground)&&this.isShowProgressBarOnTop&&!this.isStartPageActive?e==="center"&&(a?delete s.index:s.index=-150,t.push(s)):(e==="header"&&!a&&(s.index=-150,this.isShowProgressBarOnTop&&!this.isStartPageActive&&t.push(s)),e==="center"&&a&&(s.index&&delete s.index,this.isShowProgressBarOnTop&&!this.isStartPageActive&&t.push(s))),e==="footer"&&this.isShowProgressBarOnBottom&&!this.isStartPageActive&&t.push(s)}}else if(li(s.id,"buttons-navigation-top"))e==="contentTop"&&this.isNavigationButtonsShowingOnTop&&t.push(s);else if(li(s.id,"buttons-navigation"))e==="contentBottom"&&this.isNavigationButtonsShowingOnBottom&&t.push(s);else if(this.state==="running"&&li(s.id,"toc-navigation")&&this.showTOC)e==="left"&&["left","both"].indexOf(this.tocLocation)!==-1&&t.push(s),e==="right"&&["right","both"].indexOf(this.tocLocation)!==-1&&t.push(s);else if(li(s.id,"advanced-header")){if(this.state==="running"||this.state==="starting"||this.showHeaderOnCompletePage===!0&&this.state==="completed"){const i=s&&s.data;this.showTOC&&!(i&&i.hasBackground)?e==="contentTop"&&t.push(s):s.container===e&&t.push(s)}}else(Array.isArray(s.container)&&s.container.indexOf(e)!==-1||s.container===e)&&t.push(s);return t.sort((s,i)=>(s.index||0)-(i.index||0)),t.forEach(s=>{s.getData&&(s.data=s.getData())}),t}processPopupVisiblityChanged(e,t,s){this.onPopupVisibleChanged.fire(this,{question:e,popup:t,visible:s})}processOpenDropdownMenu(e,t){const s=Object.assign({question:e},t);this.onOpenDropdownMenu.fire(this,s),t.menuType=s.menuType}getCssTitleExpandableSvg(){return null}createCustomChoiceItem(e){this.onCreateCustomChoiceItem.fire(this,e)}applyTheme(e){if(e){if(Object.keys(e).forEach(t=>{t!=="header"&&(t==="isPanelless"?this.isCompact=e[t]:this[t]=e[t])}),"header"in e&&!e.headerView&&(this.headerView="advanced"),this.headerView!=="basic"){this.removeLayoutElement("advanced-header");const t=new $e;t.fromTheme(e),this.insertAdvancedHeader(t)}this.themeChanged(e)}}themeChanged(e){this.getAllQuestions().forEach(t=>t.themeChanged(e))}waitAndExecute(e){this.taskManager.waitAndExecute(e)}dispose(){if(this.unConnectEditingObj(),this.removeScrollEventListener(),this.destroyResizeObserver(),this.rootElement=void 0,this.layoutElements){for(var e=0;e<this.layoutElements.length;e++)this.layoutElements[e].data&&this.layoutElements[e].data!==this&&this.layoutElements[e].data.dispose&&this.layoutElements[e].data.dispose();this.layoutElements.splice(0,this.layoutElements.length)}if(super.dispose(),this.editingObj=null,!!this.pages){this.currentPage=null;for(var e=0;e<this.pages.length;e++)this.pages[e].setSurveyImpl(void 0),this.pages[e].dispose();this.pages.splice(0,this.pages.length),this.disposeCallback&&this.disposeCallback()}}_isElementShouldBeSticky(e){var t;if(!e)return!1;const s=(t=this.scrollerElement)===null||t===void 0?void 0:t.querySelector(e);return s?!!this.scrollerElement&&this.scrollerElement.scrollTop>0&&s.getBoundingClientRect().y<=this.scrollerElement.getBoundingClientRect().y:!1}get rootScrollDisabled(){return!(this.fitToContainer&&this.formScrollDisabled)}get formScrollDisabled(){return!this.backgroundImage||this.backgroundImageAttachment!=="fixed"}onScroll(){this.rootElement&&(this._isElementShouldBeSticky(".sv-components-container-center")?this.rootElement.classList&&this.rootElement.classList.add("sv-root--sticky-top"):this.rootElement.classList&&this.rootElement.classList.remove("sv-root--sticky-top"),this.tocModel&&this.tocModel.updateStickyTOCSize(this.rootElement)),this.onScrollCallback&&this.onScrollCallback()}addScrollEventListener(){this.scrollHandler=()=>{this.onScroll()},this.rootElement.addEventListener("scroll",this.scrollHandler),this.rootElement.getElementsByTagName("form")[0]&&this.rootElement.getElementsByTagName("form")[0].addEventListener("scroll",this.scrollHandler),this.scrollerElement&&this.scrollerElement.addEventListener("scroll",this.scrollHandler)}removeScrollEventListener(){this.rootElement&&this.scrollHandler&&(this.rootElement.removeEventListener("scroll",this.scrollHandler),this.rootElement.getElementsByTagName("form")[0]&&this.rootElement.getElementsByTagName("form")[0].removeEventListener("scroll",this.scrollHandler),this.scrollerElement&&this.scrollerElement.removeEventListener("scroll",this.scrollHandler))}};Ee.TemplateRendererComponentName="sv-template-renderer",Ee.platform="unknown",S([E()],Ee.prototype,"completedCss",void 0),S([E()],Ee.prototype,"completedBeforeCss",void 0),S([E()],Ee.prototype,"loadingBodyCss",void 0),S([E()],Ee.prototype,"containerCss",void 0),S([E({onSet:(n,e)=>{e.updateCss()}})],Ee.prototype,"fitToContainer",void 0),S([E({onSet:(n,e)=>{if(n==="basic")e.removeLayoutElement("advanced-header");else if(!e.findLayoutElement("advanced-header")){const s=new $e;e.insertAdvancedHeader(s)}}})],Ee.prototype,"headerView",void 0),S([E()],Ee.prototype,"showBrandInfo",void 0),S([E()],Ee.prototype,"enterKeyAction",void 0),S([E()],Ee.prototype,"lazyRenderFirstBatchSizeValue",void 0),S([E({defaultValue:{}})],Ee.prototype,"cssVariables",void 0),S([E()],Ee.prototype,"_isMobile",void 0),S([E()],Ee.prototype,"_isCompact",void 0),S([E({onSet:(n,e)=>{e.updateCss()}})],Ee.prototype,"backgroundImage",void 0),S([E()],Ee.prototype,"backgroundImageFit",void 0),S([E({onSet:(n,e)=>{e.updateCss()}})],Ee.prototype,"backgroundImageAttachment",void 0),S([E()],Ee.prototype,"wrapperFormCss",void 0),S([E({getDefaultValue:n=>n.progressBarType==="buttons"})],Ee.prototype,"progressBarShowPageTitles",void 0),S([E()],Ee.prototype,"progressBarShowPageNumbers",void 0),S([E()],Ee.prototype,"progressBarInheritWidthFrom",void 0),S([E({defaultValue:!0})],Ee.prototype,"validationEnabled",void 0),S([E()],Ee.prototype,"rootCss",void 0),S([E({onSet:(n,e)=>{e.updateGridColumns()}})],Ee.prototype,"gridLayoutEnabled",void 0),S([E()],Ee.prototype,"calculatedWidthMode",void 0),S([E({defaultValue:100,onSet(n,e,t){e.pages.forEach(s=>s.updateRootStyle())}})],Ee.prototype,"widthScale",void 0),S([E()],Ee.prototype,"staticStartWidth",void 0),S([E()],Ee.prototype,"responsiveStartWidth",void 0),S([Nt()],Ee.prototype,"layoutElements",void 0);function li(n,e){return!n||!e?!1:n.toUpperCase()===e.toUpperCase()}q.addClass("survey",[{name:"locale",choices:()=>is.getLocales(!0),onGetValue:n=>n.locale==is.defaultLocale?null:n.locale},{name:"title",serializationProperty:"locTitle",dependsOn:"locale"},{name:"description:text",serializationProperty:"locDescription",dependsOn:"locale"},{name:"logo:file",serializationProperty:"locLogo"},{name:"logoWidth",default:"auto",minValue:0},{name:"logoHeight",default:"40px",minValue:0},{name:"logoFit",default:"contain",choices:["none","contain","cover","fill"]},{name:"logoPosition",default:"left",choices:["none","left","right","top","bottom"]},{name:"autoFocusFirstQuestion:boolean",alternativeName:"focusFirstQuestionAutomatic"},{name:"autoFocusFirstError:boolean",default:!0,alternativeName:"focusOnFirstError"},{name:"completedHtml:html",serializationProperty:"locCompletedHtml"},{name:"completedBeforeHtml:html",serializationProperty:"locCompletedBeforeHtml"},{name:"completedHtmlOnCondition:htmlconditions",className:"htmlconditionitem",isArray:!0},{name:"loadingHtml:html",serializationProperty:"locLoadingHtml"},{name:"pages:surveypages",className:"page",isArray:!0,onSerializeValue:n=>n.originalPages||n.pages},{name:"elements",alternativeName:"questions",baseClassName:"question",visible:!1,isLightSerializable:!1,onGetValue:function(n){return null},onSetValue:function(n,e,t){n.pages.splice(0,n.pages.length);var s=n.addNewPage("");t.toObject({questions:e},s,t?.options)}},{name:"triggers:triggers",baseClassName:"surveytrigger",classNamePart:"trigger"},{name:"calculatedValues:calculatedvalues",className:"calculatedvalue",isArray:!0},{name:"sjsVersion",visible:!1},{name:"surveyId",visible:!1},{name:"surveyPostId",visible:!1},{name:"surveyShowDataSaving:boolean",visible:!1},"cookieName",{name:"partialSendEnabled:boolean",alternativeName:"sendResultOnPageNext"},{name:"showNavigationButtons:boolean",default:!0},{name:"navigationButtonsLocation",default:"bottom",choices:["top","bottom","topBottom"]},{name:"showPrevButton:boolean",default:!0,visibleIf:n=>n.showNavigationButtons!=="none"},{name:"showTitle:boolean",default:!0},{name:"showPageTitles:boolean",default:!0},{name:"showCompletePage:boolean",default:!0,alternativeName:"showCompletedPage"},"navigateToUrl",{name:"navigateToUrlOnCondition:urlconditions",className:"urlconditionitem",isArray:!0},{name:"questionOrder",alternativeName:"questionsOrder",default:"initial",choices:["initial","random"]},{name:"matrixDragHandleArea",visible:!1,default:"entireItem",choices:["entireItem","icon"]},"showPageNumbers:boolean",{name:"showQuestionNumbers",default:"off",choices:["on","onPage","recursive","off"]},{name:"questionTitleLocation",default:"top",choices:["top","bottom","left"]},{name:"questionDescriptionLocation",default:"underTitle",choices:["underInput","underTitle"]},{name:"questionErrorLocation",default:"top",choices:["top","bottom"]},{name:"showProgressBar:boolean",default:!1,onSetValue:(n,e,t)=>{n&&n.setShowProgressBar(e)}},{name:"progressBarLocation",default:"auto",choices:["auto","aboveheader","belowheader","bottom","topbottom"],visibleIf:n=>n.showProgressBar},{name:"progressBarType",default:"pages",choices:["pages","questions","requiredQuestions","correctQuestions"],visibleIf:n=>n.showProgressBar},{name:"progressBarShowPageTitles:switch",category:"navigation",visibleIf:n=>n.showProgressBar&&n.progressBarType==="pages"},{name:"progressBarShowPageNumbers:switch",default:!1,category:"navigation",visibleIf:n=>n.showProgressBar&&n.progressBarType==="pages"},{name:"progressBarInheritWidthFrom",default:"container",choices:["container","survey"],category:"navigation",visibleIf:n=>n.showProgressBar&&n.progressBarType==="pages"},{name:"showTOC:switch",default:!1},{name:"tocLocation",default:"left",choices:["left","right"],dependsOn:["showTOC"],visibleIf:n=>!!n&&n.showTOC},{name:"readOnly:boolean"},{name:"mode",visible:!1,isSerializable:!1},{name:"storeOthersAsComment:boolean",default:!0},{name:"maxTextLength:number",default:0,minValue:0},{name:"maxCommentLength:number",default:0,minValue:0,alternativeName:"maxOthersLength"},{name:"autoAdvanceEnabled:boolean",alternativeName:"goNextPageAutomatic",onSetValue:function(n,e){e!=="autogonext"&&(e=O.isTwoValueEquals(e,!0)),e==="autogonext"&&(e=!0),n.setPropertyValue("autoAdvanceEnabled",e)}},{name:"autoAdvanceAllowComplete:boolean",default:!0,alternativeName:"allowCompleteSurveyAutomatic",visibleIf:n=>n.autoAdvanceEnabled===!0},{name:"clearInvisibleValues",default:"onComplete",choices:["none","onComplete","onHidden","onHiddenContainer"]},{name:"checkErrorsMode",default:"onNextPage",choices:["onNextPage","onValueChanged","onComplete"]},{name:"validateVisitedEmptyFields:boolean",dependsOn:"checkErrorsMode",visibleIf:n=>n.checkErrorsMode==="onValueChanged"},{name:"textUpdateMode",default:"onBlur",choices:["onBlur","onTyping"]},{name:"autoGrowComment:boolean",default:!1},{name:"allowResizeComment:boolean",default:!0},{name:"commentAreaRows:number",minValue:1},{name:"startSurveyText",serializationProperty:"locStartSurveyText",visibleIf:n=>n.firstPageIsStartPage},{name:"pagePrevText",serializationProperty:"locPagePrevText",visibleIf:n=>n.showNavigationButtons!=="none"&&n.showPrevButton},{name:"pageNextText",serializationProperty:"locPageNextText",visibleIf:n=>n.showNavigationButtons!=="none"},{name:"completeText",serializationProperty:"locCompleteText",visibleIf:n=>n.showNavigationButtons!=="none"},{name:"previewText",serializationProperty:"locPreviewText",visibleIf:n=>n.showPreviewBeforeComplete},{name:"editText",serializationProperty:"locEditText",visibleIf:n=>n.showPreviewBeforeComplete},{name:"requiredMark",default:"*",alternativeName:"requiredText"},{name:"questionStartIndex",dependsOn:["showQuestionNumbers"],visibleIf:n=>!n||n.showQuestionNumbers!=="off"},{name:"questionTitlePattern",default:"numTitleRequire",dependsOn:["questionStartIndex","requiredMark"],choices:n=>n?n.getQuestionTitlePatternOptions():[]},{name:"questionTitleTemplate",visible:!1,isSerializable:!1,serializationProperty:"locQuestionTitleTemplate"},{name:"firstPageIsStartPage:boolean",default:!1,alternativeName:"firstPageIsStarted"},{name:"isSinglePage:boolean",default:!1,visible:!1,isSerializable:!1},{name:"questionsOnPageMode",default:"standard",choices:["standard","singlePage","questionPerPage","inputPerPage"]},{name:"showPreviewBeforeComplete:boolean",default:!1,onSetValue:(n,e,t)=>{n&&n.setShowPreviewBeforeComplete(e)}},{name:"previewMode",default:"allQuestions",choices:["allQuestions","answeredQuestions"],visibleIf:n=>n.showPreviewBeforeComplete},{name:"showTimer:boolean"},{name:"timeLimit:number",alternativeName:"maxTimeToFinish",default:0,minValue:0,enableIf:n=>n.showTimer},{name:"timeLimitPerPage:number",alternativeName:"maxTimeToFinishPage",default:0,minValue:0,enableIf:n=>n.showTimer},{name:"timerLocation",default:"top",choices:["top","bottom"],enableIf:n=>n.showTimer},{name:"timerInfoMode",alternativeName:"showTimerPanelMode",default:"combined",choices:["page","survey","combined"],enableIf:n=>n.showTimer},{name:"showTimerPanel",visible:!1,isSerializable:!1},{name:"widthMode",default:"auto",choices:["auto","static","responsive"]},{name:"gridLayoutEnabled:boolean",default:!1},{name:"width",visibleIf:n=>n.widthMode==="static"},{name:"fitToContainer:boolean",default:!0,visible:!1},{name:"headerView",default:"basic",choices:["basic","advanced"],visible:!1},{name:"backgroundImage:file",visible:!1},{name:"backgroundImageFit",default:"cover",choices:["auto","contain","cover"],visible:!1},{name:"backgroundImageAttachment",default:"scroll",choices:["scroll","fixed"],visible:!1},{name:"backgroundOpacity:number",minValue:0,maxValue:1,default:1,visible:!1},{name:"showBrandInfo:boolean",default:!1,visible:!1}]);let co=class extends Ce{getBaseType(){return"choiceitem"}get choiceOwner(){return this.locOwner}get showCommentArea(){return this.getPropertyValue("showCommentArea")}get supportElements(){var e;return((e=this.choiceOwner)===null||e===void 0?void 0:e.supportElementsInChoice())===!0}set showCommentArea(e){e&&!this.supportComment&&(e=!1),this.setPropertyValue("showCommentArea",e)}get isCommentRequired(){return this.getPropertyValue("isCommentRequired")}set isCommentRequired(e){this.setPropertyValue("isCommentRequired",e)}get isCommentShowing(){return this.getPropertyValue("isCommentShowing",!1)}get locCommentPlaceholder(){return this.locCommentPlaceholderValue||this.createCommentPlaceholder(),this.locCommentPlaceholderValue}createCommentPlaceholder(){const e=new At(this,!0,"commentPlaceholder");e.onChanged=()=>{this.setPropertyValue("commentPlaceholder",this.locCommentPlaceholderValue.text)},this.locCommentPlaceholderValue=e}get commentPlaceholder(){return this.locCommentPlaceholder.text}set commentPlaceholder(e){this.locCommentPlaceholder.text=e}setIsCommentShowing(e){this.setPropertyValue("isCommentShowing",e)}get supportComment(){const e=this.locOwner;return!e||!e.supportMultipleComment?!1:e.supportMultipleComment(this)}canAddPpropertyToJSON(e){return e.name==="commentPlaceholder"?!!this.locCommentPlaceholderValue:super.canAddPpropertyToJSON(e)}onLocOwnerChanged(){this.showCommentArea&&!this.supportComment&&(this.showCommentArea=!1),this.setPanelSurvey(this.panelValue)}get onExpandPanelAtDesign(){return this.onExpandPanelAtDesignValue||(this.onExpandPanelAtDesignValue=new Zt),this.onExpandPanelAtDesignValue}get isPanelShowing(){return!this.panelValue||!this.choiceOwner?!1:this.hasElements&&this.choiceOwner.isItemSelected(this)===!0}get hasElements(){const e=this.panelValue;return!!e&&e.elements.length>0}get panel(){return this.panelValue||(this.panelValue=this.createPanel()),this.panelValue}get isPanelCreated(){return!!this.panelValue}get elements(){return this.panel.elements}panelFirstRendering(){this.hasElements&&this.isPanelShowing&&this.panel.onFirstRendering()}createPanel(){const e=q.createClass("panel");return e.renderWidth="100%",e.isInteractiveDesignElement=!1,e.showTitle=!1,e.isInternalNested=!0,e.choiceItem=this,this.setPanelSurvey(e),e}setPanelSurvey(e){var t;if(e&&!e.survey){e.selectedElementInDesign=this.choiceOwner;const s=(t=this.choiceOwner)===null||t===void 0?void 0:t.getSurvey();s&&(e.name="choicePanel"+e.uniqueId,e.parent=this.choiceOwner.parent,e.setSurveyImpl(s))}}dispose(){var e;super.dispose(),(e=this.panelValue)===null||e===void 0||e.dispose(),this.panelValue=void 0}},ih=class extends Dt{get waitingChoicesByURL(){return!this.isChoicesLoaded&&this.hasChoicesUrl}get selectedItemValues(){return this.getPropertyValue("selectedItemValues")}set selectedItemValues(e){this.setPropertyValue("selectedItemValues",e)}constructor(e){super(e),this.isRunningChoices=!1,this.isFirstLoadChoicesFromUrl=!0,this.isUpdatingChoicesDependedQuestions=!1,this._renderedChoices=[],this.renderedChoicesAnimation=new Wi(this.getRenderedChoicesAnimationOptions(),s=>{this._renderedChoices=s,this.renderedChoicesChangedCallback&&this.renderedChoicesChangedCallback()},()=>this._renderedChoices),this.headItemsCount=0,this.footItemsCount=0,this.otherItemValue=this.createItemValue("other"),this.otherItem.showCommentArea=!0,this.otherItem.isCommentRequired=!0,this.noneItemValue=this.createNoneItem(A.noneItemValue,"noneText","noneItemText"),this.refuseItemValue=this.createNoneItem(A.refuseItemValue,"refuseText","refuseItemText"),this.dontKnowItemValue=this.createNoneItem(A.dontKnowItemValue,"dontKnowText","dontKnowItemText"),this.createItemValues("choices"),this.registerPropertyChangedHandlers(["choices"],()=>{this.filterItems()||this.onVisibleChoicesChanged()}),this.createItemValues("customChoices"),this.registerPropertyChangedHandlers(["customChoices"],()=>{this.onVisibleChoicesChanged()}),this.registerPropertyChangedHandlers(["choicesFromQuestion","choicesFromQuestionMode","choiceValuesFromQuestion","choiceTextsFromQuestion","showNoneItem","showRefuseItem","showDontKnowItem","isUsingRestful","isMessagePanelVisible"],()=>{this.onVisibleChoicesChanged()}),this.registerPropertyChangedHandlers(["hideIfChoicesEmpty"],()=>{this.onVisibleChanged()}),this.registerPropertyChangedHandlers(["selecteditemValues"],s=>{this.onSelectedItemValuesChangedHandler(s)}),this.createNewArray("visibleChoices",()=>this.updateRenderedChoices(),()=>this.updateRenderedChoices()),this.setNewRestfulProperty();const t=this.createLocalizableString("otherText",this.otherItemValue,!0,"otherItemText");this.createLocalizableString("otherErrorText",this,!0,"otherRequiredError"),this.createLocString({name:"otherPlaceholder",hasTranslation:!0}),this.otherItemValue.setLocText(t),this.choicesByUrl.createItemValue=s=>this.createItemValue(s),this.choicesByUrl.beforeSendRequestCallback=()=>{this.onBeforeSendRequest()},this.choicesByUrl.getResultCallback=s=>{this.onLoadChoicesFromUrl(s)},this.choicesByUrl.updateResultCallback=(s,i)=>this.survey?this.survey.updateChoicesFromServer(this,s,i):s}getType(){return"selectbase"}dispose(){super.dispose();const e=this.getQuestionWithChoices();e&&e.removeDependedQuestion(this);const t=this.commentAreaModelValues;t&&Object.keys(t).forEach(s=>{t[s].dispose()}),this.doForPanels(void 0,s=>s.dispose())}supportElementsInChoice(){return!1}getPanels(){if(!this.supportElementsInChoice())return super.getPanels();const e=new Array;return this.choices.forEach(t=>{t.isPanelCreated&&e.push(t.panel)}),e}getVisiblePanels(e){if(!this.supportElementsInChoice())return null;const t=new Array;return this.choices.forEach(s=>{s.isPanelCreated&&s.isPanelShowing===e&&t.push(s.panel)}),t}doForPanels(e,t){const s=e!==void 0?this.getVisiblePanels(e):this.getPanels();Array.isArray(s)&&s.forEach(t)}collectNestedQuestionsCore(e,t,s,i){e.push(this),s&&this.supportElementsInChoice()&&this.choices.forEach(r=>{r.hasElements&&(!t||r.isPanelShowing)&&r.panel.questions.forEach(a=>a.addNestedQuestion(e,t,s,i))})}getElementsInDesign(e=!1){if(!this.supportElementsInChoice())return[];const t=new Array;return this.choices.forEach(s=>{s.hasElements&&(e?t.push(s.panel):t.push(...s.elements))}),t}get otherTextAreaModel(){return this.getCommentTextAreaModel(this.otherItem)}getCommentTextAreaModel(e){const t=e?.value;if(t===void 0)return null;this.commentAreaModelValues||(this.commentAreaModelValues={});const s=this.commentAreaModelValues;return s[t]||(s[t]=new $u(this.getOtherTextAreaOptions(e))),s[t]}getOtherTextAreaOptions(e){return{question:this,id:()=>this.getItemCommentId(e),propertyNames:[this.getCommentPropertyValue(e)],className:()=>this.cssClasses.comment,placeholder:()=>this.getCommentPlaceholder(e),isDisabledAttr:()=>this.isInputReadOnly||!1,rows:()=>this.commentAreaRows,maxLength:()=>this.getOthersMaxLength(),autoGrow:()=>this.survey&&this.survey.autoGrowComment,ariaRequired:()=>this.ariaRequired||this.a11y_input_ariaRequired,ariaLabel:()=>this.ariaLabel||this.a11y_input_ariaLabel,getTextValue:()=>this.getCommentValueCore(e),onTextAreaChange:s=>{this.onOtherValueChange(e,s)},onTextAreaInput:s=>{this.onOtherValueInput(e,s)}}}getCommentPlaceholder(e){if(e.commentPlaceholder)return e.commentPlaceholder;if(this.isOtherItemByValue(e))return this.otherPlaceholder;const t=this.commentPlaceholder;return new no(e).processText(t,!0)}resetDependedQuestion(){this.choicesFromQuestion=""}get otherId(){return this.getItemCommentId(this.otherItem)}getItemCommentId(e){return this.id+"_"+e.uniqueId}getCommentElementsId(){return[this.commentId,this.otherId]}getItemValueType(){return"choiceitem"}createItemValue(e,t){const s=q.createClass(this.getItemValueType(),{value:e});return s.locOwner=this,t&&(s.text=t),s}validateElementCore(e){e.isOnValueChanged!==!0&&this.clearIncorrectValues();let t=!0;return this.doForPanels(!0,s=>{t&&(t=s.validateElement(e))}),super.validateElementCore(e)&&t}get isUsingCarryForward(){return!!this.carryForwardQuestionType}get carryForwardQuestionType(){return this.getPropertyValue("carryForwardQuestionType")}setCarryForwardQuestionType(e,t){const s=e?"select":t?"array":void 0;this.setPropertyValue("carryForwardQuestionType",s)}get isUsingRestful(){return this.getPropertyValueWithoutDefault("isUsingRestful")||!1}updateIsUsingRestful(){this.setPropertyValueDirectly("isUsingRestful",this.hasChoicesUrl)}supportGoNextPageError(){return!this.isOtherSelected||!!this.otherValue}isLayoutTypeSupported(e){return!0}localeChanged(){super.localeChanged(),this.choicesOrder!=="none"&&(this.updateVisibleChoices(),this.onVisibleChoicesChanged())}locStrsChanged(){super.locStrsChanged(),this.choicesFromUrl&&(Ce.locStrsChanged(this.choicesFromUrl),Ce.locStrsChanged(this.visibleChoices)),this.isUsingCarryForward&&Ce.locStrsChanged(this.visibleChoices)}updatePrevOtherErrorValue(e){const t=this.otherValue;e!==t&&(this.prevOtherErrorValue=t)}get otherValue(){return this.getStoreOthersAsComment()?this.getQuestionComment():this.otherValueCore}trimCommentValue(e){if(!(e===""||e&&e.toString().trim()===""))return e}set otherValue(e){e=this.trimCommentValue(e),!this.isSettingComment&&this.otherValue!==e&&(this.onUpdateCommentOnAutoOtherMode(e),this.updatePrevOtherErrorValue(e),this.isSettingComment=!0,this.getStoreOthersAsComment()?this.setNewComment(e):(this.otherValueCore=e,this.isOtherSelected&&!this.isRenderedValueSetting&&(this.value=this.getValueOnSettingOther(e))),this.isSettingComment=!1,this.updateChoicesDependedQuestions())}get otherValueCore(){return this.getPropertyValue("otherValue")}set otherValueCore(e){this.setPropertyValue("otherValue",e)}get otherItem(){return this.otherItemValue}get isOtherSelected(){return this.showOtherItem&&this.getHasOther(this.renderedValue)}get isNoneSelected(){return this.showNoneItem&&this.getIsItemValue(this.renderedValue,this.noneItem)}supportMultipleComment(e){return!0}isCommentShowing(e){return e&&e.showCommentArea&&this.isItemSelected(e)}getCommentValue(e){return this.isCommentShowing(e)&&this.getCommentValueCore(e)||""}setCommentValue(e,t){this.isCommentShowing(e)&&this.setCommentValueCore(e,t)}get commentPropertyValue(){return"comment"}getCommentValueCore(e){return this.isOtherItemByValue(e)?this.otherValue:this.getPropertyValue(this.getCommentPropertyValue(e),this.getCommentValueByItem(e))||""}getCommentValueByItem(e){const t=this.value;return typeof t=="object"&&t[this.commentPropertyValue]||""}setCommentValueCore(e,t){this.isOtherItemByValue(e)?this.otherValue=t:(this.setCommentPropertyValue(e,t),this.isItemSelectedCore(e)&&(t?this.value={value:e.value,comment:t}:this.value=e.value))}setCommentPropertyValue(e,t){this.setPropertyValue(this.getCommentPropertyValue(e),t)}isOtherItemByValue(e){return e.value===this.otherItem.value}getCommentPropertyValue(e){return this.isOtherItemByValue(e)?this.getStoreOthersAsComment()?"comment":"otherValue":"other_"+e.uniqueId}get showNoneItem(){return this.getPropertyValue("showNoneItem")}set showNoneItem(e){this.setPropertyValue("showNoneItem",e)}get hasNone(){return this.showNoneItem}set hasNone(e){this.showNoneItem=e}get noneItem(){return this.noneItemValue}get noneText(){return this.getLocalizableStringText("noneText")}set noneText(e){this.setLocalizableStringText("noneText",e)}get locNoneText(){return this.getLocalizableString("noneText")}get showRefuseItem(){return this.getPropertyValue("showRefuseItem")}set showRefuseItem(e){this.setPropertyValue("showRefuseItem",e)}get refuseItem(){return this.refuseItemValue}get refuseText(){return this.getLocalizableStringText("refuseText")}set refuseText(e){this.setLocalizableStringText("refuseText",e)}get locRefuseText(){return this.getLocalizableString("refuseText")}get showDontKnowItem(){return this.getPropertyValue("showDontKnowItem")}set showDontKnowItem(e){this.setPropertyValue("showDontKnowItem",e)}get dontKnowItem(){return this.dontKnowItemValue}get dontKnowText(){return this.getLocalizableStringText("dontKnowText")}set dontKnowText(e){this.setLocalizableStringText("dontKnowText",e)}get locDontKnowText(){return this.getLocalizableString("dontKnowText")}createNoneItem(e,t,s){const i=this.createItemValue(e);i.isExclusive=!0;const r=this.createLocalizableString(t,i,!0,s);return i.setLocText(r),i}get choicesVisibleIf(){return this.getPropertyValue("choicesVisibleIf","")}set choicesVisibleIf(e){this.setPropertyValue("choicesVisibleIf",e),this.filterItems()}get choicesEnableIf(){return this.getPropertyValue("choicesEnableIf","")}set choicesEnableIf(e){this.setPropertyValue("choicesEnableIf",e),this.filterItems()}surveyChoiceItemVisibilityChange(){this.filterItems()}addUsedLocales(e){super.addUsedLocales(e),this.doForPanels(void 0,t=>{t.addUsedLocales(e)})}runConditionCore(e){super.runConditionCore(e),this.runItemsEnableCondition(e),this.runItemsCondition(e),this.choices.forEach(t=>{t.runConditionCore(e)}),this.doForPanels(void 0,t=>{t.runCondition(e)})}isTextValue(){return!0}setDefaultIntoValue(e){!this.isValueEmpty(e)&&this.showOtherItem&&this.hasUnknownValue(e,!0)?this.setDefaultUnknownValue(e):super.setDefaultIntoValue(e)}setDefaultUnknownValue(e){this.renderedValue=this.setOtherValueIntoValue(e),this.otherValue=e}valueToData(e){return O.isValueEmpty(e)?e:Array.isArray(e)?e.length>0?e[0]:void 0:e}filterItems(){if(this.isLoadingFromJson||!this.data||this.areInvisibleElementsShowing)return!1;var e=this.getDataFilteredProperties();return this.runItemsEnableCondition(e),this.runItemsCondition(e)}runItemsCondition(e){const t=this.runConditionsForItems(e);return this.filteredChoicesValue&&this.filteredChoicesValue.length===this.activeChoices.length&&(this.filteredChoicesValue=void 0),t&&(this.onVisibleChoicesChanged(),this.clearIncorrectValues()),t}runItemsEnableCondition(e){const t=this.getChoicesCondition("choicesEnableIf");Ce.runEnabledConditionsForItems(this.activeChoices,t,e,(i,r)=>r&&this.onEnableItemCallBack(i))&&this.clearDisabledValues(),this.onAfterRunItemsEnableCondition()}onAfterRunItemsEnableCondition(){}onEnableItemCallBack(e){return!0}onSelectedItemValuesChangedHandler(e){var t;(t=this.survey)===null||t===void 0||t.loadedChoicesFromServer(this)}getItemIfChoicesNotContainThisValue(e,t){return this.waitingChoicesByURL?this.createItemValue(e,t):null}getSingleSelectedItem(){const e=this.selectedItemValues;if(this.isEmpty())return null;const t=this.getItemByValue(this.value);return this.onGetSingleSelectedItem(t),!t&&(!e||this.value!=e.id)&&this.updateSelectedItemValues(),t||e||(this.isOtherSelected?this.otherItem:this.getItemIfChoicesNotContainThisValue(this.value))}onGetSingleSelectedItem(e){}getMultipleSelectedItems(){return[]}getChoicesCondition(e){const t=this.getExpressionFromSurvey(e);return t?new Fs(t):null}canSurveyChangeItemVisibility(){return!!this.survey&&this.survey.canChangeChoiceItemsVisibility()}changeItemVisibility(){return this.canSurveyChangeItemVisibility()?(e,t)=>this.survey.getChoiceItemVisibility(this,e,t):null}runConditionsForItems(e){this.filteredChoicesValue=[];const t=this.changeItemVisibility(),s=this.areInvisibleElementsShowing?null:this.getChoicesCondition("choicesVisibleIf");return Ce.runConditionsForItems(this.activeChoices,this.getFilteredChoices(),s,e,!this.survey||!this.survey.areInvisibleElementsShowing,(i,r)=>t?t(i,r):r)}getHasOther(e){return this.getIsItemValue(e,this.otherItem)}getIsItemValue(e,t){return e===t.value}get validatedValue(){return this.renderedValueToDataCore(this.value)}createRestful(){return new br}setNewRestfulProperty(){this.setPropertyValue("choicesByUrl",this.createRestful()),this.choicesByUrl.owner=this,this.choicesByUrl.loadingOwner=this}get autoOtherMode(){return this.getPropertyValue("autoOtherMode")}set autoOtherMode(e){this.setPropertyValue("autoOtherMode",e)}getQuestionComment(){return this.showCommentArea?super.getQuestionComment():this.otherValueCore?this.otherValueCore:this.showCommentArea||this.getStoreOthersAsComment()?super.getQuestionComment():this.otherValueCore}selectOtherValueFromComment(e){e&&(this.prevIsOtherSelected=!0),this.value=e?this.otherItem.value:void 0}onUpdateCommentOnAutoOtherMode(e){if(!this.autoOtherMode)return;const t=this.isOtherSelected;(!t&&e||t&&!e)&&this.selectOtherValueFromComment(!!e)}getValueOnSettingOther(e){const t=this.rendredValueToData(this.renderedValue);if(this.showCommentArea||this.getStoreOthersAsComment())return t;const s=this.getItemByValue(e);if(!s||s===this.otherItem)return t;if(this.otherValueCore="",!Array.isArray(t))return e;const i=t.indexOf(this.otherItem.value);return i>-1&&t.splice(i,1),t.indexOf(e)<0&&t.push(e),t}clearValue(e,t){super.clearValue(e,t),this.selectedItemValues=void 0}get renderedValue(){return this.getPropertyValue("renderedValue",null)}set renderedValue(e){this.setRenderedValue(e,!0)}setRenderedValue(e,t){this.setPropertyValue("renderedValue",e),t&&!this.isReadOnlyAttr&&(e=this.rendredValueToData(e),this.isTwoValueEquals(e,this.value)||(this.value=e)),this.onRenderedValueChagned(t)}onRenderedValueChagned(e){this.choices.forEach(t=>this.updateItemIsCommentShowing(t,e)),this.showOtherItem&&this.updateItemIsCommentShowing(this.otherItem,e)}updateItemIsCommentShowing(e,t){if(e.showCommentArea){const s=this.isCommentShowing(e);e.setIsCommentShowing(s),!s&&t&&this.setCommentValueCore(e,void 0)}}selectItem(e){if(this.isReadOnlyAttr||!e)return;const t=this.getSingleSelectedItem();this.renderedValue=e.value,t&&t!==this.getSingleSelectedItem()&&this.onItemDeselected(t),this.onItemSelected(e)}onItemSelected(e){e.showCommentArea&&this.focusOtherComment(e)}onItemDeselected(e){e.showCommentArea&&this.setCommentValueCore(e,void 0)}setQuestionValue(e,t=!0,s=!0){this.isLoadingFromJson||this.isTwoValueEquals(this.value,e)||(this.setRenderedValue(this.rendredValueFromData(e),!1),super.setQuestionValue(e,t),this.updateChoicesDependedQuestions(),this.updateChoicesPanels(),!(this.showCommentArea||!s)&&!this.isOtherSelected&&this.otherValue&&(this.makeCommentEmpty=!0,this.otherValueCore="",this.setPropertyValue("comment","")))}setValueCore(e){super.setValueCore(e),this.makeCommentEmpty&&(this.setCommentIntoData(""),this.makeCommentEmpty=!1)}setNewValue(e){e=this.valueFromData(e),(!this.choicesByUrl.isRunning&&!this.choicesByUrl.isWaitingForParameters||!this.isValueEmpty(e))&&(this.cachedValueForUrlRequests=e),super.setNewValue(e)}valueFromData(e){let t=this.getItemByValue(e,this.activeChoices);return t?this.getChoiceValue(t,e,!1):super.valueFromData(e)}updateChoicesPanels(){!this.supportElementsInChoice()||!this.wasRendered||(this.choices.forEach(e=>{e.isDescendantOf("choiceitem")&&e.panelFirstRendering()}),this.isClearValueOnHidden&&this.clearValuesInVisiblePanels("onHiddenContainer"))}getChoiceValue(e,t,s){const i=typeof t=="object",r=i?t[this.commentPropertyValue]:"",a=!O.isValueEmpty(r);if(i&&e.showCommentArea&&(s||a)){const o={value:e.value};return a&&(o[this.commentPropertyValue]=r),o}return e.value}getItemByValue(e,t){const s=t||this.visibleChoices;return e&&typeof e=="object"&&!O.isValueEmpty(e.value)&&(e=e.value),Ce.getItemByValue(s,e)}rendredValueFromData(e){if(e&&typeof e=="object"&&!O.isValueEmpty(e.value)){const t=this.getItemByValue(e.value);t&&(this.setCommentPropertyValue(t,e[this.commentPropertyValue]),e=e.value)}return this.getStoreOthersAsComment()||!this.showOtherItem?e:this.renderedValueFromDataCore(e)}getValueFromValueWithComment(e){return e&&typeof e=="object"&&!O.isValueEmpty(e.value)?e.value:e}rendredValueToData(e){return this.getStoreOthersAsComment()?e:this.renderedValueToDataCore(e)}renderedValueFromDataCore(e){return this.hasUnknownValue(e,!0,!1)?(this.otherValue=e,this.otherItem.value):this.valueFromData(e)}renderedValueToDataCore(e){return e==this.otherItem.value&&this.needConvertRenderedOtherToDataValue()&&(e=this.otherValue),e}needConvertRenderedOtherToDataValue(){let e=this.otherValue;return!e||(e=e.trim(),!e)?!1:this.hasUnknownValue(e,!0,!1)}getIsQuestionReady(){return super.getIsQuestionReady()&&!this.waitingChoicesByURL&&!this.waitingGetChoiceDisplayValueResponse}updateSelectedItemValues(){if(this.waitingGetChoiceDisplayValueResponse||!this.survey||this.isEmpty())return;const e=this.value,t=Array.isArray(e)?e:[e];t.some(i=>!this.getItemByValue(i,this.choices))&&(this.choicesLazyLoadEnabled||this.hasChoicesUrl)&&(this.waitingGetChoiceDisplayValueResponse=!0,this.updateIsReady(),this.survey.getChoiceDisplayValue({question:this,values:t,setItems:(i,...r)=>{if(this.waitingGetChoiceDisplayValueResponse=!1,!i||!i.length){this.updateIsReady();return}const a=i.map((o,l)=>this.createItemValue(t[l],o));this.setCustomValuesIntoItems(a,r),Array.isArray(e)?this.selectedItemValues=a:this.selectedItemValues=a[0],this.updateIsReady(),this.onSelectedItemValuesUpdated()}}))}onSelectedItemValuesUpdated(){}setCustomValuesIntoItems(e,t){!Array.isArray(t)||t.length===0||t.forEach(s=>{const i=s.values,r=s.propertyName;if(Array.isArray(i))for(let a=0;a<e.length&&a<i.length;a++)e[a][r]=i[a]})}hasUnknownValue(e,t=!1,s=!0,i=!1){if(!Array.isArray(e))return this.hasUnknownValueItem(e,t,s,i);for(let r=0;r<e.length;r++)if(this.hasUnknownValueItem(e[r],t,s,i))return!0;return!1}hasUnknownValueItem(e,t=!1,s=!0,i=!1){if(!i&&this.isValueEmpty(e)||t&&e==this.otherItem.value||this.showNoneItem&&e==this.noneItem.value||this.showRefuseItem&&e==this.refuseItem.value||this.showDontKnowItem&&e==this.dontKnowItem.value)return!1;var r=s?this.getFilteredChoices():this.activeChoices;return this.getItemByValue(e,r)==null}isValueDisabled(e){var t=this.getItemByValue(e,this.getFilteredChoices());return!!t&&!t.isEnabled}endLoadingFromJson(){super.endLoadingFromJson(),this.updateVisibleChoices()}get customChoices(){return this.getPropertyValue("customChoices")}set customChoices(e){this.setPropertyValue("customChoices",e)}get choicesByUrl(){return this.getPropertyValue("choicesByUrl")}set choicesByUrl(e){e&&(this.setNewRestfulProperty(),this.choicesByUrl.fromJSON(e.toJSON()))}get choices(){return this.getPropertyValue("choices")}set choices(e){this.setPropertyValue("choices",e)}get choicesFromQuestion(){return this.getPropertyValue("choicesFromQuestion")}set choicesFromQuestion(e){var t=this.getQuestionWithChoices();this.isLockVisibleChoices=!!t&&t.name===e,t&&t.name!==e&&(t.removeDependedQuestion(this),this.isInDesignMode&&!this.isLoadingFromJson&&e&&this.setPropertyValue("choicesFromQuestion",void 0)),this.setPropertyValue("choicesFromQuestion",e),this.isLockVisibleChoices=!1}get choicesFromQuestionMode(){return this.getPropertyValue("choicesFromQuestionMode")}set choicesFromQuestionMode(e){this.setPropertyValue("choicesFromQuestionMode",e)}get choiceValuesFromQuestion(){return this.getPropertyValue("choiceValuesFromQuestion")}set choiceValuesFromQuestion(e){this.setPropertyValue("choiceValuesFromQuestion",e)}get choiceTextsFromQuestion(){return this.getPropertyValue("choiceTextsFromQuestion")}set choiceTextsFromQuestion(e){this.setPropertyValue("choiceTextsFromQuestion",e)}get hideIfChoicesEmpty(){return this.getPropertyValue("hideIfChoicesEmpty")}set hideIfChoicesEmpty(e){this.setPropertyValue("hideIfChoicesEmpty",e)}get keepIncorrectValues(){return this.getPropertyValue("keepIncorrectValues",!1)}set keepIncorrectValues(e){this.setPropertyValue("keepIncorrectValues",e)}get storeOthersAsComment(){return this.getPropertyValue("storeOthersAsComment")}set storeOthersAsComment(e){this.setPropertyValue("storeOthersAsComment",e)}get choicesOrder(){return this.getPropertyValue("choicesOrder")}set choicesOrder(e){e=e.toLowerCase(),e!=this.choicesOrder&&(this.setPropertyValue("choicesOrder",e),this.onVisibleChoicesChanged())}get otherText(){return this.getLocalizableStringText("otherText")}set otherText(e){this.setLocalizableStringText("otherText",e),this.onVisibleChoicesChanged()}get locOtherText(){return this.getLocalizableString("otherText")}get separateSpecialChoices(){return this.getPropertyValue("separateSpecialChoices")}set separateSpecialChoices(e){this.setPropertyValue("separateSpecialChoices",e)}get otherPlaceholder(){return this.getLocalizableStringText("otherPlaceholder")}set otherPlaceholder(e){this.setLocalizableStringText("otherPlaceholder",e)}get locOtherPlaceholder(){return this.getLocalizableString("otherPlaceholder")}get otherPlaceHolder(){return this.otherPlaceholder}set otherPlaceHolder(e){this.otherPlaceholder=e}get otherErrorText(){return this.getLocalizableStringText("otherErrorText")}set otherErrorText(e){this.setLocalizableStringText("otherErrorText",e)}get locOtherErrorText(){return this.getLocalizableString("otherErrorText")}get visibleChoices(){return this.getPropertyValue("visibleChoices")}get enabledChoices(){for(var e=[],t=this.visibleChoices,s=0;s<t.length;s++)t[s].isEnabled&&e.push(t[s]);return e}updateVisibleChoices(){if(this.isLoadingFromJson||this.isDisposed)return;var e=this.calcVisibleChoices(),t=new Array;(e||[]).forEach(i=>t.push(i));const s=this.visibleChoices;(!this.isTwoValueEquals(s,t)||this.choicesLazyLoadEnabled)&&(this.setArrayPropertyDirectly("visibleChoices",t),this.updateRenderedChoices())}calcVisibleChoices(){let e=new Array;return this.customChoices.forEach(t=>e.push(t)),this.getFilteredChoices().forEach(t=>e.push(t)),e=this.sortArrayByChoicesOrder(e),this.addToVisibleChoices(e,this.isAddDefaultItems),e}setCanShowOptionItemCallback(e){this.canShowOptionItemCallback=e,e&&this.onVisibleChoicesChanged()}get newItem(){return this.newItemValue}addToVisibleChoices(e,t){this.headItemsCount=0,this.footItemsCount=0,this.isEmptyActiveChoicesInDesign||this.addNewItemToVisibleChoices(e,t);const s=new Array;this.addNonChoicesItems(s,t),s.sort((i,r)=>i.index===r.index?0:i.index<r.index?-1:1);for(let i=0;i<s.length;i++){const r=s[i];r.index<0?(e.splice(i,0,r.item),this.headItemsCount++):(e.push(r.item),this.footItemsCount++)}}addNewItemToVisibleChoices(e,t){t&&(this.newItemValue||(this.newItemValue=this.createItemValue("newitem"),this.newItemValue.isGhost=!0,this.newItemValue.registerFunctionOnPropertyValueChanged("isVisible",()=>{this.updateVisibleChoices()})),this.newItemValue.isVisible&&!this.isUsingCarryForward&&this.canShowOptionItem(this.newItemValue,t,!1)&&(this.footItemsCount=1,e.push(this.newItemValue)))}addNonChoicesItems(e,t){this.supportNone()&&this.addNonChoiceItem(e,this.noneItem,t,this.showNoneItem,A.specialChoicesOrder.noneItem),this.supportRefuse()&&this.addNonChoiceItem(e,this.refuseItem,t,this.showRefuseItem,A.specialChoicesOrder.refuseItem),this.supportDontKnow()&&this.addNonChoiceItem(e,this.dontKnowItem,t,this.showDontKnowItem,A.specialChoicesOrder.dontKnowItem),this.supportOther()&&this.addNonChoiceItem(e,this.otherItem,t,this.showOtherItem,A.specialChoicesOrder.otherItem)}addNonChoiceItem(e,t,s,i,r){this.canShowOptionItem(t,s,i)&&r.forEach(a=>e.push({index:a,item:t}))}canShowOptionItem(e,t,s){let i=t&&(this.canShowOptionItemCallback?this.canShowOptionItemCallback(e):!0)||s;return this.canSurveyChangeItemVisibility()?this.changeItemVisibility()(e,i):i}isItemInList(e){return e===this.otherItem?this.showOtherItem:e===this.noneItem?this.showNoneItem:e===this.refuseItem?this.showRefuseItem:e===this.dontKnowItem?this.showDontKnowItem:e!==this.newItemValue}get isAddDefaultItems(){return A.showDefaultItemsInCreator&&this.isInDesignMode&&!this.customWidget}getPlainData(e={includeEmpty:!0,includeQuestionTypes:!1}){var t=super.getPlainData(e);if(t){var s=Array.isArray(this.value)?this.value:[this.value];t.isNode=!0,t.data=(t.data||[]).concat(s.map((i,r)=>{var a=this.getItemByValue(i),o={name:r,title:this.getLocalizationString("choices_Choice"),value:i,displayValue:this.getChoicesDisplayValue(this.visibleChoices,i),getString:l=>typeof l=="object"?JSON.stringify(l):l,isNode:!1};return a&&(e.calculations||[]).forEach(l=>{o[l.propertyName]=a[l.propertyName]}),this.isOtherSelected&&this.otherItemValue===a&&(o.isOther=!0,o.displayValue=this.otherValue),o}))}return t}getDisplayValueCore(e,t){return t=this.getValueFromValueWithComment(t),this.useDisplayValuesInDynamicTexts?this.getChoicesDisplayValue(this.visibleChoices,t):t}getDisplayValueEmpty(){return Ce.getTextOrHtmlByValue(this.visibleChoices,void 0)}getChoicesDisplayValue(e,t){if(t==this.otherItemValue.value)return this.otherValue?this.otherValue:this.locOtherText.textOrHtml;const s=this.getSingleSelectedItem();if(s&&this.isTwoValueEquals(s.value,t))return s.locText.textOrHtml;var i=Ce.getTextOrHtmlByValue(e,t);return i==""&&t?t:i}getDisplayArrayValue(e,t,s){var i=this.visibleChoices,r=[];const a=[];for(var o=0;o<t.length;o++)a.push(s?s(o):t[o]);if(O.isTwoValueEquals(this.value,a)&&this.getMultipleSelectedItems().forEach((l,u)=>r.push(this.getItemDisplayValue(l,a[u]))),r.length===0)for(var o=0;o<a.length;o++){let u=this.getChoicesDisplayValue(i,a[o]);u&&r.push(u)}return r.join(A.choicesSeparator)}getItemDisplayValue(e,t){if(e===this.otherItem){if(this.showOtherItem&&this.showCommentArea&&t)return t;if(this.comment)return this.comment}return e.locText.textOrHtml}getFilteredChoices(){return this.filteredChoicesValue?this.filteredChoicesValue:this.activeChoices}get activeChoices(){const e=this.getCarryForwardQuestion();return this.carryForwardQuestionType==="select"?(e.addDependedQuestion(this),this.getChoicesFromSelectQuestion(e)):this.carryForwardQuestionType==="array"?(e.addDependedQuestion(this),this.getChoicesFromArrayQuestion(e)):this.isEmptyActiveChoicesInDesign?[]:this.choicesFromUrl?this.choicesFromUrl:this.getChoices()}get isMessagePanelVisible(){return this.getPropertyValue("isMessagePanelVisible",!1)}set isMessagePanelVisible(e){this.setPropertyValue("isMessagePanelVisible",e)}get isEmptyActiveChoicesInDesign(){return this.isInDesignMode&&(this.hasChoicesUrl||this.isMessagePanelVisible)}getCarryForwardQuestion(e){const t=this.findCarryForwardQuestion(e),s=this.getQuestionWithChoicesCore(t),i=s?null:this.getQuestionWithArrayValue(t);return this.setCarryForwardQuestionType(!!s,!!i),s||i?t:null}getIsReadyDependsOn(){const e=super.getIsReadyDependsOn();return this.carryForwardQuestion&&e.push(this.carryForwardQuestion),e}getQuestionWithChoices(){return this.getQuestionWithChoicesCore(this.findCarryForwardQuestion())}findCarryForwardQuestion(e){var t;return e||(e=this.data||((t=this.parentQuestion)===null||t===void 0?void 0:t.data)),this.carryForwardQuestion=null,this.choicesFromQuestion&&e&&(this.carryForwardQuestion=e.findQuestionByName(this.choicesFromQuestion)),this.carryForwardQuestion}getQuestionWithChoicesCore(e){return e&&e.visibleChoices&&q.isDescendantOf(e.getType(),"selectbase")&&e!==this?e:null}getQuestionWithArrayValue(e){return e&&e.isValueArray?e:null}getChoicesFromArrayQuestion(e){if(this.isInDesignMode)return[];const t=e.value;if(!Array.isArray(t))return[];const s=[];for(var i=0;i<t.length;i++){const r=t[i];if(!O.isValueObject(r))continue;const a=this.getValueKeyName(r);if(a&&!this.isValueEmpty(r[a])){const o=this.choiceTextsFromQuestion?r[this.choiceTextsFromQuestion]:void 0;s.push(this.createItemValue(r[a],o))}}return s}getValueKeyName(e){if(this.choiceValuesFromQuestion)return this.choiceValuesFromQuestion;const t=Object.keys(e);return t.length>0?t[0]:void 0}getChoicesFromSelectQuestion(e){if(this.isInDesignMode)return[];const t=[];var s=this.choicesFromQuestionMode=="selected"?!0:this.choicesFromQuestionMode=="unselected"?!1:void 0;const i=e.visibleChoices;for(var r=0;r<i.length;r++)if(!e.isBuiltInChoice(i[r])){if(s===void 0){t.push(this.copyChoiceItem(i[r]));continue}var a=e.isItemSelected(i[r]);(a&&s||!a&&!s)&&t.push(this.copyChoiceItem(i[r]))}return this.choicesFromQuestionMode==="selected"&&!this.showOtherItem&&e.isOtherSelected&&e.otherValue&&t.push(this.createItemValue(e.otherItem.value,e.otherValue)),t}copyChoiceItem(e){const t=this.createItemValue(e.value);return t.setData(e),t}get hasActiveChoices(){var e=this.visibleChoices;(!e||e.length==0)&&(this.onVisibleChoicesChanged(),e=this.visibleChoices);for(var t=0;t<e.length;t++)if(!this.isBuiltInChoice(e[t]))return!0;return!1}isBuiltInChoice(e){return[this.otherItem,this.noneItem,this.refuseItem,this.dontKnowItem,this.newItemValue].indexOf(e)>-1}isNoneItem(e){return e.isExclusive===!0}getChoices(){return this.choices}get showOtherItem(){return this.getPropertyValue("showOtherItem",!1)}set showOtherItem(e){!this.supportOther()||this.showOtherItem==e||(this.setPropertyValue("showOtherItem",e),this.onVisibleChoicesChanged())}get hasOther(){return this.showOtherItem}set hasOther(e){this.showOtherItem=e}get requireUpdateCommentValue(){return this.showCommentArea||this.showOtherItem}supportOther(){return this.isSupportProperty("showOtherItem")}supportNone(){return this.isSupportProperty("showNoneItem")}supportRefuse(){return this.isSupportProperty("showRefuseItem")}supportDontKnow(){return this.isSupportProperty("showDontKnowItem")}isSupportProperty(e){return!this.isDesignMode||this.getPropertyByName(e).visible}onCheckForErrors(e,t,s){if(super.onCheckForErrors(e,t,s),this.hasEmptyComments()&&(!t||this.prevOtherErrorValue)){const i=new cP(this.otherErrorText,this);i.onUpdateErrorTextCallback=r=>{r.text=this.otherErrorText},e.push(i)}}hasEmptyComments(){const e=this.visibleChoices;for(let t=0;t<e.length;t++){const s=e[t];if(s.isCommentRequired&&this.isCommentShowing(s)&&!this.getCommentValue(e[t]))return!0}return!1}setSurveyImpl(e,t){this.isRunningChoices=!0,super.setSurveyImpl(e,t),this.isRunningChoices=!1,this.runChoicesByUrl(),this.isAddDefaultItems&&this.updateVisibleChoices()}setSurveyCore(e){super.setSurveyCore(e),e&&this.choicesFromQuestion&&this.onVisibleChoicesChanged()}getStoreOthersAsComment(){return this.showCommentArea?!1:this.checkHasChoicesComments()?!0:this.storeOthersAsComment===!0||this.storeOthersAsComment=="default"&&(this.survey!=null?this.survey.storeOthersAsComment:!0)||this.hasChoicesUrl&&!this.choicesFromUrl}checkHasChoicesComments(){const e=this.choices;for(let t=0;t<e.length;t++)if(e[t].showCommentArea)return!0;return!1}onSurveyLoad(){this.runChoicesByUrl(),this.onVisibleChoicesChanged(),this.doForPanels(void 0,e=>{e.onSurveyLoad()}),super.onSurveyLoad()}onFirstRenderingCore(){super.onFirstRenderingCore(),this.doForPanels(!0,e=>{e.onFirstRendering()})}onAnyValueChanged(e,t){super.onAnyValueChanged(e,t),e!=this.getValueName()&&this.runChoicesByUrl();const s=this.choicesFromQuestion;e&&s&&(e===s||t===s)&&(this.onVisibleChoicesChanged(),this.clearIncorrectValues())}updateValueFromSurvey(e,t){var s="";this.showOtherItem&&this.activeChoices.length>0&&!this.isRunningChoices&&!this.choicesByUrl.isRunning&&this.getStoreOthersAsComment()&&(this.hasUnknownValue(e)&&!this.getHasOther(e)?(s=this.getCommentFromValue(e),e=this.setOtherValueIntoValue(e)):this.data&&(s=this.data.getComment(this.getValueName()))),super.updateValueFromSurvey(e,t),(this.isRunningChoices||this.choicesByUrl.isRunning)&&!this.isEmpty()&&(this.cachedValueForUrlRequests=this.value),s&&this.setNewComment(s),this.updateValueForPanels(t,!1)}updateCommentFromSurvey(e){super.updateCommentFromSurvey(e),this.updateValueForPanels(!1,!0)}updateValueForPanels(e,t){this.data&&this.doForPanels(!0,s=>{s.questions.forEach(i=>{const r=i.getValueName();t?i.updateCommentFromSurvey(this.data.getComment(r)):i.updateValueFromSurvey(this.data.getValue(r),e)})})}getCommentFromValue(e){return e}setOtherValueIntoValue(e){return this.otherItem.value}onOtherValueInput(e,t){this.isInputTextUpdate&&t.target&&this.setCommentValueCore(e,t.target.value)}onOtherValueChange(e,t){var s;this.setCommentValueCore(e,(((s=t.target)===null||s===void 0?void 0:s.value)||"").trim());const i=this.getCommentValueCore(e);i!==t.target.value&&(t.target.value=i||"")}runChoicesByUrl(){if(this.updateIsUsingRestful(),!(!this.choicesByUrl||this.isLoadingFromJson||this.isRunningChoices||this.isInDesignMode)){var e=this.surveyImpl?this.surveyImpl.getTextProcessor():this.textProcessor;e||(e=this.survey),e&&(this.updateIsReady(),this.isRunningChoices=!0,this.choicesByUrl.run(e),this.isRunningChoices=!1)}}onBeforeSendRequest(){A.web.disableQuestionWhileLoadingChoices===!0&&!this.isReadOnly&&(this.enableOnLoadingChoices=!0,this.readOnly=!0)}onLoadChoicesFromUrl(e){this.enableOnLoadingChoices&&(this.readOnly=!1);const t=[];this.isReadOnly||this.choicesByUrl&&this.choicesByUrl.error&&t.push(this.choicesByUrl.error);var s=null,i=!0;this.isFirstLoadChoicesFromUrl&&!this.cachedValueForUrlRequests&&this.defaultValue&&(this.cachedValueForUrlRequests=this.defaultValue,i=!1),this.isValueEmpty(this.cachedValueForUrlRequests)&&(this.cachedValueForUrlRequests=this.value);var r=this.createCachedValueForUrlRequests(this.cachedValueForUrlRequests,i);if(e&&(e.length>0||this.choicesByUrl.allowEmptyResponse)&&(s=new Array,Ce.setData(s,e)),s)for(var a=0;a<s.length;a++)s[a].locOwner=this;this.setChoicesFromUrl(s,t,r)}canAvoidSettChoicesFromUrl(e){return this.isFirstLoadChoicesFromUrl||(!e||Array.isArray(e)&&e.length===0)&&!this.isEmpty()?!1:O.isTwoValueEquals(this.choicesFromUrl,e)}setChoicesFromUrl(e,t,s){if(!this.canAvoidSettChoicesFromUrl(e)){if(this.isFirstLoadChoicesFromUrl=!1,this.choicesFromUrl=e,this.filterItems(),this.onVisibleChoicesChanged(),e){var i=this.updateCachedValueForUrlRequests(s,e);if(i&&!this.isReadOnly){var r=!this.isTwoValueEquals(this.value,i.value);try{this.isValueEmpty(i.value)||(this.allowNotifyValueChanged=!1,this.setQuestionValue(void 0,!0,!1)),this.allowNotifyValueChanged=r,r?this.value=i.value:this.setQuestionValue(i.value)}finally{this.allowNotifyValueChanged=!0}}}!this.isReadOnly&&!e&&!this.isFirstLoadChoicesFromUrl&&(this.value=null),this.errors=t,this.choicesLoaded()}}createCachedValueForUrlRequests(e,t){if(this.isValueEmpty(e))return null;if(Array.isArray(e)){for(var s=[],i=0;i<e.length;i++)s.push(this.createCachedValueForUrlRequests(e[i],!0));return s}var r=t?!this.hasUnknownValue(e):!0;return{value:e,isExists:r}}updateCachedValueForUrlRequests(e,t){if(this.isValueEmpty(e))return null;if(Array.isArray(e)){for(var s=[],i=0;i<e.length;i++){var r=this.updateCachedValueForUrlRequests(e[i],t);if(r&&!this.isValueEmpty(r.value)){var a=r.value,l=this.getItemByValue(r.value,t);l&&(a=l.value),s.push(a)}}return{value:s}}var o=e.isExists&&this.hasUnknownValue(e.value)?null:e.value,l=this.getItemByValue(o,t);return l&&(o=l.value),{value:o}}updateChoicesDependedQuestions(){this.isLoadingFromJson||this.isUpdatingChoicesDependedQuestions||!this.allowNotifyValueChanged||this.choicesByUrl.isRunning||(this.isUpdatingChoicesDependedQuestions=!0,this.updateDependedQuestions(),this.isUpdatingChoicesDependedQuestions=!1)}updateDependedQuestion(){this.onVisibleChoicesChanged(),this.clearIncorrectValues()}onSurveyValueChanged(e){super.onSurveyValueChanged(e),this.updateChoicesDependedQuestions()}onVisibleChoicesChanged(){this.isLoadingFromJson||this.isLockVisibleChoices||(this.updateVisibleChoices(),this.renderedValue===this.otherItem.value&&this.setRenderedValue(this.rendredValueFromData(this.value),!1),this.onVisibleChanged(),this.visibleChoicesChangedCallback&&this.visibleChoicesChangedCallback(),this.updateChoicesDependedQuestions())}isVisibleCore(){const e=super.isVisibleCore();if(!this.hideIfChoicesEmpty||!e)return e;var t=this.isUsingCarryForward?this.visibleChoices:this.getFilteredChoices();return!t||t.length>0}sortArrayByChoicesOrder(e){const t=e.slice();if(this.isInDesignMode)return t;const s=this.choicesOrder.toLowerCase();return s=="asc"?this.sortArray(t,1):s=="desc"?this.sortArray(t,-1):s=="random"?this.randomizeArray(t):t}sortArray(e,t){return e.sort(function(s,i){return O.compareStrings(s.calculatedText,i.calculatedText)*t})}randomizeArray(e){return O.randomizeArray(e)}get hasChoicesUrl(){return this.choicesByUrl&&!!this.choicesByUrl.url}clearIncorrectValues(){!this.canClearIncorrectValues()||!this.hasValueToClearIncorrectValues()||(this.clearIncorrectValuesCallback?this.clearIncorrectValuesCallback():this.clearIncorrectValuesCore())}canClearIncorrectValues(){return!(this.canAddCustomChoices()||this.carryForwardQuestion&&!this.carryForwardQuestion.isReady||this.survey&&this.survey.questionsByValueName(this.getValueName()).length>1||this.hasChoicesUrl&&(!this.choicesFromUrl||this.choicesFromUrl.length==0))}canAddCustomChoices(){return!1}hasValueToClearIncorrectValues(){return this.survey&&this.survey.keepIncorrectValues?!1:!this.keepIncorrectValues&&!this.isEmpty()}clearValueIfInvisibleCore(e){super.clearValueIfInvisibleCore(e),this.clearIncorrectValues(),this.clearValuesInVisiblePanels(e)}clearValuesInVisiblePanels(e){this.doForPanels(!1,t=>{t.questions.forEach(s=>{s.clearValue()}),t.questions.forEach(s=>{s.clearValueIfInvisible(e)})})}isItemSelected(e){return e===this.otherItem?this.isOtherSelected:this.isItemSelectedCore(e)}isItemSelectedCore(e){return e.value===this.renderedValue}clearDisabledValues(){!this.survey||!this.survey.clearDisabledChoices||this.clearDisabledValuesCore()}clearIncorrectValuesCore(){var e=this.value;this.canClearValueAnUnknown(e)&&this.clearValue(!0)}canClearValueAnUnknown(e){return!this.getStoreOthersAsComment()&&this.isOtherSelected?!1:this.hasUnknownValue(e,!0,!0,!0)}clearDisabledValuesCore(){this.isValueDisabled(this.value)&&this.clearValue(!0)}clearUnusedValues(){super.clearUnusedValues(),this.isOtherValueUnused()&&(this.otherValue="")}isOtherValueUnused(){return!this.isOtherSelected}getColumnClass(){return new z().append(this.cssClasses.column).append("sv-q-column-"+this.colCount,this.hasColumns).toString()}getItemIndex(e){return this.visibleChoices.indexOf(e)}getItemClass(e){const t={item:e};var s=this.getItemClassCore(e,t);return t.css=s,this.survey&&this.survey.updateChoiceItemCss(this,t),t.css}getCurrentColCount(){return this.colCount}getItemClassCore(e,t){const s=new z().append(this.cssClasses.item).append(this.cssClasses.itemInline,!this.hasColumns&&this.colCount===0).append("sv-q-col-"+this.getCurrentColCount(),!this.hasColumns&&this.colCount!==0).append(this.cssClasses.itemOnError,this.hasCssError()),i=this.getIsDisableAndReadOnlyStyles(!e.isEnabled),r=i[0],a=i[1],o=this.isItemSelected(e),l=!a&&!o&&!(this.survey&&this.survey.isDesignMode),u=e===this.noneItem;return t.isDisabled=a||r,t.isChecked=o,t.isNone=u,s.append(this.cssClasses.itemDisabled,a).append(this.cssClasses.itemReadOnly,r).append(this.cssClasses.itemPreview,this.isPreviewStyle).append(this.cssClasses.itemChecked,o).append(this.cssClasses.itemHover,l).append(this.cssClasses.itemNone,u).toString()}getLabelClass(e){return new z().append(this.cssClasses.label).append(this.cssClasses.labelChecked,this.isItemSelected(e)).toString()}getControlLabelClass(e){return new z().append(this.cssClasses.controlLabel).append(this.cssClasses.controlLabelChecked,this.isItemSelected(e)).toString()||void 0}updateRenderedChoices(){this.renderedChoices=this.onGetRenderedChoicesCallback?this.onGetRenderedChoicesCallback(this.visibleChoices):this.visibleChoices}getRenderedChoicesAnimationOptions(){return{isAnimationEnabled:()=>this.animationAllowed,getRerenderEvent:()=>this.onElementRerendered,getKey:e=>e!=this.newItemValue?e.value:this.newItemValue,getLeaveOptions:e=>{let t=this.cssClasses.itemLeave;if(this.hasColumns){const s=this.bodyItems.indexOf(e);s!==-1&&s!==this.bodyItems.length-1&&(t="")}return{cssClass:t,onBeforeRunAnimation:ni,onAfterRunAnimation:ys}},getAnimatedElement:e=>e.getRootElement(),getEnterOptions:e=>{let t=this.cssClasses.itemEnter;if(this.hasColumns){const s=this.bodyItems.indexOf(e);s!==-1&&s!==this.bodyItems.length-1&&(t="")}return{cssClass:t,onBeforeRunAnimation:s=>{if(this.getCurrentColCount()==0&&this.bodyItems.indexOf(e)>=0){const i=s.parentElement.firstElementChild.offsetLeft;s.offsetLeft>i&&en(s,{moveAnimationDuration:"0s",fadeAnimationDelay:"0s"},"--")}ni(s)},onAfterRunAnimation:ys}}}}get renderedChoices(){return this._renderedChoices}set renderedChoices(e){this.renderedChoicesAnimation.sync(e)}get headItems(){const e=this.separateSpecialChoices||this.isInDesignMode?this.headItemsCount:0,t=[];for(let s=0;s<e;s++)this.renderedChoices[s]&&t.push(this.renderedChoices[s]);return t}get footItems(){const e=this.separateSpecialChoices||this.isInDesignMode?this.footItemsCount:0,t=[],s=this.renderedChoices;for(let i=0;i<e;i++)this.renderedChoices[s.length-e+i]&&t.push(this.renderedChoices[s.length-e+i]);return t}get dataChoices(){return this.renderedChoices.filter(e=>!this.isBuiltInChoice(e))}get bodyItems(){return this.hasHeadItems||this.hasFootItems?this.dataChoices:this.renderedChoices}get hasHeadItems(){return this.headItems.length>0}get hasFootItems(){return this.footItems.length>0}get itemFlowDirection(){return A.itemFlowDirection}get columns(){if(!this.hasColumns||this.renderedChoices.length===0)return[];const e=this.getCurrentColCount();let t=!this.separateSpecialChoices&&!this.isInDesignMode?this.renderedChoices:this.dataChoices;return this.itemFlowDirection==="column"?this.getColumnsWithColumnItemFlow(t,e):this.getColumnsWithRowItemFlow(t,e)}getColumnsWithColumnItemFlow(e,t){const s=[];let i=Math.floor(e.length/t);e.length%t&&(i+=1);let r=e.length,a=t,o=0;for(let l=0;l<t;l++){const u=[];for(let d=0;d<i;d++){r<=a&&(i=1);const h=e[d+o];h&&(u.push(h),r--)}s.push(u),a--,o+=u.length}return s}getColumnsWithRowItemFlow(e,t){const s=[];for(let i=0;i<t;i++){const r=[];for(let a=i;a<e.length;a+=t)r.push(e[a]);s.push(r)}return s}getItemsColumnKey(e){return(e||[]).map(t=>t.uniqueId).join("-")}get hasColumns(){return!this.isMobile&&this.getCurrentColCount()>1}get rowLayout(){return this.getCurrentColCount()==0&&!(this.hasFootItems||this.hasHeadItems)}get blockedRow(){return this.getCurrentColCount()==0&&(this.hasFootItems||this.hasHeadItems)}choicesLoaded(){this.isChoicesLoaded=!0,this.updateIsReady(),this.survey&&this.survey.loadedChoicesFromServer(this),this.loadedChoicesFromServerCallback&&this.loadedChoicesFromServerCallback()}getItemValueWrapperComponentName(e){const t=this.survey;return t?t.getItemValueWrapperComponentName(e,this):Ee.TemplateRendererComponentName}getItemValueWrapperComponentData(e){const t=this.survey;return t?t.getItemValueWrapperComponentData(e,this):e}ariaItemChecked(e){return this.renderedValue===e.value?"true":"false"}isOtherItem(e){return this.showOtherItem&&e.value==this.otherItem.value}get itemSvgIcon(){return this.isPreviewStyle&&this.cssClasses.itemPreviewSvgIconId?this.cssClasses.itemPreviewSvgIconId:this.cssClasses.itemSvgIconId}getSelectBaseRootCss(){return new z().append(this.getQuestionRootCss()).append(this.cssClasses.rootRow,this.rowLayout).toString()}allowMobileInDesignMode(){return!0}getAriaItemLabel(e){return e.locText.renderedHtml}getItemId(e){return this.inputId+"_"+this.getItemIndex(e)}get questionName(){return this.name+"_"+this.id}getItemEnabled(e){return!this.isDisabledAttr&&e.isEnabled}focusOtherComment(e){var t;this.autoOtherMode||yt.FocusElement(this.getItemCommentId(e),!1,(t=this.survey)===null||t===void 0?void 0:t.rootElement)}getDefaultItemComponent(){return""}get itemComponent(){return this.getPropertyValue("itemComponent",this.getDefaultItemComponent())}set itemComponent(e){this.setPropertyValue("itemComponent",e)}};S([Nt()],ih.prototype,"_renderedChoices",void 0);let po=class extends ih{constructor(e){super(e)}get colCount(){return this.getPropertyValue("colCount",this.isFlowLayout?0:void 0)}set colCount(e){e<0||e>5||this.isFlowLayout||(this.setPropertyValue("colCount",e),this.fireCallback(this.colCountChangedCallback))}onParentChanged(){super.onParentChanged(),this.isFlowLayout&&this.setPropertyValue("colCount",null)}onParentQuestionChanged(){this.onVisibleChoicesChanged()}getSearchableItemValueKeys(e){e.push("choices")}};function rh(n,e){var t;if(!n)return!1;if(n.templateQuestion){const s=(t=n.colOwner)===null||t===void 0?void 0:t.data;if(n=n.templateQuestion,!n.getCarryForwardQuestion(s))return!1}return n.carryForwardQuestionType===e}q.addClass("choiceitem",[{name:"showCommentArea:boolean",locationInTable:"detail",visibleIf:n=>n.supportComment},{name:"isCommentRequired:boolean",locationInTable:"detail",visibleIf:n=>n.showCommentArea},{name:"commentPlaceholder",locationInTable:"detail",serializationProperty:"locCommentPlaceholder",visibleIf:n=>n.showCommentArea},{name:"elements",baseClassName:"question",visible:!1,isLightSerializable:!1,isSerializableFunc:n=>n.hasElements}],n=>new co(n),"itemvalue"),q.addClass("selectbase",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},"choicesFromQuestion:question_carryforward",{name:"choices:choiceitem[]",uniqueProperty:"value",baseValue:function(){return Ct("choices_Item")},dependsOn:"choicesFromQuestion",visibleIf:n=>!n.choicesFromQuestion},{name:"choicesFromQuestionMode",default:"all",choices:["all","selected","unselected"],dependsOn:"choicesFromQuestion",visibleIf:n=>rh(n,"select")},{name:"choiceValuesFromQuestion",dependsOn:"choicesFromQuestion",visibleIf:n=>rh(n,"array")},{name:"choiceTextsFromQuestion",dependsOn:"choicesFromQuestion",visibleIf:n=>rh(n,"array")},{name:"choicesOrder",default:"none",choices:["none","asc","desc","random"],dependsOn:"choicesFromQuestion",visibleIf:n=>!n.choicesFromQuestion},{name:"choicesByUrl:restfull",className:"choicesByUrl",onGetValue:function(n){return n.choicesByUrl.getData()},onSetValue:function(n,e){n.choicesByUrl.setData(e)}},"hideIfChoicesEmpty:boolean","choicesVisibleIf:condition",{name:"choicesEnableIf:condition",dependsOn:"choicesFromQuestion",visibleIf:n=>!n.choicesFromQuestion},{name:"defaultValue:value",visibleIf:n=>!n.choicesFromQuestion,dependsOn:"choicesFromQuestion"},{name:"correctAnswer:value",visibleIf:n=>!n.choicesFromQuestion,dependsOn:"choicesFromQuestion"},{name:"separateSpecialChoices:boolean",visible:!1},{name:"showOtherItem:boolean",alternativeName:"hasOther"},{name:"showNoneItem:boolean",alternativeName:"hasNone"},{name:"showRefuseItem:boolean",visible:!1,version:"1.9.128"},{name:"showDontKnowItem:boolean",visible:!1,version:"1.9.128"},{name:"otherPlaceholder",alternativeName:"otherPlaceHolder",serializationProperty:"locOtherPlaceholder",dependsOn:"showOtherItem",visibleIf:function(n){return n.showOtherItem}},{name:"noneText",serializationProperty:"locNoneText",dependsOn:"showNoneItem",visibleIf:function(n){return n.showNoneItem}},{name:"refuseText",serializationProperty:"locRefuseText",dependsOn:"showRefuseItem",visibleIf:function(n){return n.showRefuseItem}},{name:"dontKnowText",serializationProperty:"locDontKnowText",dependsOn:"showDontKnowItem",visibleIf:function(n){return n.showDontKnowItem}},{name:"otherText",serializationProperty:"locOtherText",dependsOn:"showOtherItem",visibleIf:function(n){return n.showOtherItem}},{name:"otherErrorText",serializationProperty:"locOtherErrorText",dependsOn:"showOtherItem",visibleIf:function(n){return n.showOtherItem}},{name:"storeOthersAsComment",default:"default",choices:["default",!0,!1],visible:!1}],null,"question"),q.addClass("checkboxbase",[{name:"colCount:number",default:1,choices:[0,1,2,3,4,5],layout:"row"}],null,"selectbase");let Ut=class extends Te{get focusFirstInputSelector(){return this.getFocusFirstInputSelector()}getFocusFirstInputSelector(){return ft?this.isValueEmpty(this.question.value)?this.itemSelector:this.selectedItemSelector:!this.listModel.showFilter&&this.question.value?this.selectedItemSelector:""}resetItemsSettings(){this.itemsSettings.skip=0,this.itemsSettings.take=Math.max(this.minPageSize,this.question.choicesLazyLoadPageSize),this.itemsSettings.totalCount=0,this.itemsSettings.items=[]}setItems(e,t){this.itemsSettings.items=[].concat(this.itemsSettings.items,e),this.itemsSettings.totalCount=t,this.listModel.isAllDataLoaded=this.choicesLazyLoadEnabled&&this.itemsSettings.items.length==this.itemsSettings.totalCount,this.question.choices=this.itemsSettings.items}_loadQuestionChoices(e){const t=this.filterString;this.setIsChoicesLoading(!0),this.question.survey.loadQuestionChoices({question:this.question,filter:this.filterString,skip:this.itemsSettings.skip,take:this.itemsSettings.take,setItems:(s,i)=>{this.setItems(s||[],i||0),this.popupRecalculatePosition(this.itemsSettings.skip===this.itemsSettings.take),e&&e(),this.processCustomValue(t),this.setIsChoicesLoading(!1)}}),this.itemsSettings.skip+=this.itemsSettings.take}setIsChoicesLoading(e){this.question.setIsChoicesLoading&&this.question.setIsChoicesLoading(e)}processCustomValue(e){if(!this.allowCustomChoices)return;const t=e||this.filterString;this.listModel.getVisibleActions().filter(i=>O.isTwoValueEquals(i.text,t,!1,!1))[0]?this.customValue=void 0:(this.customValue=t,this.updateItems(),this.listModel.focusFirstVisibleItem())}updateQuestionChoices(e){const t=this.itemsSettings.skip+1<this.itemsSettings.totalCount;(!this.itemsSettings.skip||t)&&(this.resetTimer(),this.filterString&&A.dropdownSearchDelay>0?this.timer=setTimeout(()=>{this._loadQuestionChoices(e)},A.dropdownSearchDelay):this._loadQuestionChoices(e))}resetTimer(){this.timer&&(clearTimeout(this.timer),this.timer=void 0)}updatePopupFocusFirstInputSelector(){this._popupModel.focusFirstInputSelector=this.focusFirstInputSelector}getDropdownMenuOptions(){const e=we.getInnerWidth(),t=we.getInnerHeight(),s=D2(e,t);let i="dropdown",r="desktop";return ft&&(i="popup",r=s?"tablet":"mobile"),{menuType:i,deviceType:r,hasTouchScreen:ft,screenHeight:t,screenWidth:e}}checkFocusRemainsWithinComponent(e){if(!this.question.cssClasses.root||!e?.target)return!1;const t=e.target.closest(rs(this.question.cssClasses.root));return t&&t.contains(e.relatedTarget)}createButtons(){this.editorButtons=new _t,this.editorButtons.containerCss="sd-dropdown-action-bar",this.chevronButton=new Pe({id:"chevron",css:"sd-editor-chevron-button",iconName:this.question.cssClasses.chevronButtonIconId||"icon-chevron",iconSize:"auto",showTitle:!1,locTitle:this.locSelectCaption,disableTabStop:!0,enabled:new We(()=>!this.question.isInputReadOnly),visible:new We(()=>!this.question.isPreviewStyle),action:e=>{this.onClick()}}),this.clearButton=new Pe({id:"clear",css:"sd-editor-clean-button",iconName:this.question.cssClasses.cleanButtonIconId||"icon-cancel-24x24",iconSize:"auto",showTitle:!1,locTitle:this.locClearCaption,disableTabStop:!0,enabled:new We(()=>!this.question.isInputReadOnly),visible:new We(()=>{const e=this.question.isEmpty(),t=this.question.isReadOnly;return this.question.allowClear&&!e&&!t}),action:e=>{this.onClear()}}),this.editorButtons.setItems([this.clearButton,this.chevronButton]),this.editorButtons.actions.forEach(e=>e.cssClasses={item:"sd-editor-button-item",itemIcon:"sv-editor-button-item__icon",itemPressed:"sd-editor-button-item--pressed"})}createPopup(){const e={verticalPosition:"bottom",horizontalPosition:"center",showPointer:!1};this._popupModel=new Lt("sv-list",{model:this.listModel},e),this._popupModel.displayMode=ft?"overlay":"popup",this._popupModel.positionMode="fixed",this._popupModel.isFocusedContainer=!1,this._popupModel.isFocusedContent=ft,this._popupModel.setWidthByTarget=!ft,this._popupModel.locale=this.question.getLocale(),this.updatePopupFocusFirstInputSelector(),this.listModel.registerPropertyChangedHandlers(["showFilter"],()=>{this.updatePopupFocusFirstInputSelector()}),this._popupModel.onVisibilityChanged.add((t,s)=>{this.popupVisibilityChanged(s.isVisible),this.chevronButton.pressed=s.isVisible})}popupVisibilityChanged(e){if(e&&(this.listModel.renderElements=!0),e&&this.choicesLazyLoadEnabled&&(this.listModel.actions=[],this.resetItemsSettings(),this.updateQuestionChoices()),e){this.updatePopupFocusFirstInputSelector();const t=this.getDropdownMenuOptions();this.question.processOpenDropdownMenu(t),this._popupModel.updateDisplayMode(t.menuType)&&this.listModel.setSearchEnabled(this.inputAvailable&&t.menuType!=="dropdown"),this.question.onOpenedCallBack&&this.question.onOpenedCallBack()}e||this.onHidePopup(),this.ariaExpanded=e?"true":"false",this.question.processPopupVisiblilityChanged(this.popupModel,e)}setFilterStringToListModel(e){if(this.listModel.filterString=e,this.listModel.resetFocusedItem(),this.question.selectedItem&&this.question.selectedItem.text.indexOf(e)>=0){this.listModel.focusedItem=this.getAvailableItems().filter(t=>t.id==this.question.selectedItem.value)[0],this.listModel.filterString&&this.listModel.actions.map(t=>t.selectedValue=!1);return}(!this.listModel.focusedItem||!this.listModel.isItemVisible(this.listModel.focusedItem))&&this.listModel.focusFirstVisibleItem()}setTextWrapEnabled(e){this.listModel.textWrapEnabled=e}popupRecalculatePosition(e){setTimeout(()=>{this.popupModel.recalculatePosition(e)},1)}onHidePopup(){this.question.suggestedItem=null,this.choicesLazyLoadEnabled&&this.resetItemsSettings(),this.customValue=void 0,this.resetCustomItemValue()}getAvailableItems(){return this.allowCustomChoices?[].concat(this.question.visibleChoices,[this.customItemValue]):this.question.visibleChoices}setOnTextSearchCallbackForListModel(e){e.setOnTextSearchCallback((t,s)=>{if(t.id===this.customItemValue.id)return t.visible;if(this.filteredItems)return this.filteredItems.indexOf(t)>=0;let i=t.text.toLocaleLowerCase();i=A.comparator.normalizeTextCallback(i,"filter");const r=i.indexOf(s.toLocaleLowerCase());return this.question.searchMode=="startsWith"?r==0:r>-1})}createListModel(){const e=this.getAvailableItems();let t=this.onSelectionChanged;t||(t=r=>{this.setQuestionValue(r),this.popupModel.hide()});const s={items:e,onSelectionChanged:t,allowSelection:!1,locOwner:this.question,elementId:this.listElementId},i=new dt(s);return this.setOnTextSearchCallbackForListModel(i),i.renderElements=!1,i.forceShowFilter=this.question.choicesLazyLoadEnabled,i.areSameItemsCallback=(r,a)=>r===a,i}setQuestionValue(e){let t=e;this.allowCustomChoices&&e.id===this.customItemValue.id&&(t=this.createCustomItem()),t&&(this.resetFilterString(),this.question.selectItem(t),this.searchEnabled&&this.applyInputString(t))}createCustomItem(){const e=new Ce(this.customValue),t={item:e,question:this.question,allow:!0};return this.question.survey.createCustomChoiceItem(t),t.allow?(this.question.customChoices.push(e),this.customValue=void 0,this.updateItems(),e):(this.clear(),null)}updateAfterListModelCreated(e){e.isItemSelected=t=>!!t.selected,e.isAllDataLoaded=!this.choicesLazyLoadEnabled,e.disableSearch=this.choicesLazyLoadEnabled,e.actions.forEach(t=>t.disableTabStop=!0),e.setOnFilterStringChangedCallback(this.listModelFilterStringChanged),e.setLoadingIndicatorVisibilityObserver(t=>{t&&this.updateQuestionChoices()})}getPopupCssClasses(){return"sv-single-select-list"}updateCssClasses(e,t){this.popupModel.cssClass=new z().append(e).append(this.getPopupCssClasses()).toString(),this.listModel.cssClasses=t}resetFilterString(){this.filterString&&(this.filterString=void 0,this.listModel.filterString=""),this.inputString=null,this.hintString=""}clear(){this.customValue=void 0,this.resetFilterString()}onSetFilterString(){if(this.filteredItems=void 0,!this.filterString&&!this.popupModel.isVisible)return;const e={question:this.question,choices:this.getAvailableItems(),filter:this.filterString,filteredChoices:void 0};this.question.survey.onChoicesSearch.fire(this.question.survey,e),this.filteredItems=e.filteredChoices,this.filterString&&!this.popupModel.isVisible&&this.popupModel.show();const t=()=>{this.setFilterStringToListModel(this.filterString),this.filterString&&this.applyHintString(),this.popupRecalculatePosition(!0)};this.choicesLazyLoadEnabled?(this.resetItemsSettings(),this.updateQuestionChoices(t)):t()}get isAllDataLoaded(){return!!this.itemsSettings.totalCount&&this.itemsSettings.items.length==this.itemsSettings.totalCount}loadQuestionChoices(e){this.isAllDataLoaded||this._loadQuestionChoices(e)}get canShowSelectedItem(){return!this.focused||this._markdownMode||!this.searchEnabled}get needRenderInput(){return!this.question.isInputReadOnly||!!this.placeholderRendered}updateCustomItemValue(){this.customValue?(this.customItemValue.text=this.getLocalizationFormatString("createCustomItem",this.customValue),this.customItemValue.visible=!0):this.resetCustomItemValue()}resetCustomItemValue(){this.customItemValue.text="",this.customItemValue.visible=!1}get customItemValue(){return this._customItemValue||(this._customItemValue=new Ce("newCustomItem",this.getLocalizationFormatString("createCustomItem",this.customValue)),this._customItemValue.css="sv-list-item--custom-value"),this._customItemValue}applyInputString(e){e?.locText.hasHtml||this.question.inputFieldComponentName?(this._markdownMode=!0,this.inputString=this.cleanHtml(e?.locText.getHtmlValue()),this.hintString=""):(this.inputString=e?.title,this.hintString=e?.title)}cleanHtml(e){return this.htmlCleanerElement?(this.htmlCleanerElement.innerHTML=e,this.htmlCleanerElement.textContent):""}fixInputCase(){const e=this.hintStringMiddle;e&&this.inputString!=e&&(this.inputString=e)}applyHintString(){const e=this.listModel.focusedItem||this.question.selectedItem;e?.locText.hasHtml||this.question.inputFieldComponentName?(this._markdownMode=!0,this.hintString=""):e===this.customItemValue?this.hintString="":this.hintString=e?.title}get inputStringRendered(){return this.inputString||""}set inputStringRendered(e){var t;this.inputString=e,this.filterString=e,this.choicesLazyLoadEnabled||this.processCustomValue(),(!e||!this.searchEnabled||((t=this.listModel.focusedItem)===null||t===void 0?void 0:t.id)===this.customItemValue.id)&&(this.hintString="")}get placeholderRendered(){return this.hintString||this.question.readOnly||!this.question.isEmpty()?"":this.inputPlaceholder}get listElementId(){return this.question.inputId+"_list"}get hintStringLC(){var e;return((e=this.hintString)===null||e===void 0?void 0:e.toLowerCase())||""}get inputStringLC(){var e;return((e=this.inputString)===null||e===void 0?void 0:e.toLowerCase())||""}get showHintPrefix(){return!!this.inputString&&this.hintStringLC.indexOf(this.inputStringLC)>0}get hintStringPrefix(){return this.inputString?this.hintString.substring(0,this.hintStringLC.indexOf(this.inputStringLC)):null}get showHintString(){return!!this.searchEnabled&&!!(this.hintStringLC||this.inputStringLC)||!this.searchEnabled&&this.hintStringLC&&this.question.isEmpty()}get hintStringSuffix(){return this.hintStringLC.indexOf(this.inputStringLC)>=0?this.hintString.substring(this.hintStringLC.indexOf(this.inputStringLC)+this.inputStringLC.length):""}get hintStringMiddle(){const e=this.hintStringLC.indexOf(this.inputStringLC);return e==-1?null:this.hintString.substring(e,e+this.inputStringLC.length)}constructor(e,t){super(),this.question=e,this.onSelectionChanged=t,this.minPageSize=25,this.loadingItemHeight=40,this.timer=void 0,this._markdownMode=!1,this.filteredItems=void 0,this.selectedItemSelector=".sv-list__item--selected",this.itemSelector=".sv-list__item",this.itemsSettings={skip:0,take:0,totalCount:0,items:[]},this.listModelFilterStringChanged=i=>{this.filterString!==i&&(this.filterString=i,this.choicesLazyLoadEnabled||this.processCustomValue())},this.questionPropertyChangedHandler=(i,r)=>{this.onPropertyChangedHandler(i,r)},this.ariaExpanded="false",this.createLocalizableString("clearCaption",this.question,!1,!0),this.createLocalizableString("selectCaption",this.question,!1,!0),this.htmlCleanerElement=ge.createElement("div"),e.onPropertyChanged.add(this.questionPropertyChangedHandler),this.showInputFieldComponent=this.question.showInputFieldComponent,this.listModel=this.createListModel(),this.setChoicesLazyLoadEnabled(this.question.choicesLazyLoadEnabled),this.setInputPlaceholder(this.question.placeholder),this.updateAfterListModelCreated(this.listModel),this.setSearchEnabled(this.question.searchEnabled),this.setAllowCustomChoices(this.question.allowCustomChoices),this.setTextWrapEnabled(this.question.textWrapEnabled),this.createPopup(),this.createButtons(),this.resetItemsSettings();const s=e.cssClasses;this.updateCssClasses(s.popup,s.list)}get popupModel(){return this._popupModel}get clearCaption(){return this.getLocalizableStringText("clearCaption")}set clearCaption(e){this.setLocalizableStringText("clearCaption",e)}get locClearCaption(){return this.getLocalizableString("clearCaption")}get selectCaption(){return this.getLocalizableStringText("selectCaption")}set selectCaption(e){this.setLocalizableStringText("selectCaption",e)}get locSelectCaption(){return this.getLocalizableString("selectCaption")}get inputAvailable(){return this.searchEnabled||this.allowCustomChoices}get noTabIndex(){return this.question.isInputReadOnly||this.inputAvailable}get filterReadOnly(){return!this.filterStringEnabled||!this.focused}get filterStringEnabled(){return!this.question.isInputReadOnly&&this.inputAvailable}get inputMode(){return ft?"none":"text"}get popupEnabled(){return!this.question.isInputReadOnly}get ariaQuestionRole(){return this.filterStringEnabled?void 0:"combobox"}get ariaQuestionRequired(){return this.ariaQuestionRole?this.question.a11y_input_ariaRequired:void 0}get ariaQuestionInvalid(){return this.ariaQuestionRole?this.question.a11y_input_ariaInvalid:void 0}get ariaQuestionErrorMessage(){return this.ariaQuestionRole?this.question.a11y_input_ariaErrormessage:void 0}get ariaQuestionLabel(){return this.ariaQuestionRole?this.question.a11y_input_ariaLabel:void 0}get ariaQuestionLabelledby(){return this.ariaQuestionRole?this.question.a11y_input_ariaLabelledBy:void 0}get ariaQuestionDescribedby(){return this.ariaQuestionRole?this.question.a11y_input_ariaDescribedBy:void 0}get ariaQuestionControls(){return this.ariaQuestionRole&&this.popupEnabled?this.listElementId:void 0}get ariaQuestionExpanded(){return this.ariaQuestionRole?this.popupEnabled?this.ariaExpanded:"false":void 0}get ariaQuestionActivedescendant(){return this.ariaQuestionRole?this.ariaActivedescendant:void 0}get ariaInputRole(){return this.filterStringEnabled?"combobox":void 0}get ariaInputRequired(){return this.ariaInputRole?this.question.a11y_input_ariaRequired:void 0}get ariaInputInvalid(){return this.ariaInputRole?this.question.a11y_input_ariaInvalid:void 0}get ariaInputErrorMessage(){return this.ariaInputRole?this.question.a11y_input_ariaErrormessage:void 0}get ariaInputLabel(){return this.ariaInputRole?this.question.a11y_input_ariaLabel:void 0}get ariaInputLabelledby(){return this.ariaInputRole?this.question.a11y_input_ariaLabelledBy:void 0}get ariaInputDescribedby(){return this.ariaInputRole?this.question.a11y_input_ariaDescribedBy:void 0}get ariaInputControls(){return this.ariaInputRole&&this.popupEnabled?this.listElementId:void 0}get ariaInputExpanded(){return this.ariaInputRole?this.popupEnabled?this.ariaExpanded:"false":void 0}get ariaInputActivedescendant(){return this.ariaInputRole?this.ariaActivedescendant:void 0}setSearchEnabled(e){this.listModel.setSearchEnabled(ft&&(e||this.question.allowCustomChoices)),this.searchEnabled=e}setAllowCustomChoices(e){this.allowCustomChoices=e,e&&(this.searchEnabled=e)}setChoicesLazyLoadEnabled(e){this.choicesLazyLoadEnabled=e,this.listModel.disableSearch=e,this.listModel.isAllDataLoaded=!e}setInputPlaceholder(e){this.inputPlaceholder=e}updateItems(){this.listModel.setItems(this.getAvailableItems())}onClick(e){this.question.readOnly||this.question.isDesignMode||this.question.isPreviewStyle||this.question.isReadOnlyAttr||(this._popupModel.toggleVisibility(),this.focusItemOnClickAndPopup(),this.question.focusInputElement(!1))}chevronPointerDown(e){this._popupModel.isVisible&&e.preventDefault()}onPropertyChangedHandler(e,t){t.name=="value"&&(this.showInputFieldComponent=this.question.showInputFieldComponent),t.name=="textWrapEnabled"&&this.setTextWrapEnabled(t.newValue)}focusItemOnClickAndPopup(){this._popupModel.isVisible&&this.question.value&&this.changeSelectionWithKeyboard(!1)}onClear(e){this.question.clearValueFromUI(),this._popupModel.hide(),e&&(e.preventDefault(),e.stopPropagation())}getSelectedAction(){return this.question.selectedItem||null}changeSelectionWithKeyboard(e){var t;let s=this.listModel.focusedItem;!s&&this.question.selectedItem?Ce.getItemByValue(this.question.visibleChoices,this.question.value)&&(this.listModel.focusedItem=this.question.selectedItem):e?this.listModel.focusPrevVisibleItem():this.listModel.focusNextVisibleItem(),this.beforeScrollToFocusedItem(s),this.scrollToFocusedItem(),this.afterScrollToFocusedItem(),this.ariaActivedescendant=(t=this.listModel.focusedItem)===null||t===void 0?void 0:t.elementId}beforeScrollToFocusedItem(e){this.question.value&&e&&(e.selectedValue=!1,this.listModel.focusedItem.selectedValue=!this.listModel.filterString,this.question.suggestedItem=this.listModel.focusedItem)}afterScrollToFocusedItem(){var e;this.question.value&&!this.listModel.filterString&&this.searchEnabled?this.applyInputString(this.listModel.focusedItem||this.question.selectedItem):this.applyHintString(),this.fixInputCase(),this.ariaActivedescendant=(e=this.listModel.focusedItem)===null||e===void 0?void 0:e.elementId}keyHandler(e){let t=!1;const s=e.which||e.keyCode;if(this.popupModel.isVisible&&e.keyCode===38)this.changeSelectionWithKeyboard(!0),t=!0;else if(e.keyCode===40)this.popupModel.show(),this.changeSelectionWithKeyboard(!1),t=!0;else if(!this.popupModel.isVisible&&e.keyCode===32)this.popupModel.show(),this.changeSelectionWithKeyboard(!1),t=!0;else if(!this.popupModel.isVisible&&e.keyCode===13)this.question.survey.questionEditFinishCallback(this.question,e),t=!0;else if(this.popupModel.isVisible&&(e.keyCode===13||e.keyCode===32&&(!this.searchEnabled||!this.inputString)))e.keyCode===13&&this.searchEnabled&&!this.inputString&&this.question instanceof ns&&!this._markdownMode&&this.question.value?(this._popupModel.hide(),this.onClear(e)):(this.listModel.selectFocusedItem(),this.onFocus(e)),t=!0;else if(s===46||s===8)this.inputAvailable||this.onClear(e);else if(e.keyCode===27)this._popupModel.hide(),this.hintString="",this.onEscape();else{if((e.keyCode===38||e.keyCode===40||e.keyCode===32&&!this.searchEnabled)&&(t=!0),e.keyCode===32&&this.searchEnabled)return;ju(e,{processEsc:!1,disableTabStop:this.question.isInputReadOnly})}t&&(e.preventDefault(),e.stopPropagation())}onEscape(){this.searchEnabled&&this.applyInputString(this.question.selectedItem)}onScroll(e){const t=e.target;t.scrollHeight-(t.scrollTop+t.offsetHeight)<=this.loadingItemHeight&&this.updateQuestionChoices()}onBlur(e){this.checkFocusRemainsWithinComponent(e)||(this.focused=!1,!(this.popupModel.isVisible&&this.popupModel.displayMode=="overlay")&&(Cy(e),this._popupModel.hide(),this.resetFilterString(),e.stopPropagation()))}onFocus(e){this.focused=!0,this.setInputStringFromSelectedItem(this.question.selectedItem)}setInputStringFromSelectedItem(e){this.focused&&this.searchEnabled&&e&&this.applyInputString(e)}dispose(){super.dispose(),this.question&&this.question.onPropertyChanged.remove(this.questionPropertyChangedHandler),this.questionPropertyChangedHandler=void 0,this.listModel&&this.listModel.dispose(),this.popupModel&&this.popupModel.dispose(),this.htmlCleanerElement=void 0}scrollToFocusedItem(){this.listModel.scrollToFocusedItem()}};S([E({defaultValue:!1})],Ut.prototype,"focused",void 0),S([E({defaultValue:!1})],Ut.prototype,"allowCustomChoices",void 0),S([E({onSet:(n,e)=>{e.updateCustomItemValue()}})],Ut.prototype,"customValue",void 0),S([E({defaultValue:!0})],Ut.prototype,"searchEnabled",void 0),S([E()],Ut.prototype,"choicesLazyLoadEnabled",void 0),S([E({defaultValue:"",onSet:(n,e)=>{e.onSetFilterString()}})],Ut.prototype,"filterString",void 0),S([E({defaultValue:"",onSet:(n,e)=>{e.question.inputHasValue=!!n}})],Ut.prototype,"inputString",void 0),S([E({})],Ut.prototype,"showInputFieldComponent",void 0),S([E()],Ut.prototype,"ariaActivedescendant",void 0),S([E()],Ut.prototype,"ariaExpanded",void 0),S([E()],Ut.prototype,"inputPlaceholder",void 0),S([E({defaultValue:""})],Ut.prototype,"hintString",void 0);let ns=class extends ih{constructor(e){super(e),this.lastSelectedItemValue=null,this.minMaxChoices=[],this.onOpened=this.addEvent(),this.createLocString({name:"placeholder",hasTranslation:!0}),this.createLocalizableString("readOnlyText",this,!0),this.registerPropertyChangedHandlers(["choicesMin","choicesMax","choicesStep"],()=>{this.onVisibleChoicesChanged()}),this.registerPropertyChangedHandlers(["value","renderAs","showOtherItem","otherText","placeholder","choices","visibleChoices"],()=>{this.getSingleSelectedItem(),this.updateReadOnlyText()}),this.updateReadOnlyText()}locStrsChanged(){super.locStrsChanged(),this.updateReadOnlyText(),this.updateInputPlaceholder(this.placeholder)}updateReadOnlyText(){this.readOnlyText=this.calculateReadOnlyText()}onSelectedItemValuesUpdated(){super.onSelectedItemValuesUpdated(),this.updateReadOnlyText()}updateInputPlaceholder(e){this.dropdownListModelValue&&this.dropdownListModel.setInputPlaceholder(e)}get showOptionsCaption(){return this.allowClear}set showOptionsCaption(e){this.allowClear=e}get showClearButton(){return this.allowClear&&!this.isEmpty()}get optionsCaption(){return this.placeholder}set optionsCaption(e){this.placeholder=e}get placeholder(){return this.getLocalizableStringText("placeholder")}set placeholder(e){this.setLocalizableStringText("placeholder",e),this.updateInputPlaceholder(e)}get locPlaceholder(){return this.getLocalizableString("placeholder")}getType(){return"dropdown"}get isNewA11yStructure(){return!0}get a11yQuestionAriaRole(){return this.searchEnabled?null:"combobox"}get a11yInputAriaRole(){return this.searchEnabled?"combobox":null}get selectedItem(){return this.getSingleSelectedItem()}isOtherValueUnused(){var e;return!(!((e=this.selectedItem)===null||e===void 0)&&e.showCommentArea)}onGetSingleSelectedItem(e){e&&(this.lastSelectedItemValue=e)}get isShowingChoiceComment(){var e;return(e=this.selectedItem)===null||e===void 0?void 0:e.showCommentArea}supportAutoAdvance(){return!this.isShowingChoiceComment}getChoices(){var e=super.getChoices();if(this.choicesMax<=this.choicesMin)return e;for(var t=[],s=0;s<e.length;s++)t.push(e[s]);if(this.minMaxChoices.length===0||this.minMaxChoices.length!==(this.choicesMax-this.choicesMin)/this.choicesStep+1){this.minMaxChoices=[];for(var s=this.choicesMin;s<=this.choicesMax;s+=this.choicesStep)this.minMaxChoices.push(this.createItemValue(s))}return t=t.concat(this.minMaxChoices),t}get choicesMin(){return this.getPropertyValue("choicesMin")}set choicesMin(e){this.setPropertyValue("choicesMin",e)}get choicesMax(){return this.getPropertyValue("choicesMax")}set choicesMax(e){this.setPropertyValue("choicesMax",e)}get choicesStep(){return this.getPropertyValue("choicesStep")}set choicesStep(e){e<1&&(e=1),this.setPropertyValue("choicesStep",e)}get autocomplete(){return this.getPropertyValue("autocomplete")}set autocomplete(e){this.setPropertyValue("autocomplete",e)}get readOnlyText(){return this.getLocalizableStringText("readOnlyText")}set readOnlyText(e){this.setLocalizableStringText("readOnlyText",e)}get locReadOnlyText(){return this.getLocalizableString("readOnlyText")}calculateReadOnlyText(){if(!this.useDropdownList){if(this.isOtherSelected)return this.otherText;if(this.isNoneSelected)return this.noneText;if(this.selectedItem)return this.selectedItemText}return this.selectedItem?this.selectedItemText:this.placeholder}getControlClass(){return new z().append(this.cssClasses.control).append(this.cssClasses.controlEmpty,this.isEmpty()).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle).append(this.cssClasses.controlInputFieldComponent,!!this.inputFieldComponentName).toString()}updateCssClasses(e,t){super.updateCssClasses(e,t),this.useDropdownList&&Xa(e,t)}calcCssClasses(e){const t=super.calcCssClasses(e);return this.dropdownListModelValue&&this.dropdownListModel.updateCssClasses(t.popup,t.list),t}get selectedItemLocText(){const e=this.suggestedItem||this.selectedItem;return e?.locText}get inputFieldComponentName(){return this.inputFieldComponent||this.itemComponent}get showSelectedItemLocText(){return!this.inputHasValue&&!this.inputFieldComponentName&&!!this.selectedItemLocText&&this.dropdownListModel.canShowSelectedItem}get showInputFieldComponent(){return!this.inputHasValue&&!!this.inputFieldComponentName&&!this.isEmpty()}get selectedItemText(){const e=this.selectedItem;return e?e.text:""}get useDropdownList(){return this.renderAs!=="select"}get dropdownListModel(){return!this.isDisposed&&this.useDropdownList&&!this.dropdownListModelValue&&(this.dropdownListModelValue=new Ut(this)),this.dropdownListModelValue}set dropdownListModel(e){this.dropdownListModelValue=e}get popupModel(){return this.dropdownListModel.popupModel}onOpenedCallBack(){this.onOpened.fire(this,{question:this,choices:this.choices})}onSelectedItemValuesChangedHandler(e){var t;(t=this.dropdownListModelValue)===null||t===void 0||t.setInputStringFromSelectedItem(e),super.onSelectedItemValuesChangedHandler(e)}hasUnknownValue(e,t,s,i){return this.choicesLazyLoadEnabled?!1:super.hasUnknownValue(e,t,s,i)}needConvertRenderedOtherToDataValue(){var e;const t=(e=this.otherValue)===null||e===void 0?void 0:e.trim();return t?super.hasUnknownValue(t,!0,!1):!1}getItemIfChoicesNotContainThisValue(e,t){return this.choicesLazyLoadEnabled?this.createItemValue(e,t):super.getItemIfChoicesNotContainThisValue(e,t)}onVisibleChoicesChanged(){super.onVisibleChoicesChanged(),this.dropdownListModelValue&&this.dropdownListModel.updateItems()}canAddCustomChoices(){return this.allowCustomChoices}getIsQuestionReady(){return super.getIsQuestionReady()&&!this.isChoicesLoading}ensureQuestionIsReady(){super.ensureQuestionIsReady(),this.dropdownListModel&&this.choicesLazyLoadEnabled&&this.dropdownListModel.loadQuestionChoices()}onLoadChoicesFromUrl(e){this.updateCustomChoices(this.value,e),super.onLoadChoicesFromUrl(e)}valueFromData(e){const t=super.valueFromData(e);return this.survey&&this.survey.isSettingData()&&this.updateCustomChoices(t,this.visibleChoices),t}updateCustomChoices(e,t){e!=null&&this.allowCustomChoices&&!this.choicesLazyLoadEnabled&&(this.customChoices.splice(0,this.customChoices.length),t.filter(i=>O.isTwoValueEquals(i.id,e,!1,!1))[0]||this.customChoices.splice(0,this.customChoices.length,new Ce(e)))}setIsChoicesLoading(e){this.isChoicesLoading=e,this.updateIsReady()}getFirstInputElementId(){return this.getInputIdCore(this.searchEnabled||this.allowCustomChoices)}getInputId(){return this.getInputIdCore(!0)}getInputIdCore(e){const t=e&&this.useDropdownList?"_0":"";return this.inputId+t}clearValue(e,t){var s;super.clearValue(e,t),this.lastSelectedItemValue=null,(s=this.dropdownListModelValue)===null||s===void 0||s.clear()}afterRenderCore(e){super.afterRenderCore(e),this.dropdownListModelValue&&this.dropdownListModelValue.clear()}onClick(e){this.onOpenedCallBack&&this.onOpenedCallBack()}onKeyUp(e){(e.which||e.keyCode)===46&&(this.clearValueFromUI(),e.preventDefault(),e.stopPropagation())}supportEmptyValidation(){return!0}onBlurCore(e){this.dropdownListModel.onBlur(e),super.onBlurCore(e)}onFocusCore(e){this.dropdownListModel.onFocus(e),super.onFocusCore(e)}dispose(){super.dispose(),this.dropdownListModelValue&&(this.dropdownListModelValue.dispose(),this.dropdownListModelValue=void 0)}};S([E()],ns.prototype,"allowClear",void 0),S([E({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setSearchEnabled(n)}})],ns.prototype,"searchEnabled",void 0),S([E()],ns.prototype,"searchMode",void 0),S([E({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setAllowCustomChoices(n)}})],ns.prototype,"allowCustomChoices",void 0),S([E()],ns.prototype,"textWrapEnabled",void 0),S([E({defaultValue:!1})],ns.prototype,"inputHasValue",void 0),S([E({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setChoicesLazyLoadEnabled(n)}})],ns.prototype,"choicesLazyLoadEnabled",void 0),S([E()],ns.prototype,"choicesLazyLoadPageSize",void 0),S([E()],ns.prototype,"suggestedItem",void 0),q.addClass("dropdown",[{name:"placeholder",alternativeName:"optionsCaption",serializationProperty:"locPlaceholder"},{name:"allowClear:boolean",alternativeName:"showOptionsCaption",default:!0},{name:"choicesMin:number",default:0},{name:"choicesMax:number",default:0},{name:"choicesStep:number",default:1,minValue:1},{name:"autocomplete",alternativeName:"autoComplete",choices:A.questions.dataList},{name:"textWrapEnabled:boolean",default:!0},{name:"renderAs",default:"default",visible:!1},{name:"searchEnabled:boolean",default:!0,visible:!1},{name:"allowCustomChoices:boolean",default:!1,visibleIf:n=>!n.choicesFromQuestion,dependsOn:"choicesFromQuestion"},{name:"searchMode",default:"contains",choices:["contains","startsWith"]},{name:"choicesLazyLoadEnabled:boolean",default:!1,visible:!1},{name:"choicesLazyLoadPageSize:number",default:25,visible:!1},{name:"inputFieldComponent",visible:!1},{name:"itemComponent",visible:!1,default:""}],function(){return new ns("")},"selectbase"),qe.Instance.registerQuestion("dropdown",n=>{var e=new ns(n);return e.choices=qe.DefaultChoices,e});let eS=class{constructor(e){this.row=e}getValue(e,t,s,i){if(e.length===0)return{isFound:!0,value:this.row.value,context:this}}getTextValue(e,t,s){return s?this.row.getDisplayValue(t):t}},Wy=class extends Ce{getBaseType(){return"matrixcolumn"}get isExclusive(){return this.getPropertyValue("isExclusive",!1)}set isExclusive(e){this.setPropertyValue("isExclusive",e)}},tS=class extends Te{constructor(e,t,s,i){super(),this.item=e,this.fullName=t,this.data=s,this.setValueDirectly(i),this.registerPropertyChangedHandlers(["value"],()=>{this.data.onMatrixRowChanged(this)}),this.data.hasErrorInRow(this)&&(this.hasError=!0)}cellClick(e){this.data.cellClick(this,e)}isChecked(e){return this.data.isCellChecked(this,e)}get name(){return this.item.value}get text(){return this.item.text}get locText(){return this.item.locText}get isVisible(){return this.item.isVisible}get value(){return this.getPropertyValue("value")}set value(e){this.isReadOnly||this.setValueDirectly(this.data.getCorrectedRowValue(e))}setValueDirectly(e){this.setPropertyValue("value",e)}getDisplayValue(e){return this.data.getDisplayRowValue(e)}get isReadOnly(){return!this.item.enabled||this.data.isInputReadOnly}get isReadOnlyAttr(){return this.data.isReadOnlyAttr}get isDisabledAttr(){return!this.item.enabled||this.data.isDisabledAttr}get rowTextClasses(){return new z().append(this.data.cssClasses.rowTextCell).toString()}get hasError(){return this.getPropertyValue("hasError",!1)}set hasError(e){this.setPropertyValue("hasError",e)}get rowClasses(){const e=this.data.cssClasses;return new z().append(e.row).append(e.rowError,this.hasError).append(e.rowReadOnly,this.isReadOnly).append(e.rowDisabled,this.data.isDisabledStyle).toString()}getValueGetterContext(){return new eS(this)}},sS=class extends Te{constructor(e){super(),this.cellsOwner=e,this.values={},this.locs={}}getType(){return"cells"}get isEmpty(){return Object.keys(this.values).length==0}valuesChanged(){!this.locNotification&&this.onValuesChanged&&this.onValuesChanged()}getDefaultCellLocText(e){return this.getCellLocCore(this.defaultRowValue,e)}getCellDisplayLocText(e,t){return this.getCellLocCore(e,t)}getCellLocCore(e,t){if(e=this.getCellRowColumnValue(e,this.rows),t=this.getCellRowColumnValue(t,this.columns),O.isValueEmpty(e)||O.isValueEmpty(t))return null;this.locs[e]||(this.locs[e]={});let s=this.locs[e][t];return s||(s=this.createString(),s.setJson(this.getCellLocData(e,t)),s.onGetTextCallback=i=>{if(!i){const r=Ce.getItemByValue(this.columns,t);if(r)return r.locText.getJson()||r.value}return i},s.onStrChanged=(i,r)=>{this.updateValues(e,t,r)},this.locs[e][t]=s),s}get defaultRowValue(){return A.matrix.defaultRowName}getCellLocData(e,t){let s=this.getCellLocDataFromValue(e,t);return s||this.getCellLocDataFromValue(this.defaultRowValue,t)}getCellLocDataFromValue(e,t){return!this.values[e]||!this.values[e][t]?null:this.values[e][t]}getCellText(e,t){var s=this.getCellLocCore(e,t);return s?s.calculatedText:null}setCellText(e,t,s){const i=this.getCellLocCore(e,t);i&&(i.text=s)}updateValues(e,t,s){s?(this.values[e]||(this.values[e]={}),this.values[e][t]=s,this.valuesChanged()):this.values[e]&&this.values[e][t]&&(delete this.values[e][t],Object.keys(this.values[e]).length==0&&delete this.values[e],this.valuesChanged())}getDefaultCellText(e){var t=this.getCellLocCore(this.defaultRowValue,e);return t?t.calculatedText:null}setDefaultCellText(e,t){this.setCellText(this.defaultRowValue,e,t)}getCellDisplayText(e,t){var s=this.getCellDisplayLocText(e,t);return s?s.calculatedText:null}get rows(){return this.cellsOwner?this.cellsOwner.getRows():[]}get columns(){return this.cellsOwner?this.cellsOwner.getColumns():[]}getCellRowColumnValue(e,t){if(e==null)return null;if(typeof e=="number"){if(e<0||e>=t.length)return null;e=t[e].value}return e.value?e.value:e}getJson(){if(this.isEmpty)return null;const e=this.values[this.defaultRowValue],t={};for(let s in this.values){const i={},r=this.values[s];for(let a in r)if(s===this.defaultRowValue||!e||e[a]!==r[a]){const o=this.getCellLocCore(s,a);i[a]=o?o.getJson():r[a]}t[s]=i}return t}setJson(e,t){if(this.values={},e){for(var s in e)if(s!="pos"){var i=e[s];this.values[s]={};for(var r in i)r!="pos"&&(this.values[s][r]=i[r])}}this.locNotification=!0,this.runFuncOnLocs((a,o,l)=>l.setJson(this.getCellLocData(a,o))),this.locNotification=!1,this.valuesChanged()}locStrsChanged(){this.runFuncOnLocs((e,t,s)=>s.strChanged())}runFuncOnLocs(e){for(let t in this.locs){const s=this.locs[t];for(let i in s)e(t,i,s[i])}}createString(){return new At(this.cellsOwner,!0)}},iS=class extends ji{constructor(e){super(),this.question=e}getValue(e,t,s,i){if(e.length>0){const r=super.getValue(e,t,s,i);if(r&&r.isFound)return r}return new fs(this.question.value).getValue(e,t,s,i)}getRootObj(){return this.question.data}updateValueByItem(e,t){var s;const i=this.question.getMatrixRows();e=e.toLocaleLowerCase();for(let r=0;r<i.length;r++){const a=i[r];if((((s=a.name)===null||s===void 0?void 0:s.toString())||"").toLocaleLowerCase()===e){t.isFound=!0,t.context=a.getValueGetterContext();return}}}},$y=class extends ro{constructor(e){super(e),this.isRowChanging=!1,this.emptyLocalizableString=new At(this),this.cellsValue=new sS(this),this.cellsValue.onValuesChanged=()=>{this.updateHasCellText(),this.propertyValueChanged("cells",this.cells,this.cells)},this.registerPropertyChangedHandlers(["columns"],()=>{this.onColumnsChanged()}),this.registerPropertyChangedHandlers(["rows"],()=>{this.runCondition(this.getDataFilteredProperties()),this.onRowsChanged()}),this.registerPropertyChangedHandlers(["hideIfRowsEmpty"],()=>{this.updateVisibilityBasedOnRows()}),this.registerPropertyChangedHandlers(["cellType"],()=>{this.value=this.convertToCorrectValue(this.value)})}getType(){return"matrix"}get cellType(){return this.getPropertyValue("cellType")}set cellType(e){e!=="checkbox"&&(e="radio"),this.setPropertyValue("cellType",e)}get isMultiSelect(){return this.cellType==="checkbox"}get cellComponent(){return this.getPropertyValue("cellComponent")}set itemComponent(e){this.setPropertyValue("cellComponent",e)}get hasSingleInput(){return!1}get eachRowRequired(){return this.getPropertyValue("eachRowRequired")}set eachRowRequired(e){this.setPropertyValue("eachRowRequired",e)}get isAllRowRequired(){return this.eachRowRequired}set isAllRowRequired(e){this.eachRowRequired=e}get eachRowUnique(){return this.getPropertyValue("eachRowUnique")}set eachRowUnique(e){this.setPropertyValue("eachRowUnique",e)}get hasRows(){return this.rows.length>0}get rowOrder(){return this.getPropertyValue("rowOrder")}set rowOrder(e){e=e.toLowerCase(),e!=this.rowOrder&&(this.setPropertyValue("rowOrder",e),this.onRowsChanged())}get rowsOrder(){return this.rowOrder}set rowsOrder(e){this.rowOrder=e}get hideIfRowsEmpty(){return this.getPropertyValue("hideIfRowsEmpty")}set hideIfRowsEmpty(e){this.setPropertyValue("hideIfRowsEmpty",e)}getRows(){return this.rows}getColumns(){return this.visibleColumns}addColumn(e,t){var s=new Wy(e,t);return this.columns.push(s),s}get checkType(){return this.isMultiSelect?"checkbox":"radio"}formatCss(e){return(e||"").replace("{type}",this.checkType)}getItemClass(e,t){const s=e.isChecked(t),i=this.isReadOnly,r=!s&&!i,a=this.hasCellText,o=this.cssClasses;return new z().append(o.cell,a).append(a?o.cellText:this.formatCss(o.label)).append(o.itemOnError,!a&&(this.eachRowRequired||this.eachRowUnique?e.hasError:this.hasCssError())).append(a?o.cellTextSelected:this.formatCss(o.itemChecked),s).append(a?o.cellTextDisabled:this.formatCss(o.itemDisabled),this.isDisabledStyle).append(a?o.cellTextReadOnly:this.formatCss(o.itemReadOnly),this.isReadOnlyStyle).append(a?o.cellTextPreview:this.formatCss(o.itemPreview),this.isPreviewStyle).append(this.formatCss(o.itemHover),r&&!a).toString()}get itemSvgIcon(){return this.isPreviewStyle&&this.cssClasses.itemPreviewSvgIconId?this.cssClasses.itemPreviewSvgIconId:this.cssClasses.itemSvgIconId}getItemSvgIcon(e,t){return this.isMultiSelect&&e.isChecked(t)?this.cssClasses.itemPreviewSvgIconId:this.itemSvgIcon}get cssItemValue(){return this.formatCss(this.cssClasses.itemValue)}get cssMaterialDecorator(){return this.formatCss(this.cssClasses.materialDecorator)}get cssItemDecorator(){return this.formatCss(this.cssClasses.itemDecorator)}locStrsChanged(){super.locStrsChanged(),this.cells.locStrsChanged()}getQuizQuestionCount(){for(var e=0,t=0;t<this.rows.length;t++)this.isValueEmpty(this.correctAnswer[this.rows[t].value])||e++;return e}convertToCorrectValue(e){if(e==null||typeof e!="object")return e;const t=Object.keys(e);for(let s=0;s<t.length;s++){const i=t[s],r=e[i];Array.isArray(r)&&!this.isMultiSelect&&(r.length>0?e[i]=r[0]:delete e[i]),!Array.isArray(r)&&this.isMultiSelect&&(e[i]=[r])}return e}getCorrectAnswerCount(){for(var e=0,t=this.value,s=0;s<this.rows.length;s++){var i=this.rows[s].value;!this.isValueEmpty(t[i])&&this.isTwoValueEquals(this.correctAnswer[i],t[i])&&e++}return e}runConditionCore(e){Ce.runEnabledConditionsForItems(this.rows,void 0,e),super.runConditionCore(e)}createRowsVisibleIfRunner(){const e=this.getExpressionFromSurvey("rowsVisibleIf");return e?new Fs(e):null}onRowsChanged(){this.clearGeneratedRows(),super.onRowsChanged()}getMatrixRows(){if(this.generatedVisibleRows)return this.generatedVisibleRows;const e=new Array;let t=this.value;t||(t={});const s=this.rows;for(let i=0;i<s.length;i++){const r=s[i];if(this.isValueEmpty(r.value))continue;const a=this.id+"_"+r.value.toString().replace(/\s/g,"_");e.push(this.createMatrixRow(r,a,t[r.value]))}return this.generatedVisibleRows=e,e}getVisibleRows(){const e=[];return this.getMatrixRows().forEach(t=>{t.isVisible&&e.push(t)}),e}getRowByName(e){const t=this.visibleRows;for(let s=0;s<t.length;s++)if(t[s].name===e)return t[s];return null}getSingleInputQuestionsCore(e,t){if(this.nestedQuestionsValue)return this.nestedQuestionsValue;const s=[],i=this.isMultiSelect?"checkbox":"radiogroup";return this.visibleRows.forEach(r=>{const a=q.createClass(i);a.name=r.name,a.locTitle.sharedData=r.locText,a.choices=this.visibleColumns,a.value=r.value,a.isRequired=this.eachRowRequired,a.setSurveyImpl(this),a.setParentQuestion(this),s.push(a)}),this.nestedQuestionsValue=s,s}resetSingleInput(){super.resetSingleInput(),this.nestedQuestionsValue&&(this.nestedQuestionsValue.forEach(e=>e.dispose()),this.nestedQuestionsValue=null)}getSurveyData(){return this}getTextProcessor(){var e;return(e=this.surveyImpl)===null||e===void 0?void 0:e.getTextProcessor()}getValue(e){const t=this.getRowByName(e);return t?t.value:void 0}setValue(e,t,s,i,r){this.getRowByName(e).value=t}getVariable(e){var t;return(t=this.data)===null||t===void 0?void 0:t.getVariable(e)}setVariable(e,t){var s;(s=this.data)===null||s===void 0||s.setVariable(e,t)}getComment(e){var t;return(t=this.data)===null||t===void 0?void 0:t.getComment(e)}setComment(e,t,s){var i;(i=this.data)===null||i===void 0||i.setComment(e,t,s)}getAllValues(){var e;return(e=this.data)===null||e===void 0?void 0:e.getAllValues()}getFilteredProperties(){var e;return(e=this.data)===null||e===void 0?void 0:e.getFilteredProperties()}findQuestionByName(e){var t;return(t=this.data)===null||t===void 0?void 0:t.findQuestionByName(e)}getEditingSurveyElement(){var e;return(e=this.data)===null||e===void 0?void 0:e.getEditingSurveyElement()}sortVisibleRows(e){if(this.survey&&this.survey.isDesignMode)return e;var t=this.rowOrder.toLowerCase();return t==="random"?O.randomizeArray(e):e}endLoadingFromJson(){super.endLoadingFromJson(),this.rows=this.sortVisibleRows(this.rows),this.onRowsChanged(),this.onColumnsChanged()}isNewValueCorrect(e){return O.isValueObject(e,!0)}processRowsOnSet(e){return this.sortVisibleRows(e)}get visibleRows(){return this.getVisibleRows()}get cells(){return this.cellsValue}set cells(e){this.cells.setJson(e&&e.getJson?e.getJson():null)}get hasCellText(){return this.getPropertyValue("hasCellText",!1)}updateHasCellText(){this.setPropertyValue("hasCellText",!this.cells.isEmpty)}setCellText(e,t,s){this.cells.setCellText(e,t,s)}getCellText(e,t){return this.cells.getCellText(e,t)}setDefaultCellText(e,t){this.cells.setDefaultCellText(e,t)}getDefaultCellText(e){return this.cells.getDefaultCellText(e)}getCellDisplayText(e,t){return this.cells.getCellDisplayText(e,t)}getCellDisplayLocText(e,t){var s=this.cells.getCellDisplayLocText(e,t);return s||this.emptyLocalizableString}supportAutoAdvance(){return this.isMouseDown===!0&&this.hasValuesInAllRows()}onCheckForErrors(e,t,s){if(super.onCheckForErrors(e,t,s),!t||this.hasCssError()){const i={noValue:!1,isNotUnique:!1};this.checkErrorsAllRows(s,i),i.noValue&&e.push(new pP(null,this)),i.isNotUnique&&e.push(new gP(null,this))}}hasValuesInAllRows(){const e={noValue:!1,isNotUnique:!1};return this.checkErrorsAllRows(!1,e,!0),!e.noValue}checkErrorsAllRows(e,t,s){const i=this.eachRowRequired||s,r=this.eachRowUnique;if(t.noValue=!1,t.isNotUnique=!1,e&&(this.errorsInRow=void 0),!i&&!r)return;const a=this.visibleRows;if(!a)return;const o={};for(var l=0;l<a.length;l++){const u=a[l].value;let d=this.isValueEmpty(u);const h=r&&!d&&o[u]===!0;d=d&&i,e&&(d||h)&&this.addErrorIntoRow(a[l]),d||(o[u]=!0),t.noValue=t.noValue||d,t.isNotUnique=t.isNotUnique||h}e&&a.forEach(u=>{u.hasError=this.hasErrorInRow(u)})}addErrorIntoRow(e){this.errorsInRow||(this.errorsInRow={}),this.errorsInRow[e.name]=!0,e.hasError=!0}refreshRowsErrors(){this.errorsInRow&&this.checkErrorsAllRows(!0,{noValue:!1,isNotUnique:!1})}getIsAnswered(){return super.getIsAnswered()&&this.hasValuesInAllRows()}createMatrixRow(e,t,s){var i=new tS(e,t,this,s);return this.onMatrixRowCreated(i),i}onMatrixRowCreated(e){}setQuestionValue(e,t=!0){if(super.setQuestionValue(e,this.isRowChanging||t),!(!this.generatedVisibleRows||this.generatedVisibleRows.length==0)){this.isRowChanging=!0;var s=this.value;if(s||(s={}),this.rows.length==0)this.generatedVisibleRows[0].setValueDirectly(s);else for(var i=0;i<this.generatedVisibleRows.length;i++){var r=this.generatedVisibleRows[i],a=s[r.name];this.isValueEmpty(a)&&(a=null),this.generatedVisibleRows[i].setValueDirectly(a)}this.refreshRowsErrors(),this.updateIsAnswered(),this.isRowChanging=!1}}getValueGetterContext(){return new iS(this)}getDisplayValueCore(e,t){var s={};for(var i in t){var r=e?Ce.getTextOrHtmlByValue(this.rows,i):i;r||(r=i);var a=Ce.getTextOrHtmlByValue(this.columns,t[i]);a||(a=t[i]),s[r]=a}return s}getPlainData(e={includeEmpty:!0}){var t=super.getPlainData(e);if(t){var s=this.createValueCopy();t.isNode=!0,t.data=Object.keys(s||{}).map(i=>{var r=this.rows.filter(l=>l.value===i)[0],a={name:i,title:r?r.text:"row",value:s[i],displayValue:Ce.getTextOrHtmlByValue(this.visibleColumns,s[i]),getString:l=>typeof l=="object"?JSON.stringify(l):l,isNode:!1},o=Ce.getItemByValue(this.visibleColumns,s[i]);return o&&(e.calculations||[]).forEach(l=>{a[l.propertyName]=o[l.propertyName]}),a})}return t}addConditionObjectsByContext(e,t){for(var s=0;s<this.rows.length;s++){var i=this.rows[s];i.value&&e.push({name:this.getValueName()+"."+i.value,text:this.processedTitle+"."+i.calculatedText,question:this})}}getConditionJson(e=null,t=null){if(!t)return super.getConditionJson(e);var s=new ns(t);s.choices=this.columns;var i=new qt().toJsonObject(s);return i.type=s.getType(),i}clearIncorrectValues(){this.clearInvisibleValuesInRowsAndColumns(!0,!0,!0),super.clearIncorrectValues()}clearValueIfInvisibleCore(e){super.clearValueIfInvisibleCore(e),this.clearInvisibleValuesInRowsAndColumns(!0,!0,!1)}clearInvisibleColumnValues(){this.clearInvisibleValuesInRowsAndColumns(!1,!0,!1)}clearInvisibleValuesInRows(){this.clearInvisibleValuesInRowsAndColumns(!0,!1,!1)}clearInvisibleValuesInRowsAndColumns(e,t,s){if(this.isEmpty())return;let i=this.getUnbindValue(this.value);const r={},a=this.rows;for(let o=0;o<a.length;o++){const l=a[o].value;i[l]&&(e&&!a[o].isVisible?delete i[l]:(t&&this.clearIncorrectValuesInRow(l,i),i[l]!=null&&(r[l]=i[l])))}s&&(i=r),!this.isTwoValueEquals(i,this.value)&&(this.value=i)}clearIncorrectValuesInRow(e,t){const s=t[e];if(s===void 0){delete t[e];return}if(this.isMultiSelect&&Array.isArray(s)){for(let i=s.length-1;i>=0;i--)this.getVisibleColumnByValue(s[i])||s.splice(i,1);s.length===0&&delete t[e]}else this.getVisibleColumnByValue(s)||delete t[e]}getVisibleColumnByValue(e){const t=Ce.getItemByValue(this.columns,e);return t&&t.isVisible?t:null}getFirstInputElementId(){var e=this.generatedVisibleRows;return e||(e=this.visibleRows),e.length>0&&this.visibleColumns.length>0?this.inputId+"_"+e[0].name+"_0":super.getFirstInputElementId()}onMatrixRowChanged(e){if(!this.isRowChanging){if(this.isRowChanging=!0,!this.hasRows)this.setNewValue(e.value);else{const t=this.value||{};this.isValueEmpty(e.value)?delete t[e.name]:t[e.name]=e.value,this.setNewValue(t)}this.isRowChanging=!1}}getCorrectedRowValue(e){const t=this.getColumnByValue(e);return t?t.value:e}getDisplayRowValue(e){const t=this.getColumnByValue(e);return t?t.text:e!=null?e.toString():""}cellClick(e,t){this.isReadOnly||this.isDisabledAttr||(e.value=this.getValueOnCellClick(e,t))}getValueOnCellClick(e,t){if(this.isMultiSelect){if(t.isExclusive)return this.isCellChecked(e,t)?void 0:[t.value];let s=Array.isArray(e.value)?[].concat(e.value):[];if(this.isCellChecked(e,t)){const i=this.getRowValueIndex(e,t);i>-1&&s.splice(i,1),s.length===0&&(s=void 0)}else Array.isArray(s)||(s=[]),this.columns.forEach(i=>{if(i.isExclusive){const r=s.indexOf(i.value);r>-1&&s.splice(r,1)}}),s.push(t.value);return s}return t.value}isCellChecked(e,t){return this.isMultiSelect?this.getRowValueIndex(e,t)>-1:O.isTwoValueEquals(e.value,t.value)}getRowValueIndex(e,t){const s=e.value;if(!Array.isArray(s))return-1;for(let i=0;i<s.length;i++)if(this.isTwoValueEquals(s[i],t.value))return i;return-1}getColumnByValue(e){const t=this.columns;for(var s=0;s<t.length;s++)if(e===t[s].value)return t[s];for(var s=0;s<t.length;s++)if(this.isTwoValueEquals(e,t[s].value))return t[s];return null}hasErrorInRow(e){return!!this.errorsInRow&&!!this.errorsInRow[e.name]}getSearchableItemValueKeys(e){e.push("columns"),e.push("rows")}get SurveyModel(){return this.survey}getColumnHeaderWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName({column:e},"column-header")}getColumnHeaderWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData({column:e},"column-header")}getRowHeaderWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName({row:e},"row-header")}getRowHeaderWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData({row:e},"row-header")}};q.addClass("matrixcolumn",[{name:"isExclusive:boolean",visibleIf:n=>{var e;return((e=n.locOwner)===null||e===void 0?void 0:e.cellType)==="checkbox"},locationInTable:"detail"}],n=>new Wy(n),"itemvalue"),q.addClass("matrix",["rowTitleWidth",{name:"columns:matrixcolumn[]",uniqueProperty:"value",baseValue:function(){return Ct("matrix_column")}},{name:"rows:itemvalue[]",uniqueProperty:"value",baseValue:function(){return Ct("matrix_row")}},{name:"cells:cells",serializationProperty:"cells"},{name:"rowOrder",alternativeName:"rowsOrder",default:"initial",choices:["initial","random"]},{name:"eachRowRequired:boolean",alternativeName:"isAllRowRequired"},{name:"eachRowUnique:boolean",category:"validation"},"hideIfRowsEmpty:boolean",{name:"cellComponent",visible:!1,default:"survey-matrix-cell"},{name:"cellType",default:"radio",choices:["radio","checkbox"]}],function(){return new $y("")},"matrixbase"),qe.Instance.registerQuestion("matrix",n=>{var e=new $y(n);return e.rows=qe.DefaultRows,e.columns=qe.DefaultColums,e});let Gy=class extends Te{updateRemainingCharacterCounter(e,t){this.remainingCharacterCounter=O.getRemainingCharacterCounterText(e,t)}};S([E()],Gy.prototype,"remainingCharacterCounter",void 0);let go=class extends Dt{constructor(e){super(e),this.characterCounter=new Gy}isTextValue(){return!0}get maxLength(){return this.getPropertyValue("maxLength")}set maxLength(e){this.setPropertyValue("maxLength",e),this.updateRemainingCharacterCounter(this.value)}getMaxLength(){return O.getMaxLength(this.maxLength,this.survey?this.survey.maxTextLength:-1)}updateRemainingCharacterCounter(e){this.characterCounter.updateRemainingCharacterCounter(e,this.getMaxLength())}get placeHolder(){return this.placeholder}set placeHolder(e){this.placeholder=e}get locPlaceHolder(){return this.locPlaceholder}getType(){return"textbase"}isEmpty(){return super.isEmpty()||this.value===""}get textUpdateMode(){return this.getPropertyValue("textUpdateMode")}set textUpdateMode(e){this.setPropertyValue("textUpdateMode",e)}getIsInputTextUpdate(){return this.textUpdateMode=="default"?super.getIsInputTextUpdate():this.textUpdateMode=="onTyping"}get renderedPlaceholder(){const e=()=>this.hasPlaceholder()?this.placeHolder:void 0;return this.getPropertyValue("renderedPlaceholder",void 0,e)}onReadOnlyChanged(){super.onReadOnlyChanged(),this.resetRenderedPlaceholder()}localeChanged(){super.localeChanged(),this.resetRenderedPlaceholder()}supportEmptyValidation(){return!0}resetRenderedPlaceholder(){this.resetPropertyValue("renderedPlaceholder")}hasPlaceholder(){return!this.isReadOnly}setNewValue(e){super.setNewValue(e),this.updateRemainingCharacterCounter(e)}setQuestionValue(e,t=!0){super.setQuestionValue(e,t),this.updateRemainingCharacterCounter(e)}convertToCorrectValue(e){return Array.isArray(e)?e.join(this.getValueSeparator()):e}getValueSeparator(){return", "}getControlCssClassBuilder(){return new z().append(this.cssClasses.root).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle)}getControlClass(){return this.getControlCssClassBuilder().toString()}get isNewA11yStructure(){return!0}};S([E({localizable:!0,onSet:(n,e)=>e.resetRenderedPlaceholder()})],go.prototype,"placeholder",void 0),q.addClass("textbase",[],function(){return new go("")},"question");let rS=class{setInputValue(e){this.inputElement.maxLength>=0&&this.inputElement.maxLength<e.length&&(e=e.slice(0,this.inputElement.maxLength)),this.inputElement.value=e}constructor(e,t,s){this.inputMaskInstance=e,this.inputElement=t,this.prevUnmaskedValue=void 0,this.inputMaskInstancePropertyChangedHandler=(r,a)=>{if(a.name!=="saveMaskedValue"){const o=this.inputMaskInstance.getMaskedValue(this.prevUnmaskedValue);this.setInputValue(o)}},this.clickHandler=r=>{this.inputElement.value==this.inputMaskInstance.getMaskedValue("")&&this.inputElement.setSelectionRange(0,0)},this.beforeInputHandler=r=>{const a=this.createArgs(r),o=this.inputMaskInstance.processInput(a);this.setInputValue(o.value),this.inputElement.setSelectionRange(o.caretPosition,o.caretPosition),o.cancelPreventDefault||r.preventDefault()},this.changeHandler=r=>{const a=this.inputMaskInstance.processInput({prevValue:"",insertedChars:r.target.value,selectionStart:0,selectionEnd:0});this.setInputValue(a.value)};let i=s;i==null&&(i=""),this.setInputValue(e.saveMaskedValue?i:e.getMaskedValue(i)),this.prevUnmaskedValue=i,e.onPropertyChanged.add(this.inputMaskInstancePropertyChangedHandler),this.addInputEventListener()}createArgs(e){const t={insertedChars:e.data,selectionStart:e.target.selectionStart,selectionEnd:e.target.selectionEnd,prevValue:e.target.value,inputDirection:"forward"};return e.inputType==="deleteContentBackward"&&(t.inputDirection="backward",t.selectionStart===t.selectionEnd&&(t.selectionStart=Math.max(t.selectionStart-1,0))),e.inputType==="deleteContentForward"&&t.selectionStart===t.selectionEnd&&(t.selectionEnd+=1),t}addInputEventListener(){this.inputElement&&(this.inputElement.addEventListener("beforeinput",this.beforeInputHandler),this.inputElement.addEventListener("click",this.clickHandler),this.inputElement.addEventListener("focus",this.clickHandler),this.inputElement.addEventListener("change",this.changeHandler))}removeInputEventListener(){this.inputElement&&(this.inputElement.removeEventListener("beforeinput",this.beforeInputHandler),this.inputElement.removeEventListener("click",this.clickHandler),this.inputElement.removeEventListener("focus",this.clickHandler),this.inputElement.removeEventListener("change",this.changeHandler))}dispose(){this.removeInputEventListener(),this.inputElement=void 0,this.inputMaskInstance.onPropertyChanged.remove(this.inputMaskInstancePropertyChangedHandler)}};var nh=/[0-9]/;function Jy(){const e=(q.getChildrenClasses("masksettings")||[]).map(t=>{let s=t.name;return t.name.indexOf("mask")!==-1&&(s=s.slice(0,s.indexOf("mask"))),s});return e.unshift("none"),e}let Pr=class extends go{createMaskAdapter(){this.input&&!this.maskTypeIsEmpty&&(this.maskInputAdapter=new rS(this.maskInstance,this.input,this.value))}deleteMaskAdapter(){this.maskInputAdapter&&(this.maskInputAdapter.dispose(),this.maskInputAdapter=void 0)}updateMaskAdapter(){this.deleteMaskAdapter(),this.createMaskAdapter()}onSetMaskType(e){this.setNewMaskSettingsProperty(),this.updateMaskAdapter()}get maskTypeIsEmpty(){switch(this.inputType){case"tel":case"text":return this.maskType==="none";default:return!0}}get maskSettings(){return this.getPropertyValue("maskSettings")}set maskSettings(e){if(!e)return;const t=this.maskSettings;t&&t.dispose(),this.setNewMaskSettingsProperty(),this.maskSettings.fromJSON(e.toJSON()),this.updateMaskAdapter()}setNewMaskSettingsProperty(){this.setPropertyValue("maskSettings",this.createMaskSettings())}createMaskSettings(){let e=!this.maskType||this.maskType==="none"?"masksettings":this.maskType+"mask";q.findClass(e)||(e="masksettings");const t=q.createClass(e);return t.onPropertyChanged.add((s,i)=>{this.onNestedPropertyChanged.fire(this,{name:"maskSettings",newValue:i.newValue,nestedName:i.name}),this.updateInputValue()}),t.owner=this,t}constructor(e){super(e),this._isWaitingForEnter=!1,this.onCompositionUpdate=t=>{this.isInputTextUpdate&&setTimeout(()=>{this.updateValueOnEvent(t)},1),this.updateRemainingCharacterCounter(t.target.value)},this.onKeyUp=t=>{this.updateDateValidationMessage(t),this.isInputTextUpdate?(!this._isWaitingForEnter||t.keyCode===13)&&(this.updateValueOnEvent(t),this._isWaitingForEnter=!1):t.keyCode===13&&this.updateValueOnEvent(t),this.updateRemainingCharacterCounter(t.target.value)},this.readOnlyBlocker=t=>{if(this.isReadOnlyAttr&&["color","range"].indexOf(this.inputType)>-1)return t.preventDefault(),!0},this.onKeyDown=t=>{this.readOnlyBlocker(t)||(this.onKeyDownPreprocess&&this.onKeyDownPreprocess(t),this.isInputTextUpdate&&(this._isWaitingForEnter=t.keyCode===229),this.onTextKeyDownHandler(t))},this.onChange=t=>{this.updateDateValidationMessage(t),t.target===A.environment.root.activeElement?this.isInputTextUpdate&&this.updateValueOnEvent(t):this.updateValueOnEvent(t),this.updateRemainingCharacterCounter(t.target.value)},this.createLocalizableString("minErrorText",this,!0,"minError"),this.createLocalizableString("maxErrorText",this,!0,"maxError"),this.setNewMaskSettingsProperty(),this.locDataListValue=new Q2(this),this.locDataListValue.onValueChanged=(t,s)=>{this.propertyValueChanged("dataList",t,s)},this.registerPropertyChangedHandlers(["min","max","inputType","minValueExpression","maxValueExpression"],()=>{this.setRenderedMinMax()}),this.registerPropertyChangedHandlers(["inputType","inputSize"],()=>{this.resetInputSize(),this.resetRenderedPlaceholder()})}isTextValue(){return this.isDateInputType||["text","number","password"].indexOf(this.inputType)>-1}getType(){return"text"}onSurveyLoad(){super.onSurveyLoad(),this.setRenderedMinMax()}get inputType(){return this.getPropertyValue("inputType")}set inputType(e){e=e.toLowerCase(),(e==="datetime_local"||e==="datetime")&&(e="datetime-local"),this.setPropertyValue("inputType",e.toLowerCase()),this.isLoadingFromJson||(this.min=void 0,this.max=void 0,this.step=void 0),this.updateMaskAdapter()}getMaxLength(){return this.isTextInput?super.getMaxLength():null}getSupportedValidators(){const e={},t=["text","email","tel","password","url"];e.text=t,e.regex=t,e.email=["email"],e.numeric=["number","range"];const s=super.getSupportedValidators();for(let i=s.length-1;i>=0;i--){const r=s[i];e[r]&&e[r].indexOf(this.inputType)<0&&s.splice(i,1)}return s}runConditionCore(e){super.runConditionCore(e),(this.minValueExpression||this.maxValueExpression)&&this.setRenderedMinMax(e)}getDisplayValueCore(e,t){return!this.maskTypeIsEmpty&&!O.isValueEmpty(t)?this.maskInstance.getMaskedValue(t):super.getDisplayValueCore(e,t)}isLayoutTypeSupported(e){return!0}get inputSize(){return this.getPropertyValue("inputSize")}set inputSize(e){this.setPropertyValue("inputSize",e)}get size(){return this.inputSize}set size(e){this.inputSize=e}get isTextInput(){return["text","search","tel","url","email","password"].indexOf(this.inputType)>-1}get renderedInputSize(){return this.getPropertyValue("renderedInputSize",void 0,()=>{const e=this.calInputSize();return e>0?e:void 0})}get inputWidth(){return this.getPropertyValue("inputWidth",void 0,()=>this.calInputSize()>0?"auto":"")}calInputSize(){if(!this.isTextInput)return 0;let e=this.inputSize>0?this.inputSize:0;return e<1&&this.parent&&this.parent.inputSize&&(e=this.parent.inputSize),e}resetInputSize(){this.resetPropertyValue("renderedInputSize"),this.resetPropertyValue("inputWidth")}get autocomplete(){return this.getPropertyValue("autocomplete")}set autocomplete(e){this.setPropertyValue("autocomplete",e)}get min(){return this.getPropertyValue("min")}set min(e){if(this.isValueExpression(e)){this.minValueExpression=e.substring(1);return}this.setPropertyValue("min",e)}get max(){return this.getPropertyValue("max")}set max(e){if(this.isValueExpression(e)){this.maxValueExpression=e.substring(1);return}this.setPropertyValue("max",e)}get minValueExpression(){return this.getPropertyValue("minValueExpression","")}set minValueExpression(e){this.setPropertyValue("minValueExpression",e)}get maxValueExpression(){return this.getPropertyValue("maxValueExpression","")}set maxValueExpression(e){this.setPropertyValue("maxValueExpression",e)}get renderedMin(){return this.getPropertyValue("renderedMin")}get renderedMax(){return this.getPropertyValue("renderedMax")}get minErrorText(){return this.getLocalizableStringText("minErrorText")}set minErrorText(e){this.setLocalizableStringText("minErrorText",e)}get locMinErrorText(){return this.getLocalizableString("minErrorText")}get maxErrorText(){return this.getLocalizableStringText("maxErrorText")}set maxErrorText(e){this.setLocalizableStringText("maxErrorText",e)}get locMaxErrorText(){return this.getLocalizableString("maxErrorText")}get isMinMaxType(){return zs(this)}get maskInstance(){return this.maskSettings}get inputValue(){return!this._inputValue&&!this.maskTypeIsEmpty?this.maskInstance.getMaskedValue(""):this._inputValue}set inputValue(e){let t=e;this._inputValue=e,this.maskTypeIsEmpty||(t=this.maskInstance.getUnmaskedValue(e),this._inputValue=this.maskInstance.getMaskedValue(t),t&&this.maskSettings.saveMaskedValue&&(t=this._inputValue)),O.isTwoValueEquals(this.value,t,!1,!0)||(this.value=t)}getFilteredValue(){return this.getExpressionValue(this.value)}getExpressionValue(e){return!this.maskTypeIsEmpty&&this.maskSettings.saveMaskedValue?this.maskInstance.getUnmaskedValue(e):e}convertToCorrectValue(e){return e!=null&&typeof e!="string"&&!this.maskTypeIsEmpty&&this.maskSettings.saveMaskedValue?this.maskInstance.getMaskedValue(e):super.convertToCorrectValue(e)}onChangeQuestionValue(e){super.onChangeQuestionValue(e),this.updateInputValue()}updateInputValue(){const e=this.value;this.maskTypeIsEmpty?this._inputValue=e:this.maskSettings.saveMaskedValue?this._inputValue=e??this.maskInstance.getMaskedValue(""):this._inputValue=this.maskInstance.getMaskedValue(e)}hasToConvertToUTC(e){return A.storeUtcDates&&this.isDateTimeLocaleType()&&!!e}createDate(e){return Rt("question-text",e)}valueForSurveyCore(e){return this.hasToConvertToUTC(e)&&(e=this.createDate(e).toISOString()),super.valueForSurveyCore(e)}valueFromDataCore(e){if(this.hasToConvertToUTC(e)){const t=this.createDate(e);let i=this.createDate(t.getTime()-t.getTimezoneOffset()*60*1e3).toISOString();e=i.substring(0,i.length-2)}return super.valueFromDataCore(e)}onCheckForErrors(e,t,s){super.onCheckForErrors(e,t,s);const i=this.getIsInputTextUpdate();if(!(t&&i)){if(!this.isOnValueChanged){if(this.isValueLessMin){const r=new vs(this.getMinMaxErrorText(this.minErrorText,this.getCalculatedMinMax(this.renderedMin)),this);r.onUpdateErrorTextCallback=a=>{a.text=this.getMinMaxErrorText(this.minErrorText,this.getCalculatedMinMax(this.renderedMin))},e.push(r)}if(this.isValueGreaterMax){const r=new vs(this.getMinMaxErrorText(this.maxErrorText,this.getCalculatedMinMax(this.renderedMax)),this);r.onUpdateErrorTextCallback=a=>{a.text=this.getMinMaxErrorText(this.maxErrorText,this.getCalculatedMinMax(this.renderedMax))},e.push(r)}this.isStepNumberIncorrect&&e.push(new vs(this.getStepErrorText(),this)),e.length===0&&this.dateValidationMessage&&e.push(new vs(this.dateValidationMessage,this))}if(this.inputType==="email"&&!this.validators.some(r=>r.getType()==="emailvalidator")){const r=this.getValidatorTitle(),a=new Iy;a.errorOwner=this;const o=a.validate(this.value,r);o&&o.error&&e.push(o.error)}}}canSetValueToSurvey(){if(!this.isMinMaxType)return!0;const e=!this.isValueLessMin&&!this.isValueGreaterMax;return(!e||this.errors.length>0)&&this.survey&&(this.survey.isValidateOnValueChanging||this.survey.isValidateOnValueChanged)&&this.validate(),e}convertFuncValuetoQuestionValue(e){let t=this.maskTypeIsEmpty?this.inputType:this.maskSettings.getTypeForExpressions();return O.convertValToQuestionVal(e,t)}getMinMaxErrorText(e,t){if(O.isValueEmpty(t))return e;let s=t.toString();return this.inputType==="date"&&t.toDateString&&(s=t.toDateString()),e.replace("{0}",s)}getStepErrorText(){return this.getLocalizationString("stepError").replace("{0}",this.renderedStep)}get isValueLessMin(){return!this.isValueEmpty(this.renderedMin)&&!this.isEmpty()&&this.getCalculatedMinMax(this.value)<this.getCalculatedMinMax(this.renderedMin)}get isValueGreaterMax(){return!this.isValueEmpty(this.renderedMax)&&!this.isEmpty()&&this.getCalculatedMinMax(this.value)>this.getCalculatedMinMax(this.renderedMax)}get isStepNumberIncorrect(){if(this.inputType!=="number"||this.isEmpty()||!O.isNumber(this.renderedStep)||!O.isNumber(this.value))return!1;let e=O.getNumber(this.value),t=O.getNumber(this.renderedStep),s=1;for(;Math.round(t*s)/s!==t&&s<1e6;)s*=10;return e=e*s,t=t*s,t>0&&e%t!==0}get isDateInputType(){return this.inputType==="date"||this.isDateTimeLocaleType()}isDateTimeLocaleType(){return this.inputType==="datetime-local"}getCalculatedMinMax(e){return this.isValueEmpty(e)?e:this.isDateInputType?this.createDate(e):e}setRenderedMinMax(e=null){const t=(r,a)=>{this.setPropertyValue(r,this.convertFuncValuetoQuestionValue(a))},s=r=>{!r&&this.isDateInputType&&A.minDate&&(r=A.minDate),t("renderedMin",r)},i=r=>{!r&&this.isDateInputType&&(r=A.maxDate),t("renderedMax",r)};this.runExpressionByProperty("minValueExpression",e,r=>{s(r)})||s(this.min),this.runExpressionByProperty("maxValueExpression",e,r=>{i(r)})||i(this.max)}get step(){return this.getPropertyValue("step")}set step(e){this.setPropertyValue("step",e)}get renderedStep(){return this.isValueEmpty(this.step)?this.inputType!=="number"?void 0:"any":this.step}getIsInputTextUpdate(){return this.maskTypeIsEmpty?super.getIsInputTextUpdate():!1}supportAutoAdvance(){return!this.getIsInputTextUpdate()&&!this.isDateInputType}supportGoNextPageError(){return!this.isDateInputType}get dataList(){return this.locDataList.value}set dataList(e){this.locDataList.value=e}get locDataList(){return this.locDataListValue}get dataListId(){return this.locDataList.hasValue()?this.id+"_datalist":void 0}setNewValue(e){e=this.correctValueType(e),e&&(this.dateValidationMessage=void 0),super.setNewValue(e)}correctValueType(e){if(!e)return e;if(this.inputType==="number"||this.inputType==="range")return O.isNumber(e)?O.getNumber(e):"";if(this.inputType==="month"){const t=this.createDate(e),s=t.toISOString().indexOf(e)==0&&e.indexOf("T")==-1,i=s?t.getUTCMonth():t.getMonth(),r=s?t.getUTCFullYear():t.getFullYear(),a=i+1;return r+"-"+(a<10?"0":"")+a}return e}hasPlaceholder(){return!this.isReadOnly&&this.inputType!=="range"}getControlCssClassBuilder(){const e=this.getMaxLength();return super.getControlCssClassBuilder().append(this.cssClasses.constrolWithCharacterCounter,!!e).append(this.cssClasses.characterCounterBig,e>99)}isReadOnlyRenderDiv(){return this.isReadOnly&&A.readOnly.textRenderMode==="div"}get inputStyle(){var e={};return e.width=this.inputWidth,this.updateTextAlign(e),e}updateTextAlign(e){this.inputTextAlignment!=="auto"?e.textAlign=this.inputTextAlignment:!this.maskTypeIsEmpty&&this.maskSettings.getTextAlignment()!=="auto"&&(e.textAlign=this.maskSettings.getTextAlignment())}updateValueOnEvent(e){const t=e.target.value;this.isTwoValueEquals(this.value,t)||(this.inputValue=t)}updateDateValidationMessage(e){this.dateValidationMessage=this.isDateInputType&&e.target?e.target.validationMessage:void 0}onBlurCore(e){this.updateDateValidationMessage(e),this.updateValueOnEvent(e),this.updateRemainingCharacterCounter(e.target.value),super.onBlurCore(e)}onFocusCore(e){this.updateRemainingCharacterCounter(e.target.value),super.onFocusCore(e)}afterRenderQuestionElement(e){e&&(this.input=e instanceof HTMLInputElement?e:e.querySelector("input"),this.createMaskAdapter()),super.afterRenderQuestionElement(e)}beforeDestroyQuestionElement(e){this.deleteMaskAdapter(),this.input=void 0}};S([E({onSet:(n,e)=>{e.onSetMaskType(n)}})],Pr.prototype,"maskType",void 0),S([E()],Pr.prototype,"inputTextAlignment",void 0),S([E()],Pr.prototype,"_inputValue",void 0);const nS=["number","range","date","datetime-local","month","time","week"];function zs(n){const e=n?n.inputType:"";return e?nS.indexOf(e)>-1:!1}function Ky(n,e){const t=n.split(e);return t.length!==2||!O.isNumber(t[0])||!O.isNumber(t[1])?-1:parseFloat(t[0])*60+parseFloat(t[1])}function aS(n,e,t){const s=Ky(n,t),i=Ky(e,t);return s<0||i<0?!1:s>i}function Zy(n,e,t,s){let i=s?t:e;if(!zs(n)||O.isValueEmpty(e)||O.isValueEmpty(t))return i;if(n.inputType.indexOf("date")===0||n.inputType==="month"){const r=n.inputType==="month",a="question-text-minmax",o=Rt(a,r?e+"-01":e),l=Rt(a,r?t+"-01":t);if(!o||!l)return i;if(o>l)return s?e:t}if(n.inputType==="week"||n.inputType==="time"){const r=n.inputType==="week"?"-W":":";return aS(e,t,r)?s?e:t:i}if(n.inputType==="number"){if(!O.isNumber(e)||!O.isNumber(t))return i;if(O.getNumber(e)>O.getNumber(t))return s?e:t}return typeof e=="string"||typeof t=="string"?i:e>t?s?e:t:i}function Yy(n,e){n&&n.inputType&&(e.inputType=n.inputType!=="range"?n.inputType:"number",e.textUpdateMode="onBlur")}q.addClass("text",[{name:"inputType",default:"text",choices:A.questions.inputTypes},{name:"inputSize:number",alternativeName:"size",minValue:0,dependsOn:"inputType",visibleIf:function(n){return n?n.isTextInput:!1}},{name:"textUpdateMode",default:"default",choices:["default","onBlur","onTyping"],dependsOn:"inputType",visibleIf:function(n){return n?n.isTextInput:!1}},{name:"autocomplete",alternativeName:"autoComplete",choices:A.questions.dataList},{name:"min",dependsOn:"inputType",visibleIf:function(n){return zs(n)},onPropertyEditorUpdate:function(n,e){Yy(n,e)},onSettingValue:(n,e)=>Zy(n,e,n.max,!1)},{name:"max",dependsOn:"inputType",nextToProperty:"*min",visibleIf:function(n){return zs(n)},onSettingValue:(n,e)=>Zy(n,n.min,e,!0),onPropertyEditorUpdate:function(n,e){Yy(n,e)}},{name:"minValueExpression:expression",category:"logic",dependsOn:"inputType",visibleIf:function(n){return zs(n)}},{name:"maxValueExpression:expression",category:"logic",dependsOn:"inputType",visibleIf:function(n){return zs(n)}},{name:"minErrorText",serializationProperty:"locMinErrorText",dependsOn:"inputType",visibleIf:function(n){return zs(n)}},{name:"maxErrorText",serializationProperty:"locMaxErrorText",dependsOn:"inputType",visibleIf:function(n){return zs(n)}},{name:"inputTextAlignment",default:"auto",choices:["left","right","auto"]},{name:"maskType",default:"none",visibleIndex:0,dependsOn:"inputType",visibleIf:n=>n.inputType==="text"||n.inputType==="tel",choices:n=>Jy()},{name:"maskSettings:masksettings",className:"masksettings",visibleIndex:1,dependsOn:["inputType","maskType"],visibleIf:n=>n.inputType==="text"||n.inputType==="tel",onGetValue:function(n){return n.maskSettings.getData()},onSetValue:function(n,e){n.maskSettings.setData(e)}},{name:"step:number",dependsOn:"inputType",visibleIf:function(n){return n?n.inputType==="number"||n.inputType==="range":!1}},{name:"maxLength:number",default:-1,dependsOn:"inputType",visibleIf:function(n){return n?n.isTextInput:!1}},{name:"placeholder",alternativeName:"placeHolder",serializationProperty:"locPlaceholder",dependsOn:"inputType",visibleIf:function(n){return n?n.isTextInput:!1}},{name:"dataList:string[]",serializationProperty:"locDataList",dependsOn:"inputType",visibleIf:function(n){return n?n.inputType==="text":!1}}],function(){return new Pr("")},"textbase"),qe.Instance.registerQuestion("text",n=>new Pr(n));let oS=class extends ji{constructor(e){super(),this.question=e}getRootObj(){return this.question.data}updateValueByItem(e,t){const s=this.question.items;for(let i=0;i<s.length;i++){const r=s[i].question;if(r.getValueName()===e){t.isFound=!0,t.context=r.getValueGetterContext();return}}}},lS=class extends Pr{get a11y_input_ariaLabel(){return this.locTitle.renderedHtml}get a11y_input_ariaLabelledBy(){return null}get a11y_input_ariaDescribedBy(){return null}},Xy=class extends Te{constructor(e=null,t=null){super(),this.focusIn=()=>{this.editor.focusIn()},this.editorValue=this.createEditor(e),this.maskSettings=this.editorValue.maskSettings,this.editor.questionTitleTemplateCallback=function(){return""},this.editor.titleLocation="left",t&&(this.title=t),this.editor.onPropertyChanged.add((s,i)=>{i.name!=="maskSettings"&&this.onPropertyChanged.fire(this,i)})}getType(){return"multipletextitem"}get id(){return this.editor.id}getOriginalObj(){return this.editor}get name(){return this.editor.name}set name(e){this.editor.name=e}get question(){return this.data}get editor(){return this.editorValue}createEditor(e){return new lS(e)}addUsedLocales(e){super.addUsedLocales(e),this.editor.addUsedLocales(e)}localeChanged(){super.localeChanged(),this.editor.localeChanged()}locStrsChanged(){super.locStrsChanged(),this.editor.locStrsChanged()}setData(e){this.data=e,e&&(this.editor.defaultValue=e.getItemDefaultValue(this.name),this.editor.setSurveyImpl(this),this.editor.parent=e,this.editor.setParentQuestion(e))}get isRequired(){return this.editor.isRequired}set isRequired(e){this.editor.isRequired=e}get inputType(){return this.editor.inputType}set inputType(e){this.editor.inputType=e}get title(){return this.editor.title}set title(e){this.editor.title=e}get locTitle(){return this.editor.locTitle}get fullTitle(){return this.editor.fullTitle}get maxLength(){return this.editor.maxLength}set maxLength(e){this.editor.maxLength=e}getMaxLength(){var e=this.getSurvey();return O.getMaxLength(this.maxLength,e?e.maxTextLength:-1)}get placeholder(){return this.editor.placeholder}set placeholder(e){this.editor.placeholder=e}get locPlaceholder(){return this.editor.locPlaceholder}get placeHolder(){return this.placeholder}set placeHolder(e){this.placeholder=e}get locPlaceHolder(){return this.locPlaceholder}get requiredErrorText(){return this.editor.requiredErrorText}set requiredErrorText(e){this.editor.requiredErrorText=e}get locRequiredErrorText(){return this.editor.locRequiredErrorText}get inputSize(){return this.editor.inputSize}set inputSize(e){this.editor.inputSize=e}get size(){return this.inputSize}set size(e){this.inputSize=e}get defaultValueExpression(){return this.editor.defaultValueExpression}set defaultValueExpression(e){this.editor.defaultValueExpression=e}get minValueExpression(){return this.editor.minValueExpression}set minValueExpression(e){this.editor.minValueExpression=e}get maxValueExpression(){return this.editor.maxValueExpression}set maxValueExpression(e){this.editor.maxValueExpression=e}get validators(){return this.editor.validators}set validators(e){this.editor.validators=e}getValidators(){return this.validators}get maskType(){return this.editor.maskType}set maskType(e){this.editor.maskType=e,this.maskSettings=this.editor.maskSettings}get maskSettings(){return this.getPropertyValue("maskSettings")}set maskSettings(e){this.setPropertyValue("maskSettings",e),this.editor.maskSettings!==e&&(this.editor.maskSettings=e)}get inputTextAlignment(){return this.editor.inputTextAlignment}set inputTextAlignment(e){this.editor.inputTextAlignment=e}get value(){return this.data?this.data.getMultipleTextValue(this.name):null}set value(e){this.data!=null&&this.data.setMultipleTextValue(this.name,e)}isEmpty(){return this.editor.isEmpty()}onValueChanged(e){this.valueChangedCallback&&this.valueChangedCallback(e)}getSurveyData(){return this}getSurvey(){return this.data?this.data.getSurvey():null}getTextProcessor(){return this.data?this.data.getTextProcessor():null}getValue(e){return this.data?this.data.getMultipleTextValue(e):null}setValue(e,t){this.data&&this.data.setMultipleTextValue(e,t)}getVariable(e){}setVariable(e,t){}getComment(e){return null}setComment(e,t){}getAllValues(){return this.data?this.data.getAllValues():this.value}getFilteredProperties(){return{survey:this.getSurvey()}}findQuestionByName(e){const t=this.getSurvey();return t?t.getQuestionByName(e):null}getEditingSurveyElement(){}getValidatorTitle(){return this.title}get validatedValue(){return this.value}set validatedValue(e){this.value=e}getDataFilteredProperties(){return this.getFilteredProperties()}},mo=class extends Dt{static addDefaultItems(e){for(var t=qe.DefaultMutlipleTextItems,s=0;s<t.length;s++)e.addItem(t[s])}constructor(e){super(e),this.isMultipleItemValueChanging=!1,this.createNewArray("items",t=>{t.setData(this),this.survey&&this.survey.multipleTextItemAdded(this,t)}),this.registerPropertyChangedHandlers(["items","colCount","itemErrorLocation"],()=>{this.calcVisibleRows()}),this.registerPropertyChangedHandlers(["inputSize"],()=>{this.resetItemsSize()})}getType(){return"multipletext"}setSurveyImpl(e,t){super.setSurveyImpl(e,t);for(var s=0;s<this.items.length;s++)this.items[s].setData(this)}get isAllowTitleLeft(){return!1}get isContainer(){return!0}onSurveyLoad(){this.editorsOnSurveyLoad(),super.onSurveyLoad(),O.isValueEmpty(this.rows)||this.calcVisibleRows()}setQuestionValue(e,t=!0){super.setQuestionValue(e,t),this.performForEveryEditor(s=>{s.editor.updateValueFromSurvey(s.value)}),this.updateIsAnswered()}onSurveyValueChanged(e){super.onSurveyValueChanged(e),this.performForEveryEditor(t=>{t.editor.onSurveyValueChanged(t.value)})}resetItemsSize(){this.performForEveryEditor(e=>{e.editor.resetInputSize()})}editorsOnSurveyLoad(){this.performForEveryEditor(e=>{e.editor.onSurveyLoad()})}performForEveryEditor(e){for(var t=0;t<this.items.length;t++){var s=this.items[t];s.editor&&e(s)}}get items(){return this.getPropertyValue("items")}set items(e){this.setPropertyValue("items",e)}addItem(e,t=null){var s=this.createTextItem(e,t);return this.items.push(s),s}getItemByName(e){for(var t=0;t<this.items.length;t++)if(this.items[t].name==e)return this.items[t];return null}getElementsInDesign(e=!1){let t;return t=super.getElementsInDesign(e),t.concat(this.items)}addConditionObjectsByContext(e,t){for(var s=0;s<this.items.length;s++){var i=this.items[s];e.push({name:this.getValueName()+"."+i.name,text:this.processedTitle+"."+i.fullTitle,question:this})}}collectNestedQuestionsCore(e,t,s,i){i&&e.push(this),this.items.forEach(r=>r.editor.addNestedQuestion(e,t,s,i))}getConditionJson(e=null,t=null){if(!t)return super.getConditionJson(e);var s=this.getItemByName(t);if(!s)return null;var i=new qt().toJsonObject(s);return i.type="text",i}locStrsChanged(){super.locStrsChanged();for(var e=0;e<this.items.length;e++)this.items[e].locStrsChanged()}localeChanged(){super.localeChanged();for(var e=0;e<this.items.length;e++)this.items[e].localeChanged()}get itemErrorLocation(){return this.getPropertyValue("itemErrorLocation")}set itemErrorLocation(e){this.setPropertyValue("itemErrorLocation",e)}getQuestionErrorLocation(){return this.itemErrorLocation!=="default"?this.itemErrorLocation:this.getErrorLocation()}get showItemErrorOnTop(){return this.getQuestionErrorLocation()=="top"}get showItemErrorOnBottom(){return this.getQuestionErrorLocation()=="bottom"}getChildErrorLocation(e){return this.getQuestionErrorLocation()}isNewValueCorrect(e){return O.isValueObject(e,!0)}supportAutoAdvance(){for(var e=0;e<this.items.length;e++)if(this.items[e].isEmpty())return!1;return!0}get colCount(){return this.getPropertyValue("colCount")}set colCount(e){e<1||e>5||this.setPropertyValue("colCount",e)}get inputSize(){return this.getPropertyValue("inputSize")}set inputSize(e){this.setPropertyValue("inputSize",e)}get itemSize(){return this.inputSize}set itemSize(e){this.inputSize=e}get itemTitleWidth(){return this.getPropertyValue("itemTitleWidth")||""}set itemTitleWidth(e){this.setPropertyValue("itemTitleWidth",e)}onRowCreated(e){return e}calcVisibleRows(){const e=this.colCount,t=this.items;let s=0,i,r,a=[];for(var o=0;o<t.length;o++)s==0&&(i=this.onRowCreated(new fo),r=this.onRowCreated(new uS),this.showItemErrorOnTop?(a.push(r),a.push(i)):(a.push(i),a.push(r))),i.cells.push(new ev(t[o],this)),r.cells.push(new hS(t[o],this)),s++,(s>=e||o==t.length-1)&&(s=0,r.onAfterCreated());this.rows=a}getRows(){return O.isValueEmpty(this.rows)&&this.calcVisibleRows(),this.rows}onValueChanged(){super.onValueChanged(),this.onItemValueChanged()}createTextItem(e,t){return new Xy(e,t)}onItemValueChanged(){if(!this.isMultipleItemValueChanging)for(var e=0;e<this.items.length;e++){var t=null;this.value&&this.items[e].name in this.value&&(t=this.value[this.items[e].name]),this.items[e].onValueChanged(t)}}runConditionCore(e){super.runConditionCore(e),this.items.forEach(t=>t.editor.runCondition(e))}getIsRunningValidators(){if(super.getIsRunningValidators())return!0;for(var e=0;e<this.items.length;e++)if(this.items[e].editor.isRunningValidators)return!0;return!1}validateElementCore(e){let t=!0;for(var s=0;s<this.items.length;s++)e.isOnValueChanged&&this.items[s].editor.isEmpty()||(t=this.items[s].editor.validateElement(e)&&t);return super.validateElementCore(e)&&t}getAllErrors(){for(var e=super.getAllErrors(),t=0;t<this.items.length;t++){var s=this.items[t].editor.getAllErrors();s&&s.length>0&&(e=e.concat(s))}return e}clearErrors(){super.clearErrors();for(var e=0;e<this.items.length;e++)this.items[e].editor.clearErrors()}getContainsErrors(){var e=super.getContainsErrors();if(e)return e;for(var t=this.items,s=0;s<t.length;s++)if(t[s].editor.containsErrors)return!0;return!1}getIsAnswered(){if(!super.getIsAnswered())return!1;for(var e=0;e<this.items.length;e++){var t=this.items[e].editor;if(t.isVisible&&!t.isAnswered)return!1}return!0}getProgressInfo(){for(var e=[],t=0;t<this.items.length;t++)e.push(this.items[t].editor);return yt.getProgressInfoByElements(e,this.isRequired)}getValueGetterContext(){return new oS(this)}getDisplayValueCore(e,t){if(!t)return t;for(var s={},i=0;i<this.items.length;i++){var r=this.items[i],a=t[r.name];if(!O.isValueEmpty(a)){var o=r.name;e&&r.title&&(o=r.title),s[o]=r.editor.getDisplayValue(e,a)}}return s}allowMobileInDesignMode(){return!0}getMultipleTextValue(e){return this.value?this.value[e]:null}setMultipleTextValue(e,t){this.isMultipleItemValueChanging=!0,this.isValueEmpty(t)&&(t=void 0);var s=this.value;s||(s={}),s[e]=t,this.setNewValue(s),this.isMultipleItemValueChanging=!1}getItemDefaultValue(e){return this.defaultValue?this.defaultValue[e]:null}getTextProcessor(){return this.textProcessor}getAllValues(){return this.data?this.data.getAllValues():null}addElement(e,t){}removeElement(e){return!1}getQuestionTitleLocation(){return"left"}getQuestionTitleWidth(){}getColumsForElement(e){return[]}updateColumns(){}getQuestionStartIndex(){return this.getStartIndex()}getChildrenLayoutType(){return"row"}elementWidthChanged(e){}get elements(){return[]}indexOf(e){return-1}ensureRowsVisibility(){}validateContainerOnly(){}onQuestionValueChanged(e){}getItemLabelCss(e){return new z().append(this.cssClasses.itemLabel).append(this.cssClasses.itemLabelDisabled,this.isDisabledStyle).append(this.cssClasses.itemLabelReadOnly,this.isReadOnlyStyle).append(this.cssClasses.itemLabelPreview,this.isPreviewStyle).append(this.cssClasses.itemLabelAnswered,e.editor.isAnswered).append(this.cssClasses.itemLabelAllowFocus,!this.isDesignMode).append(this.cssClasses.itemLabelOnError,e.editor.errors.length>0).append(this.cssClasses.itemWithCharacterCounter,!!e.getMaxLength()).toString()}getItemCss(){return new z().append(this.cssClasses.item).toString()}getItemTitleCss(){return new z().append(this.cssClasses.itemTitle).toString()}get ariaRole(){return"group"}get ariaRequired(){return null}get ariaInvalid(){return null}};S([Nt()],mo.prototype,"rows",void 0);let fo=class extends Te{constructor(){super(...arguments),this.isVisible=!0,this.cells=[]}};S([E()],fo.prototype,"isVisible",void 0),S([Nt()],fo.prototype,"cells",void 0);let uS=class extends fo{onAfterCreated(){const e=()=>{this.isVisible=this.cells.some(t=>{var s,i;return((s=t.item)===null||s===void 0?void 0:s.editor)&&((i=t.item)===null||i===void 0?void 0:i.editor.hasVisibleErrors)})};this.cells.forEach(t=>{var s,i;!((s=t.item)===null||s===void 0)&&s.editor&&((i=t.item)===null||i===void 0||i.editor.registerFunctionOnPropertyValueChanged("hasVisibleErrors",e))}),e()}},ev=class{constructor(e,t){this.item=e,this.question=t,this.isErrorsCell=!1}getClassName(){return new z().append(this.question.cssClasses.cell).toString()}get className(){return this.getClassName()}},hS=class extends ev{constructor(){super(...arguments),this.isErrorsCell=!0}getClassName(){return new z().append(super.getClassName()).append(this.question.cssClasses.cellError).append(this.question.cssClasses.cellErrorTop,this.question.showItemErrorOnTop).append(this.question.cssClasses.cellErrorBottom,this.question.showItemErrorOnBottom).toString()}};q.addClass("multipletextitem",[{name:"!name",isUnique:!0},"isRequired:boolean",{name:"placeholder",alternativeName:"placeHolder",serializationProperty:"locPlaceholder"},{name:"inputType",default:"text",choices:A.questions.inputTypes},{name:"maskType",default:"none",visibleIndex:0,dependsOn:"inputType",visibleIf:n=>n.inputType==="text",choices:n=>Jy()},{name:"maskSettings:masksettings",className:"masksettings",visibleIndex:1,dependsOn:"inputType",visibleIf:n=>n.inputType==="text",onGetValue:function(n){return n.maskSettings.getData()},onSetValue:function(n,e){n.maskSettings.setData(e)}},{name:"inputTextAlignment",default:"auto",choices:["left","right","auto"]},{name:"title",serializationProperty:"locTitle"},{name:"maxLength:number",default:-1},{name:"inputSize:number",alternativeName:"size",minValue:0},{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText"},{name:"defaultValueExpression:expression",visible:!1},{name:"minValueExpression:expression",category:"logic",dependsOn:"inputType",visibleIf:function(n){return zs(n)}},{name:"maxValueExpression:expression",category:"logic",dependsOn:"inputType",visibleIf:function(n){return zs(n)}},{name:"validators:validators",baseClassName:"surveyvalidator",classNamePart:"validator"}],function(){return new Xy("")}),q.addClass("multipletext",[{name:"!items:textitems",className:"multipletextitem",isArray:!0},{name:"inputSize:number",minValue:0,visible:!1,alternativeName:"itemSize"},{name:"colCount:number",default:1,choices:[1,2,3,4,5]},{name:"itemErrorLocation",default:"default",choices:["default","top","bottom"],visible:!1},{name:"itemTitleWidth",category:"layout"}],function(){return new mo("")},"question"),qe.Instance.registerQuestion("multipletext",n=>{var e=new mo(n);return mo.addDefaultItems(e),e});let tv=class Cf extends ho{constructor(e=""){super(e),this.createLocString({name:"content",supportsMarkdown:!0}),this.registerPropertyChangedHandlers(["content"],()=>{this.onContentChanged()})}getType(){return"flowpanel"}getChildrenLayoutType(){return"flow"}onSurveyLoad(){super.onSurveyLoad(),this.onContentChanged()}get content(){return this.getLocalizableStringText("content")}set content(e){this.setLocalizableStringText("content",e)}get locContent(){return this.getLocalizableString("content")}get html(){return this.getPropertyValue("html","")}set html(e){this.setPropertyValue("html",e)}onContentChanged(){var e="";this.onCustomHtmlProducing?e=this.onCustomHtmlProducing():e=this.produceHtml(),this.html=e,this.contentChangedCallback&&this.contentChangedCallback()}produceHtml(){for(var e=[],t=/{(.*?(element:)[^$].*?)}/g,s=this.content,i=0,r=null;(r=t.exec(s))!==null;){r.index>i&&(e.push(s.substring(i,r.index)),i=r.index);var a=this.getQuestionFromText(r[0]);a?e.push(this.getHtmlForQuestion(a)):e.push(s.substring(i,r.index+r[0].length)),i=r.index+r[0].length}return i<s.length&&e.push(s.substring(i,s.length)),e.join("").replace(new RegExp("<br>","g"),"<br/>")}getQuestionFromText(e){return e=e.substring(1,e.length-1),e=e.replace(Cf.contentElementNamePrefix,"").trim(),this.getQuestionByName(e)}getHtmlForQuestion(e){return this.onGetHtmlForQuestion?this.onGetHtmlForQuestion(e):""}getQuestionHtmlId(e){return this.name+"_"+e.id}onAddElement(e,t){super.onAddElement(e,t),this.addElementToContent(e),e.renderWidth=""}onRemoveElement(e){var t=this.getElementContentText(e);this.content=this.content.replace(t,""),super.onRemoveElement(e)}dragDropMoveElement(e,t,s){}addElementToContent(e){if(!this.isLoadingFromJson){var t=this.getElementContentText(e);this.insertTextAtCursor(t)||(this.content=this.content+t)}}insertTextAtCursor(e,t=null){if(!this.isDesignMode||!we.isAvailable())return!1;let s=we.getSelection();if(s.getRangeAt&&s.rangeCount){let a=s.getRangeAt(0);a.deleteContents();const o=new Text(e);a.insertNode(o);var i=this;if(i.getContent){var r=i.getContent(t);this.content=r}return!0}return!1}getElementContentText(e){return"{"+Cf.contentElementNamePrefix+e.name+"}"}};tv.contentElementNamePrefix="element:",q.addClass("flowpanel",[{name:"content:html",serializationProperty:"locContent"}],function(){return new tv},"panel");let ah=class extends Dt{constructor(e){super(e)}getType(){return"nonvalue"}get hasInput(){return!1}get hasTitle(){return!1}getTitleLocation(){return""}get hasComment(){return!1}validateElementCore(e){return!0}getAllErrors(){return[]}supportAutoAdvance(){return!1}addConditionObjectsByContext(e,t){}getConditionJson(e=null,t=null){return null}get ariaRole(){return null}get ariaRequired(){return null}};q.addClass("nonvalue",[{name:"title",visible:!1},{name:"description",visible:!1},{name:"valueName",visible:!1},{name:"enableIf",visible:!1},{name:"defaultValue",visible:!1},{name:"correctAnswer",visible:!1},{name:"clearIfInvisible",visible:!1},{name:"isRequired",visible:!1,isSerializable:!1},{name:"requiredErrorText",visible:!1},{name:"readOnly",visible:!1},{name:"requiredIf",visible:!1},{name:"validators",visible:!1},{name:"titleLocation",visible:!1},{name:"showTitle",visible:!1,isSerializable:!1},{name:"showCommentArea",visible:!1},{name:"useDisplayValuesInDynamicTexts",alternativeName:"useDisplayValuesInTitle",visible:!1}],function(){return new ah("")},"question");let dS=class extends Dt{constructor(e){super(e)}getType(){return"empty"}};q.addClass("empty",[],function(){return new dS("")},"question");let cS=class extends co{get isExclusive(){return this.getPropertyValue("isExclusive")}set isExclusive(e){this.setPropertyValue("isExclusive",e)}getBaseType(){return"checkboxitem"}onPropertyValueChanged(e,t,s){super.onPropertyValueChanged(e,t,s),e==="showCommentArea"&&this.locOwner&&this.locOwner.onItemHasCommentChanged()}},yo=class extends po{constructor(e){super(e),this.invisibleOldValues={},this.isChangingValueOnClearIncorrect=!1,this.selectAllItemValue=this.createSelectAllItem(),this.registerPropertyChangedHandlers(["showSelectAllItem","selectAllText"],()=>{this.onVisibleChoicesChanged()}),this.registerPropertyChangedHandlers(["choices"],()=>{this.onItemHasCommentChanged()})}supportElementsInChoice(){return!0}getDefaultItemComponent(){return"survey-checkbox-item"}getType(){return"checkbox"}getItemValueType(){return"checkboxitem"}createSelectAllItem(){const e=this.createItemValue("");return e.value="",e.id="selectall",this.selectAllItemText=this.createLocalizableString("selectAllText",e,!0,"selectAllItemText"),e.locOwner=this,e.setLocText(this.selectAllItemText),e}onCreating(){super.onCreating(),this.createNewArray("renderedValue"),this.createNewArray("value")}getFirstInputElementId(){return this.inputId+"_0"}get valuePropertyName(){return this.getPropertyValue("valuePropertyName")}set valuePropertyName(e){this.setPropertyValue("valuePropertyName",e)}getValuePropertyName(){return this.valuePropertyName||(this.isTheOnlyComment?"":"value")}getQuestionFromArray(e,t){if(e&&e===this.getValuePropertyName()){const s=this.value;if(Array.isArray(s)&&t<s.length)return this}return null}getDependedQuestionsByValueName(e){return e&&this.getValuePropertyName()?[]:super.getDependedQuestionsByValueName(e)}get selectAllItem(){return this.selectAllItemValue}get selectAllText(){return this.getLocalizableStringText("selectAllText")}set selectAllText(e){this.setLocalizableStringText("selectAllText",e)}get locSelectAllText(){return this.getLocalizableString("selectAllText")}get showSelectAllItem(){return this.getPropertyValue("showSelectAllItem")}set showSelectAllItem(e){this.setPropertyValue("showSelectAllItem",e)}get hasSelectAll(){return this.showSelectAllItem}set hasSelectAll(e){this.showSelectAllItem=e}get isAllSelected(){return this.allElementsSelected()}set isAllSelected(e){e?this.selectAll():this.clearValueFromUI()}toggleSelectAll(){this.isAllSelected=!this.isAllSelected}allElementsSelected(){if(this.isNoneItemsSelected())return!1;const e=this.getVisibleEnableItems();if(e.length===0)return!1;const t=this.value;if(!t||!Array.isArray(t)||t.length===0||t.length<e.length)return!1;const s=[];for(let i=0;i<t.length;i++)s.push(this.getRealValue(t[i]));for(let i=0;i<e.length;i++)if(s.indexOf(e[i].value)<0)return!1;return!0}isNoneItemsSelected(){const e=this.getNoneItems();for(let t=0;t<e.length;t++)if(this.isItemSelected(e[t]))return!0;return!1}getNoneItems(){const e=new Array;return this.visibleChoices.forEach(t=>{this.isNoneItem(t)&&e.push(t)}),e}selectAll(){const e=[],t=this.getVisibleEnableItems();for(let s=0;s<t.length;s++)e.push(t[s].value);this.renderedValue=e}clickItemHandler(e,t){this.selectItem(e,t)}selectItem(e,t){if(!(this.isReadOnlyAttr||!e))if(e===this.selectAllItem)t===!0||t===!1?this.isAllSelected=t:this.toggleSelectAll();else{if(this.isNoneItem(e))this.renderedValue=t?[e.value]:[];else{const s=[].concat(this.renderedValue||[]),i=s.indexOf(e.value);t?i<0&&s.push(e.value):i>-1&&s.splice(i,1),this.renderedValue=s}t&&this.onItemSelected(e)}}isItemSelectedCore(e){if(e===this.selectAllItem)return this.isAllSelected;var t=this.renderedValue;if(!t||!Array.isArray(t))return!1;for(var s=0;s<t.length;s++)if(this.isTwoValueEquals(t[s],e.value))return!0;return!1}hasUnknownValueItem(e,t=!1,s=!0,i=!1){return super.hasUnknownValueItem(this.getRealValue(e),t,s,i)}setCommentValueCore(e,t){if(t=this.trimCommentValue(t),this.isOtherItemByValue(e))super.setCommentValueCore(e,t);else{this.setCommentPropertyValue(e,t);const s=this.getItemValIndexByItemValue(e.value);if(s>-1){const i=this.createValueCopy(),r=i[s];t?r[this.commentPropertyValue]=t:delete r[this.commentPropertyValue],this.value=i}}}getCommentValueByItem(e){const t=this.getItemValIndexByItemValue(e.value);return t>-1?this.value[t][this.commentPropertyValue]:void 0}getItemValIndexByItemValue(e){const t=this.value;if(!Array.isArray(t))return-1;for(let s=0;s<t.length;s++){const i=this.getRealValue(t[s]);if(O.isTwoValueEquals(i,e))return s}return-1}get isTheOnlyComment(){return this.getPropertyValue("isTheOnlyComment",void 0,()=>this.calcIsTheOnlyComment())}calcIsTheOnlyComment(){for(let e=0;e<this.choices.length;e++){const t=this.choices[e];if(t.showCommentArea&&t.value!==this.otherItem.value)return!1}return!0}onItemHasCommentChanged(){this.resetPropertyValue("isTheOnlyComment")}getRealValue(e){if(!e||typeof e!="object")return e;const t=this.getValuePropertyName();return t?e[t]:e}getValueFromReal(e){const t=this.getValuePropertyName();if(t){const s={};return s[t]=e,s}return e}get isValueArray(){return!0}get maxSelectedChoices(){return this.getPropertyValue("maxSelectedChoices")}set maxSelectedChoices(e){e<0&&(e=0),this.setPropertyValue("maxSelectedChoices",e),this.filterItems()}get minSelectedChoices(){return this.getPropertyValue("minSelectedChoices")}set minSelectedChoices(e){e<0&&(e=0),this.setPropertyValue("minSelectedChoices",e)}get selectedChoices(){const e=this.renderedValue,t=this.visibleChoices,s=this.selectedItemValues;if(this.isEmpty())return[];const i=this.defaultSelectedItemValues?[].concat(this.defaultSelectedItemValues,t):t,r=e.map(o=>Ce.getItemByValue(i,o)).filter(o=>!!o);return!r.length&&!s&&this.updateSelectedItemValues(),this.validateItemValues(r)}get selectedItems(){return this.selectedChoices}get hasFilteredValue(){return!!this.getValuePropertyName()}getFilteredName(){let e=super.getFilteredName();return this.hasFilteredValue&&(e+=A.expressionVariables.unwrapPostfix),e}getFilteredValue(e){return e&&this.hasFilteredValue?this.renderedValue:super.getFilteredValue(e)}getMultipleSelectedItems(){return this.selectedChoices}validateItemValues(e){if(e.length)return e;const t=this.selectedItemValues;return t&&t.length?(this.defaultSelectedItemValues=[].concat(t),t):this.renderedValue.map(i=>this.createItemValue(i))}getAnswerCorrectIgnoreOrder(){return!0}onCheckForErrors(e,t,s){if(super.onCheckForErrors(e,t,s),!t&&this.checkMinSelectedChoicesUnreached()){const i=new vs(this.getLocalizationFormatString("minSelectError",this.minSelectedChoices),this);e.push(i)}}onVisibleChoicesChanged(){super.onVisibleChoicesChanged(),this.updateSelectAllItemProps()}onEnableItemCallBack(e){return this.shouldCheckMaxSelectedChoices()?this.isItemSelected(e):!0}onAfterRunItemsEnableCondition(){this.updateSelectAllItemProps();const e=this.maxSelectedChoices<1||this.isOtherSelected||!this.shouldCheckMaxSelectedChoices();this.otherItem.setIsEnabled(e)}updateSelectAllItemProps(){this.showSelectAllItem&&this.selectAllItem.setIsEnabled(this.getSelectAllEnabled())}getSelectAllEnabled(){if(!this.showSelectAllItem)return!0;let e=this.getVisibleEnableItems().length;const t=this.maxSelectedChoices;return t>0&&t<e?!1:e>0}getVisibleEnableItems(){const e=new Array,t=this.visibleChoices;for(let s=0;s<t.length;s++){const i=t[s];i.isEnabled&&!this.isBuiltInChoice(i)&&!i.isExclusive&&e.push(i)}return e}shouldCheckMaxSelectedChoices(){if(this.maxSelectedChoices<1)return!1;var e=this.value,t=Array.isArray(e)?e.length:0;return t>=this.maxSelectedChoices}checkMinSelectedChoicesUnreached(){if(this.minSelectedChoices<1)return!1;var e=this.value,t=Array.isArray(e)?e.length:0;return t===1&&this.isNoneItemsSelected()?!1:t<this.minSelectedChoices}getItemClassCore(e,t){return this.value,t.isSelectAllItem=e===this.selectAllItem,new z().append(super.getItemClassCore(e,t)).append(this.cssClasses.itemSelectAll,t.isSelectAllItem).toString()}updateValueFromSurvey(e,t){super.updateValueFromSurvey(e,t),this.invisibleOldValues={}}onSurveyLoad(){this.onItemHasCommentChanged(),super.onSurveyLoad()}setDefaultUnknownValue(e){if(!Array.isArray(e)){super.setDefaultUnknownValue(e);return}if(this.hasActiveChoices){const s=[];let i="";for(var t=0;t<e.length;t++){const a=this.getRealValue(e[t]);this.hasUnknownValue(a)?i||(i=a,s.push(this.otherItem.value)):s.push(a)}this.renderedValue=s,this.otherValue=i}else{for(var t=0;t<e.length;t++){const s=this.getRealValue(e[t]);this.addIntoInvisibleOldValues(s)}this.value=e}}addIntoInvisibleOldValues(e){this.invisibleOldValues[e]=e}hasValueToClearIncorrectValues(){return super.hasValueToClearIncorrectValues()||!O.isValueEmpty(this.invisibleOldValues)}setNewValue(e){this.isChangingValueOnClearIncorrect||(this.invisibleOldValues={}),e=this.valueFromData(e);var t=this.value;e||(e=[]),t||(t=[]),!this.isTwoValueEquals(t,e)&&(this.removeNoneItemsValues(t,e),super.setNewValue(e))}getCommentFromValue(e){var t=this.getFirstUnknownIndex(e);return t<0?"":e[t]}getStoreOthersAsComment(){return this.getValuePropertyName()?!1:super.getStoreOthersAsComment()}setOtherValueIntoValue(e){var t=this.getFirstUnknownIndex(e);if(t<0)return e;let s=this.otherItem.value;const i=this.getValuePropertyName();if(i){const r={};r[i]=s,s=r}return e.splice(t,1,s),e}getFirstUnknownIndex(e){if(!Array.isArray(e))return-1;for(var t=0;t<e.length;t++)if(this.hasUnknownValueItem(e[t],!1,!1))return t;return-1}removeNoneItemsValues(e,t){if(e.length===1&&t.length===1&&this.getRealValue(e[0])===this.getRealValue(t[0]))return;const s=this.getNoneItems().map(i=>i.value);if(s.length>0){const i=this.noneIndexInArray(e,s),r=this.noneIndexInArray(t,s);if(i.index>-1)if(i.val===r.val)t.length>0&&t.splice(r.index,1);else{const a=this.noneIndexInArray(t,[i.val]);a.index>-1&&a.index<t.length-1&&t.splice(a.index,1)}else r.index>-1&&t.length>1&&t.splice(0,t.length,this.getValueFromReal(r.val))}}noneIndexInArray(e,t){if(!Array.isArray(e))return{index:-1,val:void 0};for(var s=e.length-1;s>=0;s--){const i=t.indexOf(this.getRealValue(e[s]));if(i>-1)return{index:s,val:t[i]}}return{index:-1,val:void 0}}supportSelectAll(){return this.isSupportProperty("showSelectAllItem")}addNonChoicesItems(e,t){super.addNonChoicesItems(e,t),this.supportSelectAll()&&this.addNonChoiceItem(e,this.selectAllItem,t,this.showSelectAllItem,A.specialChoicesOrder.selectAllItem)}isBuiltInChoice(e){return e===this.selectAllItem||super.isBuiltInChoice(e)}isItemInList(e){return e==this.selectAllItem?this.showSelectAllItem:super.isItemInList(e)}getDisplayValueEmpty(){return Ce.getTextOrHtmlByValue(this.visibleChoices.filter(e=>e!=this.selectAllItemValue),void 0)}getDisplayValueCore(e,t){if(!Array.isArray(t))return super.getDisplayValueCore(e,t);const s=this.getValuePropertyName(),i=r=>{let a=t[r];return s&&a[s]&&(a=a[s]),a};return this.getDisplayArrayValue(e,t,i)}clearIncorrectValuesCore(){this.clearIncorrectAndDisabledValues(!1)}clearDisabledValuesCore(){this.clearIncorrectAndDisabledValues(!0)}clearIncorrectAndDisabledValues(e){var t=this.value,s=!1,i=this.restoreValuesFromInvisible();if(!(!t&&i.length==0)){if(!Array.isArray(t)||t.length==0){if(this.isChangingValueOnClearIncorrect=!0,e||(this.showCommentArea?this.value=null:this.clearValue(!0)),this.isChangingValueOnClearIncorrect=!1,i.length==0)return;t=[]}for(var r=[],a=0;a<t.length;a++){const l=this.getRealValue(t[a]);var o=this.canClearValueAnUnknown(l);!e&&!o||e&&!this.isValueDisabled(l)?r.push(t[a]):(s=!0,o&&this.addIntoInvisibleOldValues(t[a]))}for(var a=0;a<i.length;a++)r.push(i[a]),s=!0;s&&(this.isChangingValueOnClearIncorrect=!0,r.length==0?this.clearValue(!0):this.value=r,this.isChangingValueOnClearIncorrect=!1)}}restoreValuesFromInvisible(){for(var e=[],t=this.visibleChoices,s=0;s<t.length;s++){const r=t[s];if(r!==this.selectAllItem){var i=t[s].value;O.isTwoValueEquals(i,this.invisibleOldValues[i])&&(this.isItemSelected(r)||e.push(i),delete this.invisibleOldValues[i])}}return e}getConditionJson(e=null,t=null){const s=super.getConditionJson(e,t);return(e=="contains"||e=="notcontains")&&(s.type="radiogroup"),s.maxSelectedChoices=0,s.minSelectedChoices=0,s}isAnswerCorrect(){return O.isArrayContainsEqual(this.value,this.correctAnswer)}setDefaultValueWithOthers(){this.value=this.renderedValueFromDataCore(this.defaultValue)}getIsItemValue(e,t){return!e||!Array.isArray(e)?!1:e.indexOf(t.value)>=0}valueFromData(e){if(!e)return e;if(!Array.isArray(e))return[super.valueFromData(e)];let t=[];for(let s=0;s<e.length;s++){const i=this.getItemByValue(e[s],this.visibleChoices);i?t.push(this.getChoiceValue(i,e[s],!0)):t.push(e[s])}return t}rendredValueFromData(e){return e=this.convertValueFromObject(e),super.rendredValueFromData(e)}convertValueFromObject(e){if(!this.getValuePropertyName()||!Array.isArray(e))return e;const s=[];for(let i=0;i<e.length;i++)s.push(this.getRealValue(e[i]));return s}renderedValueFromDataCore(e){if((!e||!Array.isArray(e))&&(e=[]),!this.hasActiveChoices)return e;for(var t=0;t<e.length;t++){if(e[t]==this.otherItem.value)return e;if(this.hasUnknownValueItem(e[t],!0,!1)){this.otherValue=e[t];var s=e.slice();return s[t]=this.otherItem.value,s}}return e}renderedValueToDataCore(e){if(!e||!e.length)return e;const t=[],s=this.createValueCopy();for(var i=0;i<e.length;i++){let r=-1,a=e[i];a===this.otherItem.value&&this.needConvertRenderedOtherToDataValue()?(r=this.getFirstUnknownIndex(s),a=this.otherValue,r>-1&&(s[r]=this.getValueFromReal(this.otherValue))):r=this.getItemValIndexByItemValue(a),r>-1?t.push(s[r]):t.push(this.getValueFromReal(a))}return t}valueToData(e){if(O.isValueEmpty(e)||(Array.isArray(e)||(e=[e]),!this.getValuePropertyName()))return e;const s=[];for(let i=0;i<e.length;i++){const r=e[i];s.push(typeof r=="object"?r:this.getValueFromReal(r))}return s}selectOtherValueFromComment(e){var t=[];const s=this.renderedValue;if(Array.isArray(s))for(var i=0;i<s.length;i++)s[i]!==this.otherItem.value&&t.push(s[i]);e&&t.push(this.otherItem.value),this.value=t}get checkBoxSvgPath(){return"M5,13l2-2l3,3l7-7l2,2l-9,9L5,13z"}get isNewA11yStructure(){return!0}get a11y_input_ariaRole(){return"group"}get a11y_input_ariaRequired(){return null}};q.addClass("checkboxitem",[{name:"isExclusive:boolean",locationInTable:"detail"}],n=>new cS(n),"choiceitem"),q.addClass("checkbox",[{name:"showSelectAllItem:boolean",alternativeName:"hasSelectAll"},{name:"separateSpecialChoices",visible:!0},{name:"maxSelectedChoices:number",default:0,onSettingValue:(n,e)=>{if(e<=0)return 0;const t=n.minSelectedChoices;return t>0&&e<t?t:e}},{name:"minSelectedChoices:number",default:0,onSettingValue:(n,e)=>{if(e<=0)return 0;const t=n.maxSelectedChoices;return t>0&&e>t?t:e}},{name:"selectAllText",serializationProperty:"locSelectAllText",dependsOn:"showSelectAllItem",visibleIf:function(n){return n.showSelectAllItem}},{name:"valuePropertyName",category:"data"},{name:"itemComponent",visible:!1,default:"survey-checkbox-item"}],function(){return new yo("")},"checkboxbase"),q.getProperty("checkbox","choices").type="checkboxitem[]",qe.Instance.registerQuestion("checkbox",n=>{var e=new yo(n);return e.choices=qe.DefaultChoices,e});let sv=class extends dt{updateItemState(){this.actions.forEach(e=>{const t=this.isItemSelected(e);e.visible=this.hideSelectedItems?!t:!0})}constructor(e){super(e),this.onItemClick=t=>{this.isItemDisabled(t)||(this.isExpanded=!1,this.isItemSelected(t)?(this.selectedItems.splice(this.selectedItems.indexOf(t),1)[0],this.onSelectionChanged&&this.onSelectionChanged(t,"removed")):(this.selectedItems.push(t),this.onSelectionChanged&&this.onSelectionChanged(t,"added")))},this.isItemDisabled=t=>t.enabled!==void 0&&!t.enabled,this.isItemSelected=t=>!!this.allowSelection&&this.selectedItems.filter(s=>this.areSameItems(s,t)).length>0,this.setSelectedItems(e.selectedItems||[])}updateState(){this.updateItemState(),this.raiseUpdate({needUpdateIsEmpty:!0})}setSelectedItems(e){this.selectedItems=e,this.updateState()}selectFocusedItem(){super.selectFocusedItem(),this.hideSelectedItems&&this.focusNextVisibleItem()}};S([E()],sv.prototype,"hideSelectedItems",void 0);let ln=class extends Ut{get needRenderInput(){return!this.question.isInputReadOnly||!!this.filterStringPlaceholder}locStrsChanged(){super.locStrsChanged(),this.syncFilterStringPlaceholder()}updateListState(){this.listModel.updateState(),this.updateCustomItemValue(),this.syncFilterStringPlaceholder()}syncFilterStringPlaceholder(){this.getSelectedActions().length||this.question.selectedItems.length||this.listModel.focusedItem?this.filterStringPlaceholder=void 0:this.filterStringPlaceholder=this.question.placeholder}getSelectedActions(){return this.listModel.actions.filter(e=>e.selected)}getFocusFirstInputSelector(){return this.listModel.hideSelectedItems&&ft&&!this.isValueEmpty(this.question.value)?this.itemSelector:super.getFocusFirstInputSelector()}getPopupCssClasses(){return"sv-multi-select-list"}createListModel(){const e=this.getAvailableItems();let t=this.onSelectionChanged;t||(t=(r,a)=>{this.resetFilterString(),r.id==="selectall"?this.selectAllItems():a==="added"&&r.value===A.noneItemValue?this.selectNoneItem():a==="added"?this.selectItem(r.value):a==="removed"&&this.deselectItem(r.value),this.popupRecalculatePosition(!1),this.closeOnSelect&&(this.popupModel.isVisible=!1)});const s={items:e,onSelectionChanged:t,allowSelection:!1,locOwner:this.question,elementId:this.listElementId},i=new sv(s);return this.setOnTextSearchCallbackForListModel(i),i.forceShowFilter=this.question.choicesLazyLoadEnabled,i}get shouldResetAfterCancel(){return ft&&!this.closeOnSelect}createPopup(){super.createPopup(),this.popupModel.onFooterActionsCreated.add((e,t)=>{t.actions.push({id:"sv-dropdown-done-button",title:this.doneButtonCaption,innerCss:"sv-popup__button--done",needSpace:!0,action:()=>{this.popupModel.isVisible=!1},enabled:new We(()=>!this.isTwoValueEquals(this.question.renderedValue,this.previousValue))})}),this.popupModel.onVisibilityChanged.add((e,t)=>{this.shouldResetAfterCancel&&t.isVisible&&(this.previousValue=[].concat(this.question.renderedValue||[]))}),this.popupModel.onCancel=()=>{this.shouldResetAfterCancel&&(this.question.renderedValue=this.previousValue,this.updateListState())}}selectAllItems(){this.question.toggleSelectAll(),this.question.isAllSelected&&this.question.hideSelectedItems&&this.popupModel.hide(),this.updateListState()}selectNoneItem(){this.question.renderedValue=[A.noneItemValue],this.updateListState()}selectItem(e){let t;if(this.allowCustomChoices&&e===this.customItemValue.id){const s=this.createCustomItem();s&&(t=s.id)}else t=e;if(t!=null){let s=[].concat(this.question.renderedValue||[]);s.push(t),this.question.renderedValue=s,this.updateListState()}}deselectItem(e){let t=[].concat(this.question.renderedValue||[]);t.splice(t.indexOf(e),1),this.question.renderedValue=t,this.applyHintString(),this.updateListState()}clear(){super.clear(),this.syncFilterStringPlaceholder()}onClear(e){super.onClear(e),this.updateListState()}setHideSelectedItems(e){this.listModel.hideSelectedItems=e,this.updateListState()}removeLastSelectedItem(){this.deselectItem(this.question.renderedValue[this.question.renderedValue.length-1]),this.popupRecalculatePosition(!1)}constructor(e,t){super(e,t),this.setHideSelectedItems(e.hideSelectedItems),this.syncFilterStringPlaceholder(),this.closeOnSelect=e.closeOnSelect}inputKeyHandler(e){e.keyCode===8&&!this.filterString&&(this.removeLastSelectedItem(),e.preventDefault(),e.stopPropagation())}setInputStringFromSelectedItem(e){this.question.searchEnabled&&(this.inputString=null)}focusItemOnClickAndPopup(){}onEscape(){}beforeScrollToFocusedItem(e){}afterScrollToFocusedItem(){var e;!((e=this.listModel.focusedItem)===null||e===void 0)&&e.selected?this.hintString="":this.applyHintString(),this.syncFilterStringPlaceholder()}onPropertyChangedHandler(e,t){super.onPropertyChangedHandler(e,t),(t.name==="value"||t.name==="renderedValue"||t.name==="placeholder")&&this.syncFilterStringPlaceholder()}};S([E({defaultValue:""})],ln.prototype,"filterStringPlaceholder",void 0),S([E({defaultValue:!0})],ln.prototype,"closeOnSelect",void 0),S([E()],ln.prototype,"previousValue",void 0),S([E({localizable:{defaultStr:"tagboxDoneButtonCaption"}})],ln.prototype,"doneButtonCaption",void 0);let Ls=class extends yo{constructor(e){super(e),this.itemDisplayNameMap={},this.onOpened=this.addEvent(),this.createLocString({name:"placeholder",hasTranslation:!0}),this.createLocalizableString("readOnlyText",this,!0),this.deselectAllItemText=this.createLocalizableString("deselectAllText",this.selectAllItem,!0,"deselectAllItemText"),this.registerPropertyChangedHandlers(["value","renderAs","showOtherItem","otherText","placeholder","choices","visibleChoices"],()=>{this.updateReadOnlyText()}),this.updateReadOnlyText()}supportElementsInChoice(){return!1}locStrsChanged(){var e;super.locStrsChanged(),this.updateReadOnlyText(),(e=this.dropdownListModelValue)===null||e===void 0||e.locStrsChanged()}updateReadOnlyText(){this.readOnlyText=this.displayValue||this.placeholder}onSelectedItemValuesUpdated(){super.onSelectedItemValuesUpdated(),this.updateReadOnlyText()}getDefaultItemComponent(){return""}get dropdownListModel(){return!this.isDisposed&&!this.dropdownListModelValue&&(this.dropdownListModelValue=new ln(this)),this.dropdownListModelValue}set dropdownListModel(e){this.dropdownListModelValue=e}get placeholder(){return this.getLocalizableStringText("placeholder")}set placeholder(e){this.setLocalizableStringText("placeholder",e),this.dropdownListModelValue&&this.dropdownListModel.setInputPlaceholder(e)}get locPlaceholder(){return this.getLocalizableString("placeholder")}get readOnlyText(){return this.getLocalizableStringText("readOnlyText")}set readOnlyText(e){this.setLocalizableStringText("readOnlyText",e)}get locReadOnlyText(){return this.getLocalizableString("readOnlyText")}getType(){return"tagbox"}supportMultipleComment(e){return e===this.otherItem}get a11yInputAriaRole(){return"combobox"}get popupModel(){return this.dropdownListModel.popupModel}getControlClass(){return new z().append(this.cssClasses.control).append(this.cssClasses.controlEmpty,this.isEmpty()).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlEditable,!this.isDisabledStyle&&!this.isReadOnlyStyle&&!this.isPreviewStyle).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle).toString()}updateCssClasses(e,t){super.updateCssClasses(e,t),Xa(e,t)}calcCssClasses(e){const t=super.calcCssClasses(e);return this.dropdownListModelValue&&this.dropdownListModel.updateCssClasses(t.popup,t.list),t}onOpenedCallBack(){this.onOpened.fire(this,{question:this,choices:this.choices})}hasUnknownValue(e,t=!1,s=!0,i=!1){return this.choicesLazyLoadEnabled?!1:super.hasUnknownValue(e,t,s,i)}needConvertRenderedOtherToDataValue(){var e;const t=(e=this.otherValue)===null||e===void 0?void 0:e.trim();return t?super.hasUnknownValue(t,!0,!1):!1}onVisibleChoicesChanged(){super.onVisibleChoicesChanged(),this.dropdownListModelValue&&this.dropdownListModel.updateItems()}getItemIfChoicesNotContainThisValue(e,t){return this.choicesLazyLoadEnabled?this.createItemValue(e,t):super.getItemIfChoicesNotContainThisValue(e,t)}validateItemValues(e){this.updateItemDisplayNameMap();const t=this.renderedValue;if(e.length&&e.length===t.length)return e;const s=this.selectedItemValues;if(!e.length&&s&&s.length)return this.defaultSelectedItemValues=[].concat(s),s;const i=e.map(r=>r.value);return t.filter(r=>i.indexOf(r)===-1).forEach(r=>{const a=this.getItemIfChoicesNotContainThisValue(r,this.itemDisplayNameMap[r]);a&&e.push(a)}),e.sort((r,a)=>t.indexOf(r.value)-t.indexOf(a.value)),e}updateItemDisplayNameMap(){const e=t=>{this.itemDisplayNameMap[t.value]=t.text};(this.defaultSelectedItemValues||[]).forEach(e),(this.selectedItemValues||[]).forEach(e),this.visibleChoices.forEach(e)}getIsQuestionReady(){return super.getIsQuestionReady()&&!this.isChoicesLoading}ensureQuestionIsReady(){super.ensureQuestionIsReady(),this.dropdownListModel&&this.choicesLazyLoadEnabled&&this.dropdownListModel.loadQuestionChoices()}onLoadChoicesFromUrl(e){this.updateCustomChoices(this.value,e),super.onLoadChoicesFromUrl(e)}valueFromData(e,t){const s=super.valueFromData(e);return this.survey&&this.survey.isSettingData()&&this.updateCustomChoices(s,this.visibleChoices),s}updateCustomChoices(e,t){if(e!=null&&e.length>0&&this.allowCustomChoices&&!this.choicesLazyLoadEnabled){this.customChoices.splice(0,this.customChoices.length);const s=[];e.forEach(i=>{t.filter(a=>O.isTwoValueEquals(a.id,i,!1,!1))[0]||s.push(new Ce(i))}),s.length>0&&this.customChoices.splice(0,this.customChoices.length,...s)}}setIsChoicesLoading(e){this.isChoicesLoading=e,this.updateIsReady()}canAddCustomChoices(){return this.allowCustomChoices}getFirstInputElementId(){return this.inputId+(this.searchEnabled||this.allowCustomChoices?"_0":"")}getInputId(){return this.inputId+"_0"}supportEmptyValidation(){return!0}onBlurCore(e){this.dropdownListModel.onBlur(e),super.onBlurCore(e)}onFocusCore(e){this.dropdownListModel.onFocus(e),super.onFocusCore(e)}allElementsSelected(){const e=super.allElementsSelected();return this.updateSelectAllItemText(e),e}updateSelectAllItemText(e){this.selectAllItem.setLocText(e?this.deselectAllItemText:this.selectAllItemText)}dispose(){super.dispose(),this.dropdownListModelValue&&(this.dropdownListModelValue.dispose(),this.dropdownListModelValue=void 0)}clearValue(e,t){var s;super.clearValue(e,t),(s=this.dropdownListModelValue)===null||s===void 0||s.clear()}get showClearButton(){return this.allowClear&&!this.isEmpty()}};S([E()],Ls.prototype,"searchMode",void 0),S([E({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setAllowCustomChoices(n)}})],Ls.prototype,"allowCustomChoices",void 0),S([E()],Ls.prototype,"allowClear",void 0),S([E({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setSearchEnabled(n)}})],Ls.prototype,"searchEnabled",void 0),S([E({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setHideSelectedItems(n)}})],Ls.prototype,"hideSelectedItems",void 0),S([E({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setChoicesLazyLoadEnabled(n)}})],Ls.prototype,"choicesLazyLoadEnabled",void 0),S([E()],Ls.prototype,"choicesLazyLoadPageSize",void 0),S([E({getDefaultValue:()=>A.tagboxCloseOnSelect})],Ls.prototype,"closeOnSelect",void 0),S([E()],Ls.prototype,"textWrapEnabled",void 0),q.addClass("tagbox",[{name:"placeholder",serializationProperty:"locPlaceholder"},{name:"allowClear:boolean",default:!0},{name:"searchEnabled:boolean",default:!0},{name:"allowCustomChoices:boolean",default:!1,visibleIf:n=>!n.choicesFromQuestion,dependsOn:"choicesFromQuestion"},{name:"textWrapEnabled:boolean",default:!0},{name:"choicesLazyLoadEnabled:boolean",default:!1,visible:!1},{name:"choicesLazyLoadPageSize:number",default:25,visible:!1},{name:"hideSelectedItems:boolean",default:!1},{name:"closeOnSelect:boolean"},{name:"itemComponent",visible:!1,default:""},{name:"searchMode",default:"contains",choices:["contains","startsWith"]}],function(){return new Ls("")},"checkbox"),qe.Instance.registerQuestion("tagbox",n=>{const e=new Ls(n);return e.choices=qe.DefaultChoices,e});let pS=class extends qy{constructor(){super(...arguments),this.doDragOver=()=>{if(this.parentElement.getType()==="imagepicker")return;const e=this.domAdapter.draggedElementShortcut.querySelector(".svc-item-value-controls__button");e.style.cursor="grabbing"},this.doBanDropHere=()=>{if(this.parentElement.getType()==="imagepicker")return;const e=this.domAdapter.draggedElementShortcut.querySelector(".svc-item-value-controls__button");e.style.cursor="not-allowed"}}get draggedElementType(){return"item-value"}createDraggedElementShortcut(e,t,s){if(this.parentElement.getType()==="imagepicker")return this.createImagePickerShortcut(this.draggedElement,e,t,s);const i=ge.createElement("div");if(!i)return;i.className="sv-drag-drop-choices-shortcut";const a=t.closest("[data-sv-drop-target-item-value]").cloneNode(!0);a.classList.add("sv-drag-drop-choices-shortcut__content");const o=a.querySelector(".svc-item-value-controls__drag-icon");o.style.visibility="visible";const l=a.querySelector(".svc-item-value-controls__remove");l.style.backgroundColor="transparent",a.classList.remove("svc-item-value--moveup"),a.classList.remove("svc-item-value--movedown"),this.draggedElement.isDragDropMoveDown=!1,this.draggedElement.isDragDropMoveUp=!1,i.appendChild(a);const u=t.getBoundingClientRect();return i.shortcutXOffset=s.clientX-u.x,i.shortcutYOffset=s.clientY-u.y,this.isBottom=null,typeof this.onShortcutCreated=="function"&&this.onShortcutCreated(i),i}createImagePickerShortcut(e,t,s,i){const r=ge.createElement("div");if(!r)return;r.classList.add("sv-drag-drop-image-picker-shortcut");const a=s.closest("[data-sv-drop-target-item-value]");this.imagepickerControlsNode=a.querySelector(".svc-image-item-value-controls");const o=a.querySelector(".sd-imagepicker__image-container");let l=a.querySelector(e.imageLink?"img":".sd-imagepicker__no-image").cloneNode(!0);return this.imagepickerControlsNode&&(this.imagepickerControlsNode.style.display="none"),o.style.width=l.width+"px",o.style.height=l.height+"px",l.style.objectFit="cover",l.style.borderRadius="4px",r.appendChild(l),r}getDropTargetByDataAttributeValue(e){let t;return t=this.parentElement.choices.filter(s=>""+s.value==e)[0],t}getChoices(){const e=this.parentElement;return e.getType()==="ranking"?e.selectToRankEnabled?e.unRankingChoices:e.rankingChoices:e.visibleChoices}isDropTargetValid(e,t){const s=this.getChoices();if(this.parentElement.getType()!=="imagepicker"){const i=s.indexOf(this.dropTarget),r=s.indexOf(this.draggedElement);if(r>i&&this.dropTarget.isDragDropMoveUp)return this.dropTarget.isDragDropMoveUp=!1,!1;if(r<i&&this.dropTarget.isDragDropMoveDown)return this.dropTarget.isDragDropMoveDown=!1,!1}return s.indexOf(e)!==-1}isDropTargetDoesntChanged(e){return this.dropTarget===this.prevDropTarget&&e===this.isBottom}calculateIsBottom(e,t){const s=t.getBoundingClientRect();return e>=s.y+s.height/2}afterDragOver(e){const t=this.getChoices(),s=t.indexOf(this.dropTarget),i=t.indexOf(this.draggedElement);if(i<s&&this.isBottom===!0)t.splice(i,1),t.splice(s,0,this.draggedElement);else if(i>s&&this.isBottom===!1)t.splice(s,1),t.splice(i,0,this.dropTarget);else return;this.parentElement.getType()!=="imagepicker"&&(i!==s&&(e.classList.remove("svc-item-value--moveup"),e.classList.remove("svc-item-value--movedown"),this.dropTarget.isDragDropMoveDown=!1,this.dropTarget.isDragDropMoveUp=!1),i>s&&(this.dropTarget.isDragDropMoveDown=!0),i<s&&(this.dropTarget.isDragDropMoveUp=!0),super.ghostPositionChanged())}doDrop(){const e=this.parentElement.choices,t=this.getChoices().filter(r=>e.indexOf(r)!==-1),s=e.indexOf(this.draggedElement);let i=t.indexOf(this.draggedElement);return e.splice(s,1),e.splice(i,0,this.draggedElement),this.parentElement}clear(){this.parentElement&&this.updateVisibleChoices(this.parentElement),this.imagepickerControlsNode&&(this.imagepickerControlsNode.style.display="flex",this.imagepickerControlsNode=null),super.clear()}updateVisibleChoices(e){e.getType()==="ranking"?e.updateRankingChoices():e.updateVisibleChoices()}},iv=class extends pS{constructor(){super(...arguments),this.isDragOverRootNode=!1,this.doDragOver=()=>{const e=this.domAdapter.draggedElementShortcut.querySelector(".sv-ranking-item");e.style.cursor="grabbing"},this.reorderRankedItem=(e,t,s)=>{if(t==s)return;const i=e.rankingChoices,r=i[t];e.isValueSetByUser=!0,i.splice(t,1),i.splice(s,0,r),this.updateDraggedElementShortcut(s+1)},this.doBanDropHere=()=>{if(this.isDragOverRootNode){this.allowDropHere=!0;return}const e=this.domAdapter.draggedElementShortcut.querySelector(".sv-ranking-item");e.style.cursor="not-allowed",ft&&this.parentElement.updateRankingChoices(!0)}}get draggedElementType(){return"ranking-item"}createDraggedElementShortcut(e,t,s){const i=ge.createElement("div");if(!i)return;i.className=this.shortcutClass+" sv-ranking-shortcut";const a=t.cloneNode(!0);i.appendChild(a);const o=t.getBoundingClientRect();i.style.left=o.x,i.style.top=o.y,this.domAdapter.rootElement.append(i);const l=i.offsetHeight;let u=s.clientY;return u>o.y+l&&(u=o.y+l-10),i.shortcutXOffset=s.clientX-o.x,i.shortcutYOffset=u-o.y,this.parentElement&&this.parentElement.useFullItemSizeForShortcut&&(i.style.width=t.offsetWidth+"px",i.style.height=t.offsetHeight+"px"),i}get shortcutClass(){return new z().append(this.parentElement.cssClasses.root).append(this.parentElement.cssClasses.rootMobileMod,qu).toString()}getDropTargetByDataAttributeValue(e){return this.parentElement.rankingChoices[e]}findDropTargetNodeByDragOverNode(e){return this.isDragOverRootNode=this.getIsDragOverRootNode(e),super.findDropTargetNodeByDragOverNode(e)}getIsDragOverRootNode(e){return typeof e.className=="string"&&e.className.indexOf("sv-ranking")!==-1}isDropTargetValid(e,t){return this.parentElement.rankingChoices.indexOf(e)!==-1}calculateIsBottom(e,t){return this.dropTarget instanceof Ce&&this.draggedElement!==this.dropTarget?super.calculateIsBottom(e,t):!1}getIndices(e,t,s){let i=t.indexOf(this.draggedElement),r=s.indexOf(this.dropTarget);return i<0&&this.draggedElement&&(this.draggedElement=Ce.getItemByValue(t,this.draggedElement.value)||this.draggedElement,i=t.indexOf(this.draggedElement)),r===-1?r=e.value.length:t==s?(!this.isBottom&&i<r&&r--,this.isBottom&&i>r&&r++):t!=s&&this.isBottom&&r++,{fromIndex:i,toIndex:r}}afterDragOver(e){const{fromIndex:t,toIndex:s}=this.getIndices(this.parentElement,this.parentElement.rankingChoices,this.parentElement.rankingChoices);this.reorderRankedItem(this.parentElement,t,s)}updateDraggedElementShortcut(e){var t;if(!((t=this.domAdapter)===null||t===void 0)&&t.draggedElementShortcut){const s=e!==null?e+"":"",i=this.domAdapter.draggedElementShortcut.querySelector(".sv-ranking-item__index");i.innerText=s}}ghostPositionChanged(){this.parentElement.currentDropTarget=this.draggedElement,super.ghostPositionChanged()}doDrop(){return this.parentElement.setValue(),this.parentElement}clear(){this.parentElement&&(this.parentElement.dropTargetNodeMove=null,this.parentElement.updateRankingChoices(!0)),super.clear()}},gS=class extends iv{constructor(){super(...arguments),this.selectToRank=(e,t,s)=>{const i=[].concat(e.rankingChoices),a=e.unRankingChoices[t];i.splice(s,0,a),this.updateChoices(e,i)},this.unselectFromRank=(e,t,s)=>{const i=[].concat(e.rankingChoices);i.splice(t,1),this.updateChoices(e,i)}}findDropTargetNodeByDragOverNode(e){if(e.dataset.ranking==="from-container"||e.dataset.ranking==="to-container")return e;let t=e.closest("[data-ranking='to-container']"),s=e.closest("[data-ranking='from-container']");return this.parentElement.unRankingChoices.length===0&&s?s:this.parentElement.rankingChoices.length===0&&t?t:super.findDropTargetNodeByDragOverNode(e)}getDropTargetByDataAttributeValue(e){return this.parentElement.rankingChoices[e]||this.parentElement.unRankingChoices[e]}getDropTargetByNode(e,t){return e.dataset.ranking==="to-container"?"to-container":e.dataset.ranking==="from-container"||e.closest("[data-ranking='from-container']")?"from-container":super.getDropTargetByNode(e,t)}isDropTargetValid(e,t){return e==="to-container"||e==="from-container"?!0:super.isDropTargetValid(e,t)}afterDragOver(e){const t=this.parentElement,s=t.rankingChoices,i=t.unRankingChoices;if(this.isDraggedElementUnranked&&this.isDropTargetRanked){this.doRankBetween(e,i,s,this.selectToRank);return}if(this.isDraggedElementRanked&&this.isDropTargetRanked){this.doRankBetween(e,s,s,this.reorderRankedItem);return}if(this.isDraggedElementRanked&&!this.isDropTargetRanked){this.doRankBetween(e,s,i,this.unselectFromRank);return}}doRankBetween(e,t,s,i){const r=this.parentElement;let{fromIndex:a,toIndex:o}=this.getIndices(r,t,s);i(r,a,o,e)}get isDraggedElementRanked(){return this.parentElement.rankingChoices.indexOf(this.draggedElement)!==-1}get isDropTargetRanked(){return this.dropTarget==="to-container"?!0:this.parentElement.rankingChoices.indexOf(this.dropTarget)!==-1}get isDraggedElementUnranked(){return!this.isDraggedElementRanked}updateChoices(e,t){e.isValueSetByUser=!0,e.rankingChoices=t,e.updateUnRankingChoices(t)}},js=class extends yo{constructor(e){super(e),this.domNode=null,this.onVisibleChoicesChanged=()=>{if(super.onVisibleChoicesChanged(),this.carryForwardStartUnranked&&!this.isValueSetByUser&&!this.selectToRankEnabled&&!this.defaultValue&&(this.value=[]),this.visibleChoices.length===1&&!this.selectToRankEnabled){this.value=[],this.value.push(this.visibleChoices[0].value),this.updateRankingChoices();return}if(this.isEmpty()){this.updateRankingChoices();return}if(this.selectToRankEnabled){this.updateRankingChoices();return}this.visibleChoices.length>this.value.length&&this.addToValueByVisibleChoices(),this.visibleChoices.length<this.value.length&&this.removeFromValueByVisibleChoices(),this.updateRankingChoices()},this.localeChanged=()=>{super.localeChanged(),this.updateRankingChoicesSync()},this._rankingChoicesAnimation=new Wi(this.getChoicesAnimationOptions(!0),t=>{this._renderedRankingChoices=t},()=>this.renderedRankingChoices),this._unRankingChoicesAnimation=new Wi(this.getChoicesAnimationOptions(!1),t=>{this._renderedUnRankingChoices=t},()=>this.renderedUnRankingChoices),this.rankingChoices=[],this.unRankingChoices=[],this._renderedRankingChoices=[],this._renderedUnRankingChoices=[],this.handlePointerDown=(t,s,i)=>{const r=t.target;this.isDragStartNodeValid(r)&&this.isAllowStartDrag(r,s)&&(this.draggedChoiceValue=s.value,this.draggedTargetNode=i,this.dragOrClickHelper.onPointerDown(t))},this.startDrag=t=>{const s=Ce.getItemByValue(this.visibleChoices,this.draggedChoiceValue);this.dragDropRankingChoices.startDrag(t,s,this,this.draggedTargetNode)},this.handlePointerUp=(t,s,i)=>{if(!this.selectToRankEnabled)return;const r=t.target;this.isAllowStartDrag(r,s)&&this.handleKeydownSelectToRank(t,s," ",!1)},this.handleKeydown=(t,s)=>{if(!this.isReadOnlyAttr&&!this.isDesignMode){const i=t.key,r=this.rankingChoices.indexOf(s);if(this.selectToRankEnabled){this.handleKeydownSelectToRank(t,s);return}if(i==="ArrowUp"&&r||i==="ArrowDown"&&r!==this.rankingChoices.length-1){const a=i=="ArrowUp"?r-1:r+1;this.dragDropRankingChoices.reorderRankedItem(this,r,a),this.setValueAfterKeydown(a,"",!0,t)}}},this.focusItem=(t,s)=>{if(this.domNode)if(this.selectToRankEnabled&&s){const i="[data-ranking='"+s+"']";this.domNode.querySelectorAll(i+" ."+this.cssClasses.item)[t].focus()}else this.domNode.querySelectorAll("."+this.cssClasses.item)[t].focus()},this.isValueSetByUser=!1,this.setValue=()=>{const t=[];this.rankingChoices.forEach(s=>{t.push(s.value)}),this.value=t,this.isValueSetByUser=!0},this.registerFunctionOnPropertyValueChanged("selectToRankEnabled",()=>{this.clearValue(!0),this.setDragDropRankingChoices(),this.updateRankingChoicesSync()}),this.dragOrClickHelper=new Xu(this.startDrag)}getType(){return"ranking"}supportElementsInChoice(){return!1}getItemTabIndex(e){if(!(this.isDesignMode||e.disabled))return 0}supportContainerQueries(){return this.selectToRankEnabled}get rootClass(){return new z().append(this.cssClasses.root).append(this.cssClasses.rootMobileMod,this.isMobileMode()).append(this.cssClasses.rootDisabled,this.isDisabledStyle).append(this.cssClasses.rootReadOnly,this.isReadOnlyStyle).append(this.cssClasses.rootPreview,this.isPreviewStyle).append(this.cssClasses.rootDesignMode,!!this.isDesignMode).append(this.cssClasses.itemOnError,this.hasCssError()).append(this.cssClasses.rootDragHandleAreaIcon,A.rankingDragHandleArea==="icon").append(this.cssClasses.rootSelectToRankMod,this.selectToRankEnabled).append(this.cssClasses.rootSelectToRankEmptyValueMod,this.isEmpty()).append(this.cssClasses.rootSelectToRankAlignHorizontal,this.selectToRankEnabled&&this.renderedSelectToRankAreasLayout==="horizontal").append(this.cssClasses.rootSelectToRankAlignVertical,this.selectToRankEnabled&&this.renderedSelectToRankAreasLayout==="vertical").append(this.cssClasses.rootSelectToRankSwapAreas,this.selectToRankEnabled&&this.renderedSelectToRankAreasLayout==="horizontal"&&this.selectToRankSwapAreas).toString()}isItemSelectedCore(e){return this.selectToRankEnabled?super.isItemSelectedCore(e):!0}getItemClassCore(e,t){return new z().append(super.getItemClassCore(e,t)).append(this.cssClasses.itemGhostMod,this.currentDropTarget===e).toString()}getContainerClasses(e){let t=!1;const s=e==="to",i=e==="from";return s?t=this.renderedRankingChoices.length===0:i&&(t=this.renderedUnRankingChoices.length===0),new z().append(this.cssClasses.container).append(this.cssClasses.containerToMode,s).append(this.cssClasses.containerFromMode,i).append(this.cssClasses.containerEmptyMode,t).toString()}isItemCurrentDropTarget(e){return this.dragDropRankingChoices.dropTarget===e}get ghostPositionCssClass(){return this.ghostPosition==="top"?this.cssClasses.dragDropGhostPositionTop:this.ghostPosition==="bottom"?this.cssClasses.dragDropGhostPositionBottom:""}getItemIndexClasses(e){let t;return this.selectToRankEnabled?t=this.unRankingChoices.indexOf(e)!==-1:t=this.isEmpty(),new z().append(this.cssClasses.itemIndex).append(this.cssClasses.itemIndexEmptyMode,t).toString()}getNumberByIndex(e){return this.isEmpty()?"":e+1+""}updateRankingChoicesSync(){this.blockAnimations(),this.updateRankingChoices(),this.releaseAnimations()}setSurveyImpl(e,t){super.setSurveyImpl(e,t),this.setDragDropRankingChoices(),this.updateRankingChoicesSync()}isAnswerCorrect(){return O.isArraysEqual(this.value,this.correctAnswer,!1)}get requireStrictCompare(){return!0}onSurveyValueChanged(e){super.onSurveyValueChanged(e),!this.isLoadingFromJson&&this.updateRankingChoices()}onSurveyLoad(){this.blockAnimations(),super.onSurveyLoad(),this.updateRankingChoices(),this.releaseAnimations()}updateValueFromSurvey(e,t){super.updateValueFromSurvey(e,t),e&&(this.isValueSetByUser=!0)}addToValueByVisibleChoices(){const e=this.value.slice();this.visibleChoices.forEach(t=>{e.indexOf(t.value)===-1&&e.push(t.value)}),this.value=e}removeFromValueByVisibleChoices(){const e=this.value.slice(),t=this.visibleChoices;for(let s=this.value.length-1;s>=0;s--)Ce.getItemByValue(t,this.value[s])||e.splice(s,1);this.value=e}getChoicesAnimationOptions(e){return{getKey(t){return t.value},getRerenderEvent:()=>this.onElementRerendered,isAnimationEnabled:()=>this.animationAllowed&&!this.isDesignMode&&this.isVisible&&!!this.domNode,getReorderOptions:(t,s)=>{let i="";return t!==this.currentDropTarget&&(i=s?"sv-dragdrop-movedown":"sv-dragdrop-moveup"),{cssClass:i}},getLeaveOptions:t=>{const s=e?this.renderedRankingChoices:this.renderedUnRankingChoices;return this.renderedSelectToRankAreasLayout=="vertical"&&s.length==1&&s.indexOf(t)>=0?{cssClass:"sv-ranking-item--animate-item-removing-empty"}:{cssClass:"sv-ranking-item--animate-item-removing",onBeforeRunAnimation:i=>{i.style.setProperty("--animation-height",i.offsetHeight+"px")}}},getEnterOptions:t=>{const s=e?this.renderedRankingChoices:this.renderedUnRankingChoices;return this.renderedSelectToRankAreasLayout=="vertical"&&s.length==1&&s.indexOf(t)>=0?{cssClass:"sv-ranking-item--animate-item-adding-empty"}:{cssClass:"sv-ranking-item--animate-item-adding",onBeforeRunAnimation:i=>{i.style.setProperty("--animation-height",i.offsetHeight+"px")}}},getAnimatedElement:t=>{var s;const i=this.cssClasses;let r="";this.selectToRankEnabled&&(!e&&i.containerFromMode?r=rs(i.containerFromMode):e&&i.containerToMode&&(r=rs(i.containerToMode)));const a=e?this.renderedRankingChoices.indexOf(t):this.renderedUnRankingChoices.indexOf(t);return(s=this.domNode)===null||s===void 0?void 0:s.querySelector(`${r} [data-sv-drop-target-ranking-item='${a}']`)},allowSyncRemovalAddition:!0}}get rankingChoicesAnimation(){return this._rankingChoicesAnimation}get unRankingChoicesAnimation(){return this._unRankingChoicesAnimation}get renderedRankingChoices(){return this._renderedRankingChoices}set renderedRankingChoices(e){this.rankingChoicesAnimation.sync(e)}get renderedUnRankingChoices(){return this._renderedUnRankingChoices}set renderedUnRankingChoices(e){this.unRankingChoicesAnimation.sync(e)}updateRenderedRankingChoices(){this.renderedRankingChoices=this.rankingChoices}updateRenderedUnRankingChoices(){this.renderedUnRankingChoices=this.unRankingChoices}updateRankingChoices(e=!1){if(this.selectToRankEnabled){this.updateRankingChoicesSelectToRankMode(e);return}const t=[];if(e&&(this.rankingChoices=[]),this.isEmpty()){this.rankingChoices=this.visibleChoices;return}this.value.forEach(s=>{this.visibleChoices.forEach(i=>{i.value===s&&t.push(i)})}),this.rankingChoices=t}updateUnRankingChoices(e){const t=[];this.visibleChoices.forEach(s=>{t.push(s)}),e.forEach(s=>{t.forEach((i,r)=>{i.value===s.value&&t.splice(r,1)})}),this.unRankingChoices=t}updateRankingChoicesSelectToRankMode(e){const t=[];this.isEmpty()||this.value.forEach(s=>{this.visibleChoices.forEach(i=>{i.value===s&&t.push(i)})}),this.updateUnRankingChoices(t),this.rankingChoices=t}endLoadingFromJson(){super.endLoadingFromJson(),this.setDragDropRankingChoices()}setDragDropRankingChoices(){this.dragDropRankingChoices=this.createDragDropRankingChoices()}createDragDropRankingChoices(){return this.selectToRankEnabled?new gS(this.survey,null,this.longTap):new iv(this.survey,null,this.longTap)}isDragStartNodeValid(e){return A.rankingDragHandleArea==="icon"?e.classList.contains(this.cssClasses.itemIconHoverMod):!0}isAllowStartDrag(e,t){return!this.isReadOnly&&!this.isDesignMode&&this.canStartDragDueMaxSelectedChoices(e)&&this.canStartDragDueItemEnabled(t)}canStartDragDueMaxSelectedChoices(e){return this.selectToRankEnabled&&e.closest("[data-ranking='from-container']")?this.checkMaxSelectedChoicesUnreached():!0}canStartDragDueItemEnabled(e){return e.enabled}checkMaxSelectedChoicesUnreached(){if(this.maxSelectedChoices<1)return!0;var e=this.value,t=Array.isArray(e)?e.length:0;return t<this.maxSelectedChoices}afterRenderQuestionElement(e){this.domNode=e,super.afterRenderQuestionElement(e)}beforeDestroyQuestionElement(e){this.domNode=void 0,super.beforeDestroyQuestionElement(e)}supportSelectAll(){return!1}supportOther(){return!1}supportNone(){return!1}supportRefuse(){return!1}supportDontKnow(){return!1}handleKeydownSelectToRank(e,t,s,i=!0){if(this.isDesignMode)return;let r=e.key;if(s&&(r=s),r!==" "&&r!=="ArrowUp"&&r!=="ArrowDown")return;const a=this.dragDropRankingChoices,o=this.rankingChoices,l=o.indexOf(t)!==-1,d=(l?o:this.unRankingChoices).indexOf(t);if(d<0)return;let h;if(r===" "&&!l){if(!this.checkMaxSelectedChoicesUnreached()||!this.canStartDragDueItemEnabled(t))return;h=this.value.length,a.selectToRank(this,d,h),this.setValueAfterKeydown(h,"to-container",i,e);return}if(!l)return;if(r===" "){a.unselectFromRank(this,d),h=this.unRankingChoices.indexOf(t),this.setValueAfterKeydown(h,"from-container",i,e);return}const f=r==="ArrowUp"?-1:r==="ArrowDown"?1:0;f!==0&&(h=d+f,!(h<0||h>=o.length)&&(a.reorderRankedItem(this,d,h),this.setValueAfterKeydown(h,"to-container",i,e)))}setValueAfterKeydown(e,t,s=!0,i){this.setValue(),s&&setTimeout(()=>{this.focusItem(e,t)},1),i&&i.preventDefault()}getIconHoverCss(){return new z().append(this.cssClasses.itemIcon).append(this.cssClasses.itemIconHoverMod).toString()}getIconFocusCss(){return new z().append(this.cssClasses.itemIcon).append(this.cssClasses.itemIconFocusMod).toString()}get longTap(){return this.getPropertyValue("longTap")}set longTap(e){this.setPropertyValue("longTap",e)}getDefaultItemComponent(){return"sv-ranking-item"}get selectToRankEnabled(){return this.getPropertyValue("selectToRankEnabled",!1)}set selectToRankEnabled(e){this.setPropertyValue("selectToRankEnabled",e)}get selectToRankSwapAreas(){return this.getPropertyValue("selectToRankSwapAreas",!1)}set selectToRankSwapAreas(e){this.setPropertyValue("selectToRankSwapAreas",e)}get selectToRankAreasLayout(){return this.getPropertyValue("selectToRankAreasLayout")}set selectToRankAreasLayout(e){this.setPropertyValue("selectToRankAreasLayout",e)}get renderedSelectToRankAreasLayout(){return this.isMobileMode()?"vertical":this.selectToRankAreasLayout}isMobileMode(){return qu}get useFullItemSizeForShortcut(){return this.getPropertyValue("useFullItemSizeForShortcut")}set useFullItemSizeForShortcut(e){this.setPropertyValue("useFullItemSizeForShortcut",e)}get dragDropSvgIcon(){return this.cssClasses.dragDropSvgIconId||"#icon-drag-24x24"}get arrowsSvgIcon(){return this.cssClasses.arrowsSvgIconId||"#icon-reorder-24x24"}get dashSvgIcon(){return this.cssClasses.dashSvgIconId||"#icon-rankingundefined-16x16"}get isNewA11yStructure(){return!1}};S([Nt({onSet:(n,e)=>e.updateRenderedRankingChoices(),onRemove:(n,e,t)=>t.updateRenderedRankingChoices(),onPush:(n,e,t)=>t.updateRenderedRankingChoices()})],js.prototype,"rankingChoices",void 0),S([Nt({onSet:(n,e)=>e.updateRenderedUnRankingChoices(),onRemove:(n,e,t)=>t.updateRenderedUnRankingChoices(),onPush:(n,e,t)=>t.updateRenderedUnRankingChoices()})],js.prototype,"unRankingChoices",void 0),S([Nt()],js.prototype,"_renderedRankingChoices",void 0),S([Nt()],js.prototype,"_renderedUnRankingChoices",void 0),S([E({defaultValue:null})],js.prototype,"currentDropTarget",void 0),S([E({defaultValue:!0})],js.prototype,"carryForwardStartUnranked",void 0),S([E({localizable:{defaultStr:"selectToRankEmptyRankedAreaText"}})],js.prototype,"selectToRankEmptyRankedAreaText",void 0),S([E({localizable:{defaultStr:"selectToRankEmptyUnrankedAreaText"}})],js.prototype,"selectToRankEmptyUnrankedAreaText",void 0),q.addClass("ranking",[{name:"showOtherItem",visible:!1,isSerializable:!1},{name:"otherText",visible:!1,isSerializable:!1},{name:"otherErrorText",visible:!1,isSerializable:!1},{name:"storeOthersAsComment",visible:!1,isSerializable:!1},{name:"showNoneItem",visible:!1,isSerializable:!1},{name:"showRefuseItem",visible:!1,isSerializable:!1},{name:"showDontKnowItem",visible:!1,isSerializable:!1},{name:"noneText",visible:!1,isSerializable:!1},{name:"showSelectAllItem",visible:!1,isSerializable:!1},{name:"selectAllText",visible:!1,isSerializable:!1},{name:"colCount:number",visible:!1,isSerializable:!1},{name:"separateSpecialChoices",visible:!1,isSerializable:!1},{name:"longTap",default:!0,visible:!1,isSerializable:!1},{name:"selectToRankEnabled:switch",default:!1,visible:!0,isSerializable:!0},{name:"selectToRankSwapAreas:switch",default:!1,visible:!1,isSerializable:!0,dependsOn:"selectToRankEnabled"},{name:"selectToRankAreasLayout",default:"horizontal",choices:["horizontal","vertical"],dependsOn:"selectToRankEnabled",visibleIf:n=>!!n.selectToRankEnabled,visible:!0,isSerializable:!0},{name:"selectToRankEmptyRankedAreaText:text",serializationProperty:"locSelectToRankEmptyRankedAreaText",category:"general",dependsOn:"selectToRankEnabled",visibleIf:n=>!!n.selectToRankEnabled},{name:"selectToRankEmptyUnrankedAreaText:text",serializationProperty:"locSelectToRankEmptyUnrankedAreaText",category:"general",dependsOn:"selectToRankEnabled",visibleIf:n=>!!n.selectToRankEnabled},{name:"maxSelectedChoices:number",visible:!0,default:0,dependsOn:"selectToRankEnabled",visibleIf:n=>!!n.selectToRankEnabled,isSerializable:!0},{name:"minSelectedChoices:number",visible:!0,default:0,dependsOn:"selectToRankEnabled",visibleIf:n=>!!n.selectToRankEnabled,isSerializable:!0},{name:"itemComponent",visible:!1,default:"sv-ranking-item"}],function(){return new js("")},"checkbox"),qe.Instance.registerQuestion("ranking",n=>{const e=new js(n);return e.choices=qe.DefaultChoices,e});let rv=class extends go{constructor(e){super(e)}get textAreaModel(){return this.textAreaModelValue||(this.textAreaModelValue=new $u(this.getTextAreaOptions())),this.textAreaModelValue}getTextAreaOptions(){const e=this,t=i=>{O.isTwoValueEquals(e.value,i,!1,!0,!1)||(e.value=i)};return{question:this,id:()=>this.inputId,propertyNames:["value"],className:()=>this.className,placeholder:()=>this.renderedPlaceholder,isDisabledAttr:()=>this.isDisabledAttr,isReadOnlyAttr:()=>this.isReadOnlyAttr,autoGrow:()=>this.renderedAutoGrow,maxLength:()=>this.getMaxLength(),rows:()=>this.rows,cols:()=>this.cols,ariaRequired:()=>this.a11y_input_ariaRequired,ariaLabel:()=>this.a11y_input_ariaLabel,ariaLabelledBy:()=>this.a11y_input_ariaLabelledBy,ariaDescribedBy:()=>this.a11y_input_ariaDescribedBy,ariaInvalid:()=>this.a11y_input_ariaInvalid,ariaErrormessage:()=>this.a11y_input_ariaErrormessage,getTextValue:()=>this.value,onTextAreaChange:i=>{t(i.target.value)},onTextAreaInput:i=>{this.onInput(i)},onTextAreaKeyDown:i=>{this.onKeyDown(i)},onTextAreaFocus:i=>{this.onFocus(i)},onTextAreaBlur:i=>{this.onBlur(i)}}}get rows(){return this.getPropertyValue("rows")}set rows(e){this.setPropertyValue("rows",e)}get cols(){return this.getPropertyValue("cols")}set cols(e){this.setPropertyValue("cols",e)}get acceptCarriageReturn(){return this.getPropertyValue("acceptCarriageReturn")}set acceptCarriageReturn(e){this.setPropertyValue("acceptCarriageReturn",e)}get autoGrow(){return this.getPropertyValue("autoGrow")}set autoGrow(e){this.setPropertyValue("autoGrow",e)}get renderedAutoGrow(){const e=this.autoGrow;return e===void 0&&this.survey?this.survey.autoGrowComment:!!e}get allowResize(){return this.getPropertyValue("allowResize")}set allowResize(e){this.setPropertyValue("allowResize",e)}get renderedAllowResize(){const e=this.allowResize;return e===void 0&&this.survey?this.survey.allowResizeComment:!!e}get resizeStyle(){return this.renderedAllowResize?"both":"none"}getType(){return"comment"}afterRenderQuestionElement(e){this.element=e?.querySelector(`#${this.inputId}`)||e,super.afterRenderQuestionElement(e)}beforeDestroyQuestionElement(e){super.beforeDestroyQuestionElement(e),this.element=void 0}onInput(e){this.isInputTextUpdate&&(this.value=e.target.value),this.updateRemainingCharacterCounter(e.target.value)}onBlurCore(e){super.onBlurCore(e)}onKeyDown(e){this.onKeyDownPreprocess&&this.onKeyDownPreprocess(e),!this.acceptCarriageReturn&&(e.key==="Enter"||e.keyCode===13)&&(e.preventDefault(),e.stopPropagation())}setNewValue(e){!this.acceptCarriageReturn&&e&&(e=e.replace(new RegExp(`(\r
|
|\r)`,"gm"),"")),super.setNewValue(e)}getValueSeparator(){return`
`}notifyStateChanged(e){super.notifyStateChanged(e),this.isCollapsed||this.textAreaModel.updateElement()}get className(){return(this.cssClasses?this.getControlClass():"panel-comment-root")||void 0}};q.addClass("comment",[{name:"maxLength:number",default:-1},{name:"cols:number",default:50,visible:!1,isSerializable:!1},{name:"rows:number",default:4},{name:"placeholder",alternativeName:"placeHolder",serializationProperty:"locPlaceholder"},{name:"textUpdateMode",default:"default",choices:["default","onBlur","onTyping"]},{name:"autoGrow:boolean",defaultFunc:()=>{}},{name:"allowResize:boolean",defaultFunc:()=>{}},{name:"acceptCarriageReturn:boolean",default:!0,visible:!1}],function(){return new rv("")},"textbase"),qe.Instance.registerQuestion("comment",n=>new rv(n));const un="environment",_i="user";let vo=class et{constructor(){this.canFlipValue=void 0}static clear(){et.cameraList=void 0,et.cameraIndex=-1}static setCameraList(e){const t=function(s){const i=s.label.toLocaleLowerCase();return i.indexOf(_i)>-1?_i:i.indexOf(un)>-1?un:i.indexOf("front")>-1?_i:i.indexOf("back")>-1?un:""};et.clear(),Array.isArray(e)&&e.length>0&&(et.cameraIndex=-1,e.sort((s,i)=>{if(s===i)return 0;if(s.label!==i.label){const o=t(s),l=t(i);if(o!==l){if(o===_i)return-1;if(l===_i)return 1;if(o===un)return-1;if(l===un)return 1}}const r=e.indexOf(s),a=e.indexOf(i);return r<a?-1:1})),et.cameraList=e}hasCamera(e){if(et.cameraList!==void 0){this.hasCameraCallback(e);return}if(et.mediaDevicesCallback){const t=s=>{this.setVideoInputs(s),this.hasCameraCallback(e)};et.mediaDevicesCallback(t);return}typeof navigator<"u"&&navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then(t=>{this.setVideoInputs(t),this.hasCameraCallback(e),this.updateCanFlipValue()}).catch(t=>{et.cameraList=null,this.hasCameraCallback(e)}):(et.cameraList=null,this.hasCameraCallback(e))}getMediaConstraints(e){const t=et.cameraList;if(!Array.isArray(t)||t.length<1)return;et.cameraIndex<0&&(et.cameraIndex=0);const s=t[et.cameraIndex],i={};return s&&s.deviceId?i.deviceId={exact:s.deviceId}:i.facingMode=et.cameraFacingMode,e&&(e?.height&&(i.height={ideal:e.height}),e?.width&&(i.width={ideal:e.width})),{video:i,audio:!1}}startVideo(e,t,s,i){if(!e){t(void 0);return}e.style.width="100%",e.style.height="auto",e.style.height="100%",e.style.objectFit="contain";const r=this.getMediaConstraints({width:s,height:i});navigator.mediaDevices.getUserMedia(r).then(a=>{var o;e.srcObject=a,!(!((o=et.cameraList[et.cameraIndex])===null||o===void 0)&&o.deviceId)&&a.getTracks()[0].getCapabilities().facingMode&&(et.canSwitchFacingMode=!0,this.updateCanFlipValue()),e.play(),t(a)}).catch(a=>{t(void 0)})}getImageSize(e){return{width:e.videoWidth,height:e.videoHeight}}snap(e,t){if(!e||!ge.isAvailable())return!1;const i=ge.getDocument().createElement("canvas"),r=this.getImageSize(e);i.height=r.height,i.width=r.width;let a=i.getContext("2d");return a.clearRect(0,0,i.width,i.height),a.drawImage(e,0,0,i.width,i.height),i.toBlob(t,"image/png"),!0}updateCanFlipValue(){const e=et.cameraList;this.canFlipValue=Array.isArray(e)&&e.length>1||et.canSwitchFacingMode,this.onCanFlipChangedCallback&&this.onCanFlipChangedCallback(this.canFlipValue)}canFlip(e){return this.canFlipValue===void 0&&this.updateCanFlipValue(),e&&(this.onCanFlipChangedCallback=e),this.canFlipValue}flip(){this.canFlip()&&(et.canSwitchFacingMode?et.cameraFacingMode=et.cameraFacingMode===_i?"environment":_i:et.cameraIndex>=et.cameraList.length-1?et.cameraIndex=0:et.cameraIndex++)}hasCameraCallback(e){e(Array.isArray(et.cameraList))}setVideoInputs(e){const t=[];e.forEach(s=>{s.kind==="videoinput"&&t.push(s)}),et.setCameraList(t.length>0?t:null)}};vo.cameraIndex=-1,vo.cameraFacingMode=_i,vo.canSwitchFacingMode=!1;function mS(n,e,t){const s=atob(n.split(",")[1]),i=new Uint8Array(s.split("").map(r=>r.charCodeAt(0))).buffer;return new File([i],e,{type:t})}let Co=class extends Dt{constructor(){super(...arguments),this.isUploading=!1,this.onUploadStateChanged=this.addEvent(),this.onStateChanged=this.addEvent()}stateChanged(e){this.currentState!=e&&(e==="loading"&&(this.isUploading=!0),e==="loaded"&&(this.isUploading=!1),e==="error"&&(this.isUploading=!1),this.currentState=e,this.onStateChanged.fire(this,{state:e}),this.onUploadStateChanged.fire(this,{state:e}))}get showLoadingIndicator(){return this.isUploading}get storeDataAsText(){return this.getPropertyValue("storeDataAsText")}set storeDataAsText(e){this.setPropertyValue("storeDataAsText",e)}get waitForUpload(){return this.getPropertyValue("waitForUpload")}set waitForUpload(e){this.setPropertyValue("waitForUpload",e)}clearValue(e,t){this.clearOnDeletingContainer(),super.clearValue(e,t)}clearOnDeletingContainer(){this.survey&&this.survey.clearFiles(this,this.name,this.value,null,()=>{})}onCheckForErrors(e,t,s){super.onCheckForErrors(e,t,s),this.isUploading&&this.waitForUpload&&e.push(new to(this.getLocalizationString("uploadingFile"),this))}uploadFiles(e,t){this.survey&&(this.errors=[],this.stateChanged("loading"),this.survey.uploadFiles(this,this.name,e,(s,i)=>{Array.isArray(s)&&(this.setValueFromResult(s),Array.isArray(i)&&(i.forEach(r=>this.errors.push(new to(r,this))),this.stateChanged("error"))),s==="success"&&Array.isArray(i)&&this.setValueFromResult(i),s==="error"&&(typeof i=="string"&&this.errors.push(new to(i,this)),Array.isArray(i)&&i.length>0&&i.forEach(r=>this.errors.push(new to(r,this))),this.stateChanged("error")),this.stateChanged("loaded")},t))}loadPreview(e){}onChangeQuestionValue(e){super.onChangeQuestionValue(e),this.stateChanged(this.isEmpty()?"empty":"loaded")}getIsQuestionReady(){return super.getIsQuestionReady()&&!this.isFileLoading}get isFileLoading(){return this.isFileLoadingValue}set isFileLoading(e){this.isFileLoadingValue=e,this.updateIsReady()}};S([E()],Co.prototype,"isUploading",void 0),S([E({defaultValue:"empty"})],Co.prototype,"currentState",void 0);let oh=class bf extends Te{static getId(){return"sv_sfp_"+bf.pageCounter++}constructor(e,t){super(),this.question=e,this.index=t,this.id=bf.getId()}get css(){return this.question.cssClasses.page}};oh.pageCounter=0,S([Nt({})],oh.prototype,"items",void 0);let at=class extends Co{get fileNavigatorVisible(){const e=this.showLoadingIndicator,t=this.isPlayingVideo,s=this.containsMultiplyFiles,i=this.pageSize<this.previewValue.length;return!e&&!t&&s&&i}get pagesCount(){return Math.ceil(this.previewValue.length/this.pageSize)}get actionsContainerVisible(){const e=this.showLoadingIndicator,t=this.isPlayingVideo;return!e&&!t}constructor(e){super(e),this.isDragging=!1,this.fileNavigator=new _t,this.canFlipCameraValue=void 0,this.prevPreviewLength=0,this.isClearingFiles=!1,this._renderedPages=[],this.pagesAnimation=new yy(this.getPagesAnimationOptions(),t=>{this._renderedPages=t},()=>this.renderedPages),this.calcAvailableItemsCount=(t,s,i)=>{let r=Math.floor(t/(s+i));return(r+1)*(s+i)-i<=t&&r++,r},this.dragCounter=0,this.onDragEnter=t=>{this.canDragDrop()&&(t.preventDefault(),this.isDragging=!0,this.dragCounter++)},this.onDragOver=t=>{if(!this.canDragDrop())return t.returnValue=!1,!1;t.dataTransfer.dropEffect="copy",t.preventDefault()},this.onDrop=t=>{if(this.canDragDrop()){this.isDragging=!1,this.dragCounter=0,t.preventDefault();let s=t.dataTransfer;this.onChange(s)}},this.onDragLeave=t=>{this.canDragDrop()&&(this.dragCounter--,this.dragCounter===0&&(this.isDragging=!1))},this.doChange=t=>{var s=t.target||t.srcElement;this.onChange(s)},this.doClean=()=>{if(this.needConfirmRemoveFile){Ga({message:this.confirmRemoveAllMessage,funcOnYes:()=>{this.clearFilesCore()},locale:this.getLocale(),rootElement:this.survey.rootElement,cssClass:this.cssClasses.confirmDialog});return}this.clearFilesCore()},this.doDownloadFileFromContainer=t=>{t.stopPropagation();const s=t.currentTarget;if(s&&s.getElementsByTagName){const i=s.getElementsByTagName("a")[0];i?.click()}},this.doDownloadFile=(t,s)=>{t.stopPropagation(),Ja()&&(t.preventDefault(),z2(s.content,s.name))},this.createLocString({name:"takePhotoCaption",hasTranslation:!0}),this.createLocString({name:"clearCaption",hasTranslation:!0}),this.actionsContainer=new _t,this.actionsContainer.locOwner=this,this.fileIndexAction=new Pe({id:"fileIndex",title:this.getFileIndexCaption(),enabled:!1}),this.prevFileAction=new Pe({id:"prevPage",iconSize:16,action:()=>{this.navigationDirection="left",this.indexToShow=this.previewValue.length&&(this.indexToShow-1+this.pagesCount)%this.pagesCount||0,this.fileIndexAction.title=this.getFileIndexCaption()}}),this.nextFileAction=new Pe({id:"nextPage",iconSize:16,action:()=>{this.navigationDirection="right",this.indexToShow=this.previewValue.length&&(this.indexToShow+1)%this.pagesCount||0,this.fileIndexAction.title=this.getFileIndexCaption()}}),this.takePictureAction=new Pe({iconName:"icon-takepicture",id:"sv-file-take-picture",iconSize:"auto",innerCss:new We(()=>new z().append(this.cssClasses.contextButton).append(this.cssClasses.takePictureButton).toString()),locTitle:this.locTakePhotoCaption,showTitle:!1,action:()=>{this.snapPicture()}}),this.closeCameraAction=new Pe({iconName:"icon-closecamera",id:"sv-file-close-camera",iconSize:"auto",innerCss:new We(()=>new z().append(this.cssClasses.contextButton).append(this.cssClasses.closeCameraButton).toString()),action:()=>{this.stopVideo()}}),this.changeCameraAction=new Pe({iconName:"icon-changecamera",id:"sv-file-change-camera",iconSize:"auto",innerCss:new We(()=>new z().append(this.cssClasses.contextButton).append(this.cssClasses.changeCameraButton).toString()),visible:new We(()=>this.canFlipCamera()),action:()=>{this.flipCamera()}}),this.chooseFileAction=new Pe({iconName:"icon-choosefile",id:"sv-file-choose-file",iconSize:"auto",data:{question:this},enabledIf:()=>!this.isInputReadOnly,component:"sv-file-choose-btn"}),this.startCameraAction=new Pe({iconName:"icon-takepicture_24x24",id:"sv-file-start-camera",iconSize:"auto",locTitle:this.locTakePhotoCaption,showTitle:new We(()=>!this.isAnswered),enabledIf:()=>!this.isInputReadOnly,action:()=>{this.startVideo()}}),this.cleanAction=new Pe({iconName:"icon-clear",id:"sv-file-clean",iconSize:"auto",locTitle:this.locClearButtonCaption,showTitle:!1,enabledIf:()=>!this.isInputReadOnly,innerCss:new We(()=>this.cssClasses.removeButton),action:()=>{this.doClean()}}),[this.closeCameraAction,this.changeCameraAction,this.takePictureAction].forEach(t=>{t.cssClasses={}}),this.registerFunctionOnPropertiesValueChanged(["sourceType","currentMode","isAnswered"],()=>{this.updateActionsVisibility()}),this.actionsContainer.actions=[this.chooseFileAction,this.startCameraAction,this.cleanAction],this.fileNavigator.actions=[this.prevFileAction,this.fileIndexAction,this.nextFileAction]}get videoId(){return this.id+"_video"}get hasVideoUI(){return this.currentMode!=="file"}get hasFileUI(){return this.currentMode!=="camera"}startVideo(){this.currentMode==="file"||this.isDesignMode||this.isPlayingVideo||(this.setIsPlayingVideo(!0),setTimeout(()=>{this.startVideoInCamera()},0))}get videoHtmlElement(){var e;return(e=this.rootElement)===null||e===void 0?void 0:e.querySelector(`#${this.videoId}`)}startVideoInCamera(){this.camera.startVideo(this.videoHtmlElement,e=>{this.videoStream=e,e||this.stopVideo()},$i(this.imageWidth),$i(this.imageHeight))}stopVideo(){this.setIsPlayingVideo(!1),this.closeVideoStream()}snapPicture(){if(!this.isPlayingVideo)return;const e=t=>{if(t){const s=new File([t],"snap_picture.png",{type:"image/png"});this.loadFiles([s],"camera")}};this.camera.snap(this.videoHtmlElement,e),this.stopVideo()}canFlipCamera(){return this.canFlipCameraValue===void 0&&(this.canFlipCameraValue=this.camera.canFlip(e=>{this.canFlipCameraValue=e})),this.canFlipCameraValue}flipCamera(){this.canFlipCamera()&&(this.closeVideoStream(),this.camera.flip(),this.startVideoInCamera())}closeVideoStream(){this.videoStream&&(this.videoStream.getTracks().forEach(e=>{e.stop()}),this.videoStream=void 0)}onHidingContent(){super.onHidingContent(),this.stopVideo()}updateElementCssCore(e){super.updateElementCssCore(e),this.prevFileAction.iconName=this.cssClasses.leftIconId,this.nextFileAction.iconName=this.cssClasses.rightIconId,this.updateCurrentMode()}getFileIndexCaption(){return this.getLocalizationFormatString("indexText",this.indexToShow+1,this.pagesCount)}updateFileNavigator(){this.updatePages(),this.navigationDirection=void 0,this.indexToShow=this.previewValue.length&&(this.indexToShow+this.pagesCount)%this.pagesCount||0,this.fileIndexAction.title=this.getFileIndexCaption()}updateRenderedPages(){this.pages&&this.pages[this.indexToShow]&&(this.renderedPages=[this.pages[this.indexToShow]])}updatePages(){this.blockAnimations();let e;this.pages=[],this.renderedPages=[],this.previewValue.forEach((t,s)=>{s%this.pageSize==0&&(e=new oh(this,this.pages.length),this.pages.push(e)),e.items.push(t)}),this.releaseAnimations(),this.updateRenderedPages()}previewValueChanged(){this.navigationDirection=void 0,this.previewValue.length!==this.prevPreviewLength&&(this.previewValue.length>0?this.prevPreviewLength>this.previewValue.length?this.indexToShow>=this.pagesCount&&this.indexToShow>0&&(this.indexToShow=this.pagesCount-1,this.navigationDirection="left-delete"):this.indexToShow=Math.floor(this.prevPreviewLength/this.pageSize):this.indexToShow=0),this.updatePages(),this.fileIndexAction.title=this.getFileIndexCaption(),this.containsMultiplyFiles=this.previewValue.length>1,this.previewValue.length>0&&!this.calculatedGapBetweenItems&&!this.calculatedItemWidth&&setTimeout(()=>{this.processResponsiveness(0,this._width)},1),this.prevPreviewLength=this.previewValue.length}getType(){return"file"}onChangeQuestionValue(e){super.onChangeQuestionValue(e),this.isLoadingFromJson||this.loadPreview(e)}get showPreview(){return this.getPropertyValue("showPreview")}set showPreview(e){this.setPropertyValue("showPreview",e)}get allowMultiple(){return this.getPropertyValue("allowMultiple")}set allowMultiple(e){this.setPropertyValue("allowMultiple",e)}get imageHeight(){return this.getPropertyValue("imageHeight")}set imageHeight(e){this.setPropertyValue("imageHeight",e)}get imageWidth(){return this.getPropertyValue("imageWidth")}set imageWidth(e){this.setPropertyValue("imageWidth",e)}get acceptedTypes(){return this.getPropertyValue("acceptedTypes")}set acceptedTypes(e){this.setPropertyValue("acceptedTypes",e)}get allowImagesPreview(){return this.getPropertyValue("allowImagesPreview")}set allowImagesPreview(e){this.setPropertyValue("allowImagesPreview",e)}get maxSize(){return this.getPropertyValue("maxSize")}set maxSize(e){this.setPropertyValue("maxSize",e)}get maxFiles(){return this.getPropertyValue("maxFiles")}set maxFiles(e){this.setPropertyValue("maxFiles",e)}chooseFile(e){if(!this.rootElement)return;const t=this.rootElement.querySelector(`#${this.inputId}`);t&&(e.preventDefault(),e.stopImmediatePropagation(),t&&(this.survey?this.survey.chooseFiles(t,s=>this.loadFiles(s,"file"),{element:this,elementType:this.getType(),propertyName:this.name}):t.click()))}get needConfirmRemoveFile(){return this.getPropertyValue("needConfirmRemoveFile")}set needConfirmRemoveFile(e){this.setPropertyValue("needConfirmRemoveFile",e)}getConfirmRemoveMessage(e){return this.confirmRemoveMessage.format(e)}get takePhotoCaption(){return this.getLocalizableStringText("takePhotoCaption")}set takePhotoCaption(e){this.setLocalizableStringText("takePhotoCaption",e)}get locTakePhotoCaption(){return this.getLocalizableString("takePhotoCaption")}get clearButtonCaption(){return this.getLocalizableStringText("clearCaption")}set clearButtonCaption(e){this.setLocalizableStringText("clearCaption",e)}get locClearButtonCaption(){return this.getLocalizableString("clearCaption")}get locRenderedPlaceholder(){return this.locRenderedPlaceholderValue===void 0&&(this.locRenderedPlaceholderValue=new We(()=>{const e=this.isReadOnly,t=!this.isDesignMode&&this.hasFileUI||this.isDesignMode&&this.sourceType!="camera",s=!this.isDesignMode&&this.hasVideoUI||this.isDesignMode&&this.sourceType!="file";let i;return e?i=this.locNoFileChosenCaption:t&&s?i=this.locFileOrPhotoPlaceholder:t?i=this.locFilePlaceholder:i=this.locPhotoPlaceholder,i})),this.locRenderedPlaceholderValue}get currentMode(){return this.getPropertyValue("currentMode",this.sourceType)}get isPlayingVideo(){return this.getPropertyValue("isPlayingVideo",!1)}setIsPlayingVideo(e){this.setPropertyValue("isPlayingVideo",e)}updateCurrentMode(){!this.isDesignMode&&this.survey&&(this.sourceType!=="file"?this.camera.hasCamera(e=>{this.setPropertyValue("currentMode",e?this.sourceType:"file")}):this.setPropertyValue("currentMode",this.sourceType))}updateActionsVisibility(){const e=this.isDesignMode;this.chooseFileAction.visible=!e&&this.hasFileUI||e&&this.sourceType!=="camera",this.startCameraAction.visible=!e&&this.hasVideoUI||e&&this.sourceType!=="file",this.cleanAction.visible=!!this.isAnswered}get inputTitle(){return this.isUploading?this.loadingFileTitle:this.isEmpty()?this.chooseFileTitle:" "}get chooseButtonText(){return this.isEmpty()||this.allowMultiple?this.chooseButtonCaption:this.replaceButtonCaption}clear(e){this.survey&&(this.containsMultiplyFiles=!1,this.isClearingFiles=!0,this.survey.clearFiles(this,this.name,this.value,null,(t,s)=>{t==="success"&&(this.value=void 0,this.errors=[],e&&e(),this.indexToShow=0,this.fileIndexAction.title=this.getFileIndexCaption(),this.isClearingFiles=!1)}))}get renderCapture(){return this.allowCameraAccess?"user":void 0}get multipleRendered(){return this.allowMultiple?"multiple":void 0}get showFileDecorator(){const e=this.isPlayingVideo,t=this.showLoadingIndicator;return!e&&!t}get showDragAreaPlaceholder(){return!this.isAnswered}get showLoadingIndicator(){return this.isUploading||this.isClearingFiles}get allowShowPreview(){const e=this.showLoadingIndicator,t=this.isPlayingVideo;return!e&&!t}get showPreviewContainer(){return this.previewValue&&this.previewValue.length>0}defaultImage(e){return!this.canPreviewImage(e)&&!!this.cssClasses.defaultImage}removeFile(e){this.removeFileByContent(this.value.filter(t=>t.name===e)[0])}removeFileByContent(e){this.survey&&(this.isClearingFiles=!0,this.survey.clearFiles(this,this.name,this.value,e.name,(t,s)=>{if(t==="success"){var i=this.value;Array.isArray(i)?this.value=i.filter(r=>!O.isTwoValueEquals(r,e,!0,!1,!1)):this.value=void 0,this.isClearingFiles=!1}}))}setValueFromResult(e){this.value=(this.value||[]).concat(e.map(t=>({name:t.file.name,type:t.file.type,content:t.content})))}loadFiles(e,t){if(this.survey&&(this.errors=[],!!this.allFilesOk(e))){var s=()=>{this.stateChanged("loading");var i=[];this.storeDataAsText?e.forEach(r=>{let a=new FileReader;a.onload=o=>{i=i.concat([{name:r.name,type:r.type,content:a.result}]),i.length===e.length&&(this.value=(this.value||[]).concat(i))},a.readAsDataURL(r)}):this.uploadFiles(e,t)};this.allowMultiple?s():this.clear(s)}}get camera(){return this.cameraValue||(this.cameraValue=new vo),this.cameraValue}canPreviewImage(e){return this.allowImagesPreview&&!!e&&this.isFileImage(e)}loadPreview(e){if(!(this.showPreview&&this.prevLoadedPreviewValue===e)&&(this.previewValue.splice(0,this.previewValue.length),!(!this.showPreview||!e))){this.prevLoadedPreviewValue=e;var t=Array.isArray(e)?e:e?[e]:[];this.storeDataAsText?(t.forEach(s=>{var i=s.content||s;this.previewValue.push({name:s.name,type:s.type,content:i})}),this.previewValueChanged()):(this._previewLoader&&this._previewLoader.dispose(),this.isFileLoading=!0,this._previewLoader=new nv(this,(s,i)=>{s!=="error"&&(i.forEach(r=>{this.previewValue.push(r)}),this.previewValueChanged()),this.isFileLoading=!1,this._previewLoader.dispose(),this._previewLoader=void 0}),this._previewLoader.load(t))}}allFilesOk(e){var t=this.errors?this.errors.length:0;e=e||[];const s=Array.isArray(this.value)?this.value.length:0;return this.maxFiles>0&&this.maxFiles<e.length+s&&this.errors.push(new hP(this.maxFiles,this)),e.forEach(i=>{this.maxSize>0&&i.size>this.maxSize&&this.errors.push(new uP(this.maxSize,this))}),t===this.errors.length}isFileImage(e){if(!e||!e.content||!e.content.substring)return!1;const t="data:image";var s=e.content&&e.content.substring(0,t.length);s=s&&s.toLowerCase();var i=s===t||!!e.type&&e.type.toLowerCase().indexOf("image/")===0;return i}getPlainData(e={includeEmpty:!0}){var t=super.getPlainData(e);if(t&&!this.isEmpty()){t.isNode=!1;var s=Array.isArray(this.value)?this.value:[this.value];t.data=s.map((i,r)=>({name:r,title:"File",value:i.content&&i.content||i,displayValue:i.name&&i.name||i,getString:a=>typeof a=="object"?JSON.stringify(a):a,isNode:!1}))}return t}getImageWrapperCss(e){return new z().append(this.cssClasses.imageWrapper).append(this.cssClasses.imageWrapperDefaultImage,this.defaultImage(e)).toString()}getActionsContainerCss(e){return new z().append(e.actionsContainer).append(e.actionsContainerAnswered,this.isAnswered).toString()}getRemoveButtonCss(){return new z().append(this.cssClasses.removeFileButton).append(this.cssClasses.contextButton).toString()}getChooseFileCss(){const e=this.isAnswered;return new z().append(this.cssClasses.chooseFile).append(this.cssClasses.controlDisabled,this.isReadOnly).append(this.cssClasses.chooseFileAsText,!e).append(this.cssClasses.chooseFileAsTextDisabled,!e&&this.isInputReadOnly).append(this.cssClasses.contextButton,e).append(this.cssClasses.chooseFileAsIcon,e).toString()}getReadOnlyFileCss(){return new z().append("form-control").append(this.cssClasses.placeholderInput).toString()}get fileRootCss(){return new z().append(this.cssClasses.root).append(this.cssClasses.rootDisabled,this.isDisabledStyle).append(this.cssClasses.rootReadOnly,this.isReadOnlyStyle).append(this.cssClasses.rootPreview,this.isPreviewStyle).append(this.cssClasses.rootDragging,this.isDragging).append(this.cssClasses.rootAnswered,this.isAnswered).append(this.cssClasses.single,!this.allowMultiple).append(this.cssClasses.singleImage,!this.allowMultiple&&this.isAnswered&&this.canPreviewImage(this.value[0])).append(this.cssClasses.mobile,this.isMobile).toString()}getFileDecoratorCss(){return new z().append(this.cssClasses.fileDecorator).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.fileDecoratorDrag,this.isDragging).toString()}onChange(e){if(!we.isFileReaderAvailable()||!e||!e.files||e.files.length<1)return;let t=[],s=this.allowMultiple?e.files.length:1;for(let i=0;i<s;i++)t.push(e.files[i]);e.value="",this.loadFiles(t)}calcCssClasses(e){const t=super.calcCssClasses(e);return this.actionsContainer.cssClasses=e.actionBar,this.actionsContainer.cssClasses.itemWithTitle=this.actionsContainer.cssClasses.item,this.actionsContainer.cssClasses.item="",this.actionsContainer.cssClasses.itemAsIcon=t.contextButton,this.actionsContainer.containerCss=t.actionsContainer,t}onSurveyLoad(){super.onSurveyLoad(),this.updateCurrentMode(),this.updateActionsVisibility(),this.loadPreview(this.value)}needResponsiveness(){return this.supportResponsiveness()}supportResponsiveness(){return!0}getObservedElementSelector(){return rs(this.cssClasses.dragArea)}getFileListSelector(){return rs(this.cssClasses.fileList)}get renderedPages(){return this._renderedPages}set renderedPages(e){this.pagesAnimation.sync(e)}getPagesAnimationOptions(){return{getEnterOptions:e=>{const t=this.cssClasses.page;return{cssClass:t?new z().append(`${t}--enter-from-left`,this.navigationDirection=="left"||this.navigationDirection=="left-delete").append(`${t}--enter-from-right`,this.navigationDirection=="right").toString():""}},getLeaveOptions:e=>{const t=this.cssClasses.page;return{cssClass:t?new z().append(`${t}--leave-to-left`,this.navigationDirection=="right").append(`${t}--leave-to-right`,this.navigationDirection=="left").toString():""}},getAnimatedElement:e=>{var t;return(t=this.rootElement)===null||t===void 0?void 0:t.querySelector(`#${e.id}`)},isAnimationEnabled:()=>this.animationAllowed&&!!this.rootElement,getRerenderEvent:()=>this.onElementRerendered}}triggerResponsiveness(e){e&&(this.calculatedGapBetweenItems=void 0,this.calculatedItemWidth=void 0),super.triggerResponsiveness()}processResponsiveness(e,t){if(this._width=t,this.rootElement&&(!this.calculatedGapBetweenItems||!this.calculatedItemWidth)&&this.allowMultiple){const i=this.getFileListSelector()?this.rootElement.querySelector(this.getFileListSelector()):void 0;if(i){const r=i.querySelector(rs(this.cssClasses.page));if(r){const a=r.querySelector(rs(this.cssClasses.previewItem));this.calculatedGapBetweenItems=Math.ceil(Number.parseFloat(ge.getComputedStyle(r).gap)),a&&(this.calculatedItemWidth=Math.ceil(Number.parseFloat(ge.getComputedStyle(a).width)))}}}return this.calculatedGapBetweenItems&&this.calculatedItemWidth?(this.pageSize=Math.max(this.calcAvailableItemsCount(t,this.calculatedItemWidth,this.calculatedGapBetweenItems),1),!0):!1}canDragDrop(){return!this.isInputReadOnly&&this.currentMode!=="camera"&&!this.isPlayingVideo}afterRenderQuestionElement(e){super.afterRenderQuestionElement(e),this.rootElement=e}beforeDestroyQuestionElement(e){super.beforeDestroyQuestionElement(e),this.stopVideo(),this.rootElement=void 0}clearFilesCore(){if(this.rootElement){const e=this.rootElement.querySelectorAll("input")[0];e&&(e.value="")}this.clear()}doRemoveFile(e,t){if(t.stopPropagation(),this.needConfirmRemoveFile){Ga({message:this.getConfirmRemoveMessage(e.name),funcOnYes:()=>{this.removeFileCore(e)},locale:this.getLocale(),rootElement:this.survey.rootElement,cssClass:this.cssClasses.confirmDialog});return}this.removeFileCore(e)}removeFileCore(e){const t=this.previewValue.indexOf(e);this.removeFileByContent(t===-1?e:this.value[t])}dispose(){this.cameraValue=void 0,this.closeVideoStream(),super.dispose()}};S([E()],at.prototype,"isDragging",void 0),S([Nt({})],at.prototype,"previewValue",void 0),S([Nt({})],at.prototype,"pages",void 0),S([E({defaultValue:0,onSet:(n,e)=>{e.updateRenderedPages()}})],at.prototype,"indexToShow",void 0),S([E({defaultValue:1,onSet:(n,e)=>{e.updateFileNavigator()}})],at.prototype,"pageSize",void 0),S([E({defaultValue:!1})],at.prototype,"containsMultiplyFiles",void 0),S([E()],at.prototype,"allowCameraAccess",void 0),S([E({onSet:(n,e)=>{e.isLoadingFromJson||e.updateCurrentMode()}})],at.prototype,"sourceType",void 0),S([E()],at.prototype,"canFlipCameraValue",void 0),S([E({localizable:{defaultStr:"confirmRemoveFile"}})],at.prototype,"confirmRemoveMessage",void 0),S([E({localizable:{defaultStr:"confirmRemoveAllFiles"}})],at.prototype,"confirmRemoveAllMessage",void 0),S([E({localizable:{defaultStr:"noFileChosen"}})],at.prototype,"noFileChosenCaption",void 0),S([E({localizable:{defaultStr:"chooseFileCaption"}})],at.prototype,"chooseButtonCaption",void 0),S([E({localizable:{defaultStr:"replaceFileCaption"}})],at.prototype,"replaceButtonCaption",void 0),S([E({localizable:{defaultStr:"removeFileCaption"}})],at.prototype,"removeFileCaption",void 0),S([E({localizable:{defaultStr:"loadingFile"}})],at.prototype,"loadingFileTitle",void 0),S([E({localizable:{defaultStr:"chooseFile"}})],at.prototype,"chooseFileTitle",void 0),S([E({localizable:{defaultStr:"fileOrPhotoPlaceholder"}})],at.prototype,"fileOrPhotoPlaceholder",void 0),S([E({localizable:{defaultStr:"photoPlaceholder"}})],at.prototype,"photoPlaceholder",void 0),S([E({localizable:{defaultStr:"filePlaceholder"}})],at.prototype,"filePlaceholder",void 0),S([E()],at.prototype,"locRenderedPlaceholderValue",void 0),S([E()],at.prototype,"isClearingFiles",void 0),S([Nt()],at.prototype,"_renderedPages",void 0),q.addClass("file",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},{name:"showPreview:boolean",default:!0,visible:!1},"allowMultiple:boolean",{name:"allowImagesPreview:boolean",default:!0,dependsOn:"showPreview",visibleIf:n=>!!n.showPreview},"imageHeight","imageWidth","acceptedTypes",{name:"storeDataAsText:boolean",default:!0},{name:"waitForUpload:boolean",default:!1},{name:"maxSize:number",default:0},{name:"maxFiles:number",default:1e3,visibleIf:n=>n.allowMultiple},{name:"defaultValue",visible:!1},{name:"correctAnswer",visible:!1},{name:"validators",visible:!1},{name:"needConfirmRemoveFile:boolean"},{name:"sourceType",choices:["file","camera","file-camera"],default:"file",category:"general",visible:!0},{name:"fileOrPhotoPlaceholder:text",serializationProperty:"locFileOrPhotoPlaceholder",category:"general"},{name:"photoPlaceholder:text",serializationProperty:"locPhotoPlaceholder",category:"general"},{name:"filePlaceholder:text",serializationProperty:"locFilePlaceholder",category:"general"},{name:"allowCameraAccess:switch",category:"general",visible:!1}],function(){return new at("")},"question"),qe.Instance.registerQuestion("file",n=>new at(n));let nv=class{constructor(e,t){this.fileQuestion=e,this.callback=t,this.loaded=[]}load(e){let t=0;this.loaded=new Array(e.length),e.forEach((s,i)=>{this.fileQuestion.survey&&this.fileQuestion.survey.downloadFile(this.fileQuestion,this.fileQuestion.name,s,(r,a)=>{!this.fileQuestion||!this.callback||(r!=="error"?(this.loaded[i]={content:a,name:s.name,type:s.type},t++,t===e.length&&this.callback(r,this.loaded)):this.callback("error",this.loaded))})})}dispose(){this.fileQuestion=void 0,this.callback=void 0}},av=class extends ah{constructor(e){super(e),this.createLocalizableString("html").onGetTextCallback=t=>this.survey&&!this.ignoreHtmlProgressing?this.processHtml(t):t}getType(){return"html"}get isCompositeQuestion(){return!0}getProcessedText(e){return this.ignoreHtmlProgressing?e:super.getProcessedText(e)}get html(){return this.getLocalizableStringText("html","")}set html(e){this.setLocalizableStringText("html",e)}get locHtml(){return this.getLocalizableString("html")}get processedHtml(){return this.processHtml(this.html)}processHtml(e){return this.survey?this.survey.processHtml(e,"html-question"):this.html}get isNewA11yStructure(){return!0}get renderCssRoot(){return new z().append(this.cssClasses.root).append(this.cssClasses.nested,this.getIsNested()).toString()||void 0}};q.addClass("html",[{name:"html:html",serializationProperty:"locHtml"},{name:"showNumber",visible:!1},{name:"state",visible:!1},{name:"titleLocation",visible:!1},{name:"descriptionLocation",visible:!1},{name:"errorLocation",visible:!1},{name:"indent",visible:!1},{name:"width",visible:!1}],function(){return new av("")},"nonvalue"),qe.Instance.registerQuestion("html",n=>new av(n));let ov=class extends po{constructor(e){super(e)}getDefaultItemComponent(){return"survey-radiogroup-item"}getType(){return"radiogroup"}supportElementsInChoice(){return!0}getFirstInputElementId(){return this.inputId+"_0"}get selectedItem(){return this.getSingleSelectedItem()}get allowClear(){return this.getPropertyValue("allowClear")}set allowClear(e){this.setPropertyValue("allowClear",e)}get showClearButton(){return this.allowClear}set showClearButton(e){this.allowClear=e}get canShowClearButton(){return this.allowClear&&!this.isReadOnly}get clearButtonCaption(){return this.getLocalizationString("clearCaption")}supportAutoAdvance(){var e;return this.isMouseDown===!0&&!(!((e=this.selectedItem)===null||e===void 0)&&e.showCommentArea)}getConditionJson(e=null,t=null){const s=super.getConditionJson(e,t);return delete s.allowClear,delete s.showClearButton,s}setNewComment(e){this.isMouseDown=!0,super.setNewComment(e),this.isMouseDown=!1}clickItemHandler(e){this.selectItem(e)}isOtherValueUnused(){var e;return!(!((e=this.selectedItem)===null||e===void 0)&&e.showCommentArea)}getDefaultTitleActions(){const e=[];if(!this.isDesignMode){const t=new Pe({locTitleName:"clearCaption",id:`sv-clr-btn-${this.id}`,action:()=>{this.clearValueFromUI()},innerCss:this.cssClasses.clearButton,visible:new We(()=>this.canShowClearButton)});e.push(t)}return e}get isNewA11yStructure(){return!0}get a11y_input_ariaRole(){return"radiogroup"}};q.addClass("radiogroup",[{name:"allowClear:boolean",alternativeName:"showClearButton"},{name:"separateSpecialChoices",visible:!0},{name:"itemComponent",visible:!1,default:"survey-radiogroup-item"}],function(){return new ov("")},"checkboxbase"),qe.Instance.registerQuestion("radiogroup",n=>{var e=new ov(n);return e.choices=qe.DefaultChoices,e});function lv(n){if(typeof getComputedStyle=="function"){const e=getComputedStyle(ge.getDocumentElement());return e.getPropertyValue&&e.getPropertyValue(n)}return""}function Sr(n,e,t){let s=!!n&&n[e];if(s||(s=lv(t)),!s)return null;const i=ge.createElement("canvas");if(!i)return null;var r=i.getContext("2d");r.fillStyle=s,r.fillStyle=="#000000"&&(r.fillStyle=lv(t));const a=r.fillStyle;if(a.startsWith("rgba"))return a.substring(5,a.length-1).split(",").map(l=>+l.trim());var o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return o?[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16),1]:null}let Ir=class extends Te{onStringChangedCallback(){this.text=this.itemValue.text}get value(){return this.itemValue.getPropertyValue("value")}get locText(){return this.locString||this.itemValue.locText}constructor(e,t=null){super(),this.itemValue=e,this.locString=t,this.locText.onStringChanged.add(this.onStringChangedCallback.bind(this)),this.onStringChangedCallback()}};S([E({defaultValue:""})],Ir.prototype,"highlight",void 0),S([E({defaultValue:""})],Ir.prototype,"text",void 0),S([E()],Ir.prototype,"style",void 0);let fS=class extends Ce{constructor(e,t,s){super(e,t),this.description=s}},Cs=class ss extends Dt{constructor(e){super(e),this.iCounter=0,this.createItemValues("rateValues"),this.createLocString({name:"ratingOptionsCaption",hasTranslation:!0}),this.registerFunctionOnPropertiesValueChanged(["rateMin","rateMax","minRateDescription","maxRateDescription","rateStep","displayRateDescriptionsAsExtremeItems"],()=>this.resetRenderedItems()),this.registerFunctionOnPropertiesValueChanged(["rateType"],()=>{this.setIconsToRateValues(),this.resetRenderedItems(),this.updateRateCount()}),this.registerFunctionOnPropertiesValueChanged(["rateValues"],()=>{this.setIconsToRateValues(),this.resetRenderedItems()}),this.registerSychProperties(["rateValues"],()=>{this.autoGenerate=this.rateValues.length==0,this.setIconsToRateValues(),this.resetRenderedItems()}),this.registerFunctionOnPropertiesValueChanged(["rateColorMode","scaleColorMode"],()=>{this.updateColors(this.survey.themeVariables)}),this.registerFunctionOnPropertiesValueChanged(["displayMode"],()=>{this.updateRenderAsBasedOnDisplayMode(!0)}),this.registerSychProperties(["autoGenerate"],()=>{!this.autoGenerate&&this.rateValues.length===0&&this.setPropertyValue("rateValues",this.visibleRateValues),this.autoGenerate&&(this.rateValues.splice(0,this.rateValues.length),this.updateRateMax()),this.resetRenderedItems()}),this.createLocalizableString("minRateDescription",this,!0).onStringChanged.add((t,s)=>{this.setPropertyValue("hasMinRateDescription",!t.isEmpty)}),this.createLocalizableString("maxRateDescription",this,!0).onStringChanged.add((t,s)=>{this.setPropertyValue("hasMaxRateDescription",!t.isEmpty)}),this.createLocalizableString("readOnlyText",this,!0),this.registerPropertyChangedHandlers(["value","renderAs","placeholder","choices","visibleChoices"],()=>{this.updateReadOnlyText()}),this.updateReadOnlyText(),this.initPropertyDependencies()}setIconsToRateValues(){this.rateType=="smileys"&&this.rateValues.map(e=>e.icon=this.getItemSmiley(e))}locStrsChanged(){var e;super.locStrsChanged(),this.updateReadOnlyText(),(e=this.dropdownListModelValue)===null||e===void 0||e.locStrsChanged()}updateReadOnlyText(){this.readOnlyText=this.displayValue||this.placeholder}endLoadingFromJson(){super.endLoadingFromJson(),this.jsonObj.rateMin!==void 0&&this.jsonObj.rateCount!==void 0&&this.jsonObj.rateMax===void 0&&this.updateRateMax(),this.jsonObj.rateMax!==void 0&&this.jsonObj.rateCount!==void 0&&this.jsonObj.rateMin===void 0&&this.updateRateMin(),this.jsonObj.autoGenerate===void 0&&this.jsonObj.rateValues!==void 0&&(this.autoGenerate=!this.jsonObj.rateValues.length),this.updateRateCount(),this.setIconsToRateValues()}useRateValues(){return!!this.rateValues.length&&!this.autoGenerate}updateRateMax(){this.rateMax=this.rateMin+this.rateStep*(this.rateCount-1)}updateRateMin(){this.rateMin=this.rateMax-this.rateStep*(this.rateCount-1)}updateRateCount(){let e=0;this.useRateValues()?e=this.rateValues.length:e=Math.trunc((this.rateMax-this.rateMin)/(this.rateStep||1))+1,e>10&&this.rateType=="smileys"&&(e=10),this.rateCount=e,this.rateValues.length>e&&this.rateValues.splice(e,this.rateValues.length-e)}initPropertyDependencies(){this.registerSychProperties(["rateCount"],()=>{if(!this.useRateValues())this.rateMax=this.rateMin+this.rateStep*(this.rateCount-1);else if(this.rateCount<this.rateValues.length){if(this.rateCount>=10&&this.rateType=="smileys")return;this.rateValues.splice(this.rateCount,this.rateValues.length-this.rateCount)}else for(let e=this.rateValues.length;e<this.rateCount;e++)this.rateValues.push(new Ce(Ct("choices_Item")+(e+1)))}),this.registerSychProperties(["rateMin","rateMax","rateStep","rateValues"],()=>{this.updateRateCount()})}get showSelectedItemLocText(){return!this.readOnly&&!this.inputHasValue&&!!this.selectedItemLocText}get selectedItemLocText(){var e;return!this.readOnly&&((e=this.visibleRateValues.filter(t=>t.value==this.value)[0])===null||e===void 0?void 0:e.locText)}get rateValues(){return this.getPropertyValue("rateValues")}set rateValues(e){this.setPropertyValue("rateValues",e)}selectItem(e){!this.isReadOnly&&e&&(this.value=e.value)}get rateMin(){return this.getPropertyValue("rateMin")}set rateMin(e){this.setPropertyValue("rateMin",e)}get rateMax(){return this.getPropertyValue("rateMax")}set rateMax(e){this.setPropertyValue("rateMax",e)}get rateStep(){return this.getPropertyValue("rateStep")}set rateStep(e){this.setPropertyValue("rateStep",e)}updateColors(e){this.colorMode!=="monochrome"&&ge.isAvailable()&&(ss.colorsCalculated||(ss.badColor=Sr(e,"--sjs-special-red","--sd-rating-bad-color"),ss.normalColor=Sr(e,"--sjs-special-yellow","--sd-rating-normal-color"),ss.goodColor=Sr(e,"--sjs-special-green","--sd-rating-good-color"),ss.badColorLight=Sr(e,"--sjs-special-red-light","--sd-rating-bad-color-light"),ss.normalColorLight=Sr(e,"--sjs-special-yellow-light","--sd-rating-normal-color-light"),ss.goodColorLight=Sr(e,"--sjs-special-green-light","--sd-rating-good-color-light"),this.colorsCalculated=!0,this.resetRenderedItems()))}getDisplayValueCore(e,t){if(!this.useRateValues)return super.getDisplayValueCore(e,t);var s=Ce.getTextOrHtmlByValue(this.visibleRateValues,t);return s||t}get visibleRateValues(){return this.renderedRateItems.map(e=>e.itemValue)}supportEmptyValidation(){return this.renderAs==="dropdown"}itemValuePropertyChanged(e,t,s,i){!this.useRateValues()&&i!==void 0&&(this.autoGenerate=!1),super.itemValuePropertyChanged(e,t,s,i)}runConditionCore(e){super.runConditionCore(e),this.runRateItesmCondition(e)}runRateItesmCondition(e){var t;if(!this.useRateValues())return;let s=!1;if(!((t=this.survey)===null||t===void 0)&&t.areInvisibleElementsShowing?this.rateValues.forEach(i=>{s=s||!i.isVisible,i.setIsVisible(i,!0)}):s=Ce.runConditionsForItems(this.rateValues,void 0,void 0,e,!0),s&&(this.resetRenderedItems(),!this.isEmpty()&&!this.isReadOnly)){const i=Ce.getItemByValue(this.rateValues,this.value);i&&!i.isVisible&&this.clearValue()}}getRateValuesCore(){if(!this.useRateValues())return this.createRateValues();const e=new Array;return this.rateValues.forEach(t=>{t.isVisible&&e.push(t)}),e}calculateRateValues(){let e=this.getRateValuesCore();return this.rateType=="smileys"&&e.length>10&&(e=e.slice(0,10)),e}calculateRenderedRateItems(){const e=this.calculateRateValues();return e.map((t,s)=>{let i=null;return this.displayRateDescriptionsAsExtremeItems&&(s==0&&(i=new Ir(t,this.minRateDescription&&this.locMinRateDescription||t.locText)),s==e.length-1&&(i=new Ir(t,this.maxRateDescription&&this.locMaxRateDescription||t.locText))),i||(i=new Ir(t)),i})}calculateVisibleChoices(){return this.calculateRateValues().map((t,s)=>this.getRatingItemValue(t,s))}resetRenderedItems(){if(this.autoGenerate){const e=this.getRateValuesCore();this.rateMax=e[e.length-1].value}Array.isArray(this.getPropertyValueWithoutDefault("renderedRateItems"))&&this.setArrayPropertyDirectly("renderedRateItems",this.calculateRenderedRateItems()),Array.isArray(this.getPropertyValueWithoutDefault("visibleChoices"))&&this.setArrayPropertyDirectly("visibleChoices",this.calculateVisibleChoices)}get renderedRateItems(){return this.getPropertyValue("renderedRateItems",void 0,()=>this.calculateRenderedRateItems())}get visibleChoices(){return this.getPropertyValue("visibleChoices",void 0,()=>this.calculateVisibleChoices())}createRateValues(){for(var e=[],t=this.rateMin,s=this.rateStep;t<=this.rateMax&&e.length<A.ratingMaximumRateValueCount;){let i=new Ce(t);i.locOwner=this,i.ownerPropertyName="rateValues",e.push(i),t=this.correctValue(t+s,s)}return e}getRatingItemValue(e,t){if(!e)return null;const s=e.value;let i;t===0&&(i=this.minRateDescription&&this.locMinRateDescription),t===this.rateCount-1&&(i=this.maxRateDescription&&this.locMaxRateDescription);let r=new fS(s,e.text,i);return r.locOwner=e.locOwner,r.ownerPropertyName=e.ownerPropertyName,r}correctValue(e,t){if(!e||Math.round(e)==e)return e;for(var s=0;Math.round(t)!=t;)t*=10,s++;return parseFloat(e.toFixed(s))}getType(){return"rating"}getFirstInputElementId(){return this.inputId+"_0"}getInputId(e){return this.inputId+"_"+e}get questionName(){return this.name+"_"+this.id}supportAutoAdvance(){return this.isMouseDown===!0||this.renderAs==="dropdown"}supportOther(){return!1}getPlainDataCalculatedValue(e){const t=super.getPlainDataCalculatedValue(e);if(t!==void 0||!this.useRateValues||this.isEmpty())return t;const s=Ce.getItemByValue(this.visibleRateValues,this.value);return s?s[e]:void 0}get minRateDescription(){return this.getLocalizableStringText("minRateDescription")}set minRateDescription(e){this.setLocalizableStringText("minRateDescription",e)}get locMinRateDescription(){return this.getLocalizableString("minRateDescription")}get maxRateDescription(){return this.getLocalizableStringText("maxRateDescription")}set maxRateDescription(e){this.setLocalizableStringText("maxRateDescription",e)}get locMaxRateDescription(){return this.getLocalizableString("maxRateDescription")}get hasMinRateDescription(){return this.getPropertyValue("hasMinRateDescription",void 0,()=>!!this.minRateDescription)}get hasMaxRateDescription(){return this.getPropertyValue("hasMaxRateDescription",void 0,()=>!!this.maxRateDescription)}get hasMinLabel(){return!this.displayRateDescriptionsAsExtremeItems&&!!this.hasMinRateDescription}get hasMaxLabel(){return!this.displayRateDescriptionsAsExtremeItems&&!!this.hasMaxRateDescription}updateRenderAsBasedOnDisplayMode(e){this.isDesignMode?(e||this.renderAs==="dropdown")&&(this.renderAs="default"):(e||this.displayMode!=="auto")&&(this.renderAs=this.displayMode==="dropdown"?"dropdown":"default")}onSurveyLoad(){super.onSurveyLoad(),this.renderAs==="dropdown"&&this.displayMode==="auto"?this.displayMode=this.renderAs:this.updateRenderAsBasedOnDisplayMode()}get rateDisplayMode(){return this.rateType}set rateDisplayMode(e){this.rateType=e}get isStar(){return this.rateType=="stars"}get isSmiley(){return this.rateType=="smileys"}getDefaultItemComponent(){return this.renderAs=="dropdown"?"sv-rating-dropdown-item":this.isStar?"sv-rating-item-star":this.isSmiley?"sv-rating-item-smiley":"sv-rating-item"}get itemComponent(){return this.getPropertyValue("itemComponent",this.getDefaultItemComponent())}set itemComponent(e){this.setPropertyValue("itemComponent",e)}valueToData(e){if(this.useRateValues()){var t=Ce.getItemByValue(this.rateValues,e);return t?t.value:e}return isNaN(e)?e:parseFloat(e)}setValueFromClick(e){if(!this.isReadOnlyAttr){this.value===(typeof this.value=="string"?e:parseFloat(e))?this.clearValue(!0):this.value=e;for(let t=0;t<this.renderedRateItems.length;t++)this.renderedRateItems[t].highlight="none"}}onItemMouseIn(e){if(ft||this.isReadOnly||!e.itemValue.isEnabled||this.isDesignMode)return;let t=!0,s=this.value!=null;if(this.rateType!=="stars"){e.highlight="highlighted";return}for(let i=0;i<this.renderedRateItems.length;i++)this.renderedRateItems[i].highlight=t&&!s&&"highlighted"||!t&&s&&"unhighlighted"||"none",this.renderedRateItems[i]==e&&(t=!1),this.renderedRateItems[i].itemValue.value==this.value&&(s=!1)}onItemMouseOut(e){ft||this.renderedRateItems.forEach(t=>t.highlight="none")}get itemSmallMode(){return!this.isSingleInputActive&&this.inMatrixMode&&A.matrix.rateSize=="small"}get ratingRootCss(){const e=this.hasMaxLabel||this.hasMinLabel;return new z().append(this.cssClasses.root).append(this.cssClasses.rootWrappable,this.displayMode=="buttons"||!!this.survey&&this.survey.isDesignMode||this.displayMode=="auto"&&!this.supportResponsiveness()).append(this.cssClasses.rootLabelsTop,e&&this.rateDescriptionLocation=="top").append(this.cssClasses.rootLabelsBottom,e&&this.rateDescriptionLocation=="bottom").append(this.cssClasses.rootLabelsDiagonal,e&&this.rateDescriptionLocation=="topBottom").append(this.cssClasses.itemSmall,this.itemSmallMode&&this.rateType!="labels").toString()}get itemStarIcon(){return this.itemSmallMode?"icon-rating-star-small":"icon-rating-star"}get itemStarIconAlt(){return this.itemStarIcon+"-2"}getItemSmiley(e){const t=["terrible","very-poor","poor","not-good","average","normal","good","very-good","excellent","perfect"],s=["very-good","not-good","normal","good","average","excellent","poor","perfect","very-poor","terrible"],i=this.useRateValues()?this.rateValues.length:this.rateMax-this.rateMin+1,r=s.slice(0,i),a=t.filter(o=>r.indexOf(o)!=-1);return this.useRateValues()?a[this.rateValues.indexOf(e)]:a[e.value-this.rateMin]}getItemSmileyIconName(e){return"icon-"+this.getItemSmiley(e)}getItemClassByText(e,t){return this.getItemClass(e)}getRenderedItemColor(e,t){let s=t?ss.badColorLight:ss.badColor,i=t?ss.goodColorLight:ss.goodColor;const r=(this.rateCount-1)/2,a=t?ss.normalColorLight:ss.normalColor;if(e<r?i=a:(s=a,e-=r),!s||!i)return null;const o=[0,0,0,0];for(let l=0;l<4;l++)o[l]=s[l]+(i[l]-s[l])*e/r,l<3&&(o[l]=Math.trunc(o[l]));return"rgba("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")"}getItemStyle(e,t="none"){if(this.scaleColorMode==="monochrome"&&this.rateColorMode=="default"||this.isPreviewStyle||this.isReadOnlyStyle)return{};const s=this.visibleRateValues.indexOf(e),i=this.getRenderedItemColor(s,!1),r=t=="highlighted"&&this.scaleColorMode==="colored"&&this.getRenderedItemColor(s,!0);return r?{"--sd-rating-item-color":i,"--sd-rating-item-color-light":r}:{"--sd-rating-item-color":i}}getItemClass(e,t="none"){let s=this.value==e.value;this.isStar&&(this.useRateValues()?s=this.rateValues.indexOf(this.rateValues.filter(ie=>ie.value==this.value)[0])>=this.rateValues.indexOf(e):s=this.value>=e.value);const r=!(this.isReadOnly||!e.isEnabled)&&this.value!=e.value&&!(this.survey&&this.survey.isDesignMode),a=this.renderedRateItems.filter(ie=>ie.itemValue==e)[0],o=this.isStar&&a?.highlight=="highlighted",l=this.isStar&&a?.highlight=="unhighlighted";let u=this.cssClasses.item,d=this.cssClasses.selected,h=this.cssClasses.itemDisabled,f=this.cssClasses.itemReadOnly,C=this.cssClasses.itemPreview,b=this.cssClasses.itemHover,x=this.cssClasses.itemOnError,V=null,P=null,M=null,X=null,N=null;this.isStar&&(u=this.cssClasses.itemStar,d=this.cssClasses.itemStarSelected,h=this.cssClasses.itemStarDisabled,f=this.cssClasses.itemStarReadOnly,C=this.cssClasses.itemStarPreview,b=this.cssClasses.itemStarHover,x=this.cssClasses.itemStarOnError,V=this.cssClasses.itemStarHighlighted,P=this.cssClasses.itemStarUnhighlighted,N=this.cssClasses.itemStarSmall),this.isSmiley&&(u=this.cssClasses.itemSmiley,d=this.cssClasses.itemSmileySelected,h=this.cssClasses.itemSmileyDisabled,f=this.cssClasses.itemSmileyReadOnly,C=this.cssClasses.itemSmileyPreview,b=this.cssClasses.itemSmileyHover,x=this.cssClasses.itemSmileyOnError,V=this.cssClasses.itemSmileyHighlighted,M=this.cssClasses.itemSmileyScaleColored,X=this.cssClasses.itemSmileyRateColored,N=this.cssClasses.itemSmileySmall);const W=!this.isStar&&!this.isSmiley&&(!this.displayRateDescriptionsAsExtremeItems||this.useRateValues()&&e!=this.rateValues[0]&&e!=this.rateValues[this.rateValues.length-1]||!this.useRateValues()&&e.value!=this.rateMin&&e.value!=this.rateMax)&&e.locText.calculatedText.length<=2&&Number.isInteger(Number(e.locText.calculatedText)),J={item:e,css:""};return J.css=new z().append(u).append(d,s).append(h,this.isDisabledStyle).append(f,this.isReadOnlyStyle).append(C,this.isPreviewStyle).append(b,r).append(V,o).append(M,this.scaleColorMode=="colored").append(X,this.rateColorMode=="scale"&&s).append(P,l).append(x,this.hasCssError()).append(N,this.itemSmallMode).append(this.cssClasses.itemFixedSize,W).toString(),this.survey&&this.survey.updateChoiceItemCss(this,J),J.css}getControlClass(){return this.isEmpty(),new z().append(this.cssClasses.control).append(this.cssClasses.controlEmpty,this.isEmpty()).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle).toString()}get placeholder(){return this.getLocalizableStringText("ratingOptionsCaption")}set placeholder(e){this.setLocalizableStringText("ratingOptionsCaption",e)}get locPlaceholder(){return this.getLocalizableString("ratingOptionsCaption")}get allowClear(){return!0}get searchEnabled(){return!1}get renderedValue(){return this.value}set renderedValue(e){this.value=e}isItemSelected(e){return e.value==this.value}get readOnlyText(){return this.getLocalizableStringText("readOnlyText")}set readOnlyText(e){this.setLocalizableStringText("readOnlyText",e)}get locReadOnlyText(){return this.getLocalizableString("readOnlyText")}needResponsiveWidth(){this.getPropertyValue("rateValues");const e=this.getPropertyValue("rateStep"),t=this.getPropertyValue("rateMax"),s=this.getPropertyValue("rateMin");return this.displayMode!="dropdown"&&!!(this.hasMinRateDescription||this.hasMaxRateDescription||e&&(t-s)/e>9)}supportResponsiveness(){return!this.inMatrixMode}onBeforeSetCompactRenderer(){!this.isDisposed&&!this.dropdownListModelValue&&(this.dropdownListModelValue=new Ut(this))}getCompactRenderAs(){return this.displayMode=="buttons"?"default":"dropdown"}getDesktopRenderAs(){return this.displayMode=="dropdown"?"dropdown":"default"}set dropdownListModel(e){this.dropdownListModelValue=e,this.updateElementCss()}get dropdownListModel(){return this.renderAs==="dropdown"&&this.onBeforeSetCompactRenderer(),this.dropdownListModelValue}onBlurCore(e){var t;(t=this.dropdownListModel)===null||t===void 0||t.onBlur(e),super.onBlurCore(e)}updateCssClasses(e,t){super.updateCssClasses(e,t),Xa(e,t)}calcCssClasses(e){const t=super.calcCssClasses(e);return this.dropdownListModelValue&&this.dropdownListModelValue.updateCssClasses(t.popup,t.list),t}themeChanged(e){this.colorsCalculated=!1,this.updateColors(e.cssVariables)}setSurveyImpl(e,t){super.setSurveyImpl(e,t),this.survey&&(this.updateColors(this.survey.themeVariables),this.updateRenderAsBasedOnDisplayMode())}dispose(){super.dispose(),this.dropdownListModelValue&&(this.dropdownListModelValue.dispose(),this.dropdownListModelValue=void 0)}get a11yInputAriaRole(){return this.renderAs==="dropdown"?"combobox":null}get isNewA11yStructure(){return!0}get a11y_input_ariaRole(){return"radiogroup"}};Cs.colorsCalculated=!1,S([E({defaultValue:!1})],Cs.prototype,"inputHasValue",void 0),S([E()],Cs.prototype,"autoGenerate",void 0),S([E()],Cs.prototype,"rateCount",void 0),S([E()],Cs.prototype,"displayRateDescriptionsAsExtremeItems",void 0),S([E()],Cs.prototype,"displayMode",void 0),S([E()],Cs.prototype,"rateDescriptionLocation",void 0),S([E()],Cs.prototype,"rateType",void 0),S([E()],Cs.prototype,"scaleColorMode",void 0),S([E()],Cs.prototype,"rateColorMode",void 0),q.addClass("rating",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},{name:"rateType",alternativeName:"rateDisplayMode",default:"labels",category:"rateValues",choices:["labels","stars","smileys"],visibleIndex:1},{name:"scaleColorMode",category:"rateValues",default:"monochrome",choices:["monochrome","colored"],visibleIf:function(n){return n.rateType=="smileys"},visibleIndex:2},{name:"rateColorMode",category:"rateValues",default:"scale",choices:["default","scale"],visibleIf:function(n){return n.rateType=="smileys"&&n.scaleColorMode=="monochrome"},visibleIndex:3},{name:"autoGenerate",category:"rateValues",default:!0,choices:[!0,!1],visibleIndex:5},{name:"rateCount:number",default:5,category:"rateValues",visibleIndex:4,onSettingValue:(n,e)=>e<2?2:e>A.ratingMaximumRateValueCount&&e>n.rateValues.length?A.ratingMaximumRateValueCount:e>10&&n.rateType=="smileys"?10:e},{name:"rateValues:itemvalue[]",baseValue:function(){return Ct("choices_Item")},category:"rateValues",visibleIf:function(n){return!n.autoGenerate},visibleIndex:6},{name:"rateMin:number",default:1,onSettingValue:(n,e)=>e>n.rateMax-n.rateStep?n.rateMax-n.rateStep:e,visibleIf:function(n){return!!n.autoGenerate},visibleIndex:7},{name:"rateMax:number",default:5,onSettingValue:(n,e)=>e<n.rateMin+n.rateStep?n.rateMin+n.rateStep:e,visibleIf:function(n){return!!n.autoGenerate},visibleIndex:8},{name:"rateStep:number",default:1,minValue:.1,onSettingValue:(n,e)=>(e<=0&&(e=1),e>n.rateMax-n.rateMin&&(e=n.rateMax-n.rateMin),e),visibleIf:function(n){return!!n.autoGenerate},visibleIndex:9},{name:"minRateDescription",alternativeName:"mininumRateDescription",serializationProperty:"locMinRateDescription",visibleIndex:18},{name:"maxRateDescription",alternativeName:"maximumRateDescription",serializationProperty:"locMaxRateDescription",visibleIndex:19},{name:"displayRateDescriptionsAsExtremeItems:boolean",default:!1,visibleIndex:21,visibleIf:function(n){return n.rateType=="labels"}},{name:"rateDescriptionLocation",default:"leftRight",choices:["leftRight","top","bottom","topBottom"],visibleIndex:20},{name:"displayMode",default:"auto",choices:["auto","buttons","dropdown"],visibleIndex:0},{name:"itemComponent",visible:!1,defaultFunc:n=>n?(n.getOriginalObj&&(n=n.getOriginalObj()),n.getDefaultItemComponent()):"sv-rating-item"}],function(){return new Cs("")},"question"),qe.Instance.registerQuestion("rating",n=>new Cs(n));let uv=class extends Ce{getBaseType(){return"sliderlabel"}onGetText(e){return e||!this.locOwner?super.onGetText(e):this.locOwner.getTextByItem(this)}getCorrectValue(e){return typeof e=="number"?e:O.isNumber(e)?parseFloat(e.toString()):this.value||0}get showValue(){return this.getPropertyValue("showValue",!1)}set showValue(e){this.setPropertyValue("showValue",e)}},Pt=class extends Dt{get step(){return this.getPropertyValue("step")}set step(e){this.setPropertyValue("step",e)}get labelCount(){return this.customLabels.length>0?this.customLabels.length:this.tickSize?Math.round(100/this.tickSize)+2:this.getPropertyValue("labelCount")}set labelCount(e){this.setPropertyValue("labelCount",e)}get customLabels(){return this.getPropertyValue("customLabels")}set customLabels(e){this.setPropertyValue("customLabels",e)}get allowSwap(){return this.minRangeLength?!1:this.getPropertyValue("allowSwap",!0)}set allowSwap(e){this.setPropertyValue("allowSwap",e)}constructor(e){super(e),this.getThumbContainerCss=t=>new z().append(this.cssClasses.thumbContainer).append(this.cssClasses.thumbContainerIndeterminateMode,!!this.isIndeterminate).append(this.cssClasses.thumbContainerFocusedMode,t===this.focusedThumb).toString(),this.getLabelCss=t=>new z().append(this.cssClasses.label).append(this.cssClasses.labelLongMod,t.renderedHtml.length>10).toString(),this.isIndeterminate=!1,this.getTrackPercentLeft=()=>{const{renderedValue:t,sliderType:s,renderedMin:i}=this;let r;return s==="single"?t[0]>0?r=this.getPercent(Math.max(0,i)):r=this.getPercent(t[0]):r=this.getPercent(Math.min(...t)),r},this.getTrackPercentRight=()=>{const{renderedValue:t,sliderType:s,renderedMax:i}=this;let r;return s==="single"?t[0]>0?r=this.getPercent(t[0]):r=this.getPercent(Math.min(0,i)):r=this.getPercent(Math.max(...t)),100-r},this.getPercent=t=>{const{renderedMax:s,renderedMin:i}=this,r=s-i;return Math.abs(t-i)/r*100},this.ensureMaxRangeBorders=(t,s)=>{const{renderedMaxRangeLength:i,renderedValue:r}=this,a=r.slice(),o=a[s];let l=!1;a[s]=t;for(let u=0;u<a.length-1;u++)if(Math.abs(a[u]-a[u+1])>i){l=!0;break}return l?o:t},this.ensureMinRangeBorders=(t,s)=>{const{renderedMinRangeLength:i,renderedValue:r,allowSwap:a,renderedMin:o,renderedMax:l}=this,u=r.slice(),d=u[s];let h=!1;u[s]=t;for(let f=0;f<u.length-1;f++)if(Math.abs(u[f]-u[f+1])<i){h=!0;break}if(!a){const f=s>0?u[s-1]:o,C=s<u.length-1?u[s+1]:l;(t<=f||t>=C)&&(h=!0)}return h?d:t},this.getClosestToStepValue=t=>{const{step:s,renderedMin:i,renderedMax:r}=this,a=i+Math.trunc((r-i)/s)*s;let o=i+Math.round((t-i)/s)*s;return o=Math.min(a,o),o},this.handleRangeOnChange=t=>{if(!this.isRangeMoving||!this.isAllowToChange())return;const{renderedMax:s,renderedMin:i,renderedValue:r,ensureMaxRangeBorders:a,ensureMinRangeBorders:o}=this,l=t.target,u=this.oldInputValue-+l.value;this.oldInputValue=+l.value;let d=!1;for(let h=0;h<r.length;h++){let f=r[h]-u;f=a(f,h),f=o(f,h),f<=s&&f>=i?r.splice(h,1,f):d=!0}if(d){d=!1;return}},this.prepareInputRangeForMoving=(t,s)=>{const{renderedMax:i,renderedMin:r}=this;this.isRangeMoving=!0,this.animatedThumb=!1;const a=t.target;a.style.setProperty("--sjs-range-slider-range-input-thumb-width","20px"),a.style.setProperty("--sjs-range-slider-range-input-thumb-left","initial"),a.style.setProperty("--sjs-range-slider-range-input-thumb-position","static");const l=(t.clientX-s.getBoundingClientRect().x)/s.getBoundingClientRect().width*100/100*(i-r)+r;a.value=""+l,this.oldInputValue=l},this.handleRangePointerDown=(t,s)=>{const{dragOrClickHelper:i,allowDragRange:r,step:a,prepareInputRangeForMoving:o}=this,l=t.target;a&&(l.step="0.01"),r&&(i.dragHandler=()=>{o.call(this,t,s)},i.onPointerDown(t))},this.handleRangePointerUp=(t,s)=>{const{step:i,renderedValue:r,getClosestToStepValue:a}=this,o=t.target;if(this.isRangeMoving){if(this.refreshInputRange(),this.isRangeMoving=!1,i){o.step=""+i;for(let l=0;l<r.length;l++)r[l]=a(r[l]);this.setSliderValue(r)}return}o.style.setProperty("--sjs-range-slider-range-input-thumb-width","0px"),o.style.setProperty("--sjs-range-slider-range-input-thumb-left","initial"),o.style.setProperty("--sjs-range-slider-range-input-thumb-position","static"),this.setValueByClickOnPath(t,s)},this.refreshInputRange=t=>{const{allowDragRange:s,renderedValue:i,getPercent:r}=this;if(!s)return;const a=t||ge.getDocument().getElementById(this.id+"-sjs-slider-input-range-input");if(!a)return;const o=r(i[i.length-1]),l=r(i[0]);let u=o-l;a.style.setProperty("--sjs-range-slider-range-input-thumb-width",`calc(${u}% - 20px - 20px)`),a.style.setProperty("--sjs-range-slider-range-input-thumb-left",`calc(${l}% + 20px)`),a.style.setProperty("--sjs-range-slider-range-input-thumb-position","absolute")},this.setSliderValue=t=>{if(this.isAllowToChange()){let s;this.sliderType==="single"?s=Array.isArray(t)?t[0]:t:this.sliderType==="range"&&(s=t),this.value=s,this.resetPropertyValue("renderedValue")}},this.setValueByClickOnPath=(t,s)=>{const{renderedMax:i,renderedMin:r}=this;let a=ge.getComputedStyle(ge.getBody()).direction=="rtl",o=(t.clientX-s.getBoundingClientRect().x)/s.getBoundingClientRect().width*100;a&&(o=100-o);let l=o/100*(i-r)+r;this.setValueByClick(l,t.target)},this.setValueByClick=(t,s)=>{const{step:i,getClosestToStepValue:r,ensureMaxRangeBorders:a,ensureMinRangeBorders:o,renderedValue:l,refreshInputRange:u,setSliderValue:d}=this;this.animatedThumb=!0;const h=l.slice();let f=0;for(let C=0;C<h.length;C++){const b=Math.abs(h[f]-t);Math.abs(h[C]-t)<b&&(f=C)}if(h.length>1&&(t=a(t,f),t=o(t,f)),h[f]=t,i){const C=l.slice();for(let b=0;b<h.length;b++){const x=C[b]/i,V=h[b]/i;Math.round(V)===x&&(V>x?h[b]=h[b]+i:V<x&&(h[b]=h[b]-i)),h[b]=r(h[b])}}d(h),u()},this.handleOnChange=(t,s)=>{if(!this.isAllowToChange()||this.oldValue===null)return;const{allowSwap:i,ensureMaxRangeBorders:r,ensureMinRangeBorders:a,renderedValue:o}=this;let u=+t.target.value;o.length>1&&(u=r(u,s),i||(u=a(u,s))),o.splice(s,1,u)},this.handlePointerDown=t=>{const{step:s,renderedValue:i}=this;if(s)for(let r=0;r<i.length;r++){const a=ge.getDocument().getElementById(this.id+`-sjs-slider-input-${r}`);a.step=.01}this.oldValue=this.renderedValue,this.animatedThumb=!1},this.handlePointerUp=t=>{t.stopPropagation();const{step:s,focusedThumb:i,renderedValue:r,allowSwap:a,renderedMinRangeLength:o,getClosestToStepValue:l,refreshInputRange:u,setSliderValue:d}=this,h=r[i];if(t.target,r.sort((f,C)=>f-C),this.focusedThumb=r.indexOf(h),s)for(let f=0;f<r.length;f++){r[f]=l(r[f]);const C=ge.getDocument().getElementById(this.id+`-sjs-slider-input-${f}`);C.step=s}if(a){for(let f=0;f<r.length-1;f++)if(Math.abs(r[f]-r[f+1])<o){this.setPropertyValue("renderedValue",this.oldValue);break}}d(r),u(),this.oldValue=null},this.handleKeyDown=t=>{this.oldValue=this.renderedValue,this.animatedThumb=!0},this.handleKeyUp=t=>{this.oldValue=null,this.setSliderValue(this.renderedValue)},this.handleOnFocus=t=>{this.focusedThumb=t},this.handleOnBlur=()=>{this.focusedThumb=null},this.handleLabelPointerUp=(t,s)=>{const i=t.target;isNaN(s)||this.setValueByClick(s,i)},this.getTooltipValue=t=>{const{step:s,getClosestToStepValue:i,renderedValue:r,tooltipFormat:a,formatNumber:o}=this;let l=r[t];return l=s?i(l):l,l=o(l),a.replace("{0}",""+l)},this.getLabelText=t=>{const{step:s,renderedMax:i,renderedMin:r,renderedLabelCount:a,formatNumber:o}=this,l=i-r,u=s%1!=0,d=a-1;let h=d===0?0:t*l/d;return u?""+o(h+r):""+Math.round(h+r)},this.getLabelPosition=t=>{const{max:s,min:i,renderedLabelCount:r,customLabels:a}=this,o=r-1;if(o===0)return 0;const l=s-i;return i+t*l/o},this.isRangeMoving=!1,this.oldInputValue=null,this.oldValue=null,this.calcRenderedValue=()=>{const{renderedMax:t,renderedMin:s,renderedMaxRangeLength:i,getClosestToStepValue:r,sliderType:a}=this;let o;if(a==="single")return o=this.ensureValueRespectMinMax(this.value),typeof o>"u"||o===null||o.length===0?(this.isIndeterminate=!0,this.isNegativeScale?[Math.min(t,0)]:[s]):Array.isArray(o)?[o[0]]:[o];if(o=Array.isArray(this.value)?this.value.slice():[],o.length===0){const l=t-s;if(this.isIndeterminate=!0,Math.abs(l)>i){const u=(l-i)/2;return[r(s+u),r(t-u)]}return[s,t]}return o.map(l=>this.ensureValueRespectMinMax(l))},this.createItemValues("customLabels"),this.dragOrClickHelper=new Xu(null,!1),this.initPropertyDependencies()}get generatedLabels(){return this.getPropertyValue("generatedLabels",void 0,()=>this.calcGeneratedLabels())}get renderedValue(){return this.getPropertyValue("renderedValue",void 0,()=>this.calcRenderedValue())}set renderedValue(e){this.setPropertyValue("renderedValue",e)}getType(){return"slider"}get rootCss(){return new z().append(this.cssClasses.root).append(this.cssClasses.rootSingleMode,this.sliderType==="single").append(this.cssClasses.rootNegativeScaleMode,!!this.isNegativeScale).append(this.cssClasses.rootDesignMode,!!this.isDesignMode).append(this.cssClasses.rootAnimatedThumbMode,!!this.animatedThumb).append(this.cssClasses.rootTooltipsAlwaysMode,this.tooltipVisibility==="always").append(this.cssClasses.rootLabelsShowValueTextMode,this.isLabelsShowValueText).toString()}get tooltipCss(){return new z().append(this.cssClasses.tooltip).append(this.cssClasses.tooltipOnHoverMode,this.tooltipVisibility==="auto").toString()}get renderedLabelCount(){return this.labelCount<0?6:this.labelCount}get renderedMax(){return this.max}get renderedMin(){return this.min}get renderedMaxRangeLength(){var e;return(e=this.maxRangeLength)!==null&&e!==void 0?e:this.renderedMax-this.renderedMin}get renderedMinRangeLength(){var e;return(e=this.minRangeLength)!==null&&e!==void 0?e:this.step}get renderedLabels(){const e=this.generatedLabels,t=this.customLabels;return this.autoGenerate?e:t}get isNegativeScale(){return this.renderedMin<0}getTextByItem(e){const t=e.value.toString();return this.labelFormat.replace("{0}",""+t)}endLoadingFromJson(){super.endLoadingFromJson(),this.jsonObj.customLabels!==void 0&&(this.autoGenerate=!1),!this.isDesignMode&&this.sliderType==="range"&&this.createNewArray("value")}updateValueFromSurvey(e,t){e=this.ensureValueRespectMinMax(e),super.updateValueFromSurvey(e,t),this.isIndeterminate&&(this.isIndeterminate=!1),this.resetPropertyValue("renderedValue")}runConditionCore(e){super.runConditionCore(e),this.runExpressionByProperty("maxValueExpression",e,t=>{this.max=t??this.renderedMax}),this.runExpressionByProperty("minValueExpression",e,t=>{this.min=t??this.renderedMin})}initPropertyDependencies(){this.registerFunctionOnPropertiesValueChanged(["min","max","step","autoGenerate","labelFormat","labelCount"],()=>{this.resetPropertyValue("generatedLabels"),this.locStrsChanged()}),this.registerSychProperties(["autoGenerate"],()=>{!this.autoGenerate&&this.customLabels.length===0&&this.setPropertyValue("customLabels",this.calcGeneratedLabels()),this.autoGenerate&&this.customLabels.splice(0,this.customLabels.length)}),this.registerFunctionOnPropertiesValueChanged(["min","max","step","maxRangeLength","minRangeLength","sliderType"],()=>{this.resetPropertyValue("renderedValue")})}setNewValue(e){e=this.ensureValueRespectMinMax(e),super.setNewValue(e),this.isIndeterminate&&(this.isIndeterminate=!1),this.resetPropertyValue("renderedValue")}setDefaultValue(){super.setDefaultValue();const e=this.defaultValue;this.sliderType==="single"&&Array.isArray(e)&&this.setSliderValue(e),this.resetPropertyValue("renderedValue")}getDefaultTitleActions(){const e=[];if(!this.isDesignMode){const t=new Pe({locTitleName:"clearCaption",id:`sv-clr-btn-${this.id}`,action:()=>{this.clearValueFromUI()},innerCss:this.cssClasses.clearButton,visible:new We(()=>this.allowClear&&!this.isReadOnly)});e.push(t)}return e}getItemValueType(){return"sliderlabel"}createLabelItem(e){const t=new uv(e);return t.locOwner=this,t}calcGeneratedLabels(){const e=[];for(let t=0;t<this.renderedLabelCount;t++)e.push(this.createLabelItem(this.getLabelPosition(t)));return e}formatNumber(e){return parseFloat(e.toFixed(4))}ensureValueRespectMinMax(e){return Array.isArray(e)?e.forEach((t,s,i)=>{t<this.min&&(e[s]=this.min),t>this.max&&(e[s]=this.max),s===0?(typeof t>"u"||t===null)&&(e[s]=this.min):s===i.length-1&&(typeof t>"u"||t===null)&&(e[s]=this.max)}):(e<this.min&&(e=this.min),e>this.max&&(e=this.max)),e}isAllowToChange(){return!this.isReadOnly&&!this.isDisabledAttr&&!this.isPreviewStyle&&!this.isDisabledStyle}get isLabelsShowValueText(){return!!this.customLabels.find(e=>e.showValue)}itemValuePropertyChanged(e,t,s,i){if(this.autoGenerate===!0){const r=this.generatedLabels.indexOf(e);this.autoGenerate=!1,this.setPropertyValue("customLabels",this.calcGeneratedLabels()),e=this.customLabels[r]}t==="text"&&(Number.isFinite(+i)?e.value=+i:e.text=i),super.itemValuePropertyChanged(e,t,s,i)}};S([E({defaultValue:"single"})],Pt.prototype,"sliderType",void 0),S([E({defaultValue:100})],Pt.prototype,"max",void 0),S([E({defaultValue:0})],Pt.prototype,"min",void 0),S([E({defaultValue:null})],Pt.prototype,"maxValueExpression",void 0),S([E({defaultValue:null})],Pt.prototype,"minValueExpression",void 0),S([E({defaultValue:null})],Pt.prototype,"maxRangeLength",void 0),S([E({defaultValue:null})],Pt.prototype,"minRangeLength",void 0),S([E({defaultValue:"{0}"})],Pt.prototype,"tooltipFormat",void 0),S([E({defaultValue:"{0}"})],Pt.prototype,"labelFormat",void 0),S([E({defaultValue:"auto"})],Pt.prototype,"tooltipVisibility",void 0),S([E({defaultValue:!0})],Pt.prototype,"showLabels",void 0),S([E({defaultValue:!0})],Pt.prototype,"autoGenerate",void 0),S([E({defaultValue:!0})],Pt.prototype,"allowDragRange",void 0),S([E({defaultValue:null})],Pt.prototype,"tickSize",void 0),S([E({defaultValue:!1})],Pt.prototype,"allowClear",void 0),S([E({defaultValue:null})],Pt.prototype,"focusedThumb",void 0),S([E({defaultValue:null})],Pt.prototype,"animatedThumb",void 0);function hv(n,e,t,s){let i=t?e:n;return n>=e?t?n+s:e-s:i}q.addClass("sliderlabel",[{name:"!value:number"},{name:"visibleIf",visible:!1},{name:"enableIf",visible:!1},{name:"showValue:boolean",locationInTable:"detail",default:!1}],n=>new uv(n),"itemvalue"),q.addClass("slider",[{name:"sliderType",default:"single",choices:["single","range"]},{name:"autoGenerate",default:!0,isSerializable:!1,choices:[!0,!1]},{name:"min:number",default:0,onSettingValue:(n,e)=>hv(e,n.max,!1,n.step)},{name:"max:number",default:100,onSettingValue:(n,e)=>hv(n.min,e,!0,n.step)},{name:"step:number",default:1},{name:"minValueExpression",type:"expression"},{name:"maxValueExpression",type:"expression"},{name:"minRangeLength:number",visibleIf:function(n){return n.sliderType==="range"}},{name:"maxRangeLength:number",visibleIf:function(n){return n.sliderType==="range"}},{name:"customLabels:sliderlabel[]",visibleIf:function(n){return!n.autoGenerate}},{name:"showLabels:boolean",default:!0},{name:"tooltipVisibility:string",default:"auto",choices:["auto","always","never"]},{name:"labelFormat:string",default:"{0}"},{name:"tooltipFormat:string",default:"{0}"},{name:"allowDragRange:boolean",default:!0,visible:!1,visibleIf:function(n){return n.sliderType==="range"}},{name:"allowSwap:boolean",default:!0,visibleIf:function(n){return n.sliderType==="range"}},{name:"labelCount:number",default:-1,visibleIf:function(n){return n.autoGenerate}},{name:"allowClear:boolean",default:!1}],function(){return new Pt("")},"question"),qe.Instance.registerQuestion("slider",n=>new Pt(n));let Gi=class extends Dt{constructor(e){super(e),this.createLocalizableString("labelFalse",this,!0,"booleanUncheckedLabel"),this.createLocalizableString("labelTrue",this,!0,"booleanCheckedLabel")}getType(){return"boolean"}isLayoutTypeSupported(e){return!0}supportAutoAdvance(){return this.renderAs!=="checkbox"}get isIndeterminate(){return this.isEmpty()}get booleanValue(){return this.isEmpty()?null:this.value==this.getValueTrue()}set booleanValue(e){this.isReadOnly||this.isDesignMode||this.setBooleanValue(e)}setBooleanValue(e){this.isValueEmpty(e)?this.value=void 0:this.value=e==!0?this.getValueTrue():this.getValueFalse()}get defaultValue(){return this.getPropertyValue("defaultValue")}set defaultValue(e){e===!0&&(e="true"),e===!1&&(e="false"),this.setPropertyValue("defaultValue",e),this.updateValueWithDefaults()}getDefaultValue(){const e=this.defaultValue;if(!(e==="indeterminate"||e===void 0||e===null))return e=="true"?this.getValueTrue():this.getValueFalse()}get locTitle(){const e=this.getLocalizableString("title");return(this.isLabelRendered&&!this.showTitle||this.isValueEmpty(e.text))&&!this.isValueEmpty(this.locLabel.text)?this.locLabel:e}get labelRenderedAriaID(){return this.isLabelRendered?this.ariaTitleId:null}beforeDestroyQuestionElement(e){super.beforeDestroyQuestionElement(e),this.leftAnswerElement=void 0}get isLabelRendered(){return this.titleLocation==="hidden"||this.useTitleAsLabel}get canRenderLabelDescription(){return this.isLabelRendered&&this.hasDescription&&(this.hasDescriptionUnderTitle||this.hasDescriptionUnderInput)}get labelTrue(){return this.getLocalizableStringText("labelTrue")}set labelTrue(e){this.setLocalizableStringText("labelTrue",e)}get locLabelTrue(){return this.getLocalizableString("labelTrue")}get isDeterminated(){return this.booleanValue!==null&&this.booleanValue!==void 0}get locLabelLeft(){return this.swapOrder?this.getLocalizableString("labelTrue"):this.getLocalizableString("labelFalse")}get locLabelRight(){return this.swapOrder?this.getLocalizableString("labelFalse"):this.getLocalizableString("labelTrue")}get labelFalse(){return this.getLocalizableStringText("labelFalse")}set labelFalse(e){this.setLocalizableStringText("labelFalse",e)}get locLabelFalse(){return this.getLocalizableString("labelFalse")}getValueTrue(){return this.valueTrue!==void 0?this.valueTrue:!0}getValueFalse(){return this.valueFalse!==void 0?this.valueFalse:!1}setDefaultValue(){this.isDefaultValueSet("true",this.valueTrue)&&this.setBooleanValue(!0),this.isDefaultValueSet("false",this.valueFalse)&&this.setBooleanValue(!1);const e=this.defaultValue;(e==="indeterminate"||e===null||e===void 0)&&this.setBooleanValue(void 0)}isDefaultValueSet(e,t){return this.defaultValue==e||t!==void 0&&this.defaultValue===t}getDisplayValueCore(e,t){return t==this.getValueTrue()?this.locLabelTrue.textOrHtml:this.locLabelFalse.textOrHtml}getItemCssValue(e){return new z().append(e.item).append(e.itemOnError,this.hasCssError()).append(e.itemDisabled,this.isDisabledStyle).append(e.itemReadOnly,this.isReadOnlyStyle).append(e.itemPreview,this.isPreviewStyle).append(e.itemHover,!this.isDesignMode).append(e.itemChecked,!!this.booleanValue).append(e.itemExchanged,!!this.swapOrder).append(e.itemIndeterminate,!this.isDeterminated).append(e.itemIsLabelRendered,!!this.isLabelRendered).toString()}getItemCss(){return this.getItemCssValue(this.cssClasses)}getCheckboxItemCss(){return this.getItemCssValue({item:this.cssClasses.checkboxItem,itemOnError:this.cssClasses.checkboxItemOnError,itemDisabled:this.cssClasses.checkboxItemDisabled,itemDisable:this.cssClasses.checkboxItemDisabled,itemReadOnly:this.cssClasses.checkboxItemReadOnly,itemPreview:this.cssClasses.checkboxItemPreview,itemChecked:this.cssClasses.checkboxItemChecked,itemIndeterminate:this.cssClasses.checkboxItemIndeterminate,itemIsLabelRendered:this.cssClasses.checkboxIsLabelRendered})}getLabelCss(e){return new z().append(this.cssClasses.label).append(this.cssClasses.disabledLabel,this.booleanValue===!e||this.isDisabledStyle).append(this.cssClasses.labelReadOnly,this.isReadOnlyStyle).append(this.cssClasses.labelPreview,this.isPreviewStyle).append(this.cssClasses.labelTrue,!this.isIndeterminate&&e===!this.swapOrder).append(this.cssClasses.labelFalse,!this.isIndeterminate&&e===this.swapOrder).toString()}updateValueFromSurvey(e,t=!1){super.updateValueFromSurvey(e,t)}onValueChanged(){super.onValueChanged()}get svgIcon(){return this.booleanValue&&this.cssClasses.svgIconCheckedId?this.cssClasses.svgIconCheckedId:!this.isDeterminated&&this.cssClasses.svgIconIndId?this.cssClasses.svgIconIndId:!this.booleanValue&&this.cssClasses.svgIconUncheckedId?this.cssClasses.svgIconUncheckedId:this.cssClasses.svgIconId}get itemSvgIcon(){return this.isPreviewStyle&&this.cssClasses.itemPreviewSvgIconId?this.cssClasses.itemPreviewSvgIconId:this.cssClasses.itemSvgIconId}get allowClick(){return this.isIndeterminate&&!this.isInputReadOnly}getCheckedLabel(){if(this.booleanValue===!0)return this.locLabelTrue;if(this.booleanValue===!1)return this.locLabelFalse}setQuestionValue(e,t=!0){e==="true"&&this.valueTrue!=="true"&&(e=!0),e==="false"&&this.valueFalse!=="false"&&(e=!1),(e==="indeterminate"||e===null)&&(e=void 0),super.setQuestionValue(e,t)}onLabelClick(e,t){return this.allowClick&&(wy(e),this.booleanValue=t),!0}calculateBooleanValueByEvent(e,t){let s=!1;ge.isAvailable()&&(s=ge.getComputedStyle(e.target).direction=="rtl"),this.booleanValue=s?!t:t}onSwitchClickModel(e){if(this.allowClick){wy(e);var t=e.offsetX/e.target.offsetWidth>.5;this.calculateBooleanValueByEvent(e,t);return}return!0}onKeyDownCore(e){return(e.key==="ArrowLeft"||e.key==="ArrowRight")&&(e.stopPropagation(),this.calculateBooleanValueByEvent(e,e.key==="ArrowRight")),!0}getRadioItemClass(e,t){let s;return e.radioItem&&(s=e.radioItem),e.radioItemChecked&&t===this.value&&(s=(s?s+" ":"")+e.radioItemChecked),this.isDisabledStyle&&(s+=" "+e.radioItemDisabled),this.isReadOnlyStyle&&(s+=" "+e.radioItemReadOnly),this.isPreviewStyle&&(s+=" "+e.radioItemPreview),s}supportResponsiveness(){return!0}getCompactRenderAs(){return"radio"}createActionContainer(e){return super.createActionContainer(this.renderAs!=="checkbox")}getIsTitleRenderedAsString(){return!1}get isNewA11yStructure(){return!0}get a11y_input_ariaRole(){return"switch"}};S([E({localizable:!0})],Gi.prototype,"label",void 0),S([E({defaultValue:!1,onSet:(n,e)=>{n&&e.setPropertyValue("titleLocation","hidden")}})],Gi.prototype,"useTitleAsLabel",void 0),S([E({defaultValue:!1})],Gi.prototype,"swapOrder",void 0),S([E()],Gi.prototype,"valueTrue",void 0),S([E()],Gi.prototype,"valueFalse",void 0),q.addClass("boolean",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},{name:"label:text",serializationProperty:"locLabel",isSerializable:!1,visible:!1},{name:"labelTrue",serializationProperty:"locLabelTrue"},{name:"labelFalse",serializationProperty:"locLabelFalse"},"valueTrue","valueFalse",{name:"swapOrder:boolean",category:"general"},{name:"renderAs",default:"default",visible:!1},{name:"useTitleAsLabel",default:!1,visible:!1}],function(){return new Gi("")},"question"),qe.Instance.registerQuestion("boolean",n=>new Gi(n));let lh=class extends co{constructor(e,t,s){super(e,t,s),this.typeName=s,this.createLocalizableString("imageLink")}getBaseType(){return"imageitemvalue"}get imageLink(){return this.getLocalizableStringText("imageLink")}set imageLink(e){this.setLocalizableStringText("imageLink",e),this.imageNotLoaded=!1,this.videoNotLoaded=!1}get locImageLink(){return this.getLocalizableString("imageLink")}getLocale(){return this.locOwner?this.locOwner.getLocale():""}getMarkdownHtml(e,t,s){return this.locOwner?this.locOwner.getMarkdownHtml(e,t,s):void 0}getRenderer(e){return this.locOwner?this.locOwner.getRenderer(e):null}getRendererContext(e){return this.locOwner?this.locOwner.getRendererContext(e):e}getProcessedText(e){return this.locOwner?this.locOwner.getProcessedText(e):e}onErrorHandler(){this.contentNotLoaded=!0}set contentNotLoaded(e){this.locOwner instanceof as&&this.locOwner.contentMode=="video"?this.videoNotLoaded=e:this.imageNotLoaded=e}get contentNotLoaded(){return this.locOwner instanceof as&&this.locOwner.contentMode=="video"?this.videoNotLoaded:this.imageNotLoaded}};S([E({defaultValue:!1})],lh.prototype,"videoNotLoaded",void 0),S([E({defaultValue:!1})],lh.prototype,"imageNotLoaded",void 0);let as=class extends po{constructor(e){super(e),this.isResponsiveValue=!1,this.onContentLoaded=(t,s)=>{t.contentNotLoaded=!1;const i=s.target;this.contentMode=="video"?t.aspectRatio=i.videoWidth/i.videoHeight:t.aspectRatio=i.naturalWidth/i.naturalHeight,this._width&&this.processResponsiveness(0,this._width)},this.gridColCount=void 0,this.colCount=0,this.registerPropertyChangedHandlers(["minImageWidth","maxImageWidth","minImageHeight","maxImageHeight","visibleChoices","colCount","isResponsiveValue"],()=>{this._width&&this.processResponsiveness(0,this._width)}),this.registerPropertyChangedHandlers(["imageWidth","imageHeight"],()=>{this.calcIsResponsive()}),this.calcIsResponsive()}getType(){return"imagepicker"}supportAutoAdvance(){return!this.multiSelect}get hasSingleInput(){return!1}getItemValueType(){return"imageitemvalue"}get isCompositeQuestion(){return!0}get itemFlowDirection(){return"row"}supportOther(){return!1}supportNone(){return!1}supportRefuse(){return!1}supportDontKnow(){return!1}isAnswerCorrect(){return this.multiSelect?O.isArrayContainsEqual(this.value,this.correctAnswer):super.isAnswerCorrect()}get multiSelect(){return this.getPropertyValue("multiSelect")}set multiSelect(e){this.setPropertyValue("multiSelect",e)}isItemSelected(e){var t=this.value;const s=e;if(this.isValueEmpty(t)||!s.imageLink||s.contentNotLoaded)return!1;if(!this.multiSelect)return this.isTwoValueEquals(t,e.value);if(!Array.isArray(t))return!1;for(var i=0;i<t.length;i++)if(this.isTwoValueEquals(t[i],e.value))return!0;return!1}getItemEnabled(e){const t=e;return!t.imageLink||t.contentNotLoaded?!1:super.getItemEnabled(e)}clearIncorrectValues(){if(this.multiSelect){var e=this.value;if(!e)return;if(!Array.isArray(e)||e.length==0){this.clearValue(!0);return}for(var t=[],s=0;s<e.length;s++)this.hasUnknownValue(e[s],!0)||t.push(e[s]);if(t.length==e.length)return;t.length==0?this.clearValue(!0):this.value=t}else super.clearIncorrectValues()}getDisplayValueCore(e,t){return!this.multiSelect&&!Array.isArray(t)?super.getDisplayValueCore(e,t):this.getDisplayArrayValue(e,t)}get showLabel(){return this.getPropertyValue("showLabel")}set showLabel(e){this.setPropertyValue("showLabel",e)}endLoadingFromJson(){super.endLoadingFromJson(),!this.isDesignMode&&this.multiSelect&&(this.createNewArray("renderedValue"),this.createNewArray("value")),this.calcIsResponsive()}getValueCore(){var e=super.getValueCore();return e!==void 0?e:this.multiSelect?[]:e}convertValToArrayForMultSelect(e){return!this.multiSelect||this.isValueEmpty(e)||Array.isArray(e)?e:[e]}renderedValueFromDataCore(e){return this.convertValToArrayForMultSelect(e)}renderedValueToDataCore(e){return this.convertValToArrayForMultSelect(e)}get imageHeight(){return this.getPropertyValue("imageHeight")}set imageHeight(e){this.setPropertyValue("imageHeight",e)}get imageScale(){return this.survey?this.survey.widthScale/100:1}get renderedImageHeight(){const e=this.isResponsive?Math.floor(this.responsiveImageHeight):this.imageHeight*this.imageScale;return e||150*this.imageScale}get imageWidth(){return this.getPropertyValue("imageWidth")}set imageWidth(e){this.setPropertyValue("imageWidth",e)}get renderedImageWidth(){const e=this.isResponsive?Math.floor(this.responsiveImageWidth):this.imageWidth*this.imageScale;return e||200*this.imageScale}get imageFit(){return this.getPropertyValue("imageFit")}set imageFit(e){this.setPropertyValue("imageFit",e)}get contentMode(){return this.getPropertyValue("contentMode")}set contentMode(e){this.setPropertyValue("contentMode",e),e==="video"&&(this.showLabel=!0)}valueToData(e){return e}get inputType(){return this.multiSelect?"checkbox":"radio"}isBuiltInChoice(e){return!1}addToVisibleChoices(e,t){this.addNewItemToVisibleChoices(e,t)}getSelectBaseRootCss(){const e=this.isResponsive;return new z().append(super.getSelectBaseRootCss()).append(this.cssClasses.rootResponsive,e).append(this.cssClasses.rootStatic,!e).append(this.cssClasses.rootColumn,this.getCurrentColCount()==1).toString()}get isResponsive(){return this.isResponsiveValue}get exactSizesAreEmpty(){return!["imageHeight","imageWidth"].some(e=>this[e]!==void 0&&this[e]!==null)}calcIsResponsive(){this.isResponsiveValue=this.exactSizesAreEmpty}getObservedElementSelector(){return rs(this.cssClasses.root)}supportResponsiveness(){return!0}needResponsiveness(){return this.supportResponsiveness()}needResponsiveWidth(){return this.colCount>2}getCurrentColCount(){return this.responsiveColCount===void 0||this.colCount===0?this.colCount:this.responsiveColCount}getContainerStyle(){return this.isResponsive?{gridAutoFlow:this.gridColCount?null:"column",gridTemplateColumns:this.gridColCount?`repeat(${this.gridColCount}, 1fr)`:null}:{}}processResponsiveness(e,t){this._width=t=Math.floor(t);const s=(i,r,a)=>{let o=Math.floor(i/(r+a));return(o+1)*(r+a)-a<=i&&o++,o};if(this.isResponsive){const i=this.choices.length+(this.isDesignMode?1:0),r=(this.gapBetweenItems||0)*this.imageScale,a=this.minImageWidth*this.imageScale,o=this.maxImageWidth*this.imageScale,l=this.maxImageHeight*this.imageScale,u=this.minImageHeight*this.imageScale;let d=this.colCount,h;const f=s(t,a,r);d===0?((r+a)*i-r>t?h=Math.floor((t-r*(f-1))/f):h=Math.floor((t-r*(i-1))/i),this.gridColCount=Math.max(Math.min(i,f),1)):(f<d?(this.responsiveColCount=Math.max(f,1),d=this.responsiveColCount):this.responsiveColCount=d,this.gridColCount=this.responsiveColCount,h=Math.floor((t-r*(d-1))/d)),h=Math.max(a,Math.min(h,o));let C=Number.MIN_VALUE;this.choices.forEach(V=>{const P=h/V.aspectRatio;C=P>C?P:C}),C>l?C=l:C<u&&(C=u);const b=this.responsiveImageWidth,x=this.responsiveImageHeight;return this.responsiveImageWidth=h,this.responsiveImageHeight=C,b!==this.responsiveImageWidth||x!==this.responsiveImageHeight}return!1}triggerResponsiveness(e=!0){e&&this.reCalcGapBetweenItemsCallback&&this.reCalcGapBetweenItemsCallback(),super.triggerResponsiveness(e)}afterRender(e){super.afterRender(e);const t=this.getObservedElementSelector(),s=e&&t?e.querySelector(t):void 0;s&&(this.reCalcGapBetweenItemsCallback=()=>{this.gapBetweenItems=Math.ceil(Number.parseFloat(ge.getComputedStyle(s).gap))||16},this.reCalcGapBetweenItemsCallback())}get ariaRole(){return this.multiSelect?"group":"radiogroup"}get ariaRequired(){return null}get inputRequiredAttribute(){return this.multiSelect?this.hasRequiredError():null}};S([E({})],as.prototype,"responsiveImageHeight",void 0),S([E({})],as.prototype,"responsiveImageWidth",void 0),S([E({})],as.prototype,"isResponsiveValue",void 0),S([E({})],as.prototype,"maxImageWidth",void 0),S([E({})],as.prototype,"minImageWidth",void 0),S([E({})],as.prototype,"maxImageHeight",void 0),S([E({})],as.prototype,"minImageHeight",void 0),S([E({})],as.prototype,"responsiveColCount",void 0),S([E()],as.prototype,"gridColCount",void 0),q.addClass("imageitemvalue",[{name:"imageLink:file",serializationProperty:"locImageLink"}],n=>new lh(n),"itemvalue"),q.addClass("responsiveImageSize",[],void 0,"number"),q.addClass("imagepicker",[{name:"showOtherItem",visible:!1},{name:"otherText",visible:!1},{name:"showNoneItem",visible:!1},{name:"showRefuseItem",visible:!1},{name:"showDontKnowItem",visible:!1},{name:"noneText",visible:!1},{name:"placeholder",visible:!1},{name:"otherErrorText",visible:!1},{name:"storeOthersAsComment",visible:!1},{name:"contentMode",default:"image",choices:["image","video"]},{name:"imageFit",default:"contain",choices:["none","contain","cover","fill"]},{name:"imageHeight:number",minValue:0},{name:"imageWidth:number",minValue:0},{name:"minImageWidth:responsiveImageSize",default:200,minValue:0},{name:"minImageHeight:responsiveImageSize",default:133,minValue:0},{name:"maxImageWidth:responsiveImageSize",default:3e3,minValue:0},{name:"maxImageHeight:responsiveImageSize",default:3e3,minValue:0},"showLabel:boolean",{name:"colCount:number",default:0,choices:[0,1,2,3,4,5]},"multiSelect:boolean"],function(){return new as("")},"checkboxbase"),q.getProperty("imagepicker","choices").type="imageitemvalue[]",qe.Instance.registerQuestion("imagepicker",n=>{var e=new as(n);return e});const dv=[".mp4",".mov",".wmv",".flv",".avi",".mkv"],yS="https://www.youtube.com/",cv="embed";let uh=class extends ah{constructor(e){super(e);const t=this.createLocalizableString("imageLink");t.onGetTextCallback=s=>vS(s,this.contentMode=="youtube"),this.createLocalizableString("altText"),this.registerPropertyChangedHandlers(["contentMode","imageLink"],()=>this.calculateRenderedMode())}getType(){return"image"}get isCompositeQuestion(){return!1}onSurveyLoad(){super.onSurveyLoad(),this.calculateRenderedMode()}get imageLink(){return this.getLocalizableStringText("imageLink")}set imageLink(e){this.setLocalizableStringText("imageLink",e)}get locImageLink(){return this.getLocalizableString("imageLink")}get altText(){return this.getLocalizableStringText("altText")}set altText(e){this.setLocalizableStringText("altText",e)}get locAltText(){return this.getLocalizableString("altText")}get imageHeight(){return this.getPropertyValue("imageHeight")}set imageHeight(e){this.setPropertyValue("imageHeight",e)}get renderedStyleHeight(){return this.imageHeight?Ya(this.imageHeight):void 0}get renderedHeight(){return this.imageHeight?$i(this.imageHeight):void 0}get imageWidth(){return this.getPropertyValue("imageWidth")}set imageWidth(e){this.setPropertyValue("imageWidth",e)}get renderedStyleWidth(){return this.imageWidth?Ya(this.imageWidth):void 0}get renderedWidth(){return this.imageWidth?$i(this.imageWidth):void 0}get imageFit(){return this.getPropertyValue("imageFit")}set imageFit(e){this.setPropertyValue("imageFit",e)}get contentMode(){return this.getPropertyValue("contentMode")}set contentMode(e){this.setPropertyValue("contentMode",e),e==="video"&&(this.showLabel=!0)}get renderedMode(){return this.getPropertyValue("renderedMode","image")}get ariaInvalid(){return null}get ariaLabel(){return null}get renderedAltText(){return this.altText||this.title}getImageCss(){const e=this.getPropertyByName("imageHeight"),t=this.getPropertyByName("imageWidth"),s=e.isDefaultValue(this.imageHeight)&&t.isDefaultValue(this.imageWidth);return new z().append(this.cssClasses.image).append(this.cssClasses.adaptive,s).toString()}onLoadHandler(){this.contentNotLoaded=!1}onErrorHandler(){this.contentNotLoaded=!0}setRenderedMode(e){this.setPropertyValue("renderedMode",e)}calculateRenderedMode(){this.contentMode!=="auto"?this.setRenderedMode(this.contentMode):this.isYoutubeVideo()?this.setRenderedMode("youtube"):this.isVideo()?this.setRenderedMode("video"):this.setRenderedMode("image")}isYoutubeVideo(){return O.isUrlYoutubeVideo(this.imageLink)}isVideo(){let e=this.imageLink;if(!e)return!1;e=e.toLowerCase();for(let t=0;t<dv.length;t++)if(e.endsWith(dv[t]))return!0;return!1}};S([E({defaultValue:!1})],uh.prototype,"contentNotLoaded",void 0);function vS(n,e){if(!n||!O.isUrlYoutubeVideo(n))return e?"":n;if(n.toLocaleLowerCase().indexOf(cv)>-1)return n;let s="";for(var i=n.length-1;i>=0&&!(n[i]==="="||n[i]==="/");i--)s=n[i]+s;return yS+cv+"/"+s}q.addClass("image",[{name:"imageLink:file",serializationProperty:"locImageLink"},{name:"altText",serializationProperty:"locAltText",alternativeName:"text",category:"general"},{name:"contentMode",default:"auto",choices:["auto","image","video","youtube"]},{name:"imageFit",default:"contain",choices:["none","contain","cover","fill"]},{name:"imageHeight",default:"150"},{name:"imageWidth",default:"200"}],function(){return new uh("")},"nonvalue"),qe.Instance.registerQuestion("image",n=>new uh(n));let bo=class{constructor(e,t,s,i){if(isNaN(e)||isNaN(t))throw new Error(`Point is invalid: (${e}, ${t})`);this.x=+e,this.y=+t,this.pressure=s||0,this.time=i||Date.now()}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}equals(e){return this.x===e.x&&this.y===e.y&&this.pressure===e.pressure&&this.time===e.time}velocityFrom(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):0}},CS=class jw{static fromPoints(e,t){const s=this.calculateControlPoints(e[0],e[1],e[2]).c2,i=this.calculateControlPoints(e[1],e[2],e[3]).c1;return new jw(e[1],s,i,e[2],t.start,t.end)}static calculateControlPoints(e,t,s){const i=e.x-t.x,r=e.y-t.y,a=t.x-s.x,o=t.y-s.y,l={x:(e.x+t.x)/2,y:(e.y+t.y)/2},u={x:(t.x+s.x)/2,y:(t.y+s.y)/2},d=Math.sqrt(i*i+r*r),h=Math.sqrt(a*a+o*o),f=l.x-u.x,C=l.y-u.y,b=h/(d+h),x={x:u.x+f*b,y:u.y+C*b},V=t.x-x.x,P=t.y-x.y;return{c1:new bo(l.x+V,l.y+P),c2:new bo(u.x+V,u.y+P)}}constructor(e,t,s,i,r,a){this.startPoint=e,this.control2=t,this.control1=s,this.endPoint=i,this.startWidth=r,this.endWidth=a}length(){let t=0,s,i;for(let r=0;r<=10;r+=1){const a=r/10,o=this.point(a,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),l=this.point(a,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(r>0){const u=o-s,d=l-i;t+=Math.sqrt(u*u+d*d)}s=o,i=l}return t}point(e,t,s,i,r){return t*(1-e)*(1-e)*(1-e)+3*s*(1-e)*(1-e)*e+3*i*(1-e)*e*e+r*e*e*e}},bS=class{constructor(){try{this._et=new EventTarget}catch{this._et=document}}addEventListener(e,t,s){this._et.addEventListener(e,t,s)}dispatchEvent(e){return this._et.dispatchEvent(e)}removeEventListener(e,t,s){this._et.removeEventListener(e,t,s)}};function wS(n,e=250){let t=0,s=null,i,r,a;const o=()=>{t=Date.now(),s=null,i=n.apply(r,a),s||(r=null,a=[])};return function(...u){const d=Date.now(),h=e-(d-t);return r=this,a=u,h<=0||h>e?(s&&(clearTimeout(s),s=null),t=d,i=n.apply(r,a),s||(r=null,a=[])):s||(s=window.setTimeout(o,h)),i}}let xS=class wf extends bS{constructor(e,t={}){super(),this.canvas=e,this._drawingStroke=!1,this._isEmpty=!0,this._lastPoints=[],this._data=[],this._lastVelocity=0,this._lastWidth=0,this._handleMouseDown=s=>{s.buttons===1&&this._strokeBegin(s)},this._handleMouseMove=s=>{this._strokeMoveUpdate(s)},this._handleMouseUp=s=>{s.buttons===1&&this._strokeEnd(s)},this._handleTouchStart=s=>{if(s.cancelable&&s.preventDefault(),s.targetTouches.length===1){const i=s.changedTouches[0];this._strokeBegin(i)}},this._handleTouchMove=s=>{s.cancelable&&s.preventDefault();const i=s.targetTouches[0];this._strokeMoveUpdate(i)},this._handleTouchEnd=s=>{if(s.target===this.canvas){s.cancelable&&s.preventDefault();const r=s.changedTouches[0];this._strokeEnd(r)}},this._handlePointerStart=s=>{s.preventDefault(),this._strokeBegin(s)},this._handlePointerMove=s=>{this._strokeMoveUpdate(s)},this._handlePointerEnd=s=>{this._drawingStroke&&(s.preventDefault(),this._strokeEnd(s))},this.velocityFilterWeight=t.velocityFilterWeight||.7,this.minWidth=t.minWidth||.5,this.maxWidth=t.maxWidth||2.5,this.throttle="throttle"in t?t.throttle:16,this.minDistance="minDistance"in t?t.minDistance:5,this.dotSize=t.dotSize||0,this.penColor=t.penColor||"black",this.backgroundColor=t.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=t.compositeOperation||"source-over",this.canvasContextOptions="canvasContextOptions"in t?t.canvasContextOptions:{},this._strokeMoveUpdate=this.throttle?wS(wf.prototype._strokeUpdate,this.throttle):wf.prototype._strokeUpdate,this._ctx=e.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){const{_ctx:e,canvas:t}=this;e.fillStyle=this.backgroundColor,e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0}fromDataURL(e,t={}){return new Promise((s,i)=>{const r=new Image,a=t.ratio||window.devicePixelRatio||1,o=t.width||this.canvas.width/a,l=t.height||this.canvas.height/a,u=t.xOffset||0,d=t.yOffset||0;this._reset(this._getPointGroupOptions()),r.onload=()=>{this._ctx.drawImage(r,u,d,o,l),s()},r.onerror=h=>{i(h)},r.crossOrigin="anonymous",r.src=e,this._isEmpty=!1})}toDataURL(e="image/png",t){switch(e){case"image/svg+xml":return typeof t!="object"&&(t=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(t))}`;default:return typeof t!="number"&&(t=void 0),this.canvas.toDataURL(e,t)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";const e=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!e?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerStart),this.canvas.removeEventListener("pointermove",this._handlePointerMove),this.canvas.ownerDocument.removeEventListener("pointerup",this._handlePointerEnd),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("mousemove",this._handleMouseMove),this.canvas.ownerDocument.removeEventListener("mouseup",this._handleMouseUp),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this.canvas.removeEventListener("touchmove",this._handleTouchMove),this.canvas.removeEventListener("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(e,{clear:t=!0}={}){t&&this.clear(),this._fromData(e,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(e)}toData(){return this._data}_getPointGroupOptions(e){return{penColor:e&&"penColor"in e?e.penColor:this.penColor,dotSize:e&&"dotSize"in e?e.dotSize:this.dotSize,minWidth:e&&"minWidth"in e?e.minWidth:this.minWidth,maxWidth:e&&"maxWidth"in e?e.maxWidth:this.maxWidth,velocityFilterWeight:e&&"velocityFilterWeight"in e?e.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:e&&"compositeOperation"in e?e.compositeOperation:this.compositeOperation}}_strokeBegin(e){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:e,cancelable:!0})))return;this._drawingStroke=!0;const s=this._getPointGroupOptions(),i=Object.assign(Object.assign({},s),{points:[]});this._data.push(i),this._reset(s),this._strokeUpdate(e)}_strokeUpdate(e){if(!this._drawingStroke)return;if(this._data.length===0){this._strokeBegin(e);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:e}));const t=e.clientX,s=e.clientY,i=e.pressure!==void 0?e.pressure:e.force!==void 0?e.force:0,r=this._createPoint(t,s,i),a=this._data[this._data.length-1],o=a.points,l=o.length>0&&o[o.length-1],u=l?r.distanceTo(l)<=this.minDistance:!1,d=this._getPointGroupOptions(a);if(!l||!(l&&u)){const h=this._addPoint(r,d);l?h&&this._drawCurve(h,d):this._drawDot(r,d),o.push({time:r.time,x:r.x,y:r.y,pressure:r.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:e}))}_strokeEnd(e){this._drawingStroke&&(this._strokeUpdate(e),this._drawingStroke=!1,this.dispatchEvent(new CustomEvent("endStroke",{detail:e})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerStart),this.canvas.addEventListener("pointermove",this._handlePointerMove),this.canvas.ownerDocument.addEventListener("pointerup",this._handlePointerEnd)}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown),this.canvas.addEventListener("mousemove",this._handleMouseMove),this.canvas.ownerDocument.addEventListener("mouseup",this._handleMouseUp)}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart),this.canvas.addEventListener("touchmove",this._handleTouchMove),this.canvas.addEventListener("touchend",this._handleTouchEnd)}_reset(e){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(e.minWidth+e.maxWidth)/2,this._ctx.fillStyle=e.penColor,this._ctx.globalCompositeOperation=e.compositeOperation}_createPoint(e,t,s){const i=this.canvas.getBoundingClientRect();return new bo(e-i.left,t-i.top,s,new Date().getTime())}_addPoint(e,t){const{_lastPoints:s}=this;if(s.push(e),s.length>2){s.length===3&&s.unshift(s[0]);const i=this._calculateCurveWidths(s[1],s[2],t),r=CS.fromPoints(s,i);return s.shift(),r}return null}_calculateCurveWidths(e,t,s){const i=s.velocityFilterWeight*t.velocityFrom(e)+(1-s.velocityFilterWeight)*this._lastVelocity,r=this._strokeWidth(i,s),a={end:r,start:this._lastWidth};return this._lastVelocity=i,this._lastWidth=r,a}_strokeWidth(e,t){return Math.max(t.maxWidth/(e+1),t.minWidth)}_drawCurveSegment(e,t,s){const i=this._ctx;i.moveTo(e,t),i.arc(e,t,s,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(e,t){const s=this._ctx,i=e.endWidth-e.startWidth,r=Math.ceil(e.length())*2;s.beginPath(),s.fillStyle=t.penColor;for(let a=0;a<r;a+=1){const o=a/r,l=o*o,u=l*o,d=1-o,h=d*d,f=h*d;let C=f*e.startPoint.x;C+=3*h*o*e.control1.x,C+=3*d*l*e.control2.x,C+=u*e.endPoint.x;let b=f*e.startPoint.y;b+=3*h*o*e.control1.y,b+=3*d*l*e.control2.y,b+=u*e.endPoint.y;const x=Math.min(e.startWidth+u*i,t.maxWidth);this._drawCurveSegment(C,b,x)}s.closePath(),s.fill()}_drawDot(e,t){const s=this._ctx,i=t.dotSize>0?t.dotSize:(t.minWidth+t.maxWidth)/2;s.beginPath(),this._drawCurveSegment(e.x,e.y,i),s.closePath(),s.fillStyle=t.penColor,s.fill()}_fromData(e,t,s){for(const i of e){const{points:r}=i,a=this._getPointGroupOptions(i);if(r.length>1)for(let o=0;o<r.length;o+=1){const l=r[o],u=new bo(l.x,l.y,l.pressure,l.time);o===0&&this._reset(a);const d=this._addPoint(u,a);d&&t(d,a)}else this._reset(a),s(r[0],a)}}toSVG({includeBackgroundColor:e=!1}={}){const t=this._data,s=Math.max(window.devicePixelRatio||1,1),i=0,r=0,a=this.canvas.width/s,o=this.canvas.height/s,l=document.createElementNS("http://www.w3.org/2000/svg","svg");if(l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),l.setAttribute("viewBox",`${i} ${r} ${a} ${o}`),l.setAttribute("width",a.toString()),l.setAttribute("height",o.toString()),e&&this.backgroundColor){const u=document.createElement("rect");u.setAttribute("width","100%"),u.setAttribute("height","100%"),u.setAttribute("fill",this.backgroundColor),l.appendChild(u)}return this._fromData(t,(u,{penColor:d})=>{const h=document.createElement("path");if(!isNaN(u.control1.x)&&!isNaN(u.control1.y)&&!isNaN(u.control2.x)&&!isNaN(u.control2.y)){const f=`M ${u.startPoint.x.toFixed(3)},${u.startPoint.y.toFixed(3)} C ${u.control1.x.toFixed(3)},${u.control1.y.toFixed(3)} ${u.control2.x.toFixed(3)},${u.control2.y.toFixed(3)} ${u.endPoint.x.toFixed(3)},${u.endPoint.y.toFixed(3)}`;h.setAttribute("d",f),h.setAttribute("stroke-width",(u.endWidth*2.25).toFixed(3)),h.setAttribute("stroke",d),h.setAttribute("fill","none"),h.setAttribute("stroke-linecap","round"),l.appendChild(h)}},(u,{penColor:d,dotSize:h,minWidth:f,maxWidth:C})=>{const b=document.createElement("circle"),x=h>0?h:(f+C)/2;b.setAttribute("r",x.toString()),b.setAttribute("cx",u.x.toString()),b.setAttribute("cy",u.y.toString()),b.setAttribute("fill",d),l.appendChild(b)}),l.outerHTML}};var VS=300,PS=200;let As=class extends Co{getPenColorFromTheme(){const e=this.survey;return!!e&&!!e.themeVariables&&e.themeVariables["--sjs-primary-backcolor"]}updateColors(e){const t=this.getPenColorFromTheme(),s=this.getPropertyByName("penColor");e.penColor=this.penColor||t||s.defaultValue||"#1ab394";const i=this.getPropertyByName("backgroundColor"),r=t?"transparent":void 0,a=this.backgroundImage?"transparent":this.backgroundColor;e.backgroundColor=a||r||i.defaultValue||"#ffffff"}getCssRoot(e){return new z().append(super.getCssRoot(e)).append(e.small,this.signatureWidth.toString()==="300").toString()}getFormat(){return this.dataFormat==="jpeg"?"image/jpeg":this.dataFormat==="svg"?"image/svg+xml":""}updateValue(){if(this.signaturePad){var e=this.signaturePad.toDataURL(this.getFormat());this.valueIsUpdatingInternally=!0,this.value=e,this.valueIsUpdatingInternally=!1}}constructor(e){super(e),this.valueIsUpdatingInternally=!1,this._loadedData=void 0,this.updateValueHandler=()=>{this._loadedData=void 0,this.scaleCanvas(!0,!0)}}getType(){return"signaturepad"}afterRenderQuestionElement(e){we.isAvailable()&&e&&(this.isDesignMode||this.initSignaturePad(e),this.element=e),super.afterRenderQuestionElement(e)}beforeDestroyQuestionElement(e){e&&this.destroySignaturePad(e)}themeChanged(e){this.signaturePad&&this.updateColors(this.signaturePad)}resizeCanvas(){this.canvas.width=this.containerWidth,this.canvas.height=this.containerHeight}scaleCanvas(e=!0,t=!1){const s=this.canvas,i=s.offsetWidth/this.containerWidth;(this.scale!=i||t)&&(this.scale=i,s.style.width=this.renderedCanvasWidth,this.resizeCanvas(),this.signaturePad.minWidth=this.penMinWidth*i,this.signaturePad.maxWidth=this.penMaxWidth*i,s.getContext("2d").scale(1/i,1/i),e&&this.loadPreview(this.value))}fromUrl(e){if(this.isFileLoading=!0,$2(e))this.fromDataUrl(e),this.isFileLoading=!1;else{const t=new Image;t.crossOrigin="anonymous",t.src=e,t.onload=()=>{if(this.canvas){const i=ge.createElement("canvas");i.width=this.containerWidth,i.height=this.containerHeight,i.getContext("2d").drawImage(t,0,0);var s=i.toDataURL(this.getFormat());this.fromDataUrl(s)}this.isFileLoading=!1},t.onerror=()=>{this.isFileLoading=!1}}}fromDataUrl(e){if(this._loadedData=e,this.signaturePad){let t=1,s=this.scale;this.dataFormat==="svg"&&(t=we.getDevicePixelRatio()||1,s=1);const i={width:this.canvas.width*s/t,height:this.canvas.height*s/t};this.signaturePad.fromDataURL(e,i)}}get loadedData(){return this._loadedData}loadPreview(e){if(!e){this.signaturePad&&this.canvas&&(this.canvas.getContext("2d").clearRect(0,0,this.canvas.width*this.scale,this.canvas.height*this.scale),this.signaturePad.clear()),this.hasDrawnStroke=!1,this.valueWasChangedFromLastUpload=!1;return}if(this.storeDataAsText)this.fromDataUrl(e);else if(this.loadedData)this.fromDataUrl(this.loadedData);else{var t=e?[e]:[];this._previewLoader&&this._previewLoader.dispose(),this.isFileLoading=!0,this._previewLoader=new nv(this,(s,i)=>{s==="success"&&i&&i.length>0&&i[0].content?(this.fromDataUrl(i[0].content),this.isFileLoading=!1):s==="skipped"&&this.fromUrl(e),this._previewLoader.dispose(),this._previewLoader=void 0}),this._previewLoader.load(t)}}onChangeQuestionValue(e){super.onChangeQuestionValue(e),this.isLoadingFromJson||(this._loadedData=void 0,this.loadPreview(e))}onSurveyLoad(){super.onSurveyLoad(),this.loadPreview(this.value)}initSignaturePad(e){var t=e.getElementsByTagName("canvas")[0];this.canvas=t,this.resizeCanvas();var s=new xS(t,{backgroundColor:"#ffffff"});this.signaturePad=s,this.isInputReadOnly&&s.off(),this.readOnlyChangedCallback=()=>{this.isInputReadOnly?s.off():s.on()},this.updateColors(s),s.addEventListener("beginStroke",()=>{this.scaleCanvas(),this.hasDrawnStroke=!0,t.focus()},{once:!1}),s.addEventListener("endStroke",()=>{this.storeDataAsText?this.updateValue():this.valueWasChangedFromLastUpload=!0},{once:!1}),this.updateValueHandler(),this.readOnlyChangedCallback();var i=(r,a)=>{(a.name==="signatureWidth"||a.name==="signatureHeight")&&(this.valueIsUpdatingInternally||this.updateValueHandler())};this.onPropertyChanged.add(i),this.signaturePad.propertyChangedHandler=i}destroySignaturePad(e){this.signaturePad&&(this.onPropertyChanged.remove(this.signaturePad.propertyChangedHandler),this.signaturePad.off()),this.readOnlyChangedCallback=null,this.signaturePad=null}get dataFormat(){return this.getPropertyValue("dataFormat")}set dataFormat(e){this.setPropertyValue("dataFormat",hh(e))}get signatureWidth(){return this.getPropertyValue("signatureWidth")}set signatureWidth(e){this.setPropertyValue("signatureWidth",e)}get signatureHeight(){return this.getPropertyValue("signatureHeight")}set signatureHeight(e){this.setPropertyValue("signatureHeight",e)}get containerHeight(){return this.signatureHeight||PS}get containerWidth(){return this.signatureWidth||VS}get renderedCanvasWidth(){return this.signatureAutoScaleEnabled?"100%":this.containerWidth+"px"}get height(){return this.getPropertyValue("height")}set height(e){this.setPropertyValue("height",e)}get allowClear(){return this.getPropertyValue("allowClear")}set allowClear(e){this.setPropertyValue("allowClear",e)}get canShowClearButton(){const e=!this.nothingIsDrawn(),t=this.isUploading;return!this.isInputReadOnly&&this.allowClear&&e&&!t}get penColor(){return this.getPropertyValue("penColor")}set penColor(e){this.setPropertyValue("penColor",e),this.signaturePad&&this.updateColors(this.signaturePad)}get backgroundColor(){return this.getPropertyValue("backgroundColor")}set backgroundColor(e){this.setPropertyValue("backgroundColor",e),this.signaturePad&&this.updateColors(this.signaturePad)}get backgroundImage(){return this.getPropertyValue("backgroundImage")}set backgroundImage(e){this.setPropertyValue("backgroundImage",e),this.signaturePad&&this.updateColors(this.signaturePad)}get clearButtonCaption(){return this.getLocalizationString("clearCaption")}get locRenderedPlaceholder(){return this.isReadOnly?this.locPlaceholderReadOnly:this.locPlaceholder}nothingIsDrawn(){const e=this.hasDrawnStroke,t=this.isEmpty(),s=this.isUploading,i=this.valueWasChangedFromLastUpload;return!e&&t&&!s&&!i}needShowPlaceholder(){return this.showPlaceholder&&this.nothingIsDrawn()}onBlurCore(e){if(super.onBlurCore(e),!this.storeDataAsText&&!this.element.contains(e.relatedTarget)){if(!this.valueWasChangedFromLastUpload)return;this.uploadFiles([mS(this.signaturePad.toDataURL(this.getFormat()),this.name+"."+hh(this.dataFormat),this.getFormat())],"signature"),this.valueWasChangedFromLastUpload=!1}}uploadResultItemToValue(e){return e.content}setValueFromResult(e){this.valueIsUpdatingInternally=!0,this.value=e?.length?e.map(t=>t.content)[0]:void 0,this.valueIsUpdatingInternally=!1}clearValue(e,t){this.valueWasChangedFromLastUpload=!1,super.clearValue(e,t),this._loadedData=void 0,this.loadPreview(this.value)}endLoadingFromJson(){super.endLoadingFromJson(),this.signatureWidth===300&&this.width&&typeof this.width=="number"&&this.width&&(ri.warn("Use signatureWidth property to set width for the signature pad"),this.signatureWidth=this.width,this.width=void 0),this.signatureHeight===200&&this.height&&(ri.warn("Use signatureHeight property to set width for the signature pad"),this.signatureHeight=this.height,this.height=void 0)}};S([E({defaultValue:!1})],As.prototype,"hasDrawnStroke",void 0),S([E({defaultValue:!1})],As.prototype,"isReadyForUpload",void 0),S([E({defaultValue:!1})],As.prototype,"valueWasChangedFromLastUpload",void 0),S([E()],As.prototype,"signatureAutoScaleEnabled",void 0),S([E()],As.prototype,"penMinWidth",void 0),S([E()],As.prototype,"penMaxWidth",void 0),S([E({})],As.prototype,"showPlaceholder",void 0),S([E({localizable:{defaultStr:"signaturePlaceHolder"}})],As.prototype,"placeholder",void 0),S([E({localizable:{defaultStr:"signaturePlaceHolderReadOnly"}})],As.prototype,"placeholderReadOnly",void 0);function hh(n){return n||(n="png"),n=n.replace("image/","").replace("+xml",""),n!=="jpeg"&&n!=="svg"&&(n="png"),n}q.addClass("signaturepad",[{name:"signatureWidth:number",category:"general",default:300},{name:"signatureHeight:number",category:"general",default:200},{name:"signatureAutoScaleEnabled:boolean",category:"general",default:!1},{name:"penMinWidth:number",category:"general",default:.5},{name:"penMaxWidth:number",category:"general",default:2.5},{name:"height:number",category:"general",visible:!1},{name:"allowClear:boolean",category:"general",default:!0},{name:"showPlaceholder:boolean",category:"general",default:!0},{name:"placeholder:text",serializationProperty:"locPlaceholder",category:"general",dependsOn:"showPlaceholder",visibleIf:n=>n.showPlaceholder},{name:"placeholderReadOnly:text",serializationProperty:"locPlaceholderReadOnly",category:"general",dependsOn:"showPlaceholder",visibleIf:n=>n.showPlaceholder},{name:"backgroundImage:file",category:"general"},{name:"penColor:color",category:"general"},{name:"backgroundColor:color",category:"general"},{name:"dataFormat",category:"general",default:"png",choices:[{value:"png",text:"PNG"},{value:"jpeg",text:"JPEG"},{value:"svg",text:"SVG"}],onSettingValue:(n,e)=>hh(e)},{name:"defaultValue",visible:!1},{name:"correctAnswer",visible:!1},{name:"storeDataAsText:boolean",default:!0},{name:"waitForUpload:boolean",default:!1}],function(){return new As("")},"question"),qe.Instance.registerQuestion("signaturepad",n=>new As(n));let SS=class extends Ty{constructor(e){super(),this.item=e}getIndex(){return this.panelIndex}getQuestionData(){return this.item.data}getValue(e,t,s,i){if(e.length===0)return;if(e.length===1){const u=this.getPanelValue(e[0].name);if(u!==void 0)return{isFound:!0,value:u,context:this}}const r=A.expressionVariables,a=r.panel;if(e.length>1&&e[0].name.toLocaleLowerCase()===r.parentPanel.toLocaleLowerCase()){const u=this.item.data;if(u&&u.parentQuestion&&u.parent&&u.parent.data)return e[0].name=a,u.parent.data.getValueGetterContext().getValue(e,!0,s,i)}const o=this.item.panel,l=e[0].name===a;if(l||!t){l&&e.shift();const u=new Gu(o.questions).getValue(e,!1,s,i);if(u&&u.isFound)return u;const d=this.item.getAllValues();if(t){const h=this.getValueFromBindedQuestions(e,d);if(h)return h}return new fs(d).getValue(e,!1,s,i)}}getTextValue(e,t,s){return e=e.toLocaleLowerCase(),[this.indexVar,this.visIndexVar].indexOf(e)>-1&&t>-1&&t++,super.getTextValue(e,t,s)}get indexVar(){return A.expressionVariables.panelIndex.toLocaleLowerCase()}get visIndexVar(){return A.expressionVariables.visiblePanelIndex.toLocaleLowerCase()}getPanelValue(e){if(e=e.toLocaleLowerCase(),e===this.indexVar)return this.panelIndex;if(e==this.visIndexVar)return this.visiblePanelIndex}get panelIndex(){return this.getPanels(!1).indexOf(this.item.panel)}get visiblePanelIndex(){return this.getPanels(!0).indexOf(this.item.panel)}getPanels(e){const t=this.item.data;return t?e?t.visiblePanels:t.panels:[]}},IS=class extends io{constructor(e){super(e),this.question=e}getValue(e,t,s,i){if(!i&&this.question.isEmpty())return{isFound:e.length===0,value:void 0};if(s>-1){const r=this.question;return s>=0&&s<r.panels.length?r.panels[s].data.getValueGetterContext().getValue(e,!1,s,i):{isFound:!1,value:void 0,context:this}}return super.getValue(e,t,s,i)}},TS=class extends Pe{constructor(e){super(e)}},pv=class{constructor(e,t){this.data=e,this.data=e,this.panelValue=t,this.textPreProcessor=new no(this),this.setSurveyImpl()}get panel(){return this.panelValue}setSurveyImpl(){this.panel.setSurveyImpl(this)}getValueGetterContext(){return new SS(this)}getValue(e){var t=this.getAllValues();return t[e]}setValue(e,t){const s=this.data.getPanelItemData(this),i=s?s[e]:void 0;if(O.isTwoValueEquals(t,i,!1,!0,!1))return;this.data.setPanelItemData(this,e,O.getUnbindValue(t));const r=this.panel.questions;for(var a=0;a<r.length;a++){const o=r[a];o.getValueName()!==e&&o.checkBindings(e,t);const l=A.commentSuffix;if(e.endsWith(l)){e=e.substring(0,e.length-l.length);const d=this.panel.getQuestionByName(e);d&&(t=d.value)}const u=A.expressionVariables.panel+"."+e;o.runTriggers(u,t)}}getVariable(e){}setVariable(e,t){}getComment(e){var t=this.getValue(e+A.commentSuffix);return t||""}setComment(e,t,s){this.setValue(e+A.commentSuffix,t)}findQuestionByName(e){if(!e)return;const t=A.expressionVariables.panel+".";if(e.indexOf(t)===0)return this.panel.getQuestionByName(e.substring(t.length));const s=this.getSurvey();return s?s.getQuestionByName(e):null}getEditingSurveyElement(){}getAllValues(){return this.data.getPanelItemData(this)}getFilteredProperties(){return this.data&&this.data.getRootData()?this.data.getRootData().getFilteredProperties():{survey:this.getSurvey()}}getSurveyData(){return this}getSurvey(){return this.data?this.data.getSurvey():null}getTextProcessor(){return this.textPreProcessor}},ES=class{constructor(e){this.data=e}getSurveyData(){return null}getSurvey(){return this.data.getSurvey()}getTextProcessor(){return null}},ui=class extends Dt{constructor(e){super(e),this._renderedPanels=[],this.isPanelsAnimationRunning=!1,this.isAddingNewPanels=!1,this.isSetPanelItemData={},this.createNewArray("panels",t=>{this.onPanelAdded(t)},t=>{this.onPanelRemoved(t)}),this.createNewArray("visiblePanels"),this.templateValue=this.createAndSetupNewPanelObject(),this.template.renderWidth="100%",this.template.selectedElementInDesign=this,this.template.addElementCallback=t=>{this.addOnPropertyChangedCallback(t),this.rebuildPanels()},this.template.removeElementCallback=()=>{this.rebuildPanels()},this.createLocString({name:"confirmDeleteText",translationKey:"confirmDelete"}),this.createLocString({name:"keyDuplicationError",hasTranslation:!0}),this.createLocString({name:"addPanelText",translationKey:"addPanel"}),this.createLocString({name:"removePanelText",translationKey:"removePanel"}),this.createLocString({name:"prevPanelText",translationKey:"pagePrevText"}),this.createLocString({name:"nextPanelText",translationKey:"pageNextText"}),this.createLocString({name:"noEntriesText",translationKey:"noEntriesText"}),this.createLocString({name:"editPanelText",translationKey:"editText"}),this.createLocString({name:"templateTabTitle",translationKey:"panelDynamicTabTextFormat",supportsMarkdown:!0}),this.createLocString({name:"tabTitlePlaceholder",translationKey:"tabTitlePlaceholder",supportsMarkdown:!0}),this.registerPropertyChangedHandlers(["panelsState"],()=>{this.setPanelsState()}),this.registerPropertyChangedHandlers(["newPanelPosition","displayMode","showProgressBar"],()=>{this.updateFooterActions()}),this.registerPropertyChangedHandlers(["allowAddPanel"],()=>{this.updateNoEntriesTextDefaultLoc()}),this.registerPropertyChangedHandlers(["minPanelCount"],()=>{this.onMinPanelCountChanged()}),this.registerPropertyChangedHandlers(["maxPanelCount"],()=>{this.onMaxPanelCountChanged()}),this.registerPropertyChangedHandlers(["templateQuestionTitleLocation","templateQuestionTitleWidth"],()=>{const t=this.visiblePanelsCore;t&&t.forEach(s=>{s.updateElementCss(!0)})})}get isCompositeQuestion(){return!0}get isContainer(){return!0}getFirstQuestionToFocus(e){for(var t=0;t<this.visiblePanelsCore.length;t++){const s=this.visiblePanelsCore[t].getFirstQuestionToFocus(e);if(s)return s}return this.showAddPanelButton&&(!e||this.currentErrorCount>0)?this:null}getFirstInputElementId(){return this.showAddPanelButton?this.addButtonId:super.getFirstInputElementId()}getFirstErrorInputElementId(){const e=this.getFirstQuestionToFocus(!0);return e?e.inputId:super.getFirstErrorInputElementId()}setSurveyImpl(e,t){super.setSurveyImpl(e,t),this.setTemplatePanelSurveyImpl(),this.setPanelsSurveyImpl()}assignOnPropertyChangedToTemplate(){for(var e=this.template.elements,t=0;t<e.length;t++)this.addOnPropertyChangedCallback(e[t])}addOnPropertyChangedCallback(e){e.isQuestion&&e.setParentQuestion(this),e.onPropertyChanged.add((t,s)=>{this.onTemplateElementPropertyChanged(t,s)}),e.isPanel&&(e.addElementCallback=t=>{this.addOnPropertyChangedCallback(t)})}onTemplateElementPropertyChanged(e,t){if(!(this.isLoadingFromJson||this.useTemplatePanel||this.panelsCore.length==0)){var s=q.findProperty(e.getType(),t.name);if(s)for(var i=this.panelsCore,r=0;r<i.length;r++){var a=i[r].getQuestionByName(e.name);a&&a[t.name]!==t.newValue&&(a[t.name]=t.newValue)}}}get useTemplatePanel(){return this.isDesignMode&&!this.isContentElement}getType(){return"paneldynamic"}clearOnDeletingContainer(){this.panelsCore.forEach(e=>{e.clearOnDeletingContainer()})}get isAllowTitleLeft(){return!1}removeElement(e){return this.template.removeElement(e)}get template(){return this.templateValue}getPanelInDesignMode(){return this.template}getPanels(){return[this.template]}get templateElements(){return this.template.elements}get templateTitle(){return this.template.title}set templateTitle(e){this.template.title=e}get locTemplateTitle(){return this.template.locTitle}get templateTabTitle(){return this.locTemplateTabTitle.text}set templateTabTitle(e){this.locTemplateTabTitle.text=e}get locTemplateTabTitle(){return this.getLocalizableString("templateTabTitle")}get tabTitlePlaceholder(){return this.locTabTitlePlaceholder.text}set tabTitlePlaceholder(e){this.locTabTitlePlaceholder.text=e}get locTabTitlePlaceholder(){return this.getLocalizableString("tabTitlePlaceholder")}get templateDescription(){return this.template.description}set templateDescription(e){this.template.description=e}get locTemplateDescription(){return this.template.locDescription}get templateVisibleIf(){return this.getPropertyValue("templateVisibleIf")}set templateVisibleIf(e){this.setPropertyValue("templateVisibleIf",e),this.template.visibleIf=e}get questionStartIndex(){return this.template.questionStartIndex}set questionStartIndex(e){this.template.questionStartIndex=e}get items(){for(var e=[],t=0;t<this.panelsCore.length;t++)e.push(this.panelsCore[t].data);return e}get panels(){return this.buildPanelsFirstTime(this.canBuildPanels),this.panelsCore}get visiblePanels(){return this.buildPanelsFirstTime(this.canBuildPanels),this.visiblePanelsCore}get panelsCore(){return this.getPropertyValue("panels")}get visiblePanelsCore(){return this.getPropertyValue("visiblePanels")}onPanelAdded(e){if(this.onPanelRemovedCore(e),!e.visible)return;let t=0;const s=this.panelsCore;for(var i=0;i<s.length&&s[i]!==e;i++)s[i].visible&&t++;this.visiblePanelsCore.splice(t,0,e),this.addTabFromToolbar(e,t),this.currentPanel||(this.currentPanel=e),this.updateRenderedPanels()}onPanelRemoved(e){let t=this.onPanelRemovedCore(e);if(this.currentPanel===e){const s=this.visiblePanelsCore;t>=s.length&&(t=s.length-1),this.currentPanel=t>=0?s[t]:null}this.updateRenderedPanels()}onPanelRemovedCore(e){const t=this.visiblePanelsCore;let s=t.indexOf(e);return s>-1&&(t.splice(s,1),this.removeTabFromToolbar(e)),s}get currentIndex(){return this.isRenderModeList?-1:this.useTemplatePanel?0:this.visiblePanelsCore.indexOf(this.currentPanel)}set currentIndex(e){e<0||this.visiblePanelCount<1||(e>=this.visiblePanelCount&&(e=this.visiblePanelCount-1),this.currentPanel=this.visiblePanelsCore[e])}get currentPanel(){if(this.isDesignMode)return this.template;if(this.isRenderModeList||this.useTemplatePanel)return null;let e=this.getPropertyValue("currentPanel",null);return!e&&this.visiblePanelCount>0&&(e=this.visiblePanelsCore[0],this.currentPanel=e),e}set currentPanel(e){if(this.isRenderModeList||this.useTemplatePanel)return;const t=this.getPropertyValue("currentPanel"),s=e?this.visiblePanelsCore.indexOf(e):-1;if(!(e&&s<0||e===t)&&(t&&t.onHidingContent(),e&&e.onFirstRendering(),this.setPropertyValue("currentPanel",e),this.updateRenderedPanels(),this.updateFooterActions(),this.updateTabToolbarItemsPressedState(),this.fireCallback(this.currentIndexChangedCallback),s>-1&&this.survey)){const i={panel:e,visiblePanelIndex:s};this.survey.dynamicPanelCurrentIndexChanged(this,i)}}updateRenderedPanels(){this.isRenderModeList?this.renderedPanels=[].concat(this.visiblePanels):this.currentPanel?this.renderedPanels=[this.currentPanel]:this.renderedPanels=[],this.renderedPanels.forEach(e=>this.panelOnFirstRendering(e))}panelOnFirstRendering(e){e&&(e.onFirstRendering(),e.locStrsChanged())}set renderedPanels(e){this.renderedPanels.length==0||e.length==0?(this.blockAnimations(),this.panelsAnimation.sync(e),this.releaseAnimations()):(this.isPanelsAnimationRunning=!0,this.panelsAnimation.sync(e))}get renderedPanels(){return this._renderedPanels}getPanelsAnimationOptions(){const e=()=>{if(this.isRenderModeList)return"";let t=new z,s=!1;const i=this.renderedPanels.filter(a=>a!==this.currentPanel)[0];let r=this.visiblePanels.indexOf(i);return r<0&&(s=!0,r=this.removedPanelIndex),t.append("sv-pd-animation-adding",!!this.focusNewPanelCallback).append("sv-pd-animation-removing",s).append("sv-pd-animation-left",r<=this.currentIndex).append("sv-pd-animation-right",r>this.currentIndex).toString()};return{getRerenderEvent:()=>this.onElementRerendered,getAnimatedElement:t=>{var s,i;if(t&&this.cssContent){const r=rs(this.cssContent);return(i=(s=this.getWrapperElement())===null||s===void 0?void 0:s.querySelector(`:scope ${r} #${t.id}`))===null||i===void 0?void 0:i.parentElement}},getEnterOptions:()=>{const t=new z().append(this.cssClasses.panelWrapperEnter).append(e()).toString();return{onBeforeRunAnimation:s=>{if(this.focusNewPanelCallback){const i=this.isRenderModeList?s:s.parentElement;yt.ScrollElementToViewCore(i,!1,!1,{behavior:"smooth"})}!this.isRenderModeList&&s.parentElement?en(s.parentElement,{heightTo:s.offsetHeight+"px"}):ni(s)},onAfterRunAnimation:s=>{ys(s),s.parentElement&&ys(s.parentElement)},cssClass:t}},getLeaveOptions:()=>{const t=new z().append(this.cssClasses.panelWrapperLeave).append(e()).toString();return{onBeforeRunAnimation:s=>{!this.isRenderModeList&&s.parentElement?en(s.parentElement,{heightFrom:s.offsetHeight+"px"}):ni(s)},onAfterRunAnimation:s=>{ys(s),s.parentElement&&ys(s.parentElement)},cssClass:t}},isAnimationEnabled:()=>this.animationAllowed&&!!this.getWrapperElement()}}disablePanelsAnimations(){this.panelsCore.forEach(e=>{e.blockAnimations()})}enablePanelsAnimations(){this.panelsCore.forEach(e=>{e.releaseAnimations()})}updatePanelsAnimation(){this._panelsAnimations=new(this.isRenderModeList?Wi:yy)(this.getPanelsAnimationOptions(),(e,t)=>{this._renderedPanels=e,t||(this.isPanelsAnimationRunning=!1,this.focusNewPanel())},()=>this._renderedPanels)}get panelsAnimation(){return this._panelsAnimations||this.updatePanelsAnimation(),this._panelsAnimations}onHidingContent(){super.onHidingContent(),this.currentPanel?this.currentPanel.onHidingContent():this.visiblePanelsCore.forEach(e=>e.onHidingContent())}get confirmDelete(){return this.getPropertyValue("confirmDelete")}set confirmDelete(e){this.setPropertyValue("confirmDelete",e)}get keyName(){return this.getPropertyValue("keyName","")}set keyName(e){this.setPropertyValue("keyName",e)}get confirmDeleteText(){return this.getLocalizableStringText("confirmDeleteText")}set confirmDeleteText(e){this.setLocalizableStringText("confirmDeleteText",e)}get locConfirmDeleteText(){return this.getLocalizableString("confirmDeleteText")}get keyDuplicationError(){return this.getLocalizableStringText("keyDuplicationError")}set keyDuplicationError(e){this.setLocalizableStringText("keyDuplicationError",e)}get locKeyDuplicationError(){return this.getLocalizableString("keyDuplicationError")}get prevPanelText(){return this.getLocalizableStringText("prevPanelText")}set prevPanelText(e){this.setLocalizableStringText("prevPanelText",e)}get locPrevPanelText(){return this.getLocalizableString("prevPanelText")}get panelPrevText(){return this.prevPanelText}set panelPrevText(e){this.prevPanelText=e}get locPanelPrevText(){return this.locPrevPanelText}get nextPanelText(){return this.getLocalizableStringText("nextPanelText")}set nextPanelText(e){this.setLocalizableStringText("nextPanelText",e)}get locNextPanelText(){return this.getLocalizableString("nextPanelText")}get panelNextText(){return this.nextPanelText}set panelNextText(e){this.nextPanelText=e}get locPanelNextText(){return this.locNextPanelText}get addPanelText(){return this.getLocalizableStringText("addPanelText")}set addPanelText(e){this.setLocalizableStringText("addPanelText",e)}get locAddPanelText(){return this.getLocalizableString("addPanelText")}get panelAddText(){return this.addPanelText}set panelAddText(e){this.addPanelText=e}get locPanelAddText(){return this.locAddPanelText}get removePanelText(){return this.getLocalizableStringText("removePanelText")}set removePanelText(e){this.setLocalizableStringText("removePanelText",e)}get locRemovePanelText(){return this.getLocalizableString("removePanelText")}get panelRemoveText(){return this.removePanelText}set panelRemoveText(e){this.removePanelText=e}get locPanelRemoveText(){return this.locRemovePanelText}get isProgressTopShowing(){return this.displayMode=="carousel"&&(this.progressBarLocation==="top"||this.progressBarLocation==="topBottom")}get isProgressBottomShowing(){return this.displayMode=="carousel"&&(this.progressBarLocation==="bottom"||this.progressBarLocation==="topBottom")}get isPrevButtonVisible(){return this.currentIndex>0}get isPrevButtonShowing(){return this.isPrevButtonVisible}get isNextButtonVisible(){return this.currentIndex>=0&&this.currentIndex<this.visiblePanelCount-1}get isNextButtonShowing(){return this.isNextButtonVisible}get isRangeShowing(){return this.showProgressBar&&this.currentIndex>=0&&this.visiblePanelCount>1}getElementsInDesign(e=!1){return e?[this.template]:this.templateElements}prepareValueForPanelCreating(){this.addingNewPanelsValue=this.value,this.isAddingNewPanels=!0,this.isNewPanelsValueChanged=!1}setValueAfterPanelsCreating(){this.isAddingNewPanels=!1,this.isNewPanelsValueChanged&&(this.isValueChangingInternally=!0,this.value=this.addingNewPanelsValue,this.isValueChangingInternally=!1)}getValueCore(){return this.isAddingNewPanels?this.addingNewPanelsValue:super.getValueCore()}setValueCore(e){this.isAddingNewPanels?(this.isNewPanelsValueChanged=!0,this.addingNewPanelsValue=e):super.setValueCore(e)}setIsMobile(e){super.setIsMobile(e),(this.panelsCore||[]).forEach(t=>t.getQuestions(!0).forEach(s=>{s.setIsMobile(e)}))}themeChanged(e){super.themeChanged(e),(this.panelsCore||[]).forEach(t=>t.getQuestions(!0).forEach(s=>{s.themeChanged(e)}))}get panelCount(){return!this.canBuildPanels||this.wasNotRenderedInSurvey?this.getPropertyValue("panelCount"):this.panelsCore.length}set panelCount(e){if(e<0)return;if(!this.isLoadingFromJson&&this.isDesignMode){const s=this.minPanelCount;e<s&&(e=s);const i=this.maxPanelCount;i>0&&e>i&&(e=i)}if(!this.canBuildPanels||this.wasNotRenderedInSurvey){this.setPropertyValue("panelCount",e),this.updateFooterActions();return}if(e==this.panelsCore.length||this.useTemplatePanel)return;this.updateBindings("panelCount",e),this.prepareValueForPanelCreating();const t=e-this.panelCount===1;for(let s=this.panelCount;s<e;s++){const i=this.createNewPanel();this.panelsCore.push(i),this.displayMode=="list"&&this.panelsState!="default"&&(this.panelsState==="expanded"?i.expand():i.title&&i.collapse())}t&&this.singleInputOnAddItem(this.settingPanelCountBasedOnValue),e<this.panelCount&&this.panelsCore.splice(e,this.panelCount-e),this.disablePanelsAnimations(),this.setValueAfterPanelsCreating(),this.setValueBasedOnPanelCount(),this.reRunCondition(),this.updateFooterActions(),this.fireCallback(this.panelCountChangedCallback),this.enablePanelsAnimations()}get visiblePanelCount(){return this.visiblePanels.length}get panelsState(){return this.getPropertyValue("panelsState")}set panelsState(e){this.setPropertyValue("panelsState",e)}getStructuredValue(e=-1){if(e<0||this.isEmpty()||!Array.isArray(this.value))return this.value;const t=new Array,s=Math.min(this.visiblePanelCount,this.value.length);for(let i=0;i<s;i++){const r=this.visiblePanels[i],a={};r.collectValues(a,e),t.push(a)}return t}setTemplatePanelSurveyImpl(){this.template.setSurveyImpl(this.useTemplatePanel?this.surveyImpl:new ES(this))}setPanelsSurveyImpl(){for(var e=0;e<this.panelsCore.length;e++){var t=this.panelsCore[e];t!=this.template&&t.setSurveyImpl(t.data)}}setPanelsState(){if(!(this.useTemplatePanel||this.displayMode!="list"||!this.templateTitle))for(var e=0;e<this.panelsCore.length;e++){var t=this.panelsState;t==="firstExpanded"&&(t=e===0?"expanded":"collapsed"),this.panelsCore[e].state=t}}setValueBasedOnPanelCount(){var e=this.value;if((!e||!Array.isArray(e))&&(e=[]),e.length!=this.panelCount){for(var t=e.length;t<this.panelCount;t++){const s=this.panels[t].getValue(),i=O.isValueEmpty(s)?{}:s;e.push(i)}e.length>this.panelCount&&e.splice(this.panelCount,e.length-this.panelCount),this.isValueChangingInternally=!0,this.value=e,this.isValueChangingInternally=!1}}get minPanelCount(){return this.getPropertyValue("minPanelCount")}set minPanelCount(e){e<0&&(e=0),this.setPropertyValue("minPanelCount",e)}onMinPanelCountChanged(){const e=this.minPanelCount;e>this.maxPanelCount&&(this.maxPanelCount=e),this.panelCount<e&&(this.panelCount=e)}get maxPanelCount(){return this.getPropertyValue("maxPanelCount")}set maxPanelCount(e){e<=0||(e>A.panel.maxPanelCount&&(e=A.panel.maxPanelCount),this.setPropertyValue("maxPanelCount",e),this.updateFooterActions())}onMaxPanelCountChanged(){const e=this.maxPanelCount;e<this.minPanelCount&&(this.minPanelCount=e),this.panelCount>e&&(this.panelCount=e),this.updateFooterActions()}get allowAddPanel(){return this.getPropertyValue("allowAddPanel")}set allowAddPanel(e){this.setPropertyValue("allowAddPanel",e)}get addButtonId(){return this.id+"addPanel"}get newPanelPosition(){return this.getPropertyValue("newPanelPosition")}set newPanelPosition(e){this.setPropertyValue("newPanelPosition",e)}get allowRemovePanel(){return this.getPropertyValue("allowRemovePanel")}set allowRemovePanel(e){this.setPropertyValue("allowRemovePanel",e)}get templateQuestionTitleLocation(){return this.getPropertyValue("templateQuestionTitleLocation")}set templateQuestionTitleLocation(e){this.setPropertyValue("templateQuestionTitleLocation",e)}get templateTitleLocation(){return this.templateQuestionTitleLocation}set templateTitleLocation(e){this.templateQuestionTitleLocation=e}get templateQuestionTitleWidth(){return this.template.questionTitleWidth}set templateQuestionTitleWidth(e){this.template.questionTitleWidth=e}get templateErrorLocation(){return this.getPropertyValue("templateErrorLocation")}set templateErrorLocation(e){this.setPropertyValue("templateErrorLocation",e.toLowerCase())}resetSingleInput(){super.resetSingleInput(),this.locTemplateTitle.onGetTextCallback=null}getSingleInputQuestionsCore(e,t){this.onFirstRendering();const s=new Array,i=this.visiblePanels;if(t)for(let r=0;r<i.length;r++){const a=i[r];(!a.hasValueAnyQuestion(!0)||!a.validate(!1,!1))&&this.fillSingleInputQuestionsByPanel(s,a)}return this.getSingleInputQuestionsForDynamic(e,s)}fillSingleInputQuestionsInContainer(e,t){const s=this.getPanelByQuestion(t);this.fillSingleInputQuestionsByPanel(e,s)}fillSingleInputQuestionsByPanel(e,t){t&&t.visibleQuestions.forEach(s=>s.addNestedQuestion(e,!0,!1,!1))}getSingleQuestionLocTitleCore(){const e=this.locTemplateTitle;return e.onGetTextCallback=t=>{const s=this.singleInputQuestion;return s?this.processSingleInputTitle(t,this.getPanelByQuestion(s)):t},e}processSingleInputTitle(e,t){return e||(e=this.getSingleInputTitleTemplate()),t?t.getProcessedText(e):e}getSingleInputTitleTemplate(){return this.getLocalizationString("panelDynamicTabTextFormat")}getPanelByQuestion(e){let t=e.parent;for(;t&&t.parent;)t=t.parent;return t}getSingleInputAddTextCore(){if(this.canAddPanel)return this.addPanelText}singleInputAddItemCore(){this.addPanelUI()}getSingleQuestionOnChange(e){const t=this.visiblePanelsCore;if(t.length>0){(e<0||e>=t.length)&&(e=t.length-1);const i=t[e].visibleQuestions;if(i.length>0)return i[0]}return null}createSingleInputSummary(){const e=new Fy(this,this.locNoEntriesText),t=new Array;return this.visiblePanels.forEach(s=>{const i=new At(this,!0,void 0,this.locTemplateTitle.localizationName);i.setJson(this.locTemplateTitle.getJson()),i.onGetTextCallback=o=>this.processSingleInputTitle(this.templateTitle,s);const r=new Pe({locTitle:this.getLocalizableString("editPanelText"),action:()=>{this.singInputEditPanel(s)}}),a=this.canRemovePanel?new Pe({locTitle:this.locPanelRemoveText,action:()=>{this.removePanelUI(s)}}):void 0;t.push(new By(i,r,a))}),e.items=t,e}singleInputMoveToFirstCore(){var e;let t=(e=this.singleInputQuestion)===null||e===void 0?void 0:e.parent;for(;t&&t.parent;)t=t.parent;this.singInputEditPanel(t)}singInputEditPanel(e){if(!e)return;const t=e.visibleQuestions;t.length>0&&this.setSingleInputQuestion(t[0])}get showQuestionNumbers(){return this.getPropertyValue("showQuestionNumbers")}set showQuestionNumbers(e){e||(e="off"),e=e.toLowerCase(),e==="onsurvey"&&(e="default"),this.setPropertyValue("showQuestionNumbers",e),!this.isLoadingFromJson&&this.survey&&this.survey.questionVisibilityChanged(this,this.visible,!0)}getShowQuestionNumbers(){var e;const t=this.showQuestionNumbers;if(t==="default"){const s=(e=this.survey)===null||e===void 0?void 0:e.showQuestionNumbers;if(s==="recursive")return s}return t}notifySurveyOnChildrenVisibilityChanged(){return this.showQuestionNumbers==="default"}get removePanelButtonLocation(){return this.getPropertyValue("removePanelButtonLocation")}set removePanelButtonLocation(e){this.setPropertyValue("removePanelButtonLocation",e)}get panelRemoveButtonLocation(){return this.removePanelButtonLocation}set panelRemoveButtonLocation(e){this.removePanelButtonLocation=e}get showRangeInProgress(){return this.showProgressBar}set showRangeInProgress(e){this.showProgressBar=e}get renderMode(){let e=this.displayMode;if(e=="carousel"){const t=this.progressBarLocation;if(t=="top")return"progressTop";if(t=="bottom")return"progressBottom";if(t=="topBottom")return"progressTopBottom"}return e}set renderMode(e){(e||"").startsWith("progress")?(e=="progressTop"?this.progressBarLocation="top":e=="progressBottom"?this.progressBarLocation="bottom":e=="progressTopBottom"&&(this.progressBarLocation="topBottom"),this.displayMode="carousel"):this.displayMode=e}updatePanelView(){this.blockAnimations(),this.updateRenderedPanels(),this.releaseAnimations(),this.updatePanelsAnimation()}get tabAlign(){return this.getPropertyValue("tabAlign")}set tabAlign(e){this.setPropertyValue("tabAlign",e),this.isRenderModeTab&&(this.tabbedMenu.containerCss=this.getTabbedMenuCss())}get isRenderModeList(){return this.displayMode==="list"||this.isSingleInputActive}get isRenderModeTab(){return this.displayMode==="tab"&&!this.isSingleInputActive}setVisibleIndex(e){const t=this.isDesignMode?[this.template]:this.visiblePanelsCore;if(this.isVisibleIndexNegative(e))return t.forEach(a=>a.setVisibleIndex(-1)),super.setVisibleIndex(-1);const s=this.getShowQuestionNumbers(),i=s==="default";let r=i?e:0;for(let a=0;a<t.length;a++){let o=this.setPanelVisibleIndex(t[a],r,s!="off");i&&(r+=o)}return super.setVisibleIndex(i?-1:e),i?r-e:1}setPanelVisibleIndex(e,t,s){return s?e.setVisibleIndex(t):(e.setVisibleIndex(-1),0)}get canAddPanel(){return this.isDesignMode||!this.legacyNavigation&&!this.isRenderModeList&&this.currentIndex<this.visiblePanelCount-1&&this.newPanelPosition!=="next"?!1:this.allowAddPanel&&!this.isReadOnly&&this.panelCount<this.maxPanelCount}get canRemovePanel(){return this.isDesignMode?!1:this.allowRemovePanel&&!this.isReadOnly&&this.panelCount>this.minPanelCount}rebuildPanels(){if(!this.isLoadingFromJson){this.prepareValueForPanelCreating();var e=[];if(this.useTemplatePanel)new pv(this,this.template),e.push(this.template);else for(var t=0;t<this.panelCount;t++)e.push(this.createNewPanel());this.panelsCore.splice(0,this.panelsCore.length,...e),this.setValueAfterPanelsCreating(),this.setPanelsState(),this.reRunCondition(),this.updateFooterActions(),this.fireCallback(this.panelCountChangedCallback),this.updateTabToolbar()}}get defaultPanelValue(){return this.getPropertyValue("defaultPanelValue")}set defaultPanelValue(e){this.setPropertyValue("defaultPanelValue",e)}get copyDefaultValueFromLastEntry(){return this.getPropertyValue("copyDefaultValueFromLastEntry")}set copyDefaultValueFromLastEntry(e){this.setPropertyValue("copyDefaultValueFromLastEntry",e)}get defaultValueFromLastPanel(){return this.copyDefaultValueFromLastEntry}set defaultValueFromLastPanel(e){this.copyDefaultValueFromLastEntry=e}isDefaultValueEmpty(){return super.isDefaultValueEmpty()&&this.isValueEmpty(this.defaultPanelValue)}setDefaultValue(){if(this.isValueEmpty(this.defaultPanelValue)||!this.isValueEmpty(this.defaultValue)){super.setDefaultValue();return}if(!(!this.isEmpty()||this.panelCount==0)){for(var e=[],t=0;t<this.panelCount;t++)e.push(this.defaultPanelValue);this.value=e}}get isValueArray(){return!0}isEmpty(){var e=this.value;if(!e||!Array.isArray(e))return!0;for(var t=0;t<e.length;t++)if(!this.isRowEmpty(e[t]))return!1;return!0}getProgressInfo(){return yt.getProgressInfoByElements(this.visiblePanelsCore,this.isRequired)}isRowEmpty(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}addPanelUI(){return this.addPanel(void 0,!0)}addPanel(e,t){const s=t===!0;if(s&&(!this.canAddPanel||!this.canLeaveCurrentPanel()))return null;const i=this.addPanelCore(e);return this.panelOnFirstRendering(i),s&&(this.displayMode==="list"&&this.panelsState!=="default"&&i.expand(),this.focusNewPanelCallback=()=>{i?.focusFirstQuestion()},this.isPanelsAnimationRunning||this.focusNewPanel()),i}addPanelCore(e){const t=this.currentIndex;return e===void 0&&(e=t<0?this.panelCount:t+1),(e<0||e>this.panelCount)&&(e=this.panelCount),this.updateValueOnAddingPanel(t<0?this.panelCount-1:t,e),this.isRenderModeList||(this.currentIndex=e),this.notifyOnPanelAddedRemoved(!0,e),this.panelsCore[e]}focusNewPanel(){this.focusNewPanelCallback&&(this.focusNewPanelCallback(),this.focusNewPanelCallback=void 0)}updateValueOnAddingPanel(e,t){this.panelCount++;let s=this.value;if(!Array.isArray(s)||s.length!==this.panelCount)return;let i=!1;const r=this.panelCount-1;if(t<r){i=!0;const a=s[r];s.splice(r,1),s.splice(t,0,a)}if(this.isValueEmpty(this.defaultPanelValue)||(i=!0,this.copyValue(s[t],this.defaultPanelValue)),this.copyDefaultValueFromLastEntry&&s.length>1){const a=e>-1&&e<=r?e:r;i=!0,this.copyValue(s[t],s[a])}i&&(this.value=s)}canLeaveCurrentPanel(){return this.displayMode==="list"||!this.currentPanel||this.currentPanel.validate(!0,!0)}copyValue(e,t){for(var s in t)e[s]=t[s]}getPanelRemoveButtonId(e){return e.id+"_remove_button"}isRequireConfirmOnDelete(e){if(!this.confirmDelete)return!1;const t=this.getVisualPanelIndex(e);if(t<0||t>=this.visiblePanelCount)return!1;const s=this.visiblePanelsCore[t].getValue();return!this.isValueEmpty(s)&&(this.isValueEmpty(this.defaultPanelValue)||!this.isTwoValueEquals(s,this.defaultPanelValue))}goToNextPanel(){return this.currentIndex<0||!this.canLeaveCurrentPanel()?!1:(this.currentIndex++,!0)}goToPrevPanel(){this.currentIndex<0||this.currentIndex--}removePanelUI(e){this.removePanel(e,this.isRequireConfirmOnDelete(e))}removePanel(e,t){const s=this.getVisualPanelIndex(e);if(s<0||s>=this.visiblePanelCount)return;if(t!==void 0){if(!this.canRemovePanel)return;const r=()=>{var a;this.removePanelCore(s);const o=this.visiblePanelCount,l=s>=o?o-1:s;let u=o===0?this.addButtonId:l>-1?this.getPanelRemoveButtonId(this.visiblePanels[l]):"";u&&yt.FocusElement(u,!0,(a=this.survey)===null||a===void 0?void 0:a.rootElement)};t?Ga({message:this.confirmDeleteText,funcOnYes:()=>{r()},locale:this.getLocale(),rootElement:this.survey.rootElement,cssClass:this.cssClasses.confirmDialog}):r()}else this.removePanelCore(s)}removePanelCore(e){this.removedPanelIndex=e;const t=this.visiblePanelsCore[e],s=this.panelsCore.indexOf(t);if(!(s<0)&&!(this.survey&&!this.survey.dynamicPanelRemoving(this,s,t))){this.panelsCore.splice(s,1),this.updateBindings("panelCount",this.panelCount),this.singleInputOnRemoveItem(e);var i=this.value;!i||!Array.isArray(i)||s>=i.length?this.updateFooterActions():(this.isValueChangingInternally=!0,i.splice(s,1),this.value=i,this.updateFooterActions(),this.fireCallback(this.panelCountChangedCallback),this.notifyOnPanelAddedRemoved(!1,s,t),this.isValueChangingInternally=!1)}}notifyOnPanelAddedRemoved(e,t,s){s||(s=this.panelsCore[t]);const i=this.getShowQuestionNumbers();if(this.survey){const r=i==="default";e?this.survey.dynamicPanelAdded(this,t,s,r):this.survey.dynamicPanelRemoved(this,t,s,r)}e&&s&&(i==="onpanel"||i==="recursive")&&s.setVisibleIndex(0)}recursiveNoCallback(){return this.getShowQuestionNumbers()==="recursive"?this.no:""}getVisualPanelIndex(e){if(O.isNumber(e))return e;const t=this.visiblePanelsCore;for(var s=0;s<t.length;s++)if(t[s]===e||t[s].data===e)return s;return-1}getPanelVisibleIndexById(e){const t=this.visiblePanelsCore;for(var s=0;s<t.length;s++)if(t[s].id===e)return s;return-1}locStrsChanged(){super.locStrsChanged(),this.locTemplateTitle.strChanged();for(var e=this.panelsCore,t=0;t<e.length;t++)e[t].locStrsChanged();this.tabbedMenu&&this.tabbedMenu.locStrsChanged()}clearIncorrectValues(){for(var e=0;e<this.panelsCore.length;e++)this.clearIncorrectValuesInPanel(e)}clearErrors(){super.clearErrors();for(var e=0;e<this.panelsCore.length;e++)this.panelsCore[e].clearErrors()}getQuestionFromArray(e,t){return t<0||t>=this.panelsCore.length?null:this.panelsCore[t].getQuestionByName(e)}clearIncorrectValuesInPanel(e){var t=this.panelsCore[e];t.clearIncorrectValues();var s=this.value,i=s&&e<s.length?s[e]:null;if(i){var r=!1;for(var a in i)if(!this.getSharedQuestionFromArray(a,e)){var o=t.getQuestionByValueName(a);o||this.iscorrectValueWithPostPrefix(t,a,A.commentSuffix)||this.iscorrectValueWithPostPrefix(t,a,A.matrix.totalsSuffix)||(delete i[a],r=!0)}r&&(s[e]=i,this.value=s)}}iscorrectValueWithPostPrefix(e,t,s){return t.indexOf(s)!==t.length-s.length?!1:!!e.getQuestionByName(t.substring(0,t.indexOf(s)))}getSharedQuestionFromArray(e,t){return this.survey&&this.valueName?this.survey.getQuestionByValueNameFromArray(this.valueName,e,t):null}addConditionObjectsByContext(e,t){const s=t?.isValidator?t.errorOwner:t,i=!!t&&(t===!0||this.template.questions.indexOf(s)>-1),r=new Array,a=this.template.questions;for(var o=0;o<a.length;o++)a[o].addConditionObjectsByContext(r,t);for(var l=0;l<A.panel.maxPanelCountInCondition;l++){const u="["+l+"].",d=this.getValueName()+u,h=this.processedTitle+u;for(var o=0;o<r.length;o++)r[o].context?e.push(r[o]):e.push({name:d+r[o].name,text:h+r[o].text,question:r[o].question})}if(i){const u=t===!0?this.getValueName()+".":"",d=t===!0?this.processedTitle+".":"",h=A.expressionVariables.panel+".";for(var o=0;o<r.length;o++){if(r[o].question==t)continue;const C={name:u+h+r[o].name,text:d+h+r[o].text,question:r[o].question};C.context=this,e.push(C)}}}collectNestedQuestionsCore(e,t,s,i){i&&e.push(this);const r=t?this.visiblePanelsCore:this.panelsCore;Array.isArray(r)&&r.forEach(a=>{a.questions.forEach(o=>o.addNestedQuestion(e,t,s,i))})}getConditionJson(e=null,t=null){if(!t)return super.getConditionJson(e);var s=t,i=t.indexOf(".");i>-1&&(s=t.substring(0,i),t=t.substring(i+1));var r=this.template.getQuestionByName(s);return r?r.getConditionJson(e,t):null}onReadOnlyChanged(){var e=this.isReadOnly;this.template.readOnly=e;for(var t=0;t<this.panelsCore.length;t++)this.panelsCore[t].readOnly=e;this.updateNoEntriesTextDefaultLoc(),this.updateFooterActions(),super.onReadOnlyChanged()}updateNoEntriesTextDefaultLoc(){const e=this.getLocalizableString("noEntriesText");e&&(e.localizationName=this.isReadOnly||!this.allowAddPanel?"noEntriesReadonlyText":"noEntriesText")}onSurveyLoad(){this.template.readOnly=this.isReadOnly,this.template.onSurveyLoad();const e=this.adjustPanelCount();e>-1&&this.setPropertyValue("panelCount",e),super.onSurveyLoad()}adjustPanelCount(){const e=this.getPropertyValue("panelCount");return e<this.minPanelCount?this.minPanelCount:e>this.maxPanelCount?this.maxPanelCount:-1}buildPanelsFirstTime(e=!1){if(!this.hasPanelBuildFirstTime&&!(!e&&this.wasNotRenderedInSurvey)){if(this.blockAnimations(),this.hasPanelBuildFirstTime=!0,this.isBuildingPanelsFirstTime=!0,this.getPropertyValue("panelCount")>0&&(this.panelCount=this.getPropertyValue("panelCount")),this.useTemplatePanel&&this.rebuildPanels(),this.setPanelsSurveyImpl(),this.setPanelsState(),this.assignOnPropertyChangedToTemplate(),this.data&&this.isValueChangedWithoutPanels&&(this.isValueChangedWithoutPanels=!1,this.runTriggersOnBuildPanelsFirstTime()),this.survey)for(var t=0;t<this.panelCount;t++)this.notifyOnPanelAddedRemoved(!0,t);this.updateIsReady(),this.showAddPanelButton||this.updateNoEntriesTextDefaultLoc(),this.updateFooterActions(),this.isBuildingPanelsFirstTime=!1,this.releaseAnimations()}}runTriggersOnBuildPanelsFirstTime(){this.value,this.visiblePanelsCore.forEach(e=>{const t=this.getPanelItemData(e.data);if(!O.isValueEmpty(t)){const s=O.createCopyWithPrefix(t,A.expressionVariables.panel+".");e.questions.forEach(i=>i.runTriggers("",void 0,s))}})}get showAddPanelButton(){return this.allowAddPanel&&!this.isReadOnly}get wasNotRenderedInSurvey(){return!this.hasPanelBuildFirstTime&&!this.wasRendered&&!!this.survey}get canBuildPanels(){return!this.isLoadingFromJson&&!this.useTemplatePanel}onFirstRenderingCore(){super.onFirstRenderingCore(),this.buildPanelsFirstTime(),this.template.onFirstRendering()}localeChanged(){super.localeChanged(),this.panelsCore.forEach(e=>e.localeChanged())}runConditionCore(e){super.runConditionCore(e),this.runPanelsCondition(this.panelsCore,e)}runTriggers(e,t,s){super.runTriggers(e,t,s),this.visiblePanelsCore.forEach(i=>{i.questions.forEach(r=>r.runTriggers(e,t,s))})}reRunCondition(){this.data&&this.runCondition(this.getDataFilteredProperties())}runPanelsCondition(e,t){this.isValueChangingInternally=!0;for(var s=0;s<e.length;s++){const i=e[s],r=A.expressionVariables.panel,a=O.createCopy(t);a[r]=i,i.runCondition(a),i.isVisible}this.isValueChangingInternally=!1}onAnyValueChanged(e,t){super.onAnyValueChanged(e,t),!this.hasPanelBuildFirstTime&&e===this.getValueName()&&(this.isValueChangedWithoutPanels=!0);for(var s=0;s<this.panelsCore.length;s++)this.panelsCore[s].onAnyValueChanged(e,t),this.panelsCore[s].onAnyValueChanged(A.expressionVariables.panel,"")}hasKeysDuplicated(e){for(var t=[],s,i=0;i<this.panelsCore.length;i++)s=this.isValueDuplicated(this.panelsCore[i],t,e)||s;return s}updatePanelsContainsErrors(){const e=this.changingValueQuestions;if(!(!Array.isArray(e)||e.length===0)){for(var t=e[0],s=t.parent;s;)s.updateContainsErrors(),s=s.parent;this.updateContainsErrors()}}validateElementCore(e){if(this.isValueChangingInternally&&!this.hasInputInChangedQuestions()||this.isBuildingPanelsFirstTime)return!0;let t=!0;const s=this.changingValueQuestions;if(Array.isArray(s)){let i=!0;s.forEach(r=>{i=r.validateElement(e)&&i}),t=!this.hasKeysDuplicated(e)&&i,this.updatePanelsContainsErrors()}else t=this.validateInPanels(e);return super.validateElementCore(e)&&t}hasInputInChangedQuestions(){const e=this.changingValueQuestions;if(!Array.isArray(e)||e.length===0)return!1;for(let t=0;t<e.length;t++)if(e[t].hasInput)return!0;return!1}getContainsErrors(){var e=super.getContainsErrors();if(e)return e;for(var t=this.panelsCore,s=0;s<t.length;s++)if(t[s].containsErrors)return!0;return!1}getIsAnswered(){if(!super.getIsAnswered())return!1;for(var e=this.visiblePanelsCore,t=0;t<e.length;t++){var s=[];e[t].addQuestionsToList(s,!0);for(var i=0;i<s.length;i++)if(!s[i].isAnswered)return!1}return!0}clearValueOnHidding(e){if(!e){if(this.survey&&this.survey.getQuestionClearIfInvisible("onHidden")==="none")return;this.clearValueInPanelsIfInvisible("onHiddenContainer")}super.clearValueOnHidding(e)}clearValueIfInvisible(e="onHidden"){const t=e==="onHidden"?"onHiddenContainer":e;this.clearValueInPanelsIfInvisible(t),super.clearValueIfInvisible(e)}clearValueInPanelsIfInvisible(e){for(var t=0;t<this.panelsCore.length;t++){const r=this.panelsCore[t];var s=r.questions;this.isSetPanelItemData={};for(var i=0;i<s.length;i++){const a=s[i];a.visible&&!r.isVisible||(a.clearValueIfInvisible(e),this.isSetPanelItemData[a.getValueName()]=this.maxCheckCount+1)}}this.isSetPanelItemData={}}getIsRunningValidators(){if(super.getIsRunningValidators())return!0;for(var e=0;e<this.panelsCore.length;e++)for(var t=this.panelsCore[e].questions,s=0;s<t.length;s++)if(t[s].isRunningValidators)return!0;return!1}getAllErrors(){var e=super.getAllErrors();const t=this.visiblePanelsCore;for(var s=0;s<t.length;s++)for(var i=t[s].questions,r=0;r<i.length;r++){var a=i[r].getAllErrors();a&&a.length>0&&(e=e.concat(a))}return e}getValueGetterContext(){return new IS(this)}getDisplayValueCore(e,t){var s=this.getUnbindValue(t);if(!s||!Array.isArray(s))return s;for(var i=0;i<this.panelsCore.length&&i<s.length;i++){var r=s[i];r&&(s[i]=this.getPanelDisplayValue(i,r,e))}return s}getPanelDisplayValue(e,t,s){if(!t)return t;for(var i=this.panelsCore[e],r=Object.keys(t),a=0;a<r.length;a++){var o=r[a],l=i.getQuestionByValueName(o);if(l||(l=this.getSharedQuestionFromArray(o,e)),l){var u=l.getDisplayValue(s,t[o]);t[o]=u,s&&l.title&&l.title!==o&&(t[l.title]=u,delete t[o])}}return t}validateInPanels(e){let t=!0;const s=this.visiblePanels,i=[];for(let r=0;r<s.length;r++){let a=s[r].validateElement(e);a=!this.isValueDuplicated(s[r],i,e)&&a,!this.isRenderModeList&&!a&&t&&e.focusOnFirstError&&(this.currentIndex=r),t=a&&t}return t}isValueDuplicated(e,t,s){if(!this.keyName)return!1;var i=e.getQuestionByValueName(this.keyName);if(!i||i.isEmpty())return!1;var r=i.value;const a=this.changingValueQuestions;Array.isArray(a)&&a.indexOf(i)<0&&i.validateElement(s);for(var o=0;o<t.length;o++)if(r==t[o])return s.fireCallback&&i.addError(new Py(this.keyDuplicationError,this)),s.setErrorElement(i),!0;return t.push(r),!1}getPanelActions(e){let t=e.footerActions;return this.removePanelButtonLocation!=="right"&&t.push(new Pe({id:`remove-panel-${e.id}`,component:"sv-paneldynamic-remove-btn",visible:new We(()=>[this.canRenderRemovePanel(e,"bottom")].every(s=>s===!0)),data:{question:this,panel:e}})),this.survey&&(t=this.survey.getUpdatedPanelFooterActions(e,t,this)),t}canRenderRemovePanelOnRight(e){return this.canRenderRemovePanel(e,"right")}canRenderRemovePanel(e,t){const s=this.canRemovePanel,i=e.state!=="collapsed";return this.removePanelButtonLocation===t&&s&&i}createNewPanel(){var e=this.createAndSetupNewPanelObject(),t=this.template.toJSON();return new qt().toObject(t,e),e.renderWidth="100%",e.updateCustomWidgets(),e.questions.forEach(s=>s.setParentQuestion(this)),new pv(this,e),e.onGetFooterActionsCallback=()=>this.getPanelActions(e),e.onGetFooterToolbarCssCallback=()=>this.cssClasses.panelFooter,e.registerPropertyChangedHandlers(["visible"],()=>{e.visible?this.onPanelAdded(e):this.onPanelRemoved(e),this.updateFooterActions()}),e}createAndSetupNewPanelObject(){var e=this.createNewPanelObject();return e.isInteractiveDesignElement=!1,e.setParentQuestion(this),e.onGetQuestionTitleLocation=()=>this.getTemplateQuestionTitleLocation(),e.onGetQuestionTitleWidth=()=>this.templateQuestionTitleWidth,e.recursiveNoCallback=()=>this.recursiveNoCallback(),e}getTemplateQuestionTitleLocation(){return this.templateQuestionTitleLocation!="default"?this.templateQuestionTitleLocation:this.getParentTitleLocation()}getChildErrorLocation(e){return this.templateErrorLocation!=="default"?this.templateErrorLocation:super.getChildErrorLocation(e)}createNewPanelObject(){return q.createClass("panel")}setPanelCountBasedOnValue(){if(!(this.isValueChangingInternally||this.useTemplatePanel)){var e=this.value,t=e&&Array.isArray(e)?e.length:0;t==0&&this.getPropertyValue("panelCount")>0&&(t=this.getPropertyValue("panelCount")),this.settingPanelCountBasedOnValue=!0,this.panelCount=t,this.settingPanelCountBasedOnValue=!1}}setQuestionValue(e){if(!this.settingPanelCountBasedOnValue){super.setQuestionValue(e,!1),this.setPanelCountBasedOnValue();for(var t=0;t<this.panelsCore.length;t++)this.panelUpdateValueFromSurvey(this.panelsCore[t]);this.updateIsAnswered()}}onSurveyValueChanged(e){if(!(e===void 0&&this.isAllPanelsEmpty())){super.onSurveyValueChanged(e);for(var t=0;t<this.panelsCore.length;t++)this.panelSurveyValueChanged(this.panelsCore[t]);e===void 0&&this.setValueBasedOnPanelCount(),this.updateIsReady()}}isAllPanelsEmpty(){for(var e=0;e<this.panelsCore.length;e++)if(!O.isValueEmpty(this.panelsCore[e].getValue()))return!1;return!0}panelUpdateValueFromSurvey(e){const t=e.questions;for(var s=this.getPanelItemData(e.data),i=0;i<t.length;i++){const r=t[i];r.updateValueFromSurvey(s[r.getValueName()]),r.updateCommentFromSurvey(s[r.getValueName()+A.commentSuffix]),r.initDataUI()}}panelSurveyValueChanged(e){for(var t=e.questions,s=this.getPanelItemData(e.data),i=0;i<t.length;i++){var r=t[i];r.onSurveyValueChanged(s[r.getValueName()])}}onSetData(){super.onSetData(),!this.isLoadingFromJson&&this.useTemplatePanel&&(this.setTemplatePanelSurveyImpl(),this.rebuildPanels())}isNewValueCorrect(e){return Array.isArray(e)}getValueChangingOptions(e){let t=e.parent;for(;t.parent;)t=t.parent;const s=t,i=this.panels.indexOf(s);return{question:this,panel:s,name:e.name,panelIndex:i,panelData:this.getPanelItemDataByIndex(i),oldValue:e.value}}getItemIndex(e){var t=this.items.indexOf(e);return t>-1?t:this.items.length}getVisibleItemIndex(e){const t=this.visiblePanelsCore;for(var s=0;s<t.length;s++)if(t[s].data===e)return s;return t.length}getPanelItemData(e){return this.getPanelItemDataByIndex(this.items.indexOf(e))}getPanelItemDataByIndex(e){const t=this.items;var s=this.value;return e<0&&Array.isArray(s)&&s.length>t.length&&(e=t.length),e<0?{}:!s||!Array.isArray(s)||s.length<=e?{}:s[e]}setPanelItemData(e,t,s){if(this.isSetPanelItemData[t]>this.maxCheckCount)return;this.isSetPanelItemData[t]||(this.isSetPanelItemData[t]=0),this.isSetPanelItemData[t]++;var i=this.items,r=i.indexOf(e);r<0&&(r=i.length);var a=this.getUnbindValue(this.value);(!a||!Array.isArray(a))&&(a=[]);const o=Math.max(r+1,i.length);for(var l=a.length;l<o;l++)a.push({});a[r]||(a[r]={}),this.isValueEmpty(s)?delete a[r][t]:a[r][t]=s,r>=0&&r<this.panelsCore.length&&(Array.isArray(this.changingValueQuestions)||(this.changingValueQuestions=[]),this.changingValueQuestions.push(this.panelsCore[r].getQuestionByValueName(t))),this.value=a,this.changingValueQuestions=null,this.isSetPanelItemData[t]--,this.isSetPanelItemData[t]-1&&delete this.isSetPanelItemData[t]}getRootData(){return this.data}getPlainData(e={includeEmpty:!0}){var t=super.getPlainData(e);if(t){t.isNode=!0;const s=Array.isArray(t.data)?[].concat(t.data):[];t.data=this.panels.map((i,r)=>{var a={name:i.name||r,title:i.title||"Panel",value:i.getValue(),displayValue:i.getValue(),getString:o=>typeof o=="object"?JSON.stringify(o):o,isNode:!0,data:i.questions.map(o=>o.getPlainData(e)).filter(o=>!!o)};return(e.calculations||[]).forEach(o=>{a[o.propertyName]=i[o.propertyName]}),a}),t.data=t.data.concat(s)}return t}updateElementCss(e){super.updateElementCss(e);for(var t=0;t<this.panelsCore.length;t++){var s=this.panelsCore[t];s.updateElementCss(e)}}get progressText(){var e=this.visiblePanelCount;return this.getLocalizationFormatString("panelDynamicProgressText",this.currentIndex+1,e)}get progress(){return(this.currentIndex+1)/this.visiblePanelCount*100+"%"}get progressBarAriaLabel(){return Ct("progressbar",this.getLocale())}getRootCss(){return new z().append(super.getRootCss()).append(this.cssClasses.empty,this.getShowNoEntriesPlaceholder()).toString()}get cssHeader(){const e=this.isRenderModeTab&&!!this.visiblePanelCount;return new z().append(super.getCssHeader(this.cssClasses)).append(this.cssClasses.headerTab,this.hasTitleOnTop&&e).toString()}getTabsContainerCss(){return new z().append(this.cssClasses.tabsContainer).append(this.cssClasses.tabsContainerWithHeader,this.hasTitleOnTop).toString()}getPanelWrapperCss(e){return new z().append(this.cssClasses.panelWrapper,!e||e.visible).append(this.cssClasses.panelWrapperList,this.isRenderModeList).append(this.cssClasses.panelWrapperInRow,this.removePanelButtonLocation==="right").toString()}getPanelRemoveButtonCss(){return new z().append(this.cssClasses.button).append(this.cssClasses.buttonRemove).append(this.cssClasses.buttonRemoveRight,this.removePanelButtonLocation==="right").toString()}getAddButtonCss(){return new z().append(this.cssClasses.button).append(this.cssClasses.buttonAdd).append(this.cssClasses.buttonAdd+"--list-mode",this.displayMode==="list").toString()}getPrevButtonCss(){return new z().append(this.cssClasses.buttonPrev).append(this.cssClasses.buttonPrevDisabled,!this.isPrevButtonVisible).toString()}getNextButtonCss(){return new z().append(this.cssClasses.buttonNext).append(this.cssClasses.buttonNextDisabled,!this.isNextButtonVisible).toString()}get noEntriesText(){return this.getLocalizableStringText("noEntriesText")}set noEntriesText(e){this.setLocalizableStringText("noEntriesText",e)}get locNoEntriesText(){return this.getLocalizableString("noEntriesText")}getShowNoEntriesPlaceholder(){return!!this.cssClasses.noEntriesPlaceholder&&!this.isDesignMode&&this.visiblePanelCount===0}needResponsiveWidth(){const e=this.getPanels();for(let t=0;t<e.length;t++){const s=e[t];if(s.isVisible&&s.needResponsiveWidth())return!0}return!1}get hasTabbedMenu(){return this.isRenderModeTab&&this.visiblePanels.length>0}get tabbedMenu(){return this.isRenderModeTab?(this.tabbedMenuValue||(this.tabbedMenuValue=new Wa,this.tabbedMenuValue.dotsItem.popupModel.showPointer=!1,this.tabbedMenuValue.dotsItem.popupModel.verticalPosition="bottom",this.tabbedMenuValue.dotsItem.popupModel.horizontalPosition="center",this.updateElementCss(!1)),this.tabbedMenuValue):null}get showFooterToolbar(){return this.footerToolbar&&this._showFooterToolbar}get footerToolbar(){return this.footerToolbarValue||this.initFooterToolbar(),this.footerToolbarValue}get ariaRole(){return"group"}get ariaRequired(){return null}get ariaInvalid(){return null}updateFooterActions(){this.updateFooterActionsCallback&&this.updateFooterActionsCallback()}initFooterToolbar(){this.footerToolbarValue=this.createActionContainer();const e=[],t=new Pe({id:"sv-pd-prev-btn",title:this.prevPanelText,action:()=>{this.goToPrevPanel()}}),s=new Pe({id:"sv-pd-next-btn",title:this.nextPanelText,action:()=>{this.goToNextPanel()}}),i=new Pe({id:"sv-pd-add-btn",component:"sv-paneldynamic-add-btn",data:{question:this}}),r=new Pe({id:"sv-prev-btn-icon",component:"sv-paneldynamic-prev-btn",data:{question:this}}),a=new Pe({id:"sv-pd-progress-text",component:"sv-paneldynamic-progress-text",data:{question:this}}),o=new Pe({id:"sv-pd-next-btn-icon",component:"sv-paneldynamic-next-btn",data:{question:this}});e.push(t,s,i,r,a,o),this.updateFooterActionsCallback=()=>{const l=this.legacyNavigation,u=this.isRenderModeList,d=this.isMobile,h=!l&&!u;t.visible=h&&this.currentIndex>0,s.visible=h&&this.currentIndex<this.visiblePanelCount-1,s.needSpace=d&&s.visible&&t.visible,i.visible=this.canAddPanel,i.needSpace=this.isMobile&&!s.visible&&t.visible,a.visible=!this.isRenderModeList&&!d,a.needSpace=!l&&!this.isMobile;const f=l&&!u;r.visible=f,o.visible=f,r.needSpace=f},this.updateFooterActionsCallback(),this.footerToolbarValue.setItems(e),this.footerToolbar.flushUpdates(),this._showFooterToolbar=new We(()=>{var l;return(l=this.footerToolbarValue)===null||l===void 0?void 0:l.hasVisibleActions})}createTabByPanel(e,t){if(!this.isRenderModeTab)return;const s=new At(e,!0);s.onGetTextCallback=o=>{if(o||(o=this.locTabTitlePlaceholder.renderedHtml),!this.survey)return o;const l={title:o,panel:e,visiblePanelIndex:t};return this.survey.dynamicPanelGetTabTitle(this,l),l.title},s.sharedData=this.locTemplateTabTitle;const i=e.id,r=this.getPanelVisibleIndexById(i)===this.currentIndex;return new TS({id:`${this.id}_tab_${i}`,panelId:i,pressed:r,locTitle:s,disableHide:r,action:()=>{this.currentIndex=this.getPanelVisibleIndexById(i)}})}getTabbedMenuCss(e){const t=e??this.cssClasses;return new z().append(t.tabsRoot).append(t.tabsLeft,this.tabAlign==="left").append(t.tabsRight,this.tabAlign==="right").append(t.tabsCenter,this.tabAlign==="center").toString()}updateTabToolbarItemsPressedState(){if(!this.isRenderModeTab||this.currentIndex<0||this.currentIndex>=this.visiblePanelCount)return;const e=this.visiblePanelsCore[this.currentIndex];this.tabbedMenu.actions.forEach(t=>{const s=t.panelId===e.id;t.pressed=s,t.disableHide=s})}updateTabToolbar(){if(!this.isRenderModeTab)return;const e=[],t=this.visiblePanelsCore;for(let s=0;s<t.length;s++)this.visiblePanelsCore.forEach(i=>e.push(this.createTabByPanel(t[s],s)));this.tabbedMenu.setItems(e)}addTabFromToolbar(e,t){if(!this.isRenderModeTab)return;const s=this.createTabByPanel(e,t);this.tabbedMenu.actions.splice(t,0,s),this.updateTabToolbarItemsPressedState()}removeTabFromToolbar(e){if(!this.isRenderModeTab)return;const t=this.tabbedMenu.actions.find(s=>s.panelId==e.id);t&&(this.tabbedMenu.actions.splice(this.tabbedMenu.actions.indexOf(t),1),this.updateTabToolbarItemsPressedState())}get showNavigation(){return this.isReadOnly&&this.visiblePanelCount==1?!1:this.visiblePanelCount>0&&!!this.cssClasses.footer}showSeparator(e){return this.isRenderModeList&&e<this.renderedPanels.length-1}calcCssClasses(e){const t=super.calcCssClasses(e),s=this.tabbedMenu;return s&&(s.containerCss=this.getTabbedMenuCss(t),s.cssClasses=t.tabs,s.dotsItem.cssClasses=t.tabs,s.dotsItem.popupModel.contentComponentData.model.cssClasses=e.list),t}onMobileChanged(){super.onMobileChanged(),this.updateFooterActions()}};ui.maxCheckCount=3,S([Nt({})],ui.prototype,"_renderedPanels",void 0),S([E({onSet:(n,e)=>{e.fireCallback(e.renderModeChangedCallback),e.updatePanelView()}})],ui.prototype,"displayMode",void 0),S([E({onSet:(n,e)=>{e.fireCallback(e.currentIndexChangedCallback)}})],ui.prototype,"showProgressBar",void 0),S([E({onSet:(n,e)=>{}})],ui.prototype,"progressBarLocation",void 0),S([E({defaultValue:!1})],ui.prototype,"_showFooterToolbar",void 0),S([E({defaultValue:!1,onSet:(n,e)=>{e.updateFooterActions()}})],ui.prototype,"legacyNavigation",void 0),q.addClass("paneldynamic",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},{name:"templateElements",alternativeName:"questions",baseClassName:"question",visible:!1,isLightSerializable:!1},{name:"templateTitle:text",serializationProperty:"locTemplateTitle"},{name:"templateTabTitle",serializationProperty:"locTemplateTabTitle",visibleIf:n=>n.displayMode==="tab"},{name:"tabTitlePlaceholder",serializationProperty:"locTabTitlePlaceholder",visibleIf:n=>n.displayMode==="tab"},{name:"templateDescription:text",serializationProperty:"locTemplateDescription"},{name:"minWidth",defaultFunc:()=>"auto"},{name:"noEntriesText:text",serializationProperty:"locNoEntriesText"},{name:"allowAddPanel:boolean",default:!0},{name:"allowRemovePanel:boolean",default:!0},{name:"newPanelPosition",choices:["next","last"],default:"last",category:"layout"},{name:"panelCount:number",isBindable:!0,default:0,choices:[0,1,2,3,4,5,6,7,8,9,10]},{name:"minPanelCount:number",default:0,minValue:0},{name:"maxPanelCount:number",defaultFunc:()=>A.panel.maxPanelCount},"defaultPanelValue:panelvalue",{name:"copyDefaultValueFromLastEntry:boolean",alternativeName:"defaultValueFromLastPanel"},{name:"panelsState",default:"default",choices:["default","collapsed","expanded","firstExpanded"],visibleIf:n=>n.displayMode==="list"},{name:"keyName"},{name:"keyDuplicationError",serializationProperty:"locKeyDuplicationError"},{name:"confirmDelete:boolean"},{name:"confirmDeleteText",serializationProperty:"locConfirmDeleteText",visibleIf:n=>n.confirmDelete},{name:"addPanelText",alternativeName:"panelAddText",serializationProperty:"locAddPanelText",visibleIf:n=>n.allowAddPanel},{name:"removePanelText",alternativeName:"panelRemoveText",serializationProperty:"locRemovePanelText",visibleIf:n=>n.allowRemovePanel},{name:"prevPanelText",alternativeName:"panelPrevText",serializationProperty:"locPrevPanelText",visibleIf:n=>n.displayMode!=="list"},{name:"nextPanelText",alternativeName:"panelNextText",serializationProperty:"locNextPanelText",visibleIf:n=>n.displayMode!=="list"},{name:"showQuestionNumbers",default:"off",choices:["default","onpanel","recursive","off"]},{name:"questionStartIndex",visibleIf:n=>{const e=n.showQuestionNumbers;return e==="onpanel"||e==="recursive"}},{name:"renderMode",visible:!1,isSerializable:!1},{name:"displayMode",default:"list",choices:["list","carousel","tab"]},{name:"showProgressBar:boolean",alternativeName:"showRangeInProgress",default:!0,visibleIf:n=>n.displayMode==="carousel"},{name:"progressBarLocation",default:"top",choices:["top","bottom","topBottom"],visibleIf:n=>n.showProgressBar&&n.displayMode==="carousel"},{name:"tabAlign",default:"center",choices:["left","center","right"],visibleIf:n=>n.displayMode==="tab"},{name:"templateQuestionTitleLocation",alternativeName:"questionTitleLocation",default:"default",choices:["default","top","bottom","left"]},{name:"templateQuestionTitleWidth",visibleIf:function(n){return!!n&&n.template.availableQuestionTitleWidth()}},{name:"templateErrorLocation",default:"default",choices:["default","top","bottom"]},{name:"templateVisibleIf:expression",category:"logic"},{name:"removePanelButtonLocation",alternativeName:"panelRemoveButtonLocation",default:"bottom",choices:["bottom","right"],visibleIf:n=>n.allowRemovePanel}],function(){return new ui("")},"question"),qe.Instance.registerQuestion("paneldynamic",n=>new ui(n));let gv=class{static getProgressTextInBarCss(e){return new z().append(e.progressText).append(e.progressTextInBar).toString()}static getProgressTextUnderBarCss(e){return new z().append(e.progressText).append(e.progressTextUnderBar).toString()}},mv=class pr extends Te{static get operators(){return pr.operatorsValue!=null||(pr.operatorsValue={empty:function(e,t){return!e},notempty:function(e,t){return!!e},equal:function(e,t){return e==t},notequal:function(e,t){return e!=t},contains:function(e,t){return e&&e.indexOf&&e.indexOf(t)>-1},notcontains:function(e,t){return!e||!e.indexOf||e.indexOf(t)==-1},greater:function(e,t){return e>t},less:function(e,t){return e<t},greaterorequal:function(e,t){return e>=t},lessorequal:function(e,t){return e<=t}}),pr.operatorsValue}constructor(){super()}get id(){return this.uniqueId}getType(){return"triggerbase"}toString(){var e=this.getType().replace("trigger",""),t=this.expression;return t&&(e+=", "+t),e}get isInternal(){return this.isGhost===!0}get operator(){return this.getPropertyValue("operator","equal")}set operator(e){e&&(e=e.toLowerCase(),pr.operators[e]&&this.setPropertyValue("operator",e))}get value(){return this.getPropertyValue("value",null)}set value(e){this.setPropertyValue("value",e)}get name(){return this.getPropertyValue("name","")}set name(e){this.setPropertyValue("name",e)}get expression(){return this.getPropertyValue("expression",this.buildExpression())}set expression(e){this.setPropertyValue("expression",e)}canBeExecuted(e){return!0}canBeExecutedOnComplete(){return!1}checkExpression(e){if(this.isExecutingOnNextPage=e.isOnNextPage,this.isExecutingOnNavigation=e.isOnNavigation||e.isOnNextPage,!this.canBeExecuted(e.isOnNextPage)||e.isOnComplete&&!this.canBeExecutedOnComplete())return;const t=Object.keys(e.keys);if(Array.isArray(t)&&!this.canBeExecuteOnKeysChange(t))return;const s=e.properties||null;this.runExpressionByProperty("expression",s,i=>{this.triggerResult(i===!0,s)},i=>this.isCheckRequired(i,e.keys))||this.isCheckRequired(null,e.keys)&&this.canSuccessOnEmptyExpression()&&this.triggerResult(!0,s)}canBeExecuteOnKeysChange(e){return!0}canSuccessOnEmptyExpression(){return!1}check(e){var t=pr.operators[this.operator](e,this.value);t?this.onSuccess(null):this.onFailure()}get requireValidQuestion(){return!1}triggerResult(e,t){e?(this.onSuccess(t),this.onSuccessExecuted()):this.onFailure()}onSuccess(e){}onFailure(){}onSuccessExecuted(){}buildExpression(){return!this.name||this.isValueEmpty(this.value)&&this.isRequireValue?"":"{"+this.name+"} "+this.operator+" "+Ne.toOperandString(this.value)}isCheckRequired(e,t){return t?e?.hasFunction()===!0?!0:new Ii().isAnyKeyChanged(t,this.getUsedVariables(e)):!1}getUsedVariables(e){if(!e)return[];const t=e.getVariables();if(Array.isArray(t)){const s=A.expressionVariables.unwrapPostfix;for(let i=t.length-1;i>=0;i--){const r=t[i];r.endsWith(s)&&t.push(r.substring(0,r.length-s.length))}}return t}get isRequireValue(){return this.operator!=="empty"&&this.operator!="notempty"}};mv.operatorsValue=null;let Tr=class extends mv{constructor(){super(),this.ownerValue=null}get owner(){return this.ownerValue}setOwner(e){this.ownerValue=e}getSurvey(e=!1){return this.owner&&this.owner.getSurvey?this.owner.getSurvey():null}isRealExecution(){return!0}onSuccessExecuted(){this.owner&&this.isRealExecution()&&this.owner.triggerExecuted(this)}},RS=class extends Tr{constructor(){super(),this.pages=[],this.questions=[]}getType(){return"visibletrigger"}onSuccess(e){this.onTrigger(this.onItemSuccess)}onFailure(){this.onTrigger(this.onItemFailure)}onTrigger(e){if(this.owner)for(var t=this.owner.getObjects(this.pages,this.questions),s=0;s<t.length;s++)e(t[s])}onItemSuccess(e){e.visible=!0}onItemFailure(e){e.visible=!1}},_S=class extends Tr{constructor(){super()}getType(){return"completetrigger"}get requireValidQuestion(){return!0}isRealExecution(){return!A.triggers.executeCompleteOnValueChanged===this.isExecutingOnNavigation}onSuccess(e){this.owner&&(this.isRealExecution()?this.owner.setCompleted(this):this.owner.canBeCompleted(this,!0))}onFailure(){this.owner.canBeCompleted(this,!1)}},LS=class extends Tr{constructor(){super()}getType(){return"setvaluetrigger"}canBeExecuted(e){return!e&&!!this.setToName}canBeExecuteOnKeysChange(e){return e.length===1&&e[0]===this.setToName?!1:super.canBeExecuteOnKeysChange(e)}onPropertyValueChanged(e,t,s){if(super.onPropertyValueChanged(e,t,s),e==="setToName"){var i=this.getSurvey();i&&!i.isLoadingFromJson&&i.isDesignMode&&(this.setValue=void 0)}}get setToName(){return this.getPropertyValue("setToName","")}set setToName(e){this.setPropertyValue("setToName",e)}get setValue(){return this.getPropertyValue("setValue")}set setValue(e){this.setPropertyValue("setValue",e)}get isVariable(){return this.getPropertyValue("isVariable")}set isVariable(e){this.setPropertyValue("isVariable",e)}onSuccess(e){!this.setToName||!this.owner||this.owner.setTriggerValue(this.setToName,O.getUnbindValue(this.setValue),this.isVariable)}},AS=class extends Tr{constructor(){super()}getType(){return"skiptrigger"}get requireValidQuestion(){return this.canBeExecuted(!1)}get gotoName(){return this.getPropertyValue("gotoName","")}set gotoName(e){this.setPropertyValue("gotoName",e)}canBeExecuted(e){return e===!A.triggers.executeSkipOnValueChanged}onSuccess(e){!this.gotoName||!this.owner||this.owner.focusQuestion(this.gotoName)}},DS=class extends Tr{constructor(){super()}getType(){return"runexpressiontrigger"}get setToName(){return this.getPropertyValue("setToName","")}set setToName(e){this.setPropertyValue("setToName",e)}get runExpression(){return this.getPropertyValue("runExpression","")}set runExpression(e){this.setPropertyValue("runExpression",e)}canBeExecuted(e){return!e}onSuccess(e){this.owner&&this.runExpressionByProperty("runExpression",e,t=>{this.onCompleteRunExpression(t)})}onCompleteRunExpression(e){this.setToName&&e!==void 0&&this.owner.setTriggerValue(this.setToName,O.convertValToQuestionVal(e),!1)}},OS=class extends Tr{constructor(){super()}canBeExecuted(e){return!e&&!!this.setToName&&!!this.fromName}get setToName(){return this.getPropertyValue("setToName","")}set setToName(e){this.setPropertyValue("setToName",e)}get fromName(){return this.getPropertyValue("fromName","")}set fromName(e){this.setPropertyValue("fromName",e)}get copyDisplayValue(){return this.getPropertyValue("copyDisplayValue")}set copyDisplayValue(e){this.setPropertyValue("copyDisplayValue",e)}getType(){return"copyvaluetrigger"}canBeExecuteOnKeysChange(e){return e.length===1&&e[0]===this.setToName?!1:super.canBeExecuteOnKeysChange(e)}onSuccess(e){!this.setToName||!this.owner||this.owner.copyTriggerValue(this.setToName,this.fromName,this.copyDisplayValue)}canSuccessOnEmptyExpression(){return!0}getUsedVariables(e){const t=super.getUsedVariables(e);return t.length===0&&this.fromName&&t.push(this.fromName),t}};q.addClass("trigger",[{name:"operator",default:"equal",visible:!1},{name:"value",visible:!1},"expression:condition"]),q.addClass("surveytrigger",[{name:"name",visible:!1}],null,"trigger"),q.addClass("visibletrigger",["pages:pages","questions:questions"],function(){return new RS},"surveytrigger"),q.addClass("completetrigger",[],function(){return new _S},"surveytrigger"),q.addClass("setvaluetrigger",[{name:"!setToName:questionvalue"},{name:"setValue:triggervalue",dependsOn:"setToName",visibleIf:function(n){return!!n&&!!n.setToName}},{name:"isVariable:boolean",visible:!1}],function(){return new LS},"surveytrigger"),q.addClass("copyvaluetrigger",[{name:"!fromName:questionvalue"},{name:"!setToName:questionvalue"},{name:"copyDisplayValue:boolean",visible:!1}],function(){return new OS},"surveytrigger"),q.addClass("skiptrigger",[{name:"!gotoName:question"}],function(){return new AS},"surveytrigger"),q.addClass("runexpressiontrigger",[{name:"setToName:questionvalue"},"runExpression:expression"],function(){return new DS},"surveytrigger");let fv=class extends Te{constructor(e,t=null){super(),this.closeOnCompleteTimeout=0,t?this.surveyValue=t:this.surveyValue=this.createSurvey(e),this.surveyValue.fitToContainer=!0,this.windowElement=ge.createElement("div"),this.survey.onComplete.add((s,i)=>{this.onSurveyComplete()}),this.registerPropertyChangedHandlers(["isShowing"],()=>{this.showingChangedCallback&&this.showingChangedCallback()}),this.registerPropertyChangedHandlers(["isExpanded"],()=>{this.onExpandedChanged()}),this.width=new We(()=>this.survey.width),this.width=this.survey.width,this.updateCss(),this.onCreating()}onCreating(){}getType(){return"popupsurvey"}get survey(){return this.surveyValue}get isShowing(){return this.getPropertyValue("isShowing",!1)}set isShowing(e){this.setPropertyValue("isShowing",e)}get isFullScreen(){return this.getPropertyValue("isFullScreen",!1)}set isFullScreen(e){!this.isExpanded&&e&&(this.isExpanded=!0),this.setPropertyValue("isFullScreen",e),this.setCssRoot()}show(){this.isShowing=!0}hide(){this.isShowing=!1}toggleFullScreen(){this.isFullScreen=!this.isFullScreen}get isExpanded(){return this.getPropertyValue("isExpanded",!1)}set isExpanded(e){this.isFullScreen&&!e&&(this.isFullScreen=!1),this.setPropertyValue("isExpanded",e)}get isCollapsed(){return!this.isExpanded}onExpandedChanged(){this.expandedChangedCallback&&this.expandedChangedCallback(),this.updateCssButton()}get title(){return this.survey.title}set title(e){this.survey.title=e}get locTitle(){return this.survey.locTitle.isEmpty?null:this.survey.locTitle}get locDescription(){return this.survey.locTitle.isEmpty?null:this.survey.locDescription}expand(){this.isExpanded=!0}collapse(){this.isExpanded=!1}changeExpandCollapse(){this.isExpanded=!this.isExpanded}get allowClose(){return this.getPropertyValue("allowClose",!1)}set allowClose(e){this.setPropertyValue("allowClose",e)}get allowFullScreen(){return this.getPropertyValue("allowFullScreen",!1)}set allowFullScreen(e){this.setPropertyValue("allowFullScreen",e)}get css(){return this.survey.css}get cssButton(){return this.getPropertyValue("cssButton","")}get cssRoot(){let e=this.getPropertyValue("cssRoot","");return this.isCollapsed&&(e+=" "+this.getPropertyValue("cssRootCollapsedMod","")),e}get cssRootCollapsedMod(){return this.getPropertyValue("cssRootCollapsedMod")}get cssRootContent(){return this.getPropertyValue("cssRootContent")}get cssBody(){return this.getPropertyValue("cssBody","")}get cssHeaderRoot(){return this.getPropertyValue("cssHeaderRoot","")}get cssHeaderTitleCollapsed(){return this.getPropertyValue("cssHeaderTitleCollapsed","")}get cssHeaderButtonsContainer(){return this.getPropertyValue("cssHeaderButtonsContainer","")}get cssHeaderCollapseButton(){return this.getPropertyValue("cssHeaderCollapseButton","")}get cssHeaderCloseButton(){return this.getPropertyValue("cssHeaderCloseButton","")}get cssHeaderFullScreenButton(){return this.getPropertyValue("cssHeaderFullScreenButton","")}get renderedWidth(){let e=this.getPropertyValue("width","60%");return e&&!isNaN(e)&&(e=e+"px"),e}updateCss(){if(!this.css||!this.css.window)return;const e=this.css.window;this.setCssRoot(),this.setPropertyValue("cssRootCollapsedMod",e.rootCollapsedMod),this.setPropertyValue("cssRootContent",e.rootContent),this.setPropertyValue("cssBody",e.body);const t=e.header;t&&(this.setPropertyValue("cssHeaderRoot",t.root),this.setPropertyValue("cssHeaderTitleCollapsed",t.titleCollapsed),this.setPropertyValue("cssHeaderButtonsContainer",t.buttonsContainer),this.setPropertyValue("cssHeaderCollapseButton",t.collapseButton),this.setPropertyValue("cssHeaderCloseButton",t.closeButton),this.setPropertyValue("cssHeaderFullScreenButton",t.fullScreenButton),this.updateCssButton())}setCssRoot(){const e=this.css.window;this.isFullScreen?this.setPropertyValue("cssRoot",e.root+" "+e.rootFullScreenMode):this.setPropertyValue("cssRoot",e.root)}updateCssButton(){const e=this.css.window?this.css.window.header:null;e&&this.setCssButton(this.isExpanded?e.buttonExpanded:e.buttonCollapsed)}setCssButton(e){e&&this.setPropertyValue("cssButton",e)}createSurvey(e){return new Ee(e)}onSurveyComplete(){if(!(this.closeOnCompleteTimeout<0))if(this.closeOnCompleteTimeout==0)this.hide();else{var e=this,t=null,s=function(){e.hide(),clearInterval(t)};t=setInterval(s,this.closeOnCompleteTimeout*1e3)}}onScroll(){this.survey.onScroll()}};S([E()],fv.prototype,"width",void 0);let MS=class{constructor(){this._lockScroll=!1}setRootElement(e){this._containerElementValue=e?.querySelector(".sv-scroll__scroller"),this._scrollbarElement=e?.querySelector(".sv-scroll__scrollbar"),this._scrollbarSizerElement=e?.querySelector(".sv-scroll__scrollbar-sizer"),this._containerBodyElement=e?.querySelector(".sv-scroll__container"),!(!e||!we.isAvailable())&&(this._containerBodyResizeObserver=new ResizeObserver(t=>{for(let s of t){const i=s.contentBoxSize?s.contentBoxSize[0].blockSize:s.contentRect.width;this._scrollbarSizerElement.style.height=i+"px"}this.onInnerHeightChanged&&this.onInnerHeightChanged(this._containerBodyElement.clientHeight>this._containerElementValue.clientHeight)}),this._containerBodyResizeObserver.observe(this._containerBodyElement))}onScrollContainer(){this._lockScroll=!0,this._scrollbarElement.scrollTop=this._containerElementValue.scrollTop}onScrollScrollbar(){if(this._lockScroll){this._lockScroll=!1;return}this._containerElementValue.scrollTop=this._scrollbarElement.scrollTop}unsubscribeRootElement(){this._containerBodyResizeObserver&&(this._containerBodyResizeObserver.disconnect(),this._containerBodyResizeObserver=void 0)}};const yv='input:not(:disabled):not([readonly]):not([type=hidden]),select:not(:disabled):not([readonly]),textarea:not(:disabled):not([readonly]), button:not(:disabled):not([readonly]), [tabindex]:not([tabindex^="-"])';let hi=class extends Te{updateIsVisible(e){this._isVisible=e,this.onVisibilityChanged.fire(this,{isVisible:e})}updateBeforeShowing(){this.model.onShow()}updateAfterHiding(){this.model.onHiding()}getLeaveOptions(){return{cssClass:"sv-popup--leave",onBeforeRunAnimation:e=>{e.setAttribute("inert","")},onAfterRunAnimation:e=>e.removeAttribute("inert")}}getEnterOptions(){return{cssClass:"sv-popup--enter"}}getAnimatedElement(){return this.getAnimationContainer()}isAnimationEnabled(){return this.model.displayMode!=="overlay"&&A.animationEnabled}getRerenderEvent(){return this.onElementRerendered}getAnimationContainer(){var e;return(e=this.container)===null||e===void 0?void 0:e.querySelector(this.fixedPopupContainer)}get isVisible(){return this._isVisible}set isVisible(e){this.visibilityAnimation.sync(e)}get container(){return this.containerElement||this.createdContainer}getLocale(){return this.locale?this.locale:super.getLocale()}hidePopup(){this.model.isVisible=!1}getStyleClass(){return new z().append(this.model.cssClass)}getShowFooter(){return this.isOverlay}getShowHeader(){return!1}getPopupHeaderTemplate(){}createFooterActionBar(){this.footerToolbarValue=new _t}resetDimensionsAndPositionStyleProperties(){this.top="",this.left="",this.height="",this.width="",this.minWidth=""}onModelChanging(e){}setupModel(e){this.model&&this.model.onVisibilityChanged.remove(this.onModelIsVisibleChangedCallback),this.onModelChanging(e),this._model=e,e.onVisibilityChanged.add(this.onModelIsVisibleChangedCallback),this.onModelIsVisibleChangedCallback()}get model(){return this._model}set model(e){this.setupModel(e)}constructor(e){super(),this.popupSelector=".sv-popup",this.fixedPopupContainer=".sv-popup",this.containerSelector=".sv-popup__container",this.scrollingContentSelector=".sv-popup__scrolling-content",this.visibilityAnimation=new fy(this,t=>{this._isVisible!==t&&(t?(this.updateBeforeShowing(),this.updateIsVisible(t)):(this.updateOnHiding(),this.updateIsVisible(t),this.updateAfterHiding(),this._isPositionSetValue=!1))},()=>this._isVisible),this.onVisibilityChanged=new Zt,this.onModelIsVisibleChangedCallback=()=>{this.isVisible=this.model.isVisible},this._isPositionSetValue=!1,this.model=e,this.locale=this.model.locale}get title(){return this.model.title}get contentComponentName(){return this.model.contentComponentName}get contentComponentData(){return this.model.contentComponentData}get isModal(){return this.model.isModal}get isFocusedContent(){return this.model.isFocusedContent}get isFocusedContainer(){return this.model.isFocusedContainer}get showFooter(){return this.getShowFooter()}get showHeader(){return this.getShowHeader()}get popupHeaderTemplate(){return this.getPopupHeaderTemplate()}get isOverlay(){return this.model.displayMode==="overlay"}get styleClass(){return this.getStyleClass().toString()}get cancelButtonText(){return this.getLocalizationString("modalCancelButtonText")}get footerToolbar(){return this.footerToolbarValue||this.createFooterActionBar(),this.footerToolbarValue}onKeyDown(e){e.key==="Tab"||e.keyCode===9?this.trapFocus(e):(e.key==="Escape"||e.keyCode===27)&&this.hidePopup()}trapFocus(e){const t=this.container.querySelectorAll(yv),s=t[0],i=t[t.length-1];e.shiftKey?A.environment.root.activeElement===s&&(i.focus(),e.preventDefault()):A.environment.root.activeElement===i&&(s.focus(),e.preventDefault())}switchFocus(){this.isFocusedContent?this.focusFirstInput():this.isFocusedContainer&&this.focusContainer()}get isPositionSet(){return this._isPositionSetValue}updateOnShowing(){this.prevActiveElement=A.environment.root.activeElement,this.isOverlay&&this.resetDimensionsAndPositionStyleProperties(),this.switchFocus(),this._isPositionSetValue=!0}updateOnHiding(){this.isFocusedContent&&this.prevActiveElement&&this.prevActiveElement.focus({preventScroll:!0})}focusContainer(){if(!this.container)return;const e=this.container.querySelector(this.popupSelector);e?.focus()}focusFirstInput(){setTimeout(()=>{if(this.container){var e=this.container.querySelector(this.model.focusFirstInputSelector||yv);e?e.focus():this.focusContainer()}},100)}clickOutside(e){this.hidePopup(),e?.stopPropagation()}blur(e){this.model.onBlur()}cancel(){this.model.onCancel(),this.hidePopup()}dispose(){super.dispose(),this.model&&this.model.onVisibilityChanged.remove(this.onModelIsVisibleChangedCallback),this.createdContainer&&(this.createdContainer.remove(),this.createdContainer=void 0),this.footerToolbarValue&&this.footerToolbarValue.dispose(),this.resetComponentElement()}initializePopupContainer(){if(!this.container){const e=ge.createElement("div");this.createdContainer=e,j2(A.environment.popupMountContainer).appendChild(e)}}setComponentElement(e){e&&(this.containerElement=e)}resetComponentElement(){this.containerElement=void 0,this.prevActiveElement=void 0}preventScrollOuside(e,t){let s=e.target;for(;s!==this.container;){if(ge.getComputedStyle(s).overflowY==="auto"&&s.scrollHeight!==s.offsetHeight){const{scrollHeight:i,scrollTop:r,clientHeight:a}=s;if(!(t>0&&Math.abs(i-a-r)<1)&&!(t<0&&r<=0))return}s=s.parentElement}e.cancelable&&e.preventDefault()}};S([E({defaultValue:"0px"})],hi.prototype,"top",void 0),S([E({defaultValue:"0px"})],hi.prototype,"left",void 0),S([E({defaultValue:"auto"})],hi.prototype,"height",void 0),S([E({defaultValue:"auto"})],hi.prototype,"width",void 0),S([E({defaultValue:"auto"})],hi.prototype,"minWidth",void 0),S([E({defaultValue:!1})],hi.prototype,"_isVisible",void 0),S([E()],hi.prototype,"locale",void 0);let dh=class{constructor(e,t,s,i){this.x=e,this.y=t,this.width=s,this.height=i}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}},Li=class Uw{static calculatePosition(e,t,s,i,r,a="flex"){let o=e.left,l=e.top;return a==="flex"&&(r=="center"?o=(e.left+e.right-s)/2:r=="left"?o=e.left-s:o=e.right),i=="middle"?l=(e.top+e.bottom-t)/2:i=="top"?l=e.top-t:l=e.bottom,r!="center"&&i!="middle"&&(i=="top"?l=l+e.height:l=l-e.height),{left:Math.round(o),top:Math.round(l)}}static getCorrectedVerticalDimensions(e,t,s,i,r=!0,a={top:0,bottom:0}){let o;const l=s-Uw.bottomIndent;if(i==="top"&&(o={height:t,top:e}),e<-a.top)o={height:r?t+e:t,top:-a.top};else if(t+e>s){let u=Math.min(t,l-e);o={height:r?u:t,top:r?e:e-(t-u)}}return o&&(o.height=Math.min(o.height,l),o.top=Math.max(o.top,-a.top)),o}static updateHorizontalDimensions(e,t,s,i,r="flex",a={left:0,right:0}){t+=a.left+a.right;let o,l=e;return i==="center"&&(r==="fixed"?(e+t>s&&(o=s-e),l-=a.left):e<0?(l=a.left,o=Math.min(t,s)):t+e>s&&(l=s-t,l=Math.max(l,a.left),o=Math.min(t,s))),i==="left"&&e<0&&(l=a.left,o=Math.min(t,s)),i==="right"&&t+e>s&&(o=s-e),{width:o-a.left-a.right,left:l}}static updateVerticalPosition(e,t,s,i,r){if(i==="middle")return i;let a=t-(e.top+(s!=="center"?e.height:0)),o=t+e.bottom-(s!=="center"?e.height:0)-r;return a>0&&o<=0&&i=="top"?i="bottom":o>0&&a<=0&&i=="bottom"?i="top":o>0&&a>0&&(i=a<o?"top":"bottom"),i}static updateHorizontalPosition(e,t,s,i){if(s==="center")return s;let r=t-e.left,a=t+e.right-i;return r>0&&a<=0&&s=="left"?s="right":a>0&&r<=0&&s=="right"?s="left":a>0&&r>0&&(s=r<a?"left":"right"),s}static calculatePopupDirection(e,t){var s;return t=="center"&&e!="middle"?s=e:t!="center"&&(s=t),s}static calculatePointerTarget(e,t,s,i,r,a=0,o=0){var l={};return r!="center"?(l.top=e.top+e.height/2,l.left=e[r]):i!="middle"&&(l.top=e[i],l.left=e.left+e.width/2),l.left=Math.round(l.left-s),l.top=Math.round(l.top-t),r=="left"&&(l.left-=a+o),r==="center"&&(l.left-=a),l}};Li.bottomIndent=16;let wo=class extends hi{createFooterActionBar(){super.createFooterActionBar(),this.footerToolbar.setCssClasses({root:_s.root,defaultSizeMode:_s.defaultSizeMode,smallSizeMode:_s.smallSizeMode,item:"sd-action sv-menu-popup__button"},!1),this.footerToolbar.containerCss="sv-menu-footer-action-bar";let e=[{id:"cancel",visibleIndex:10,title:this.cancelButtonText,innerCss:"sv-popup__button--cancel",action:()=>{this.cancel()}}];e=this.model.updateFooterActions(e),this.footerToolbarValue.setItems(e)}getAvailableAreaRect(){const e=this.model.getAreaCallback?this.model.getAreaCallback(this.container):void 0;if(e){const t=e.getBoundingClientRect();return new dh(t.x,t.y,t.width,t.height)}return new dh(0,0,we.getInnerWidth(),we.getInnerHeight())}getTargetElementRect(e){const t=this.container;let s=this.model.getTargetCallback?this.model.getTargetCallback(t):void 0;if(t&&t.parentElement&&!this.isModal&&!s&&(s=t.parentElement),!s)return null;const i=s.getBoundingClientRect();return new dh(i.left-e.left,i.top-e.top,i.width,i.height)}_updatePosition(){var e,t,s;const i=this.getAvailableAreaRect(),r=this.getTargetElementRect(i);if(!r)return;const a=(e=this.container)===null||e===void 0?void 0:e.querySelector(this.containerSelector);if(!a)return;const o=(t=this.container)===null||t===void 0?void 0:t.querySelector(this.fixedPopupContainer),l=a.querySelector(this.scrollingContentSelector),u=ge.getComputedStyle(a),d=parseFloat(u.marginLeft)||0,h=parseFloat(u.marginRight)||0,f=parseFloat(u.marginTop)||0,C=parseFloat(u.marginBottom)||0;let b=a.offsetHeight-l.offsetHeight+l.scrollHeight;const x=a.getBoundingClientRect().width;this.model.setWidthByTarget&&(this.minWidth=r.width+"px");let V=this.model.verticalPosition,P=this.getActualHorizontalPosition();if(we.isAvailable()){const X=[b,we.getInnerHeight()*.9,(s=we.getVisualViewport())===null||s===void 0?void 0:s.height];b=Math.ceil(Math.min(...X.filter(N=>typeof N=="number"))),V=Li.updateVerticalPosition(r,b,this.model.horizontalPosition,this.model.verticalPosition,i.height),P=Li.updateHorizontalPosition(r,x,P,i.width)}this.popupDirection=Li.calculatePopupDirection(V,P);const M=Li.calculatePosition(r,b,x+d+h,V,P,this.model.positionMode);if(we.isAvailable()){const X=Li.getCorrectedVerticalDimensions(M.top,b,i.height,V,this.model.canShrink,{top:f,bottom:C});if(X&&(this.height=X.height+"px",M.top=X.top),this.model.setWidthByTarget)this.width=r.width+"px",M.left=r.left;else{const N=Li.updateHorizontalDimensions(M.left,x,we.getInnerWidth(),P,this.model.positionMode,{left:d,right:h});N&&(this.width=N.width?N.width+"px":void 0,M.left=N.left)}}if(o){const X=o.getBoundingClientRect();M.top-=X.top,M.left-=X.left}this.showHeader&&(this.pointerTarget=Li.calculatePointerTarget(r,M.top,M.left,V,P,d,h),this.pointerTarget.top+="px",this.pointerTarget.left+="px"),M.left+=i.left,M.top+=i.top,this.left=M.left+"px",this.top=M.top+"px"}getActualHorizontalPosition(){let e=this.model.horizontalPosition;return ge.isAvailable()&&ge.getComputedStyle(ge.getBody()).direction=="rtl"&&(this.model.horizontalPosition==="left"?e="right":this.model.horizontalPosition==="right"&&(e="left")),e}getStyleClass(){const e=this.model.getDisplayMode();return super.getStyleClass().append("sv-popup--menu-phone",e==="menu-overlay").append("sv-popup--menu-tablet",e==="menu-popup-overlay").append("sv-popup--menu-popup",e==="menu-popup").append("sv-popup--show-pointer",e==="menu-popup"&&this.showHeader).append(`sv-popup--${this.popupDirection}`,e==="menu-popup"&&(this.showHeader||this.popupDirection=="top"||this.popupDirection=="bottom"))}getShowHeader(){return this.model.showPointer&&!this.isOverlay}getPopupHeaderTemplate(){return"popup-pointer"}constructor(e){super(e),this.scrollEventCallBack=t=>{if(this.isOverlay&&ft){t.stopPropagation(),t.preventDefault();return}this.hidePopup()},this.resizeEventCallback=()=>{if(!we.isAvailable())return;const t=we.getVisualViewport(),s=ge.getDocumentElement();s&&t&&s.style.setProperty("--sv-popup-overlay-height",`${t.height*t.scale}px`)},this.resizeWindowCallback=()=>{this.isOverlay||this.updatePosition(!0,Ee.platform==="vue"||Ee.platform==="vue3"||Ee.platform=="react"||Ee.platform=="js-ui")},this.clientY=0,this.touchStartEventCallback=t=>{this.clientY=t.touches[0].clientY},this.touchMoveEventCallback=t=>{this.preventScrollOuside(t,this.clientY-t.changedTouches[0].clientY)},this.model.onRecalculatePosition.add(this.recalculatePositionHandler)}setComponentElement(e){super.setComponentElement(e)}resetComponentElement(){super.resetComponentElement()}updateOnShowing(){const{root:e}=A.environment;this.prevActiveElement=e.activeElement,this.isOverlay?this.resetDimensionsAndPositionStyleProperties():this.updatePosition(!0,!1),this.switchFocus(),we.addEventListener("resize",this.resizeWindowCallback),this.shouldCreateResizeCallback&&(we.getVisualViewport().addEventListener("resize",this.resizeEventCallback),this.container&&(this.container.addEventListener("touchstart",this.touchStartEventCallback),this.container.addEventListener("touchmove",this.touchMoveEventCallback)),this.resizeEventCallback()),we.addEventListener("scroll",this.scrollEventCallBack),this._isPositionSetValue=!0}get shouldCreateResizeCallback(){return!!we.getVisualViewport()&&this.isOverlay}updatePosition(e,t=!0){e&&(this.height="auto"),t?setTimeout(()=>{this._updatePosition()},1):this._updatePosition()}updateOnHiding(){super.updateOnHiding(),we.removeEventListener("resize",this.resizeWindowCallback),this.shouldCreateResizeCallback&&(we.getVisualViewport().removeEventListener("resize",this.resizeEventCallback),this.container&&(this.container.removeEventListener("touchstart",this.touchStartEventCallback),this.container.removeEventListener("touchmove",this.touchMoveEventCallback))),we.removeEventListener("scroll",this.scrollEventCallBack),this.isDisposed||(this.top=void 0,this.left=void 0,this.height=void 0,this.width=void 0,this.minWidth=void 0)}onModelChanging(e){this.model&&this.model.onRecalculatePosition.remove(this.recalculatePositionHandler),this.recalculatePositionHandler||(this.recalculatePositionHandler=(t,s)=>{this.isOverlay||this.updatePosition(s.isResetHeight)}),super.onModelChanging(e),e.onRecalculatePosition.add(this.recalculatePositionHandler)}dispose(){super.dispose(),this.updateOnHiding(),this.model&&(this.model.onRecalculatePosition.remove(this.recalculatePositionHandler),this.recalculatePositionHandler=void 0),this.resetComponentElement()}};wo.tabletSizeBreakpoint=600,S([E({defaultValue:"left"})],wo.prototype,"popupDirection",void 0),S([E({defaultValue:{left:"0px",top:"0px"}})],wo.prototype,"pointerTarget",void 0);let vv=class extends hi{getStyleClass(){const e=this.model.getDisplayMode();return super.getStyleClass().append("sv-popup--modal-popup",e==="modal-popup").append("sv-popup--modal-overlay",e==="modal-overlay")}getShowFooter(){return!0}createFooterActionBar(){super.createFooterActionBar(),this.footerToolbar.setCssClasses({root:_s.root,defaultSizeMode:_s.defaultSizeMode,smallSizeMode:_s.smallSizeMode,item:"sv-popup__body-footer-item sv-popup__button sv-modal-popup__button sd-btn sd-btn--small"},!1),this.footerToolbar.containerCss="sv-modal-footer-action-bar";let e=[{id:"cancel",visibleIndex:10,title:this.cancelButtonText,innerCss:"sv-popup__button--cancel",action:()=>{this.cancel()}},{id:"apply",visibleIndex:20,title:this.applyButtonText,innerCss:"sv-popup__button--apply sd-btn--action",action:()=>{this.apply()}}];e=this.model.updateFooterActions(e),this.footerToolbarValue.setItems(e)}constructor(e){super(e),this.onScrollOutsideCallback=t=>{this.preventScrollOuside(t,t.deltaY)}}get applyButtonText(){return this.getLocalizationString("modalApplyButtonText")}apply(){this.model.onApply&&!this.model.onApply()||this.hidePopup()}clickOutside(){}onKeyDown(e){(e.key==="Escape"||e.keyCode===27)&&this.model.onCancel(),super.onKeyDown(e)}updateOnShowing(){this.container&&this.container.addEventListener("wheel",this.onScrollOutsideCallback,{passive:!1}),super.updateOnShowing()}updateOnHiding(){this.container&&this.container.removeEventListener("wheel",this.onScrollOutsideCallback),super.updateOnHiding()}};function kS(n,e){var t;const s=Object.assign({},n);s.verticalPosition="top",s.horizontalPosition="left",s.showPointer=!1,s.isModal=!0,s.displayMode=n.displayMode||"popup";const i=new Lt(n.componentName,n.data,s);i.isFocusedContent=(t=n.isFocusedContent)!==null&&t!==void 0?t:!0;const r=new vv(i);if(e&&e.appendChild){var a=ge.createElement("div");e.appendChild(a),r.setComponentElement(a)}r.container||r.initializePopupContainer();const o=(l,u)=>{u.isVisible||a&&r.resetComponentElement(),r.onVisibilityChanged.remove(o)};return r.onVisibilityChanged.add(o),r}function NS(n){return n.isModal?new vv(n):new wo(n)}let xo=class extends co{getBaseType(){return"buttongroupitemvalue"}};S([E()],xo.prototype,"iconName",void 0),S([E()],xo.prototype,"iconSize",void 0),S([E()],xo.prototype,"showCaption",void 0);let Cv=class extends po{constructor(e){super(e),this._allowClear=!0,this.createLocString({name:"buttongroupOptionsCaption",hasTranslation:!0}),this.createLocalizableString("readOnlyText",this,!0),this.registerPropertyChangedHandlers(["value","renderAs","placeholder","choices","visibleChoices"],()=>{this.updateReadOnlyText()}),this.updateReadOnlyText()}locStrsChanged(){var e;super.locStrsChanged(),this.updateReadOnlyText(),(e=this.dropdownListModelValue)===null||e===void 0||e.locStrsChanged()}updateReadOnlyText(){this.readOnlyText=this.displayValue||this.placeholder}getType(){return"buttongroup"}getItemValueType(){return"buttongroupitemvalue"}supportOther(){return!1}getControlClass(){return this.isEmpty(),new z().append(this.cssClasses.control).append(this.cssClasses.controlEmpty,this.isEmpty()).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle).toString()}getFirstInputElementId(){return this.inputId+"_0"}getInputId(e){return this.inputId+"_"+e}get placeholder(){return this.getLocalizableStringText("buttongroupOptionsCaption")}set placeholder(e){this.setLocalizableStringText("buttongroupOptionsCaption",e)}get locPlaceholder(){return this.getLocalizableString("buttongroupOptionsCaption")}get allowClear(){return this._allowClear}set allowClear(e){this._allowClear=e}get searchEnabled(){return!1}isItemSelected(e){return e.value==this.value}get readOnlyText(){return this.getLocalizableStringText("readOnlyText")}set readOnlyText(e){this.setLocalizableStringText("readOnlyText",e)}get locReadOnlyText(){return this.getLocalizableString("readOnlyText")}get showSelectedItemLocText(){return!this.readOnly&&!this.inputHasValue&&!!this.selectedItemLocText}get selectedItemLocText(){var e;return(e=this.selectedItem)===null||e===void 0?void 0:e.locText}set dropdownListModel(e){this.dropdownListModelValue=e,this.updateElementCss()}get dropdownListModel(){return this.renderAs==="dropdown"&&this.onBeforeSetCompactRenderer(),this.dropdownListModelValue}get selectedItem(){return this.getSingleSelectedItem()}onBlurCore(e){var t;(t=this.dropdownListModel)===null||t===void 0||t.onBlur(e),super.onBlurCore(e)}updateCssClasses(e,t){super.updateCssClasses(e,t),Xa(e,t)}calcCssClasses(e){const t=super.calcCssClasses(e);return this.dropdownListModelValue&&this.dropdownListModelValue.updateCssClasses(t.popup,t.list),t}needResponsiveWidth(){return!0}supportResponsiveness(){return!0}getCompactRenderAs(){return"dropdown"}getObservedElementSelector(){return".sd-button-group-scrollable-container"}onBeforeSetCompactRenderer(){!this.isDisposed&&!this.dropdownListModelValue&&(this.dropdownListModelValue=new Ut(this))}dispose(){super.dispose(),this.dropdownListModelValue&&(this.dropdownListModelValue.dispose(),this.dropdownListModelValue=void 0)}};S([E({defaultValue:!1})],Cv.prototype,"inputHasValue",void 0),q.addClass("buttongroup",[{name:"choices:buttongroupitemvalue[]"}],function(){return new Cv("")},"checkboxbase"),q.addClass("buttongroupitemvalue",[{name:"showCaption:boolean",default:!0},{name:"iconName:text"},{name:"iconSize:number"}],n=>new xo(n),"choiceitem");let qS=class{constructor(e,t,s){this.question=e,this.item=t,this.index=s}get value(){return this.item.value}get iconName(){return this.item.iconName}get iconSize(){return this.item.iconSize||24}get caption(){return this.item.locText}get showCaption(){return this.item.showCaption||this.item.showCaption===void 0}get isRequired(){return this.question.isRequired}get selected(){return this.question.isItemSelected(this.item)}get readOnly(){return this.question.isInputReadOnly||!this.item.isEnabled}get name(){return this.question.name+"_"+this.question.id}get id(){return this.question.inputId+"_"+this.index}get hasErrors(){return this.question.errors.length>0}get describedBy(){return this.question.errors.length>0?this.question.id+"_errors":null}get labelClass(){return new z().append(this.question.cssClasses.item).append(this.question.cssClasses.itemSelected,this.selected).append(this.question.cssClasses.itemHover,!this.readOnly&&!this.selected).append(this.question.cssClasses.itemDisabled,this.question.isReadOnly||!this.item.isEnabled).toString()}get css(){return{label:this.labelClass,icon:this.question.cssClasses.itemIcon,control:this.question.cssClasses.itemControl,caption:this.question.cssClasses.itemCaption,decorator:this.question.cssClasses.itemDecorator}}onChange(){this.question.selectItem(this.item)}},Vo=class extends Te{getSurvey(e=!1){var t;return(t=this.owner)===null||t===void 0?void 0:t.getSurvey()}getType(){return"masksettings"}setData(e){q.getProperties(this.getType()).forEach(s=>{const i=e[s.name];this[s.name]=i!==void 0?i:s.getDefaultValue(this)})}getData(){const e={};return q.getProperties(this.getType()).forEach(s=>{const i=this[s.name];s.isDefaultValue(i)||(e[s.name]=i)}),e}processInput(e){return{value:e.prevValue,caretPosition:e.selectionEnd,cancelPreventDefault:!1}}getUnmaskedValue(e){return e}getMaskedValue(e){return e}getTextAlignment(){return"auto"}getTypeForExpressions(){return"text"}};S([E()],Vo.prototype,"saveMaskedValue",void 0),q.addClass("masksettings",[{name:"saveMaskedValue:boolean",visibleIf:function(n){return n?n.getType()!=="masksettings":!1}}],function(){return new Vo});function ch(n){const e=[];let t=!1;const s=Object.keys(A.maskSettings.patternDefinitions);for(let i=0;i<n.length;i++){const r=n[i];r===A.maskSettings.patternEscapeChar?t=!0:t?(t=!1,e.push({type:"fixed",value:r})):e.push({type:s.indexOf(r)!==-1?"regex":"const",value:r})}return e}function BS(n,e,t){const s=A.maskSettings.patternDefinitions[t.value];for(;e<n.length;){if(n[e].match(s))return e;e++}return e}function FS(n,e,t){const s=n??"";let i="",r=0;const a=typeof e=="string"?ch(e):e;for(let o=0;o<a.length;o++)switch(a[o].type){case"regex":if(r<s.length&&(r=BS(s,r,a[o])),r<s.length)i+=s[r];else if(t)i+=A.maskSettings.patternPlaceholderChar;else return i;r++;break;case"const":case"fixed":i+=a[o].value,a[o].value===s[r]&&r++;break}return i}function ph(n,e,t,s=!1){let i="";if(!n)return i;let r=typeof e=="string"?ch(e):e;for(let a=0;a<r.length;a++)if(r[a].type==="fixed"&&!s&&(i+=r[a].value),r[a].type==="regex"){const o=A.maskSettings.patternDefinitions[r[a].value];if(n[a]&&n[a].match(o))i+=n[a];else if(t){i="";break}else break}return i}let gh=class extends Vo{constructor(){super(...arguments),this.literals=[]}updateLiterals(){this.literals=ch(this.pattern||"")}onPropertyValueChanged(e,t,s){super.onPropertyValueChanged(e,t,s),e==="pattern"&&this.updateLiterals()}getType(){return"patternmask"}fromJSON(e,t){super.fromJSON(e,t),this.updateLiterals()}_getMaskedValue(e,t=!1){return FS(e??"",this.literals,t)}_getUnmaskedValue(e,t=!1){return ph(e??"",this.literals,t)}processInput(e){const t={value:e.prevValue,caretPosition:e.selectionEnd,cancelPreventDefault:!1};if(!e.insertedChars&&e.selectionStart===e.selectionEnd)return t;const s=e.prevValue.slice(0,e.selectionStart)+(e.insertedChars||""),i=ph(e.prevValue.slice(0,e.selectionStart),this.literals.slice(0,e.selectionStart),!1),r=ph(e.prevValue.slice(e.selectionEnd),this.literals.slice(e.selectionEnd),!1,!0);return t.value=this._getMaskedValue(i+(e.insertedChars||"")+r,!0),!e.insertedChars&&e.inputDirection==="backward"?t.caretPosition=e.selectionStart:t.caretPosition=this._getMaskedValue(s).length,t}getMaskedValue(e){return this._getMaskedValue(e,!0)}getUnmaskedValue(e){return this._getUnmaskedValue(e,!0)}};S([E()],gh.prototype,"pattern",void 0),q.addClass("patternmask",[{name:"pattern"}],function(){return new gh},"masksettings");function QS(n,e=!0,t=3){let s=[];if(e){for(let i=n.length-t;i>-t;i-=t)s.push(n.substring(i,i+t));s=s.reverse()}else for(let i=0;i<n.length;i+=t)s.push(n.substring(i,i+t));return s}let Ai=class extends Vo{calccaretPosition(e,t,s){const i=e?this.displayNumber(this.parseNumber(e),!1).length:0;let r=0,a=t.selectionStart;const o=!t.insertedChars&&t.inputDirection==="forward";for(let l=0;l<s.length;l++)if(s[l]!==this.thousandsSeparator&&r++,r===i+(o?1:0)){o?a=l:a=l+1;break}return a}numericalCompositionIsEmpty(e){return!e.integralPart&&!e.fractionalPart}displayNumber(e,t=!0,s=!1){let i=e.integralPart;t&&i&&(i=QS(i).join(this.thousandsSeparator));let r=e.fractionalPart;const a=e.isNegative?"-":"";if(r===""){if(s)return!i||i==="0"?i:a+i;{const o=e.hasDecimalSeparator&&!s?this.decimalSeparator:"",l=i+o;return l==="0"?l:a+l}}else return i=i||"0",r=r.substring(0,this.precision),[a+i,r].join(this.decimalSeparator)}convertNumber(e){let t;const s=e.isNegative?"-":"";return e.fractionalPart?t=parseFloat(s+(e.integralPart||"0")+"."+e.fractionalPart.substring(0,this.precision)):t=parseInt(s+e.integralPart||"0"),t}validateNumber(e,t){const s=this.min||Number.MIN_SAFE_INTEGER,i=this.max||Number.MAX_SAFE_INTEGER;if(this.numericalCompositionIsEmpty(e))return!0;if(this.min!==void 0||this.max!==void 0){let r=this.convertNumber(e);if(Number.isNaN(r)||r>=s&&r<=i)return!0;if(!t){if(!e.hasDecimalSeparator&&r!=0){let a=r,o=r;if(r>0){if(r+1>s&&r<=i)return!0;for(;a=a*10+9,o=o*10,!(o>i);)if(a>s)return!0;return!1}if(r<0){if(r>=s&&r-1<i)return!0;for(;a=a*10,o=o*10-9,!(a<s);)if(o<i)return!0;return!1}}else{const a=Math.pow(.1,(e.fractionalPart||"").length);if(r>=0)return r+a>s&&r<=i;if(r<0)return r>=s&&r-a<i}return r>=0&&r<=i||r<0&&r>=s}return!1}return!0}parseNumber(e){const t={integralPart:"",fractionalPart:"",hasDecimalSeparator:!1,isNegative:!1},s=e==null?"":e.toString();let i=0;for(let r=0;r<s.length;r++){const a=s[r];switch(a){case"-":{this.allowNegativeValues&&(this.min===void 0||this.min<0)&&i++;break}case this.decimalSeparator:{this.precision>0&&(t.hasDecimalSeparator=!0);break}case this.thousandsSeparator:break;default:a.match(nh)&&(t.hasDecimalSeparator?t.fractionalPart+=a:t.integralPart+=a)}}return t.isNegative=i%2!==0,t.integralPart.length>1&&t.integralPart[0]==="0"&&(t.integralPart=t.integralPart.slice(1)),t}getNumberMaskedValue(e,t=!1){const s=this.parseNumber(e);return this.validateNumber(s,t)?this.displayNumber(s,!0,t):null}getNumberUnmaskedValue(e){const t=this.parseNumber(e);if(!this.numericalCompositionIsEmpty(t))return this.convertNumber(t)}getTextAlignment(){return"right"}getMaskedValue(e){let t=e==null?"":e.toString();return t=t.replace(".",this.decimalSeparator),this.getNumberMaskedValue(t,!0)}getUnmaskedValue(e){return this.getNumberUnmaskedValue(e)}processInput(e){const t={value:e.prevValue,caretPosition:e.selectionEnd,cancelPreventDefault:!1},s=e.prevValue.slice(0,e.selectionStart)+(e.insertedChars||""),i=e.prevValue.slice(e.selectionEnd),r=s+i,a=this.parseNumber(r);if(!this.validateNumber(a,!1))return t;const o=this.getNumberMaskedValue(r),l=this.calccaretPosition(s,e,o);return t.value=o,t.caretPosition=l,t}getType(){return"numericmask"}isValueUndefined(e){return e===""||super.isValueUndefined(e)}};S([E()],Ai.prototype,"allowNegativeValues",void 0),S([E()],Ai.prototype,"decimalSeparator",void 0),S([E()],Ai.prototype,"precision",void 0),S([E()],Ai.prototype,"thousandsSeparator",void 0),S([E()],Ai.prototype,"min",void 0),S([E()],Ai.prototype,"max",void 0),q.addClass("numericmask",[{name:"allowNegativeValues:boolean",default:!0},{name:"decimalSeparator",default:".",maxLength:1},{name:"thousandsSeparator",default:",",maxLength:1},{name:"precision:number",default:2,minValue:0},{name:"min:number"},{name:"max:number"}],function(){return new Ai},"masksettings");function bv(n,e){switch(n){case"hour":case"minute":case"second":case"day":case"month":return 2;case"timeMarker":case"year":return e;default:return 1}}function HS(n,e){let t=e;return n.count<n.maxCount&&(n.type==="day"&&parseInt(e[0])===0||n.type==="month"&&parseInt(e[0])===0)&&(t=e.slice(1,e.length)),t}function zS(n){const e=[];let t;const s=(i,r,a=!1)=>{if(t&&t===i){e[e.length-1].count++;const o=bv(i,e[e.length-1].count);e[e.length-1].maxCount=o}else{const o=bv(i,1);e.push({type:i,value:r,count:1,maxCount:o,upperCase:a})}};for(let i=0;i<n.length;i++){const r=n[i];switch(r){case"m":s("month",r);break;case"d":s("day",r);break;case"y":s("year",r);break;case"h":s("hour",r,!1);break;case"H":s("hour",r,!0);break;case"M":s("minute",r);break;case"s":s("second",r);break;case"t":s("timeMarker",r);break;case"T":s("timeMarker",r,!0);break;default:e.push({type:"separator",value:r,count:1,maxCount:1,upperCase:!1});break}t=e[e.length-1].type}return e}let mh=class extends gh{constructor(){super(...arguments),this.defaultDate="1970-01-01T",this.turnOfTheCentury=68,this.twelve=12,this.lexems=[],this.inputDateTimeData=[],this.validBeginningOfNumbers={hour:1,hourU:2,minute:5,second:5,day:3,month:1}}get hasDatePart(){return this.lexems.some(e=>e.type==="day"||e.type==="month"||e.type==="year")}get hasTimePart(){return this.lexems.some(e=>e.type==="hour"||e.type==="minute"||e.type==="second")}get is12Hours(){return this.lexems.filter(e=>e.type==="hour"&&!e.upperCase).length>0}getType(){return"datetimemask"}getTypeForExpressions(){return this.hasTimePart?"datetime-local":"datetime"}updateLiterals(){this.lexems=zS(this.pattern||"")}leaveOnlyNumbers(e){let t="";for(let s=0;s<e.length;s++)e[s].match(nh)&&(t+=e[s]);return t}getMaskedStrFromISO(e){let t=new Date(e);return this.initInputDateTimeData(),this.hasTimePart||(t=new Date(e+"T00:00:00")),this.hasDatePart||(t=new Date(this.defaultDate+e)),isNaN(t)||this.lexems.forEach((s,i)=>{let r=this.inputDateTimeData[i];switch(r.isCompleted=!0,s.type){case"hour":{this.is12Hours?r.value=((t.getHours()-1)%this.twelve+1).toString():r.value=t.getHours().toString();break}case"minute":{r.value=t.getMinutes().toString();break}case"second":{r.value=t.getSeconds().toString();break}case"timeMarker":{const a=t.getHours()>=this.twelve?"pm":"am";r.value=s.upperCase?a.toUpperCase():a;break}case"day":{r.value=t.getDate().toString();break}case"month":{r.value=(t.getMonth()+1).toString();break}case"year":{let a=t.getFullYear();s.count==2&&(a=a%100),r.value=a.toString();break}}}),this.getFormatedString(!0)}initInputDateTimeData(){this.inputDateTimeData=[],this.lexems.forEach(e=>{this.inputDateTimeData.push({lexem:e,isCompleted:!1,value:void 0})})}getISO_8601Format(e){const t=[],s=[];if(e.year!==void 0){const r=this.getPlaceholder(4,e.year.toString(),"0")+e.year;t.push(r)}if(e.month!==void 0&&e.year!==void 0){const r=this.getPlaceholder(2,e.month.toString(),"0")+e.month;t.push(r)}if(e.day!==void 0&&e.month!==void 0&&e.year!==void 0){const r=this.getPlaceholder(2,e.day.toString(),"0")+e.day;t.push(r)}if(e.hour!==void 0){const r=this.getPlaceholder(2,e.hour.toString(),"0")+e.hour;s.push(r)}if(e.minute!==void 0&&e.hour!==void 0){const r=this.getPlaceholder(2,e.minute.toString(),"0")+e.minute;s.push(r)}if(e.second!==void 0&&e.minute!==void 0&&e.hour!==void 0){const r=this.getPlaceholder(2,e.second.toString(),"0")+e.second;s.push(r)}const i=[];return t.length>0&&i.push(t.join("-")),s.length>1&&i.push(s.join(":")),i.join("T")}isYearValid(e){if(e.min===void 0&&e.max===void 0)return!1;const t=e.year.toString(),s=e.min.toISOString().slice(0,t.length),i=e.max.toISOString().slice(0,t.length);return e.year>=parseInt(s)&&e.year<=parseInt(i)}createIDateTimeCompositionWithDefaults(e,t){const s=e.day==29&&e.month==2;let i=e.min.getFullYear(),r=e.max.getFullYear();s&&(i=Math.ceil(i/4)*4,r=Math.floor(r/4)*4,i>r&&(i=void 0,r=void 0));const a=e.year!==void 0?e.year:t?r:i,o=e.month!==void 0?e.month:t&&this.hasDatePart?12:1,l=e.day!==void 0?e.day:t&&this.hasDatePart?this.getMaxDateForMonth(a,o):1,u=e.hour!==void 0?e.hour:t?23:0,d=e.minute!==void 0?e.minute:t?59:0,h=e.second!==void 0?e.second:t?59:0;return{year:a,month:o,day:l,hour:u,minute:d,second:h}}getMaxDateForMonth(e,t){return t==2?e%4==0&&e%100!=0||e%400==0?29:28:[31,28,31,30,31,30,31,31,30,31,30,31][t-1]}isDateValid(e){const t=new Date(this.getISO_8601Format(this.createIDateTimeCompositionWithDefaults(e,!1))),s=new Date(this.getISO_8601Format(this.createIDateTimeCompositionWithDefaults(e,!0)));return!isNaN(t)&&(t.getDate()===e.day||e.day===void 0)&&(t.getMonth()===e.month-1||e.month===void 0)&&(t.getFullYear()===e.year||e.year===void 0)&&s>=e.min&&t<=e.max}getPlaceholder(e,t,s){const i=e-(t||"").length;return i>0?s.repeat(i):""}isDateValid12(e){return this.is12Hours?this.is12Hours&&e.hour>this.twelve?!1:e.timeMarker?e.timeMarker[0].toLowerCase()==="p"?(e.hour!==this.twelve&&(e.hour+=this.twelve),this.isDateValid(e)):(e.hour===this.twelve&&(e.hour=0),this.isDateValid(e)):this.isDateValid(e)?!0:(e.hour+=this.twelve,this.isDateValid(e)):this.isDateValid(e)}updateTimeMarkerInputDateTimeData(e,t){let s=e.value;if(!s)return;const i="timeMarker",r=Object.assign({},t);r[i]=s,this.isDateValid12(r)?e.isCompleted=!0:s=s.slice(0,s.length-1),e.value=s||void 0,t[i]=s||void 0}updateInputDateTimeData(e,t){let s=e.value;if(!s)return;const i=e.lexem.type,r=Object.assign({},t);if(r[i]=parseInt(this.parseTwoDigitYear(e)),s.length===e.lexem.maxCount)if(this.isDateValid12(r)){e.isCompleted=!0,e.value=s||void 0,t[i]=parseInt(s)>0?parseInt(s):void 0;return}else s=s.slice(0,s.length-1);r[i]=parseInt(s);const a=parseInt(s[0]),o=this.validBeginningOfNumbers[i+(e.lexem.upperCase?"U":"")];i==="year"&&!this.isYearValid(r)?(s=s.slice(0,s.length-1),e.isCompleted=!1):o!==void 0&&a>o?this.isDateValid12(r)?e.isCompleted=!0:s=s.slice(0,s.length-1):o!==void 0&&a!==0&&a<=o&&(this.checkValidationDateTimePart(r,i,e),e.isCompleted&&!this.isDateValid12(r)&&(s=s.slice(0,s.length-1))),e.value=s||void 0,t[i]=parseInt(s)>0?parseInt(s):void 0}checkValidationDateTimePart(e,t,s){const i=e[t];let r=i*10,a=10;t==="month"&&(a=3),t==="hour"&&(a=this.is12Hours?3:5),s.isCompleted=!0;for(let o=0;o<a;o++)if(e[t]=r+o,this.isDateValid12(e)){s.isCompleted=!1;break}e[t]=i}getCorrectDatePartFormat(e,t){const s=e.lexem;let i=e.value||"";return i&&s.type==="timeMarker"?(t&&(i=i+this.getPlaceholder(s.count,i,s.value)),i):(i&&e.isCompleted&&(i=parseInt(i).toString()),i&&e.isCompleted?i=this.getPlaceholder(s.count,i,"0")+i:(i=HS(s,i),t&&(i+=this.getPlaceholder(s.count,i,s.value))),i)}createIDateTimeComposition(){let e,t;return this.hasDatePart?(e=this.min||"0001-01-01",t=this.max||"9996-12-31"):(e=this.defaultDate+(this.min||"00:00:00"),t=this.defaultDate+(this.max||"23:59:59")),{hour:void 0,minute:void 0,second:void 0,day:void 0,month:void 0,year:void 0,min:new Date(e),max:new Date(t)}}parseTwoDigitYear(e){const t=e.value;return e.lexem.type!=="year"||e.lexem.count>2?t:(this.max&&this.max.length>=4&&(this.turnOfTheCentury=parseInt(this.max.slice(2,4))),(parseInt(t)>this.turnOfTheCentury?"19":"20")+t)}getFormatedString(e){let t="",s="",i=!1,r=this.inputDateTimeData.length-1;if(!e){const a=this.inputDateTimeData.filter(o=>!!o.value);r=this.inputDateTimeData.indexOf(a[a.length-1])}for(let a=0;a<this.inputDateTimeData.length;a++){const o=this.inputDateTimeData[a];switch(o.lexem.type){case"timeMarker":case"hour":case"minute":case"second":case"day":case"month":case"year":if(o.value===void 0&&!e)return t+=i?s:"",t;{const l=e||r>a,u=this.getCorrectDatePartFormat(o,l);t+=s+u,i=o.isCompleted}break;case"separator":s=o.lexem.value;break}}return t}cleanTimeMarker(e,t){let s="";e=e.toUpperCase();for(let i=0;i<e.length;i++)(!s&&(e[i]=="P"||e[i]=="A")||s&&e[i]=="M")&&(s+=e[i]);return t?s=s.toUpperCase():s=s.toLowerCase(),s}setInputDateTimeData(e){let t=0;this.initInputDateTimeData(),this.lexems.forEach((s,i)=>{if(e.length>0&&t<e.length){if(s.type==="separator")return;const r=this.inputDateTimeData[i],a=e[t];let o;s.type==="timeMarker"?o=this.cleanTimeMarker(a,s.upperCase):o=this.leaveOnlyNumbers(a),r.value=o.slice(0,s.maxCount),t++}})}_getMaskedValue(e,t=!0){let s=e==null?"":e.toString();const i=this.getParts(s);this.setInputDateTimeData(i);const r=this.createIDateTimeComposition();return this.inputDateTimeData.forEach(o=>{o.lexem.type==="timeMarker"?this.updateTimeMarkerInputDateTimeData(o,r):this.updateInputDateTimeData(o,r)}),this.getFormatedString(t)}getParts(e){const t=[],s=this.lexems.filter(l=>l.type!=="separator"),i=this.lexems.filter(l=>l.type==="separator").map(l=>l.value);let r="",a=!1,o=!1;for(let l=0;l<e.length;l++){const u=e[l];if(u.match(nh)||u===s[t.length].value||s[t.length].type==="timeMarker"?(a=!1,o=!1,r+=u):i.indexOf(u)!==-1?o||(a=!0,t.push(r),r=""):a||(o=!0,t.push(r),r=""),t.length>=s.length){a=!1;break}}return(r!=""||a)&&t.push(r),t}getUnmaskedValue(e){var t;let s=e==null?"":e.toString();const i=this.getParts(s);this.setInputDateTimeData(i);const r=(t=this.inputDateTimeData.filter(l=>l.lexem.type==="timeMarker")[0])===null||t===void 0?void 0:t.value.toLowerCase()[0],a=this.createIDateTimeComposition();let o=!1;return this.inputDateTimeData.forEach(l=>{let u=l.value;if(l.lexem.type=="timeMarker"||l.lexem.type=="separator")return;if(!u||u.length<l.lexem.count){o=!0;return}let d=parseInt(this.parseTwoDigitYear(l));l.lexem.type=="hour"&&r==="p"&&d!=this.twelve&&(d+=this.twelve),a[l.lexem.type]=d}),o?"":this.getISO_8601Format(a)}getMaskedValue(e){return this.getMaskedStrFromISO(e)}processInput(e){const t={value:e.prevValue,caretPosition:e.selectionEnd,cancelPreventDefault:!1},s=e.prevValue.slice(0,e.selectionStart),i=e.prevValue.slice(e.selectionEnd);return t.value=this._getMaskedValue(s+(e.insertedChars||"")+i),!e.insertedChars&&e.inputDirection==="backward"?t.caretPosition=e.selectionStart:t.caretPosition=this._getMaskedValue(s+(e.insertedChars||""),!1).length,t}};S([E()],mh.prototype,"min",void 0),S([E()],mh.prototype,"max",void 0),q.addClass("datetimemask",[{name:"min",type:"datetime",enableIf:n=>!!n.pattern},{name:"max",type:"datetime",enableIf:n=>!!n.pattern}],function(){return new mh},"patternmask");let fh=class extends Ai{getType(){return"currencymask"}wrapText(e){const t=this.prefix||"",s=this.suffix||"";let i=e;return i&&(i.indexOf(t)===-1&&(i=t+i),i.indexOf(s)===-1&&(i+=s),i)}unwrapInputArgs(e){let t=e.prevValue;if(t){if(this.prefix&&t.indexOf(this.prefix)!==-1){t=t.slice(t.indexOf(this.prefix)+this.prefix.length);const s=(this.prefix||"").length;e.selectionStart=Math.max(e.selectionStart-s,0),e.selectionEnd-=s}this.suffix&&t.indexOf(this.suffix)!==-1&&(t=t.slice(0,t.indexOf(this.suffix))),e.prevValue=t}}processInput(e){this.unwrapInputArgs(e);const t=super.processInput(e),s=(this.prefix||"").length;return t.value&&(t.caretPosition+=s),t.value=this.wrapText(t.value),t}getMaskedValue(e){const t=super.getMaskedValue(e);return this.wrapText(t)}};S([E()],fh.prototype,"prefix",void 0),S([E()],fh.prototype,"suffix",void 0),q.addClass("currencymask",[{name:"prefix"},{name:"suffix"}],()=>new fh,"numericmask");var Po;Po="2.3.15",A.version=Po;function jS(n,e){if(Po!=n){const t="survey-core has version '"+Po+"' and "+e+" has version '"+n+"'. SurveyJS libraries should have the same versions to work correctly.";console.error(t)}}let US=class{constructor(){this.icons={},this.iconPrefix="icon-",this.onIconsChanged=new Zt}processId(e,t){return e.indexOf(t)==0&&(e=e.substring(t.length)),e=vy[e]||e,e}registerIconFromSymbol(e,t){this.icons[e]=t}registerIconFromSvgViaElement(e,t,s=this.iconPrefix){if(!ge.isAvailable())return;e=this.processId(e,s);let i=ge.createElement("div");i.innerHTML=t;let r=ge.createElement("symbol"),a=i.querySelector("svg");r.innerHTML=a.innerHTML;for(var o=0;o<a.attributes.length;o++)r.setAttributeNS("http://www.w3.org/2000/svg",a.attributes[o].name,a.attributes[o].value);r.id=s+e,this.registerIconFromSymbol(e,r.outerHTML)}registerIconFromSvg(e,t,s=this.iconPrefix){e=this.processId(e,s);const i="<svg ",r="</svg>";t=t.trim();const a=t.toLowerCase();return a.substring(0,i.length)===i&&a.substring(a.length-r.length,a.length)===r?(this.registerIconFromSymbol(e,'<symbol id="'+s+e+'" '+t.substring(i.length,a.length-r.length)+"</symbol>"),!0):!1}registerIconsFromFolder(e){e.keys().forEach(t=>{this.registerIconFromSvg(t.substring(2,t.length-4).toLowerCase(),e(t))})}registerIcons(e){for(const t in e)this.registerIconFromSvg(t,e[t]);this.updateMarkup()}registerIcon(e,t,s="v2"){this.registerIconFromSvg(e,t),vh(s,{[e]:t})}iconsRenderedHtml(){return Object.keys(this.icons).map(e=>this.icons[e]).join("")}updateMarkup(){this.onIconsChanged.fire(this,{})}};const So=new US,yh={};function vh(n,e){yh[n]||(yh[n]={});const t=yh[n];for(const s in e)t[s]=e[s]}var hn,Le,wv,Ji,xv,Vv,Pv,Sv,Ch,bh,wh,dn={},Iv=[],WS=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,cn=Array.isArray;function Us(n,e){for(var t in e)n[t]=e[t];return n}function xh(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function y(n,e,t){var s,i,r,a={};for(r in e)r=="key"?s=e[r]:r=="ref"?i=e[r]:a[r]=e[r];if(arguments.length>2&&(a.children=arguments.length>3?hn.call(arguments,2):t),typeof n=="function"&&n.defaultProps!=null)for(r in n.defaultProps)a[r]===void 0&&(a[r]=n.defaultProps[r]);return pn(n,a,s,i,null)}function pn(n,e,t,s,i){var r={type:n,props:e,key:t,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++wv,__i:-1,__u:0};return i==null&&Le.vnode!=null&&Le.vnode(r),r}function ct(){return{current:null}}function Me(n){return n.children}function Ge(n,e){this.props=n,this.context=e}function Er(n,e){if(e==null)return n.__?Er(n.__,n.__i+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?Er(n):null}function Tv(n){var e,t;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return Tv(n)}}function Ev(n){(!n.__d&&(n.__d=!0)&&Ji.push(n)&&!Io.__r++||xv!=Le.debounceRendering)&&((xv=Le.debounceRendering)||Vv)(Io)}function Io(){for(var n,e,t,s,i,r,a,o=1;Ji.length;)Ji.length>o&&Ji.sort(Pv),n=Ji.shift(),o=Ji.length,n.__d&&(t=void 0,s=void 0,i=(s=(e=n).__v).__e,r=[],a=[],e.__P&&((t=Us({},s)).__v=s.__v+1,Le.vnode&&Le.vnode(t),Vh(e.__P,t,s,e.__n,e.__P.namespaceURI,32&s.__u?[i]:null,r,i??Er(s),!!(32&s.__u),a),t.__v=s.__v,t.__.__k[t.__i]=t,Dv(r,t,a),s.__e=s.__=null,t.__e!=i&&Tv(t)));Io.__r=0}function Rv(n,e,t,s,i,r,a,o,l,u,d){var h,f,C,b,x,V,P,M=s&&s.__k||Iv,X=e.length;for(l=$S(t,e,M,l,X),h=0;h<X;h++)(C=t.__k[h])!=null&&(f=C.__i==-1?dn:M[C.__i]||dn,C.__i=h,V=Vh(n,C,f,i,r,a,o,l,u,d),b=C.__e,C.ref&&f.ref!=C.ref&&(f.ref&&Sh(f.ref,null,C),d.push(C.ref,C.__c||b,C)),x==null&&b!=null&&(x=b),(P=!!(4&C.__u))||f.__k===C.__k?l=_v(C,l,n,P):typeof C.type=="function"&&V!==void 0?l=V:b&&(l=b.nextSibling),C.__u&=-7);return t.__e=x,l}function $S(n,e,t,s,i){var r,a,o,l,u,d=t.length,h=d,f=0;for(n.__k=new Array(i),r=0;r<i;r++)(a=e[r])!=null&&typeof a!="boolean"&&typeof a!="function"?(l=r+f,(a=n.__k[r]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?pn(null,a,null,null,null):cn(a)?pn(Me,{children:a},null,null,null):a.constructor==null&&a.__b>0?pn(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=n,a.__b=n.__b+1,o=null,(u=a.__i=GS(a,t,l,h))!=-1&&(h--,(o=t[u])&&(o.__u|=2)),o==null||o.__v==null?(u==-1&&(i>d?f--:i<d&&f++),typeof a.type!="function"&&(a.__u|=4)):u!=l&&(u==l-1?f--:u==l+1?f++:(u>l?f--:f++,a.__u|=4))):n.__k[r]=null;if(h)for(r=0;r<d;r++)(o=t[r])!=null&&(2&o.__u)==0&&(o.__e==s&&(s=Er(o)),Mv(o,o));return s}function _v(n,e,t,s){var i,r;if(typeof n.type=="function"){for(i=n.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=n,e=_v(i[r],e,t,s));return e}n.__e!=e&&(s&&(e&&n.type&&!e.parentNode&&(e=Er(n)),t.insertBefore(n.__e,e||null)),e=n.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function To(n,e){return e=e||[],n==null||typeof n=="boolean"||(cn(n)?n.some(function(t){To(t,e)}):e.push(n)),e}function GS(n,e,t,s){var i,r,a,o=n.key,l=n.type,u=e[t],d=u!=null&&(2&u.__u)==0;if(u===null&&n.key==null||d&&o==u.key&&l==u.type)return t;if(s>(d?1:0)){for(i=t-1,r=t+1;i>=0||r<e.length;)if((u=e[a=i>=0?i--:r++])!=null&&(2&u.__u)==0&&o==u.key&&l==u.type)return a}return-1}function Lv(n,e,t){e[0]=="-"?n.setProperty(e,t??""):n[e]=t==null?"":typeof t!="number"||WS.test(e)?t:t+"px"}function Eo(n,e,t,s,i){var r,a;e:if(e=="style")if(typeof t=="string")n.style.cssText=t;else{if(typeof s=="string"&&(n.style.cssText=s=""),s)for(e in s)t&&e in t||Lv(n.style,e,"");if(t)for(e in t)s&&t[e]==s[e]||Lv(n.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")r=e!=(e=e.replace(Sv,"$1")),a=e.toLowerCase(),e=a in n||e=="onFocusOut"||e=="onFocusIn"?a.slice(2):e.slice(2),n.l||(n.l={}),n.l[e+r]=t,t?s?t.u=s.u:(t.u=Ch,n.addEventListener(e,r?wh:bh,r)):n.removeEventListener(e,r?wh:bh,r);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in n)try{n[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?n.removeAttribute(e):n.setAttribute(e,e=="popover"&&t==1?"":t))}}function Av(n){return function(e){if(this.l){var t=this.l[e.type+n];if(e.t==null)e.t=Ch++;else if(e.t<t.u)return;return t(Le.event?Le.event(e):e)}}}function Vh(n,e,t,s,i,r,a,o,l,u){var d,h,f,C,b,x,V,P,M,X,N,W,J,ie,ne,ce,ye,le=e.type;if(e.constructor!=null)return null;128&t.__u&&(l=!!(32&t.__u),r=[o=e.__e=t.__e]),(d=Le.__b)&&d(e);e:if(typeof le=="function")try{if(P=e.props,M="prototype"in le&&le.prototype.render,X=(d=le.contextType)&&s[d.__c],N=d?X?X.props.value:d.__:s,t.__c?V=(h=e.__c=t.__c).__=h.__E:(M?e.__c=h=new le(P,N):(e.__c=h=new Ge(P,N),h.constructor=le,h.render=KS),X&&X.sub(h),h.props=P,h.state||(h.state={}),h.context=N,h.__n=s,f=h.__d=!0,h.__h=[],h._sb=[]),M&&h.__s==null&&(h.__s=h.state),M&&le.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=Us({},h.__s)),Us(h.__s,le.getDerivedStateFromProps(P,h.__s))),C=h.props,b=h.state,h.__v=e,f)M&&le.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),M&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(M&&le.getDerivedStateFromProps==null&&P!==C&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(P,N),!h.__e&&h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(P,h.__s,N)===!1||e.__v==t.__v){for(e.__v!=t.__v&&(h.props=P,h.state=h.__s,h.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(be){be&&(be.__=e)}),W=0;W<h._sb.length;W++)h.__h.push(h._sb[W]);h._sb=[],h.__h.length&&a.push(h);break e}h.componentWillUpdate!=null&&h.componentWillUpdate(P,h.__s,N),M&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(C,b,x)})}if(h.context=N,h.props=P,h.__P=n,h.__e=!1,J=Le.__r,ie=0,M){for(h.state=h.__s,h.__d=!1,J&&J(e),d=h.render(h.props,h.state,h.context),ne=0;ne<h._sb.length;ne++)h.__h.push(h._sb[ne]);h._sb=[]}else do h.__d=!1,J&&J(e),d=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++ie<25);h.state=h.__s,h.getChildContext!=null&&(s=Us(Us({},s),h.getChildContext())),M&&!f&&h.getSnapshotBeforeUpdate!=null&&(x=h.getSnapshotBeforeUpdate(C,b)),ce=d,d!=null&&d.type===Me&&d.key==null&&(ce=Ov(d.props.children)),o=Rv(n,cn(ce)?ce:[ce],e,t,s,i,r,a,o,l,u),h.base=e.__e,e.__u&=-161,h.__h.length&&a.push(h),V&&(h.__E=h.__=null)}catch(be){if(e.__v=null,l||r!=null)if(be.then){for(e.__u|=l?160:128;o&&o.nodeType==8&&o.nextSibling;)o=o.nextSibling;r[r.indexOf(o)]=null,e.__e=o}else{for(ye=r.length;ye--;)xh(r[ye]);Ph(e)}else e.__e=t.__e,e.__k=t.__k,be.then||Ph(e);Le.__e(be,e,t)}else r==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):o=e.__e=JS(t.__e,e,t,s,i,r,a,l,u);return(d=Le.diffed)&&d(e),128&e.__u?void 0:o}function Ph(n){n&&n.__c&&(n.__c.__e=!0),n&&n.__k&&n.__k.forEach(Ph)}function Dv(n,e,t){for(var s=0;s<t.length;s++)Sh(t[s],t[++s],t[++s]);Le.__c&&Le.__c(e,n),n.some(function(i){try{n=i.__h,i.__h=[],n.some(function(r){r.call(i)})}catch(r){Le.__e(r,i.__v)}})}function Ov(n){return typeof n!="object"||n==null||n.__b&&n.__b>0?n:cn(n)?n.map(Ov):Us({},n)}function JS(n,e,t,s,i,r,a,o,l){var u,d,h,f,C,b,x,V=t.props,P=e.props,M=e.type;if(M=="svg"?i="http://www.w3.org/2000/svg":M=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(u=0;u<r.length;u++)if((C=r[u])&&"setAttribute"in C==!!M&&(M?C.localName==M:C.nodeType==3)){n=C,r[u]=null;break}}if(n==null){if(M==null)return document.createTextNode(P);n=document.createElementNS(i,M,P.is&&P),o&&(Le.__m&&Le.__m(e,r),o=!1),r=null}if(M==null)V===P||o&&n.data==P||(n.data=P);else{if(r=r&&hn.call(n.childNodes),V=t.props||dn,!o&&r!=null)for(V={},u=0;u<n.attributes.length;u++)V[(C=n.attributes[u]).name]=C.value;for(u in V)if(C=V[u],u!="children"){if(u=="dangerouslySetInnerHTML")h=C;else if(!(u in P)){if(u=="value"&&"defaultValue"in P||u=="checked"&&"defaultChecked"in P)continue;Eo(n,u,null,C,i)}}for(u in P)C=P[u],u=="children"?f=C:u=="dangerouslySetInnerHTML"?d=C:u=="value"?b=C:u=="checked"?x=C:o&&typeof C!="function"||V[u]===C||Eo(n,u,C,V[u],i);if(d)o||h&&(d.__html==h.__html||d.__html==n.innerHTML)||(n.innerHTML=d.__html),e.__k=[];else if(h&&(n.innerHTML=""),Rv(e.type=="template"?n.content:n,cn(f)?f:[f],e,t,s,M=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,a,r?r[0]:t.__k&&Er(t,0),o,l),r!=null)for(u=r.length;u--;)xh(r[u]);o||(u="value",M=="progress"&&b==null?n.removeAttribute("value"):b!=null&&(b!==n[u]||M=="progress"&&!b||M=="option"&&b!=V[u])&&Eo(n,u,b,V[u],i),u="checked",x!=null&&x!=n[u]&&Eo(n,u,x,V[u],i))}return n}function Sh(n,e,t){try{if(typeof n=="function"){var s=typeof n.__u=="function";s&&n.__u(),s&&e==null||(n.__u=n(e))}else n.current=e}catch(i){Le.__e(i,t)}}function Mv(n,e,t){var s,i;if(Le.unmount&&Le.unmount(n),(s=n.ref)&&(s.current&&s.current!=n.__e||Sh(s,null,e)),(s=n.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(r){Le.__e(r,e)}s.base=s.__P=null}if(s=n.__k)for(i=0;i<s.length;i++)s[i]&&Mv(s[i],e,t||typeof n.type!="function");t||xh(n.__e),n.__c=n.__=n.__e=void 0}function KS(n,e,t){return this.constructor(n,t)}function Ih(n,e,t){var s,i,r,a;e==document&&(e=document.documentElement),Le.__&&Le.__(n,e),i=(s=!1)?null:e.__k,r=[],a=[],Vh(e,n=e.__k=y(Me,null,[n]),i||dn,dn,e.namespaceURI,i?null:e.firstChild?hn.call(e.childNodes):null,r,i?i.__e:e.firstChild,s,a),Dv(r,n,a)}function ZS(n,e,t){var s,i,r,a,o=Us({},n.props);for(r in n.type&&n.type.defaultProps&&(a=n.type.defaultProps),e)r=="key"?s=e[r]:r=="ref"?i=e[r]:o[r]=e[r]===void 0&&a!=null?a[r]:e[r];return arguments.length>2&&(o.children=arguments.length>3?hn.call(arguments,2):t),pn(n.type,o,s||n.key,i||n.ref,null)}hn=Iv.slice,Le={__e:function(n,e,t,s){for(var i,r,a;e=e.__;)if((i=e.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(n)),a=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(n,s||{}),a=i.__d),a)return i.__E=i}catch(o){n=o}throw n}},wv=0,Ge.prototype.setState=function(n,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Us({},this.state),typeof n=="function"&&(n=n(Us({},t),this.props)),n&&Us(t,n),n!=null&&this.__v&&(e&&this._sb.push(e),Ev(this))},Ge.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),Ev(this))},Ge.prototype.render=Me,Ji=[],Vv=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Pv=function(n,e){return n.__v.__b-e.__v.__b},Io.__r=0,Sv=/(PointerCapture)$|Capture$/i,Ch=0,bh=Av(!1),wh=Av(!0);var Ws,Th,kv,Nv=[],Bt=Le,qv=Bt.__b,Bv=Bt.__r,Fv=Bt.diffed,Qv=Bt.__c,Hv=Bt.unmount,zv=Bt.__;function YS(){for(var n;n=Nv.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(Ro),n.__H.__h.forEach(Eh),n.__H.__h=[]}catch(e){n.__H.__h=[],Bt.__e(e,n.__v)}}Bt.__b=function(n){Ws=null,qv&&qv(n)},Bt.__=function(n,e){n&&e.__k&&e.__k.__m&&(n.__m=e.__k.__m),zv&&zv(n,e)},Bt.__r=function(n){Bv&&Bv(n);var e=(Ws=n.__c).__H;e&&(Th===Ws?(e.__h=[],Ws.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.forEach(Ro),e.__h.forEach(Eh),e.__h=[])),Th=Ws},Bt.diffed=function(n){Fv&&Fv(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(Nv.push(e)!==1&&kv===Bt.requestAnimationFrame||((kv=Bt.requestAnimationFrame)||XS)(YS)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),Th=Ws=null},Bt.__c=function(n,e){e.some(function(t){try{t.__h.forEach(Ro),t.__h=t.__h.filter(function(s){return!s.__||Eh(s)})}catch(s){e.some(function(i){i.__h&&(i.__h=[])}),e=[],Bt.__e(s,t.__v)}}),Qv&&Qv(n,e)},Bt.unmount=function(n){Hv&&Hv(n);var e,t=n.__c;t&&t.__H&&(t.__H.__.forEach(function(s){try{Ro(s)}catch(i){e=i}}),t.__H=void 0,e&&Bt.__e(e,t.__v))};var jv=typeof requestAnimationFrame=="function";function XS(n){var e,t=function(){clearTimeout(s),jv&&cancelAnimationFrame(e),setTimeout(n)},s=setTimeout(t,35);jv&&(e=requestAnimationFrame(t))}function Ro(n){var e=Ws,t=n.__c;typeof t=="function"&&(n.__c=void 0,t()),Ws=e}function Eh(n){var e=Ws;n.__c=n.__(),Ws=e}function eI(n,e){for(var t in e)n[t]=e[t];return n}function Uv(n,e){for(var t in n)if(t!=="__source"&&!(t in e))return!0;for(var s in e)if(s!=="__source"&&n[s]!==e[s])return!0;return!1}function Wv(n,e){this.props=n,this.context=e}(Wv.prototype=new Ge).isPureReactComponent=!0,Wv.prototype.shouldComponentUpdate=function(n,e){return Uv(this.props,n)||Uv(this.state,e)};var $v=Le.__b;Le.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),$v&&$v(n)};var tI=Le.__e;Le.__e=function(n,e,t,s){if(n.then){for(var i,r=e;r=r.__;)if((i=r.__c)&&i.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),i.__c(n,e)}tI(n,e,t,s)};var Gv=Le.unmount;function Jv(n,e,t){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(s){typeof s.__c=="function"&&s.__c()}),n.__c.__H=null),(n=eI({},n)).__c!=null&&(n.__c.__P===t&&(n.__c.__P=e),n.__c.__e=!0,n.__c=null),n.__k=n.__k&&n.__k.map(function(s){return Jv(s,e,t)})),n}function Kv(n,e,t){return n&&t&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(s){return Kv(s,e,t)}),n.__c&&n.__c.__P===e&&(n.__e&&t.appendChild(n.__e),n.__c.__e=!0,n.__c.__P=t)),n}function Rh(){this.__u=0,this.o=null,this.__b=null}function Zv(n){var e=n.__.__c;return e&&e.__a&&e.__a(n)}function _o(){this.i=null,this.l=null}Le.unmount=function(n){var e=n.__c;e&&e.__R&&e.__R(),e&&32&n.__u&&(n.type=null),Gv&&Gv(n)},(Rh.prototype=new Ge).__c=function(n,e){var t=e.__c,s=this;s.o==null&&(s.o=[]),s.o.push(t);var i=Zv(s.__v),r=!1,a=function(){r||(r=!0,t.__R=null,i?i(o):o())};t.__R=a;var o=function(){if(!--s.__u){if(s.state.__a){var l=s.state.__a;s.__v.__k[0]=Kv(l,l.__c.__P,l.__c.__O)}var u;for(s.setState({__a:s.__b=null});u=s.o.pop();)u.forceUpdate()}};s.__u++||32&e.__u||s.setState({__a:s.__b=s.__v.__k[0]}),n.then(a,a)},Rh.prototype.componentWillUnmount=function(){this.o=[]},Rh.prototype.render=function(n,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),s=this.__v.__k[0].__c;this.__v.__k[0]=Jv(this.__b,t,s.__O=s.__P)}this.__b=null}var i=e.__a&&y(Me,null,n.fallback);return i&&(i.__u&=-33),[y(Me,null,e.__a?null:n.children),i]};var Yv=function(n,e,t){if(++t[1]===t[0]&&n.l.delete(e),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.l.size))for(t=n.i;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;n.i=t=t[2]}};function sI(n){return this.getChildContext=function(){return n.context},n.children}function iI(n){var e=this,t=n.h;if(e.componentWillUnmount=function(){Ih(null,e.v),e.v=null,e.h=null},e.h&&e.h!==t&&e.componentWillUnmount(),!e.v){for(var s=e.__v;s!==null&&!s.__m&&s.__!==null;)s=s.__;e.h=t,e.v={nodeType:1,parentNode:t,childNodes:[],__k:{__m:s.__m},contains:function(){return!0},insertBefore:function(i,r){this.childNodes.push(i),e.h.insertBefore(i,r)},removeChild:function(i){this.childNodes.splice(this.childNodes.indexOf(i)>>>1,1),e.h.removeChild(i)}}}Ih(y(sI,{context:e.context},n.__v),e.v)}function rI(n,e){var t=y(iI,{__v:n,h:e});return t.containerInfo=e,t}(_o.prototype=new Ge).__a=function(n){var e=this,t=Zv(e.__v),s=e.l.get(n);return s[0]++,function(i){var r=function(){e.props.revealOrder?(s.push(i),Yv(e,n,s)):i()};t?t(r):r()}},_o.prototype.render=function(n){this.i=null,this.l=new Map;var e=To(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.l.set(e[t],this.i=[1,0,this.i]);return n.children},_o.prototype.componentDidUpdate=_o.prototype.componentDidMount=function(){var n=this;this.l.forEach(function(e,t){Yv(n,t,e)})};var Xv=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,nI=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,aI=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,oI=/[A-Z0-9]/g,lI=typeof document<"u",uI=function(n){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(n)};function eC(n,e,t){return e.__k==null&&(e.textContent=""),Ih(n,e),typeof t=="function"&&t(),n?n.__c:null}Ge.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(n){Object.defineProperty(Ge.prototype,n,{configurable:!0,get:function(){return this["UNSAFE_"+n]},set:function(e){Object.defineProperty(this,n,{configurable:!0,writable:!0,value:e})}})});var tC=Le.event;function hI(){}function dI(){return this.cancelBubble}function cI(){return this.defaultPrevented}Le.event=function(n){return tC&&(n=tC(n)),n.persist=hI,n.isPropagationStopped=dI,n.isDefaultPrevented=cI,n.nativeEvent=n};var pI={enumerable:!1,configurable:!0,get:function(){return this.class}},sC=Le.vnode;Le.vnode=function(n){typeof n.type=="string"&&(function(e){var t=e.props,s=e.type,i={},r=s.indexOf("-")===-1;for(var a in t){var o=t[a];if(!(a==="value"&&"defaultValue"in t&&o==null||lI&&a==="children"&&s==="noscript"||a==="class"||a==="className")){var l=a.toLowerCase();a==="defaultValue"&&"value"in t&&t.value==null?a="value":a==="download"&&o===!0?o="":l==="translate"&&o==="no"?o=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?a="ondblclick":l!=="onchange"||s!=="input"&&s!=="textarea"||uI(t.type)?l==="onfocus"?a="onfocusin":l==="onblur"?a="onfocusout":aI.test(a)&&(a=l):l=a="oninput":r&&nI.test(a)?a=a.replace(oI,"-$&").toLowerCase():o===null&&(o=void 0),l==="oninput"&&i[a=l]&&(a="oninputCapture"),i[a]=o}}s=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=To(t.children).forEach(function(u){u.props.selected=i.value.indexOf(u.props.value)!=-1})),s=="select"&&i.defaultValue!=null&&(i.value=To(t.children).forEach(function(u){u.props.selected=i.multiple?i.defaultValue.indexOf(u.props.value)!=-1:i.defaultValue==u.props.value})),t.class&&!t.className?(i.class=t.class,Object.defineProperty(i,"className",pI)):(t.className&&!t.class||t.class&&t.className)&&(i.class=i.className=t.className),e.props=i})(n),n.$$typeof=Xv,sC&&sC(n)};var iC=Le.__r;Le.__r=function(n){iC&&iC(n),n.__c};var rC=Le.diffed;Le.diffed=function(n){rC&&rC(n);var e=n.props,t=n.__e;t!=null&&n.type==="textarea"&&"value"in e&&e.value!==t.value&&(t.value=e.value==null?"":e.value)};function gI(n){return!!n&&n.$$typeof===Xv}function nC(n){return gI(n)?ZS.apply(null,arguments):n}var aC=function(n,e){return n(e)};let ee=class{constructor(){this.creatorHash={}}registerElement(e,t){this.creatorHash[e]=t}getAllTypes(){var e=new Array;for(var t in this.creatorHash)e.push(t);return e.sort()}isElementRegistered(e){return!!this.creatorHash[e]}createElement(e,t){var s=this.creatorHash[e];return s==null?null:s(t)}};ee.Instance=new ee;let $s=class{static wrapRow(e,t,s){const i=e.getRowWrapperComponentName(s),r=e.getRowWrapperComponentData(s);return ee.Instance.createElement(i,{element:t,row:s,componentData:r})}static wrapElement(e,t,s){const i=e.getElementWrapperComponentName(s),r=e.getElementWrapperComponentData(s);return ee.Instance.createElement(i,{element:t,question:s,componentData:r})}static wrapQuestionContent(e,t,s){const i=e.getQuestionContentWrapperComponentName(s),r=e.getElementWrapperComponentData(s);return ee.Instance.createElement(i,{element:t,question:s,componentData:r})}static wrapItemValue(e,t,s,i){const r=e.getItemValueWrapperComponentName(i,s),a=e.getItemValueWrapperComponentData(i,s);return ee.Instance.createElement(r,{key:t?.key,element:t,question:s,item:i,componentData:a})}static wrapMatrixCell(e,t,s,i="cell"){const r=e.getElementWrapperComponentName(s,i),a=e.getElementWrapperComponentData(s,i);return ee.Instance.createElement(r,{element:t,cell:s,componentData:a})}};Ee.platform="react";let Se=class xf extends Ge{static renderLocString(e,t=null,s){return ee.Instance.createElement(e.renderAs,{locStr:e.renderAsData,style:t,key:s})}static renderQuestionDescription(e){var t=xf.renderLocString(e.locDescription);return y("div",{style:e.hasDescription?void 0:{display:"none"},id:e.ariaDescriptionId,className:e.cssDescription},t)}constructor(e){super(e),this._allowComponentUpdate=!0,this.prevStateElements=[],this.propertyValueChangedHandler=(t,s)=>{const i=s.name;!this.canUsePropInState(i)||this.isRendering||(this.changedStatePropNameValue=i,this.setState(r=>{var a={};return a[i]=s.newValue,a}))},this.onArrayChangedCallback=(t,s)=>{this.isRendering||(this.changedStatePropNameValue=s.name,this.setState(i=>{var r={};return r[s.name]=s.newValue,r}))}}componentDidMount(){this.makeBaseElementsReact()}componentWillUnmount(){this.unMakeBaseElementsReact(),this.disableStateElementsRerenderEvent(this.getStateElements())}componentDidUpdate(e,t){var s;this.makeBaseElementsReact();const i=this.getStateElements();this.disableStateElementsRerenderEvent(((s=this.prevStateElements)!==null&&s!==void 0?s:[]).filter(r=>!i.find(a=>a==r))),this.prevStateElements=[],this.getStateElements().forEach(r=>{r.afterRerender()})}allowComponentUpdate(){this._allowComponentUpdate=!0,this.forceUpdate()}denyComponentUpdate(){this._allowComponentUpdate=!1}shouldComponentUpdate(e,t){return this._allowComponentUpdate&&(this.unMakeBaseElementsReact(),this.prevStateElements=this.getStateElements()),this._allowComponentUpdate}render(){if(!this.canRender())return null;this.startEndRendering(1);var e=this.renderElement();return this.startEndRendering(-1),e&&(e=this.wrapElement(e)),this.changedStatePropNameValue=void 0,e}wrapElement(e){return e}get isRendering(){var e=this.getRenderedElements();for(let t of e)if(t.reactRendering>0)return!0;return!1}getRenderedElements(){return this.getStateElements()}startEndRendering(e){var t=this.getRenderedElements();for(let s of t)s.reactRendering||(s.reactRendering=0),s.reactRendering+=e}canRender(){return!0}renderElement(){return null}get changedStatePropName(){return this.changedStatePropNameValue}makeBaseElementsReact(){for(var e=this.getStateElements(),t=0;t<e.length;t++)e[t].enableOnElementRerenderedEvent(),this.makeBaseElementReact(e[t])}unMakeBaseElementsReact(){var e=this.getStateElements();this.unMakeBaseElementsReactive(e)}unMakeBaseElementsReactive(e){for(var t=0;t<e.length;t++)this.unMakeBaseElementReact(e[t])}disableStateElementsRerenderEvent(e){e.forEach(t=>{t.disableOnElementRerenderedEvent()})}getStateElements(){var e=this.getStateElement();return e?[e]:[]}getStateElement(){return null}get isDisplayMode(){return this.props.isDisplayMode||!1}renderLocString(e,t=null,s){return xf.renderLocString(e,t,s)}canMakeReact(e){return!!e&&!!e.iteratePropertiesHash}makeBaseElementReact(e){this.canMakeReact(e)&&(e.addOnArrayChangedCallback(this.onArrayChangedCallback),e.addOnPropertyValueChangedCallback(this.propertyValueChangedHandler))}canUsePropInState(e){return!0}unMakeBaseElementReact(e){this.canMakeReact(e)&&(e.removeOnPropertyValueChangedCallback(this.propertyValueChangedHandler),e.removeOnArrayChangedCallback(this.onArrayChangedCallback))}},ot=class extends Se{constructor(e){super(e)}get cssClasses(){return this.props.cssClasses}},St=class extends Se{constructor(e){super(e)}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.updateDomElement()}componentDidMount(){super.componentDidMount(),this.updateDomElement()}componentWillUnmount(){if(super.componentWillUnmount(),this.questionBase){const e=this.content||this.control;this.questionBase.beforeDestroyQuestionElement(e),e&&e.removeAttribute("data-rendered")}}updateDomElement(){const e=this.content||this.control;e&&e.getAttribute("data-rendered")!=="r"&&(e.setAttribute("data-rendered","r"),this.questionBase.afterRenderQuestionElement(e))}get questionBase(){return this.props.question}getRenderedElements(){return[this.questionBase]}get creator(){return this.props.creator}canRender(){return!!this.questionBase&&!!this.creator}shouldComponentUpdate(e,t){return super.shouldComponentUpdate(e,t)?!this.questionBase.customWidget||!!this.questionBase.customWidgetData.isNeedRender||!!this.questionBase.customWidget.widgetJson.isDefaultRender||!!this.questionBase.customWidget.widgetJson.render:!1}get isDisplayMode(){return this.props.isDisplayMode||!!this.questionBase&&this.questionBase.isInputReadOnly||!1}wrapCell(e,t,s){if(!s)return t;const i=this.questionBase.survey;let r=null;return i&&(r=$s.wrapMatrixCell(i,t,e,s)),r??t}setControl(e){e&&(this.control=e)}setContent(e){e&&(this.content=e)}},gn=class extends St{constructor(e){super(e),this.updateValueOnEvent=t=>{O.isTwoValueEquals(this.questionBase.value,t.target.value,!1,!0,!1)||this.setValueCore(t.target.value)},this.updateValueOnEvent=this.updateValueOnEvent.bind(this)}get question(){return this.questionBase}setValueCore(e){this.questionBase.value=e}getValueCore(){return this.questionBase.value}updateDomElement(){if(this.control){const e=this.control,t=this.getValueCore();O.isTwoValueEquals(t,e.value,!1,!0,!1)||(e.value=this.getValue(t))}super.updateDomElement()}getValue(e){return O.isValueEmpty(e)?"":e}},Be=class extends Ge{constructor(e){super(e),this.svgIconRef=ct()}updateSvg(){this.props.iconName&&K2(this.props.size,this.props.width,this.props.height,this.props.iconName,this.svgIconRef.current,this.props.title)}componentDidUpdate(){this.updateSvg()}render(){let e="sv-svg-icon";return this.props.className&&(e+=" "+this.props.className),this.props.iconName?y("svg",{className:e,style:this.props.style,onClick:this.props.onClick,ref:this.svgIconRef,role:"presentation"},y("use",null)):null}componentDidMount(){this.updateSvg()}};ee.Instance.registerElement("sv-svg-icon",n=>y(Be,n));let oC=class extends Ge{constructor(e){super(e)}render(){var e=`sv-action-bar-separator ${this.props.cssClasses}`;return y("div",{className:e})}};ee.Instance.registerElement("sv-action-bar-separator",n=>y(oC,n));let mn=class extends Se{constructor(e){super(e),this.ref=ct()}get item(){return this.props.item}getStateElement(){return this.item}renderElement(){const e=this.item.getActionRootCss(),t=this.item.needSeparator?y(oC,null):null,s=ee.Instance.createElement(this.item.component||"sv-action-bar-item",{item:this.item});return y("div",{className:e,id:this.item.id,ref:this.ref},y("div",{className:"sv-action__content"},t,s))}componentWillUnmount(){super.componentWillUnmount(),this.item.updateModeCallback=void 0}componentDidMount(){super.componentDidMount(),this.item.updateModeCallback=(e,t)=>{queueMicrotask(()=>{aC?aC(()=>{this.item.mode=e}):this.item.mode=e,queueMicrotask(()=>{t(e,this.ref.current)})})},this.item.afterRender()}},lC=class extends Se{get item(){return this.props.item}getStateElement(){return this.item}renderElement(){return y(Me,null,this.renderInnerButton())}renderText(){if(!this.item.hasTitle)return null;const e=this.item.getActionBarItemTitleCss();return y("span",{className:e},this.item.title)}renderButtonContent(){const e=this.renderText(),t=this.item.iconName?y(Be,{className:this.item.cssClasses.itemIcon,size:this.item.iconSize,iconName:this.item.iconName,title:this.item.tooltip||this.item.title}):null;return y(Me,null,t,e)}renderInnerButton(){const e=this.item.getActionBarItemCss(),t=this.item.tooltip||this.item.title,s=this.renderButtonContent(),i=this.item.disableTabStop?-1:void 0;return Oh(y("button",{className:e,type:"button",disabled:this.item.disabled,onMouseDown:a=>this.item.doMouseDown(a),onFocus:a=>this.item.doFocus(a),onClick:a=>this.item.doAction(a),title:t,tabIndex:i,"aria-checked":this.item.ariaChecked,"aria-expanded":this.item.ariaExpanded,role:this.item.ariaRole},s),this.item,{processEsc:!1})}};ee.Instance.registerElement("sv-action-bar-item",n=>y(lC,n));let fn=class extends Se{constructor(e){super(e),this.containerRef=ct(),this.createModel()}get model(){return this.props.model}getStateElement(){return this.model}createModel(){this.popup=NS(this.props.model)}setTargetElement(){const e=this.containerRef.current;this.popup.setComponentElement(e)}componentDidMount(){super.componentDidMount(),this.setTargetElement()}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.setTargetElement()}componentWillUnmount(){super.componentWillUnmount(),this.popup.resetComponentElement()}shouldComponentUpdate(e,t){var s;if(!super.shouldComponentUpdate(e,t))return!1;const i=e.model!==this.popup.model;return i&&((s=this.popup)===null||s===void 0||s.dispose(),this.createModel()),i}render(){this.popup.model=this.model;let e;return this.model.isModal?e=y(_h,{model:this.popup}):e=y(mI,{model:this.popup}),y("div",{ref:this.containerRef},e)}};ee.Instance.registerElement("sv-popup",n=>y(fn,n));let _h=class extends Se{constructor(e){super(e),this.handleKeydown=t=>{this.model.onKeyDown(t)},this.clickInside=t=>{t.stopPropagation()}}get model(){return this.props.model}getStateElement(){return this.model}componentDidUpdate(e,t){super.componentDidUpdate(e,t),!this.model.isPositionSet&&this.model.isVisible&&this.model.updateOnShowing()}renderContainer(e){const t=e.showHeader?this.renderHeaderPopup(e):null,s=e.title?this.renderHeaderContent():null,i=this.renderContent(),r=e.showFooter?this.renderFooter(this.model):null;return y("div",{className:"sv-popup__container",style:{left:e.left,top:e.top,height:e.height,width:e.width,minWidth:e.minWidth},onClick:a=>{this.clickInside(a)}},t,y("div",{className:"sv-popup__body-content"},s,y("div",{className:"sv-popup__scrolling-content"},i),r))}renderHeaderContent(){return y("div",{className:"sv-popup__body-header"},this.model.title)}renderContent(){const e=ee.Instance.createElement(this.model.contentComponentName,this.model.contentComponentData);return y("div",{className:"sv-popup__content"},e)}renderHeaderPopup(e){return null}renderFooter(e){return y("div",{className:"sv-popup__body-footer"},y(bs,{model:e.footerToolbar}))}render(){const e=this.renderContainer(this.model),t=new z().append("sv-popup").append(this.model.styleClass).toString(),s={display:this.model.isVisible?"":"none"};return y("div",{tabIndex:-1,className:t,style:s,onClick:i=>{this.model.clickOutside(i)},onBlur:i=>{this.model.blur(i)},onKeyDown:this.handleKeydown},e)}componentDidMount(){super.componentDidMount(),this.model.isVisible&&this.model.updateOnShowing()}},mI=class extends _h{renderHeaderPopup(e){const t=e;return t?y("span",{style:{left:t.pointerTarget.left,top:t.pointerTarget.top},className:"sv-popup__pointer"}):null}},fI=class extends lC{constructor(e){super(e)}renderInnerButton(){const e=super.renderInnerButton();return y(Me,null,e,y(fn,{model:this.item.popupModel}))}componentDidMount(){this.viewModel=new q2(this.item)}componentWillUnmount(){super.componentWillUnmount(),this.viewModel.dispose()}};ee.Instance.registerElement("sv-action-bar-item-dropdown",n=>y(fI,n));let bs=class extends Se{constructor(e){super(e),this.rootRef=ct()}get handleClick(){return this.props.handleClick!==void 0?this.props.handleClick:!0}get model(){return this.props.model}componentDidMount(){if(super.componentDidMount(),!this.model.hasVisibleActions)return;const e=this.rootRef.current;e&&this.model.initResponsivityManager(e,t=>{setTimeout(t,100)})}componentWillUnmount(){super.componentWillUnmount(),this.model.resetResponsivityManager()}componentDidUpdate(e,t){if(super.componentDidUpdate(e,t),e.model!=this.props.model&&e.model.resetResponsivityManager(),this.model.hasVisibleActions){const s=this.rootRef.current;s&&this.model.initResponsivityManager(s,i=>{setTimeout(i,100)})}}getStateElement(){return this.model}renderElement(){if(!this.model.hasActions)return null;const e=this.renderItems();return y("div",{ref:this.rootRef,style:this.model.getRootStyle(),className:this.model.getRootCss(),onClick:this.handleClick?function(t){t.stopPropagation()}:void 0},e)}renderItems(){return this.model.renderedActions.concat([]).map((e,t)=>y(mn,{item:e,key:e.renderedId}))}};ee.Instance.registerElement("sv-action-bar",n=>y(bs,n));let uC=class extends Ge{constructor(e){super(e)}get cssClasses(){return this.props.cssClasses}get element(){return this.props.element}render(){if(this.element.isTitleRenderedAsString)return Se.renderLocString(this.element.locRenderedTitle);var e=this.renderTitleSpans(this.element.getTitleOwner(),this.cssClasses);return y(Me,null,e)}renderTitleSpans(e,t){var s=a=>y("span",{"data-key":a,key:a},""),i=[];e.isRequireTextOnStart&&(i.push(this.renderRequireText(e)),i.push(s("req-sp")));var r=e.no;return r&&(i.push(y("span",{"data-key":"q_num",key:"q_num",className:e.cssTitleNumber,style:{position:"static"},"aria-hidden":!0},r)),i.push(s("num-sp"))),e.isRequireTextBeforeTitle&&(i.push(this.renderRequireText(e)),i.push(s("req-sp"))),i.push(Se.renderLocString(e.locRenderedTitle,null,"q_title")),e.isRequireTextAfterTitle&&(i.push(s("req-sp")),i.push(this.renderRequireText(e))),i}renderRequireText(e){return y("span",{"data-key":"req-text",key:"req-text",className:e.cssRequiredMark,"aria-hidden":!0},e.requiredMark)}},Lh=class extends Ge{get cssClasses(){return this.props.cssClasses}get element(){return this.props.element}get renderActions(){return this.props.renderActions===void 0?!0:this.props.renderActions}render(){const e=y(uC,{element:this.element,cssClasses:this.cssClasses});return this.element.hasTitleActions?y("div",{className:"sv-title-actions"},y("span",{className:"sv-title-actions__title"},e),this.renderActions?y(bs,{model:this.element.getTitleToolbar()}):null):e}};ai.Instance.registerRenderer("element","title-actions","sv-title-actions"),ee.Instance.registerElement("sv-title-actions",n=>y(Lh,n));let Rr=class extends Ge{constructor(e){super(e)}get element(){return this.props.element}renderTitleExpandableSvg(){if(!this.element.getCssTitleExpandableSvg())return null;let e=this.element.isExpanded?"icon-collapse-16x16":"icon-expand-16x16";return y(Be,{className:this.element.getCssTitleExpandableSvg(),iconName:e,size:"auto"})}render(){const e=this.element;if(!e||!e.hasTitle)return null;const t=e.titleAriaLabel||void 0,s=this.renderTitleExpandableSvg(),i=y(Lh,{element:e,cssClasses:e.cssClasses,renderActions:this.props.renderActions});let r,a;e.hasTitleEvents&&(a=l=>{ju(l.nativeEvent)});const o=e.titleTagName;return y(o,{className:e.cssTitle,id:e.ariaTitleId,"aria-label":t,tabIndex:e.titleTabIndex,"aria-expanded":e.titleAriaExpanded,role:e.titleAriaRole,onClick:r,onKeyUp:a},s,i)}},hC=class extends Ge{constructor(e){super(e),this.state={changed:0},this.rootRef=ct()}get survey(){return this.props.survey}get css(){return this.survey.css}componentDidMount(){const e=this;this.survey.afterRenderHeader(this.rootRef.current),this.survey.locLogo.onChanged=function(){e.setState({changed:e.state.changed+1})}}componentWillUnmount(){this.survey.locLogo.onChanged=function(){}}renderTitle(){if(!this.survey.renderedHasTitle)return null;const e=Se.renderLocString(this.survey.locDescription);return y("div",{className:this.css.headerText,style:{maxWidth:this.survey.titleMaxWidth}},y(Rr,{element:this.survey}),this.survey.renderedHasDescription?y("div",{className:this.css.description},e):null)}renderLogoImage(e){if(!e)return null;const t=this.survey.getElementWrapperComponentName(this.survey,"logo-image"),s=this.survey.getElementWrapperComponentData(this.survey,"logo-image");return ee.Instance.createElement(t,{data:s})}render(){return this.survey.renderedHasHeader?y("div",{className:this.css.header,ref:this.rootRef},this.renderLogoImage(this.survey.isLogoBefore),this.renderTitle(),this.renderLogoImage(this.survey.isLogoAfter),y("div",{className:this.css.headerClose})):null}};ee.Instance.registerElement("survey-header",n=>y(hC,n));let Fe=class{constructor(){this.creatorHash={}}registerQuestion(e,t){this.creatorHash[e]=t}getAllTypes(){var e=new Array;for(var t in this.creatorHash)e.push(t);return e.sort()}createQuestion(e,t){var s=this.creatorHash[e];return s==null?null:s(t)}};Fe.Instance=new Fe;let yI=class extends Ge{render(){return y("div",{className:"sv-brand-info"},y("a",{className:"sv-brand-info__logo",href:"https://surveyjs.io/?utm_source=built-in_links&utm_medium=online_survey_tool&utm_campaign=landing_page"},y("img",{src:"https://surveyjs.io/Content/Images/poweredby.svg"})),y("div",{className:"sv-brand-info__text"},"Try and see how easy it is to ",y("a",{href:"https://surveyjs.io/create-survey?utm_source=built-in_links&utm_medium=online_survey_tool&utm_campaign=create_survey"},"create a survey")),y("div",{className:"sv-brand-info__terms"},y("a",{href:"https://surveyjs.io/TermsOfUse"},"Terms of Use & Privacy Statement")))}},dC=class extends Se{get notifier(){return this.props.notifier}getStateElement(){return this.notifier}renderElement(){if(!this.notifier.isDisplayed)return null;const e={visibility:this.notifier.active?"visible":"hidden"};return y("div",{className:this.notifier.css,style:e,role:"alert","aria-live":"polite"},y("span",null,this.notifier.message),y(bs,{model:this.notifier.actionBar}))}};ee.Instance.registerElement("sv-notifier",n=>y(dC,n));let di=class extends Ge{render(){const e=this.props.survey.getContainerContent(this.props.container),t=this.props.needRenderWrapper!==!1;return e.length==0?null:t?y("div",{className:"sv-components-column sv-components-container-"+this.props.container},e.map(s=>ee.Instance.createElement(s.component,{survey:this.props.survey,model:s.data,container:this.props.container,key:s.id}))):y(Me,null,e.map(s=>ee.Instance.createElement(s.component,{survey:this.props.survey,model:s.data,container:this.props.container,key:s.id})))}};ee.Instance.registerElement("sv-components-container",n=>y(di,n));let vI=class extends Ge{constructor(e){super(e),this.onIconsChanged=()=>{this.containerRef.current&&(this.containerRef.current.innerHTML=So.iconsRenderedHtml())},this.containerRef=ct()}componentDidMount(){this.onIconsChanged(),So.onIconsChanged.add(this.onIconsChanged)}componentWillUnmount(){So.onIconsChanged.remove(this.onIconsChanged)}render(){return y("svg",{style:{display:"none"},id:"sv-icon-holder-global-container",ref:this.containerRef})}},cC=class Vf extends Se{constructor(e){super(e),this.isInitialized=!1,this.init=()=>{this.isInitialized||(A.showDialog=(t,s)=>this.showDialog(t,s),this.isInitialized=!0)},this.clean=()=>{this.isInitialized&&(A.showDialog=void 0,this.isInitialized=!1)},this.state={changed:0},this.descriptor={init:this.init,clean:this.clean}}static addModalDescriptor(e){A.showDialog||e.init(),this.modalDescriptors.push(e)}static removeModalDescriptor(e){e.clean(),this.modalDescriptors.splice(this.modalDescriptors.indexOf(e),1),!A.showDialog&&this.modalDescriptors[0]&&this.modalDescriptors[0].init()}renderElement(){return this.model?rI(y(_h,{model:this.model}),this.model.container):null}showDialog(e,t){this.model=kS(e,t);const s=(i,r)=>{r.isVisible||(this.model.dispose(),this.model=void 0,this.setState({changed:this.state.changed+1}))};return this.model.onVisibilityChanged.add(s),this.model.model.isVisible=!0,this.setState({changed:this.state.changed+1}),this.model}componentDidMount(){Vf.addModalDescriptor(this.descriptor)}componentWillUnmount(){this.model&&(this.model.dispose(),this.model=void 0),Vf.removeModalDescriptor(this.descriptor)}};cC.modalDescriptors=[];var CI={modernbooleancheckchecked:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><polygon points="19,10 14,10 14,5 10,5 10,10 5,10 5,14 10,14 10,19 14,19 14,14 19,14 "></polygon></svg>',modernbooleancheckind:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><path d="M22,0H2C0.9,0,0,0.9,0,2v20c0,1.1,0.9,2,2,2h20c1.1,0,2-0.9,2-2V2C24,0.9,23.1,0,22,0z M21,18L6,3h15V18z M3,6l15,15H3V6z"></path></svg>',modernbooleancheckunchecked:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><rect x="5" y="10" width="14" height="4"></rect></svg>',moderncheck:'<svg viewBox="0 0 24 24"><path d="M5,13l2-2l3,3l7-7l2,2l-9,9L5,13z"></path></svg>',modernradio:'<svg viewBox="-12 -12 24 24"><circle r="6" cx="0" cy="0"></circle></svg>',progressbutton:'<svg viewBox="0 0 10 10"><polygon points="2,2 0,4 5,9 10,4 8,2 5,5 "></polygon></svg>',removefile:'<svg viewBox="0 0 16 16"><path d="M8,2C4.7,2,2,4.7,2,8s2.7,6,6,6s6-2.7,6-6S11.3,2,8,2z M11,10l-1,1L8,9l-2,2l-1-1l2-2L5,6l1-1l2,2l2-2l1,1L9,8 L11,10z"></path></svg>',timercircle:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 160 160"><circle cx="80" cy="80" r="70" style="stroke: var(--sd-timer-stroke-background-color); stroke-width: var(--sd-timer-stroke-background-width)" stroke-dasharray="none" stroke-dashoffset="none"></circle><circle cx="80" cy="80" r="70"></circle></svg>',"add-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 11H17V13H13V17H11V13H7V11H11V7H13V11ZM23 12C23 18.1 18.1 23 12 23C5.9 23 1 18.1 1 12C1 5.9 5.9 1 12 1C18.1 1 23 5.9 23 12ZM21 12C21 7 17 3 12 3C7 3 3 7 3 12C3 17 7 21 12 21C17 21 21 17 21 12Z"></path></svg>',"arrowleft-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M15 8.99999H4.4L8.7 13.3L7.3 14.7L0.599998 7.99999L7.3 1.29999L8.7 2.69999L4.4 6.99999H15V8.99999Z"></path></svg>',"arrowright-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M1 6.99999H11.6L7.3 2.69999L8.7 1.29999L15.4 7.99999L8.7 14.7L7.3 13.3L11.6 8.99999H1V6.99999Z"></path></svg>',"camera-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.01 4H18.4C18.2 4 18.01 3.9 17.9 3.73L16.97 2.34C16.41 1.5 15.48 1 14.47 1H9.54C8.53 1 7.6 1.5 7.04 2.34L6.11 3.73C6 3.9 5.81 4 5.61 4H4C2.35 4 1 5.35 1 7V19C1 20.65 2.35 22 4 22H20C21.65 22 23 20.65 23 19V7C23 5.35 21.65 4 20 4H20.01ZM21.01 19C21.01 19.55 20.56 20 20.01 20H4.01C3.46 20 3.01 19.55 3.01 19V7C3.01 6.45 3.46 6 4.01 6H5.62C6.49 6 7.3 5.56 7.79 4.84L8.72 3.45C8.91 3.17 9.22 3 9.55 3H14.48C14.81 3 15.13 3.17 15.31 3.45L16.24 4.84C16.72 5.56 17.54 6 18.41 6H20.02C20.57 6 21.02 6.45 21.02 7V19H21.01ZM12.01 6C8.7 6 6.01 8.69 6.01 12C6.01 15.31 8.7 18 12.01 18C15.32 18 18.01 15.31 18.01 12C18.01 8.69 15.32 6 12.01 6ZM12.01 16C9.8 16 8.01 14.21 8.01 12C8.01 9.79 9.8 8 12.01 8C14.22 8 16.01 9.79 16.01 12C16.01 14.21 14.22 16 12.01 16ZM13.01 10C13.01 10.55 12.56 11 12.01 11C11.46 11 11.01 11.45 11.01 12C11.01 12.55 10.56 13 10.01 13C9.46 13 9.01 12.55 9.01 12C9.01 10.35 10.36 9 12.01 9C12.56 9 13.01 9.45 13.01 10Z"></path></svg>',"camera-32x32":'<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M27 6H23.8C23.34 6 22.92 5.77 22.66 5.39L22.25 4.78C21.51 3.66 20.26 3 18.92 3H13.06C11.72 3 10.48 3.67 9.73 4.78L9.32 5.39C9.07 5.77 8.64 6 8.18 6H4.98C2.79 6 1 7.79 1 10V24C1 26.21 2.79 28 5 28H27C29.21 28 31 26.21 31 24V10C31 7.79 29.21 6 27 6ZM29 24C29 25.1 28.1 26 27 26H5C3.9 26 3 25.1 3 24V10C3 8.9 3.9 8 5 8H8.2C9.33 8 10.38 7.44 11 6.5L11.41 5.89C11.78 5.33 12.41 5 13.07 5H18.93C19.6 5 20.22 5.33 20.59 5.89L21 6.5C21.62 7.44 22.68 8 23.8 8H27C28.1 8 29 8.9 29 10V24ZM16 9C12.13 9 9 12.13 9 16C9 19.87 12.13 23 16 23C19.87 23 23 19.87 23 16C23 12.13 19.87 9 16 9ZM16 21C13.24 21 11 18.76 11 16C11 13.24 13.24 11 16 11C18.76 11 21 13.24 21 16C21 18.76 18.76 21 16 21ZM17 13C17 13.55 16.55 14 16 14C14.9 14 14 14.9 14 16C14 16.55 13.55 17 13 17C12.45 17 12 16.55 12 16C12 13.79 13.79 12 16 12C16.55 12 17 12.45 17 13Z"></path></svg>',"cancel-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M22.6 8.6L16.4 2.4C16 2 15.5 1.8 15 1.8C14.5 1.8 14 2 13.6 2.4L1.40005 14.6C0.600049 15.4 0.600049 16.6 1.40005 17.4L6.00005 22H12L22.6 11.4C23.3 10.6 23.3 9.3 22.6 8.6ZM11.1 20H6.80005L2.80005 16L6.20005 12.6L12.4 18.8L11.1 20ZM13.8 17.4L7.60005 11.2L15 3.8L21.2 10L13.8 17.4ZM16 20H23V22H14L16 20Z"></path></svg>',"check-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5.003 14.413L0.292999 9.70303L1.703 8.29303L5.003 11.583L14.293 2.29303L15.703 3.70303L5.003 14.413Z"></path></svg>',"check-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9 20.1L1 12L3.1 9.9L9 15.9L20.9 4L23 6.1L9 20.1Z"></path></svg>',"chevrondown-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 15L17 10H7L12 15Z"></path></svg>',"chevronright-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5.64648 12.6465L6.34648 13.3465L11.7465 8.04648L6.34648 2.64648L5.64648 3.34648L10.2465 8.04648L5.64648 12.6465Z"></path></svg>',"clear-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13.35 3.34999L12.65 2.64999L8.05002 7.24999L3.35002 2.64999L2.65002 3.34999L7.25002 8.04999L2.65002 12.65L3.35002 13.35L8.05002 8.74999L12.65 13.35L13.35 12.65L8.75002 8.04999L13.35 3.34999Z"></path></svg>',"clear-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M22.6 8.6L16.4 2.4C16 2 15.5 1.8 15 1.8C14.5 1.8 14 2 13.6 2.4L1.40005 14.6C0.600049 15.4 0.600049 16.6 1.40005 17.4L6.00005 22H12L22.6 11.4C23.3 10.6 23.3 9.3 22.6 8.6ZM11.1 20H6.80005L2.80005 16L6.20005 12.6L12.4 18.8L11.1 20ZM13.8 17.4L7.60005 11.2L15 3.8L21.2 10L13.8 17.4ZM16 20H23V22H14L16 20Z"></path></svg>',"close-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M9.43 8.0025L13.7 3.7225C14.09 3.3325 14.09 2.6925 13.7 2.2925C13.31 1.9025 12.67 1.9025 12.27 2.2925L7.99 6.5725L3.72 2.3025C3.33 1.9025 2.69 1.9025 2.3 2.3025C1.9 2.6925 1.9 3.3325 2.3 3.7225L6.58 8.0025L2.3 12.2825C1.91 12.6725 1.91 13.3125 2.3 13.7125C2.69 14.1025 3.33 14.1025 3.73 13.7125L8.01 9.4325L12.29 13.7125C12.68 14.1025 13.32 14.1025 13.72 13.7125C14.11 13.3225 14.11 12.6825 13.72 12.2825L9.44 8.0025H9.43Z"></path></svg>',"close-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.4101 12L20.7001 4.71C21.0901 4.32 21.0901 3.69 20.7001 3.3C20.3101 2.91 19.6801 2.91 19.2901 3.3L12.0001 10.59L4.71006 3.29C4.32006 2.9 3.68006 2.9 3.29006 3.29C2.90006 3.68 2.90006 4.32 3.29006 4.71L10.5801 12L3.29006 19.29C2.90006 19.68 2.90006 20.31 3.29006 20.7C3.49006 20.9 3.74006 20.99 4.00006 20.99C4.26006 20.99 4.51006 20.89 4.71006 20.7L12.0001 13.41L19.2901 20.7C19.4901 20.9 19.7401 20.99 20.0001 20.99C20.2601 20.99 20.5101 20.89 20.7101 20.7C21.1001 20.31 21.1001 19.68 20.7101 19.29L13.4201 12H13.4101Z"></path></svg>',"collapse-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2 6L3 5L8 10L13 5L14 6L8 12L2 6Z"></path></svg>',"collapsedetails-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13 7H3V9H13V7Z"></path></svg>',"delete-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M15 2H14H11V1C11 0.4 10.6 0 10 0H7C6.4 0 6 0.4 6 1V2H3H2V4H3V14C3 15.1 3.9 16 5 16H12C13.1 16 14 15.1 14 14V4H15V2ZM7 1H10V2H7V1ZM12 14H5V4H12V14ZM7 13H6V5H7V13ZM9 13H8V5H9V13ZM11 13H10V5H11V13Z"></path></svg>',"delete-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M22 4H20H16V2C16 0.9 15.1 0 14 0H10C8.9 0 8 0.9 8 2V4H4H2V6H4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V6H22V4ZM10 2H14V4H10V2ZM18 20H6V6H8H16H18V20ZM14 8H16V18H14V8ZM11 8H13V18H11V8ZM8 8H10V18H8V8Z"></path></svg>',"drag-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 6C13 4.9 13.9 4 15 4C16.1 4 17 4.9 17 6C17 7.1 16.1 8 15 8C13.9 8 13 7.1 13 6ZM9 4C7.9 4 7 4.9 7 6C7 7.1 7.9 8 9 8C10.1 8 11 7.1 11 6C11 4.9 10.1 4 9 4ZM15 10C13.9 10 13 10.9 13 12C13 13.1 13.9 14 15 14C16.1 14 17 13.1 17 12C17 10.9 16.1 10 15 10ZM9 10C7.9 10 7 10.9 7 12C7 13.1 7.9 14 9 14C10.1 14 11 13.1 11 12C11 10.9 10.1 10 9 10ZM15 16C13.9 16 13 16.9 13 18C13 19.1 13.9 20 15 20C16.1 20 17 19.1 17 18C17 16.9 16.1 16 15 16ZM9 16C7.9 16 7 16.9 7 18C7 19.1 7.9 20 9 20C10.1 20 11 19.1 11 18C11 16.9 10.1 16 9 16Z"></path></svg>',"draghorizontal-24x16":'<svg viewBox="0 0 24 16" xmlns="http://www.w3.org/2000/svg"><path d="M18 9C19.1 9 20 9.9 20 11C20 12.1 19.1 13 18 13C16.9 13 16 12.1 16 11C16 9.9 16.9 9 18 9ZM20 5C20 3.9 19.1 3 18 3C16.9 3 16 3.9 16 5C16 6.1 16.9 7 18 7C19.1 7 20 6.1 20 5ZM14 11C14 9.9 13.1 9 12 9C10.9 9 10 9.9 10 11C10 12.1 10.9 13 12 13C13.1 13 14 12.1 14 11ZM14 5C14 3.9 13.1 3 12 3C10.9 3 10 3.9 10 5C10 6.1 10.9 7 12 7C13.1 7 14 6.1 14 5ZM8 11C8 9.9 7.1 9 6 9C4.9 9 4 9.9 4 11C4 12.1 4.9 13 6 13C7.1 13 8 12.1 8 11ZM8 5C8 3.9 7.1 3 6 3C4.9 3 4 3.9 4 5C4 6.1 4.9 7 6 7C7.1 7 8 6.1 8 5Z"></path></svg>',"editsmall-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13.59 4.5884L11.42 2.4184C11.03 2.0284 10.52 1.8284 10.01 1.8284C9.5 1.8284 8.99 2.0284 8.6 2.4184L3.76 7.2384C2.63 8.3684 2 9.8884 2 11.4784V12.9884C2 13.5384 2.45 13.9884 3 13.9884H4.51C6.1 13.9884 7.63 13.3584 8.75 12.2284L13.58 7.3984C14.36 6.6184 14.36 5.3484 13.58 4.5684L13.59 4.5884ZM7.35 10.8284C6.59 11.5884 5.59 11.9984 4.52 11.9984H4.01V11.4884C4.01 10.4184 4.43 9.4184 5.18 8.6584L7.72 6.1184L9.89 8.2884L7.35 10.8284ZM11.3 6.8784L9.13 4.7084L10.01 3.8284L12.18 5.9984L11.3 6.8784Z"></path></svg>',"expand-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6 14L5 13L10 8L5 3L6 2L12 8L6 14Z"></path></svg>',"expanddetails-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13 7H9V3H7V7H3V9H7V13H9V9H13V7Z"></path></svg>',"file-72x72":'<svg viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M62.83 12.83L53.17 3.17C52.7982 2.79866 52.357 2.50421 51.8714 2.30346C51.3858 2.1027 50.8654 1.99959 50.34 2H14C12.4087 2 10.8826 2.63214 9.75735 3.75736C8.63214 4.88258 8 6.4087 8 8V64C8 65.5913 8.63214 67.1174 9.75735 68.2426C10.8826 69.3679 12.4087 70 14 70H58C59.5913 70 61.1174 69.3679 62.2426 68.2426C63.3679 67.1174 64 65.5913 64 64V15.66C64.0004 15.1346 63.8973 14.6142 63.6965 14.1286C63.4958 13.643 63.2013 13.2018 62.83 12.83ZM52 4.83L61.17 14H56C54.9391 14 53.9217 13.5786 53.1716 12.8284C52.4214 12.0783 52 11.0609 52 10V4.83ZM62 64C62 65.0609 61.5786 66.0783 60.8284 66.8284C60.0783 67.5786 59.0609 68 58 68H14C12.9391 68 11.9217 67.5786 11.1716 66.8284C10.4214 66.0783 10 65.0609 10 64V8C10 6.93914 10.4214 5.92172 11.1716 5.17157C11.9217 4.42143 12.9391 4 14 4H50V10C50 11.5913 50.6321 13.1174 51.7574 14.2426C52.8826 15.3679 54.4087 16 56 16H62V64ZM22 26H50V28H22V26ZM22 32H50V34H22V32ZM22 38H50V40H22V38ZM22 44H50V46H22V44Z"></path></svg>',"flip-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M23 12.0037C23 14.2445 21.7794 16.3052 19.5684 17.8257C19.3984 17.9458 19.1983 18.0058 19.0082 18.0058C18.688 18.0058 18.3779 17.8557 18.1778 17.5756C17.8677 17.1155 17.9777 16.4953 18.4379 16.1852C20.0887 15.0448 21.0091 13.5643 21.0091 12.0138C21.0091 8.70262 16.9673 6.01171 12.005 6.01171C11.4948 6.01171 10.9945 6.04172 10.5043 6.09173L11.7149 7.30215C12.105 7.69228 12.105 8.32249 11.7149 8.71263C11.5148 8.9127 11.2647 9.00273 11.0045 9.00273C10.7444 9.00273 10.4943 8.90269 10.2942 8.71263L6.58254 5.00136L10.2842 1.2901C10.6744 0.899964 11.3047 0.899964 11.6949 1.2901C12.085 1.68023 12.085 2.31045 11.6949 2.70058L10.3042 4.09105C10.8545 4.03103 11.4147 4.00102 11.985 4.00102C18.0578 4.00102 22.99 7.59225 22.99 12.0037H23ZM12.2851 15.2949C11.895 15.685 11.895 16.3152 12.2851 16.7054L13.4957 17.9158C13.0055 17.9758 12.4952 17.9958 11.995 17.9958C7.03274 17.9958 2.99091 15.3049 2.99091 11.9937C2.99091 10.4332 3.90132 8.95271 5.56207 7.82232C6.02228 7.51222 6.13233 6.89201 5.82219 6.43185C5.51205 5.97169 4.89177 5.86166 4.43156 6.17176C2.22055 7.69228 1 9.76299 1 11.9937C1 16.4052 5.93224 19.9965 12.005 19.9965C12.5753 19.9965 13.1355 19.9665 13.6858 19.9064L12.2951 21.2969C11.905 21.6871 11.905 22.3173 12.2951 22.7074C12.4952 22.9075 12.7453 22.9975 13.0055 22.9975C13.2656 22.9975 13.5157 22.8975 13.7158 22.7074L17.4275 18.9961L13.7158 15.2849C13.3256 14.8947 12.6953 14.8947 12.3051 15.2849L12.2851 15.2949Z"></path></svg>',"folder-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.93 9H21V7C21 6.46957 20.7893 5.96086 20.4142 5.58579C20.0391 5.21071 19.5304 5 19 5H10L8 3H4C3.46957 3 2.96086 3.21071 2.58579 3.58579C2.21071 3.96086 2 4.46957 2 5L2 21H21L23.89 11.63C23.9916 11.3244 24.0179 10.9988 23.9667 10.6809C23.9155 10.363 23.7882 10.0621 23.5958 9.80392C23.4034 9.54571 23.1514 9.33779 22.8614 9.19782C22.5714 9.05786 22.2519 8.99 21.93 9ZM4 5H7.17L8.59 6.41L9.17 7H19V9H6L4 15V5ZM22 11L19.54 19H4.77L7.44 11H22Z"></path></svg>',"fullsize-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M12 13H4C2.9 13 2 12.1 2 11V5C2 3.9 2.9 3 4 3H12C13.1 3 14 3.9 14 5V11C14 12.1 13.1 13 12 13ZM4 5V11H12V5H4Z"></path></svg>',"image-48x48":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M36 8H12C9.79 8 8 9.79 8 12V36C8 38.21 9.79 40 12 40H36C38.21 40 40 38.21 40 36V12C40 9.79 38.21 8 36 8ZM38 36C38 37.1 37.1 38 36 38H12C10.9 38 10 37.1 10 36V12C10 10.9 10.9 10 12 10H36C37.1 10 38 10.9 38 12V36ZM14 17C14 15.34 15.34 14 17 14C18.66 14 20 15.34 20 17C20 18.66 18.66 20 17 20C15.34 20 14 18.66 14 17ZM27 24L36 36H12L19 27L23 29L27 24Z"></path></svg>',"loading-48x48":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_19679_369428)"><path opacity="0.1" d="M24 40C15.18 40 8 32.82 8 24C8 15.18 15.18 8 24 8C32.82 8 40 15.18 40 24C40 32.82 32.82 40 24 40ZM24 12C17.38 12 12 17.38 12 24C12 30.62 17.38 36 24 36C30.62 36 36 30.62 36 24C36 17.38 30.62 12 24 12Z" fill="black" fill-opacity="0.91"></path><path d="M10 26C8.9 26 8 25.1 8 24C8 15.18 15.18 8 24 8C25.1 8 26 8.9 26 10C26 11.1 25.1 12 24 12C17.38 12 12 17.38 12 24C12 25.1 11.1 26 10 26Z"></path></g><defs><clipPath id="clip0_19679_369428"><rect width="32" height="32" fill="white" transform="translate(8 8)"></rect></clipPath></defs></svg>',"maximize-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6.71 10.71L4.42 13H6.01C6.56 13 7.01 13.45 7.01 14C7.01 14.55 6.56 15 6.01 15H2C1.45 15 1 14.55 1 14V10C1 9.45 1.45 9 2 9C2.55 9 3 9.45 3 10V11.59L5.29 9.3C5.68 8.91 6.31 8.91 6.7 9.3C7.09 9.69 7.09 10.32 6.7 10.71H6.71ZM14 1H10C9.45 1 9 1.45 9 2C9 2.55 9.45 3 10 3H11.59L9.3 5.29C8.91 5.68 8.91 6.31 9.3 6.7C9.5 6.9 9.75 6.99 10.01 6.99C10.27 6.99 10.52 6.89 10.72 6.7L13.01 4.41V6C13.01 6.55 13.46 7 14.01 7C14.56 7 15.01 6.55 15.01 6V2C15.01 1.45 14.56 1 14.01 1H14Z"></path></svg>',"minimize-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13 9H3C2.45 9 2 8.55 2 8C2 7.45 2.45 7 3 7H13C13.55 7 14 7.45 14 8C14 8.55 13.55 9 13 9Z"></path></svg>',"more-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6 12C6 13.1 5.1 14 4 14C2.9 14 2 13.1 2 12C2 10.9 2.9 10 4 10C5.1 10 6 10.9 6 12ZM12 10C10.9 10 10 10.9 10 12C10 13.1 10.9 14 12 14C13.1 14 14 13.1 14 12C14 10.9 13.1 10 12 10ZM20 10C18.9 10 18 10.9 18 12C18 13.1 18.9 14 20 14C21.1 14 22 13.1 22 12C22 10.9 21.1 10 20 10Z"></path></svg>',"navmenu-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M16 7H2V5H16V7ZM2 11V13H22V11H2ZM2 19H10V17H2V19Z"></path></svg>',"noimage-48x48":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M14 17.01C14 16.4167 14.1759 15.8366 14.5056 15.3433C14.8352 14.8499 15.3038 14.4654 15.8519 14.2384C16.4001 14.0113 17.0033 13.9519 17.5853 14.0676C18.1672 14.1834 18.7018 14.4691 19.1213 14.8887C19.5409 15.3082 19.8266 15.8428 19.9424 16.4247C20.0581 17.0067 19.9987 17.6099 19.7716 18.1581C19.5446 18.7062 19.1601 19.1748 18.6667 19.5044C18.1734 19.8341 17.5933 20.01 17 20.01C16.2044 20.01 15.4413 19.6939 14.8787 19.1313C14.3161 18.5687 14 17.8056 14 17.01ZM27.09 24.14L20 36.01H36L27.09 24.14ZM36.72 8.14L35.57 10.01H36C36.5304 10.01 37.0391 10.2207 37.4142 10.5958C37.7893 10.9709 38 11.4796 38 12.01V36.01C38 36.5404 37.7893 37.0491 37.4142 37.4242C37.0391 37.7993 36.5304 38.01 36 38.01H18.77L17.57 40.01H36C37.0609 40.01 38.0783 39.5886 38.8284 38.8384C39.5786 38.0883 40 37.0709 40 36.01V12.01C39.9966 11.0765 39.6668 10.1737 39.0678 9.45778C38.4688 8.74188 37.6382 8.25802 36.72 8.09V8.14ZM36.86 4.5L12.86 44.5L11.14 43.5L13.23 40.01H12C10.9391 40.01 9.92172 39.5886 9.17157 38.8384C8.42143 38.0883 8 37.0709 8 36.01V12.01C8 10.9491 8.42143 9.93172 9.17157 9.18157C9.92172 8.43143 10.9391 8.01 12 8.01H32.43L35.14 3.5L36.86 4.5ZM14.43 38.01L15.63 36.01H12L19 27.01L20.56 27.8L31.23 10.01H12C11.4696 10.01 10.9609 10.2207 10.5858 10.5958C10.2107 10.9709 10 11.4796 10 12.01V36.01C10 36.5404 10.2107 37.0491 10.5858 37.4242C10.9609 37.7993 11.4696 38.01 12 38.01H14.43Z"></path></svg>',"ranking-arrows":'<svg viewBox="0 0 10 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 5L5 0L0 5H4V9H6V5H10Z"></path><path d="M6 19V15H4V19H0L5 24L10 19H6Z"></path></svg>',"rankingundefined-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13 7H3V9H13V7Z"></path></svg>',"rating-star-2":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M24 39.5057L11.7226 45.9839C10.4095 46.6739 8.87606 45.5622 9.12525 44.096L11.4734 30.373L1.54411 20.6556C0.480254 19.6207 1.06489 17.8095 2.53128 17.5986L16.2559 15.5957L22.3994 3.10891C23.0512 1.77685 24.9488 1.77685 25.6102 3.10891L31.7441 15.5957L45.4687 17.5986C46.9351 17.8095 47.5197 19.6207 46.4559 20.6556L36.5266 30.373L38.8748 44.096C39.1239 45.5622 37.5905 46.6835 36.2774 45.9839L24 39.5057Z" fill="none" stroke-width="2"></path><path d="M24.3981 33.1305L24 32.9206L23.6019 33.1305L15.8715 37.2059L17.3542 28.5663L17.43 28.1246L17.1095 27.8113L10.83 21.6746L19.4965 20.4049L19.9405 20.3399L20.1387 19.9373L24 12.0936L27.8613 19.9373L28.0595 20.3399L28.5035 20.4049L37.17 21.6746L30.8905 27.8113L30.57 28.1246L30.6458 28.5663L32.1285 37.2059L24.3981 33.1305Z" stroke-width="1.70746"></path></svg>',"rating-star-small-2":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 19.3373L6.13001 22.4373C5.50001 22.7673 4.77001 22.2373 4.89001 21.5373L6.01001 14.9773L1.26001 10.3273C0.750007 9.83728 1.03001 8.96728 1.73001 8.86728L8.29001 7.90728L11.23 1.93728C11.54 1.29728 12.45 1.29728 12.77 1.93728L15.7 7.90728L22.26 8.86728C22.96 8.96728 23.24 9.83728 22.73 10.3273L17.98 14.9773L19.1 21.5373C19.22 22.2373 18.49 22.7773 17.86 22.4373L11.99 19.3373H12Z" fill="none" stroke-width="2"></path><path d="M12 15.9472L8.58001 17.7572L9.23001 13.9272L6.45001 11.2072L10.29 10.6472L12 7.17725L13.71 10.6472L17.55 11.2072L14.77 13.9272L15.42 17.7572L12 15.9472Z"></path></svg>',"rating-star-small":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g><path d="M12 19.3373L6.13001 22.4373C5.50001 22.7673 4.77001 22.2373 4.89001 21.5373L6.01001 14.9773L1.26001 10.3273C0.750007 9.83728 1.03001 8.96728 1.73001 8.86728L8.29001 7.90728L11.23 1.93728C11.54 1.29728 12.45 1.29728 12.77 1.93728L15.7 7.90728L22.26 8.86728C22.96 8.96728 23.24 9.83728 22.73 10.3273L17.98 14.9773L19.1 21.5373C19.22 22.2373 18.49 22.7773 17.86 22.4373L11.99 19.3373H12Z"></path></g></svg>',"rating-star":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g><path d="M24 39.5057L11.7226 45.9839C10.4095 46.6739 8.87606 45.5622 9.12525 44.096L11.4734 30.373L1.54411 20.6556C0.480254 19.6207 1.06489 17.8095 2.53128 17.5986L16.2559 15.5957L22.3994 3.10891C23.0512 1.77685 24.9488 1.77685 25.6102 3.10891L31.7441 15.5957L45.4687 17.5986C46.9351 17.8095 47.5197 19.6207 46.4559 20.6556L36.5266 30.373L38.8748 44.096C39.1239 45.5622 37.5905 46.6835 36.2774 45.9839L24 39.5057Z"></path></g></svg>',"reorder-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 5L12 0L7 5H11V9H13V5H17Z"></path><path d="M13 19V15H11V19H7L12 24L17 19H13Z"></path></svg>',"restoredown-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M15 6C15 6.55 14.55 7 14 7H10C9.45 7 9 6.55 9 6V2C9 1.45 9.45 1 10 1C10.55 1 11 1.45 11 2V3.59L13.29 1.29C13.49 1.09 13.74 1 14 1C14.26 1 14.51 1.1 14.71 1.29C15.1 1.68 15.1 2.31 14.71 2.7L12.42 4.99H14.01C14.56 4.99 15.01 5.44 15.01 5.99L15 6ZM6 9H2C1.45 9 0.999998 9.45 0.999998 10C0.999998 10.55 1.45 11 2 11H3.59L1.29 13.29C0.899998 13.68 0.899998 14.31 1.29 14.7C1.68 15.09 2.31 15.09 2.7 14.7L4.99 12.41V14C4.99 14.55 5.44 15 5.99 15C6.54 15 6.99 14.55 6.99 14V10C6.99 9.45 6.54 9 5.99 9H6Z"></path></svg>',"search-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14 2C9.6 2 6 5.6 6 10C6 11.8 6.6 13.5 7.7 14.9L2.3 20.3C1.9 20.7 1.9 21.3 2.3 21.7C2.5 21.9 2.7 22 3 22C3.3 22 3.5 21.9 3.7 21.7L9.1 16.3C10.5 17.4 12.2 18 14 18C18.4 18 22 14.4 22 10C22 5.6 18.4 2 14 2ZM14 16C10.7 16 8 13.3 8 10C8 6.7 10.7 4 14 4C17.3 4 20 6.7 20 10C20 13.3 17.3 16 14 16Z"></path></svg>',"smiley-rate1-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 4.9938C4 4.44362 4.45 3.99348 5 3.99348H6.59L5.3 2.70306C4.91 2.31293 4.91 1.68272 5.3 1.2926C5.69 0.902468 6.32 0.902468 6.71 1.2926L9.71 4.29357C9.8 4.3836 9.88 4.49364 9.93 4.62368C10.03 4.86376 10.03 5.14385 9.93 5.38393C9.88 5.50397 9.81 5.614 9.71 5.71404L6.71 8.71501C6.51 8.91508 6.26 9.00511 6 9.00511C5.74 9.00511 5.49 8.90508 5.29 8.71501C4.9 8.32489 4.9 7.69468 5.29 7.30456L6.58 6.01413H4.99C4.44 6.01413 3.99 5.56399 3.99 5.01381L4 4.9938ZM14.08 5.37393C14.13 5.49397 14.2 5.604 14.3 5.70403L17.3 8.70501C17.5 8.90508 17.75 8.99511 18.01 8.99511C18.27 8.99511 18.52 8.89507 18.72 8.70501C19.11 8.31488 19.11 7.68468 18.72 7.29455L17.43 6.00413H19.02C19.57 6.00413 20.02 5.55399 20.02 5.00381C20.02 4.45363 19.57 4.00348 19.02 4.00348H17.43L18.72 2.71306C19.11 2.32293 19.11 1.69273 18.72 1.3026C18.33 0.912471 17.7 0.912471 17.31 1.3026L14.31 4.30358C14.22 4.39361 14.14 4.50364 14.09 4.63368C13.99 4.87376 13.99 5.15385 14.09 5.39393L14.08 5.37393ZM22 14.9971V20.999C22 22.6496 20.65 24 19 24H5C3.35 24 2 22.6496 2 20.999V14.9971C2 13.3465 3.35 11.9961 5 11.9961H19C20.65 11.9961 22 13.3465 22 14.9971ZM19 13.9967H16V16.9977H20V14.9971C20 14.4469 19.55 13.9967 19 13.9967ZM14 16.9977V13.9967H10V16.9977H14ZM10 18.9984V21.9993H14V18.9984H10ZM4 14.9971V16.9977H8V13.9967H5C4.45 13.9967 4 14.4469 4 14.9971ZM5 21.9993H8V18.9984H4V20.999C4 21.5492 4.45 21.9993 5 21.9993ZM20 20.999V18.9984H16V21.9993H19C19.55 21.9993 20 21.5492 20 20.999Z"></path></svg>',"smiley-rate10-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.01 23C6.85721 23 1.15412 19.9621 0.0134987 13.1669C-0.0765501 12.6272 0.293651 12.1076 0.833944 12.0177C1.38424 11.9277 1.89452 12.2975 1.98457 12.8371C2.92508 18.4732 7.69767 20.9914 12 20.9914C16.3023 20.9914 21.0749 18.4732 22.0154 12.8371C22.1055 12.2975 22.6158 11.9277 23.1661 12.0177C23.7063 12.1076 24.0765 12.6272 23.9865 13.1669C22.8559 19.9521 17.1428 23 11.99 23H12.01ZM21.165 6.15177C22.3056 5.01257 22.3056 3.16386 21.165 2.02465L21.0049 1.85477C19.9143 0.765533 18.1633 0.725561 17.0227 1.71487C15.8821 0.715568 14.1312 0.765533 13.0406 1.85477L12.8705 2.01466C11.7299 3.15386 11.7299 5.00257 12.8705 6.14178L17.0227 10.2889L21.175 6.14178L21.165 6.15177ZM15.742 3.27378L17.0127 4.54289L18.2834 3.27378C18.6436 2.91403 19.2239 2.91403 19.5841 3.27378L19.7442 3.43367C20.1044 3.79342 20.1044 4.37301 19.7442 4.73276L17.0127 7.46086L14.2812 4.73276C13.921 4.37301 13.921 3.79342 14.2812 3.43367L14.4413 3.27378C14.6214 3.09391 14.8515 3.00397 15.0917 3.00397C15.3318 3.00397 15.5619 3.09391 15.742 3.27378ZM11.1595 6.15177C12.3002 5.01257 12.3002 3.16386 11.1595 2.02465L10.9995 1.85477C9.90886 0.765533 8.15792 0.725561 7.0173 1.71487C5.87668 0.715568 4.12573 0.765533 3.03514 1.85477L2.86505 2.01466C1.72443 3.15386 1.72443 5.00257 2.86505 6.14178L7.0173 10.2889L11.1695 6.14178L11.1595 6.15177ZM5.7366 3.27378L7.00729 4.54289L8.27798 3.27378C8.63818 2.91403 9.21849 2.91403 9.57869 3.27378L9.73877 3.43367C10.099 3.79342 10.099 4.37301 9.73877 4.73276L7.00729 7.46086L4.27581 4.73276C3.91562 4.37301 3.91562 3.79342 4.27581 3.43367L4.4359 3.27378C4.61599 3.09391 4.84612 3.00397 5.08625 3.00397C5.32638 3.00397 5.5565 3.09391 5.7366 3.27378Z"></path></svg>',"smiley-rate2-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_15894_140103)"><path d="M4.88291 4.51001C4.47291 4.51001 4.08291 4.25001 3.94291 3.84001C3.76291 3.32001 4.03291 2.75001 4.55291 2.57001L8.32291 1.25001C8.84291 1.06001 9.41291 1.34001 9.59291 1.86001C9.77291 2.38001 9.50291 2.95001 8.98291 3.13001L5.20291 4.45001C5.09291 4.49001 4.98291 4.51001 4.87291 4.51001H4.88291ZM19.8129 3.89001C20.0229 3.38001 19.7729 2.79001 19.2629 2.59001L15.5529 1.07001C15.0429 0.860007 14.4529 1.11001 14.2529 1.62001C14.0429 2.13001 14.2929 2.72001 14.8029 2.92001L18.5029 4.43001C18.6229 4.48001 18.7529 4.50001 18.8829 4.50001C19.2729 4.50001 19.6529 4.27001 19.8129 3.88001V3.89001ZM3.50291 6.00001C2.64291 6.37001 1.79291 6.88001 1.00291 7.48001C0.79291 7.64001 0.64291 7.87001 0.59291 8.14001C0.48291 8.73001 0.87291 9.29001 1.45291 9.40001C2.04291 9.51001 2.60291 9.12001 2.71291 8.54001C2.87291 7.69001 3.12291 6.83001 3.50291 5.99001V6.00001ZM21.0429 8.55001C21.6029 10.48 24.2429 8.84001 22.7529 7.48001C21.9629 6.88001 21.1129 6.37001 20.2529 6.00001C20.6329 6.84001 20.8829 7.70001 21.0429 8.55001ZM21.5729 13.2C21.2529 14.2 22.5429 15.09 23.3629 14.39C23.8529 14 23.9229 13.29 23.5429 12.81C21.7429 10.67 22.1329 10.55 21.5829 13.2H21.5729ZM1.75291 11C1.22291 11.79 -0.14709 12.64 0.0129102 13.75C0.15291 14.36 0.75291 14.74 1.35291 14.6C2.98291 14.1 1.80291 12.22 1.75291 11ZM19.8829 17C19.8829 13.14 16.2929 10 11.8829 10C7.47291 10 3.88291 13.14 3.88291 17C3.88291 20.86 7.47291 24 11.8829 24C16.2929 24 19.8829 20.86 19.8829 17ZM17.8829 17C17.8829 19.76 15.1929 22 11.8829 22C8.57291 22 5.88291 19.76 5.88291 17C5.88291 14.24 8.57291 12 11.8829 12C15.1929 12 17.8829 14.24 17.8829 17Z"></path></g><defs><clipPath id="clip0_15894_140103"><rect width="24" height="24" fill="white"></rect></clipPath></defs></svg>',"smiley-rate3-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.01915 7C6.46961 7 6.01998 6.55 6.01998 6V2C6.01998 1.45 6.46961 1 7.01915 1C7.56869 1 8.01832 1.45 8.01832 2V6C8.01832 6.55 7.56869 7 7.01915 7ZM18.01 6V2C18.01 1.45 17.5604 1 17.0108 1C16.4613 1 16.0117 1.45 16.0117 2V6C16.0117 6.55 16.4613 7 17.0108 7C17.5604 7 18.01 6.55 18.01 6ZM16.4213 21.58L18.01 19.99L19.2989 21.28C19.6886 21.67 20.3181 21.67 20.7077 21.28C21.0974 20.89 21.0974 20.26 20.7077 19.87L19.4188 18.58C18.6395 17.8 17.3705 17.8 16.5912 18.58L15.0025 20.17L13.4138 18.58C12.6345 17.8 11.3655 17.8 10.5862 18.58L8.9975 20.17L7.40883 18.58C6.62948 17.8 5.36053 17.8 4.58118 18.58L3.29226 19.87C2.90258 20.26 2.90258 20.89 3.29226 21.28C3.68193 21.67 4.31141 21.67 4.70108 21.28L5.99001 19.99L7.57868 21.58C8.35803 22.36 9.62698 22.36 10.4063 21.58L11.995 19.99L13.5837 21.58C13.9734 21.97 14.4829 22.16 14.9925 22.16C15.5021 22.16 16.0117 21.97 16.4013 21.58H16.4213Z"></path></svg>',"smiley-rate4-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.06927 7C6.51927 7 6.06927 6.55 6.06927 6V2C6.06927 1.45 6.51927 1 7.06927 1C7.61927 1 8.06927 1.45 8.06927 2V6C8.06927 6.55 7.61927 7 7.06927 7ZM18.0693 6V2C18.0693 1.45 17.6193 1 17.0693 1C16.5193 1 16.0693 1.45 16.0693 2V6C16.0693 6.55 16.5193 7 17.0693 7C17.6193 7 18.0693 6.55 18.0693 6ZM22.5693 21.9C23.0693 21.66 23.2793 21.07 23.0393 20.57C21.1093 16.52 16.9093 14 12.0693 14C7.22927 14 3.02927 16.52 1.09927 20.57C0.859273 21.07 1.06927 21.67 1.56927 21.9C2.06927 22.14 2.65927 21.93 2.89927 21.43C4.49927 18.08 8.00927 16 12.0593 16C16.1093 16 19.6293 18.08 21.2193 21.43C21.3893 21.79 21.7493 22 22.1193 22C22.2593 22 22.4093 21.97 22.5493 21.9H22.5693Z"></path></svg>',"smiley-rate5-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.00572 7C6.45572 7 6.00572 6.55 6.00572 6V2C6.00572 1.45 6.45572 1 7.00572 1C7.55572 1 8.00572 1.45 8.00572 2V6C8.00572 6.55 7.55572 7 7.00572 7ZM18.0057 6V2C18.0057 1.45 17.5557 1 17.0057 1C16.4557 1 16.0057 1.45 16.0057 2V6C16.0057 6.55 16.4557 7 17.0057 7C17.5557 7 18.0057 6.55 18.0057 6ZM19.9457 21.33C20.1257 20.81 19.8557 20.24 19.3357 20.05C14.5457 18.35 9.45572 18.35 4.66572 20.05C4.14572 20.23 3.87572 20.81 4.05572 21.33C4.23572 21.85 4.80572 22.12 5.33572 21.94C9.69572 20.4 14.3057 20.4 18.6657 21.94C18.7757 21.98 18.8857 22 18.9957 22C19.4057 22 19.7957 21.74 19.9357 21.33H19.9457Z"></path></svg>',"smiley-rate6-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7 7C6.45 7 6 6.55 6 6V2C6 1.45 6.45 1 7 1C7.55 1 8 1.45 8 2V6C8 6.55 7.55 7 7 7ZM18 6V2C18 1.45 17.55 1 17 1C16.45 1 16 1.45 16 2V6C16 6.55 16.45 7 17 7C17.55 7 18 6.55 18 6ZM21 21C21 20.45 20.55 20 20 20H4C3.45 20 3 20.45 3 21C3 21.55 3.45 22 4 22H20C20.55 22 21 21.55 21 21Z"></path></svg>',"smiley-rate7-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.0022 23.99C11.452 23.99 11.0018 23.5402 11.0018 22.9904C11.0018 22.4407 11.452 21.9909 12.0022 21.9909C16.3137 21.9909 21.0755 19.472 22.0158 13.8344C22.1058 13.2947 22.616 12.9248 23.1662 13.0148C23.7064 13.1047 24.0765 13.6245 23.9865 14.1643C22.8561 20.9513 17.144 24 11.9922 24L12.0022 23.99ZM8.00072 5.99783V1.99957C8.00072 1.4498 7.55056 1 7.00036 1C6.45016 1 6 1.4498 6 1.99957V5.99783C6 6.54759 6.45016 6.99739 7.00036 6.99739C7.55056 6.99739 8.00072 6.54759 8.00072 5.99783ZM18.0043 5.99783V1.99957C18.0043 1.4498 17.5542 1 17.004 1C16.4538 1 16.0036 1.4498 16.0036 1.99957V5.99783C16.0036 6.54759 16.4538 6.99739 17.004 6.99739C17.5542 6.99739 18.0043 6.54759 18.0043 5.99783Z"></path></svg>',"smiley-rate8-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.01 24C6.85721 24 1.15412 20.96 0.0134987 14.16C-0.0765501 13.62 0.293651 13.1 0.833944 13.01C1.38424 12.92 1.89452 13.29 1.98457 13.83C2.92508 19.47 7.69767 21.99 12 21.99C16.3023 21.99 21.0749 19.47 22.0154 13.83C22.1055 13.29 22.6158 12.92 23.1661 13.01C23.7063 13.1 24.0765 13.62 23.9865 14.16C22.8559 20.95 17.1428 24 11.99 24H12.01ZM8.00783 6V2C8.00783 1.45 7.55759 1 7.00729 1C6.45699 1 6.00675 1.45 6.00675 2V6C6.00675 6.55 6.45699 7 7.00729 7C7.55759 7 8.00783 6.55 8.00783 6ZM18.0133 6V2C18.0133 1.45 17.563 1 17.0127 1C16.4624 1 16.0122 1.45 16.0122 2V6C16.0122 6.55 16.4624 7 17.0127 7C17.563 7 18.0133 6.55 18.0133 6Z"></path></svg>',"smiley-rate9-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.01 24C6.85767 24 1.15509 20.96 0.0145752 14.16C-0.0354475 13.87 0.0445888 13.57 0.234675 13.35C0.424761 13.13 0.704888 13 0.995019 13H23.005C23.2951 13 23.5752 13.13 23.7653 13.35C23.9554 13.57 24.0354 13.87 23.9854 14.16C22.8549 20.95 17.1423 24 11.99 24H12.01ZM2.25559 15C3.61621 19.82 8.0182 22 12.01 22C16.0018 22 20.4038 19.82 21.7644 15H2.25559ZM8.00819 6V2C8.00819 1.45 7.55799 1 7.00774 1C6.45749 1 6.00729 1.45 6.00729 2V6C6.00729 6.55 6.45749 7 7.00774 7C7.55799 7 8.00819 6.55 8.00819 6ZM18.0127 6V2C18.0127 1.45 17.5625 1 17.0123 1C16.462 1 16.0118 1.45 16.0118 2V6C16.0118 6.55 16.462 7 17.0123 7C17.5625 7 18.0127 6.55 18.0127 6Z"></path></svg>'};var pC={modernbooleancheckchecked:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><polygon points="19,10 14,10 14,5 10,5 10,10 5,10 5,14 10,14 10,19 14,19 14,14 19,14 "></polygon></svg>',modernbooleancheckind:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><path d="M22,0H2C0.9,0,0,0.9,0,2v20c0,1.1,0.9,2,2,2h20c1.1,0,2-0.9,2-2V2C24,0.9,23.1,0,22,0z M21,18L6,3h15V18z M3,6l15,15H3V6z"></path></svg>',modernbooleancheckunchecked:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><rect x="5" y="10" width="14" height="4"></rect></svg>',moderncheck:'<svg viewBox="0 0 24 24"><path d="M5,13l2-2l3,3l7-7l2,2l-9,9L5,13z"></path></svg>',modernradio:'<svg viewBox="-12 -12 24 24"><circle r="6" cx="0" cy="0"></circle></svg>',progressbutton:'<svg viewBox="0 0 10 10"><polygon points="2,2 0,4 5,9 10,4 8,2 5,5 "></polygon></svg>',removefile:'<svg viewBox="0 0 16 16"><path d="M8,2C4.7,2,2,4.7,2,8s2.7,6,6,6s6-2.7,6-6S11.3,2,8,2z M11,10l-1,1L8,9l-2,2l-1-1l2-2L5,6l1-1l2,2l2-2l1,1L9,8 L11,10z"></path></svg>',timercircle:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 160 160"><circle cx="80" cy="80" r="70" style="stroke: var(--sd-timer-stroke-background-color); stroke-width: var(--sd-timer-stroke-background-width)" stroke-dasharray="none" stroke-dashoffset="none"></circle><circle cx="80" cy="80" r="70"></circle></svg>',"add-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.75 12C15.75 12.41 15.41 12.75 15 12.75H12.75V15C12.75 15.41 12.41 15.75 12 15.75C11.59 15.75 11.25 15.41 11.25 15V12.75H9C8.59 12.75 8.25 12.41 8.25 12C8.25 11.59 8.59 11.25 9 11.25H11.25V9C11.25 8.59 11.59 8.25 12 8.25C12.41 8.25 12.75 8.59 12.75 9V11.25H15C15.41 11.25 15.75 11.59 15.75 12ZM21.75 12C21.75 17.38 17.38 21.75 12 21.75C6.62 21.75 2.25 17.38 2.25 12C2.25 6.62 6.62 2.25 12 2.25C17.38 2.25 21.75 6.62 21.75 12ZM20.25 12C20.25 7.45 16.55 3.75 12 3.75C7.45 3.75 3.75 7.45 3.75 12C3.75 16.55 7.45 20.25 12 20.25C16.55 20.25 20.25 16.55 20.25 12Z"></path></svg>',"arrowleft-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.7475 7.9975C14.7475 8.4075 14.4075 8.7475 13.9975 8.7475H3.8075L7.5275 12.4675C7.8175 12.7575 7.8175 13.2375 7.5275 13.5275C7.3775 13.6775 7.1875 13.7475 6.9975 13.7475C6.8075 13.7475 6.6175 13.6775 6.4675 13.5275L1.4675 8.5275C1.1775 8.2375 1.1775 7.7575 1.4675 7.4675L6.4675 2.4675C6.7575 2.1775 7.2375 2.1775 7.5275 2.4675C7.8175 2.7575 7.8175 3.2375 7.5275 3.5275L3.8075 7.2475H13.9975C14.4075 7.2475 14.7475 7.5875 14.7475 7.9975Z"></path></svg>',"arrowright-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.53 8.5275L9.53 13.5275C9.38 13.6775 9.19 13.7475 9 13.7475C8.81 13.7475 8.62 13.6775 8.47 13.5275C8.18 13.2375 8.18 12.7575 8.47 12.4675L12.19 8.7475H2C1.59 8.7475 1.25 8.4075 1.25 7.9975C1.25 7.5875 1.59 7.2475 2 7.2475H12.19L8.47 3.5275C8.18 3.2375 8.18 2.7575 8.47 2.4675C8.76 2.1775 9.24 2.1775 9.53 2.4675L14.53 7.4675C14.82 7.7575 14.82 8.2375 14.53 8.5275Z"></path></svg>',"camera-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.19 4.25H17.12C16.72 4.25 16.35 4.03 16.17 3.67C15.73 2.8 14.86 2.25 13.88 2.25H10.12C9.14 2.25 8.27 2.79 7.83 3.67C7.65 4.03 7.29 4.25 6.88 4.25H4.81C3.4 4.25 2.25 5.4 2.25 6.81V18.19C2.25 19.6 3.4 20.75 4.81 20.75H19.19C20.6 20.75 21.75 19.6 21.75 18.19V6.81C21.75 5.4 20.6 4.25 19.19 4.25ZM20.25 18.19C20.25 18.77 19.78 19.25 19.19 19.25H4.81C4.23 19.25 3.75 18.78 3.75 18.19V6.81C3.75 6.23 4.22 5.75 4.81 5.75H6.88C7.86 5.75 8.73 5.21 9.17 4.33C9.35 3.97 9.71 3.75 10.12 3.75H13.88C14.28 3.75 14.65 3.97 14.83 4.33C15.27 5.2 16.14 5.75 17.12 5.75H19.19C19.77 5.75 20.25 6.22 20.25 6.81V18.19ZM12 6.25C8.83 6.25 6.25 8.83 6.25 12C6.25 15.17 8.83 17.75 12 17.75C15.17 17.75 17.75 15.17 17.75 12C17.75 8.83 15.17 6.25 12 6.25ZM12 16.25C9.66 16.25 7.75 14.34 7.75 12C7.75 9.66 9.66 7.75 12 7.75C14.34 7.75 16.25 9.66 16.25 12C16.25 14.34 14.34 16.25 12 16.25ZM14.75 12C14.75 13.52 13.52 14.75 12 14.75C11.59 14.75 11.25 14.41 11.25 14C11.25 13.59 11.59 13.25 12 13.25C12.69 13.25 13.25 12.69 13.25 12C13.25 11.59 13.59 11.25 14 11.25C14.41 11.25 14.75 11.59 14.75 12Z"></path></svg>',"camera-32x32":'<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M25 7.25H22.19C21.73 7.25 21.31 7 21.09 6.59L20.89 6.22C20.23 5.01 18.97 4.25 17.59 4.25H14.41C13.03 4.25 11.77 5 11.11 6.22L10.91 6.6C10.69 7 10.27 7.26 9.81 7.26H7C4.93 7.26 3.25 8.94 3.25 11.01V24.01C3.25 26.08 4.93 27.76 7 27.76H25C27.07 27.76 28.75 26.08 28.75 24.01V11C28.75 8.93 27.07 7.25 25 7.25ZM27.25 24C27.25 25.24 26.24 26.25 25 26.25H7C5.76 26.25 4.75 25.24 4.75 24V11C4.75 9.76 5.76 8.75 7 8.75H9.81C10.82 8.75 11.75 8.2 12.23 7.31L12.43 6.94C12.82 6.21 13.58 5.76 14.41 5.76H17.59C18.42 5.76 19.18 6.21 19.57 6.94L19.77 7.31C20.25 8.2 21.18 8.76 22.19 8.76H25C26.24 8.76 27.25 9.77 27.25 11.01V24.01V24ZM16 10.25C12.28 10.25 9.25 13.28 9.25 17C9.25 20.72 12.28 23.75 16 23.75C19.72 23.75 22.75 20.72 22.75 17C22.75 13.28 19.72 10.25 16 10.25ZM16 22.25C13.11 22.25 10.75 19.89 10.75 17C10.75 14.11 13.11 11.75 16 11.75C18.89 11.75 21.25 14.11 21.25 17C21.25 19.89 18.89 22.25 16 22.25ZM19.75 17C19.75 19.07 18.07 20.75 16 20.75C15.59 20.75 15.25 20.41 15.25 20C15.25 19.59 15.59 19.25 16 19.25C17.24 19.25 18.25 18.24 18.25 17C18.25 16.59 18.59 16.25 19 16.25C19.41 16.25 19.75 16.59 19.75 17Z"></path></svg>',"cancel-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.8099 11.75L15.2799 9.28C15.5699 8.99 15.5699 8.51 15.2799 8.22C14.9899 7.93 14.5099 7.93 14.2199 8.22L11.7499 10.69L9.27994 8.22C8.98994 7.93 8.50994 7.93 8.21994 8.22C7.92994 8.51 7.92994 8.99 8.21994 9.28L10.6899 11.75L8.21994 14.22C7.92994 14.51 7.92994 14.99 8.21994 15.28C8.36994 15.43 8.55994 15.5 8.74994 15.5C8.93994 15.5 9.12994 15.43 9.27994 15.28L11.7499 12.81L14.2199 15.28C14.3699 15.43 14.5599 15.5 14.7499 15.5C14.9399 15.5 15.1299 15.43 15.2799 15.28C15.5699 14.99 15.5699 14.51 15.2799 14.22L12.8099 11.75Z"></path></svg>',"check-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.0275 5.0275L6.5275 12.5275C6.3775 12.6775 6.1875 12.7475 5.9975 12.7475C5.8075 12.7475 5.6175 12.6775 5.4675 12.5275L2.4675 9.5275C2.1775 9.2375 2.1775 8.7575 2.4675 8.4675C2.7575 8.1775 3.2375 8.1775 3.5275 8.4675L5.9975 10.9375L12.9675 3.9675C13.2575 3.6775 13.7375 3.6775 14.0275 3.9675C14.3175 4.2575 14.3175 4.7375 14.0275 5.0275Z"></path></svg>',"check-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.5275 7.5275L9.5275 17.5275C9.3775 17.6775 9.1875 17.7475 8.9975 17.7475C8.8075 17.7475 8.6175 17.6775 8.4675 17.5275L4.4675 13.5275C4.1775 13.2375 4.1775 12.7575 4.4675 12.4675C4.7575 12.1775 5.2375 12.1775 5.5275 12.4675L8.9975 15.9375L18.4675 6.4675C18.7575 6.1775 19.2375 6.1775 19.5275 6.4675C19.8175 6.7575 19.8175 7.2375 19.5275 7.5275Z"></path></svg>',"chevrondown-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M16.5275 10.5275L12.5275 14.5275C12.3775 14.6775 12.1875 14.7475 11.9975 14.7475C11.8075 14.7475 11.6175 14.6775 11.4675 14.5275L7.4675 10.5275C7.1775 10.2375 7.1775 9.7575 7.4675 9.4675C7.7575 9.1775 8.2375 9.1775 8.5275 9.4675L11.9975 12.9375L15.4675 9.4675C15.7575 9.1775 16.2375 9.1775 16.5275 9.4675C16.8175 9.7575 16.8175 10.2375 16.5275 10.5275Z"></path></svg>',"chevronright-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.35 8.34627L7.35 12.3463C7.25 12.4463 7.12 12.4963 7 12.4963C6.88 12.4963 6.74 12.4463 6.65 12.3463C6.45 12.1463 6.45 11.8363 6.65 11.6363L10.3 7.98627L6.65 4.34627C6.45 4.15627 6.45 3.83627 6.65 3.64627C6.85 3.45627 7.16 3.44627 7.35 3.64627L11.35 7.64627C11.55 7.84627 11.55 8.15627 11.35 8.35627V8.34627Z"></path></svg>',"clear-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M12.35 11.65C12.55 11.85 12.55 12.16 12.35 12.36C12.25 12.46 12.12 12.51 12 12.51C11.88 12.51 11.74 12.46 11.65 12.36L8 8.71L4.35 12.36C4.25 12.46 4.12 12.51 4 12.51C3.88 12.51 3.74 12.46 3.65 12.36C3.45 12.16 3.45 11.85 3.65 11.65L7.3 8L3.65 4.35C3.45 4.16 3.45 3.84 3.65 3.65C3.85 3.46 4.16 3.45 4.35 3.65L8 7.3L11.65 3.65C11.85 3.45 12.16 3.45 12.36 3.65C12.56 3.85 12.56 4.16 12.36 4.36L8.71 8.01L12.36 11.66L12.35 11.65Z"></path></svg>',"clear-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.12 10.9325C20.64 10.4125 20.93 9.7225 20.93 8.9925C20.93 8.2625 20.64 7.5725 20.12 7.0525L16.95 3.8825C15.88 2.8125 14.13 2.8125 13.06 3.8825L3.88 13.0525C3.36 13.5725 3.07 14.2625 3.07 14.9925C3.07 15.7225 3.36 16.4125 3.88 16.9325L5.64 18.6925C6.57 19.6225 7.78 20.0825 9 20.0825C10.22 20.0825 11.43 19.6225 12.36 18.6925L20.12 10.9325ZM14.12 4.9325C14.36 4.6925 14.67 4.5625 15 4.5625C15.33 4.5625 15.65 4.6925 15.88 4.9325L19.05 8.1025C19.54 8.5925 19.54 9.3825 19.05 9.8725L12.99 15.9325L8.05 10.9925L14.12 4.9325ZM6.7 17.6325L4.94 15.8725C4.45 15.3825 4.45 14.5925 4.94 14.1025L7 12.0425L11.94 16.9825L11.3 17.6225C10.07 18.8525 7.93 18.8525 6.7 17.6225V17.6325ZM22.75 20.9925C22.75 21.4025 22.41 21.7425 22 21.7425H14C13.59 21.7425 13.25 21.4025 13.25 20.9925C13.25 20.5825 13.59 20.2425 14 20.2425H22C22.41 20.2425 22.75 20.5825 22.75 20.9925ZM4.75 20.9925C4.75 21.4025 4.41 21.7425 4 21.7425H2C1.59 21.7425 1.25 21.4025 1.25 20.9925C1.25 20.5825 1.59 20.2425 2 20.2425H4C4.41 20.2425 4.75 20.5825 4.75 20.9925Z"></path></svg>',"close-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13.5275 12.4675C13.8175 12.7575 13.8175 13.2375 13.5275 13.5275C13.3775 13.6775 13.1875 13.7475 12.9975 13.7475C12.8075 13.7475 12.6175 13.6775 12.4675 13.5275L7.9975 9.0575L3.5275 13.5275C3.3775 13.6775 3.1875 13.7475 2.9975 13.7475C2.8075 13.7475 2.6175 13.6775 2.4675 13.5275C2.1775 13.2375 2.1775 12.7575 2.4675 12.4675L6.9375 7.9975L2.4675 3.5275C2.1775 3.2375 2.1775 2.7575 2.4675 2.4675C2.7575 2.1775 3.2375 2.1775 3.5275 2.4675L7.9975 6.9375L12.4675 2.4675C12.7575 2.1775 13.2375 2.1775 13.5275 2.4675C13.8175 2.7575 13.8175 3.2375 13.5275 3.5275L9.0575 7.9975L13.5275 12.4675Z"></path></svg>',"close-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.5275 18.4675C19.8175 18.7575 19.8175 19.2375 19.5275 19.5275C19.3775 19.6775 19.1875 19.7475 18.9975 19.7475C18.8075 19.7475 18.6175 19.6775 18.4675 19.5275L11.9975 13.0575L5.5275 19.5275C5.3775 19.6775 5.1875 19.7475 4.9975 19.7475C4.8075 19.7475 4.6175 19.6775 4.4675 19.5275C4.1775 19.2375 4.1775 18.7575 4.4675 18.4675L10.9375 11.9975L4.4675 5.5275C4.1775 5.2375 4.1775 4.7575 4.4675 4.4675C4.7575 4.1775 5.2375 4.1775 5.5275 4.4675L11.9975 10.9375L18.4675 4.4675C18.7575 4.1775 19.2375 4.1775 19.5275 4.4675C19.8175 4.7575 19.8175 5.2375 19.5275 5.5275L13.0575 11.9975L19.5275 18.4675Z"></path></svg>',"collapse-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.75 8C11.75 8.41 11.41 8.75 11 8.75H5C4.59 8.75 4.25 8.41 4.25 8C4.25 7.59 4.59 7.25 5 7.25H11C11.41 7.25 11.75 7.59 11.75 8Z"></path></svg>',"collapsedetails-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.75 8C11.75 8.41 11.41 8.75 11 8.75H5C4.59 8.75 4.25 8.41 4.25 8C4.25 7.59 4.59 7.25 5 7.25H11C11.41 7.25 11.75 7.59 11.75 8Z"></path></svg>',"delete-16x16":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13 3.25H10.75V3C10.75 2.04 9.96 1.25 9 1.25H7C6.04 1.25 5.25 2.04 5.25 3V3.25H3C2.59 3.25 2.25 3.59 2.25 4C2.25 4.41 2.59 4.75 3 4.75H3.25V13C3.25 13.96 4.04 14.75 5 14.75H11C11.96 14.75 12.75 13.96 12.75 13V4.75H13C13.41 4.75 13.75 4.41 13.75 4C13.75 3.59 13.41 3.25 13 3.25ZM6.75 3C6.75 2.86 6.86 2.75 7 2.75H9C9.14 2.75 9.25 2.86 9.25 3V3.25H6.75V3ZM11.25 13C11.25 13.14 11.14 13.25 11 13.25H5C4.86 13.25 4.75 13.14 4.75 13V4.75H11.25V13ZM9.25 6.25C9.66 6.25 10 6.59 10 7V11C10 11.41 9.66 11.75 9.25 11.75C8.84 11.75 8.5 11.41 8.5 11V7C8.5 6.59 8.84 6.25 9.25 6.25ZM7.5 7V11C7.5 11.41 7.16 11.75 6.75 11.75C6.34 11.75 6 11.41 6 11V7C6 6.59 6.34 6.25 6.75 6.25C7.16 6.25 7.5 6.59 7.5 7Z"></path></svg>',"delete-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.75 9V17C12.75 17.41 12.41 17.75 12 17.75C11.59 17.75 11.25 17.41 11.25 17V9C11.25 8.59 11.59 8.25 12 8.25C12.41 8.25 12.75 8.59 12.75 9ZM14.25 9V17C14.25 17.41 14.59 17.75 15 17.75C15.41 17.75 15.75 17.41 15.75 17V9C15.75 8.59 15.41 8.25 15 8.25C14.59 8.25 14.25 8.59 14.25 9ZM9 8.25C8.59 8.25 8.25 8.59 8.25 9V17C8.25 17.41 8.59 17.75 9 17.75C9.41 17.75 9.75 17.41 9.75 17V9C9.75 8.59 9.41 8.25 9 8.25ZM20.75 6C20.75 6.41 20.41 6.75 20 6.75H18.75V18C18.75 19.52 17.52 20.75 16 20.75H8C6.48 20.75 5.25 19.52 5.25 18V6.75H4C3.59 6.75 3.25 6.41 3.25 6C3.25 5.59 3.59 5.25 4 5.25H8.25V4C8.25 3.04 9.04 2.25 10 2.25H14C14.96 2.25 15.75 3.04 15.75 4V5.25H20C20.41 5.25 20.75 5.59 20.75 6ZM9.75 5.25H14.25V4C14.25 3.86 14.14 3.75 14 3.75H10C9.86 3.75 9.75 3.86 9.75 4V5.25ZM17.25 6.75H6.75V18C6.75 18.69 7.31 19.25 8 19.25H16C16.69 19.25 17.25 18.69 17.25 18V6.75Z"></path></svg>',"drag-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14.5 8.75C15.19 8.75 15.75 8.19 15.75 7.5C15.75 6.81 15.19 6.25 14.5 6.25C13.81 6.25 13.25 6.81 13.25 7.5C13.25 8.19 13.81 8.75 14.5 8.75ZM14.5 7.25C14.64 7.25 14.75 7.36 14.75 7.5C14.75 7.78 14.25 7.78 14.25 7.5C14.25 7.36 14.36 7.25 14.5 7.25ZM9.5 6.25C8.81 6.25 8.25 6.81 8.25 7.5C8.25 8.19 8.81 8.75 9.5 8.75C10.19 8.75 10.75 8.19 10.75 7.5C10.75 6.81 10.19 6.25 9.5 6.25ZM9.25 7.5C9.25 7.36 9.36 7.25 9.5 7.25C9.64 7.25 9.75 7.36 9.75 7.5C9.75 7.78 9.25 7.78 9.25 7.5ZM14.5 11.25C13.81 11.25 13.25 11.81 13.25 12.5C13.25 13.19 13.81 13.75 14.5 13.75C15.19 13.75 15.75 13.19 15.75 12.5C15.75 11.81 15.19 11.25 14.5 11.25ZM14.25 12.5C14.25 12.36 14.36 12.25 14.5 12.25C14.64 12.25 14.75 12.36 14.75 12.5C14.75 12.78 14.25 12.78 14.25 12.5ZM9.5 11.25C8.81 11.25 8.25 11.81 8.25 12.5C8.25 13.19 8.81 13.75 9.5 13.75C10.19 13.75 10.75 13.19 10.75 12.5C10.75 11.81 10.19 11.25 9.5 11.25ZM9.25 12.5C9.25 12.36 9.36 12.25 9.5 12.25C9.64 12.25 9.75 12.36 9.75 12.5C9.75 12.78 9.25 12.78 9.25 12.5ZM14.5 16.25C13.81 16.25 13.25 16.81 13.25 17.5C13.25 18.19 13.81 18.75 14.5 18.75C15.19 18.75 15.75 18.19 15.75 17.5C15.75 16.81 15.19 16.25 14.5 16.25ZM14.25 17.5C14.25 17.36 14.36 17.25 14.5 17.25C14.64 17.25 14.75 17.36 14.75 17.5C14.75 17.78 14.25 17.78 14.25 17.5ZM9.5 16.25C8.81 16.25 8.25 16.81 8.25 17.5C8.25 18.19 8.81 18.75 9.5 18.75C10.19 18.75 10.75 18.19 10.75 17.5C10.75 16.81 10.19 16.25 9.5 16.25ZM9.25 17.5C9.25 17.36 9.36 17.25 9.5 17.25C9.64 17.25 9.75 17.36 9.75 17.5C9.75 17.78 9.25 17.78 9.25 17.5Z"></path></svg>',"draghorizontal-24x16":'<svg viewBox="0 0 24 16" xmlns="http://www.w3.org/2000/svg"><path d="M17.5 9.25C16.81 9.25 16.25 9.81 16.25 10.5C16.25 11.19 16.81 11.75 17.5 11.75C18.19 11.75 18.75 11.19 18.75 10.5C18.75 9.81 18.19 9.25 17.5 9.25ZM17.25 10.5C17.25 10.36 17.36 10.25 17.5 10.25C17.64 10.25 17.75 10.36 17.75 10.5C17.75 10.78 17.25 10.78 17.25 10.5ZM17.5 6.75C18.19 6.75 18.75 6.19 18.75 5.5C18.75 4.81 18.19 4.25 17.5 4.25C16.81 4.25 16.25 4.81 16.25 5.5C16.25 6.19 16.81 6.75 17.5 6.75ZM17.5 5.25C17.64 5.25 17.75 5.36 17.75 5.5C17.75 5.78 17.25 5.78 17.25 5.5C17.25 5.36 17.36 5.25 17.5 5.25ZM12.5 9.25C11.81 9.25 11.25 9.81 11.25 10.5C11.25 11.19 11.81 11.75 12.5 11.75C13.19 11.75 13.75 11.19 13.75 10.5C13.75 9.81 13.19 9.25 12.5 9.25ZM12.25 10.5C12.25 10.36 12.36 10.25 12.5 10.25C12.64 10.25 12.75 10.36 12.75 10.5C12.75 10.78 12.25 10.78 12.25 10.5ZM12.5 4.25C11.81 4.25 11.25 4.81 11.25 5.5C11.25 6.19 11.81 6.75 12.5 6.75C13.19 6.75 13.75 6.19 13.75 5.5C13.75 4.81 13.19 4.25 12.5 4.25ZM12.25 5.5C12.25 5.36 12.36 5.25 12.5 5.25C12.64 5.25 12.75 5.36 12.75 5.5C12.75 5.78 12.25 5.78 12.25 5.5ZM7.5 9.25C6.81 9.25 6.25 9.81 6.25 10.5C6.25 11.19 6.81 11.75 7.5 11.75C8.19 11.75 8.75 11.19 8.75 10.5C8.75 9.81 8.19 9.25 7.5 9.25ZM7.25 10.5C7.25 10.36 7.36 10.25 7.5 10.25C7.64 10.25 7.75 10.36 7.75 10.5C7.75 10.78 7.25 10.78 7.25 10.5ZM7.5 4.25C6.81 4.25 6.25 4.81 6.25 5.5C6.25 6.19 6.81 6.75 7.5 6.75C8.19 6.75 8.75 6.19 8.75 5.5C8.75 4.81 8.19 4.25 7.5 4.25ZM7.25 5.5C7.25 5.36 7.36 5.25 7.5 5.25C7.64 5.25 7.75 5.36 7.75 5.5C7.75 5.78 7.25 5.78 7.25 5.5Z"></path></svg>',"editsmall-16x16":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.1209 3.05249L12.9509 2.88249C11.8809 1.81249 10.1309 1.81249 9.06089 2.88249L3.47089 8.46249C3.37089 8.56249 3.31089 8.68249 3.27089 8.81249L2.27089 12.8125C2.21089 13.0625 2.28089 13.3425 2.47089 13.5225C2.61089 13.6625 2.80089 13.7425 3.00089 13.7425C3.06089 13.7425 3.12089 13.7425 3.18089 13.7225L7.18089 12.7225C7.31089 12.6925 7.43089 12.6225 7.53089 12.5225L13.1209 6.93249C14.1909 5.86249 14.1909 4.11249 13.1209 3.04249V3.05249ZM6.62089 11.3125L4.04089 11.9625L4.69089 9.38249L8.01089 6.06249L9.95089 8.00249L6.63089 11.3225L6.62089 11.3125ZM12.0609 5.87249L11.0009 6.93249L9.06089 4.99249L10.1209 3.93249C10.6109 3.44249 11.4009 3.44249 11.8909 3.93249L12.0609 4.10249C12.5509 4.59249 12.5509 5.38249 12.0609 5.87249Z"></path></svg>',"expand-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.75 8C11.75 8.41 11.41 8.75 11 8.75H8.75V11C8.75 11.41 8.41 11.75 8 11.75C7.59 11.75 7.25 11.41 7.25 11V8.75H5C4.59 8.75 4.25 8.41 4.25 8C4.25 7.59 4.59 7.25 5 7.25H7.25V5C7.25 4.59 7.59 4.25 8 4.25C8.41 4.25 8.75 4.59 8.75 5V7.25H11C11.41 7.25 11.75 7.59 11.75 8Z"></path></svg>',"expanddetails-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.75 8C11.75 8.41 11.41 8.75 11 8.75H8.75V11C8.75 11.41 8.41 11.75 8 11.75C7.59 11.75 7.25 11.41 7.25 11V8.75H5C4.59 8.75 4.25 8.41 4.25 8C4.25 7.59 4.59 7.25 5 7.25H7.25V5C7.25 4.59 7.59 4.25 8 4.25C8.41 4.25 8.75 4.59 8.75 5V7.25H11C11.41 7.25 11.75 7.59 11.75 8Z"></path></svg>',"file-72x72":'<svg viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M62.83 12.83L53.17 3.17C52.7982 2.79866 52.357 2.50421 51.8714 2.30346C51.3858 2.1027 50.8654 1.99959 50.34 2H14C12.4087 2 10.8826 2.63214 9.75735 3.75736C8.63214 4.88258 8 6.4087 8 8V64C8 65.5913 8.63214 67.1174 9.75735 68.2426C10.8826 69.3679 12.4087 70 14 70H58C59.5913 70 61.1174 69.3679 62.2426 68.2426C63.3679 67.1174 64 65.5913 64 64V15.66C64.0004 15.1346 63.8973 14.6142 63.6965 14.1286C63.4958 13.643 63.2013 13.2018 62.83 12.83ZM52 4.83L61.17 14H56C54.9391 14 53.9217 13.5786 53.1716 12.8284C52.4214 12.0783 52 11.0609 52 10V4.83ZM62 64C62 65.0609 61.5786 66.0783 60.8284 66.8284C60.0783 67.5786 59.0609 68 58 68H14C12.9391 68 11.9217 67.5786 11.1716 66.8284C10.4214 66.0783 10 65.0609 10 64V8C10 6.93914 10.4214 5.92172 11.1716 5.17157C11.9217 4.42143 12.9391 4 14 4H50V10C50 11.5913 50.6321 13.1174 51.7574 14.2426C52.8826 15.3679 54.4087 16 56 16H62V64ZM22 26H50V28H22V26ZM22 32H50V34H22V32ZM22 38H50V40H22V38ZM22 44H50V46H22V44Z"></path></svg>',"flip-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14.53 17.4775C14.82 17.7675 14.82 18.2475 14.53 18.5375L11.53 21.5375C11.38 21.6875 11.19 21.7575 11 21.7575C10.81 21.7575 10.62 21.6875 10.47 21.5375C10.18 21.2475 10.18 20.7675 10.47 20.4775L12.2 18.7475C12.13 18.7475 12.07 18.7475 12 18.7475C6.62 18.7475 2.25 15.7475 2.25 12.0575C2.25 10.2975 3.22 8.6375 4.99 7.3875C5.33 7.1475 5.8 7.2275 6.03 7.5675C6.27 7.9075 6.19 8.3775 5.85 8.6075C4.49 9.5675 3.74 10.7875 3.74 12.0575C3.74 14.9175 7.44 17.2475 11.99 17.2475C12.05 17.2475 12.11 17.2475 12.17 17.2475L10.46 15.5375C10.17 15.2475 10.17 14.7675 10.46 14.4775C10.75 14.1875 11.23 14.1875 11.52 14.4775L14.52 17.4775H14.53ZM12 5.2575C11.93 5.2575 11.87 5.2575 11.8 5.2575L13.53 3.5275C13.82 3.2375 13.82 2.7575 13.53 2.4675C13.24 2.1775 12.76 2.1775 12.47 2.4675L9.47 5.4675C9.18 5.7575 9.18 6.2375 9.47 6.5275L12.47 9.5275C12.62 9.6775 12.81 9.7475 13 9.7475C13.19 9.7475 13.38 9.6775 13.53 9.5275C13.82 9.2375 13.82 8.7575 13.53 8.4675L11.82 6.7575C11.88 6.7575 11.94 6.7575 12 6.7575C16.55 6.7575 20.25 9.0875 20.25 11.9475C20.25 13.2075 19.5 14.4375 18.14 15.3975C17.8 15.6375 17.72 16.1075 17.96 16.4475C18.11 16.6575 18.34 16.7675 18.57 16.7675C18.72 16.7675 18.87 16.7275 19 16.6275C20.77 15.3775 21.75 13.7175 21.75 11.9575C21.75 8.2675 17.38 5.2675 12 5.2675V5.2575Z"></path></svg>',"folder-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.72 9.24C21.45 8.92 21.12 8.67 20.75 8.5V8C20.75 6.48 19.52 5.25 18 5.25H10.65C10.32 4.1 9.26 3.25 8 3.25H6C4.48 3.25 3.25 4.48 3.25 6V18C3.25 19.52 4.48 20.75 6 20.75H18.33C19.66 20.75 20.8 19.8 21.04 18.49L22.31 11.49C22.46 10.69 22.24 9.86 21.72 9.24ZM4.75 18V6C4.75 5.31 5.31 4.75 6 4.75H8C8.69 4.75 9.25 5.31 9.25 6C9.25 6.41 9.59 6.75 10 6.75H18C18.69 6.75 19.25 7.31 19.25 8V8.25H9.27C7.94 8.25 6.8 9.2 6.56 10.51L5.29 17.51C5.19 18.07 5.27 18.64 5.51 19.15C5.06 18.96 4.75 18.52 4.75 18ZM20.83 11.22L19.56 18.22C19.45 18.81 18.94 19.25 18.33 19.25H8C7.63 19.25 7.28 19.09 7.04 18.8C6.8 18.51 6.7 18.14 6.77 17.78L8.04 10.78C8.15 10.19 8.66 9.75 9.27 9.75H19.6C19.97 9.75 20.32 9.91 20.56 10.2C20.8 10.49 20.9 10.86 20.83 11.22Z"></path></svg>',"fullsize-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M12 3.25H4C3.04 3.25 2.25 4.04 2.25 5V11C2.25 11.96 3.04 12.75 4 12.75H12C12.96 12.75 13.75 11.96 13.75 11V5C13.75 4.04 12.96 3.25 12 3.25ZM12.25 11C12.25 11.14 12.14 11.25 12 11.25H4C3.86 11.25 3.75 11.14 3.75 11V5C3.75 4.86 3.86 4.75 4 4.75H12C12.14 4.75 12.25 4.86 12.25 5V11Z"></path></svg>',"image-48x48":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M33 10.25H15C12.38 10.25 10.25 12.38 10.25 15V33C10.25 35.62 12.38 37.75 15 37.75H33C35.62 37.75 37.75 35.62 37.75 33V15C37.75 12.38 35.62 10.25 33 10.25ZM36.25 33C36.25 34.79 34.79 36.25 33 36.25H15C13.21 36.25 11.75 34.79 11.75 33V15C11.75 13.21 13.21 11.75 15 11.75H33C34.79 11.75 36.25 13.21 36.25 15V33ZM30.5 14.25C28.71 14.25 27.25 15.71 27.25 17.5C27.25 19.29 28.71 20.75 30.5 20.75C32.29 20.75 33.75 19.29 33.75 17.5C33.75 15.71 32.29 14.25 30.5 14.25ZM30.5 19.25C29.54 19.25 28.75 18.46 28.75 17.5C28.75 16.54 29.54 15.75 30.5 15.75C31.46 15.75 32.25 16.54 32.25 17.5C32.25 18.46 31.46 19.25 30.5 19.25ZM29.26 26.28C28.94 25.92 28.49 25.71 28.01 25.7C27.54 25.68 27.07 25.87 26.73 26.2L24.95 27.94L22.28 25.23C21.94 24.89 21.5 24.71 21 24.71C20.52 24.71 20.06 24.93 19.74 25.28L14.74 30.78C14.25 31.3 14.12 32.06 14.41 32.72C14.69 33.36 15.28 33.75 15.95 33.75H32.07C32.74 33.75 33.33 33.35 33.61 32.72C33.89 32.06 33.77 31.31 33.29 30.79L29.27 26.29L29.26 26.28ZM32.22 32.12C32.18 32.2 32.13 32.25 32.06 32.25H15.94C15.87 32.25 15.81 32.21 15.78 32.12C15.77 32.09 15.71 31.93 15.83 31.8L20.84 26.29C20.9 26.22 20.99 26.21 21.02 26.21C21.06 26.21 21.14 26.22 21.2 26.29L24.4 29.54C24.69 29.83 25.16 29.84 25.46 29.54L27.77 27.27C27.83 27.21 27.9 27.2 27.94 27.2C28.01 27.2 28.06 27.21 28.13 27.28L32.16 31.79C32.16 31.79 32.16 31.79 32.17 31.8C32.29 31.93 32.23 32.09 32.22 32.12Z"></path></svg>',"loading-48x48":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_19679_369428)"><path opacity="0.1" d="M24 40C15.18 40 8 32.82 8 24C8 15.18 15.18 8 24 8C32.82 8 40 15.18 40 24C40 32.82 32.82 40 24 40ZM24 12C17.38 12 12 17.38 12 24C12 30.62 17.38 36 24 36C30.62 36 36 30.62 36 24C36 17.38 30.62 12 24 12Z" fill="black" fill-opacity="0.91"></path><path d="M10 26C8.9 26 8 25.1 8 24C8 15.18 15.18 8 24 8C25.1 8 26 8.9 26 10C26 11.1 25.1 12 24 12C17.38 12 12 17.38 12 24C12 25.1 11.1 26 10 26Z"></path></g><defs><clipPath id="clip0_19679_369428"><rect width="32" height="32" fill="white" transform="translate(8 8)"></rect></clipPath></defs></svg>',"maximize-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13.75 3V7C13.75 7.41 13.41 7.75 13 7.75C12.59 7.75 12.25 7.41 12.25 7V4.81L9.53 7.53C9.38 7.68 9.19 7.75 9 7.75C8.81 7.75 8.62 7.68 8.47 7.53C8.18 7.24 8.18 6.76 8.47 6.47L11.19 3.75H9C8.59 3.75 8.25 3.41 8.25 3C8.25 2.59 8.59 2.25 9 2.25H13C13.1 2.25 13.19 2.27 13.29 2.31C13.47 2.39 13.62 2.53 13.7 2.72C13.74 2.81 13.76 2.91 13.76 3.01L13.75 3ZM7.53 8.47C7.24 8.18 6.76 8.18 6.47 8.47L3.75 11.19V9C3.75 8.59 3.41 8.25 3 8.25C2.59 8.25 2.25 8.59 2.25 9V13C2.25 13.1 2.27 13.19 2.31 13.29C2.39 13.47 2.53 13.62 2.72 13.7C2.81 13.74 2.91 13.76 3.01 13.76H7.01C7.42 13.76 7.76 13.42 7.76 13.01C7.76 12.6 7.42 12.26 7.01 12.26H4.82L7.54 9.54C7.83 9.25 7.83 8.77 7.54 8.48L7.53 8.47Z"></path></svg>',"minimize-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13.75 8C13.75 8.41 13.41 8.75 13 8.75H3C2.59 8.75 2.25 8.41 2.25 8C2.25 7.59 2.59 7.25 3 7.25H13C13.41 7.25 13.75 7.59 13.75 8Z"></path></svg>',"more-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 10.25C11.04 10.25 10.25 11.04 10.25 12C10.25 12.96 11.04 13.75 12 13.75C12.96 13.75 13.75 12.96 13.75 12C13.75 11.04 12.96 10.25 12 10.25ZM11.75 12C11.75 11.86 11.86 11.75 12 11.75C12.14 11.75 12.25 11.86 12.25 12C12.25 12.28 11.75 12.28 11.75 12ZM19 10.25C18.04 10.25 17.25 11.04 17.25 12C17.25 12.96 18.04 13.75 19 13.75C19.96 13.75 20.75 12.96 20.75 12C20.75 11.04 19.96 10.25 19 10.25ZM18.75 12C18.75 11.86 18.86 11.75 19 11.75C19.14 11.75 19.25 11.86 19.25 12C19.25 12.28 18.75 12.28 18.75 12ZM5 10.25C4.04 10.25 3.25 11.04 3.25 12C3.25 12.96 4.04 13.75 5 13.75C5.96 13.75 6.75 12.96 6.75 12C6.75 11.04 5.96 10.25 5 10.25ZM4.75 12C4.75 11.86 4.86 11.75 5 11.75C5.14 11.75 5.25 11.86 5.25 12C5.25 12.28 4.75 12.28 4.75 12Z"></path></svg>',"navmenu-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.25 7C3.25 6.59 3.59 6.25 4 6.25H15C15.41 6.25 15.75 6.59 15.75 7C15.75 7.41 15.41 7.75 15 7.75H4C3.59 7.75 3.25 7.41 3.25 7ZM20 11.25H4C3.59 11.25 3.25 11.59 3.25 12C3.25 12.41 3.59 12.75 4 12.75H20C20.41 12.75 20.75 12.41 20.75 12C20.75 11.59 20.41 11.25 20 11.25ZM9 16.25H4C3.59 16.25 3.25 16.59 3.25 17C3.25 17.41 3.59 17.75 4 17.75H9C9.41 17.75 9.75 17.41 9.75 17C9.75 16.59 9.41 16.25 9 16.25Z"></path></svg>',"noimage-48x48":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M30.4975 14.2475C28.7075 14.2475 27.2475 15.7075 27.2475 17.4975C27.2475 19.2875 28.7075 20.7475 30.4975 20.7475C32.2875 20.7475 33.7475 19.2875 33.7475 17.4975C33.7475 15.7075 32.2875 14.2475 30.4975 14.2475ZM30.4975 19.2475C29.5375 19.2475 28.7475 18.4575 28.7475 17.4975C28.7475 16.5375 29.5375 15.7475 30.4975 15.7475C31.4575 15.7475 32.2475 16.5375 32.2475 17.4975C32.2475 18.4575 31.4575 19.2475 30.4975 19.2475ZM13.5175 11.2175C13.4375 10.8075 13.7075 10.4175 14.1175 10.3375C14.4275 10.2775 14.7175 10.2475 14.9975 10.2475H32.9975C35.6175 10.2475 37.7475 12.3775 37.7475 14.9975V32.9975C37.7475 33.2775 37.7175 33.5675 37.6575 33.8775C37.5875 34.2375 37.2775 34.4875 36.9175 34.4875C36.8675 34.4875 36.8275 34.4875 36.7775 34.4775C36.3675 34.3975 36.1075 34.0075 36.1775 33.5975C36.2175 33.3775 36.2375 33.1775 36.2375 32.9975V14.9975C36.2375 13.2075 34.7775 11.7475 32.9875 11.7475H14.9975C14.8075 11.7475 14.6175 11.7675 14.3975 11.8075C13.9875 11.8875 13.5975 11.6175 13.5175 11.2075V11.2175ZM34.4775 36.7775C34.5575 37.1875 34.2875 37.5775 33.8775 37.6575C33.5675 37.7175 33.2775 37.7475 32.9975 37.7475H14.9975C12.3775 37.7475 10.2475 35.6175 10.2475 32.9975V14.9975C10.2475 14.7175 10.2775 14.4275 10.3375 14.1175C10.4175 13.7075 10.8075 13.4375 11.2175 13.5175C11.6275 13.5975 11.8875 13.9875 11.8175 14.3975C11.7775 14.6175 11.7575 14.8175 11.7575 14.9975V32.9975C11.7575 34.7875 13.2175 36.2475 15.0075 36.2475H33.0075C33.1975 36.2475 33.3875 36.2275 33.6075 36.1875C34.0075 36.1075 34.4075 36.3775 34.4875 36.7875L34.4775 36.7775ZM15.8275 31.7975C15.6975 31.9375 15.7575 32.0875 15.7775 32.1175C15.8175 32.1975 15.8675 32.2475 15.9375 32.2475H29.8175C30.2275 32.2475 30.5675 32.5875 30.5675 32.9975C30.5675 33.4075 30.2275 33.7475 29.8175 33.7475H15.9375C15.2675 33.7475 14.6775 33.3475 14.3975 32.7175C14.1075 32.0575 14.2375 31.2975 14.7275 30.7775L19.7275 25.2775C20.0475 24.9275 20.5075 24.7175 20.9875 24.7075C21.4875 24.7275 21.9375 24.8875 22.2675 25.2275L25.4675 28.4775C25.7575 28.7675 25.7575 29.2475 25.4675 29.5375C25.1675 29.8275 24.6975 29.8275 24.4075 29.5375L21.2075 26.2875C21.1475 26.2175 21.0675 26.1875 21.0275 26.2075C20.9875 26.2075 20.9075 26.2175 20.8475 26.2875L15.8375 31.7975H15.8275ZM38.5275 38.5275C38.3775 38.6775 38.1875 38.7475 37.9975 38.7475C37.8075 38.7475 37.6175 38.6775 37.4675 38.5275L9.4675 10.5275C9.1775 10.2375 9.1775 9.7575 9.4675 9.4675C9.7575 9.1775 10.2375 9.1775 10.5275 9.4675L38.5275 37.4675C38.8175 37.7575 38.8175 38.2375 38.5275 38.5275Z"></path></svg>',"ranking-arrows":'<svg viewBox="0 0 10 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 5L5 0L0 5H4V9H6V5H10Z"></path><path d="M6 19V15H4V19H0L5 24L10 19H6Z"></path></svg>',"rankingundefined-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.75 8C11.75 8.41 11.41 8.75 11 8.75H5C4.59 8.75 4.25 8.41 4.25 8C4.25 7.59 4.59 7.25 5 7.25H11C11.41 7.25 11.75 7.59 11.75 8Z"></path></svg>',"rating-star-2":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M24 39.5057L11.7226 45.9839C10.4095 46.6739 8.87606 45.5622 9.12525 44.096L11.4734 30.373L1.54411 20.6556C0.480254 19.6207 1.06489 17.8095 2.53128 17.5986L16.2559 15.5957L22.3994 3.10891C23.0512 1.77685 24.9488 1.77685 25.6102 3.10891L31.7441 15.5957L45.4687 17.5986C46.9351 17.8095 47.5197 19.6207 46.4559 20.6556L36.5266 30.373L38.8748 44.096C39.1239 45.5622 37.5905 46.6835 36.2774 45.9839L24 39.5057Z" fill="none" stroke-width="2"></path><path d="M24.3981 33.1305L24 32.9206L23.6019 33.1305L15.8715 37.2059L17.3542 28.5663L17.43 28.1246L17.1095 27.8113L10.83 21.6746L19.4965 20.4049L19.9405 20.3399L20.1387 19.9373L24 12.0936L27.8613 19.9373L28.0595 20.3399L28.5035 20.4049L37.17 21.6746L30.8905 27.8113L30.57 28.1246L30.6458 28.5663L32.1285 37.2059L24.3981 33.1305Z" stroke-width="1.70746"></path></svg>',"rating-star-small-2":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 19.3373L6.13001 22.4373C5.50001 22.7673 4.77001 22.2373 4.89001 21.5373L6.01001 14.9773L1.26001 10.3273C0.750007 9.83728 1.03001 8.96728 1.73001 8.86728L8.29001 7.90728L11.23 1.93728C11.54 1.29728 12.45 1.29728 12.77 1.93728L15.7 7.90728L22.26 8.86728C22.96 8.96728 23.24 9.83728 22.73 10.3273L17.98 14.9773L19.1 21.5373C19.22 22.2373 18.49 22.7773 17.86 22.4373L11.99 19.3373H12Z" fill="none" stroke-width="2"></path><path d="M12 15.9472L8.58001 17.7572L9.23001 13.9272L6.45001 11.2072L10.29 10.6472L12 7.17725L13.71 10.6472L17.55 11.2072L14.77 13.9272L15.42 17.7572L12 15.9472Z"></path></svg>',"rating-star-small":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g><path d="M12 19.3373L6.13001 22.4373C5.50001 22.7673 4.77001 22.2373 4.89001 21.5373L6.01001 14.9773L1.26001 10.3273C0.750007 9.83728 1.03001 8.96728 1.73001 8.86728L8.29001 7.90728L11.23 1.93728C11.54 1.29728 12.45 1.29728 12.77 1.93728L15.7 7.90728L22.26 8.86728C22.96 8.96728 23.24 9.83728 22.73 10.3273L17.98 14.9773L19.1 21.5373C19.22 22.2373 18.49 22.7773 17.86 22.4373L11.99 19.3373H12Z"></path></g></svg>',"rating-star":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g><path d="M24 39.5057L11.7226 45.9839C10.4095 46.6739 8.87606 45.5622 9.12525 44.096L11.4734 30.373L1.54411 20.6556C0.480254 19.6207 1.06489 17.8095 2.53128 17.5986L16.2559 15.5957L22.3994 3.10891C23.0512 1.77685 24.9488 1.77685 25.6102 3.10891L31.7441 15.5957L45.4687 17.5986C46.9351 17.8095 47.5197 19.6207 46.4559 20.6556L36.5266 30.373L38.8748 44.096C39.1239 45.5622 37.5905 46.6835 36.2774 45.9839L24 39.5057Z"></path></g></svg>',"reorder-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.9444 10.75H15.0544C15.7144 10.75 16.3144 10.39 16.6144 9.80002C16.9144 9.22002 16.8644 8.52002 16.4844 7.98002L13.4244 3.71002C12.7644 2.79002 11.2344 2.79002 10.5744 3.71002L7.5244 7.99002C7.1444 8.53002 7.0944 9.22002 7.3944 9.81002C7.6944 10.4 8.2944 10.76 8.9544 10.76L8.9444 10.75ZM8.7444 8.86002L11.7944 4.58002C11.8644 4.49002 11.9544 4.48002 11.9944 4.48002C12.0344 4.48002 12.1344 4.49002 12.1944 4.58002L15.2544 8.86002C15.3344 8.97002 15.3044 9.07002 15.2744 9.12002C15.2444 9.17002 15.1844 9.26002 15.0544 9.26002H8.9444C8.8144 9.26002 8.7444 9.18002 8.7244 9.12002C8.7044 9.06002 8.6644 8.97002 8.7444 8.86002ZM15.0544 13.25H8.9444C8.2844 13.25 7.6844 13.61 7.3844 14.2C7.0844 14.78 7.1344 15.48 7.5144 16.02L10.5744 20.3C10.9044 20.76 11.4344 21.03 11.9944 21.03C12.5544 21.03 13.0944 20.76 13.4144 20.3L16.4744 16.02C16.8544 15.48 16.9044 14.79 16.6044 14.2C16.3044 13.61 15.7044 13.25 15.0444 13.25H15.0544ZM15.2644 15.15L12.2044 19.43C12.0744 19.61 11.9244 19.61 11.7944 19.43L8.7344 15.15C8.6544 15.04 8.6844 14.94 8.7144 14.89C8.7444 14.84 8.8044 14.75 8.9344 14.75H15.0444C15.1744 14.75 15.2444 14.83 15.2644 14.89C15.2844 14.95 15.3244 15.04 15.2444 15.15H15.2644Z"></path></svg>',"restoredown-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.69 8.71C7.73 8.8 7.75 8.9 7.75 9V13C7.75 13.41 7.41 13.75 7 13.75C6.59 13.75 6.25 13.41 6.25 13V10.81L3.53 13.53C3.38 13.68 3.19 13.75 3 13.75C2.81 13.75 2.62 13.68 2.47 13.53C2.18 13.24 2.18 12.76 2.47 12.47L5.19 9.75H3C2.59 9.75 2.25 9.41 2.25 9C2.25 8.59 2.59 8.25 3 8.25H7C7.1 8.25 7.19 8.27 7.29 8.31C7.47 8.39 7.62 8.53 7.7 8.72L7.69 8.71ZM13 6.25H10.81L13.53 3.53C13.82 3.24 13.82 2.76 13.53 2.47C13.24 2.18 12.76 2.18 12.47 2.47L9.75 5.19V3C9.75 2.59 9.41 2.25 9 2.25C8.59 2.25 8.25 2.59 8.25 3V7C8.25 7.1 8.27 7.19 8.31 7.29C8.39 7.47 8.53 7.62 8.72 7.7C8.81 7.74 8.91 7.76 9.01 7.76H13.01C13.42 7.76 13.76 7.42 13.76 7.01C13.76 6.6 13.42 6.26 13.01 6.26L13 6.25Z"></path></svg>',"search-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.9975 2.25C9.7275 2.25 6.2475 5.73 6.2475 10C6.2475 11.87 6.9075 13.58 8.0175 14.92L2.4675 20.47C2.1775 20.76 2.1775 21.24 2.4675 21.53C2.6175 21.68 2.8075 21.75 2.9975 21.75C3.1875 21.75 3.3775 21.68 3.5275 21.53L9.0775 15.98C10.4175 17.08 12.1275 17.75 13.9975 17.75C18.2675 17.75 21.7475 14.27 21.7475 10C21.7475 5.73 18.2675 2.25 13.9975 2.25ZM13.9975 16.25C10.5475 16.25 7.7475 13.45 7.7475 10C7.7475 6.55 10.5475 3.75 13.9975 3.75C17.4475 3.75 20.2475 6.55 20.2475 10C20.2475 13.45 17.4475 16.25 13.9975 16.25Z"></path></svg>',"smiley-rate1-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 4.9938C4 4.44362 4.45 3.99348 5 3.99348H6.59L5.3 2.70306C4.91 2.31293 4.91 1.68272 5.3 1.2926C5.69 0.902468 6.32 0.902468 6.71 1.2926L9.71 4.29357C9.8 4.3836 9.88 4.49364 9.93 4.62368C10.03 4.86376 10.03 5.14385 9.93 5.38393C9.88 5.50397 9.81 5.614 9.71 5.71404L6.71 8.71501C6.51 8.91508 6.26 9.00511 6 9.00511C5.74 9.00511 5.49 8.90508 5.29 8.71501C4.9 8.32489 4.9 7.69468 5.29 7.30456L6.58 6.01413H4.99C4.44 6.01413 3.99 5.56399 3.99 5.01381L4 4.9938ZM14.08 5.37393C14.13 5.49397 14.2 5.604 14.3 5.70403L17.3 8.70501C17.5 8.90508 17.75 8.99511 18.01 8.99511C18.27 8.99511 18.52 8.89507 18.72 8.70501C19.11 8.31488 19.11 7.68468 18.72 7.29455L17.43 6.00413H19.02C19.57 6.00413 20.02 5.55399 20.02 5.00381C20.02 4.45363 19.57 4.00348 19.02 4.00348H17.43L18.72 2.71306C19.11 2.32293 19.11 1.69273 18.72 1.3026C18.33 0.912471 17.7 0.912471 17.31 1.3026L14.31 4.30358C14.22 4.39361 14.14 4.50364 14.09 4.63368C13.99 4.87376 13.99 5.15385 14.09 5.39393L14.08 5.37393ZM22 14.9971V20.999C22 22.6496 20.65 24 19 24H5C3.35 24 2 22.6496 2 20.999V14.9971C2 13.3465 3.35 11.9961 5 11.9961H19C20.65 11.9961 22 13.3465 22 14.9971ZM19 13.9967H16V16.9977H20V14.9971C20 14.4469 19.55 13.9967 19 13.9967ZM14 16.9977V13.9967H10V16.9977H14ZM10 18.9984V21.9993H14V18.9984H10ZM4 14.9971V16.9977H8V13.9967H5C4.45 13.9967 4 14.4469 4 14.9971ZM5 21.9993H8V18.9984H4V20.999C4 21.5492 4.45 21.9993 5 21.9993ZM20 20.999V18.9984H16V21.9993H19C19.55 21.9993 20 21.5492 20 20.999Z"></path></svg>',"smiley-rate10-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.01 23C6.85721 23 1.15412 19.9621 0.0134987 13.1669C-0.0765501 12.6272 0.293651 12.1076 0.833944 12.0177C1.38424 11.9277 1.89452 12.2975 1.98457 12.8371C2.92508 18.4732 7.69767 20.9914 12 20.9914C16.3023 20.9914 21.0749 18.4732 22.0154 12.8371C22.1055 12.2975 22.6158 11.9277 23.1661 12.0177C23.7063 12.1076 24.0765 12.6272 23.9865 13.1669C22.8559 19.9521 17.1428 23 11.99 23H12.01ZM21.165 6.15177C22.3056 5.01257 22.3056 3.16386 21.165 2.02465L21.0049 1.85477C19.9143 0.765533 18.1633 0.725561 17.0227 1.71487C15.8821 0.715568 14.1312 0.765533 13.0406 1.85477L12.8705 2.01466C11.7299 3.15386 11.7299 5.00257 12.8705 6.14178L17.0227 10.2889L21.175 6.14178L21.165 6.15177ZM15.742 3.27378L17.0127 4.54289L18.2834 3.27378C18.6436 2.91403 19.2239 2.91403 19.5841 3.27378L19.7442 3.43367C20.1044 3.79342 20.1044 4.37301 19.7442 4.73276L17.0127 7.46086L14.2812 4.73276C13.921 4.37301 13.921 3.79342 14.2812 3.43367L14.4413 3.27378C14.6214 3.09391 14.8515 3.00397 15.0917 3.00397C15.3318 3.00397 15.5619 3.09391 15.742 3.27378ZM11.1595 6.15177C12.3002 5.01257 12.3002 3.16386 11.1595 2.02465L10.9995 1.85477C9.90886 0.765533 8.15792 0.725561 7.0173 1.71487C5.87668 0.715568 4.12573 0.765533 3.03514 1.85477L2.86505 2.01466C1.72443 3.15386 1.72443 5.00257 2.86505 6.14178L7.0173 10.2889L11.1695 6.14178L11.1595 6.15177ZM5.7366 3.27378L7.00729 4.54289L8.27798 3.27378C8.63818 2.91403 9.21849 2.91403 9.57869 3.27378L9.73877 3.43367C10.099 3.79342 10.099 4.37301 9.73877 4.73276L7.00729 7.46086L4.27581 4.73276C3.91562 4.37301 3.91562 3.79342 4.27581 3.43367L4.4359 3.27378C4.61599 3.09391 4.84612 3.00397 5.08625 3.00397C5.32638 3.00397 5.5565 3.09391 5.7366 3.27378Z"></path></svg>',"smiley-rate2-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_15894_140103)"><path d="M4.88291 4.51001C4.47291 4.51001 4.08291 4.25001 3.94291 3.84001C3.76291 3.32001 4.03291 2.75001 4.55291 2.57001L8.32291 1.25001C8.84291 1.06001 9.41291 1.34001 9.59291 1.86001C9.77291 2.38001 9.50291 2.95001 8.98291 3.13001L5.20291 4.45001C5.09291 4.49001 4.98291 4.51001 4.87291 4.51001H4.88291ZM19.8129 3.89001C20.0229 3.38001 19.7729 2.79001 19.2629 2.59001L15.5529 1.07001C15.0429 0.860007 14.4529 1.11001 14.2529 1.62001C14.0429 2.13001 14.2929 2.72001 14.8029 2.92001L18.5029 4.43001C18.6229 4.48001 18.7529 4.50001 18.8829 4.50001C19.2729 4.50001 19.6529 4.27001 19.8129 3.88001V3.89001ZM3.50291 6.00001C2.64291 6.37001 1.79291 6.88001 1.00291 7.48001C0.79291 7.64001 0.64291 7.87001 0.59291 8.14001C0.48291 8.73001 0.87291 9.29001 1.45291 9.40001C2.04291 9.51001 2.60291 9.12001 2.71291 8.54001C2.87291 7.69001 3.12291 6.83001 3.50291 5.99001V6.00001ZM21.0429 8.55001C21.6029 10.48 24.2429 8.84001 22.7529 7.48001C21.9629 6.88001 21.1129 6.37001 20.2529 6.00001C20.6329 6.84001 20.8829 7.70001 21.0429 8.55001ZM21.5729 13.2C21.2529 14.2 22.5429 15.09 23.3629 14.39C23.8529 14 23.9229 13.29 23.5429 12.81C21.7429 10.67 22.1329 10.55 21.5829 13.2H21.5729ZM1.75291 11C1.22291 11.79 -0.14709 12.64 0.0129102 13.75C0.15291 14.36 0.75291 14.74 1.35291 14.6C2.98291 14.1 1.80291 12.22 1.75291 11ZM19.8829 17C19.8829 13.14 16.2929 10 11.8829 10C7.47291 10 3.88291 13.14 3.88291 17C3.88291 20.86 7.47291 24 11.8829 24C16.2929 24 19.8829 20.86 19.8829 17ZM17.8829 17C17.8829 19.76 15.1929 22 11.8829 22C8.57291 22 5.88291 19.76 5.88291 17C5.88291 14.24 8.57291 12 11.8829 12C15.1929 12 17.8829 14.24 17.8829 17Z"></path></g><defs><clipPath id="clip0_15894_140103"><rect width="24" height="24" fill="white"></rect></clipPath></defs></svg>',"smiley-rate3-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.01915 7C6.46961 7 6.01998 6.55 6.01998 6V2C6.01998 1.45 6.46961 1 7.01915 1C7.56869 1 8.01832 1.45 8.01832 2V6C8.01832 6.55 7.56869 7 7.01915 7ZM18.01 6V2C18.01 1.45 17.5604 1 17.0108 1C16.4613 1 16.0117 1.45 16.0117 2V6C16.0117 6.55 16.4613 7 17.0108 7C17.5604 7 18.01 6.55 18.01 6ZM16.4213 21.58L18.01 19.99L19.2989 21.28C19.6886 21.67 20.3181 21.67 20.7077 21.28C21.0974 20.89 21.0974 20.26 20.7077 19.87L19.4188 18.58C18.6395 17.8 17.3705 17.8 16.5912 18.58L15.0025 20.17L13.4138 18.58C12.6345 17.8 11.3655 17.8 10.5862 18.58L8.9975 20.17L7.40883 18.58C6.62948 17.8 5.36053 17.8 4.58118 18.58L3.29226 19.87C2.90258 20.26 2.90258 20.89 3.29226 21.28C3.68193 21.67 4.31141 21.67 4.70108 21.28L5.99001 19.99L7.57868 21.58C8.35803 22.36 9.62698 22.36 10.4063 21.58L11.995 19.99L13.5837 21.58C13.9734 21.97 14.4829 22.16 14.9925 22.16C15.5021 22.16 16.0117 21.97 16.4013 21.58H16.4213Z"></path></svg>',"smiley-rate4-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.06927 7C6.51927 7 6.06927 6.55 6.06927 6V2C6.06927 1.45 6.51927 1 7.06927 1C7.61927 1 8.06927 1.45 8.06927 2V6C8.06927 6.55 7.61927 7 7.06927 7ZM18.0693 6V2C18.0693 1.45 17.6193 1 17.0693 1C16.5193 1 16.0693 1.45 16.0693 2V6C16.0693 6.55 16.5193 7 17.0693 7C17.6193 7 18.0693 6.55 18.0693 6ZM22.5693 21.9C23.0693 21.66 23.2793 21.07 23.0393 20.57C21.1093 16.52 16.9093 14 12.0693 14C7.22927 14 3.02927 16.52 1.09927 20.57C0.859273 21.07 1.06927 21.67 1.56927 21.9C2.06927 22.14 2.65927 21.93 2.89927 21.43C4.49927 18.08 8.00927 16 12.0593 16C16.1093 16 19.6293 18.08 21.2193 21.43C21.3893 21.79 21.7493 22 22.1193 22C22.2593 22 22.4093 21.97 22.5493 21.9H22.5693Z"></path></svg>',"smiley-rate5-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.00572 7C6.45572 7 6.00572 6.55 6.00572 6V2C6.00572 1.45 6.45572 1 7.00572 1C7.55572 1 8.00572 1.45 8.00572 2V6C8.00572 6.55 7.55572 7 7.00572 7ZM18.0057 6V2C18.0057 1.45 17.5557 1 17.0057 1C16.4557 1 16.0057 1.45 16.0057 2V6C16.0057 6.55 16.4557 7 17.0057 7C17.5557 7 18.0057 6.55 18.0057 6ZM19.9457 21.33C20.1257 20.81 19.8557 20.24 19.3357 20.05C14.5457 18.35 9.45572 18.35 4.66572 20.05C4.14572 20.23 3.87572 20.81 4.05572 21.33C4.23572 21.85 4.80572 22.12 5.33572 21.94C9.69572 20.4 14.3057 20.4 18.6657 21.94C18.7757 21.98 18.8857 22 18.9957 22C19.4057 22 19.7957 21.74 19.9357 21.33H19.9457Z"></path></svg>',"smiley-rate6-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7 7C6.45 7 6 6.55 6 6V2C6 1.45 6.45 1 7 1C7.55 1 8 1.45 8 2V6C8 6.55 7.55 7 7 7ZM18 6V2C18 1.45 17.55 1 17 1C16.45 1 16 1.45 16 2V6C16 6.55 16.45 7 17 7C17.55 7 18 6.55 18 6ZM21 21C21 20.45 20.55 20 20 20H4C3.45 20 3 20.45 3 21C3 21.55 3.45 22 4 22H20C20.55 22 21 21.55 21 21Z"></path></svg>',"smiley-rate7-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.0022 23.99C11.452 23.99 11.0018 23.5402 11.0018 22.9904C11.0018 22.4407 11.452 21.9909 12.0022 21.9909C16.3137 21.9909 21.0755 19.472 22.0158 13.8344C22.1058 13.2947 22.616 12.9248 23.1662 13.0148C23.7064 13.1047 24.0765 13.6245 23.9865 14.1643C22.8561 20.9513 17.144 24 11.9922 24L12.0022 23.99ZM8.00072 5.99783V1.99957C8.00072 1.4498 7.55056 1 7.00036 1C6.45016 1 6 1.4498 6 1.99957V5.99783C6 6.54759 6.45016 6.99739 7.00036 6.99739C7.55056 6.99739 8.00072 6.54759 8.00072 5.99783ZM18.0043 5.99783V1.99957C18.0043 1.4498 17.5542 1 17.004 1C16.4538 1 16.0036 1.4498 16.0036 1.99957V5.99783C16.0036 6.54759 16.4538 6.99739 17.004 6.99739C17.5542 6.99739 18.0043 6.54759 18.0043 5.99783Z"></path></svg>',"smiley-rate8-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.01 24C6.85721 24 1.15412 20.96 0.0134987 14.16C-0.0765501 13.62 0.293651 13.1 0.833944 13.01C1.38424 12.92 1.89452 13.29 1.98457 13.83C2.92508 19.47 7.69767 21.99 12 21.99C16.3023 21.99 21.0749 19.47 22.0154 13.83C22.1055 13.29 22.6158 12.92 23.1661 13.01C23.7063 13.1 24.0765 13.62 23.9865 14.16C22.8559 20.95 17.1428 24 11.99 24H12.01ZM8.00783 6V2C8.00783 1.45 7.55759 1 7.00729 1C6.45699 1 6.00675 1.45 6.00675 2V6C6.00675 6.55 6.45699 7 7.00729 7C7.55759 7 8.00783 6.55 8.00783 6ZM18.0133 6V2C18.0133 1.45 17.563 1 17.0127 1C16.4624 1 16.0122 1.45 16.0122 2V6C16.0122 6.55 16.4624 7 17.0127 7C17.563 7 18.0133 6.55 18.0133 6Z"></path></svg>',"smiley-rate9-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.01 24C6.85767 24 1.15509 20.96 0.0145752 14.16C-0.0354475 13.87 0.0445888 13.57 0.234675 13.35C0.424761 13.13 0.704888 13 0.995019 13H23.005C23.2951 13 23.5752 13.13 23.7653 13.35C23.9554 13.57 24.0354 13.87 23.9854 14.16C22.8549 20.95 17.1423 24 11.99 24H12.01ZM2.25559 15C3.61621 19.82 8.0182 22 12.01 22C16.0018 22 20.4038 19.82 21.7644 15H2.25559ZM8.00819 6V2C8.00819 1.45 7.55799 1 7.00774 1C6.45749 1 6.00729 1.45 6.00729 2V6C6.00729 6.55 6.45749 7 7.00774 7C7.55799 7 8.00819 6.55 8.00819 6ZM18.0127 6V2C18.0127 1.45 17.5625 1 17.0123 1C16.462 1 16.0118 1.45 16.0118 2V6C16.0118 6.55 16.462 7 17.0123 7C17.5625 7 18.0127 6.55 18.0127 6Z"></path></svg>'};let Ah=class extends Ge{constructor(e){super(e),this.rootRef=ct(),this.model=new MS,this.model.onInnerHeightChanged=t=>{this.props.onInnerHeightChanged&&this.props.onInnerHeightChanged(t)}}componentDidMount(){const e=this.rootRef.current;e&&this.model.setRootElement(e)}componentWillUnmount(){this.model.unsubscribeRootElement(),this.model.setRootElement(void 0)}render(){return this.props.disabled?y(Me,null,this.props.children):y("div",{ref:this.rootRef,className:"sv-scroll__wrapper"},y("div",{className:"sv-scroll__scroller sv-drag-target-skipped",onScroll:()=>this.model.onScrollContainer()},y("div",{className:"sv-scroll__container"},this.props.children)),y("div",{className:"sv-scroll__scrollbar",onScroll:()=>this.model.onScrollScrollbar()},y("div",{className:"sv-scroll__scrollbar-sizer"})))}};ee.Instance.registerElement("svc-scroll",n=>y(Ah,n)),vh("v1",CI),vh("v2",pC),So.registerIcons(pC);let Dh=class extends Se{constructor(e){super(e),this.previousJSON={},this.isSurveyUpdated=!1,this.createSurvey(e),this.updateSurvey(e,{}),this.rootRef=ct(),this.rootNodeId=e.id||null,this.rootNodeClassName=e.className||""}getStateElement(){return this.survey}onSurveyUpdated(){if(this.survey){const e=this.rootRef.current;e&&this.survey.afterRenderSurvey(e),this.survey.startTimerFromUI(),this.setSurveyEvents()}}shouldComponentUpdate(e,t){return super.shouldComponentUpdate(e,t)?(this.isModelJSONChanged(e)&&(this.destroySurvey(),this.createSurvey(e),this.updateSurvey(e,{}),this.isSurveyUpdated=!0),!0):!1}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.updateSurvey(this.props,e),this.isSurveyUpdated&&(this.onSurveyUpdated(),this.isSurveyUpdated=!1)}componentDidMount(){super.componentDidMount(),this.onSurveyUpdated()}destroySurvey(){this.survey&&(this.survey.renderCallback=void 0,this.survey.onPartialSend.clear(),this.survey.stopTimer(),this.survey.destroyResizeObserver())}componentWillUnmount(){super.componentWillUnmount(),this.destroySurvey()}doRender(){let e;this.survey.state=="completed"?e=this.renderCompleted():this.survey.state=="completedbefore"?e=this.renderCompletedBefore():this.survey.state=="loading"?e=this.renderLoading():this.survey.state=="empty"?e=this.renderEmptySurvey():e=this.renderSurvey();const t=this.survey.backgroundImage?y("div",{className:this.css.rootBackgroundImage,style:this.survey.backgroundImageStyle}):null,s=this.survey.headerView==="basic"?y(hC,{survey:this.survey}):null,i=function(l){l.preventDefault()};let r=y("div",{className:"sv_custom_header"});this.survey.hasLogo&&(r=null);const a=this.survey.getRootCss(),o=this.rootNodeClassName?this.rootNodeClassName+" "+a:a;return y("div",{id:this.rootNodeId,ref:this.rootRef,className:o,style:this.survey.themeVariables,lang:this.survey.locale||"en",dir:this.survey.localeDir},y(Ah,{disabled:this.survey.rootScrollDisabled},this.survey.needRenderIcons?y(vI,null):null,y(cC,null),y("div",{className:this.survey.wrapperFormCss},t,y("form",{onSubmit:i},y(Ah,{disabled:this.survey.formScrollDisabled},r,y("div",{className:this.css.container},s,y(di,{survey:this.survey,container:"header",needRenderWrapper:!1}),e,y(di,{survey:this.survey,container:"footer",needRenderWrapper:!1})))),y(dC,{notifier:this.survey.notifier}))))}renderElement(){return this.doRender()}get css(){return this.survey.css}set css(e){this.survey.css=e}renderCompleted(){if(!this.survey.showCompletedPage)return null;var e={__html:this.survey.processedCompletedHtml};return y(Me,null,y("div",{dangerouslySetInnerHTML:e,className:this.survey.completedCss}),y(di,{survey:this.survey,container:"completePage",needRenderWrapper:!1}))}renderCompletedBefore(){var e={__html:this.survey.processedCompletedBeforeHtml};return y("div",{dangerouslySetInnerHTML:e,className:this.survey.completedBeforeCss})}renderLoading(){var e={__html:this.survey.processedLoadingHtml};return y("div",{dangerouslySetInnerHTML:e,className:this.survey.loadingBodyCss})}renderSurvey(){var e=this.survey.activePage?this.renderPage(this.survey.activePage):null;this.survey.isShowStartingPage;var t=this.survey.activePage?this.survey.activePage.id:"";let s=this.survey.bodyCss;const i={};return this.survey.renderedWidth&&(i.maxWidth=this.survey.renderedWidth),y("div",{className:this.survey.bodyContainerCss},y(di,{survey:this.survey,container:"left"}),y("div",{className:"sv-components-column sv-components-column--expandable"},y(di,{survey:this.survey,container:"center"}),y("div",{id:t,className:s,style:i},y(di,{survey:this.survey,container:"contentTop"}),e,y(di,{survey:this.survey,container:"contentBottom"}),this.survey.showBrandInfo?y(yI,null):null)),y(di,{survey:this.survey,container:"right"}))}renderPage(e){return ee.Instance.createElement(this.survey.pageComponent||"sv-page",{survey:this.survey,page:e,css:this.css,creator:this})}renderEmptySurvey(){return y("div",{className:this.css.bodyEmpty},this.survey.emptySurveyText)}createSurvey(e){e||(e={}),this.previousJSON={},e?e.model?this.survey=e.model:e.json&&(this.previousJSON=e.json,this.survey=new Ee(e.json)):this.survey=new Ee,e.css&&(this.survey.css=this.css)}isModelJSONChanged(e){return e.model?this.survey!==e.model:e.json?!O.isTwoValueEquals(e.json,this.previousJSON):!1}updateSurvey(e,t){if(e){t=t||{};for(var s in e)if(!(s=="model"||s=="children"||s=="json")){if(s=="css"){this.survey.mergeValues(e.css,this.survey.getCss()),this.survey.updateNavigationCss(),this.survey.updateElementCss();continue}e[s]!==t[s]&&(s.indexOf("on")==0&&this.survey[s]&&this.survey[s].add?(t[s]&&this.survey[s].remove(t[s]),this.survey[s].add(e[s])):this.survey[s]=e[s])}}}setSurveyEvents(){var e=this;this.survey.renderCallback=function(){var t=e.state&&e.state.modelChanged?e.state.modelChanged:0;e.setState({modelChanged:t+1})},this.survey.onPartialSend.add(t=>{e.state&&e.setState(e.state)})}createQuestionElement(e){return Fe.Instance.createQuestion(e.isDefaultRendering()?e.getTemplate():e.getComponentName(),{question:e,isDisplayMode:e.isInputReadOnly,creator:this})}renderError(e,t,s,i){return ee.Instance.createElement(this.survey.questionErrorComponent,{key:e,error:t,cssClasses:s,element:i})}questionTitleLocation(){return this.survey.questionTitleLocation}questionErrorLocation(){return this.survey.questionErrorLocation}};ee.Instance.registerElement("survey",n=>y(Dh,n));function Oh(n,e,t={processEsc:!0,disableTabStop:!1}){return e&&e.disableTabStop||t&&t.disableTabStop?nC(n,{tabIndex:-1}):(t=Object.assign({},t),nC(n,{tabIndex:0,onKeyUp:s=>(s.preventDefault(),s.stopPropagation(),ju(s,t),!1),onKeyDown:s=>Y2(s,t),onBlur:s=>Cy(s)}))}let Mh=class extends Ge{constructor(e){super(e),this.updateStateFunction=null,this.state={update:0}}get survey(){return this.props.survey}get css(){return this.props.css||this.survey.css}componentDidMount(){if(this.survey){var e=this;this.updateStateFunction=function(){e.setState({update:e.state.update+1})},this.survey.onPageVisibleChanged.add(this.updateStateFunction)}}componentWillUnmount(){this.survey&&this.updateStateFunction&&(this.survey.onPageVisibleChanged.remove(this.updateStateFunction),this.updateStateFunction=null)}},bI=class extends ot{constructor(e){super(e),this.circleLength=440}getStateElement(){return this.timerModel}get timerModel(){return this.props.model}get progress(){return-this.timerModel.progress*this.circleLength}render(){if(!this.timerModel.isRunning)return null;let e=y("div",{className:this.timerModel.survey.getCss().timerRoot},this.timerModel.text);if(this.timerModel.showTimerAsClock){let t={strokeDasharray:this.circleLength,strokeDashoffset:this.progress};const s=this.timerModel.showProgress?y(Be,{className:this.timerModel.getProgressCss(),style:t,iconName:"icon-timercircle",size:"auto"}):null;e=y("div",{className:this.timerModel.rootCss},s,y("div",{className:this.timerModel.textContainerCss},y("span",{className:this.timerModel.majorTextCss},this.timerModel.clockMajorText),this.timerModel.clockMinorText?y("span",{className:this.timerModel.minorTextCss},this.timerModel.clockMinorText):null))}return e}};ee.Instance.registerElement("sv-timerpanel",n=>y(bI,n));let wI=class extends Se{constructor(e){super(e),this.element.cssClasses,this.rootRef=ct()}getStateElement(){return this.element}get element(){return this.props.element}get index(){return this.props.index}get row(){return this.props.row}get survey(){return this.props.survey}get creator(){return this.props.creator}get css(){return this.props.css}componentDidMount(){super.componentDidMount(),this.rootRef.current&&this.element.setWrapperElement(this.rootRef.current)}componentWillUnmount(){super.componentWillUnmount(),this.element.setWrapperElement(void 0)}shouldComponentUpdate(e,t){return super.shouldComponentUpdate(e,t)?(e.element!==this.element&&(e.element&&e.element.setWrapperElement(this.rootRef.current),this.element&&this.element.setWrapperElement(void 0)),this.element.cssClasses,!0):!1}renderElement(){const e=this.element,t=this.createElement(e,this.index),s=e.cssClassesValue,i=()=>{const r=e;r&&r.isQuestion&&r.focusIn()};return y("div",{className:s.questionWrapper,style:e.rootStyle,"data-key":e.name+this.index,onFocus:i,ref:this.rootRef},t)}createElement(e,t){if(!this.row.isNeedRender)return ee.Instance.createElement(e.skeletonComponentName,{element:e,css:this.css});let s=e.getTemplate();return ee.Instance.isElementRegistered(s)||(s="question"),ee.Instance.createElement(s,{element:e,creator:this.creator,survey:this.survey,css:this.css})}},xI=class extends Se{constructor(e){super(e),this.rootRef=ct(),this.recalculateCss()}recalculateCss(){this.row.visibleElements.map(e=>e.cssClasses)}getStateElement(){return this.row}get row(){return this.props.row}get survey(){return this.props.survey}get creator(){return this.props.creator}get css(){return this.props.css}canRender(){return!!this.row&&!!this.survey&&!!this.creator}renderElementContent(){const e=this.row.visibleElements.map((t,s)=>y(wI,{element:t,index:s,row:this.row,survey:this.survey,creator:this.creator,css:this.css,key:t.id}));return y("div",{ref:this.rootRef,className:this.row.getRowCss()},e)}renderElement(){const e=this.survey,t=this.renderElementContent();return $s.wrapRow(e,t,this.row)||t}componentDidMount(){super.componentDidMount();var e=this.rootRef.current;if(this.rootRef.current&&this.row.setRootElement(this.rootRef.current),e&&!this.row.isNeedRender){var t=e;this.lazyRenderingTimeout=setTimeout(()=>{this.row.startLazyRendering(t)},10)}}shouldComponentUpdate(e,t){return super.shouldComponentUpdate(e,t)?(e.row!==this.row&&(e.row.isNeedRender=this.row.isNeedRender,e.row.setRootElement(this.rootRef.current),this.row.setRootElement(void 0),this.stopLazyRendering()),this.recalculateCss(),!0):!1}stopLazyRendering(){clearTimeout(this.lazyRenderingTimeout),this.row.stopLazyRendering(),this.row.isNeedRender=!this.row.isLazyRendering()}componentWillUnmount(){super.componentWillUnmount(),this.row&&(this.row.setRootElement(void 0),this.stopLazyRendering())}createElement(e,t){const s=t?"-"+t:0;var i=e.getType();return ee.Instance.isElementRegistered(i)||(i="question"),ee.Instance.createElement(i,{key:e.name+s,element:e,creator:this.creator,survey:this.survey,css:this.css})}},gC=class extends Se{constructor(e){super(e),this.rootRef=ct()}getStateElement(){return this.panelBase}canUsePropInState(e){return e!=="elements"&&super.canUsePropInState(e)}get survey(){return this.getSurvey()}get creator(){return this.props.creator}get css(){return this.getCss()}get panelBase(){return this.getPanelBase()}getPanelBase(){return this.props.element||this.props.question}getSurvey(){return this.props.survey||(this.panelBase?this.panelBase.survey:null)}getCss(){return this.props.css}componentDidMount(){super.componentDidMount(),this.doAfterRender()}componentWillUnmount(){super.componentWillUnmount();var e=this.rootRef.current;e&&e.removeAttribute("data-rendered")}componentDidUpdate(e,t){super.componentDidUpdate(e,t),!(e.page&&this.survey&&this.survey.activePage&&e.page.id===this.survey.activePage.id)&&this.doAfterRender()}doAfterRender(){var e=this.rootRef.current;e&&this.survey&&(this.panelBase.isPanel?this.panelBase.afterRender(e):this.survey.afterRenderPage(e))}getIsVisible(){return this.panelBase.isVisible}canRender(){return super.canRender()&&!!this.survey&&!!this.panelBase&&!!this.panelBase.survey&&this.getIsVisible()}renderRows(e){return this.panelBase.visibleRows.map(t=>this.createRow(t,e))}createRow(e,t){return y(xI,{key:e.id,row:e,survey:this.survey,creator:this.creator,css:t})}},kh=class extends Se{getStateElement(){return this.props.counter}renderElement(){return y("div",{className:this.props.remainingCharacterCounter},this.props.counter.remainingCharacterCounter)}};ee.Instance.registerElement("sv-character-counter",n=>y(kh,n));let Nh=class extends Se{constructor(e){super(e),this.initialValue=this.viewModel.getTextValue()||"",this.textareaRef=ct()}get viewModel(){return this.props.viewModel}canRender(){return!!this.viewModel.question}componentDidMount(){super.componentDidMount();let e=this.textareaRef.current;e&&this.viewModel.setElement(e)}componentWillUnmount(){super.componentWillUnmount(),this.viewModel.resetElement()}renderElement(){return y("textarea",{id:this.viewModel.id,className:this.viewModel.className,ref:this.textareaRef,disabled:this.viewModel.isDisabledAttr,readOnly:this.viewModel.isReadOnlyAttr,rows:this.viewModel.rows,cols:this.viewModel.cols,placeholder:this.viewModel.placeholder,maxLength:this.viewModel.maxLength,defaultValue:this.initialValue,onChange:e=>{this.viewModel.onTextAreaInput(e)},onFocus:e=>{this.viewModel.onTextAreaFocus(e)},onBlur:e=>{this.viewModel.onTextAreaBlur(e)},onKeyDown:e=>{this.viewModel.onTextAreaKeyDown(e)},"aria-required":this.viewModel.ariaRequired,"aria-label":this.viewModel.ariaLabel,"aria-labelledby":this.viewModel.ariaLabelledBy,"aria-describedby":this.viewModel.ariaDescribedBy,"aria-invalid":this.viewModel.ariaInvalid,"aria-errormessage":this.viewModel.ariaErrormessage,style:{resize:this.viewModel.question.resizeStyle}})}};ee.Instance.registerElement("sv-text-area",n=>y(Nh,n));let VI=class extends gn{renderCharacterCounter(){let e=null;return this.question.getMaxLength()&&(e=y(kh,{counter:this.question.characterCounter,remainingCharacterCounter:this.question.cssClasses.remainingCharacterCounter})),e}constructor(e){super(e)}renderElement(){if(this.question.isReadOnlyRenderDiv())return y("div",null,this.question.value);const e=this.renderCharacterCounter(),t=this.props.question.textAreaModel;return y(Me,null,y(Nh,{viewModel:t}),e)}},mC=class extends ot{constructor(e){super(e),this.textAreaModel=this.getTextAreaModel()}canRender(){return!!this.props.question}getTextAreaModel(){return this.props.question.commentTextAreaModel}renderElement(){if(this.props.question.isReadOnlyRenderDiv()){const t=this.textAreaModel.getTextValue()||"";return y("div",null,t)}return y(Nh,{key:this.getKey(),viewModel:this.textAreaModel})}getKey(){}},qh=class extends mC{constructor(e){super(e)}getTextAreaModel(){return this.props.question.getCommentTextAreaModel(this.props.item)}getKey(){return this.props.item.uniqueId}};Fe.Instance.registerQuestion("comment",n=>y(VI,n));let PI=class extends St{constructor(e){super(e),this.widgetRef=ct()}_afterRender(){if(this.questionBase.customWidget){let e=this.widgetRef.current;e&&(this.questionBase.customWidget.afterRender(this.questionBase,e),this.questionBase.customWidgetData.isNeedRender=!1)}}componentDidMount(){super.componentDidMount(),this.questionBase&&this._afterRender()}componentDidUpdate(e,t){super.componentDidUpdate(e,t);var s=!!this.questionBase.customWidget&&this.questionBase.customWidget.isDefaultRender;this.questionBase&&!s&&this._afterRender()}componentWillUnmount(){if(super.componentWillUnmount(),this.questionBase.customWidget){let e=this.widgetRef.current;e&&this.questionBase.customWidget.willUnmount(this.questionBase,e)}}canRender(){return super.canRender()&&this.questionBase.visible}renderElement(){let e=this.questionBase.customWidget;if(e.isDefaultRender)return y("div",{ref:this.widgetRef},this.creator.createQuestionElement(this.questionBase));let t=null;if(e.widgetJson.render)t=e.widgetJson.render(this.questionBase);else if(e.htmlTemplate){let s={__html:e.htmlTemplate};return y("div",{ref:this.widgetRef,dangerouslySetInnerHTML:s})}return y("div",{ref:this.widgetRef},t)}},fC=class extends Se{get element(){return this.props.element}getRenderedElements(){return[this.element]}renderElement(){const e=this.element,t=e.hasTitle?y(Rr,{element:e}):null,s=e.hasDescriptionUnderTitle?Se.renderQuestionDescription(this.element):null,i=e.hasAdditionalTitleToolbar?y(bs,{model:e.additionalTitleToolbar}):null,r={width:void 0};return e instanceof Dt&&(r.width=e.titleWidth),y("div",{className:e.cssHeader,onClick:a=>e.clickTitleFunction&&e.clickTitleFunction(a.nativeEvent),style:r},t,s,i)}},yC=class extends ot{constructor(e){super(e)}get css(){return this.props.css}get summary(){return this.props.summary}renderElement(){return this.summary?this.summary.isEmpty()?this.renderNoItems():this.renderItems():null}renderItems(){return y("div",{className:this.css.summary},this.summary.items.map((e,t)=>this.renderItem(e,t)))}renderNoItems(){const e=this.summary.question;return ee.Instance.createElement("sv-placeholder-"+e.getTemplate(),{cssClasses:this.css,question:e})||y("div",null,this.renderLocString(this.summary.noEntry))}renderItem(e,t){const s=e.btnEdit?y("button",{className:this.css.summaryRowActionEdit,onClick:()=>e.btnEdit.action(),title:e.btnEdit.title},y(Be,{iconName:"icon-editsmall-16x16",iconSize:"auto"})):null,i=e.showRemove&&e.btnRemove?y("button",{className:this.css.summaryRowActionDelete,onClick:()=>e.btnRemove.action(),title:e.btnRemove.title},y(Be,{iconName:"icon-delete-16x16",iconSize:"auto"})):null;return y("div",{className:this.css.summaryRow,key:t},y("div",{className:this.css.summaryRowContent},this.renderLocString(e.locText)),y("div",{className:this.css.summaryRowActions},s,i))}};ee.Instance.registerElement("sv-singleinput-summary",n=>y(yC,n));let vC=class extends Se{constructor(e){super(e)}getStateElement(){return this.props.model}get items(){return this.props.model.actions}get css(){return this.props.css}renderElement(){if(!this.items||!this.items.length)return null;const e=this.renderItems();return y("div",{className:this.css.breadcrumbsRoot},e)}renderItems(){const e=[];return this.items.concat([]).forEach((t,s)=>{s&&e.push(y(Be,{key:t.renderedId+"_separator",className:this.css.breadcrumbsSeparator,iconName:"arrowright-16x16",size:"auto"})),e.push(y(mn,{key:t.renderedId,item:t}))}),e}};ee.Instance.registerElement("sv-breadcrumbs",n=>y(vC,n));let yn=class Pf extends Se{static renderQuestionBody(e,t){var s=t.customWidget;return s?y(PI,{creator:e,question:t}):e.createQuestionElement(t)}constructor(e){super(e),this.isNeedFocus=!1,this.rootRef=ct()}getStateElement(){return this.question}get question(){return this.props.element}get creator(){return this.props.creator}componentDidMount(){super.componentDidMount(),this.question&&(this.question.react=this),this.doAfterRender()}componentWillUnmount(){super.componentWillUnmount(),this.question&&(this.question.react=null);const e=this.rootRef.current;e&&e.removeAttribute("data-rendered")}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.doAfterRender()}doAfterRender(){if(this.isNeedFocus&&(this.question.isCollapsed||this.question.clickTitleFunction(),this.isNeedFocus=!1),this.question){var e=this.rootRef.current;e&&e.getAttribute("data-rendered")!=="r"&&(e.setAttribute("data-rendered","r"),this.question.afterRender&&this.question.afterRender(e))}}canRender(){return super.canRender()&&!!this.question&&!!this.creator}renderQuestionContent(){let e=this.question;var t={display:this.question.renderedIsExpanded?"":"none"},s=e.cssClasses,i=this.renderQuestion(),r=e&&e.hasComment?this.renderComment(s):null,a=e.hasDescriptionUnderInput?this.renderDescription():null;return y("div",{className:e.cssContent||void 0,style:t,"aria-hidden":e.contentAriaHidden,role:"presentation","data-sv-drop-target-matrix":this.question.dragDropMatrixAttribute,"data-sv-drop-target-matrix-row":this.question.dragDropMatrixAttribute},i,r,a)}renderElement(){var e=this.question,t=e.cssClasses,s=this.renderHeader(e),i=e.hasTitleOnLeftTop?s:null,r=e.hasTitleOnBottom?s:null;const a=this.question.showErrorsAboveQuestion?this.renderErrors(t,""):null,o=this.question.showErrorsBelowQuestion?this.renderErrors(t,""):null,l=e.getRootStyle(),u=e.singleInputHasActions?this.renderSingleInputBreadcrumbs(e,t):void 0,f=(e.singleInputSummary?this.renderSingleInputSummary(e,t):void 0)||(e.singleInputQuestion?this.renderSingleInputQuestion(e,t):void 0)||this.wrapQuestionContent(this.renderQuestionContent());return y(Me,null,y("div",{ref:this.rootRef,id:e.id,className:e.getRootCss(),style:l,"data-name":e.name,role:e.ariaRole,"aria-required":this.question.ariaRequired,"aria-invalid":this.question.ariaInvalid,"aria-label":this.question.ariaLabel,"aria-labelledby":e.ariaLabelledBy,"aria-describedby":e.ariaDescribedBy,"aria-expanded":e.ariaExpanded},u,a,i,f,r,o))}renderSingleInputQuestion(e,t){const s=e.singleInputQuestion,i=s.id;return y(Pf,{key:i,element:s,creator:this.creator,css:t})}renderSingleInputBreadcrumbs(e,t){return y(vC,{model:e.singleInputActions,css:t})}renderSingleInputSummary(e,t){return y(yC,{summary:e.singleInputSummary,creator:this.creator,css:t})}wrapElement(e){const t=this.question.survey;let s=null;return t&&(s=$s.wrapElement(t,e,this.question)),s??e}wrapQuestionContent(e){const t=this.question.survey;let s=null;return t&&(s=$s.wrapQuestionContent(t,e,this.question)),s??e}renderQuestion(){return Pf.renderQuestionBody(this.creator,this.question)}renderDescription(){return Se.renderQuestionDescription(this.question)}renderComment(e){const t=Se.renderLocString(this.question.locCommentText);return y("div",{className:this.question.getCommentAreaCss()},y("div",null,t),y(mC,{question:this.question,cssClasses:e,isDisplayMode:this.question.isInputReadOnly}))}renderHeader(e){return y(fC,{element:e})}renderErrors(e,t){return y(Lo,{element:this.question,cssClasses:e,creator:this.creator,location:t,id:this.question.id+"_errors"})}};ee.Instance.registerElement("question",n=>y(yn,n));let Lo=class extends ot{constructor(e){super(e),this.state=this.getState()}get id(){return this.props.element.id+"_errors"}get element(){return this.props.element}get creator(){return this.props.creator}getState(e=null){return e?{error:e.error+1}:{error:0}}canRender(){return!!this.element&&this.element.hasVisibleErrors}componentWillUnmount(){}renderElement(){const e=[];for(let t=0;t<this.element.renderedErrors.length;t++){const s="error"+t;e.push(this.creator.renderError(s,this.element.renderedErrors[t],this.cssClasses,this.element))}return y("div",{className:this.element.cssError,id:this.id},e)}},CC=class extends ot{constructor(e){super(e)}getStateElement(){return this.question}get question(){return this.getQuestion()}get creator(){return this.props.creator}getQuestion(){return this.props.question}get itemCss(){return this.props.itemCss}componentDidMount(){super.componentDidMount(),this.doAfterRender()}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.doAfterRender()}doAfterRender(){}canRender(){return!!this.question}renderContent(){var e=this.renderQuestion();return y(Me,null,e)}getShowErrors(){return this.question.isVisible}renderQuestion(){return yn.renderQuestionBody(this.creator,this.question)}},SI=class extends CC{constructor(e){super(e),this.cellRef=ct()}componentWillUnmount(){if(super.componentWillUnmount(),this.question){var e=this.cellRef.current;e&&e.removeAttribute("data-rendered")}}renderCellContent(){return y("div",{className:this.props.cell.cellQuestionWrapperClassName},this.renderQuestion())}renderElement(){var e=this.getCellStyle();const t=this.props.cell,s=()=>{t.focusIn()};return y("td",{ref:this.cellRef,className:this.itemCss,colSpan:t.colSpans,title:t.getTitle(),style:e,onFocus:s},this.wrapCell(this.props.cell,this.renderCellContent()))}getCellStyle(){return null}getHeaderText(){return""}wrapCell(e,t){if(!e)return t;const s=this.question.survey;let i=null;return s&&(i=$s.wrapMatrixCell(s,t,e,this.props.reason)),i??t}},bC=class extends Ge{constructor(e){super(e),this.state={changed:0},this.question&&this.registerCallback(this.question)}get question(){return this.props.question}update(){this.setState({changed:this.state.changed+1})}getQuestionPropertiesToTrack(){return["errors"]}registerCallback(e){e.registerFunctionOnPropertiesValueChanged(this.getQuestionPropertiesToTrack(),()=>{this.update()},"__reactSubscription")}unRegisterCallback(e){e.unRegisterFunctionOnPropertiesValueChanged(this.getQuestionPropertiesToTrack(),"__reactSubscription")}componentDidUpdate(e){e.question&&e.question!==this.question&&this.unRegisterCallback(e.cell),this.question&&this.registerCallback(this.question)}componentWillUnmount(){this.question&&this.unRegisterCallback(this.question)}render(){return y(Lo,{element:this.question,creator:this.props.creator,cssClasses:this.question.cssClasses})}},II=class extends gC{constructor(e){super(e)}getPanelBase(){return this.props.page}get page(){return this.panelBase}renderElement(){var e=this.renderTitle(),t=this.renderDescription(),s=this.renderRows(this.panelBase.cssClasses);const i=y(Lo,{element:this.panelBase,cssClasses:this.panelBase.cssClasses,creator:this.creator});return y("div",{ref:this.rootRef,className:this.page.cssRoot},e,t,i,s)}renderTitle(){return y(Rr,{element:this.page})}renderDescription(){if(!this.page._showDescription)return null;var e=Se.renderLocString(this.page.locDescription);return y("div",{className:this.panelBase.cssClasses.page.description},e)}};ee.Instance.registerElement("sv-page",n=>y(II,n));let _r=class extends gC{constructor(e){super(e),this.hasBeenExpanded=!1}get panel(){return this.panelBase}renderElement(){const e=this.renderHeader(),t=y(Lo,{element:this.panelBase,cssClasses:this.panelBase.cssClasses,creator:this.creator}),s={paddingLeft:this.panel.innerPaddingLeft,display:this.panel.renderedIsExpanded?void 0:"none"};let i=null;if(this.panel.renderedIsExpanded){const a=this.renderRows(this.panelBase.cssClasses),o=this.panelBase.cssClasses.panel.content;i=this.renderContent(s,a,o)}const r=()=>{this.panelBase&&this.panelBase.focusIn()};return y("div",{ref:this.rootRef,className:this.panelBase.getContainerCss(),onFocus:r,id:this.panelBase.id},this.panel.showErrorsAbovePanel?t:null,e,this.panel.showErrorsAbovePanel?null:t,i)}renderHeader(){return!this.panel.hasTitle&&!this.panel.hasDescription?null:y(fC,{element:this.panel})}wrapElement(e){const t=this.panel.survey;let s=null;return t&&(s=$s.wrapElement(t,e,this.panel)),s??e}renderContent(e,t,s){const i=this.renderBottom();return y("div",{style:e,className:s,id:this.panel.contentId,role:this.panel.ariaRole,"aria-labelledby":this.panel.ariaLabelledBy,"aria-label":this.panel.ariaLabel},t,i)}renderTitle(){return this.panelBase.title?y(Rr,{element:this.panelBase}):null}renderDescription(){if(!this.panelBase.description)return null;var e=Se.renderLocString(this.panelBase.locDescription);return y("div",{className:this.panel.cssClasses.panel.description},e)}renderBottom(){const e=this.panel.getFooterToolbar();return e.hasActions?y(bs,{model:e}):null}getIsVisible(){return this.panelBase.getIsContentVisible()}};ee.Instance.registerElement("panel",n=>y(_r,n));let TI=class extends _r{constructor(e){super(e)}get flowPanel(){return this.panel}componentDidMount(){super.componentDidMount(),this.flowPanel&&(this.flowPanel.onCustomHtmlProducing=function(){return""},this.flowPanel.onGetHtmlForQuestion=this.renderQuestion)}componentWillUnmount(){super.componentWillUnmount(),this.flowPanel&&(this.flowPanel.onCustomHtmlProducing=null,this.flowPanel.onGetHtmlForQuestion=null)}getQuestion(e){return this.flowPanel.getQuestionByName(e)}renderQuestion(e){return"<question>"+e.name+"</question>"}renderRows(){const e=this.renderHtml();return e?[e]:[]}getNodeIndex(){return this.renderedIndex++}renderHtml(){if(!this.flowPanel)return null;const e="<span>"+this.flowPanel.produceHtml()+"</span>";if(!DOMParser)return y("div",{dangerouslySetInnerHTML:{__html:e}});const t=new DOMParser().parseFromString(e,"text/xml");return this.renderedIndex=0,this.renderParentNode(t)}renderNodes(e){const t=[];for(let s=0;s<e.length;s++){const i=this.renderNode(e[s]);i&&t.push(i)}return t}getStyle(e){const t={};return e.toLowerCase()==="b"&&(t.fontWeight="bold"),e.toLowerCase()==="i"&&(t.fontStyle="italic"),e.toLowerCase()==="u"&&(t.textDecoration="underline"),t}renderParentNode(e){const t=e.nodeName.toLowerCase(),s=this.renderNodes(this.getChildDomNodes(e));return t==="div"?y("div",{key:this.getNodeIndex()},s):y("span",{key:this.getNodeIndex(),style:this.getStyle(t)},s)}renderNode(e){if(!this.hasTextChildNodesOnly(e))return this.renderParentNode(e);const t=e.nodeName.toLowerCase();if(t==="question"){const s=this.flowPanel.getQuestionByName(e.textContent);if(!s)return null;const i=y(yn,{key:s.name,element:s,creator:this.creator,css:this.css});return y("span",{key:this.getNodeIndex()},i)}return t==="div"?y("div",{key:this.getNodeIndex()},e.textContent):y("span",{key:this.getNodeIndex(),style:this.getStyle(t)},e.textContent)}getChildDomNodes(e){const t=[];for(let s=0;s<e.childNodes.length;s++)t.push(e.childNodes[s]);return t}hasTextChildNodesOnly(e){const t=e.childNodes;for(let s=0;s<t.length;s++)if(t[s].nodeName.toLowerCase()!=="#text")return!1;return!0}renderContent(e,t){return y("f-panel",{style:e},t)}};ee.Instance.registerElement("flowpanel",n=>y(TI,n));let wC=class extends St{constructor(e){super(e)}get question(){return this.questionBase}renderElement(){var e=this.question.cssClasses;return y("fieldset",{className:this.question.getSelectBaseRootCss(),ref:t=>this.setControl(t),role:this.question.a11y_input_ariaRole,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-labelledby":this.question.a11y_input_ariaLabelledBy,"aria-describedby":this.question.a11y_input_ariaDescribedBy,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage},this.renderHeader(),this.question.hasColumns?this.getColumnedBody(e):this.getBody(e),this.getFooter())}renderHeader(){return null}getFooter(){if(this.question.hasFootItems){const e=this.question.footItems.map((t,s)=>this.renderItem(t,!1,this.question.cssClasses));return y(Me,null,e)}return null}getStateValue(){}isItemChecked(e,t){return!1}getColumnedBody(e){return y("div",{className:e.rootMultiColumn},this.getColumns(e))}getColumns(e){const t=this.getStateValue();return this.question.columns.map((s,i)=>{var r=s.map((a,o)=>this.renderItem(a,i===0&&o===0,e,""+i+o,this.isItemChecked(a,t)));return y("div",{key:"column"+i+this.question.getItemsColumnKey(s),className:this.question.getColumnClass(),role:"presentation"},r)})}getBody(e){return this.question.blockedRow?y("div",{className:e.rootRow},this.getItems(e,this.question.dataChoices)):y(Me,null,this.getItems(e,this.question.bodyItems))}getItems(e,t){const s=[],i=this.getStateValue();for(let r=0;r<t.length;r++){const a=t[r],o=this.renderItem(a,r==0,e,""+r,this.isItemChecked(a,i));o&&s.push(o)}return s}get textStyle(){return null}renderItem(e,t,s,i,r){const a=ee.Instance.createElement(this.question.itemComponent,{key:e.uniqueId,question:this.question,cssClasses:s,isDisplayMode:this.isDisplayMode,item:e,textStyle:this.textStyle,index:i,isFirst:t,isChecked:r,creator:this.props.creator}),o=this.question.survey;let l=null;return o&&a&&(l=$s.wrapItemValue(o,a,this.question,e)),l??a}},xC=class extends ot{constructor(e){super(e),this.handleOnChange=t=>{this.doOnItemChange(t)},this.rootRef=ct()}getStateElement(){return this.item}get question(){return this.props.question}get item(){return this.props.item}get textStyle(){return this.props.textStyle}get isFirst(){return this.props.isFirst}get index(){return this.props.index}get hideCaption(){return this.props.hideCaption===!0}get ariaLabel(){return this.props.ariaLabel||null}componentDidUpdate(e,t){super.componentDidUpdate(e,t),e.item!==this.props.item&&!this.question.isDesignMode&&(this.props.item&&this.props.item.setRootElement(this.rootRef.current),e.item&&e.item.setRootElement(void 0))}shouldComponentUpdate(e,t){return super.shouldComponentUpdate(e,t)?!this.question.customWidget||!!this.question.customWidgetData.isNeedRender||!!this.question.customWidget.widgetJson.isDefaultRender||!!this.question.customWidget.widgetJson.render:!1}doOnItemChange(e){}canRender(){return!!this.item&&!!this.question}renderElement(){return y(Me,null,this.renderElementContent(),this.renderPanel(),this.renderComment())}renderElementContent(){return null}get inputStyle(){return null}renderComment(){return this.item.isCommentShowing?y("div",{className:this.question.getCommentAreaCss(!0)},y(qh,{question:this.question,item:this.item,cssClasses:this.question.cssClasses})):null}renderPanel(){if(this.item.isPanelShowing){const e=this.item.panel;return y(_r,{key:e.id,element:e,survey:this.question.survey,cssClasses:this.props.cssClasses,isDisplayMode:this.isDisplayMode,creator:this.props.creator})}return null}componentDidMount(){super.componentDidMount(),this.question.isDesignMode||this.item.setRootElement(this.rootRef.current)}componentWillUnmount(){super.componentWillUnmount(),this.question.isDesignMode||this.item.setRootElement(void 0)}},EI=class extends wC{constructor(e){super(e)}get question(){return this.questionBase}renderHeader(){return y(Me,null,y("legend",{className:"sv-hidden"},this.question.locTitle.renderedHtml),this.getHeader())}getHeader(){return this.question.hasHeadItems?this.question.headItems.map((e,t)=>this.renderItem(e,!1,this.question.cssClasses)):null}},VC=class extends xC{constructor(e){super(e)}doOnItemChange(e){this.question.clickItemHandler(this.item,e.target.checked)}renderElementContent(){const e=this.question.isItemSelected(this.item);return this.renderCheckbox(e)}get inputStyle(){return null}renderCheckbox(e){const t=this.question.getItemId(this.item),s=this.question.getItemClass(this.item),i=this.question.getLabelClass(this.item),r=this.hideCaption?null:y("span",{className:this.cssClasses.controlLabel},this.renderLocString(this.item.locText,this.textStyle));return y("div",{className:s,role:"presentation",ref:this.rootRef},y("label",{className:i},y("input",{className:this.cssClasses.itemControl,type:"checkbox",name:this.question.name+this.item.id,value:this.item.value,id:t,style:this.inputStyle,disabled:!this.question.getItemEnabled(this.item),readOnly:this.question.isReadOnlyAttr,checked:e,onChange:this.handleOnChange,required:this.question.hasRequiredError(),"aria-label":this.ariaLabel}),this.cssClasses.materialDecorator?y("span",{className:this.cssClasses.materialDecorator},this.question.itemSvgIcon?y("svg",{className:this.cssClasses.itemDecorator},y("use",{xlinkHref:this.question.itemSvgIcon})):null):null,r))}};ee.Instance.registerElement("survey-checkbox-item",n=>y(VC,n)),Fe.Instance.registerQuestion("checkbox",n=>y(EI,n));let RI=class extends St{get question(){return this.questionBase}renderElement(){return this.question.selectToRankEnabled?y("div",{className:this.question.rootClass,ref:t=>this.setControl(t)},y("div",{className:this.question.getContainerClasses("from"),"data-ranking":"from-container"},this.getItems(this.question.renderedUnRankingChoices,!0),this.question.renderedUnRankingChoices.length===0?y("div",{className:this.question.cssClasses.containerPlaceholder}," ",this.renderLocString(this.question.locSelectToRankEmptyRankedAreaText)," "):null),y("div",{className:this.question.cssClasses.containersDivider}),y("div",{className:this.question.getContainerClasses("to"),"data-ranking":"to-container"},this.getItems(),this.question.renderedRankingChoices.length===0?y("div",{className:this.question.cssClasses.containerPlaceholder}," ",this.renderLocString(this.question.locSelectToRankEmptyUnrankedAreaText)," "):null)):y("div",{className:this.question.rootClass,ref:e=>this.setControl(e)},this.getItems())}getItems(e=this.question.renderedRankingChoices,t){const s=[];for(let i=0;i<e.length;i++){const r=e[i];s.push(this.renderItem(r,i,a=>{this.question.handleKeydown.call(this.question,a,r)},a=>{a.persist(),this.question.handlePointerDown.call(this.question,a,r,a.currentTarget)},a=>{a.persist(),this.question.handlePointerUp.call(this.question,a,r,a.currentTarget)},this.question.cssClasses,this.question.getItemClass(r),this.question,t))}return s}renderItem(e,t,s,i,r,a,o,l,u){""+e.renderedId;const d=this.renderLocString(e.locText),h=t,f=this.question.getNumberByIndex(h),C=this.question.getItemTabIndex(e),b=y(_I,{key:e.uniqueId,text:d,index:h,indexText:f,itemTabIndex:C,handleKeydown:s,handlePointerDown:i,handlePointerUp:r,cssClasses:a,itemClass:o,question:l,unrankedItem:u,item:e}),x=this.question.survey;let V=null;return x&&(V=$s.wrapItemValue(x,b,this.question,e)),V??b}},_I=class extends ot{get text(){return this.props.text}get index(){return this.props.index}get indexText(){return this.props.indexText}get handleKeydown(){return this.props.handleKeydown}get handlePointerDown(){return this.props.handlePointerDown}get handlePointerUp(){return this.props.handlePointerUp}get cssClasses(){return this.props.cssClasses}get itemClass(){return this.props.itemClass}get itemTabIndex(){return this.props.itemTabIndex}get question(){return this.props.question}get unrankedItem(){return this.props.unrankedItem}get item(){return this.props.item}renderEmptyIcon(){return y("svg",null,y("use",{xlinkHref:this.question.dashSvgIcon}))}renderElement(){let e=ee.Instance.createElement(this.question.itemComponent,{item:this.item,cssClasses:this.cssClasses});return y("div",{id:this.question.getItemId(this.item),tabIndex:this.itemTabIndex,className:this.itemClass,onKeyDown:this.handleKeydown,onPointerDown:this.handlePointerDown,onPointerUp:this.handlePointerUp,"data-sv-drop-target-ranking-item":this.index},y("div",{tabIndex:-1,style:{outline:"none"}},y("div",{className:this.cssClasses.itemGhostNode}),y("div",{className:this.cssClasses.itemContent},y("div",{className:this.cssClasses.itemIconContainer},y("svg",{className:this.question.getIconHoverCss()},y("use",{xlinkHref:this.question.dragDropSvgIcon})),y("svg",{className:this.question.getIconFocusCss()},y("use",{xlinkHref:this.question.arrowsSvgIcon}))),y("div",{className:this.question.getItemIndexClasses(this.item)},!this.unrankedItem&&this.indexText?this.indexText:this.renderEmptyIcon()),e)))}},LI=class extends ot{get item(){return this.props.item}get cssClasses(){return this.props.cssClasses}renderElement(){return y("div",{className:this.cssClasses.controlLabel},Se.renderLocString(this.item.locText))}};ee.Instance.registerElement("sv-ranking-item",n=>y(LI,n)),Fe.Instance.registerQuestion("ranking",n=>y(RI,n));let Bh=class extends Se{constructor(e){super(e),this.handleOnMouseDown=this.handleOnMouseDown.bind(this)}get question(){return this.props.question}get item(){return this.props.item}get index(){return this.props.index}getStateElement(){return this.item}handleOnMouseDown(e){this.question.onMouseDown()}},AI=class extends Bh{render(){var e=this.renderLocString(this.item.locText);return y("label",{onMouseDown:this.handleOnMouseDown,className:this.question.getItemClassByText(this.item.itemValue,this.item.text)},y("input",{type:"radio",className:"sv-visuallyhidden",name:this.question.questionName,id:this.question.getInputId(this.index),value:this.item.value,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,checked:this.question.value==this.item.value,onClick:this.props.handleOnClick,onChange:()=>{},"aria-label":this.question.ariaLabel}),y("span",{className:this.question.cssClasses.itemText,"data-text":this.item.text},e))}componentDidMount(){super.componentDidMount()}};ee.Instance.registerElement("sv-rating-item",n=>y(AI,n));let DI=class extends Bh{render(){return y("label",{onMouseDown:this.handleOnMouseDown,className:this.question.getItemClass(this.item.itemValue),onMouseOver:e=>this.question.onItemMouseIn(this.item),onMouseOut:e=>this.question.onItemMouseOut(this.item),title:this.item.text},y("input",{type:"radio",className:"sv-visuallyhidden",name:this.question.questionName,id:this.question.getInputId(this.index),value:this.item.value,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,checked:this.question.value==this.item.value,onClick:this.props.handleOnClick,onChange:()=>{},"aria-label":this.question.ariaLabel}),y(Be,{className:"sv-star",size:"auto",iconName:this.question.itemStarIcon}),y(Be,{className:"sv-star-2",size:"auto",iconName:this.question.itemStarIconAlt}))}};ee.Instance.registerElement("sv-rating-item-star",n=>y(DI,n));let OI=class extends Bh{render(){return y("label",{onMouseDown:this.handleOnMouseDown,style:this.question.getItemStyle(this.item.itemValue,this.item.highlight),className:this.question.getItemClass(this.item.itemValue),onMouseOver:e=>this.question.onItemMouseIn(this.item),onMouseOut:e=>this.question.onItemMouseOut(this.item),title:this.item.text},y("input",{type:"radio",className:"sv-visuallyhidden",name:this.question.questionName,id:this.question.getInputId(this.index),value:this.item.value,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,checked:this.question.value==this.item.value,onClick:this.props.handleOnClick,onChange:()=>{},"aria-label":this.question.ariaLabel}),y(Be,{size:"auto",iconName:this.question.getItemSmileyIconName(this.item.itemValue)}))}};ee.Instance.registerElement("sv-rating-item-smiley",n=>y(OI,n));let MI=class extends Se{get item(){return this.props.item}getStateElement(){return this.item}render(){if(!this.item)return null;const e=this.props.item,t=this.renderDescription(e);return y("div",{className:"sd-rating-dropdown-item"},y("span",{className:"sd-rating-dropdown-item_text"},e.title),t)}renderDescription(e){return e.description?y("div",{className:"sd-rating-dropdown-item_description"},this.renderLocString(e.description,void 0,"locString")):null}};ee.Instance.registerElement("sv-rating-dropdown-item",n=>y(MI,n));let PC=class extends Se{get model(){return this.props.model}get question(){return this.props.question}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.updateDomElement()}componentDidMount(){super.componentDidMount(),this.updateDomElement()}updateDomElement(){if(this.inputElement){const e=this.inputElement,t=this.model.inputStringRendered;O.isTwoValueEquals(t,e.value,!1,!0,!1)||(e.value=this.model.inputStringRendered)}}onChange(e){var t;const s=(t=e.target.getRootNode())===null||t===void 0?void 0:t.activeElement;e.target===s&&(this.model.inputStringRendered=e.target.value)}keyhandler(e){this.model.inputKeyHandler(e)}onBlur(e){this.question.onBlur(e)}onFocus(e){this.question.onFocus(e)}constructor(e){super(e)}getStateElement(){return this.model}render(){return y("div",{className:this.question.cssClasses.hint},this.model.showHintPrefix?y("div",{className:this.question.cssClasses.hintPrefix},y("span",null,this.model.hintStringPrefix)):null,y("div",{className:this.question.cssClasses.hintSuffixWrapper},this.model.showHintString?y("div",{className:this.question.cssClasses.hintSuffix},y("span",{style:{visibility:"hidden"},"data-bind":"text: model.filterString"},this.model.inputStringRendered),y("span",null,this.model.hintStringSuffix)):null,y("input",{type:"text",autoComplete:"off",id:this.question.getInputId(),inputMode:this.model.inputMode,ref:e=>this.inputElement=e,className:this.question.cssClasses.filterStringInput,disabled:this.question.isInputReadOnly,readOnly:this.model.filterReadOnly?!0:void 0,size:this.model.inputStringRendered?void 0:1,role:this.model.ariaInputRole,"aria-required":this.model.ariaInputRequired,"aria-invalid":this.model.ariaInputInvalid,"aria-errormessage":this.model.ariaInputErrorMessage,"aria-expanded":this.model.ariaInputExpanded,"aria-label":this.model.ariaInputLabel,"aria-labelledby":this.model.ariaInputLabelledby,"aria-describedby":this.model.ariaInputDescribedby,"aria-controls":this.model.ariaInputControls,"aria-activedescendant":this.model.ariaInputActivedescendant,placeholder:this.model.filterStringPlaceholder,onKeyDown:e=>{this.keyhandler(e)},onChange:e=>{this.onChange(e)},onBlur:e=>{this.onBlur(e)},onFocus:e=>{this.onFocus(e)}})))}};Fe.Instance.registerQuestion("sv-tagbox-filter",n=>y(PC,n));let kI=class extends ot{constructor(e){super(e),this.state={changed:0},this.setupModel()}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.setupModel()}componentDidMount(){super.componentDidMount(),this.setupModel()}componentWillUnmount(){super.componentWillUnmount(),this.item&&(this.item.locText.onChanged=()=>{})}setupModel(){if(!this.item.locText)return;const e=this;this.item.locText.onChanged=()=>{e.setState({changed:e.state.changed+1})}}getStateElement(){return this.item}get item(){return this.props.item}canRender(){return!!this.item}renderElement(){return y("option",{value:this.item.value,disabled:!this.item.isEnabled},this.item.text)}},Ao=class extends gn{constructor(){super(...arguments),this.click=e=>{var t;(t=this.question.dropdownListModel)===null||t===void 0||t.onClick(e)},this.chevronPointerDown=e=>{var t;(t=this.question.dropdownListModel)===null||t===void 0||t.chevronPointerDown(e)},this.clear=e=>{var t;(t=this.question.dropdownListModel)===null||t===void 0||t.onClear(e)},this.keyhandler=e=>{var t;(t=this.question.dropdownListModel)===null||t===void 0||t.keyHandler(e)},this.blur=e=>{this.updateInputDomElement(),this.question.onBlur(e)},this.focus=e=>{this.question.onFocus(e)}}get dropdownListModel(){return this.question.dropdownListModel}getStateElement(){return this.question.dropdownListModel}setValueCore(e){this.questionBase.renderedValue=e}getValueCore(){return this.questionBase.renderedValue}renderReadOnlyElement(){return this.question.locReadOnlyText?y("div",{className:this.question.cssClasses.controlValue},this.renderLocString(this.question.locReadOnlyText)):null}renderSelect(e){let t=null;const s=this.dropdownListModel;return this.question.isReadOnly?t=y("div",{id:this.question.inputId,role:s?.ariaQuestionRole,"aria-label":s?.ariaQuestionLabel,"aria-labelledby":s?.ariaQuestionLabelledby,"aria-describedby":s?.ariaQuestionDescribedby,"aria-expanded":"false","aria-readonly":"true","aria-disabled":"true",tabIndex:this.question.isDisabledAttr?void 0:0,className:this.question.getControlClass(),ref:i=>this.setControl(i)},this.renderReadOnlyElement(),this.renderEditorButtons()):t=y(Me,null,this.renderInput(),this.question.isInputReadOnly?null:y(fn,{model:s.popupModel})),y("div",{className:e.selectWrapper,onClick:this.click},t)}renderValueElement(){return this.question.showInputFieldComponent?ee.Instance.createElement(this.question.inputFieldComponentName,{item:this.dropdownListModel.getSelectedAction(),question:this.question}):this.question.showSelectedItemLocText?this.renderLocString(this.question.selectedItemLocText):null}renderInput(){const e=this.dropdownListModel;let t=this.renderValueElement();return y("div",{id:this.question.inputId,className:this.question.getControlClass(),tabIndex:e.noTabIndex?void 0:0,disabled:this.question.isDisabledAttr,required:this.question.isRequired,onKeyDown:this.keyhandler,onBlur:this.blur,onFocus:this.focus,role:e.ariaQuestionRole,"aria-required":e.ariaQuestionRequired,"aria-invalid":e.ariaQuestionInvalid,"aria-errormessage":e.ariaQuestionErrorMessage,"aria-expanded":e.ariaQuestionExpanded,"aria-label":e.ariaQuestionLabel,"aria-labelledby":e.ariaQuestionLabelledby,"aria-describedby":e.ariaQuestionDescribedby,"aria-controls":e.ariaQuestionControls,"aria-activedescendant":e.ariaQuestionActivedescendant,ref:s=>this.setControl(s)},e.showHintPrefix?y("div",{className:this.question.cssClasses.hintPrefix},y("span",null,e.hintStringPrefix)):null,y("div",{className:this.question.cssClasses.controlValue},e.showHintString?y("div",{className:this.question.cssClasses.hintSuffix},y("span",{style:{visibility:"hidden"},"data-bind":"text: model.filterString"},e.inputStringRendered),y("span",null,e.hintStringSuffix)):null,t,e.needRenderInput?this.renderFilterInput():null),this.renderEditorButtons())}renderFilterInput(){const{root:e}=A.environment,t=this.dropdownListModel,s=i=>{var r;const a=(r=i.target.getRootNode())===null||r===void 0?void 0:r.activeElement;i.target===a&&(t.inputStringRendered=i.target.value)};return y("input",{type:"text",autoComplete:"off",id:this.question.getInputId(),ref:i=>this.inputElement=i,className:this.question.cssClasses.filterStringInput,role:t.ariaInputRole,"aria-required":t.ariaInputRequired,"aria-invalid":t.ariaInputInvalid,"aria-errormessage":t.ariaInputErrorMessage,"aria-expanded":t.ariaInputExpanded,"aria-label":t.ariaInputLabel,"aria-labelledby":t.ariaInputLabelledby,"aria-describedby":t.ariaInputDescribedby,"aria-controls":t.ariaInputControls,"aria-activedescendant":t.ariaInputActivedescendant,placeholder:t.placeholderRendered,readOnly:t.filterReadOnly?!0:void 0,tabIndex:t.noTabIndex?void 0:-1,disabled:this.question.isDisabledAttr,inputMode:t.inputMode,onChange:i=>{s(i)},onBlur:this.blur,onFocus:this.focus})}renderOther(e,t){return!e||!e.isCommentShowing?null:y("div",{key:e.uniqueId,className:this.question.getCommentAreaCss(!0)},y(qh,{question:this.question,item:e,cssClasses:this.question.cssClasses}))}renderEditorButtons(){return y(bs,{model:this.dropdownListModel.editorButtons})}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.updateInputDomElement()}componentDidMount(){super.componentDidMount(),this.updateInputDomElement()}componentWillUnmount(){super.componentWillUnmount(),this.question.dropdownListModel&&(this.question.dropdownListModel.focused=!1)}updateInputDomElement(){if(this.inputElement){const e=this.inputElement,t=this.question.dropdownListModel.inputStringRendered;O.isTwoValueEquals(t,e.value,!1,!0,!1)||(e.value=this.question.dropdownListModel.inputStringRendered)}}},SC=class extends Ao{constructor(e){super(e)}renderElement(){const e=this.question.cssClasses,t=this.renderOther(this.question.selectedItem,e),s=this.renderSelect(e);return y("div",{className:this.question.renderCssRoot},s,t)}};Fe.Instance.registerQuestion("dropdown",n=>y(SC,n));let NI=class extends ot{constructor(e){super(e)}get question(){return this.props.question}get item(){return this.props.item}canRender(){return!!this.item&&!!this.question}renderElement(){const e=this.renderLocString(this.item.locText),t=s=>{this.question.dropdownListModel.deselectItem(this.item.value),s.stopPropagation()};return y("div",{className:"sv-tagbox__item"},y("div",{className:"sv-tagbox__item-text"},e),y("div",{className:this.question.cssClasses.cleanItemButton,onClick:t},y(Be,{className:this.question.cssClasses.cleanItemButtonSvg,iconName:this.question.cssClasses.cleanItemButtonIconId,size:"auto"})))}},qI=class extends Ao{constructor(e){super(e)}renderItem(e,t){return y(NI,{key:e,question:this.question,item:t})}renderInput(){const e=this.dropdownListModel,t=this.question.selectedChoices.map((s,i)=>this.renderItem("item"+i,s));return y("div",{id:this.question.inputId,className:this.question.getControlClass(),tabIndex:e.noTabIndex?void 0:0,disabled:this.question.isInputReadOnly,required:this.question.isRequired,onKeyDown:this.keyhandler,onBlur:this.blur,role:e.ariaQuestionRole,"aria-required":e.ariaQuestionRequired,"aria-invalid":e.ariaQuestionInvalid,"aria-errormessage":e.ariaQuestionErrorMessage,"aria-label":e.ariaQuestionLabel,"aria-labelledby":e.ariaQuestionLabelledby,"aria-describedby":e.ariaQuestionDescribedby,"aria-expanded":e.ariaQuestionExpanded,"aria-controls":e.ariaQuestionControls,"aria-activedescendant":e.ariaQuestionActivedescendant,ref:s=>this.setControl(s)},y("div",{className:this.question.cssClasses.controlValue},t,e.needRenderInput?y(PC,{model:e,question:this.question}):null),this.renderEditorButtons())}renderElement(){const e=this.question.cssClasses,t=this.renderOther(this.question.otherItem,e),s=this.renderSelect(e);return y("div",{className:this.question.renderCssRoot},s,t)}};Fe.Instance.registerQuestion("tagbox",n=>y(qI,n));let BI=class extends SC{constructor(e){super(e)}renderSelect(e){const t=r=>{this.question.onClick(r)},s=r=>{this.question.onKeyUp(r)},i=this.isDisplayMode?y("div",{id:this.question.inputId,className:this.question.getControlClass(),disabled:!0},this.question.readOnlyText):y("select",{id:this.question.inputId,className:this.question.getControlClass(),ref:r=>this.setControl(r),autoComplete:this.question.autocomplete,onChange:this.updateValueOnEvent,onInput:this.updateValueOnEvent,onClick:t,onKeyUp:s,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage,required:this.question.isRequired},this.question.allowClear?y("option",{value:""},this.question.placeholder):null,this.question.visibleChoices.map(r=>y(kI,{key:r.uniqueId,item:r})));return y("div",{className:e.selectWrapper},i,this.createChevronButton())}createChevronButton(){return this.question.cssClasses.chevronButtonIconId?y("div",{className:this.question.cssClasses.chevronButton,"aria-hidden":"true",onPointerDown:this.chevronPointerDown},y(Be,{className:this.question.cssClasses.chevronButtonSvg,iconName:this.question.cssClasses.chevronButtonIconId,size:"auto"})):null}};Fe.Instance.registerQuestion("sv-dropdown-select",n=>y(BI,n)),ai.Instance.registerRenderer("dropdown","select","sv-dropdown-select");let FI=class extends St{constructor(e){super(e),this.state={rowsChanged:0}}get question(){return this.questionBase}componentDidMount(){if(super.componentDidMount(),this.question){var e=this;this.question.visibleRowsChangedCallback=function(){e.setState({rowsChanged:e.state.rowsChanged+1})}}}componentWillUnmount(){super.componentWillUnmount(),this.question&&(this.question.visibleRowsChangedCallback=null)}renderElement(){for(var e=this.question.cssClasses,t=this.question.hasRows?y("td",null):null,s=[],i=0;i<this.question.visibleColumns.length;i++){var r=this.question.visibleColumns[i],a=this.renderLocString(r.locText);const h={};this.question.columnMinWidth&&(h.minWidth=this.question.columnMinWidth,h.width=this.question.columnMinWidth),s.push(y("th",{className:this.question.cssClasses.headerCell,style:h,key:r.uniqueId},this.wrapCell({column:r},a,"column-header")))}for(var o=[],l=this.question.visibleRows,i=0;i<l.length;i++){var u=l[i];o.push(y(QI,{key:u.uniqueId,question:this.question,cssClasses:e,row:u,isFirst:i==0}))}var d=this.question.showHeader?y("thead",{role:"presentation"},y("tr",null,t,s)):null;return y("div",{className:e.tableWrapper,ref:h=>this.setControl(h)},y("fieldset",{role:"radiogroup"},y("legend",{className:"sv-visuallyhidden"},this.question.locTitle.renderedHtml),y("table",{className:this.question.getTableCss(),role:"presentation"},d,y("tbody",null,o))))}},QI=class extends ot{constructor(e){super(e)}getStateElement(){return this.row?this.row.item:super.getStateElement()}get question(){return this.props.question}get row(){return this.props.row}wrapCell(e,t,s){if(!s)return t;const i=this.question.survey;let r=null;return i&&(r=$s.wrapMatrixCell(i,t,e,s)),r??t}canRender(){return!!this.row}renderElement(){var e=null;if(this.question.hasRows){var t=this.renderLocString(this.row.locText);const i={};this.question.rowTitleWidth&&(i.minWidth=this.question.rowTitleWidth,i.width=this.question.rowTitleWidth),e=y("td",{style:i,className:this.row.rowTextClasses},this.wrapCell({row:this.row},t,"row-header"))}var s=this.generateTds();return y("tr",{className:this.row.rowClasses||void 0},e,s)}generateTds(){const e=[],t=this.row,s=this.question.cellComponent;for(var i=0;i<this.question.visibleColumns.length;i++){let r=null;const a=this.question.visibleColumns[i],o=a.uniqueId;let l=this.question.getItemClass(t,a);if(this.question.hasCellText){const u=d=>()=>this.cellClick(t,d);r=y("td",{key:o,className:l,onClick:u?u(a):()=>{}},this.renderLocString(this.question.getCellDisplayLocText(t.name,a)))}else{const u=ee.Instance.createElement(s,{question:this.question,row:this.row,column:a,columnIndex:i,cssClasses:this.cssClasses,cellChanged:()=>{this.cellClick(this.row,a)}});r=y("td",{key:o,"data-responsive-title":a.locText.renderedHtml,className:this.question.cssClasses.cell},u)}e.push(r)}return e}cellClick(e,t){e.cellClick(t),this.setState({value:e.value})}},HI=class extends ot{constructor(e){super(e),this.handleOnMouseDown=this.handleOnMouseDown.bind(this),this.handleOnChange=this.handleOnChange.bind(this)}handleOnChange(e){this.props.cellChanged&&this.props.cellChanged(),this.setState({value:this.row.isChecked(this.column)})}handleOnMouseDown(e){this.question.onMouseDown()}get question(){return this.props.question}get row(){return this.props.row}get column(){return this.props.column}get columnIndex(){return this.props.columnIndex}canRender(){return!!this.question&&!!this.row}renderElement(){const e=this.row.isChecked(this.column),t=this.question.inputId+"_"+this.row.name+"_"+this.columnIndex,s=this.question.getItemClass(this.row,this.column),i=this.question.getItemSvgIcon(this.row,this.column),r=this.question.isMobile?y("span",{className:this.question.cssClasses.cellResponsiveTitle},this.renderLocString(this.column.locText)):void 0;return y("label",{onMouseDown:this.handleOnMouseDown,className:s},this.renderInput(t,e),y("span",{className:this.question.cssMaterialDecorator},i?y("svg",{className:this.question.cssItemDecorator},y("use",{xlinkHref:i})):null),r)}renderInput(e,t){return y("input",{id:e,type:this.question.checkType,className:this.question.cssItemValue,name:this.row.fullName,value:this.column.value,disabled:this.row.isDisabledAttr,readOnly:this.row.isReadOnlyAttr,checked:t,onChange:this.handleOnChange,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.getCellAriaLabel(this.row,this.column),"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage})}};ee.Instance.registerElement("survey-matrix-cell",n=>y(HI,n)),Fe.Instance.registerQuestion("matrix",n=>y(FI,n));let zI=class extends St{constructor(e){super(e)}get question(){return this.questionBase}componentDidMount(){this.reactOnStrChanged()}componentWillUnmount(){this.question.locHtml.onChanged=function(){}}componentDidUpdate(e,t){this.reactOnStrChanged()}reactOnStrChanged(){this.question.locHtml.onChanged=()=>{this.setState({changed:this.state&&this.state.changed?this.state.changed+1:1})}}canRender(){return super.canRender()&&!!this.question.html}renderElement(){var e={__html:this.question.locHtml.renderedHtml};return y("div",{className:this.question.renderCssRoot,dangerouslySetInnerHTML:e})}};Fe.Instance.registerQuestion("html",n=>y(zI,n));let IC=class extends Ge{render(){return y("div",{className:"sd-loading-indicator"},y(Be,{iconName:"icon-loading",size:"auto"}))}},jI=class extends St{constructor(e){super(e)}get question(){return this.questionBase}renderElement(){const e=this.question.allowShowPreview?this.renderPreview():null,t=this.question.showLoadingIndicator?this.renderLoadingIndicator():null,s=this.question.isPlayingVideo?this.renderVideo():null,i=this.question.showFileDecorator?this.renderFileDecorator():null,r=this.question.fileNavigatorVisible?y(bs,{model:this.question.fileNavigator}):null;let a;return this.question.isReadOnlyAttr?a=y("input",{readOnly:!0,type:"file",className:this.isDisplayMode?this.question.getReadOnlyFileCss():this.question.cssClasses.fileInput,id:this.question.inputId,ref:o=>this.setControl(o),style:this.isDisplayMode?{color:"transparent"}:{},multiple:this.question.allowMultiple,placeholder:this.question.title,accept:this.question.acceptedTypes}):this.question.isDisabledAttr?a=y("input",{disabled:!0,type:"file",className:this.isDisplayMode?this.question.getReadOnlyFileCss():this.question.cssClasses.fileInput,id:this.question.inputId,ref:o=>this.setControl(o),style:this.isDisplayMode?{color:"transparent"}:{},multiple:this.question.allowMultiple,placeholder:this.question.title,accept:this.question.acceptedTypes}):this.question.hasFileUI?a=y("input",{type:"file",disabled:this.isDisplayMode,tabIndex:-1,className:this.isDisplayMode?this.question.getReadOnlyFileCss():this.question.cssClasses.fileInput,id:this.question.inputId,ref:o=>this.setControl(o),style:this.isDisplayMode?{color:"transparent"}:{},"aria-required":this.question.ariaRequired,"aria-label":this.question.ariaLabel,"aria-invalid":this.question.ariaInvalid,"aria-errormessage":this.question.ariaErrormessage,multiple:this.question.allowMultiple,title:this.question.inputTitle,accept:this.question.acceptedTypes,capture:this.question.renderCapture}):a=null,y("div",{className:this.question.fileRootCss,ref:o=>this.setContent(o)},a,y("div",{className:this.question.cssClasses.dragArea,onDrop:this.question.onDrop,onDragOver:this.question.onDragOver,onDragLeave:this.question.onDragLeave,onDragEnter:this.question.onDragEnter},i,t,s,e,r))}renderFileDecorator(){const e=this.question.actionsContainerVisible?y(bs,{model:this.question.actionsContainer}):null;return y("div",{className:this.question.getFileDecoratorCss()},this.question.showDragAreaPlaceholder?y("span",{className:this.question.cssClasses.dragAreaPlaceholder},this.renderLocString(this.question.locRenderedPlaceholder)):!1,y("div",{className:this.question.cssClasses.wrapper},e))}renderPreview(){return ee.Instance.createElement("sv-file-preview",{question:this.question})}renderLoadingIndicator(){return y("div",{className:this.question.cssClasses.loadingIndicator},y(IC,null))}renderVideo(){return y("div",{className:this.question.cssClasses.videoContainer},y(mn,{item:this.question.changeCameraAction}),y(mn,{item:this.question.closeCameraAction}),y("video",{autoPlay:!0,playsInline:!0,id:this.question.videoId,className:this.question.cssClasses.video}),y(mn,{item:this.question.takePictureAction}))}};Fe.Instance.registerQuestion("file",n=>y(jI,n));let UI=class extends ot{constructor(e){super(e)}get question(){return this.props.item&&this.props.item.data.question||this.props.data.question}render(){return Oh(y("label",{tabIndex:0,className:this.question.getChooseFileCss(),htmlFor:this.question.inputId,"aria-label":this.question.chooseButtonText,onClick:e=>this.question.chooseFile(e.nativeEvent)},this.question.cssClasses.chooseFileIconId?y(Be,{title:this.question.chooseButtonText,iconName:this.question.cssClasses.chooseFileIconId,size:"auto"}):null,y("span",null,this.question.chooseButtonText)))}};ee.Instance.registerElement("sv-file-choose-btn",n=>y(UI,n));let WI=class extends Se{get question(){return this.props.question}get page(){return this.props.page}renderElement(){const e=this.page.items.map((t,s)=>ee.Instance.createElement("sv-file-item",{item:t,question:this.question,key:s}));return y("div",{className:this.page.css,id:this.page.id},e)}},$I=class extends Se{get question(){return this.props.question}renderFileSign(e,t){return!e||!t.name?null:y("div",{className:e},y("a",{href:t.content,onClick:s=>{this.question.doDownloadFile(s,t)},title:t.name,download:t.name,style:{width:this.question.imageWidth}},t.name))}renderElement(){const e=this.question.renderedPages.map((t,s)=>y(WI,{page:t,question:this.question,key:t.id}));return y("div",{className:this.question.cssClasses.fileList||void 0},e)}canRender(){return this.question.showPreviewContainer}};ee.Instance.registerElement("sv-file-preview",n=>y($I,n));let GI=class extends Se{get question(){return this.props.question}get item(){return this.props.item}renderFileSign(e,t){return!e||!t.name?null:y("div",{className:e},y("a",{href:t.content,onClick:s=>{this.question.doDownloadFile(s,t)},title:t.name,download:t.name,target:"_blank",rel:"noreferrer",style:{width:this.question.imageWidth}},t.name))}renderElement(){const e=this.item;return y("span",{className:this.question.cssClasses.previewItem,onClick:t=>this.question.doDownloadFileFromContainer(t)},this.renderFileSign(this.question.cssClasses.fileSign,e),y("div",{className:this.question.getImageWrapperCss(e)},this.question.canPreviewImage(e)?y("img",{src:e.content,style:{height:this.question.imageHeight,width:this.question.imageWidth},alt:"File preview"}):this.question.cssClasses.defaultImage?y(Be,{iconName:this.question.cssClasses.defaultImageIconId,size:"auto",className:this.question.cssClasses.defaultImage}):null,e.name&&!this.question.isReadOnly?y("div",{className:this.question.getRemoveButtonCss(),onClick:t=>this.question.doRemoveFile(e,t)},y("span",{className:this.question.cssClasses.removeFile},this.question.removeFileCaption),this.question.cssClasses.removeFileSvgIconId?y(Be,{title:this.question.removeFileCaption,iconName:this.question.cssClasses.removeFileSvgIconId,size:"auto",className:this.question.cssClasses.removeFileSvg}):null):null),this.renderFileSign(this.question.cssClasses.fileSignBottom,e))}canRender(){return this.question.showPreviewContainer}};ee.Instance.registerElement("sv-file-item",n=>y(GI,n));let JI=class extends St{constructor(e){super(e)}get question(){return this.questionBase}renderElement(){for(var e=this.question.cssClasses,t=this.question.getRows(),s=[],i=0;i<t.length;i++)t[i].isVisible&&s.push(this.renderRow(i,t[i].cells,e));return y("table",{className:this.question.getQuestionRootCss()},y("tbody",null,s))}renderCell(e,t,s){let i;const r=()=>{e.item.focusIn()};return e.isErrorsCell?i=y(bC,{question:e.item.editor,creator:this.creator}):i=y(KI,{question:this.question,item:e.item,creator:this.creator,cssClasses:t}),y("td",{key:e.item.id,className:e.className,onFocus:r},i)}renderRow(e,t,s){const i="item"+e,r=[];for(let a=0;a<t.length;a++){const o=t[a];r.push(this.renderCell(o,s,a))}return y("tr",{key:i,className:s.row},r)}},KI=class extends ot{get question(){return this.props.question}get item(){return this.props.item}getStateElements(){return[this.item,this.item.editor]}get creator(){return this.props.creator}renderElement(){const e=this.item,t=this.cssClasses,s={};return this.question.itemTitleWidth&&(s.minWidth=this.question.itemTitleWidth,s.width=this.question.itemTitleWidth),y("label",{className:this.question.getItemLabelCss(e)},y("span",{className:t.itemTitle,style:s},y(uC,{element:e.editor,cssClasses:e.editor.cssClasses})),y(ZI,{cssClasses:t,itemCss:this.question.getItemCss(),question:e.editor,creator:this.creator}))}},ZI=class extends CC{renderElement(){return y("div",{className:this.itemCss},this.renderContent())}};Fe.Instance.registerQuestion("multipletext",n=>y(JI,n));let YI=class extends wC{constructor(e){super(e)}get question(){return this.questionBase}getFooter(){return y(Me,null,super.getFooter(),this.renderClearButton())}renderClearButton(){return this.question.showClearButtonInContent?y("div",null,y("input",{type:"button",className:this.question.cssClasses.clearButton,onClick:()=>this.question.clearValueFromUI(),value:this.question.clearButtonCaption})):null}getStateValue(){return this.question.isEmpty()?"":this.question.renderedValue}isItemChecked(e,t){return e.value===t}},TC=class extends xC{constructor(e){super(e),this.handleOnMouseDown=this.handleOnMouseDown.bind(this)}getStateElement(){return this.item}get question(){return this.props.question}get isChecked(){return this.props.isChecked}doOnItemChange(e){this.question.clickItemHandler(this.item)}handleOnMouseDown(e){this.question.onMouseDown()}renderElementContent(){return this.renderRadioButton()}renderRadioButton(){var e=this.question.getItemClass(this.item),t=this.question.getLabelClass(this.item),s=this.question.getControlLabelClass(this.item);const i=this.hideCaption?null:y("span",{className:s},this.renderLocString(this.item.locText,this.textStyle));return y("div",{className:e,role:"presentation",ref:this.rootRef},y("label",{onMouseDown:this.handleOnMouseDown,className:t},y("input",{"aria-errormessage":this.question.ariaErrormessage,className:this.cssClasses.itemControl,id:this.question.getItemId(this.item),type:"radio",name:this.question.questionName,checked:this.isChecked,value:this.item.value,disabled:!this.question.getItemEnabled(this.item),readOnly:this.question.isReadOnlyAttr,onChange:this.handleOnChange,"aria-label":this.ariaLabel}),this.cssClasses.materialDecorator?y("span",{className:this.cssClasses.materialDecorator},this.question.itemSvgIcon?y("svg",{className:this.cssClasses.itemDecorator},y("use",{xlinkHref:this.question.itemSvgIcon})):null):null,i))}};ee.Instance.registerElement("survey-radiogroup-item",n=>y(TC,n)),Fe.Instance.registerQuestion("radiogroup",n=>y(YI,n));let XI=class extends gn{constructor(e){super(e)}renderInput(){const e=this.question.getControlClass(),t=this.question.renderedPlaceholder;if(this.question.isReadOnlyRenderDiv())return y("div",null,this.question.inputValue);const s=this.question.getMaxLength()?y(kh,{counter:this.question.characterCounter,remainingCharacterCounter:this.question.cssClasses.remainingCharacterCounter}):null;return y(Me,null,y("input",{id:this.question.inputId,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,className:e,type:this.question.inputType,ref:i=>this.setControl(i),style:this.question.inputStyle,maxLength:this.question.getMaxLength(),min:this.question.renderedMin,max:this.question.renderedMax,step:this.question.renderedStep,size:this.question.inputSize,placeholder:t,list:this.question.dataListId,autoComplete:this.question.autocomplete,onBlur:i=>{this.question.onBlur(i)},onFocus:i=>{this.question.onFocus(i)},onChange:this.question.onChange,onClick:this.question.readOnlyBlocker,onPointerDown:this.question.readOnlyBlocker,onKeyUp:this.question.onKeyUp,onKeyDown:this.question.onKeyDown,onCompositionUpdate:i=>this.question.onCompositionUpdate(i.nativeEvent),"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-labelledby":this.question.a11y_input_ariaLabelledBy,"aria-describedby":this.question.a11y_input_ariaDescribedBy,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage}),s)}renderElement(){return this.question.dataListId?y("div",null,this.renderInput(),this.renderDataList()):this.renderInput()}setValueCore(e){this.question.inputValue=e}getValueCore(){return this.question.inputValue}renderDataList(){if(!this.question.dataListId)return null;var e=this.question.dataList;if(e.length==0)return null;for(var t=[],s=0;s<e.length;s++)t.push(y("option",{key:"item"+s,value:e[s]}));return y("datalist",{id:this.question.dataListId},t)}};Fe.Instance.registerQuestion("text",n=>y(XI,n));let Fh=class extends St{constructor(e){super(e),this.handleOnChange=this.handleOnChange.bind(this),this.handleOnClick=this.handleOnClick.bind(this),this.handleOnLabelClick=this.handleOnLabelClick.bind(this),this.handleOnSwitchClick=this.handleOnSwitchClick.bind(this),this.handleOnKeyDown=this.handleOnKeyDown.bind(this),this.checkRef=ct()}getStateElement(){return this.question}get question(){return this.questionBase}doCheck(e){this.question.booleanValue=e}handleOnChange(e){this.doCheck(e.target.checked)}handleOnClick(e){this.question.onLabelClick(e,!0)}handleOnSwitchClick(e){this.question.onSwitchClickModel(e.nativeEvent)}handleOnLabelClick(e,t){this.question.onLabelClick(e,t)}handleOnKeyDown(e){this.question.onKeyDownCore(e)}updateDomElement(){if(!this.question)return;const e=this.checkRef.current;e&&(e.indeterminate=this.question.isIndeterminate),this.setControl(e),super.updateDomElement()}renderElement(){const e=this.question.cssClasses,t=this.question.getItemCss();return y("div",{className:e.root,onKeyDown:this.handleOnKeyDown},y("label",{className:t},y("input",{ref:this.checkRef,type:"checkbox",name:this.question.name,value:this.question.booleanValue===null?"":this.question.booleanValue,id:this.question.inputId,className:e.control,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,checked:this.question.booleanValue||!1,onChange:this.handleOnChange,role:this.question.a11y_input_ariaRole,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-labelledby":this.question.a11y_input_ariaLabelledBy,"aria-describedby":this.question.a11y_input_ariaDescribedBy,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage}),y("div",{className:e.sliderGhost,onClick:s=>this.handleOnLabelClick(s,this.question.swapOrder)},y("span",{className:this.question.getLabelCss(this.question.swapOrder)},this.renderLocString(this.question.locLabelLeft))),y("div",{className:e.switch,onClick:this.handleOnSwitchClick},y("span",{className:e.slider},this.question.isDeterminated&&e.sliderText?y("span",{className:e.sliderText},this.renderLocString(this.question.getCheckedLabel())):null)),y("div",{className:e.sliderGhost,onClick:s=>this.handleOnLabelClick(s,!this.question.swapOrder)},y("span",{className:this.question.getLabelCss(!this.question.swapOrder)},this.renderLocString(this.question.locLabelRight)))))}};Fe.Instance.registerQuestion("boolean",n=>y(Fh,n));let e5=class extends Fh{constructor(e){super(e)}renderElement(){const e=this.question.cssClasses,t=this.question.getCheckboxItemCss(),s=this.question.canRenderLabelDescription?Se.renderQuestionDescription(this.question):null;return y("div",{className:e.rootCheckbox},y("div",{className:t},y("label",{className:e.checkboxLabel},y("input",{ref:this.checkRef,type:"checkbox",name:this.question.name,value:this.question.booleanValue===null?"":this.question.booleanValue,id:this.question.inputId,className:e.controlCheckbox,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,checked:this.question.booleanValue||!1,onChange:this.handleOnChange,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-labelledby":this.question.a11y_input_ariaLabelledBy,"aria-describedby":this.question.a11y_input_ariaDescribedBy,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage}),y("span",{className:e.checkboxMaterialDecorator},this.question.svgIcon?y("svg",{className:e.checkboxItemDecorator},y("use",{xlinkHref:this.question.svgIcon})):null,y("span",{className:"check"})),this.question.isLabelRendered&&y("span",{className:e.checkboxControlLabel,id:this.question.labelRenderedAriaID},y(Lh,{element:this.question,cssClasses:this.question.cssClasses}))),s))}};Fe.Instance.registerQuestion("sv-boolean-checkbox",n=>y(e5,n)),ai.Instance.registerRenderer("boolean","checkbox","sv-boolean-checkbox");let t5=class extends Fh{constructor(e){super(e)}renderRadioItem(e,t){const s=this.question.cssClasses,i=()=>{this.question.value=e};return y("div",{role:"presentation",className:this.question.getRadioItemClass(s,e)},y("label",{className:s.radioLabel},y("input",{type:"radio",name:this.question.name,value:e,"aria-errormessage":this.question.ariaErrormessage,checked:e===this.question.value,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,className:s.itemRadioControl,onChange:i}),this.question.cssClasses.materialRadioDecorator?y("span",{className:s.materialRadioDecorator},this.question.itemSvgIcon?y("svg",{className:s.itemRadioDecorator},y("use",{xlinkHref:this.question.itemSvgIcon})):null):null,y("span",{className:s.radioControlLabel},this.renderLocString(t))))}renderElement(){const e=this.question.cssClasses;return y("div",{className:e.rootRadio},y("fieldset",{role:"presentation",className:e.radioFieldset},this.question.swapOrder?y(Me,null,this.renderRadioItem(this.question.getValueTrue(),this.question.locLabelTrue),this.renderRadioItem(this.question.getValueFalse(),this.question.locLabelFalse)):y(Me,null,this.renderRadioItem(this.question.getValueFalse(),this.question.locLabelFalse),this.renderRadioItem(this.question.getValueTrue(),this.question.locLabelTrue))))}};Fe.Instance.registerQuestion("sv-boolean-radio",n=>y(t5,n)),ai.Instance.registerRenderer("boolean","radio","sv-boolean-radio");let s5=class extends St{constructor(e){super(e),this.state={value:this.question.value}}get question(){return this.questionBase}renderElement(){return y("div",null)}};Fe.Instance.registerQuestion("empty",n=>y(s5,n));let EC=class extends Se{constructor(e){super(e),this.root=ct(),this.onPointerDownHandler=t=>{this.parentMatrix.onPointerDown(t.nativeEvent,this.model.row)}}get model(){return this.props.model}get parentMatrix(){return this.props.parentMatrix}getStateElement(){return this.model}componentDidMount(){super.componentDidMount(),this.root.current&&this.model.setRootElement(this.root.current)}componentWillUnmount(){super.componentWillUnmount(),this.model.setRootElement(void 0)}shouldComponentUpdate(e,t){return super.shouldComponentUpdate(e,t)?(e.model!==this.model&&(e.element&&e.element.setRootElement(this.root.current),this.model&&this.model.setRootElement(void 0)),!0):!1}render(){const e=this.model;return e.visible?y("tr",{ref:this.root,className:e.className,"data-sv-drop-target-matrix-row":e.dropTargetId,onPointerDown:t=>this.onPointerDownHandler(t)},this.props.children):null}};ee.Instance.registerElement("sv-matrix-row",n=>y(EC,n));let RC=class extends ot{get question(){return this.props.item.data.question}renderElement(){return y("div",null,this.renderIcon())}renderIcon(){return this.question.iconDragElement?y("svg",{className:this.question.cssClasses.dragElementDecorator},y("use",{xlinkHref:this.question.iconDragElement})):y("span",{className:this.question.cssClasses.iconDrag})}};ee.Instance.registerElement("sv-matrix-drag-drop-icon",n=>y(RC,n));let i5=class extends Se{get question(){return this.props.question}get creator(){return this.props.creator}get table(){return this.question.renderedTable}getStateElement(){return this.table}wrapCell(e,t,s){return this.props.wrapCell(e,t,s)}renderHeader(){const e=this.question.renderedTable;if(!e.showHeader)return null;const t=[],s=e.headerRow.cells;for(var i=0;i<s.length;i++){const r=s[i],a="column"+i,o={};r.width&&(o.width=r.width),r.minWidth&&(o.minWidth=r.minWidth);const l=this.renderCellContent(r,"column-header",{}),u=r.hasTitle?y("th",{className:r.className,key:a,style:o}," ",l," "):y("td",{className:r.className,key:a,style:o});t.push(u)}return y("thead",null,y("tr",null,t))}renderFooter(){const e=this.question.renderedTable;if(!e.showFooter)return null;const t=this.renderRow("footer",e.footerRow,this.question.cssClasses,"row-footer");return y("tfoot",null,t)}renderRows(){const e=this.question.cssClasses,t=[],s=this.question.renderedTable.renderedRows;for(var i=0;i<s.length;i++)t.push(this.renderRow(s[i].id,s[i],e));return y("tbody",null,t)}renderRow(e,t,s,i){const r=[],a=t.cells;for(var o=0;o<a.length;o++)r.push(this.renderCell(a[o],s,i));const l="row"+e;return y(Me,{key:l},i=="row-footer"?y("tr",null,r):y(EC,{model:t,parentMatrix:this.question},r))}renderCell(e,t,s){const i="cell"+e.id;if(e.hasQuestion)return y(a5,{key:i,cssClasses:t,cell:e,creator:this.creator,reason:s});if(e.isErrorsCell&&e.isErrorsCell)return y(n5,{cell:e,key:i,keyValue:i,question:e.question,creator:this.creator});let r=s;r||(r=e.hasTitle?"row-header":"");const a=this.renderCellContent(e,r,t);let o=null;return(e.width||e.minWidth)&&(o={},e.width&&(o.width=e.width),e.minWidth&&(o.minWidth=e.minWidth)),y("td",{className:e.className,key:i,style:o,colSpan:e.colSpans,title:e.getTitle()},a)}renderCellContent(e,t,s){let i=null,r=null;if((e.width||e.minWidth)&&(r={},e.width&&(r.width=e.width),e.minWidth&&(r.minWidth=e.minWidth)),e.hasTitle){t="row-header";const o=this.renderLocString(e.locTitle),l=e.column?y(LC,{column:e.column,question:this.question}):null;i=y(Me,null,o,l)}if(e.isDragHandlerCell&&(i=y(Me,null,y(RC,{item:{data:{row:e.row,question:this.question}}}))),e.isActionsCell&&(i=ee.Instance.createElement("sv-matrixdynamic-actions-cell",{question:this.question,cssClasses:s,cell:e,model:e.item.getData()})),e.hasPanel&&(i=y(_r,{key:e.panel.id,element:e.panel,survey:this.question.survey,cssClasses:s,isDisplayMode:this.isDisplayMode,creator:this.creator})),!i)return null;const a=y(Me,null,i);return this.wrapCell(e,a,t)}renderElement(){const e=this.renderHeader(),t=this.renderFooter(),s=this.renderRows();return y("table",{className:this.question.getTableCss()},e,s,t)}},_C=class extends St{constructor(e){super(e),this.question.renderedTable,this.state=this.getState()}get question(){return this.questionBase}getState(e=null){return{rowCounter:e?e.rowCounter+1:0}}updateStateOnCallback(){this.isRendering||this.setState(this.getState(this.state))}componentDidMount(){super.componentDidMount(),this.question.onRenderedTableResetCallback=()=>{this.updateStateOnCallback()}}componentWillUnmount(){super.componentWillUnmount(),this.question.onRenderedTableResetCallback=()=>{}}renderElement(){return this.renderTableDiv()}renderTableDiv(){return y("div",{className:this.question.cssClasses.tableWrapper,ref:e=>this.setControl(e)},y(i5,{question:this.question,creator:this.creator,wrapCell:(e,t,s)=>this.wrapCell(e,t,s)}))}},r5=class extends ot{constructor(e){super(e)}get model(){return this.props.model}renderElement(){return y(bs,{model:this.model,handleClick:!1})}},n5=class extends bC{constructor(e){super(e)}get key(){return this.props.keyValue}get cell(){return this.props.cell}render(){return this.cell.isVisible?y("td",{className:this.cell.className,key:this.key,colSpan:this.cell.colSpans,title:this.cell.getTitle()},super.render()):null}getQuestionPropertiesToTrack(){return super.getQuestionPropertiesToTrack().concat(["visible"])}};ee.Instance.registerElement("sv-matrixdynamic-actions-cell",n=>y(r5,n));let LC=class extends ot{constructor(e){super(e)}get column(){return this.props.column}get question(){return this.props.question}getStateElement(){return this.column}renderElement(){return this.column.isRenderedRequired?y(Me,null,y("span",null,""),y("span",{className:this.question.cssClasses.cellRequiredMark},this.column.requiredMark)):null}},a5=class extends SI{constructor(e){super(e)}get cell(){return this.props.cell}get itemCss(){return this.cell?this.cell.className:""}getQuestion(){var e=super.getQuestion();return e||(this.cell?this.cell.question:null)}doAfterRender(){var e=this.cellRef.current;if(e&&this.cell&&this.question&&this.question.survey&&e.getAttribute("data-rendered")!=="r"){e.setAttribute("data-rendered","r");const t={cell:this.cell,cellQuestion:this.question,htmlElement:e,row:this.cell.row,column:this.cell.cell.column};this.question.survey.matrixAfterCellRender(t),this.question.afterRenderCore(e)}}getShowErrors(){return this.question.isVisible&&(!this.cell.isChoice||this.cell.isFirstChoice)}getCellStyle(){var e=super.getCellStyle();return(this.cell.width||this.cell.minWidth)&&(e||(e={}),this.cell.width&&(e.width=this.cell.width),this.cell.minWidth&&(e.minWidth=this.cell.minWidth)),e}getHeaderText(){return this.cell.headers}renderElement(){return this.cell.isVisible?super.renderElement():null}renderCellContent(){const e=super.renderCellContent(),t=this.cell.showResponsiveTitle?y("span",{className:this.cell.responsiveTitleCss},this.renderLocString(this.cell.responsiveLocTitle),y(LC,{column:this.cell.column,question:this.cell.matrix})):null;return y(Me,null,t,e)}renderQuestion(){return this.question.isVisible?this.cell.isChoice?this.cell.isOtherChoice?this.renderOtherComment():this.cell.isCheckbox?this.renderCellCheckboxButton():this.renderCellRadiogroupButton():yn.renderQuestionBody(this.creator,this.question):y(Me,null)}renderOtherComment(){const e=this.cell.question,t=e.cssClasses||{};return y(qh,{question:e,item:e.otherItem,cssClasses:t})}renderCellCheckboxButton(){var e=this.cell.question.id+"item"+this.cell.choiceIndex;return y(VC,{key:e,question:this.cell.question,cssClasses:this.cell.question.cssClasses,isDisplayMode:this.cell.question.isInputReadOnly,item:this.cell.item,isFirst:this.cell.isFirstChoice,index:this.cell.choiceIndex.toString(),hideCaption:!0,ariaLabel:this.getCellAriaLabel()})}renderCellRadiogroupButton(){var e=this.cell.question.id+"item"+this.cell.choiceIndex;return y(TC,{key:e,question:this.cell.question,cssClasses:this.cell.question.cssClasses,isDisplayMode:this.cell.question.isInputReadOnly,item:this.cell.item,index:this.cell.choiceIndex.toString(),isChecked:this.cell.question.value===this.cell.item.value,isDisabled:this.cell.question.isReadOnly||!this.cell.item.isEnabled,hideCaption:!0,ariaLabel:this.getCellAriaLabel()})}getCellAriaLabel(){return this.question.parentQuestion.getCellAriaLabel(this.cell.row,this.cell.column)}},o5=class extends _C{constructor(e){super(e)}};Fe.Instance.registerQuestion("matrixdropdown",n=>y(o5,n));let l5=class extends _C{constructor(e){super(e),this.handleOnRowAddClick=this.handleOnRowAddClick.bind(this)}get matrix(){return this.questionBase}handleOnRowAddClick(e){this.matrix.addRowUI()}renderElement(){var e=this.question.cssClasses,t=this.question.renderedTable.showTable,s=t?this.renderTableDiv():this.renderNoRowsContent(e);return y("div",null,this.renderAddRowButtonOnTop(e),s,this.renderAddRowButtonOnBottom(e))}renderAddRowButtonOnTop(e){return this.matrix.renderedTable.showAddRowOnTop?this.renderAddRowButton(e):null}renderAddRowButtonOnBottom(e){return this.matrix.renderedTable.showAddRowOnBottom?this.renderAddRowButton(e):null}renderNoRowsContent(e){return ee.Instance.createElement("sv-placeholder-matrixdynamic",{cssClasses:e,question:this.matrix})}renderAddRowButton(e,t=!1){return ee.Instance.createElement("sv-matrixdynamic-add-btn",{question:this.question,cssClasses:e,isEmptySection:t})}};Fe.Instance.registerQuestion("matrixdynamic",n=>y(l5,n));let u5=class extends ot{constructor(e){super(e),this.handleOnRowAddClick=this.handleOnRowAddClick.bind(this)}get matrix(){return this.props.question}handleOnRowAddClick(e){this.matrix.addRowUI()}renderElement(){const e=this.renderLocString(this.matrix.locAddRowText),t=y("button",{className:this.matrix.getAddRowButtonCss(this.props.isEmptySection),type:"button",disabled:this.matrix.isInputReadOnly,onClick:this.matrix.isDesignMode?void 0:this.handleOnRowAddClick},e,y("span",{className:this.props.cssClasses.iconAdd},this.cssClasses.iconAddId&&y("svg",null,y("use",{xlinkHref:this.cssClasses.iconAddId}))));return this.props.isEmptySection?t:y("div",{className:this.props.cssClasses.footer},t)}},h5=class extends ot{constructor(e){super(e)}renderElement(){const e=this.props.cssClasses,t=this.props.question,s=t.renderedTable.showAddRow,i=this.renderLocString(t.locNoRowsText),r=y("div",{className:e.noRowsText},i),a=s?this.renderAddRowButton(e,t):void 0;return y("div",{className:e.noRowsSection},r,a)}renderAddRowButton(e,t){return ee.Instance.createElement("sv-matrixdynamic-add-btn",{question:t,cssClasses:e,isEmptySection:!0})}};ee.Instance.registerElement("sv-matrixdynamic-add-btn",n=>y(u5,n)),ee.Instance.registerElement("sv-placeholder-matrixdynamic",n=>y(h5,n));let d5=class extends St{constructor(e){super(e)}get question(){return this.questionBase}componentDidMount(){super.componentDidMount(),this.setState({panelCounter:0});const e=this;this.question.panelCountChangedCallback=function(){e.updateQuestionRendering()},this.question.currentIndexChangedCallback=function(){e.updateQuestionRendering()},this.question.renderModeChangedCallback=function(){e.updateQuestionRendering()}}componentWillUnmount(){super.componentWillUnmount(),this.question.panelCountChangedCallback=()=>{},this.question.currentIndexChangedCallback=()=>{},this.question.renderModeChangedCallback=()=>{}}updateQuestionRendering(){this.setState({panelCounter:this.state?this.state.panelCounter+1:1})}renderElement(){const e=[],t=this.question.cssClasses;this.question.renderedPanels.forEach((a,o)=>{e.push(y(c5,{key:a.id,element:a,question:this.question,index:o,cssClasses:t,isDisplayMode:this.isDisplayMode,creator:this.creator}))});const s=this.question.isRangeShowing&&this.question.isProgressTopShowing?this.renderRange():null,i=this.renderNavigatorV2(),r=this.renderPlaceholder(t);return y("div",{className:t.root},this.question.hasTabbedMenu?y("div",{className:this.question.getTabsContainerCss()},y(bs,{model:this.question.tabbedMenu})):null,r,s,y("div",{className:this.question.cssClasses.panelsContainer},e),i)}renderRange(){return y("div",{className:this.question.cssClasses.progress},y("div",{className:this.question.cssClasses.progressBar,style:{width:this.question.progress},role:"progressbar","aria-label":this.question.progressBarAriaLabel}))}renderAddRowButton(){return ee.Instance.createElement("sv-paneldynamic-add-btn",{data:{question:this.question}})}renderNavigatorV2(){if(!this.question.showNavigation)return null;const e=this.question.isRangeShowing&&this.question.isProgressBottomShowing?this.renderRange():null;return y("div",{className:this.question.cssClasses.footer},y("hr",{className:this.question.cssClasses.separator}),e,this.question.showFooterToolbar?y("div",{className:this.question.cssClasses.footerButtonsContainer},y(bs,{model:this.question.footerToolbar})):null)}renderPlaceholder(e){return this.question.getShowNoEntriesPlaceholder()?ee.Instance.createElement("sv-placeholder-paneldynamic",{cssClasses:e,question:this.question}):null}},c5=class extends _r{get question(){return this.props.question}get index(){return this.props.index}getSurvey(){return this.question?this.question.survey:null}getCss(){const e=this.getSurvey();return e?e.getCss():{}}render(){const e=super.render(),t=this.renderButton(),s=this.question.showSeparator(this.index)?y("hr",{className:this.question.cssClasses.separator}):null;return y(Me,null,y("div",{className:this.question.getPanelWrapperCss(this.panel)},e,t),s)}renderButton(){return this.question.canRenderRemovePanelOnRight(this.panel)?ee.Instance.createElement("sv-paneldynamic-remove-btn",{data:{question:this.question,panel:this.panel}}):null}};Fe.Instance.registerQuestion("paneldynamic",n=>y(d5,n));let p5=class extends ot{constructor(e){super(e)}renderElement(){const e=this.props.cssClasses,t=this.props.question;return y("div",{className:e.noEntriesPlaceholder},y("span",null,this.renderLocString(t.locNoEntriesText)),this.renderAddRowButton(t))}renderAddRowButton(e){return ee.Instance.createElement("sv-paneldynamic-add-btn",{data:{question:e}})}};ee.Instance.registerElement("sv-placeholder-paneldynamic",n=>y(p5,n));let Do=class extends Mh{constructor(e){super(e)}get isTop(){return this.props.isTop}get progress(){return this.survey.progressValue}get progressText(){return this.survey.progressText}get progressBarAriaLabel(){return this.survey.progressBarAriaLabel}render(){var e={width:this.progress+"%"};return y("div",{className:this.survey.getProgressCssClasses(this.props.container)},y("div",{style:e,className:this.css.progressBar,role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-label":this.progressBarAriaLabel},y("span",{className:gv.getProgressTextInBarCss(this.css)},this.progressText)),y("span",{className:gv.getProgressTextUnderBarCss(this.css)},this.progressText))}};ee.Instance.registerElement("sv-progress-pages",n=>y(Do,n)),ee.Instance.registerElement("sv-progress-questions",n=>y(Do,n)),ee.Instance.registerElement("sv-progress-correctquestions",n=>y(Do,n)),ee.Instance.registerElement("sv-progress-requiredquestions",n=>y(Do,n));let g5=class extends Mh{constructor(e){super(e),this.listContainerRef=ct()}get model(){return this.props.model}get container(){return this.props.container}onResize(e){this.setState({canShowItemTitles:e}),this.setState({canShowHeader:!e})}onUpdateScroller(e){this.setState({hasScroller:e})}onUpdateSettings(){this.setState({canShowItemTitles:this.model.showItemTitles}),this.setState({canShowFooter:!this.model.showItemTitles})}render(){return y("div",{className:this.model.getRootCss(this.props.container),style:{maxWidth:this.model.progressWidth},role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-label":this.model.progressBarAriaLabel},this.state.canShowHeader?y("div",{className:this.css.progressButtonsHeader},y("div",{className:this.css.progressButtonsPageTitle,title:this.model.headerText},this.model.headerText)):null,y("div",{className:this.css.progressButtonsContainer},y("div",{className:this.model.getScrollButtonCss(this.state.hasScroller,!0),role:"button",onClick:()=>this.clickScrollButton(this.listContainerRef.current,!0)}),y("div",{className:this.css.progressButtonsListContainer,ref:this.listContainerRef},y("ul",{className:this.css.progressButtonsList},this.getListElements())),y("div",{className:this.model.getScrollButtonCss(this.state.hasScroller,!1),role:"button",onClick:()=>this.clickScrollButton(this.listContainerRef.current,!1)})),this.state.canShowFooter?y("div",{className:this.css.progressButtonsFooter},y("div",{className:this.css.progressButtonsPageTitle,title:this.model.footerText},this.model.footerText)):null)}getListElements(){let e=[];return this.survey.visiblePages.forEach((t,s)=>{e.push(this.renderListElement(t,s))}),e}renderListElement(e,t){const s=Se.renderLocString(e.locNavigationTitle);return y("li",{key:"listelement"+t,className:this.model.getListElementCss(t),onClick:this.model.isListElementClickable(t)?()=>this.model.clickListElement(e):void 0,"data-page-number":this.model.getItemNumber(e)},y("div",{className:this.css.progressButtonsConnector}),this.state.canShowItemTitles?y(Me,null,y("div",{className:this.css.progressButtonsPageTitle,title:e.renderedNavigationTitle},s),y("div",{className:this.css.progressButtonsPageDescription,title:e.navigationDescription},e.navigationDescription)):null,y("div",{className:this.css.progressButtonsButton},y("div",{className:this.css.progressButtonsButtonBackground}),y("div",{className:this.css.progressButtonsButtonContent}),y("span",null,this.model.getItemNumber(e))))}clickScrollButton(e,t){e&&(e.scrollLeft+=(t?-1:1)*70)}componentDidMount(){super.componentDidMount(),setTimeout(()=>{this.respManager=new JP(this.model,this.listContainerRef.current,this)},10)}componentWillUnmount(){this.respManager&&this.respManager.dispose(),super.componentWillUnmount()}};ee.Instance.registerElement("sv-progress-buttons",n=>y(g5,n));let AC=class extends Se{constructor(e){super(e),this.handleKeydown=t=>{this.model.onKeyDown(t)},this.elementRef=ct()}get model(){return this.props.model}get item(){return this.props.item}getStateElement(){return this.item}render(){if(!this.item)return null;const e=this.model.getItemClass(this.item),t=this.item.component||this.model.itemComponent,s=ee.Instance.createElement(t,{item:this.item,key:this.item.id,model:this.model}),i=y("div",{ref:this.elementRef,style:this.model.getItemStyle(this.item),className:this.model.cssClasses.itemBody,title:this.item.getTooltip(),onMouseOver:l=>{this.model.onItemHover(this.item)},onMouseLeave:l=>{this.model.onItemLeave(this.item)}},s),r=this.item.needSeparator?y("div",{className:this.model.cssClasses.itemSeparator}):null,o={display:this.model.isItemVisible(this.item)?null:"none"};return Oh(y("li",{className:e,role:this.model.listItemRole,style:o,id:this.item.elementId,"aria-selected":this.model.getA11yItemAriaSelected(this.item),"aria-checked":this.model.getA11yItemAriaChecked(this.item),onClick:l=>{this.model.onItemClick(this.item),l.stopPropagation()},onPointerDown:l=>this.model.onPointerDown(l,this.item)},r,i),this.item)}componentDidMount(){var e;super.componentDidMount(),this.model.onItemRended(this.item,(e=this.elementRef)===null||e===void 0?void 0:e.current)}};ee.Instance.registerElement("sv-list-item",n=>y(AC,n));let DC=class extends Se{constructor(e){super(e),this.handleKeydown=t=>{this.model.onKeyDown(t)},this.handleMouseMove=t=>{this.model.onMouseMove(t)},this.state={filterString:this.model.filterString||""},this.listContainerRef=ct()}get model(){return this.props.model}getStateElement(){return this.model}componentDidMount(){super.componentDidMount(),this.listContainerRef&&this.listContainerRef.current&&this.model.initListContainerHtmlElement(this.listContainerRef.current)}componentDidUpdate(e,t){var s;super.componentDidUpdate(e,t),this.model!==e.model&&(this.model&&(!((s=this.listContainerRef)===null||s===void 0)&&s.current)&&this.model.initListContainerHtmlElement(this.listContainerRef.current),e.model&&e.model.initListContainerHtmlElement(void 0))}componentWillUnmount(){super.componentWillUnmount(),this.model&&this.model.initListContainerHtmlElement(void 0)}renderElement(){return y("div",{className:this.model.cssClasses.root,ref:this.listContainerRef},this.searchElementContent(),this.emptyContent(),this.renderList())}renderList(){if(!this.model.renderElements)return null;const e=this.renderItems(),t={display:this.model.isEmpty?"none":null};return y("ul",{className:this.model.getListClass(),style:t,role:this.model.listRole,"aria-label":this.model.a11ya11y_input_ariaLabel,id:this.model.elementId,onMouseDown:s=>{s.preventDefault()},onKeyDown:this.handleKeydown,onMouseMove:this.handleMouseMove},e)}renderItems(){if(!this.model)return null;const e=this.model.renderedActions;return e?e.map((t,s)=>y(AC,{model:this.model,item:t,key:"item"+s})):null}searchElementContent(){if(this.model.showFilter){const e=i=>{var r;const a=(r=i.target.getRootNode())===null||r===void 0?void 0:r.activeElement;i.target===a&&(this.model.filterString=i.target.value)},t=i=>{this.model.goToItems(i)},s=this.model.showSearchClearButton&&this.model.filterString?y("button",{className:this.model.cssClasses.searchClearButtonIcon,onClick:i=>{this.model.onClickSearchClearButton(i)}},y(Be,{iconName:"icon-searchclear",size:"auto"})):null;return y("div",{className:this.model.cssClasses.filter},y("div",{className:this.model.cssClasses.filterIcon},y(Be,{iconName:"icon-search",size:"auto"})),y("input",{type:"text",className:this.model.cssClasses.filterInput,"aria-label":this.model.filterStringPlaceholder,placeholder:this.model.filterStringPlaceholder,value:this.state.filterString,onKeyUp:t,onChange:e}),s)}else return null}emptyContent(){const e={display:this.model.isEmpty?null:"none"};return y("div",{className:this.model.cssClasses.emptyContainer,style:e},y("div",{className:this.model.cssClasses.emptyText,"aria-label":this.model.emptyMessage},this.model.emptyMessage))}};ee.Instance.registerElement("sv-list",n=>y(DC,n));let m5=class extends Mh{componentDidMount(){super.componentDidMount(),this.props.model.updateStickyTOCSize(this.survey.rootElement)}render(){const e=this.props.model;let t;return e.isMobile?t=y("div",{onClick:e.togglePopup},y(Be,{iconName:e.icon,size:24}),y(fn,{model:e.popupModel})):t=y(DC,{model:e.listModel}),y("div",{className:e.containerCss},t)}};ee.Instance.registerElement("sv-navigation-toc",n=>y(m5,n));let f5=class extends St{constructor(e){super(e),this.handleOnClick=this.handleOnClick.bind(this)}get question(){return this.questionBase}handleOnClick(e){this.question.setValueFromClick(e.target.value),this.setState({value:this.question.value})}renderItem(e,t){return ee.Instance.createElement(this.question.itemComponent,{question:this.question,item:e,index:t,key:"value"+t,handleOnClick:this.handleOnClick,isDisplayMode:this.isDisplayMode})}renderElement(){var e=this.question.cssClasses,t=this.question.minRateDescription?this.renderLocString(this.question.locMinRateDescription):null,s=this.question.maxRateDescription?this.renderLocString(this.question.locMaxRateDescription):null;return y("div",{className:this.question.ratingRootCss,ref:i=>this.setControl(i)},y("fieldset",{role:this.question.a11y_input_ariaRole,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-labelledby":this.question.a11y_input_ariaLabelledBy,"aria-describedby":this.question.a11y_input_ariaDescribedBy,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage},y("legend",{role:"presentation",className:"sv-hidden"}),this.question.hasMinLabel?y("span",{className:e.minText},t):null,this.question.renderedRateItems.map((i,r)=>this.renderItem(i,r)),this.question.hasMaxLabel?y("span",{className:e.maxText},s):null))}};Fe.Instance.registerQuestion("rating",n=>y(f5,n));let y5=class extends Ao{constructor(e){super(e)}renderElement(){var e=this.question.cssClasses,t=this.renderSelect(e);return y("div",{className:this.question.cssClasses.rootDropdown},t)}};Fe.Instance.registerQuestion("sv-rating-dropdown",n=>y(y5,n)),ai.Instance.registerRenderer("rating","dropdown","sv-rating-dropdown");let v5=class extends St{constructor(e){super(e),this.rangeInputRef=ct()}componentDidMount(){super.componentDidMount(),this.question.refreshInputRange(this.rangeInputRef.current)}get question(){return this.questionBase}getStateElement(){return this.question}renderElement(){const{cssClasses:e,showLabels:t,sliderType:s,getTrackPercentLeft:i,getTrackPercentRight:r,allowDragRange:a,setValueByClickOnPath:o}=this.question,l=s==="single"&&a?null:this.getRangeInput(),u=this.getInputsAndThumbs(),d=t?this.getLabels():null;return y("div",{className:this.question.rootCss,ref:h=>this.setControl(h)},l,y("div",{className:e.visualContainer,onPointerUp:h=>{o(h.nativeEvent,this.control)}},y("div",{className:e.visualContainerSlider},y("div",{className:e.inverseTrackLeft,style:{width:i()+"%"}}),y("div",{className:e.inverseTrackRight,style:{width:r()+"%"}}),y("div",{className:e.rangeTrack,style:{left:i()+"%",right:r()+"%"}}),u)),d)}getInputsAndThumbs(){const e=[],t=this.question.renderedValue;for(let s=0;s<t.length;s++){const i=y(Me,{key:s},this.getInput(s),this.getThumb(s));e.push(i)}return e}getThumb(e){const{cssClasses:t,getThumbContainerCss:s,tooltipVisibility:i,tooltipCss:r,getPercent:a,renderedValue:o,getTooltipValue:l}=this.question,u=o[e];let d=null;return i!=="never"&&(d=y("div",{className:r},y("div",{className:t.tooltipPanel},y("div",{className:t.tooltipValue},l(e))))),y("div",{className:s(e),style:{left:a(u)+"%"}},d,y("div",{className:t.thumb},y("div",{className:t.thumbDot})))}getInput(e){const{renderedMax:t,renderedMin:s,step:i,cssClasses:r,isDisabledAttr:a,renderedValue:o,handleOnChange:l,handlePointerDown:u,handlePointerUp:d,handleKeyDown:h,handleKeyUp:f,handleOnFocus:C,handleOnBlur:b,id:x}=this.question,V=o[e];return y("input",{className:r.input,id:x+"-sjs-slider-input-"+e,type:"range",min:s,max:t,step:i,value:V,onChange:M=>{l(M.nativeEvent,e)},onPointerDown:M=>{u(M.nativeEvent)},onPointerUp:M=>{M.stopPropagation(),d(M.nativeEvent)},onKeyDown:M=>{h(M.nativeEvent)},onKeyUp:M=>{f(M.nativeEvent)},onFocus:()=>{C(e)},onBlur:()=>{b()},disabled:a,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-labelledby":this.question.a11y_input_ariaLabelledBy,"aria-describedby":this.question.a11y_input_ariaDescribedBy,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage})}getRangeInput(){const{renderedMax:e,renderedMin:t,step:s,cssClasses:i,handleRangeOnChange:r,handleRangePointerDown:a,handleRangePointerUp:o,id:l}=this.question;return y("input",{name:"range-input",id:l+"-sjs-slider-input-range-input",ref:this.rangeInputRef,className:i.input,type:"range","aria-hidden":"true",min:t,max:e,step:s,tabIndex:-1,onChange:u=>{r(u.nativeEvent)},onPointerDown:u=>{u.persist(),a(u.nativeEvent,this.control)},onPointerUp:u=>{o(u.nativeEvent,this.control)}})}getLabels(){const e=[],{renderedLabels:t,cssClasses:s}=this.question;for(let i=0;i<t.length;i++){const r=ee.Instance.createElement("sv-slider-label-item",{item:t[i],question:this.question,key:t[i].id});e.push(r)}return y("div",{className:s.labelsContainer},y("div",null,e))}};Fe.Instance.registerQuestion("slider",n=>y(v5,n));let C5=class extends St{constructor(e){super(e)}get question(){return this.questionBase}renderElement(){var e=this.question.cssClasses;return y("div",{id:this.question.inputId,className:e.root,ref:t=>this.setControl(t),"aria-live":"polite","aria-label":this.question.formatedValue},this.question.formatedValue)}};Fe.Instance.registerQuestion("expression",n=>y(C5,n));let b5=class extends Dh{constructor(e){super(e),this.handleOnExpanded=this.handleOnExpanded.bind(this)}getStateElements(){return[this.popup,this.popup.survey]}handleOnExpanded(e){this.popup.changeExpandCollapse()}canRender(){return super.canRender()&&this.popup.isShowing}renderElement(){var e=this.renderWindowHeader(),t=this.renderBody();let s={};return this.popup.renderedWidth&&(s.width=this.popup.renderedWidth,s.maxWidth=this.popup.renderedWidth),y("div",{className:this.popup.cssRoot,style:s,onScroll:()=>this.popup.onScroll()},y("div",{className:this.popup.cssRootContent},e,t))}renderWindowHeader(){var e=this.popup,t=e.cssHeaderRoot,s=null,i,r=null,a=null;return e.isCollapsed?(t+=" "+e.cssRootCollapsedMod,s=this.renderTitleCollapsed(e),i=this.renderExpandIcon()):i=this.renderCollapseIcon(),e.allowClose&&(r=this.renderCloseButton(this.popup)),e.allowFullScreen&&(a=this.renderAllowFullScreenButon(this.popup)),y("div",{className:e.cssHeaderRoot},s,y("div",{className:e.cssHeaderButtonsContainer},a,y("div",{className:e.cssHeaderCollapseButton,onClick:this.handleOnExpanded},i),r))}renderTitleCollapsed(e){return e.locTitle?y("div",{className:e.cssHeaderTitleCollapsed},e.locTitle.renderedHtml):null}renderExpandIcon(){return y(Be,{iconName:"icon-restore_16x16",size:16})}renderCollapseIcon(){return y(Be,{iconName:"icon-minimize_16x16",size:16})}renderCloseButton(e){return y("div",{className:e.cssHeaderCloseButton,onClick:()=>{e.hide(),typeof this.props.onClose=="function"&&this.props.onClose()}},y(Be,{iconName:"icon-close_16x16",size:16}))}renderAllowFullScreenButon(e){let t;return e.isFullScreen?t=y(Be,{iconName:"icon-back-to-panel_16x16",size:16}):t=y(Be,{iconName:"icon-full-screen_16x16",size:16}),y("div",{className:e.cssHeaderFullScreenButton,onClick:()=>{e.toggleFullScreen()}},t)}renderBody(){return y("div",{className:this.popup.cssBody},this.doRender())}createSurvey(e){e||(e={}),super.createSurvey(e),this.popup=new fv(null,this.survey),e.closeOnCompleteTimeout&&(this.popup.closeOnCompleteTimeout=e.closeOnCompleteTimeout),this.popup.allowClose=e.allowClose,this.popup.allowFullScreen=e.allowFullScreen,this.popup.isShowing=!0,!this.popup.isExpanded&&(e.expanded||e.isExpanded)&&this.popup.expand()}},w5=class extends St{constructor(e){super(e)}get question(){return this.questionBase}renderElement(){var e=this.question.cssClasses;return y("fieldset",{className:this.question.getSelectBaseRootCss(),style:this.question.getContainerStyle()},y("legend",{className:"sv-hidden"},this.question.locTitle.renderedHtml),this.question.hasColumns?this.getColumns(e):this.getItems(e))}getColumns(e){return this.question.columns.map((t,s)=>{var i=t.map((r,a)=>this.renderItem(r,e));return y("div",{key:"column"+s+this.question.getItemsColumnKey(t),className:this.question.getColumnClass(),role:"presentation"},i)})}getItems(e){for(var t=[],s=0;s<this.question.visibleChoices.length;s++){var i=this.question.visibleChoices[s];t.push(this.renderItem(i,e))}return t}get textStyle(){return{marginLeft:"3px",display:"inline",position:"static"}}renderItem(e,t){const s=y(x5,{key:e.uniqueId,question:this.question,item:e,cssClasses:t}),i=this.question.survey;let r=null;return i&&(r=$s.wrapItemValue(i,s,this.question,e)),r??s}},x5=class extends ot{constructor(e){super(e),this.handleOnChange=this.handleOnChange.bind(this)}getStateElement(){return this.item}componentDidMount(){super.componentDidMount(),this.reactOnStrChanged()}componentWillUnmount(){super.componentWillUnmount(),this.item.locImageLink.onChanged=function(){}}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.reactOnStrChanged()}reactOnStrChanged(){this.item.locImageLink.onChanged=()=>{this.setState({locImageLinkchanged:this.state&&this.state.locImageLink?this.state.locImageLink+1:1})}}get cssClasses(){return this.props.cssClasses}get item(){return this.props.item}get question(){return this.props.question}handleOnChange(e){if(!this.question.isReadOnlyAttr){if(this.question.multiSelect)if(e.target.checked)this.question.value=this.question.value.concat(e.target.value);else{var t=this.question.value;t.splice(this.question.value.indexOf(e.target.value),1),this.question.value=t}else this.question.value=e.target.value;this.setState({value:this.question.value})}}renderElement(){const e=this.item,t=this.question,s=this.cssClasses;var i=t.isItemSelected(e),r=t.getItemClass(e),a=null;t.showLabel&&(a=y("span",{className:t.cssClasses.itemText},e.text?Se.renderLocString(e.locText):e.value));var o={objectFit:this.question.imageFit},l=null;if(e.locImageLink.renderedHtml&&this.question.contentMode==="image"&&(l=y("img",{className:s.image,src:e.locImageLink.renderedHtml,width:this.question.renderedImageWidth,height:this.question.renderedImageHeight,alt:e.locText.renderedHtml,style:o,onLoad:d=>{this.question.onContentLoaded(e,d.nativeEvent)},onError:d=>{e.onErrorHandler(e,d.nativeEvent)}})),e.locImageLink.renderedHtml&&this.question.contentMode==="video"&&(l=y("video",{controls:!0,className:s.image,src:e.locImageLink.renderedHtml,width:this.question.renderedImageWidth,height:this.question.renderedImageHeight,style:o,onLoadedMetadata:d=>{this.question.onContentLoaded(e,d.nativeEvent)},onError:d=>{e.onErrorHandler(e,d.nativeEvent)}})),!e.locImageLink.renderedHtml||e.contentNotLoaded){let d={width:this.question.renderedImageWidth,height:this.question.renderedImageHeight,objectFit:this.question.imageFit};l=y("div",{className:s.itemNoImage,style:d},s.itemNoImageSvgIcon?y(Be,{className:s.itemNoImageSvgIcon,iconName:this.question.cssClasses.itemNoImageSvgIconId,size:48}):null)}return y("div",{className:r},y("label",{className:s.label},y("input",{className:s.itemControl,id:this.question.getItemId(e),type:this.question.inputType,name:this.question.questionName,checked:i,value:e.value,disabled:!this.question.getItemEnabled(e),readOnly:this.question.isReadOnlyAttr,onChange:this.handleOnChange,required:this.question.inputRequiredAttribute,"aria-label":e.locText.renderedHtml,"aria-invalid":this.question.ariaInvalid,"aria-errormessage":this.question.ariaErrormessage}),y("div",{className:this.question.cssClasses.itemDecorator},y("div",{className:this.question.cssClasses.imageContainer},this.question.cssClasses.checkedItemDecorator?y("span",{className:this.question.cssClasses.checkedItemDecorator,"aria-hidden":"true"},this.question.cssClasses.checkedItemSvgIconId?y(Be,{size:"auto",className:this.question.cssClasses.checkedItemSvgIcon,iconName:this.question.cssClasses.checkedItemSvgIconId}):null):null,l),a)))}};Fe.Instance.registerQuestion("imagepicker",n=>y(w5,n));let V5=class extends St{constructor(e){super(e)}componentDidMount(){super.componentDidMount(),this.question.locImageLink.onChanged=()=>{this.forceUpdate()}}componentWillUnmount(){super.componentWillUnmount(),this.question.locImageLink.onChanged=()=>{}}get question(){return this.questionBase}renderElement(){var e=this.question.getImageCss(),t={objectFit:this.question.imageFit,width:this.question.renderedStyleWidth,height:this.question.renderedStyleHeight};(!this.question.imageLink||this.question.contentNotLoaded)&&(t.display="none");var s=null;this.question.renderedMode==="image"&&(s=y("img",{className:e,src:this.question.locImageLink.renderedHtml||null,alt:this.question.renderedAltText,width:this.question.renderedWidth,height:this.question.renderedHeight,style:t,onLoad:r=>{this.question.onLoadHandler()},onError:r=>{this.question.onErrorHandler()}})),this.question.renderedMode==="video"&&(s=y("video",{controls:!0,className:e,src:this.question.locImageLink.renderedHtml,width:this.question.renderedWidth,height:this.question.renderedHeight,style:t,onLoadedMetadata:r=>{this.question.onLoadHandler()},onError:r=>{this.question.onErrorHandler()}})),this.question.renderedMode==="youtube"&&(s=y("iframe",{className:e,src:this.question.locImageLink.renderedHtml,width:this.question.renderedWidth,height:this.question.renderedHeight,style:t,title:this.question.renderedAltText}));var i=null;return(!this.question.imageLink||this.question.contentNotLoaded)&&(i=y("div",{className:this.question.cssClasses.noImage},y(Be,{iconName:this.question.cssClasses.noImageSvgIconId,size:48}))),y("div",{className:this.question.cssClasses.root},s,i)}};Fe.Instance.registerQuestion("image",n=>y(V5,n));let P5=class extends St{constructor(e){super(e),this.state={value:this.question.value}}get question(){return this.questionBase}renderElement(){var e=this.question.cssClasses;const t=this.question.showLoadingIndicator?this.renderLoadingIndicator():null;var s=this.renderCleanButton();return y("div",{className:e.root,ref:i=>this.setControl(i),style:{width:this.question.renderedCanvasWidth}},y("div",{className:e.placeholder,style:{display:this.question.needShowPlaceholder()?"":"none"}},this.renderLocString(this.question.locRenderedPlaceholder)),y("div",null,this.renderBackgroundImage(),y("canvas",{tabIndex:-1,className:this.question.cssClasses.canvas,onBlur:i=>{this.question.onBlur(i)}})),s,t)}renderBackgroundImage(){return this.question.backgroundImage?y("img",{className:this.question.cssClasses.backgroundImage,src:this.question.backgroundImage,style:{width:this.question.renderedCanvasWidth},role:"presentation"}):null}renderLoadingIndicator(){return y("div",{className:this.question.cssClasses.loadingIndicator},y(IC,null))}renderCleanButton(){if(!this.question.canShowClearButton)return null;var e=this.question.cssClasses;return y("div",{className:e.controls},y("button",{type:"button",className:e.clearButton,title:this.question.clearButtonCaption,onClick:()=>this.question.clearValueFromUI()},this.question.cssClasses.clearButtonIconId?y(Be,{iconName:this.question.cssClasses.clearButtonIconId,size:"auto"}):y("span",null,"")," "))}};Fe.Instance.registerQuestion("signaturepad",n=>y(P5,n));let S5=class extends St{constructor(e){super(e)}get question(){return this.questionBase}getStateElement(){return this.question}renderElement(){const e=this.renderItems();return y("div",{className:this.question.cssClasses.root},e)}renderItems(){return this.question.visibleChoices.map((e,t)=>y(I5,{key:this.question.inputId+"_"+t,item:e,question:this.question,index:t}))}};Fe.Instance.registerQuestion("buttongroup",n=>y(S5,n));let I5=class extends Se{constructor(e){super(e)}get index(){return this.props.index}get question(){return this.props.question}get item(){return this.props.item}getStateElement(){return this.item}renderElement(){this.model=new qS(this.question,this.item,this.index);const e=this.renderIcon(),t=this.renderInput(),s=this.renderCaption();return y("label",{className:this.model.css.label,title:this.model.caption.renderedHtml},t,y("div",{className:this.model.css.decorator},e,s))}renderIcon(){return this.model.iconName?y(Be,{className:this.model.css.icon,iconName:this.model.iconName,size:this.model.iconSize||24}):null}renderInput(){return y("input",{className:this.model.css.control,id:this.model.id,type:"radio",name:this.model.name,checked:this.model.selected,value:this.model.value,disabled:this.model.readOnly,onChange:()=>{this.model.onChange()},"aria-required":this.model.isRequired,"aria-label":this.model.caption.renderedHtml,"aria-invalid":this.model.hasErrors,"aria-errormessage":this.model.describedBy})}renderCaption(){if(!this.model.showCaption)return null;let e=this.renderLocString(this.model.caption);return y("span",{className:this.model.css.caption,title:this.model.caption.renderedHtml},e)}},T5=class extends Ao{constructor(e){super(e)}renderElement(){const e=this.question.cssClasses,t=this.renderSelect(e);return y("div",{className:this.question.cssClasses.rootDropdown},t)}};Fe.Instance.registerQuestion("sv-buttongroup-dropdown",n=>y(T5,n)),ai.Instance.registerRenderer("buttongroup","dropdown","sv-buttongroup-dropdown");let E5=class extends gn{constructor(e){super(e)}getStateElements(){const e=super.getStateElements();return this.question.contentQuestion&&e.push(this.question.contentQuestion),e}renderElement(){return yn.renderQuestionBody(this.creator,this.question.contentQuestion)}},R5=class extends gn{constructor(e){super(e)}canRender(){return!!this.question.contentPanel}renderElement(){return y(_r,{element:this.question.contentPanel,creator:this.creator,survey:this.question.survey})}};Fe.Instance.registerQuestion("custom",n=>y(E5,n)),Fe.Instance.registerQuestion("composite",n=>y(R5,n));let _5=class extends Se{get model(){return this.props.model}get item(){return this.props.item}getStateElement(){return this.item}render(){if(!this.item)return null;const e=this.renderLocString(this.item.locTitle,void 0,"locString"),t=this.item.iconName?y(Be,{className:this.model.cssClasses.itemIcon,iconName:this.item.iconName,size:this.item.iconSize,"aria-label":this.item.title}):null,s=this.item.markerIconName?y(Be,{className:this.item.cssClasses.itemMarkerIcon,iconName:this.item.markerIconName,size:"auto"}):null;return y(Me,null,t,e,s)}};ee.Instance.registerElement("sv-list-item-content",n=>y(_5,n));let L5=class extends Se{get model(){return this.props.model}get item(){return this.props.item}getStateElement(){return this.item}render(){var e;if(!this.item)return null;const t=ee.Instance.createElement("sv-list-item-content",{item:this.item,key:"content"+this.item.id,model:this.model});return y(Me,null,t,y(fn,{model:(e=this.item)===null||e===void 0?void 0:e.popupModel}))}};ee.Instance.registerElement("sv-list-item-group",n=>y(L5,n));let A5=class extends Ge{constructor(e){super(e)}get survey(){return this.props.data}render(){const e=[];return e.push(y("div",{key:"logo-image",className:this.survey.logoClassNames},y("img",{className:this.survey.css.logoImage,src:this.survey.locLogo.renderedHtml||null,alt:this.survey.locTitle.renderedHtml,width:this.survey.renderedLogoWidth,height:this.survey.renderedLogoHeight,style:{objectFit:this.survey.logoFit,width:this.survey.renderedStyleLogoWidth,height:this.survey.renderedStyleLogoHeight}}))),y(Me,null,e)}};ee.Instance.registerElement("sv-logo-image",n=>y(A5,n));let D5=class extends ot{constructor(e){super(e),this.handleOnRowRemoveClick=this.handleOnRowRemoveClick.bind(this)}get question(){return this.props.item.data.question}get row(){return this.props.item.data.row}handleOnRowRemoveClick(e){this.question.removeRowUI(this.row)}renderElement(){var e=this.renderLocString(this.question.locRemoveRowText);return y("button",{className:this.question.getRemoveRowButtonCss(),type:"button",onClick:this.handleOnRowRemoveClick,disabled:this.question.isInputReadOnly},e,y("span",{className:this.question.cssClasses.iconRemove}))}};ee.Instance.registerElement("sv-matrix-remove-button",n=>y(D5,n));let O5=class extends ot{constructor(e){super(e),this.handleOnShowHideClick=this.handleOnShowHideClick.bind(this)}getStateElement(){return this.props.item}get item(){return this.props.item}get question(){return this.props.item.data.question}get row(){return this.props.item.data.row}handleOnShowHideClick(e){this.row.showHideDetailPanelClick()}renderElement(){var e=this.row.isDetailPanelShowing,t=e,s=e?this.row.detailPanelId:void 0;return y("button",{type:"button",title:this.props.item.title,onClick:this.handleOnShowHideClick,className:this.question.getDetailPanelButtonCss(this.row),"aria-expanded":t,"aria-controls":s},y(Be,{className:this.question.getDetailPanelIconCss(this.row),iconName:this.question.getDetailPanelIconId(this.row),size:"auto"}))}};ee.Instance.registerElement("sv-matrix-detail-button",n=>y(O5,n));let vn=class extends ot{constructor(e){super(e)}get data(){return this.props.item&&this.props.item.data||this.props.data}get question(){return this.props.item&&this.props.item.data.question||this.props.data.question}},M5=class extends vn{constructor(){super(...arguments),this.handleClick=e=>{this.question.addPanelUI()}}renderElement(){if(!this.question.canAddPanel)return null;const e=this.renderLocString(this.question.locAddPanelText);return y("button",{type:"button",id:this.question.addButtonId,className:this.question.getAddButtonCss(),onClick:this.handleClick},y("span",{className:this.question.cssClasses.buttonAddText},e))}};ee.Instance.registerElement("sv-paneldynamic-add-btn",n=>y(M5,n));let k5=class extends vn{constructor(){super(...arguments),this.handleClick=e=>{this.question.removePanelUI(this.data.panel)}}renderElement(){const e=this.renderLocString(this.question.locRemovePanelText),t=this.question.getPanelRemoveButtonId(this.data.panel);return y("button",{id:t,className:this.question.getPanelRemoveButtonCss(),onClick:this.handleClick,type:"button"},y("span",{className:this.question.cssClasses.buttonRemoveText},e),y("span",{className:this.question.cssClasses.iconRemove}))}};ee.Instance.registerElement("sv-paneldynamic-remove-btn",n=>y(k5,n));let N5=class extends vn{constructor(){super(...arguments),this.handleClick=e=>{this.question.goToPrevPanel()}}renderElement(){return y("div",{title:this.question.panelPrevText,onClick:this.handleClick,className:this.question.getPrevButtonCss()},y(Be,{iconName:this.question.cssClasses.progressBtnIcon,size:"auto"}))}};ee.Instance.registerElement("sv-paneldynamic-prev-btn",n=>y(N5,n));let q5=class extends vn{constructor(){super(...arguments),this.handleClick=e=>{this.question.goToNextPanel()}}renderElement(){return y("div",{title:this.question.panelNextText,onClick:this.handleClick,className:this.question.getNextButtonCss()},y(Be,{iconName:this.question.cssClasses.progressBtnIcon,size:"auto"}))}};ee.Instance.registerElement("sv-paneldynamic-next-btn",n=>y(q5,n));let B5=class extends vn{renderElement(){return y("div",{className:this.question.cssClasses.progressText},this.question.progressText)}};ee.Instance.registerElement("sv-paneldynamic-progress-text",n=>y(B5,n));let F5=class extends ot{get item(){return this.props.item}canRender(){return this.item.isVisible}renderElement(){return y("input",{className:this.item.innerCss,type:"button",disabled:this.item.disabled,onMouseDown:this.item.data&&this.item.data.mouseDown,onClick:this.item.action,title:this.item.getTooltip(),value:this.item.title})}};ee.Instance.registerElement("sv-nav-btn",n=>y(F5,n));let OC=class extends Ge{constructor(e){super(e),this.onChangedHandler=(t,s)=>{this.isRendering||this.setState({changed:this.state&&this.state.changed?this.state.changed+1:1})},this.rootRef=ct()}get locStr(){return this.props.locStr}get style(){return this.props.style}componentDidMount(){this.reactOnStrChanged()}componentWillUnmount(){this.locStr&&this.locStr.onStringChanged.remove(this.onChangedHandler)}componentDidUpdate(e,t){e.locStr&&e.locStr.onStringChanged.remove(this.onChangedHandler),this.reactOnStrChanged()}reactOnStrChanged(){this.locStr&&this.locStr.onStringChanged.add(this.onChangedHandler)}render(){if(!this.locStr)return null;this.isRendering=!0;const e=this.renderString();return this.isRendering=!1,e}renderString(){const e=this.locStr.allowLineBreaks?"sv-string-viewer sv-string-viewer--multiline":"sv-string-viewer";if(this.locStr.hasHtml){let t={__html:this.locStr.renderedHtml};return y("span",{ref:this.rootRef,className:e,style:this.style,dangerouslySetInnerHTML:t})}return y("span",{ref:this.rootRef,className:e,style:this.style},this.locStr.renderedHtml)}};ee.Instance.registerElement(At.defaultRenderer,n=>y(OC,n));let Q5=class extends Ge{render(){const e=this.props.error,t=this.props.cssClasses;return y("div",null,y("span",{className:e.getCssIcon(t),"aria-hidden":"true"}),y("span",{className:this.props.cssClasses.error.item||void 0},y(OC,{locStr:e.locText})))}};ee.Instance.registerElement("sv-question-error",n=>y(Q5,n));let H5=class extends Se{getStateElement(){return this.item}get item(){return this.props.item}get question(){return this.props.question}componentDidUpdate(e,t){super.componentDidUpdate(e,t)}renderElement(){const{cssClasses:e,handleLabelPointerUp:t,getLabelCss:s,getPercent:i}=this.question,{value:r,locText:a}=this.item;let o=null,l=null;return this.item.showValue?(o=y("div",{className:e.labelText},this.item.value),l=y("div",{className:e.labelTextSecondaryMode},this.renderLocString(a))):o=y("div",{className:e.labelText},this.renderLocString(a)),y("div",{key:this.item.uniqueId,className:s(a),style:{left:i(r)+"%"},onPointerUp:u=>{t(u.nativeEvent,r)}},y("div",{className:e.labelTick}),y("div",{className:e.labelTextContainer},o,l))}};ee.Instance.registerElement("sv-slider-label-item",n=>y(H5,n));let z5=class extends Ge{render(){var e,t;return y("div",{className:"sv-skeleton-element",id:(e=this.props.element)===null||e===void 0?void 0:e.id,style:{height:(t=this.props.element)===null||t===void 0?void 0:t.skeletonHeight}})}};ee.Instance.registerElement("sv-skeleton",n=>y(z5,n));let j5=class extends Ge{get model(){return this.props.model}renderLogoImage(){const e=this.model.survey.getElementWrapperComponentName(this.model.survey,"logo-image"),t=this.model.survey.getElementWrapperComponentData(this.model.survey,"logo-image");return ee.Instance.createElement(e,{data:t})}render(){return y("div",{className:"sv-header--mobile"},this.model.survey.hasLogo?y("div",{className:"sv-header__logo"},this.renderLogoImage()):null,this.model.survey.hasTitle?y("div",{className:"sv-header__title",style:{maxWidth:this.model.renderedTextAreaWidth}},y(Rr,{element:this.model.survey})):null,this.model.survey.renderedHasDescription?y("div",{className:"sv-header__description",style:{maxWidth:this.model.renderedTextAreaWidth}},y("div",{className:this.model.survey.css.description},Se.renderLocString(this.model.survey.locDescription))):null)}},U5=class extends Ge{get model(){return this.props.model}renderLogoImage(){const e=this.model.survey.getElementWrapperComponentName(this.model.survey,"logo-image"),t=this.model.survey.getElementWrapperComponentData(this.model.survey,"logo-image");return ee.Instance.createElement(e,{data:t})}render(){return y("div",{className:this.model.css,style:this.model.style},y("div",{className:"sv-header__cell-content",style:this.model.contentStyle},this.model.showLogo?y("div",{className:"sv-header__logo"},this.renderLogoImage()):null,this.model.showTitle?y("div",{className:"sv-header__title",style:{maxWidth:this.model.textAreaWidth}},y(Rr,{element:this.model.survey})):null,this.model.showDescription?y("div",{className:"sv-header__description",style:{maxWidth:this.model.textAreaWidth}},y("div",{className:this.model.survey.css.description},Se.renderLocString(this.model.survey.locDescription))):null))}},W5=class extends Se{get model(){return this.props.model}getStateElement(){return this.model}renderElement(){if(this.model.survey=this.props.survey,this.props.survey.headerView!=="advanced"||this.model.isEmpty)return null;let e=null;return this.props.survey.isMobile?e=y(j5,{model:this.model}):e=y("div",{className:this.model.contentClasses,style:{maxWidth:this.model.maxWidth}},this.model.cells.map((t,s)=>y(U5,{key:s,model:t}))),y("div",{className:this.model.headerClasses,style:{height:this.model.renderedHeight}},this.model.backgroundImage?y("div",{style:this.model.backgroundImageStyle,className:this.model.backgroundImageClasses}):null,e)}componentDidMount(){super.componentDidMount(),this.model.processResponsiveness()}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.model.processResponsiveness()}};ee.Instance.registerElement("sv-header",n=>y(W5,n));let $5=class extends Ge{constructor(e){super(e),this.onInput=t=>{this.locStr.text=t.target.innerText},this.onClick=t=>{t.preventDefault(),t.stopPropagation()},this.state={changed:0}}get locStr(){return this.props.locStr}get style(){return this.props.style}componentDidMount(){if(this.locStr){var e=this;this.locStr.onChanged=function(){e.setState({changed:e.state.changed+1})}}}componentWillUnmount(){this.locStr&&(this.locStr.onChanged=function(){})}render(){if(!this.locStr)return null;if(this.locStr.hasHtml){const e={__html:this.locStr.renderedHtml};return y("span",{className:"sv-string-editor",contentEditable:"true",suppressContentEditableWarning:!0,style:this.style,dangerouslySetInnerHTML:e,onBlur:this.onInput,onClick:this.onClick})}return y("span",{className:"sv-string-editor",contentEditable:"true",suppressContentEditableWarning:!0,style:this.style,onBlur:this.onInput,onClick:this.onClick},this.locStr.renderedHtml)}};ee.Instance.registerElement(At.editableRenderer,n=>y($5,n));function MC(n,e,t={}){const s=y(Dh,Object.assign({model:n},t));eC(s,e)}function G5(n,e,t={}){const s=y(b5,Object.assign({model:n},t));eC(s,e)}function kC(n){return this.each(function(){G5(n.model,this,n)})}let Qh=globalThis;typeof globalThis>"u"&&(Qh=window);let Oo=Qh.jQuery||Qh.$;if(typeof Oo<"u")NC(Oo);else try{Oo=require("jquery"),NC(Oo)}catch{}function NC(n){n.fn.extend({Survey:function(e){return this.each(function(){MC(e.model,this,e)})},PopupSurvey:kC,SurveyWindow:kC})}Ee.platform="js-ui",Ee.prototype.render=function(n=null){this.renderCallback?this.renderCallback():MC(this,n)},jS("2.3.15","survey-js-ui");var J5="4.0.0";const K5={name:"survey",version:J5,parameters:{survey_json:{type:m.OBJECT,default:{}},survey_function:{type:m.FUNCTION,default:null},validation_function:{type:m.FUNCTION,default:null},min_width:{type:m.STRING,default:"min(100vw, 800px)"}},data:{response:{type:m.OBJECT},rt:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},dp=class dp{constructor(e){this.jsPsych=e,this.jsPsych=e}applyStyles(e){e.applyTheme({cssVariables:{"--sjs-general-backcolor":"rgba(255, 255, 255, 1)","--sjs-general-backcolor-dim":"rgba(255, 255, 255, 1)","--sjs-general-backcolor-dim-light":"rgba(249, 249, 249, 1)","--sjs-general-forecolor":"rgba(0, 0, 0, 0.91)","--sjs-general-forecolor-light":"rgba(0, 0, 0, 0.45)","--sjs-general-dim-forecolor":"rgba(0, 0, 0, 0.91)","--sjs-general-dim-forecolor-light":"rgba(0, 0, 0, 0.45)","--sjs-primary-backcolor":"#474747","--sjs-primary-backcolor-light":"rgba(0, 0, 0, 0.1)","--sjs-primary-backcolor-dark":"#000000","--sjs-primary-forecolor":"rgba(255, 255, 255, 1)","--sjs-primary-forecolor-light":"rgba(255, 255, 255, 0.25)","--sjs-shadow-small":"0px 0px 0px 1px rgba(0, 0, 0, 0.15)","--sjs-shadow-small-reset":"0px 0px 0px 0px rgba(0, 0, 0, 0.15)","--sjs-shadow-medium":"0px 0px 0px 1px rgba(0, 0, 0, 0.1)","--sjs-shadow-large":"0px 8px 16px 0px rgba(0, 0, 0, 0.05)","--sjs-shadow-inner-reset":"0px 0px 0px 0px rgba(0, 0, 0, 0.15)","--sjs-border-light":"rgba(0, 0, 0, 0.15)","--sjs-border-default":"rgba(0, 0, 0, 0.15)","--sjs-border-inside":" rgba(0, 0, 0, 0.16)"},themeName:"plain",colorPalette:"light",isPanelless:!1})}createSurveyContainer(e,t){const s=document.createElement("div");return s.classList.add("jspsych-survey-container"),s.style.textAlign="initial",s.style.minWidth=t,e.appendChild(s),s}trial(e,t){JSON.stringify(t.survey_json)==="{}"&&t.survey_function===null&&console.error("Survey plugin warning: you must define the survey using a non-empty JSON object and/or a survey function."),this.survey=new Ee(t.survey_json),t.survey_function!==null&&t.survey_function(this.survey),this.applyStyles(this.survey),t.validation_function&&this.survey.onValidateQuestion.add(t.validation_function),this.survey.onComplete.add((i,r)=>{const a=i.getAllQuestions(),o=Object.keys(i.data);for(const l of a)o.includes(l.name)||i.mergeData({[l.name]:l.defaultValue??null});this.jsPsych.finishTrial({rt:Math.round(performance.now()-this.start_time),response:i.data})});const s=this.createSurveyContainer(e,t.min_width);this.survey.render(s),this.start_time=performance.now()}};dp.info=K5;let Hh=dp;var Z5="2.1.0";const Y5={name:"survey-html-form",version:Z5,parameters:{html:{type:m.HTML_STRING,default:null},preamble:{type:m.HTML_STRING,default:null},button_label:{type:m.STRING,default:"Continue"},autofocus:{type:m.STRING,default:""},dataAsArray:{type:m.BOOL,default:!1},autocomplete:{type:m.BOOL,default:!1}},data:{response:{type:m.OBJECT},rt:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},cp=class cp{constructor(e){this.jsPsych=e}trial(e,t){var s="";if(t.preamble!==null&&(s+='<div id="jspsych-survey-html-form-preamble" class="jspsych-survey-html-form-preamble">'+t.preamble+"</div>"),t.autocomplete?s+='<form id="jspsych-survey-html-form">':s+='<form id="jspsych-survey-html-form" autocomplete="off">',s+=t.html,s+='<input type="submit" id="jspsych-survey-html-form-next" class="jspsych-btn jspsych-survey-html-form" value="'+t.button_label+'"></input>',s+="</form>",e.innerHTML=s,t.autofocus!==""){var i=e.querySelectorAll("#"+t.autofocus);i.length===0?console.warn("No element found with id: "+t.autofocus):i.length>1?console.warn('The id "'+t.autofocus+'" is not unique so autofocus will not work.'):i[0].focus()}e.querySelector("#jspsych-survey-html-form").addEventListener("submit",l=>{l.preventDefault();var u=performance.now(),d=Math.round(u-r),h=e.querySelector("#jspsych-survey-html-form"),f=a(h);t.dataAsArray||(f=o(f));var C={rt:d,response:f};this.jsPsych.finishTrial(C)});var r=performance.now();function a(l){for(var u=[],d=0;d<l.elements.length;d++){var h=l.elements[d];if(!(!h.name||h.disabled||h.type==="file"||h.type==="reset"||h.type==="submit"||h.type==="button"))if(h.type==="select-multiple")for(var f=0;f<h.options.length;f++)h.options[f].selected&&u.push({name:h.name,value:h.options[f].value});else(h.type!=="checkbox"&&h.type!=="radio"||h.checked)&&u.push({name:h.name,value:h.value})}return u}function o(l){for(var u={},d=0;d<l.length;d++)u[l[d].name]=l[d].value;return u}}};cp.info=Y5;let zh=cp;var X5="2.1.0";const eT={name:"survey-likert",version:X5,parameters:{questions:{type:m.COMPLEX,array:!0,nested:{prompt:{type:m.HTML_STRING,default:void 0},labels:{type:m.STRING,array:!0,default:void 0},required:{type:m.BOOL,default:!1},name:{type:m.STRING,default:""}}},randomize_question_order:{type:m.BOOL,default:!1},preamble:{type:m.HTML_STRING,default:null},scale_width:{type:m.INT,default:null},button_label:{type:m.STRING,default:"Continue"},autocomplete:{type:m.BOOL,default:!1}},data:{response:{type:m.OBJECT},rt:{type:m.INT},question_order:{type:m.INT,array:!0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},pp=class pp{constructor(e){this.jsPsych=e}trial(e,t){if(t.scale_width!==null)var s=t.scale_width+"px";else var s="100%";var i="";i+='<style id="jspsych-survey-likert-css">',i+=".jspsych-survey-likert-statement { display:block; font-size: 16px; padding-top: 40px; margin-bottom:10px; }.jspsych-survey-likert-opts { list-style:none; width:"+s+"; margin:auto; padding:0 0 35px; display:block; font-size: 14px; line-height:1.1em; }.jspsych-survey-likert-opt-label { line-height: 1.1em; color: #444; }.jspsych-survey-likert-opts:before { content: ''; position:relative; top:11px; /*left:9.5%;*/ display:block; background-color:#efefef; height:4px; width:100%; }.jspsych-survey-likert-opts:last-of-type { border-bottom: 0; }.jspsych-survey-likert-opts li { display:inline-block; /*width:19%;*/ text-align:center; vertical-align: top; }.jspsych-survey-likert-opts li input[type=radio] { display:block; position:relative; top:0; left:50%; margin-left:-6px; }",i+="</style>",t.preamble!==null&&(i+='<div id="jspsych-survey-likert-preamble" class="jspsych-survey-likert-preamble">'+t.preamble+"</div>"),t.autocomplete?i+='<form id="jspsych-survey-likert-form">':i+='<form id="jspsych-survey-likert-form" autocomplete="off">';for(var r=[],a=0;a<t.questions.length;a++)r.push(a);t.randomize_question_order&&(r=this.jsPsych.randomization.shuffle(r));for(var a=0;a<t.questions.length;a++){var o=t.questions[r[a]];i+='<label class="jspsych-survey-likert-statement">'+o.prompt+"</label>";for(var l=100/o.labels.length,u='<ul class="jspsych-survey-likert-opts" data-name="'+o.name+'" data-radio-group="Q'+r[a]+'">',d=0;d<o.labels.length;d++)u+='<li style="width:'+l+'%"><label class="jspsych-survey-likert-opt-label"><input type="radio" name="Q'+r[a]+'" value="'+d+'"',o.required&&(u+=" required"),u+=">"+o.labels[d]+"</label></li>";u+="</ul>",i+=u}i+='<input type="submit" id="jspsych-survey-likert-next" class="jspsych-survey-likert jspsych-btn" value="'+t.button_label+'"></input>',i+="</form>",e.innerHTML=i,e.querySelector("#jspsych-survey-likert-form").addEventListener("submit",f=>{f.preventDefault();for(var C=performance.now(),b=Math.round(C-h),x={},V=e.querySelectorAll("#jspsych-survey-likert-form .jspsych-survey-likert-opts"),P=0;P<V.length;P++){var M=V[P].dataset.radioGroup,X=e.querySelector('input[name="'+M+'"]:checked');if(X===null)var N="";else var N=parseInt(X.value);var W={};if(V[P].attributes["data-name"].value!=="")var J=V[P].attributes["data-name"].value;else var J=M;W[J]=N,Object.assign(x,W)}var ie={rt:b,response:x,question_order:r};this.jsPsych.finishTrial(ie)});var h=performance.now()}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={};let i=1e3;for(const o of e.questions){const l=o.name?o.name:`Q${e.questions.indexOf(o)}`;s[l]=this.jsPsych.randomization.randomInt(0,o.labels.length-1),i+=this.jsPsych.randomization.sampleExGaussian(1500,400,1/200,!0)}const r={response:s,rt:i,question_order:e.randomize_question_order?this.jsPsych.randomization.shuffle([...Array(e.questions.length).keys()]):[...Array(e.questions.length).keys()]},a=this.jsPsych.pluginAPI.mergeSimulationData(r,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,a),a}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s();const a=Object.entries(i.response);for(let o=0;o<a.length;o++)this.jsPsych.pluginAPI.clickTarget(r.querySelector(`input[type="radio"][name="${a[o][0]}"][value="${a[o][1]}"]`),(i.rt-1e3)/a.length*(o+1));this.jsPsych.pluginAPI.clickTarget(r.querySelector("#jspsych-survey-likert-next"),i.rt)}};pp.info=eT;let jh=pp;var tT="2.1.0";const sT={name:"survey-multi-choice",version:tT,parameters:{questions:{type:m.COMPLEX,array:!0,nested:{prompt:{type:m.HTML_STRING,default:void 0},options:{type:m.STRING,array:!0,default:void 0},required:{type:m.BOOL,default:!1},horizontal:{type:m.BOOL,default:!1},name:{type:m.STRING,default:""}}},randomize_question_order:{type:m.BOOL,default:!1},preamble:{type:m.HTML_STRING,default:null},button_label:{type:m.STRING,default:"Continue"},autocomplete:{type:m.BOOL,default:!1}},data:{response:{type:m.OBJECT},rt:{type:m.INT},question_order:{type:m.INT,array:!0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},st="jspsych-survey-multi-choice",gp=class gp{constructor(e){this.jsPsych=e}trial(e,t){const s=`${st}_form`;var i="";i+=`
    <style id="${st}-css">
      .${st}-question { margin-top: 2em; margin-bottom: 2em; text-align: left; }
      .${st}-text span.required {color: darkred;}
      .${st}-horizontal .${st}-text {  text-align: center;}
      .${st}-option { line-height: 2; }
      .${st}-horizontal .${st}-option {  display: inline-block;  margin-left: 1em;  margin-right: 1em;  vertical-align: top;}
      label.${st}-text input[type='radio'] {margin-right: 1em;}
      </style>`,t.preamble!==null&&(i+=`<div id="${st}-preamble" class="${st}-preamble">${t.preamble}</div>`),t.autocomplete?i+=`<form id="${s}">`:i+=`<form id="${s}" autocomplete="off">`;for(var r=[],a=0;a<t.questions.length;a++)r.push(a);t.randomize_question_order&&(r=this.jsPsych.randomization.shuffle(r));for(var a=0;a<t.questions.length;a++){var o=t.questions[r[a]],l=r[a],u=[`${st}-question`];o.horizontal&&u.push(`${st}-horizontal`),i+=`<div id="${st}-${l}" class="${u.join(" ")}" data-name="${o.name}">`,i+=`<p class="${st}-text survey-multi-choice">${o.prompt}`,o.required&&(i+="<span class='required'>*</span>"),i+="</p>";for(var d=0;d<o.options.length;d++){var h=`${st}-option-${l}-${d}`,f=`${st}-response-${l}`,C=`${st}-response-${l}-${d}`,b=o.required?"required":"";i+=`
        <div id="${h}" class="${st}-option">
          <label class="${st}-text" for="${C}">
            <input type="radio" name="${f}" id="${C}" value="${o.options[d]}" ${b} />
            ${o.options[d]}
            </label>
        </div>`}i+="</div>"}i+=`<input type="submit" id="${st}-next" class="${st} jspsych-btn"${t.button_label?' value="'+t.button_label+'"':""} />`,i+="</form>",e.innerHTML=i,e.querySelector(`#${s}`).addEventListener("submit",P=>{P.preventDefault();for(var M=performance.now(),X=Math.round(M-V),N={},W=0;W<t.questions.length;W++){var J=e.querySelector(`#${st}-${W}`),ie="Q"+W,ne;J.querySelector("input[type=radio]:checked")!==null?ne=J.querySelector("input[type=radio]:checked").value:ne="";var ce={},ye=ie;J.attributes["data-name"].value!==""&&(ye=J.attributes["data-name"].value),ce[ye]=ne,Object.assign(N,ce)}var le={rt:X,response:N,question_order:r};this.jsPsych.finishTrial(le)});var V=performance.now()}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={};let i=1e3;for(const o of e.questions){const l=o.name?o.name:`Q${e.questions.indexOf(o)}`;s[l]=this.jsPsych.randomization.sampleWithoutReplacement(o.options,1)[0],i+=this.jsPsych.randomization.sampleExGaussian(1500,400,1/200,!0)}const r={response:s,rt:i,question_order:e.randomize_question_order?this.jsPsych.randomization.shuffle([...Array(e.questions.length).keys()]):[...Array(e.questions.length).keys()]},a=this.jsPsych.pluginAPI.mergeSimulationData(r,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,a),a}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s();const a=Object.entries(i.response);for(let o=0;o<a.length;o++)this.jsPsych.pluginAPI.clickTarget(r.querySelector(`#${st}-response-${o}-${e.questions[o].options.indexOf(a[o][1])}`),(i.rt-1e3)/a.length*(o+1));this.jsPsych.pluginAPI.clickTarget(r.querySelector(`#${st}-next`),i.rt)}};gp.info=sT;let Uh=gp;var iT="2.1.0";const rT={name:"survey-multi-select",version:iT,parameters:{questions:{type:m.COMPLEX,array:!0,nested:{prompt:{type:m.HTML_STRING,default:void 0},options:{type:m.STRING,array:!0,default:void 0},horizontal:{type:m.BOOL,default:!1},required:{type:m.BOOL,default:!1},name:{type:m.STRING,default:""}}},randomize_question_order:{type:m.BOOL,default:!1},preamble:{type:m.HTML_STRING,default:null},button_label:{type:m.STRING,default:"Continue"},required_message:{type:m.STRING,default:"You must choose at least one response for this question"},autocomplete:{type:m.BOOL,default:!1}},data:{response:{type:m.OBJECT},rt:{type:m.INT},question_order:{type:m.INT,array:!0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},mp=class mp{constructor(e){this.jsPsych=e}trial(e,t){var s="jspsych-survey-multi-select",i="#"+s;const r=(...ne)=>ne.join("-");var a=".jspsych-survey-multi-select-question { margin-top: 2em; margin-bottom: 2em; text-align: left; }.jspsych-survey-multi-select-text span.required {color: darkred;}.jspsych-survey-multi-select-horizontal .jspsych-survey-multi-select-text {  text-align: center;}.jspsych-survey-multi-select-option { line-height: 2; }.jspsych-survey-multi-select-horizontal .jspsych-survey-multi-select-option {  display: inline-block;  margin-left: 1em;  margin-right: 1em;  vertical-align: top;}label.jspsych-survey-multi-select-text input[type='checkbox'] {margin-right: 1em;}";e.innerHTML='<style id="jspsych-survey-multi-select-css">'+a+"</style>";var o=r(s,"form");e.innerHTML+='<form id="'+o+'"></form>';var l=e.querySelector("#"+o);t.autocomplete||l.setAttribute("autocomplete","off");var u=r(s,"preamble");t.preamble!==null&&(l.innerHTML+='<div id="'+u+'" class="'+u+'">'+t.preamble+"</div>");for(var d=[],h=0;h<t.questions.length;h++)d.push(h);t.randomize_question_order&&(d=this.jsPsych.randomization.shuffle(d));for(var h=0;h<t.questions.length;h++){var f=t.questions[d[h]],C=d[h],b=[r(s,"question")];f.horizontal&&b.push(r(s,"horizontal")),l.innerHTML+='<div id="'+r(s,C)+'" data-name="'+f.name+'" class="'+b.join(" ")+'"></div>';var x=r(i,C);e.querySelector(x).innerHTML+='<p id="survey-question" class="'+s+'-text survey-multi-select">'+f.prompt+"</p>";for(var V=0;V<f.options.length;V++){var P=r(s,"option",C,V);e.querySelector(x).innerHTML+='<div id="'+P+'" class="'+r(s,"option")+'"></div>';var M=document.getElementById(P),X=r(s,"response",C),N=r(s,"response",C,V),W=document.createElement("label");W.setAttribute("class",s+"-text"),W.innerHTML=f.options[V],W.setAttribute("for",N);var J=document.createElement("input");J.setAttribute("type","checkbox"),J.setAttribute("name",X),J.setAttribute("id",N),J.setAttribute("value",f.options[V]),M.appendChild(W),W.insertBefore(J,W.firstChild)}}l.innerHTML+='<div class="fail-message"></div>',l.innerHTML+='<button id="'+s+'-next" class="'+s+' jspsych-btn">'+t.button_label+"</button>",e.querySelector("#jspsych-survey-multi-select-next").addEventListener("click",()=>{for(var ne=0;ne<t.questions.length;ne++)t.questions[ne].required&&(e.querySelector("#jspsych-survey-multi-select-"+ne+" input:checked")==null?e.querySelector("#jspsych-survey-multi-select-"+ne+" input").setCustomValidity(t.required_message):e.querySelector("#jspsych-survey-multi-select-"+ne+" input").setCustomValidity(""));l.reportValidity()}),l.addEventListener("submit",ne=>{ne.preventDefault();for(var ce=performance.now(),ye=Math.round(ce-ie),le={},be=0;be<t.questions.length;be++){for(var F=e.querySelector("#jspsych-survey-multi-select-"+be),Z=[],ae=F.querySelectorAll("input[type=checkbox]:checked"),ue=0;ue<ae.length;ue++){var me=ae[ue];Z.push(me.value)}var Xe="Q"+be,xt={},si=Xe;F.attributes["data-name"].value!==""&&(si=F.attributes["data-name"].value),xt[si]=Z,Object.assign(le,xt),Z.length==0}var ii={rt:ye,response:le,question_order:d};this.jsPsych.finishTrial(ii)});var ie=performance.now()}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={};let i=1e3;for(const o of e.questions){let l;o.required?l=this.jsPsych.randomization.randomInt(1,o.options.length):l=this.jsPsych.randomization.randomInt(0,o.options.length);const u=o.name?o.name:`Q${e.questions.indexOf(o)}`,d=this.jsPsych.randomization.sampleWithoutReplacement(o.options,l);s[u]=d,i+=this.jsPsych.randomization.sampleExGaussian(1500,400,1/200,!0)}const r={response:s,rt:i,question_order:e.randomize_question_order?this.jsPsych.randomization.shuffle([...Array(e.questions.length).keys()]):[...Array(e.questions.length).keys()]},a=this.jsPsych.pluginAPI.mergeSimulationData(r,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,a),a}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s();const a=Object.entries(i.response);for(let o=0;o<a.length;o++)for(const l of a[o][1])this.jsPsych.pluginAPI.clickTarget(r.querySelector(`#jspsych-survey-multi-select-response-${o}-${e.questions[o].options.indexOf(l)}`),(i.rt-1e3)/a.length*(o+1));this.jsPsych.pluginAPI.clickTarget(r.querySelector("#jspsych-survey-multi-select-next"),i.rt)}};mp.info=rT;let Wh=mp;var nT="2.1.0";const aT={name:"survey-text",version:nT,parameters:{questions:{type:m.COMPLEX,array:!0,default:void 0,nested:{prompt:{type:m.HTML_STRING,default:void 0},placeholder:{type:m.STRING,default:""},rows:{type:m.INT,default:1},columns:{type:m.INT,default:40},required:{type:m.BOOL,default:!1},name:{type:m.STRING,default:""}}},randomize_question_order:{type:m.BOOL,default:!1},preamble:{type:m.HTML_STRING,default:null},button_label:{type:m.STRING,default:"Continue"},autocomplete:{type:m.BOOL,default:!1}},data:{response:{type:m.OBJECT},rt:{type:m.INT},question_order:{type:m.INT,array:!0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},fp=class fp{constructor(e){this.jsPsych=e}trial(e,t){for(var s=0;s<t.questions.length;s++)typeof t.questions[s].rows>"u"&&(t.questions[s].rows=1);for(var s=0;s<t.questions.length;s++)typeof t.questions[s].columns>"u"&&(t.questions[s].columns=40);for(var s=0;s<t.questions.length;s++)typeof t.questions[s].value>"u"&&(t.questions[s].value="");var i="";t.preamble!==null&&(i+='<div id="jspsych-survey-text-preamble" class="jspsych-survey-text-preamble">'+t.preamble+"</div>"),t.autocomplete?i+='<form id="jspsych-survey-text-form">':i+='<form id="jspsych-survey-text-form" autocomplete="off">';for(var r=[],s=0;s<t.questions.length;s++)r.push(s);t.randomize_question_order&&(r=this.jsPsych.randomization.shuffle(r));for(var s=0;s<t.questions.length;s++){var a=t.questions[r[s]],o=r[s];i+='<div id="jspsych-survey-text-'+o+'" class="jspsych-survey-text-question" style="margin: 2em 0em;">',i+='<p class="jspsych-survey-text">'+a.prompt+"</p>";var l=s==0?"autofocus":"",u=a.required?"required":"";a.rows==1?i+='<input type="text" id="input-'+o+'"  name="#jspsych-survey-text-response-'+o+'" data-name="'+a.name+'" size="'+a.columns+'" '+l+" "+u+' placeholder="'+a.placeholder+'"></input>':i+='<textarea id="input-'+o+'" name="#jspsych-survey-text-response-'+o+'" data-name="'+a.name+'" cols="'+a.columns+'" rows="'+a.rows+'" '+l+" "+u+' placeholder="'+a.placeholder+'"></textarea>',i+="</div>"}i+='<input type="submit" id="jspsych-survey-text-next" class="jspsych-btn jspsych-survey-text" value="'+t.button_label+'"></input>',i+="</form>",e.innerHTML=i,e.querySelector("#input-"+r[0]).focus(),e.querySelector("#jspsych-survey-text-form").addEventListener("submit",h=>{h.preventDefault();for(var f=performance.now(),C=Math.round(f-d),b={},x=0;x<t.questions.length;x++){var V="Q"+x,P=document.querySelector("#jspsych-survey-text-"+x).querySelector("textarea, input"),M=P.value,X=P.attributes["data-name"].value;X==""&&(X=V);var N={};N[X]=M,Object.assign(b,N)}var W={rt:C,response:b};this.jsPsych.finishTrial(W)});var d=performance.now()}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={};let i=1e3;for(const o of e.questions){const l=o.name?o.name:`Q${e.questions.indexOf(o)}`,u=o.rows==1?this.jsPsych.randomization.sampleExponential(.25):this.jsPsych.randomization.randomInt(1,10)*o.rows;s[l]=this.jsPsych.randomization.randomWords({exactly:u,join:" "}),i+=this.jsPsych.randomization.sampleExGaussian(2e3,400,.004,!0)}const r={response:s,rt:i},a=this.jsPsych.pluginAPI.mergeSimulationData(r,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,a),a}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s();const a=Object.entries(i.response).map(o=>o[1]);for(let o=0;o<a.length;o++)this.jsPsych.pluginAPI.fillTextInput(r.querySelector(`#input-${o}`),a[o],(i.rt-1e3)/a.length*(o+1));this.jsPsych.pluginAPI.clickTarget(r.querySelector("#jspsych-survey-text-next"),i.rt)}};fp.info=aT;let $h=fp;var oT="2.1.1";const lT={name:"video-button-response",version:oT,parameters:{stimulus:{type:m.VIDEO,default:void 0,array:!0},choices:{type:m.STRING,default:void 0,array:!0},button_html:{type:m.FUNCTION,default:function(n,e){return`<button class="jspsych-btn">${n}</button>`}},prompt:{type:m.HTML_STRING,default:null},width:{type:m.INT,default:null},height:{type:m.INT,default:null},autoplay:{type:m.BOOL,pretty_name:"Autoplay",default:!0},controls:{type:m.BOOL,default:!1},start:{type:m.FLOAT,default:null},stop:{type:m.FLOAT,default:null},rate:{type:m.FLOAT,default:1},trial_ends_after_video:{type:m.BOOL,default:!1},trial_duration:{type:m.INT,default:null},button_layout:{type:m.STRING,default:"grid"},grid_rows:{type:m.INT,default:1},grid_columns:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0},response_allowed_while_playing:{type:m.BOOL,default:!0},enable_button_after:{type:m.INT,default:0}},data:{response:{type:m.INT},rt:{type:m.INT},stimulus:{type:m.STRING,array:!0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},yp=class yp{constructor(e){this.jsPsych=e}trial(e,t){const s=document.createElement("div");e.appendChild(s);const i=document.createElement("video");s.appendChild(i),i.id="jspsych-video-button-response-stimulus",t.width&&(i.width=t.width),t.height&&(i.height=t.height),i.controls=t.controls,i.autoplay=t.autoplay&&t.start==null,t.start!==null&&(i.style.visibility="hidden");const r=this.jsPsych.pluginAPI.getVideoBuffer(t.stimulus[0]);if(!r)for(let x of t.stimulus){x.indexOf("?")>-1&&(x=x.substring(0,x.indexOf("?")));const V=x.substring(x.lastIndexOf(".")+1).toLowerCase();V==="mov"&&console.warn("Warning: video-button-response plugin does not reliably support .mov files.");const P=document.createElement("source");P.src=x,P.type="video/"+V,i.appendChild(P)}const a=document.createElement("div");if(a.id="jspsych-video-button-response-btngroup",t.button_layout==="grid"){if(a.classList.add("jspsych-btn-group-grid"),t.grid_rows===null&&t.grid_columns===null)throw new Error("You cannot set `grid_rows` to `null` without providing a value for `grid_columns`.");const x=t.grid_columns===null?Math.ceil(t.choices.length/t.grid_rows):t.grid_columns,V=t.grid_rows===null?Math.ceil(t.choices.length/t.grid_columns):t.grid_rows;a.style.gridTemplateColumns=`repeat(${x}, 1fr)`,a.style.gridTemplateRows=`repeat(${V}, 1fr)`}else t.button_layout==="flex"&&a.classList.add("jspsych-btn-group-flex");for(const[x,V]of t.choices.entries()){a.insertAdjacentHTML("beforeend",t.button_html(V,x));const P=a.lastChild;P.dataset.choice=x.toString(),P.addEventListener("click",()=>{f(x)})}e.appendChild(a),t.prompt!==null&&e.insertAdjacentHTML("beforeend",t.prompt);var o=performance.now();r&&(i.src=r),i.onended=()=>{t.trial_ends_after_video?h():t.response_allowed_while_playing||b()},i.playbackRate=t.rate,t.start!==null&&(i.pause(),i.onseeked=()=>{i.style.visibility="visible",i.muted=!1,t.autoplay?i.play():i.pause(),i.onseeked=()=>{}},i.onplaying=()=>{i.currentTime=t.start,i.onplaying=()=>{}},i.muted=!0,i.play());let l=!1;t.stop!==null&&i.addEventListener("timeupdate",x=>{i.currentTime>=t.stop&&(t.response_allowed_while_playing||(t.enable_button_after>0?u(t.enable_button_after):b()),i.pause(),t.trial_ends_after_video&&!l&&(l=!0,h()))});const u=x=>{this.jsPsych.pluginAPI.setTimeout(b,x)};t.response_allowed_while_playing?(C(),t.enable_button_after>0?u(t.enable_button_after):b()):C();var d={rt:null,button:null};const h=()=>{i.pause(),i.onended=()=>{};const x={rt:d.rt,stimulus:t.stimulus,response:d.button};this.jsPsych.finishTrial(x)};function f(x){var V=performance.now(),P=Math.round(V-o);d.button=x,d.rt=P,i.classList.add("responded"),C(),t.response_ends_trial&&h()}function C(){for(const x of a.children)x.setAttribute("disabled","disabled")}function b(){for(const x of a.children)x.removeAttribute("disabled")}t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(h,t.trial_duration)}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={stimulus:e.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0)+e.enable_button_after,response:this.jsPsych.randomization.randomInt(0,e.choices.length-1)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s();const a=r.querySelector("#jspsych-video-button-response-stimulus"),o=()=>{i.rt!==null&&this.jsPsych.pluginAPI.clickTarget(r.querySelector(`#jspsych-video-button-response-btngroup [data-choice="${i.response}"]`),i.rt)};e.response_allowed_while_playing?o():a.addEventListener("ended",o)}};yp.info=lT;let Gh=yp;var uT="2.1.1";const hT={name:"video-keyboard-response",version:uT,parameters:{stimulus:{type:m.VIDEO,pretty_name:"Video",default:void 0,array:!0},choices:{type:m.KEYS,pretty_name:"Choices",default:"ALL_KEYS"},prompt:{type:m.HTML_STRING,pretty_name:"Prompt",default:null},width:{type:m.INT,pretty_name:"Width",default:""},height:{type:m.INT,pretty_name:"Height",default:""},autoplay:{type:m.BOOL,pretty_name:"Autoplay",default:!0},controls:{type:m.BOOL,pretty_name:"Controls",default:!1},start:{type:m.FLOAT,pretty_name:"Start",default:null},stop:{type:m.FLOAT,pretty_name:"Stop",default:null},rate:{type:m.FLOAT,pretty_name:"Rate",default:1},trial_ends_after_video:{type:m.BOOL,pretty_name:"End trial after video finishes",default:!1},trial_duration:{type:m.INT,pretty_name:"Trial duration",default:null},response_ends_trial:{type:m.BOOL,pretty_name:"Response ends trial",default:!0},response_allowed_while_playing:{type:m.BOOL,pretty_name:"Response allowed while playing",default:!0}},data:{response:{type:m.STRING},rt:{type:m.INT},stimulus:{type:m.STRING,array:!0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},vp=class vp{constructor(e){this.jsPsych=e}trial(e,t){var s="<div>";s+='<video id="jspsych-video-keyboard-response-stimulus"',t.width&&(s+=' width="'+t.width+'"'),t.height&&(s+=' height="'+t.height+'"'),t.autoplay&&t.start==null&&(s+=" autoplay "),t.controls&&(s+=" controls "),t.start!==null&&(s+=' style="visibility: hidden;"'),s+=">";var i=this.jsPsych.pluginAPI.getVideoBuffer(t.stimulus[0]);if(!i)for(var r=0;r<t.stimulus.length;r++){var a=t.stimulus[r];a.indexOf("?")>-1&&(a=a.substring(0,a.indexOf("?")));var o=a.substr(a.lastIndexOf(".")+1);o=o.toLowerCase(),o=="mov"&&console.warn("Warning: video-keyboard-response plugin does not reliably support .mov files."),s+='<source src="'+a+'" type="video/'+o+'">'}s+="</video>",s+="</div>",t.prompt!==null&&(s+=t.prompt),e.innerHTML=s;var l=e.querySelector("#jspsych-video-keyboard-response-stimulus");i&&(l.src=i),l.onended=()=>{t.trial_ends_after_video&&h(),t.response_allowed_while_playing==!1&&!t.trial_ends_after_video&&this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:f,valid_responses:t.choices,rt_method:"performance",persist:!1,allow_held_key:!1})},l.playbackRate=t.rate,t.start!==null&&(l.pause(),l.onseeked=()=>{l.style.visibility="visible",l.muted=!1,t.autoplay?l.play():l.pause(),l.onseeked=()=>{}},l.onplaying=()=>{l.currentTime=t.start,l.onplaying=()=>{}},l.muted=!0,l.play());let u=!1;t.stop!==null&&l.addEventListener("timeupdate",C=>{var b=l.currentTime;b>=t.stop&&(t.response_allowed_while_playing||this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:f,valid_responses:t.choices,rt_method:"performance",persist:!1,allow_held_key:!1}),l.pause(),t.trial_ends_after_video&&!u&&(u=!0,h()))});var d={rt:null,key:null};const h=()=>{this.jsPsych.pluginAPI.cancelAllKeyboardResponses(),e.querySelector("#jspsych-video-keyboard-response-stimulus").pause(),e.querySelector("#jspsych-video-keyboard-response-stimulus").onended=()=>{};var C={rt:d.rt,stimulus:t.stimulus,response:d.key};this.jsPsych.finishTrial(C)};var f=C=>{e.querySelector("#jspsych-video-keyboard-response-stimulus").className+=" responded",d.key==null&&(d=C),t.response_ends_trial&&h()};t.choices!="NO_KEYS"&&t.response_allowed_while_playing&&this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:f,valid_responses:t.choices,rt_method:"performance",persist:!1,allow_held_key:!1}),t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(h,t.trial_duration)}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s();const a=r.querySelector("#jspsych-video-button-response-stimulus"),o=()=>{i.rt!==null&&this.jsPsych.pluginAPI.pressKey(i.response,i.rt)};e.response_allowed_while_playing?o():a.addEventListener("ended",o)}create_simulation_data(e,t){const s={stimulus:e.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0),response:this.jsPsych.pluginAPI.getValidKey(e.choices)},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}};vp.info=hT;let Jh=vp;var dT="2.1.1";const cT={name:"video-slider-response",version:dT,parameters:{stimulus:{type:m.VIDEO,default:void 0,array:!0},prompt:{type:m.HTML_STRING,default:null},width:{type:m.INT,default:null},height:{type:m.INT,default:null},autoplay:{type:m.BOOL,default:!0},controls:{type:m.BOOL,default:!1},start:{type:m.FLOAT,default:null},stop:{type:m.FLOAT,default:null},rate:{type:m.FLOAT,default:1},min:{type:m.INT,default:0},max:{type:m.INT,default:100},slider_start:{type:m.INT,default:50},step:{type:m.INT,default:1},labels:{type:m.HTML_STRING,default:[],array:!0},slider_width:{type:m.INT,default:null},button_label:{type:m.STRING,default:"Continue"},require_movement:{type:m.BOOL,default:!1},trial_ends_after_video:{type:m.BOOL,default:!1},trial_duration:{type:m.INT,default:null},response_ends_trial:{type:m.BOOL,default:!0},response_allowed_while_playing:{type:m.BOOL,default:!0}},data:{response:{type:m.INT},rt:{type:m.INT},stimulus:{type:m.STRING,array:!0},slider_start:{type:m.INT},start:{type:m.FLOAT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Cp=class Cp{constructor(e){this.jsPsych=e}trial(e,t){var s=7.5,i='<video id="jspsych-video-slider-response-stimulus-video"';t.width&&(i+=' width="'+t.width+'"'),t.height&&(i+=' height="'+t.height+'"'),t.autoplay&&t.start==null&&(i+=" autoplay "),t.controls&&(i+=" controls "),t.start!==null&&(i+=' style="visibility: hidden;"'),i+=">";var r=this.jsPsych.pluginAPI.getVideoBuffer(t.stimulus[0]);if(!r)for(var a=0;a<t.stimulus.length;a++){var o=t.stimulus[a];o.indexOf("?")>-1&&(o=o.substring(0,o.indexOf("?")));var l=o.substr(o.lastIndexOf(".")+1);l=l.toLowerCase(),l=="mov"&&console.warn("Warning: video-slider-response plugin does not reliably support .mov files."),i+='<source src="'+o+'" type="video/'+l+'">'}i+="</video>";var u='<div id="jspsych-video-slider-response-wrapper" style="margin: 100px 0px;">';u+='<div id="jspsych-video-slider-response-stimulus">'+i+"</div>",u+='<div class="jspsych-video-slider-response-container" style="position:relative; margin: 0 auto 3em auto; width:',t.slider_width!==null?u+=t.slider_width+"px;":u+="auto;",u+='">',u+='<input type="range" class="jspsych-slider" value="'+t.slider_start+'" min="'+t.min+'" max="'+t.max+'" step="'+t.step+'" id="jspsych-video-slider-response-response"',t.response_allowed_while_playing||(u+=" disabled"),u+="></input><div>";for(var d=0;d<t.labels.length;d++){var h=100/(t.labels.length-1),f=d*(100/(t.labels.length-1)),C=(f-50)/50*100,b=C*s/100;u+='<div style="border: 1px solid transparent; display: inline-block; position: absolute; left:calc('+f+"% - ("+h+"% / 2) - "+b+"px); text-align: center; width: "+h+'%;">',u+='<span style="text-align: center; font-size: 80%;">'+t.labels[d]+"</span>",u+="</div>"}u+="</div>",u+="</div>",u+="</div>",t.prompt!==null&&(u+="<div>"+t.prompt+"</div>");var x="";(t.require_movement||!t.response_allowed_while_playing)&&(x="disabled"),u+='<button id="jspsych-video-slider-response-next" class="jspsych-btn" '+x+">"+t.button_label+"</button>",e.innerHTML=u;var V=e.querySelector("#jspsych-video-slider-response-stimulus-video");r&&(V.src=r),V.onended=()=>{t.trial_ends_after_video?N():t.response_allowed_while_playing||W()},V.playbackRate=t.rate,t.start!==null&&(V.pause(),V.onseeked=()=>{V.style.visibility="visible",V.muted=!1,t.autoplay?V.play():V.pause(),V.onseeked=()=>{}},V.onplaying=()=>{V.currentTime=t.start,V.onplaying=()=>{}},V.muted=!0,V.play());let P=!1;if(t.stop!==null&&V.addEventListener("timeupdate",J=>{var ie=V.currentTime;ie>=t.stop&&(V.pause(),t.trial_ends_after_video&&!P&&(P=!0,N()),t.response_allowed_while_playing||W())}),t.require_movement){const J=()=>{e.querySelector("#jspsych-video-slider-response-next").disabled=!1};e.querySelector("#jspsych-video-slider-response-response").addEventListener("mousedown",J),e.querySelector("#jspsych-video-slider-response-response").addEventListener("touchstart",J),e.querySelector("#jspsych-video-slider-response-response").addEventListener("change",J)}var M=performance.now(),X={rt:null,response:null};const N=()=>{e.querySelector("#jspsych-video-slider-response-stimulus-video").pause(),e.querySelector("#jspsych-video-slider-response-stimulus-video").onended=()=>{};var J={rt:X.rt,stimulus:t.stimulus,start:t.start,slider_start:t.slider_start,response:X.response};this.jsPsych.finishTrial(J)};e.querySelector("#jspsych-video-slider-response-next").addEventListener("click",()=>{var J=performance.now();X.rt=Math.round(J-M),X.response=e.querySelector("#jspsych-video-slider-response-response").valueAsNumber,t.response_ends_trial?N():e.querySelector("#jspsych-video-slider-response-next").disabled=!0});function W(){document.querySelector("#jspsych-video-slider-response-response").disabled=!1,t.require_movement||(document.querySelector("#jspsych-video-slider-response-next").disabled=!1)}t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(N,t.trial_duration)}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={stimulus:e.stimulus,slider_start:e.slider_start,response:this.jsPsych.randomization.randomInt(e.min,e.max),rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0),start:e.start},i=this.jsPsych.pluginAPI.mergeSimulationData(s,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,i),i}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s();const a=r.querySelector("#jspsych-video-button-response-stimulus"),o=()=>{if(i.rt!==null){const l=r.querySelector("input[type='range']");setTimeout(()=>{this.jsPsych.pluginAPI.clickTarget(l),l.valueAsNumber=i.response},i.rt/2),this.jsPsych.pluginAPI.clickTarget(r.querySelector("button"),i.rt)}};e.response_allowed_while_playing?o():a.addEventListener("ended",o)}};Cp.info=cT;let Kh=Cp;var pT="3.1.0";const gT={name:"virtual-chinrest",version:pT,parameters:{resize_units:{type:m.SELECT,options:["none","cm","inch","deg"],default:"none"},pixels_per_unit:{type:m.INT,default:100},adjustment_prompt:{type:m.HTML_STRING,default:`
          <div style="text-align: left;">
          <p>Click and drag the lower right corner of the image until it is the same size as a credit card held up to the screen.</p>
          <p>You can use any card that is the same size as a credit card, like a membership card or driver's license.</p>
          <p>If you do not have access to a real card you can use a ruler to measure the image width to 3.37 inches or 85.6 mm.</p>
          </div>`},adjustment_button_prompt:{type:m.HTML_STRING,default:"Click here when the image is the correct size"},item_path:{type:m.IMAGE,default:null,preload:!1},item_height_mm:{type:m.FLOAT,default:53.98},item_width_mm:{type:m.FLOAT,default:85.6},item_init_size:{type:m.INT,default:250},blindspot_reps:{type:m.INT,default:5},blindspot_prompt:{type:m.HTML_STRING,pretty_name:"Blindspot prompt",default:`
          <p>Now we will quickly measure how far away you are sitting.</p>
          <div style="text-align: left">
            <ol>
              <li>Put your left hand on the <b>space bar</b>.</li>
              <li>Cover your right eye with your right hand.</li>
              <li>Using your left eye, focus on the black square. Keep your focus on the black square.</li>
              <li>The <span style="color: red; font-weight: bold;">red ball</span> will disappear as it moves from right to left. Press the space bar as soon as the ball disappears.</li>
            </ol>
          </div>
          <p>Press the space bar when you are ready to begin.</p>
          `},blindspot_measurements_prompt:{type:m.HTML_STRING,default:"Remaining measurements: "},viewing_distance_report:{type:m.HTML_STRING,default:"<p>Based on your responses, you are sitting about <span id='distance-estimate' style='font-weight: bold;'></span> from the screen.</p><p>Does that seem about right?</p>"},redo_measurement_button_label:{type:m.HTML_STRING,default:"No, that is not close. Try again."},blindspot_done_prompt:{type:m.HTML_STRING,default:"Yes"}},data:{rt:{type:m.INT},item_height_mm:{type:m.FLOAT},item_width_mm:{type:m.FLOAT},item_height_deg:{type:m.FLOAT},item_width_deg:{type:m.FLOAT},item_width_px:{type:m.FLOAT},px2deg:{type:m.INT},px2mm:{type:m.FLOAT},scale_factor:{type:m.FLOAT},win_width_deg:{type:m.FLOAT},win_height_deg:{type:m.FLOAT},view_dist_mm:{type:m.FLOAT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},bp=class bp{constructor(e){this.jsPsych=e,this.ball_size=30,this.ball=null,this.container=null,this.reps_remaining=0,this.ball_animation_frame_id=null}trial(e,t){if(!(t.blindspot_reps>0)&&(t.resize_units=="deg"||t.resize_units=="degrees")){console.error("Blindspot repetitions set to 0, so resizing to degrees of visual angle is not possible!");return}this.reps_remaining=t.blindspot_reps;let s={item_width_mm:t.item_width_mm,item_height_mm:t.item_height_mm},i={ball_pos:[]},r=t.item_width_mm/t.item_height_mm;const a=r<1?t.item_init_size:Math.round(t.item_init_size/r),o=r<1?Math.round(t.item_init_size*r):t.item_init_size,l=Math.round(o*.1);let u=`
        <div id="page-size">
          <div id="item" style="border: none; height: ${a}px; width: ${o}px; margin: 5px auto; background-color: #ddd; position: relative; ${t.item_path===null?"":`background-image: url(${t.item_path}); background-size: 100% auto; background-repeat: no-repeat;`}">
            <div id="jspsych-resize-handle" style="cursor: nwse-resize; background-color: none; width: ${l}px; height: ${l}px; border: 5px solid red; border-left: 0; border-top: 0; position: absolute; bottom: 0; right: 0;">
            </div>
          </div>
          ${t.adjustment_prompt}
          <button id="end_resize_phase" class="jspsych-btn">
            ${t.adjustment_button_prompt}
          </button>
        </div>
      `,d=`
        <div id="blind-spot">
          ${t.blindspot_prompt}
          <div id="svgDiv" style="height:100px; position:relative;"></div>
          <button class="btn btn-primary" id="proceed" style="display:none;"> +
            ${t.blindspot_done_prompt} +
          </button>
          ${t.blindspot_measurements_prompt} 
          <div id="click" style="display:inline; color: red"> ${t.blindspot_reps} </div>
        </div>`,h=`
        <div id="distance-report">
          <div id="info-h">
            ${t.viewing_distance_report}
          </div>
          <button id="redo_blindspot" class="jspsych-btn">${t.redo_measurement_button_label}</button>
          <button id="proceed" class="jspsych-btn">${t.blindspot_done_prompt}</button>
        </div>
      `;e.innerHTML='<div id="content" style="width: 900px; margin: 0 auto;"></div>';const f=performance.now();C();function C(){e.querySelector("#content").innerHTML=u;let F=!1,Z,ae,ue,me;const Xe=e.querySelector("#item");function xt(){F=!1}document.addEventListener("mouseup",xt);function si(Ts){Ts.preventDefault(),F=!0,Z=Ts.pageX,ae=Ts.pageY,ue=parseInt(Xe.style.width),me=parseInt(Xe.style.height)}e.querySelector("#jspsych-resize-handle").addEventListener("mousedown",si);function ii(Ts){if(F){let Ht=Ts.pageX-Z,nr=Ts.pageY-ae;Math.abs(Ht)>=Math.abs(nr)?(Xe.style.width=Math.round(Math.max(20,ue+Ht*2))+"px",Xe.style.height=Math.round(Math.max(20,ue+Ht*2)/r)+"px"):(Xe.style.height=Math.round(Math.max(20,me+nr*2))+"px",Xe.style.width=Math.round(r*Math.max(20,me+nr*2))+"px")}}e.addEventListener("mousemove",ii),e.querySelector("#end_resize_phase").addEventListener("click",b)}function b(){const F=document.querySelector("#item").getBoundingClientRect().width;s.item_width_px=Math.round(F);const Z=ce(F);s.px2mm=ye(Z,2),t.blindspot_reps>0?x():W()}const x=()=>{i={ball_pos:[],slider_clck:!1},e.querySelector("#content").innerHTML=d,this.container=e.querySelector("#svgDiv"),J(),V()},V=()=>{const Z=(this.container.getBoundingClientRect().width-this.ball_size)*.85;this.ball.style.left=`${Z}px`,this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:P,valid_responses:[" "],rt_method:"performance",allow_held_key:!1,persist:!1})},P=()=>{this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:ne,valid_responses:[" "],rt_method:"performance",allow_held_key:!1,persist:!1}),this.ball_animation_frame_id=requestAnimationFrame(ie)},M=()=>{const Z=i.ball_pos.reduce((Xe,xt)=>Xe+xt,0),ae=i.ball_pos.length;i.avg_ball_pos=ye(Z/ae,2);const me=(i.square_pos-i.avg_ball_pos)/s.px2mm/Math.tan(be(13.5));s.view_dist_mm=ye(me,2),t.viewing_distance_report=="none"?W():X()};function X(){e.querySelector("#content").innerHTML=h,e.querySelector("#distance-estimate").innerHTML=`
          ${Math.round(s.view_dist_mm/10)} cm (${Math.round(s.view_dist_mm*.0393701)} inches)
        `,e.querySelector("#redo_blindspot").addEventListener("click",x),e.querySelector("#proceed").addEventListener("click",W)}function N(){s.item_width_deg=2*Math.atan(s.item_width_mm/2/s.view_dist_mm)*180/Math.PI,s.px2deg=s.item_width_px/s.item_width_deg;let F=0;switch(t.resize_units){case"cm":case"centimeters":F=s.px2mm*10;break;case"inch":case"inches":F=s.px2mm*25.4;break;case"deg":case"degrees":F=s.px2deg;break}if(F>0){let Z=F/t.pixels_per_unit;document.getElementById("jspsych-content").style.transform="scale("+Z+")",s.px2deg=s.px2deg/Z,s.px2mm=s.px2mm/Z,s.item_width_px=s.item_width_px/Z,s.scale_factor=Z}t.blindspot_reps>0?(s.win_width_deg=window.innerWidth/s.px2deg,s.win_height_deg=window.innerHeight/s.px2deg):(delete s.px2deg,delete s.item_width_deg)}const W=()=>{s.rt=Math.round(performance.now()-f),this.jsPsych.pluginAPI.cancelAllKeyboardResponses(),N(),this.jsPsych.finishTrial(s)},J=()=>{this.container.innerHTML=`
        <div id="virtual-chinrest-circle" style="position: absolute; background-color: #f00; width: ${this.ball_size}px; height: ${this.ball_size}px; border-radius:${this.ball_size}px;"></div>
        <div id="virtual-chinrest-square" style="position: absolute; background-color: #000; width: ${this.ball_size}px; height: ${this.ball_size}px;"></div>
      `;const F=this.container.querySelector("#virtual-chinrest-circle"),Z=this.container.querySelector("#virtual-chinrest-square"),ae=this.container.getBoundingClientRect().width-this.ball_size,ue=ae*.85;F.style.left=`${ue}px`,Z.style.left=`${ae}px`,this.ball=F,i.square_pos=ye(le(Z).x,2)},ie=()=>{const Z=parseInt(this.ball.style.left);this.ball.style.left=`${Z+-2}px`,this.ball_animation_frame_id=requestAnimationFrame(ie)},ne=()=>{cancelAnimationFrame(this.ball_animation_frame_id),i.ball_pos.push(ye(le(this.ball).x,2)),this.reps_remaining--,document.querySelector("#click").textContent=Math.max(this.reps_remaining,0).toString(),this.reps_remaining<=0?M():V()};function ce(F){return F/s.item_width_mm}function ye(F,Z){return+(Math.round(+(F+"e"+Z))+"e-"+Z)}function le(F){const Z=F.getBoundingClientRect();return{x:Z.left+Z.width/2,y:Z.top+Z.height/2}}const be=F=>F*Math.PI/180}};bp.info=gT;let Zh=bp;var mT="2.2.0";const fT={name:"visual-search-circle",version:mT,parameters:{target:{type:m.IMAGE,default:null},foil:{type:m.IMAGE,default:null},set_size:{type:m.INT,default:null},stimuli:{type:m.IMAGE,default:[],array:!0},target_present:{type:m.BOOL,default:void 0},fixation_image:{type:m.IMAGE,default:void 0},target_size:{type:m.INT,array:!0,default:[50,50]},fixation_size:{type:m.INT,array:!0,default:[16,16]},circle_diameter:{type:m.INT,default:250},target_present_key:{type:m.KEY,default:"j"},target_absent_key:{type:m.KEY,default:"f"},trial_duration:{type:m.INT,default:null},fixation_duration:{type:m.INT,default:1e3},randomize_item_locations:{type:m.BOOL,pretty_name:"Randomize item locations",default:!0},location_first_item:{type:m.INT,pretty_name:"Location first item",default:0},response_ends_trial:{type:m.BOOL,default:!0}},data:{correct:{type:m.BOOL},response:{type:m.STRING},rt:{type:m.INT},set_size:{type:m.INT},target_present:{type:m.BOOL},locations:{type:m.INT,array:!0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},wp=class wp{constructor(e){this.jsPsych=e}trial(e,t){var s=t.circle_diameter+t.target_size[0],i=this.generateFixationLoc(t),r=this.generatePresentationSet(t),a=this.generateDisplayLocs(r.length,t);e.innerHTML+='<div id="jspsych-visual-search-circle-container" style="position: relative; width:'+s+"px; height:"+s+'px"></div>';var o=e.querySelector("#jspsych-visual-search-circle-container");const l=()=>{o.innerHTML+="<img src='"+t.fixation_image+"' style='position: absolute; top:"+i[0]+"px; left:"+i[1]+"px; width:"+t.fixation_size[0]+"px; height:"+t.fixation_size[1]+"px;'></img>",this.jsPsych.pluginAPI.setTimeout(()=>{h()},t.fixation_duration)},u={rt:null,key:null,correct:!1},d=()=>{this.jsPsych.pluginAPI.cancelAllKeyboardResponses();const f={correct:u.correct,rt:u.rt,response:u.key,locations:a,target_present:t.target_present,set_size:t.set_size};this.jsPsych.finishTrial(f)};l();const h=()=>{for(var f=0;f<a.length;f++)o.innerHTML+="<img src='"+r[f]+"' style='position: absolute; top:"+a[f][0]+"px; left:"+a[f][1]+"px; width:"+t.target_size[0]+"px; height:"+t.target_size[1]+"px;'></img>";const C=V=>{var P=!1;(this.jsPsych.pluginAPI.compareKeys(V.key,t.target_present_key)&&t.target_present||this.jsPsych.pluginAPI.compareKeys(V.key,t.target_absent_key)&&!t.target_present)&&(P=!0),u.rt=V.rt,u.key=V.key,u.correct=P,t.response_ends_trial&&d()},b=[t.target_present_key,t.target_absent_key],x=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:C,valid_responses:b,rt_method:"performance",persist:!1,allow_held_key:!1});t.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{u.rt||this.jsPsych.pluginAPI.cancelKeyboardResponse(x),d()},t.trial_duration)}}generateFixationLoc(e){var t=e.circle_diameter+e.target_size[0];return[Math.floor(t/2-e.fixation_size[0]/2),Math.floor(t/2-e.fixation_size[1]/2)]}generateDisplayLocs(e,t){for(var s=t.circle_diameter,i=s/2,r=s+t.target_size[0],a=t.target_size[0],o=t.target_size[1],l=a/2,u=o/2,d=[],h=t.randomize_item_locations?Math.floor(Math.random()*360):t.location_first_item-180,f=0;f<e;f++)d.push([Math.floor(r/2+this.cosd(h+f*(360/e))*i-u),Math.floor(r/2-this.sind(h+f*(360/e))*i-l)]);return d}generatePresentationSet(e){var t=[];if(e.target!==null&&e.foil!==null&&e.set_size!==null)if(e.target_present){for(var s=0;s<e.set_size-1;s++)t.push(e.foil);t.push(e.target)}else for(var s=0;s<e.set_size;s++)t.push(e.foil);else e.stimuli.length>0?t=e.stimuli:console.error("Error in visual-search-circle plugin: you must specify an array of images via the stimuli parameter OR specify the target, foil and set_size parameters.");return t}cosd(e){return Math.cos(e/180*Math.PI)}sind(e){return Math.sin(e/180*Math.PI)}simulate(e,t,s,i){t=="data-only"&&(i(),this.simulate_data_only(e,s)),t=="visual"&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s=this.jsPsych.pluginAPI.getValidKey([e.target_present_key,e.target_absent_key]),i=this.generatePresentationSet(e),r={correct:e.target_present?s==e.target_present_key:s==e.target_absent_key,response:s,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),set_size:i.length,target_present:e.target_present,locations:this.generateDisplayLocs(i.length,e)},a=this.jsPsych.pluginAPI.mergeSimulationData(r,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,a),a}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s(),i.rt!==null&&this.jsPsych.pluginAPI.pressKey(i.response,e.fixation_duration+i.rt)}};wp.info=fT;let Yh=wp;var yT="1.2.0";const xp=class xp{constructor(e){this.jsPsych=e,this.currentTrialData=[],this.currentTrialTargets={},this.initialized=!1,this.activeTrial=!1,this.initialize=({round_predictions:t=!0,auto_initialize:s=!1,sampling_interval:i=34,webgazer:r})=>(this.round_predictions=t,this.sampling_interval=i,this.gazeUpdateCallbacks=[],this.domObserver=new MutationObserver(this.mutationObserverCallback),new Promise((a,o)=>{typeof r>"u"?window.webgazer?this.webgazer=window.webgazer:o(new Error("Webgazer extension failed to initialize. webgazer.js not loaded. Load webgazer.js before calling initJsPsych()")):this.webgazer=r,this.hideVideo(),this.hidePredictions(),s?this.webgazer.begin().then(()=>{this.initialized=!0,this.stopMouseCalibration(),this.pause(),a()}).catch(l=>{console.error(l),o(l)}):a()})),this.on_start=t=>{this.currentTrialData=[],this.currentTrialTargets={},this.currentTrialSelectors=t.targets,this.domObserver.observe(this.jsPsych.getDisplayElement(),{childList:!0})},this.on_load=()=>{this.currentTrialStart=performance.now(),this.startSampleInterval(),this.activeTrial=!0},this.on_finish=()=>(this.stopSampleInterval(),this.domObserver.disconnect(),this.activeTrial=!1,{webgazer_data:this.currentTrialData,webgazer_targets:this.currentTrialTargets}),this.start=()=>new Promise((t,s)=>{if(typeof this.webgazer>"u"){const i="Failed to start webgazer. Things to check: Is webgazer.js loaded? Is the webgazer extension included in initJsPsych?";console.error(i),s(i)}this.webgazer.begin().then(()=>{this.initialized=!0,this.stopMouseCalibration(),this.pause(),t()}).catch(i=>{console.error(i),s(i)})}),this.startSampleInterval=(t=this.sampling_interval)=>{this.gazeInterval=setInterval(()=>{this.webgazer.getCurrentPrediction().then(this.handleGazeDataUpdate)},t),this.webgazer.getCurrentPrediction().then(this.handleGazeDataUpdate)},this.stopSampleInterval=()=>{clearInterval(this.gazeInterval)},this.isInitialized=()=>this.initialized,this.faceDetected=()=>this.webgazer.getTracker().predictionReady,this.showPredictions=()=>{this.webgazer.showPredictionPoints(!0)},this.hidePredictions=()=>{this.webgazer.showPredictionPoints(!1)},this.showVideo=()=>{this.webgazer.showVideo(!0),this.webgazer.showFaceOverlay(!0),this.webgazer.showFaceFeedbackBox(!0)},this.hideVideo=()=>{this.webgazer.showVideo(!1),this.webgazer.showFaceOverlay(!1),this.webgazer.showFaceFeedbackBox(!1)},this.resume=()=>{this.webgazer.resume()},this.pause=()=>{this.webgazer.pause(),document.querySelector("#webgazerGazeDot")&&(document.querySelector("#webgazerGazeDot").style.display="none")},this.resetCalibration=()=>{this.webgazer.clearData()},this.stopMouseCalibration=()=>{this.webgazer.removeMouseEventListeners()},this.startMouseCalibration=()=>{this.webgazer.addMouseEventListeners()},this.calibratePoint=(t,s)=>{this.webgazer.recordScreenPosition(t,s,"click")},this.setRegressionType=t=>{var s=["ridge","weightedRidge","threadedRidge"];s.includes(t)?this.webgazer.setRegression(t):console.warn("Invalid regression_type parameter for webgazer.setRegressionType. Valid options are ridge, weightedRidge, and threadedRidge.")},this.getCurrentPrediction=()=>this.webgazer.getCurrentPrediction(),this.onGazeUpdate=t=>(this.gazeUpdateCallbacks.push(t),()=>{this.gazeUpdateCallbacks=this.gazeUpdateCallbacks.filter(s=>s!==t)}),this.handleGazeDataUpdate=(t,s)=>{if(t!==null){var i={x:this.round_predictions?Math.round(t.x):t.x,y:this.round_predictions?Math.round(t.y):t.y,t:t.t};this.activeTrial&&(i.t=Math.round(t.t-this.currentTrialStart),this.currentTrialData.push(i)),this.currentGaze=i;for(var r=0;r<this.gazeUpdateCallbacks.length;r++)this.gazeUpdateCallbacks[r](i)}else this.currentGaze=null},this.mutationObserverCallback=(t,s)=>{for(const r of this.currentTrialSelectors)if(!this.currentTrialTargets[r]&&this.jsPsych.getDisplayElement().querySelector(r)){var i=this.jsPsych.getDisplayElement().querySelector(r).getBoundingClientRect();this.currentTrialTargets[r]=i}}}};xp.info={name:"webgazer",version:yT,data:{webgazer_data:{type:m.INT,array:!0},webgazer_targets:{type:m.COMPLEX,nested:{x:{type:m.INT},y:{type:m.INT},width:{type:m.INT},height:{type:m.INT},top:{type:m.INT},bottom:{type:m.INT},left:{type:m.INT},right:{type:m.INT}}}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}};let Xh=xp;var vT="2.1.0";const CT={name:"webgazer-calibrate",version:vT,parameters:{calibration_points:{type:m.INT,default:[[10,10],[10,50],[10,90],[50,10],[50,50],[50,90],[90,10],[90,50],[90,90]],array:!0},calibration_mode:{type:m.SELECT,options:["click","view"],default:"click"},point_size:{type:m.INT,default:20},repetitions_per_point:{type:m.INT,default:1},randomize_calibration_order:{type:m.BOOL,default:!1},time_to_saccade:{type:m.INT,default:1e3},time_per_point:{type:m.INT,default:1e3}},data:{},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Vp=class Vp{constructor(e){this.jsPsych=e}trial(e,t){const s=this.jsPsych.extensions.webgazer;var i=`
          <div id='webgazer-calibrate-container' style='position: relative; width:100vw; height:100vh'>
          </div>`;e.innerHTML=i;var r=e.querySelector("#webgazer-calibrate-container"),a=0,o=-1,l=null;const u=()=>{t.randomize_calibration_order?l=this.jsPsych.randomization.shuffle(t.calibration_points):l=t.calibration_points,o=-1,h()},d=()=>{s.resume(),t.calibration_mode=="click"&&s.startMouseCalibration(),u()},h=()=>{if(o++,o==l.length)a++,a==t.repetitions_per_point?C():u();else{var x=l[o];f(x)}},f=x=>{var V=`<div id="calibration-point" style="width:${t.point_size}px; height:${t.point_size}px; border-radius:${t.point_size}px; border: 1px solid #000; background-color: #333; position: absolute; left:${x[0]}%; top:${x[1]}%;"></div>`;r.innerHTML=V;var P=r.querySelector("#calibration-point");if(t.calibration_mode=="click"&&(P.style.cursor="pointer",P.addEventListener("click",()=>{h()})),t.calibration_mode=="view"){var M=P.getBoundingClientRect(),X=M.left+M.width/2,N=M.top+M.height/2,W=performance.now()+t.time_to_saccade,J=performance.now()+t.time_to_saccade+t.time_per_point;const ie=()=>{performance.now()>W&&s.calibratePoint(X,N),performance.now()<J?requestAnimationFrame(ie):h()};requestAnimationFrame(ie)}},C=()=>{t.calibration_mode=="click"&&s.stopMouseCalibration(),r.innerHTML="",b()},b=()=>{s.pause(),s.hidePredictions(),s.hideVideo();var x={};this.jsPsych.finishTrial(x)};d()}};Vp.info=CT;let ed=Vp;var bT="2.1.0";const wT={name:"webgazer-init-camera",version:bT,parameters:{instructions:{type:m.HTML_STRING,default:`
            <p>Position your head so that the webcam has a good view of your eyes.</p>
            <p>Center your face in the box and look directly towards the camera.</p>
            <p>It is important that you try and keep your head reasonably still throughout the experiment, so please take a moment to adjust your setup to be comfortable.</p>
            <p>When your face is centered in the box and the box is green, you can click to continue.</p>`},button_text:{type:m.STRING,default:"Continue"}},data:{load_time:{type:m.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Pp=class Pp{constructor(e){this.jsPsych=e}trial(e,t,s){const i=this.jsPsych.extensions.webgazer;let r;var a=performance.now(),o;const l=()=>{i.pause(),i.hideVideo();var f={load_time:o};document.querySelector("#webgazer-center-style").remove(),this.jsPsych.finishTrial(f),r()},u=()=>{s(),o=Math.round(performance.now()-a);var f=`
          <style id="webgazer-center-style">
            #webgazerVideoContainer { top: 20px !important; left: calc(50% - 160px) !important;}
          </style>
        `;document.querySelector("head").insertAdjacentHTML("beforeend",f);var C=`
          <div id='webgazer-init-container' style='position: relative; width:100vw; height:100vh'>
          </div>`;e.innerHTML=C,i.showVideo(),i.resume();var b=e.querySelector("#webgazer-init-container");if(b.innerHTML=`
          <div style='position: absolute; top: max(260px, 40%); left: calc(50% - 400px); width:800px;'>
          ${t.instructions}
          <button id='jspsych-wg-cont' class='jspsych-btn' disabled>${t.button_text}</button>
          </div>`,d())document.querySelector("#jspsych-wg-cont").disabled=!1;else{var x=new MutationObserver(h);x.observe(document,{attributes:!0,attributeFilter:["style"],subtree:!0})}document.querySelector("#jspsych-wg-cont").addEventListener("click",()=>{x&&x.disconnect(),l()})};i.isInitialized()?u():i.start().then(()=>{u()}).catch(f=>{console.log(f),e.innerHTML=`<p>The experiment cannot continue because the eye tracker failed to start.</p>
              <p>This may be because of a technical problem or because you did not grant permission for the page to use your camera.</p>`});function d(){return document.querySelector("#webgazerFaceFeedbackBox")?document.querySelector("#webgazerFaceFeedbackBox").style.borderColor=="green":!1}function h(f,C){f[0].target==document.querySelector("#webgazerFaceFeedbackBox")&&(f[0].type=="attributes"&&f[0].target.style.borderColor=="green"&&(document.querySelector("#jspsych-wg-cont").disabled=!1),f[0].type=="attributes"&&f[0].target.style.borderColor=="red"&&(document.querySelector("#jspsych-wg-cont").disabled=!0))}return new Promise(f=>{r=f})}};Pp.info=wT;let td=Pp;var xT="2.1.0";const VT={name:"webgazer-validate",version:xT,parameters:{validation_points:{type:m.INT,default:[[10,10],[10,50],[10,90],[50,10],[50,50],[50,90],[90,10],[90,50],[90,90]],array:!0},validation_point_coordinates:{type:m.SELECT,default:"percent",options:["percent","center-offset-pixels"]},roi_radius:{type:m.INT,default:200},randomize_validation_order:{type:m.BOOL,default:!1},time_to_saccade:{type:m.INT,default:1e3},validation_duration:{type:m.INT,default:2e3},point_size:{type:m.INT,default:20},show_validation_data:{type:m.BOOL,default:!1}},data:{raw_gaze:{type:m.COMPLEX,array:!0,nested:{x:{type:m.INT},y:{type:m.INT},dx:{type:m.INT},dy:{type:m.INT}}},percent_in_roi:{type:m.FLOAT,array:!0},average_offset:{type:m.FLOAT,array:!0},samples_per_sec:{type:m.FLOAT},validation_points:{type:m.INT,array:!0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Sp=class Sp{constructor(e){this.jsPsych=e}trial(e,t){const s=this.jsPsych.extensions.webgazer;var i={};i.raw_gaze=[],i.percent_in_roi=[],i.average_offset=[],i.validation_points=null;var r=`
        <div id='webgazer-validate-container' style='position: relative; width:100vw; height:100vh; overflow: hidden;'>
        </div>`;e.innerHTML=r;var a=e.querySelector("#webgazer-validate-container"),o=-1,l=null,u=performance.now();const d=()=>{s.stopSampleInterval(),this.jsPsych.finishTrial(i)},h=F=>{var Z=V(F[0],F[1]);a.innerHTML=Z;var ae=a.querySelector(".validation-point"),ue=ae.getBoundingClientRect(),me=ue.left+ue.width/2,Xe=ue.top+ue.height/2,xt=performance.now()+t.time_to_saccade,si=xt+t.validation_duration,ii=[],Ts=s.onGazeUpdate(Ht=>{performance.now()>xt&&ii.push({x:Ht.x,y:Ht.y,dx:Ht.x-me,dy:Ht.y-Xe,t:Math.round(Ht.t-u)})});requestAnimationFrame(function Ht(){performance.now()<si?requestAnimationFrame(Ht):(i.raw_gaze.push(ii),Ts(),f())})},f=()=>{if(o++,o==l.length)x();else{var F=l[o];h(F)}},C=()=>{t.randomize_validation_order?l=this.jsPsych.randomization.shuffle(t.validation_points):l=t.validation_points,i.validation_points=l,o=-1,s.startSampleInterval(),f()},b=()=>{for(var F="",Z=0;Z<t.validation_points.length;Z++){F+=V(t.validation_points[Z][0],t.validation_points[Z][1]),F+=X(t.validation_points[Z][0],t.validation_points[Z][1],0,0,t.roi_radius);for(var ae=0;ae<i.raw_gaze[Z].length;ae++)F+=J(t.validation_points[Z][0],t.validation_points[Z][1],i.raw_gaze[Z][ae].dx,i.raw_gaze[Z][ae].dy)}F+='<button id="cont" style="position:absolute; top: 50%; left:calc(50% - 50px); width: 100px;" class="jspsych-btn">Continue</btn>',a.innerHTML=F,a.querySelector("#cont").addEventListener("click",()=>{s.pause(),d()}),s.showPredictions(),s.stopSampleInterval(),s.resume()},x=()=>{i.samples_per_sec=be(i.raw_gaze).toFixed(2);for(var F=0;F<t.validation_points.length;F++)i.percent_in_roi[F]=le(i.raw_gaze[F]),i.average_offset[F]=ye(i.raw_gaze[F]);t.show_validation_data?b():d()};C();function V(F,Z){if(t.validation_point_coordinates=="percent")return P(F,Z);if(t.validation_point_coordinates=="center-offset-pixels")return M(F,Z)}function P(F,Z){return`<div class="validation-point" style="width:${t.point_size}px; height:${t.point_size}px; border-radius:${t.point_size}px; border: 1px solid #000; background-color: #333; position: absolute; left:${F}%; top:${Z}%;"></div>`}function M(F,Z){return`<div class="validation-point" style="width:${t.point_size}px; height:${t.point_size}px; border-radius:${t.point_size}px; border: 1px solid #000; background-color: #333; position: absolute; left:calc(50% - ${t.point_size/2}px + ${F}px); top:calc(50% - ${t.point_size/2}px + ${Z}px);"></div>`}function X(F,Z,ae,ue,me){if(t.validation_point_coordinates=="percent")return N(F,Z,ae,ue,me);if(t.validation_point_coordinates=="center-offset-pixels")return W(F,Z,ae,ue,me)}function N(F,Z,ae,ue,me){var Xe=`
          <div class="validation-centroid" style="width:${me*2}px; height:${me*2}px; border: 2px dotted #ccc; border-radius: ${me}px; background-color: transparent; position: absolute; left:calc(${F}% + ${ae-me}px); top:calc(${Z}% + ${ue-me}px);"></div>
        `;return Xe}function W(F,Z,ae,ue,me){var Xe=`
          <div class="validation-centroid" style="width:${me*2}px; height:${me*2}px; border: 2px dotted #ccc; border-radius: ${me}px; background-color: transparent; position: absolute; left:calc(50% + ${F}px + ${ae-me}px); top:calc(50% + ${Z}px + ${ue-me}px);"></div>
        `;return Xe}function J(F,Z,ae,ue){if(t.validation_point_coordinates=="percent")return ie(F,Z,ae,ue);if(t.validation_point_coordinates=="center-offset-pixels")return ne(F,Z,ae,ue)}function ie(F,Z,ae,ue){var me=Math.sqrt(ae*ae+ue*ue)<=t.roi_radius?"#afa":"#faa";return`<div class="raw-data-point" style="width:5px; height:5px; border-radius:5px; background-color: ${me}; opacity:0.8; position: absolute; left:calc(${F}% + ${ae-2}px); top:calc(${Z}% + ${ue-2}px);"></div>`}function ne(F,Z,ae,ue){var me=Math.sqrt(ae*ae+ue*ue)<=t.roi_radius?"#afa":"#faa";return`<div class="raw-data-point" style="width:5px; height:5px; border-radius:5px; background-color: ${me}; opacity:0.8; position: absolute; left:calc(50% + ${F}px + ${ae-2}px); top:calc(50% + ${Z}px + ${ue-2}px);"></div>`}function ce(F){var Z=Math.floor(F.length/2),ae=F.sort((ue,me)=>ue-me);return F.length%2==0?ae[Z-1]+ae[Z]/2:ae[Z]}function ye(F){var Z=F.reduce((me,Xe,xt)=>(me+=Xe.dx,xt==F.length-1?me/F.length:me),0),ae=F.reduce((me,Xe,xt)=>(me+=Xe.dy,xt==F.length-1?me/F.length:me),0),ue=ce(F.map(me=>Math.sqrt(Math.pow(me.dx-Z,2)+Math.pow(me.dy-ae,2))));return{x:Z,y:ae,r:ue}}function le(F){var Z=F.map(me=>Math.sqrt(Math.pow(me.dx,2)+Math.pow(me.dy,2))),ae=Z.reduce((me,Xe)=>(Xe<=t.roi_radius&&me++,me),0),ue=ae/F.length*100;return ue}function be(F){var Z=[];if(F.length==0)return 0;for(var ae=0;ae<F.length;ae++)if(F[ae].length>1){for(var ue=[],me=1;me<F[ae].length;me++)ue.push(F[ae][me].t-F[ae][me-1].t);Z.push(ue.reduce((Xe,xt)=>Xe+xt,0)/ue.length)}return Z.length>0?1e3/(Z.reduce((Xe,xt)=>Xe+xt,0)/Z.length):null}}};Sp.info=VT;let sd=Sp;var PT="1.2.0";const Ip=class Ip{constructor(e){this.jsPsych=e,this.recordedChunks=[],this.recorder=null,this.currentTrialData=null,this.trialComplete=!1,this.onUpdateCallback=null,this.initialize=async()=>{},this.on_start=()=>{if(this.recorder=this.jsPsych.pluginAPI.getCameraRecorder(),this.recordedChunks=[],this.trialComplete=!1,this.currentTrialData={},!this.recorder){console.warn("The record-video extension is trying to start but the camera is not initialized. Do you need to run the initialize-camera plugin?");return}this.recorder.addEventListener("dataavailable",this.handleOnDataAvailable)},this.on_load=()=>{this.recorder.start()},this.on_finish=()=>new Promise(t=>{this.trialComplete=!0,this.recorder.stop(),this.currentTrialData.record_video_data?t(this.currentTrialData):this.onUpdateCallback=()=>{t(this.currentTrialData)}}),zi(this)}handleOnDataAvailable(e){e.data.size>0&&(console.log("chunks added"),this.recordedChunks.push(e.data),this.trialComplete&&this.updateData())}updateData(){const e=new Blob(this.recordedChunks,{type:this.recorder.mimeType}),t=new FileReader;t.addEventListener("load",()=>{const s=t.result.split(",")[1];this.currentTrialData.record_video_data=s,this.onUpdateCallback&&this.onUpdateCallback()}),t.readAsDataURL(e)}};Ip.info={name:"record-video",version:PT,data:{record_video_data:{type:m.STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}};let id=Ip;var ST="1.2.0";const Tp=class Tp{constructor(e){this.jsPsych=e,this.initialize=async({minimum_sample_time:t=0})=>{this.domObserver=new MutationObserver(this.mutationObserverCallback),this.minimumSampleTime=t},this.on_start=t=>{t=t||{},this.currentTrialData=[],this.currentTrialTargets=new Map,this.currentTrialSelectors=t.targets||[],this.lastSampleTime=null,this.eventsToTrack=t.events||["mousemove"],this.domObserver.observe(this.jsPsych.getDisplayElement(),{childList:!0})},this.on_load=()=>{this.currentTrialStartTime=performance.now(),this.eventsToTrack.includes("mousemove")&&window.addEventListener("mousemove",this.mouseMoveEventHandler),this.eventsToTrack.includes("mousedown")&&window.addEventListener("mousedown",this.mouseDownEventHandler),this.eventsToTrack.includes("mouseup")&&window.addEventListener("mouseup",this.mouseUpEventHandler)},this.on_finish=()=>(this.domObserver.disconnect(),this.eventsToTrack.includes("mousemove")&&window.removeEventListener("mousemove",this.mouseMoveEventHandler),this.eventsToTrack.includes("mousedown")&&window.removeEventListener("mousedown",this.mouseDownEventHandler),this.eventsToTrack.includes("mouseup")&&window.removeEventListener("mouseup",this.mouseUpEventHandler),{mouse_tracking_data:this.currentTrialData,mouse_tracking_targets:Object.fromEntries(this.currentTrialTargets.entries())}),this.mouseMoveEventHandler=({clientX:t,clientY:s})=>{const i=performance.now(),r=Math.round(i-this.currentTrialStartTime);(this.lastSampleTime===null||i-this.lastSampleTime>=this.minimumSampleTime)&&(this.lastSampleTime=i,this.currentTrialData.push({x:t,y:s,t:r,event:"mousemove"}))},this.mouseUpEventHandler=({clientX:t,clientY:s})=>{const i=performance.now(),r=Math.round(i-this.currentTrialStartTime);this.currentTrialData.push({x:t,y:s,t:r,event:"mouseup"})},this.mouseDownEventHandler=({clientX:t,clientY:s})=>{const i=performance.now(),r=Math.round(i-this.currentTrialStartTime);this.currentTrialData.push({x:t,y:s,t:r,event:"mousedown"})},this.mutationObserverCallback=(t,s)=>{for(const i of this.currentTrialSelectors)if(!this.currentTrialTargets.has(i)){const r=this.jsPsych.getDisplayElement().querySelector(i);r&&this.currentTrialTargets.set(i,r.getBoundingClientRect())}}}};Tp.info={name:"mouse-tracking",version:ST,data:{mouse_tracking_data:{type:m.COMPLEX,array:!0,nested:{x:{type:m.INT},y:{type:m.INT},t:{type:m.INT},event:{type:m.STRING}}},mouse_tracking_targets:{type:m.COMPLEX,nested:{x:{type:m.INT},y:{type:m.INT},width:{type:m.INT},height:{type:m.INT},top:{type:m.INT},bottom:{type:m.INT},left:{type:m.INT},right:{type:m.INT}}}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}};let rd=Tp;var Mo={exports:{}},IT=Mo.exports,qC;function BC(){return qC||(qC=1,(function(n){(function(e,t,s){function i(l){var u=this,d=o();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=d(" "),u.s1=d(" "),u.s2=d(" "),u.s0-=d(l),u.s0<0&&(u.s0+=1),u.s1-=d(l),u.s1<0&&(u.s1+=1),u.s2-=d(l),u.s2<0&&(u.s2+=1),d=null}function r(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function a(l,u){var d=new i(l),h=u&&u.state,f=d.next;return f.int32=function(){return d.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,h&&(typeof h=="object"&&r(h,d),f.state=function(){return r(d,{})}),f}function o(){var l=4022871197,u=function(d){d=String(d);for(var h=0;h<d.length;h++){l+=d.charCodeAt(h);var f=.02519603282416938*l;l=f>>>0,f-=l,f*=l,l=f>>>0,f-=l,l+=f*4294967296}return(l>>>0)*23283064365386963e-26};return u}t&&t.exports?t.exports=a:this.alea=a})(IT,n)})(Mo)),Mo.exports}var ko={exports:{}},TT=ko.exports,FC;function ET(){return FC||(FC=1,(function(n){(function(e,t,s){function i(o){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},o===(o|0)?l.x=o:u+=o;for(var d=0;d<u.length+64;d++)l.x^=u.charCodeAt(d)|0,l.next()}function r(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function a(o,l){var u=new i(o),d=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,C=(u.next()>>>0)/4294967296,b=(f+C)/(1<<21);while(b===0);return b},h.int32=u.next,h.quick=h,d&&(typeof d=="object"&&r(d,u),h.state=function(){return r(u,{})}),h}t&&t.exports?t.exports=a:this.xor128=a})(TT,n)})(ko)),ko.exports}var No={exports:{}},RT=No.exports,QC;function _T(){return QC||(QC=1,(function(n){(function(e,t,s){function i(o){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:u+=o;for(var d=0;d<u.length+64;d++)l.x^=u.charCodeAt(d)|0,d==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function r(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function a(o,l){var u=new i(o),d=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,C=(u.next()>>>0)/4294967296,b=(f+C)/(1<<21);while(b===0);return b},h.int32=u.next,h.quick=h,d&&(typeof d=="object"&&r(d,u),h.state=function(){return r(u,{})}),h}t&&t.exports?t.exports=a:this.xorwow=a})(RT,n)})(No)),No.exports}var qo={exports:{}},LT=qo.exports,HC;function AT(){return HC||(HC=1,(function(n){(function(e,t,s){function i(o){var l=this;l.next=function(){var d=l.x,h=l.i,f,C;return f=d[h],f^=f>>>7,C=f^f<<24,f=d[h+1&7],C^=f^f>>>10,f=d[h+3&7],C^=f^f>>>3,f=d[h+4&7],C^=f^f<<7,f=d[h+7&7],f=f^f<<13,C^=f^f<<9,d[h]=C,l.i=h+1&7,C};function u(d,h){var f,C=[];if(h===(h|0))C[0]=h;else for(h=""+h,f=0;f<h.length;++f)C[f&7]=C[f&7]<<15^h.charCodeAt(f)+C[f+1&7]<<13;for(;C.length<8;)C.push(0);for(f=0;f<8&&C[f]===0;++f);for(f==8?C[7]=-1:C[f],d.x=C,d.i=0,f=256;f>0;--f)d.next()}u(l,o)}function r(o,l){return l.x=o.x.slice(),l.i=o.i,l}function a(o,l){o==null&&(o=+new Date);var u=new i(o),d=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,C=(u.next()>>>0)/4294967296,b=(f+C)/(1<<21);while(b===0);return b},h.int32=u.next,h.quick=h,d&&(d.x&&r(d,u),h.state=function(){return r(u,{})}),h}t&&t.exports?t.exports=a:this.xorshift7=a})(LT,n)})(qo)),qo.exports}var Bo={exports:{}},DT=Bo.exports,zC;function OT(){return zC||(zC=1,(function(n){(function(e,t,s){function i(o){var l=this;l.next=function(){var d=l.w,h=l.X,f=l.i,C,b;return l.w=d=d+1640531527|0,b=h[f+34&127],C=h[f=f+1&127],b^=b<<13,C^=C<<17,b^=b>>>15,C^=C>>>12,b=h[f]=b^C,l.i=f,b+(d^d>>>16)|0};function u(d,h){var f,C,b,x,V,P=[],M=128;for(h===(h|0)?(C=h,h=null):(h=h+"\0",C=0,M=Math.max(M,h.length)),b=0,x=-32;x<M;++x)h&&(C^=h.charCodeAt((x+32)%h.length)),x===0&&(V=C),C^=C<<10,C^=C>>>15,C^=C<<4,C^=C>>>13,x>=0&&(V=V+1640531527|0,f=P[x&127]^=C+V,b=f==0?b+1:0);for(b>=128&&(P[(h&&h.length||0)&127]=-1),b=127,x=512;x>0;--x)C=P[b+34&127],f=P[b=b+1&127],C^=C<<13,f^=f<<17,C^=C>>>15,f^=f>>>12,P[b]=C^f;d.w=V,d.X=P,d.i=b}u(l,o)}function r(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function a(o,l){o==null&&(o=+new Date);var u=new i(o),d=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,C=(u.next()>>>0)/4294967296,b=(f+C)/(1<<21);while(b===0);return b},h.int32=u.next,h.quick=h,d&&(d.X&&r(d,u),h.state=function(){return r(u,{})}),h}t&&t.exports?t.exports=a:this.xor4096=a})(DT,n)})(Bo)),Bo.exports}var Fo={exports:{}},MT=Fo.exports,jC;function kT(){return jC||(jC=1,(function(n){(function(e,t,s){function i(o){var l=this,u="";l.next=function(){var h=l.b,f=l.c,C=l.d,b=l.a;return h=h<<25^h>>>7^f,f=f-C|0,C=C<<24^C>>>8^b,b=b-h|0,l.b=h=h<<20^h>>>12^f,l.c=f=f-C|0,l.d=C<<16^f>>>16^b,l.a=b-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):u+=o;for(var d=0;d<u.length+20;d++)l.b^=u.charCodeAt(d)|0,l.next()}function r(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function a(o,l){var u=new i(o),d=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,C=(u.next()>>>0)/4294967296,b=(f+C)/(1<<21);while(b===0);return b},h.int32=u.next,h.quick=h,d&&(typeof d=="object"&&r(d,u),h.state=function(){return r(u,{})}),h}t&&t.exports?t.exports=a:this.tychei=a})(MT,n)})(Fo)),Fo.exports}var Qo={exports:{}},NT=Qo.exports,UC;function qT(){return UC||(UC=1,(function(n){(function(e,t,s){var i=256,r=6,a=52,o="random",l=s.pow(i,r),u=s.pow(2,a),d=u*2,h=i-1,f;function C(N,W,J){var ie=[];W=W==!0?{entropy:!0}:W||{};var ne=P(V(W.entropy?[N,X(t)]:N??M(),3),ie),ce=new b(ie),ye=function(){for(var le=ce.g(r),be=l,F=0;le<u;)le=(le+F)*i,be*=i,F=ce.g(1);for(;le>=d;)le/=2,be/=2,F>>>=1;return(le+F)/be};return ye.int32=function(){return ce.g(4)|0},ye.quick=function(){return ce.g(4)/4294967296},ye.double=ye,P(X(ce.S),t),(W.pass||J||function(le,be,F,Z){return Z&&(Z.S&&x(Z,ce),le.state=function(){return x(ce,{})}),F?(s[o]=le,be):le})(ye,ne,"global"in W?W.global:this==s,W.state)}function b(N){var W,J=N.length,ie=this,ne=0,ce=ie.i=ie.j=0,ye=ie.S=[];for(J||(N=[J++]);ne<i;)ye[ne]=ne++;for(ne=0;ne<i;ne++)ye[ne]=ye[ce=h&ce+N[ne%J]+(W=ye[ne])],ye[ce]=W;(ie.g=function(le){for(var be,F=0,Z=ie.i,ae=ie.j,ue=ie.S;le--;)be=ue[Z=h&Z+1],F=F*i+ue[h&(ue[Z]=ue[ae=h&ae+be])+(ue[ae]=be)];return ie.i=Z,ie.j=ae,F})(i)}function x(N,W){return W.i=N.i,W.j=N.j,W.S=N.S.slice(),W}function V(N,W){var J=[],ie=typeof N,ne;if(W&&ie=="object")for(ne in N)try{J.push(V(N[ne],W-1))}catch{}return J.length?J:ie=="string"?N:N+"\0"}function P(N,W){for(var J=N+"",ie,ne=0;ne<J.length;)W[h&ne]=h&(ie^=W[h&ne]*19)+J.charCodeAt(ne++);return X(W)}function M(){try{var N;return f&&(N=f.randomBytes)?N=N(i):(N=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(N)),X(N)}catch{var W=e.navigator,J=W&&W.plugins;return[+new Date,e,J,e.screen,X(t)]}}function X(N){return String.fromCharCode.apply(0,N)}if(P(s.random(),t),n.exports){n.exports=C;try{f=Df}catch{}}else s["seed"+o]=C})(typeof self<"u"?self:NT,[],Math)})(Qo)),Qo.exports}var nd,WC;function BT(){if(WC)return nd;WC=1;var n=BC(),e=ET(),t=_T(),s=AT(),i=OT(),r=kT(),a=qT();return a.alea=n,a.xor128=e,a.xorwow=t,a.xorshift7=s,a.xor4096=i,a.tychei=r,nd=a,nd}var ad,$C;function FT(){if($C)return ad;$C=1;var n=BT(),e=["ability","able","aboard","about","above","accept","accident","according","account","accurate","acres","across","act","action","active","activity","actual","actually","add","addition","additional","adjective","adult","adventure","advice","affect","afraid","after","afternoon","again","against","age","ago","agree","ahead","aid","air","airplane","alike","alive","all","allow","almost","alone","along","aloud","alphabet","already","also","although","am","among","amount","ancient","angle","angry","animal","announced","another","answer","ants","any","anybody","anyone","anything","anyway","anywhere","apart","apartment","appearance","apple","applied","appropriate","are","area","arm","army","around","arrange","arrangement","arrive","arrow","art","article","as","aside","ask","asleep","at","ate","atmosphere","atom","atomic","attached","attack","attempt","attention","audience","author","automobile","available","average","avoid","aware","away","baby","back","bad","badly","bag","balance","ball","balloon","band","bank","bar","bare","bark","barn","base","baseball","basic","basis","basket","bat","battle","be","bean","bear","beat","beautiful","beauty","became","because","become","becoming","bee","been","before","began","beginning","begun","behavior","behind","being","believed","bell","belong","below","belt","bend","beneath","bent","beside","best","bet","better","between","beyond","bicycle","bigger","biggest","bill","birds","birth","birthday","bit","bite","black","blank","blanket","blew","blind","block","blood","blow","blue","board","boat","body","bone","book","border","born","both","bottle","bottom","bound","bow","bowl","box","boy","brain","branch","brass","brave","bread","break","breakfast","breath","breathe","breathing","breeze","brick","bridge","brief","bright","bring","broad","broke","broken","brother","brought","brown","brush","buffalo","build","building","built","buried","burn","burst","bus","bush","business","busy","but","butter","buy","by","cabin","cage","cake","call","calm","came","camera","camp","can","canal","cannot","cap","capital","captain","captured","car","carbon","card","care","careful","carefully","carried","carry","case","cast","castle","cat","catch","cattle","caught","cause","cave","cell","cent","center","central","century","certain","certainly","chain","chair","chamber","chance","change","changing","chapter","character","characteristic","charge","chart","check","cheese","chemical","chest","chicken","chief","child","children","choice","choose","chose","chosen","church","circle","circus","citizen","city","class","classroom","claws","clay","clean","clear","clearly","climate","climb","clock","close","closely","closer","cloth","clothes","clothing","cloud","club","coach","coal","coast","coat","coffee","cold","collect","college","colony","color","column","combination","combine","come","comfortable","coming","command","common","community","company","compare","compass","complete","completely","complex","composed","composition","compound","concerned","condition","congress","connected","consider","consist","consonant","constantly","construction","contain","continent","continued","contrast","control","conversation","cook","cookies","cool","copper","copy","corn","corner","correct","correctly","cost","cotton","could","count","country","couple","courage","course","court","cover","cow","cowboy","crack","cream","create","creature","crew","crop","cross","crowd","cry","cup","curious","current","curve","customs","cut","cutting","daily","damage","dance","danger","dangerous","dark","darkness","date","daughter","dawn","day","dead","deal","dear","death","decide","declared","deep","deeply","deer","definition","degree","depend","depth","describe","desert","design","desk","detail","determine","develop","development","diagram","diameter","did","die","differ","difference","different","difficult","difficulty","dig","dinner","direct","direction","directly","dirt","dirty","disappear","discover","discovery","discuss","discussion","disease","dish","distance","distant","divide","division","do","doctor","does","dog","doing","doll","dollar","done","donkey","door","dot","double","doubt","down","dozen","draw","drawn","dream","dress","drew","dried","drink","drive","driven","driver","driving","drop","dropped","drove","dry","duck","due","dug","dull","during","dust","duty","each","eager","ear","earlier","early","earn","earth","easier","easily","east","easy","eat","eaten","edge","education","effect","effort","egg","eight","either","electric","electricity","element","elephant","eleven","else","empty","end","enemy","energy","engine","engineer","enjoy","enough","enter","entire","entirely","environment","equal","equally","equator","equipment","escape","especially","essential","establish","even","evening","event","eventually","ever","every","everybody","everyone","everything","everywhere","evidence","exact","exactly","examine","example","excellent","except","exchange","excited","excitement","exciting","exclaimed","exercise","exist","expect","experience","experiment","explain","explanation","explore","express","expression","extra","eye","face","facing","fact","factor","factory","failed","fair","fairly","fall","fallen","familiar","family","famous","far","farm","farmer","farther","fast","fastened","faster","fat","father","favorite","fear","feathers","feature","fed","feed","feel","feet","fell","fellow","felt","fence","few","fewer","field","fierce","fifteen","fifth","fifty","fight","fighting","figure","fill","film","final","finally","find","fine","finest","finger","finish","fire","fireplace","firm","first","fish","five","fix","flag","flame","flat","flew","flies","flight","floating","floor","flow","flower","fly","fog","folks","follow","food","foot","football","for","force","foreign","forest","forget","forgot","forgotten","form","former","fort","forth","forty","forward","fought","found","four","fourth","fox","frame","free","freedom","frequently","fresh","friend","friendly","frighten","frog","from","front","frozen","fruit","fuel","full","fully","fun","function","funny","fur","furniture","further","future","gain","game","garage","garden","gas","gasoline","gate","gather","gave","general","generally","gentle","gently","get","getting","giant","gift","girl","give","given","giving","glad","glass","globe","go","goes","gold","golden","gone","good","goose","got","government","grabbed","grade","gradually","grain","grandfather","grandmother","graph","grass","gravity","gray","great","greater","greatest","greatly","green","grew","ground","group","grow","grown","growth","guard","guess","guide","gulf","gun","habit","had","hair","half","halfway","hall","hand","handle","handsome","hang","happen","happened","happily","happy","harbor","hard","harder","hardly","has","hat","have","having","hay","he","headed","heading","health","heard","hearing","heart","heat","heavy","height","held","hello","help","helpful","her","herd","here","herself","hidden","hide","high","higher","highest","highway","hill","him","himself","his","history","hit","hold","hole","hollow","home","honor","hope","horn","horse","hospital","hot","hour","house","how","however","huge","human","hundred","hung","hungry","hunt","hunter","hurried","hurry","hurt","husband","ice","idea","identity","if","ill","image","imagine","immediately","importance","important","impossible","improve","in","inch","include","including","income","increase","indeed","independent","indicate","individual","industrial","industry","influence","information","inside","instance","instant","instead","instrument","interest","interior","into","introduced","invented","involved","iron","is","island","it","its","itself","jack","jar","jet","job","join","joined","journey","joy","judge","jump","jungle","just","keep","kept","key","kids","kill","kind","kitchen","knew","knife","know","knowledge","known","label","labor","lack","lady","laid","lake","lamp","land","language","large","larger","largest","last","late","later","laugh","law","lay","layers","lead","leader","leaf","learn","least","leather","leave","leaving","led","left","leg","length","lesson","let","letter","level","library","lie","life","lift","light","like","likely","limited","line","lion","lips","liquid","list","listen","little","live","living","load","local","locate","location","log","lonely","long","longer","look","loose","lose","loss","lost","lot","loud","love","lovely","low","lower","luck","lucky","lunch","lungs","lying","machine","machinery","mad","made","magic","magnet","mail","main","mainly","major","make","making","man","managed","manner","manufacturing","many","map","mark","market","married","mass","massage","master","material","mathematics","matter","may","maybe","me","meal","mean","means","meant","measure","meat","medicine","meet","melted","member","memory","men","mental","merely","met","metal","method","mice","middle","might","mighty","mile","military","milk","mill","mind","mine","minerals","minute","mirror","missing","mission","mistake","mix","mixture","model","modern","molecular","moment","money","monkey","month","mood","moon","more","morning","most","mostly","mother","motion","motor","mountain","mouse","mouth","move","movement","movie","moving","mud","muscle","music","musical","must","my","myself","mysterious","nails","name","nation","national","native","natural","naturally","nature","near","nearby","nearer","nearest","nearly","necessary","neck","needed","needle","needs","negative","neighbor","neighborhood","nervous","nest","never","new","news","newspaper","next","nice","night","nine","no","nobody","nodded","noise","none","noon","nor","north","nose","not","note","noted","nothing","notice","noun","now","number","numeral","nuts","object","observe","obtain","occasionally","occur","ocean","of","off","offer","office","officer","official","oil","old","older","oldest","on","once","one","only","onto","open","operation","opinion","opportunity","opposite","or","orange","orbit","order","ordinary","organization","organized","origin","original","other","ought","our","ourselves","out","outer","outline","outside","over","own","owner","oxygen","pack","package","page","paid","pain","paint","pair","palace","pale","pan","paper","paragraph","parallel","parent","park","part","particles","particular","particularly","partly","parts","party","pass","passage","past","path","pattern","pay","peace","pen","pencil","people","per","percent","perfect","perfectly","perhaps","period","person","personal","pet","phrase","physical","piano","pick","picture","pictured","pie","piece","pig","pile","pilot","pine","pink","pipe","pitch","place","plain","plan","plane","planet","planned","planning","plant","plastic","plate","plates","play","pleasant","please","pleasure","plenty","plural","plus","pocket","poem","poet","poetry","point","pole","police","policeman","political","pond","pony","pool","poor","popular","population","porch","port","position","positive","possible","possibly","post","pot","potatoes","pound","pour","powder","power","powerful","practical","practice","prepare","present","president","press","pressure","pretty","prevent","previous","price","pride","primitive","principal","principle","printed","private","prize","probably","problem","process","produce","product","production","program","progress","promised","proper","properly","property","protection","proud","prove","provide","public","pull","pupil","pure","purple","purpose","push","put","putting","quarter","queen","question","quick","quickly","quiet","quietly","quite","rabbit","race","radio","railroad","rain","raise","ran","ranch","range","rapidly","rate","rather","raw","rays","reach","read","reader","ready","real","realize","rear","reason","recall","receive","recent","recently","recognize","record","red","refer","refused","region","regular","related","relationship","religious","remain","remarkable","remember","remove","repeat","replace","replied","report","represent","require","research","respect","rest","result","return","review","rhyme","rhythm","rice","rich","ride","riding","right","ring","rise","rising","river","road","roar","rock","rocket","rocky","rod","roll","roof","room","root","rope","rose","rough","round","route","row","rubbed","rubber","rule","ruler","run","running","rush","sad","saddle","safe","safety","said","sail","sale","salmon","salt","same","sand","sang","sat","satellites","satisfied","save","saved","saw","say","scale","scared","scene","school","science","scientific","scientist","score","screen","sea","search","season","seat","second","secret","section","see","seed","seeing","seems","seen","seldom","select","selection","sell","send","sense","sent","sentence","separate","series","serious","serve","service","sets","setting","settle","settlers","seven","several","shade","shadow","shake","shaking","shall","shallow","shape","share","sharp","she","sheep","sheet","shelf","shells","shelter","shine","shinning","ship","shirt","shoe","shoot","shop","shore","short","shorter","shot","should","shoulder","shout","show","shown","shut","sick","sides","sight","sign","signal","silence","silent","silk","silly","silver","similar","simple","simplest","simply","since","sing","single","sink","sister","sit","sitting","situation","six","size","skill","skin","sky","slabs","slave","sleep","slept","slide","slight","slightly","slip","slipped","slope","slow","slowly","small","smaller","smallest","smell","smile","smoke","smooth","snake","snow","so","soap","social","society","soft","softly","soil","solar","sold","soldier","solid","solution","solve","some","somebody","somehow","someone","something","sometime","somewhere","son","song","soon","sort","sound","source","south","southern","space","speak","special","species","specific","speech","speed","spell","spend","spent","spider","spin","spirit","spite","split","spoken","sport","spread","spring","square","stage","stairs","stand","standard","star","stared","start","state","statement","station","stay","steady","steam","steel","steep","stems","step","stepped","stick","stiff","still","stock","stomach","stone","stood","stop","stopped","store","storm","story","stove","straight","strange","stranger","straw","stream","street","strength","stretch","strike","string","strip","strong","stronger","struck","structure","struggle","stuck","student","studied","studying","subject","substance","success","successful","such","sudden","suddenly","sugar","suggest","suit","sum","summer","sun","sunlight","supper","supply","support","suppose","sure","surface","surprise","surrounded","swam","sweet","swept","swim","swimming","swing","swung","syllable","symbol","system","table","tail","take","taken","tales","talk","tall","tank","tape","task","taste","taught","tax","tea","teach","teacher","team","tears","teeth","telephone","television","tell","temperature","ten","tent","term","terrible","test","than","thank","that","thee","them","themselves","then","theory","there","therefore","these","they","thick","thin","thing","think","third","thirty","this","those","thou","though","thought","thousand","thread","three","threw","throat","through","throughout","throw","thrown","thumb","thus","thy","tide","tie","tight","tightly","till","time","tin","tiny","tip","tired","title","to","tobacco","today","together","told","tomorrow","tone","tongue","tonight","too","took","tool","top","topic","torn","total","touch","toward","tower","town","toy","trace","track","trade","traffic","trail","train","transportation","trap","travel","treated","tree","triangle","tribe","trick","tried","trip","troops","tropical","trouble","truck","trunk","truth","try","tube","tune","turn","twelve","twenty","twice","two","type","typical","uncle","under","underline","understanding","unhappy","union","unit","universe","unknown","unless","until","unusual","up","upon","upper","upward","us","use","useful","using","usual","usually","valley","valuable","value","vapor","variety","various","vast","vegetable","verb","vertical","very","vessels","victory","view","village","visit","visitor","voice","volume","vote","vowel","voyage","wagon","wait","walk","wall","want","war","warm","warn","was","wash","waste","watch","water","wave","way","we","weak","wealth","wear","weather","week","weigh","weight","welcome","well","went","were","west","western","wet","whale","what","whatever","wheat","wheel","when","whenever","where","wherever","whether","which","while","whispered","whistle","white","who","whole","whom","whose","why","wide","widely","wife","wild","will","willing","win","wind","window","wing","winter","wire","wise","wish","with","within","without","wolf","women","won","wonder","wonderful","wood","wooden","wool","word","wore","work","worker","world","worried","worry","worse","worth","would","wrapped","write","writer","writing","written","wrong","wrote","yard","year","yellow","yes","yesterday","yet","you","young","younger","your","yourself","youth","zero","zebra","zipper","zoo","zulu"];function t(s){const i=s?.seed?new n(s.seed):null;function r(){return s&&s.maxLength>1?a():o()}function a(){for(var b=!1,x;!b;)x=o(),x.length<=s.maxLength&&(b=!0);return x}function o(){return e[l(e.length)]}function l(b){const x=i?i():Math.random();return Math.floor(x*b)}if(typeof s>"u")return r();typeof s=="number"&&(s={exactly:s}),s.exactly&&(s.min=s.exactly,s.max=s.exactly),typeof s.wordsPerString!="number"&&(s.wordsPerString=1),typeof s.formatter!="function"&&(s.formatter=b=>b),typeof s.separator!="string"&&(s.separator=" ");for(var u=s.min+l(s.max+1-s.min),d=[],h="",f=0,C=0;C<u*s.wordsPerString;C++)f===s.wordsPerString-1?h+=s.formatter(r(),f):h+=s.formatter(r(),f)+s.separator,f++,(C+1)%s.wordsPerString===0&&(d.push(h),h="",f=0);return typeof s.join=="string"&&(d=d.join(s.join)),d}return ad=t,t.wordList=e,ad}FT(),BC();var $=(n=>(n[n.BOOL=0]="BOOL",n[n.STRING=1]="STRING",n[n.INT=2]="INT",n[n.FLOAT=3]="FLOAT",n[n.FUNCTION=4]="FUNCTION",n[n.KEY=5]="KEY",n[n.KEYS=6]="KEYS",n[n.SELECT=7]="SELECT",n[n.HTML_STRING=8]="HTML_STRING",n[n.IMAGE=9]="IMAGE",n[n.AUDIO=10]="AUDIO",n[n.VIDEO=11]="VIDEO",n[n.OBJECT=12]="OBJECT",n[n.COMPLEX=13]="COMPLEX",n[n.TIMELINE=14]="TIMELINE",n))($||{});$.AUDIO,$.IMAGE,$.VIDEO;class Ki extends Error{constructor(e="The global `jsPsych` variable is no longer available in jsPsych v7."){super(`${e} Please follow the migration guide at https://www.jspsych.org/7.0/support/migration-v7/ to update your experiment.`),this.name="MigrationError"}}window.jsPsych={get init(){throw new Ki("`jsPsych.init()` was replaced by `initJsPsych()` in jsPsych v7.")},get data(){throw new Ki},get randomization(){throw new Ki},get turk(){throw new Ki},get pluginAPI(){throw new Ki},get ALL_KEYS(){throw new Ki('jsPsych.ALL_KEYS was replaced by the "ALL_KEYS" string in jsPsych v7.')},get NO_KEYS(){throw new Ki('jsPsych.NO_KEYS was replaced by the "NO_KEYS" string in jsPsych v7.')}},typeof window<"u"&&window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext);var QT="2.2.0";const HT={name:"ImageComponent",version:QT,parameters:{name:{type:$.STRING,default:void 0},stimulus:{type:$.IMAGE,default:void 0},height:{type:$.INT,default:null},width:{type:$.INT,default:null},maintain_aspect_ratio:{type:$.BOOL,default:!0},stimulus_duration:{type:$.INT,default:null},coordinates:{type:$.OBJECT,pretty_name:"Coordinates",default:{x:0,y:0},description:"Object with x and y properties for absolute positioning"}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Ep=class Ep{constructor(e){this.element=null,this.hideTimeout=null,this.jsPsych=e}render(e,t){const s=f=>f>1?50:f<-1?-50:f*50,i=t.coordinates!==void 0;let r;if(i){if(r=document.createElement("div"),r.style.position="absolute",t.coordinates.x!==void 0){const f=s(t.coordinates.x);r.style.left=`calc(50% + ${f}vw)`}else r.style.left="50%";if(t.coordinates.y!==void 0){const f=s(t.coordinates.y);r.style.top=`calc(50% + ${f}vh)`}else r.style.top="50%";r.style.transform="translate(-50%, -50%)",e.appendChild(r)}else r=e;const a=f=>{let C,b;return t.height!==null?(b=t.height,t.width==null&&t.maintain_aspect_ratio?C=f.naturalWidth*(t.height/f.naturalHeight):C=f.naturalWidth):(b=f.naturalHeight,C=f.naturalWidth),t.width!==null&&(C=t.width,t.height==null&&t.maintain_aspect_ratio&&(b=f.naturalHeight*(t.width/f.naturalWidth))),[C,b]};let o,l=null;const u=t.render_on_canvas?new Image:document.createElement("img");t.render_on_canvas||(u.id=t.name?`jspsych-dynamic-${t.name}-stimulus`:"jspsych-dynamic-image-stimulus",u.className="dynamic-image-component"),t.render_on_canvas?(l=document.createElement("canvas"),l.id=t.name?`jspsych-dynamic-${t.name}-stimulus`:"jspsych-dynamic-image-stimulus",l.className="dynamic-image-component",l.style.margin="0",l.style.padding="0",o=l):o=u;const d=()=>{const[f,C]=a(u);if(t.render_on_canvas&&l){l.width=f,l.height=C;const b=l.getContext("2d");b&&b.drawImage(u,0,0,f,C)}else o.style.width=`${f}px`,o.style.height=`${C}px`};let h=!1;return u.onload=()=>{h||(d(),h=!0)},u.src=t.stimulus,u.complete&&u.naturalWidth!==0&&(d(),h=!0),r.appendChild(o),t.stimulus_duration!==null&&(this.hideTimeout=this.jsPsych.pluginAPI.setTimeout(()=>{this.hide()},t.stimulus_duration)),this.element=o,o}hide(){this.element&&(this.element.style.visibility="hidden")}show(){this.element&&(this.element.style.visibility="visible")}destroy(){this.hideTimeout!==null&&clearTimeout(this.hideTimeout),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null}getElement(){return this.element}};Ep.info=HT;let od=Ep;var zT="2.2.0";const jT={name:"VideoComponent",version:zT,parameters:{name:{type:$.STRING,default:void 0},stimulus:{type:$.VIDEO,default:void 0,array:!0},width:{type:$.INT,default:null},height:{type:$.INT,default:null},autoplay:{type:$.BOOL,pretty_name:"Autoplay",default:!0},controls:{type:$.BOOL,default:!1},start:{type:$.FLOAT,default:null},stop:{type:$.FLOAT,default:null},rate:{type:$.FLOAT,default:1},coordinates:{type:$.OBJECT,default:{x:0,y:0}}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Rp=class Rp{constructor(e){this.videoElement=null,this.wrapper=null,this.stopped=!1,this.jsPsych=e}render(e,t){const s=d=>d<-1?-50:d>1?50:d*50,i=document.createElement("div");i.id="jspsych-dynamic-video-component-wrapper",i.className="dynamic-video-component-wrapper",i.style.position="absolute";const r=s(t.coordinates.x),a=s(t.coordinates.y);i.style.left=`calc(50% + ${r}vw)`,i.style.top=`calc(50% + ${a}vh)`,i.style.transform="translate(-50%, -50%)",e.appendChild(i);const o=document.createElement("video");i.appendChild(o),o.id=t.name?`jspsych-dynamic-${t.name}-stimulus`:"jspsych-dynamic-video-stimulus",o.className="dynamic-video-component",o.setAttribute("playsinline",""),t.width&&(o.width=t.width),t.height&&(o.height=t.height),o.controls=t.controls!==void 0?t.controls:!1;const l=t.autoplay!==void 0?t.autoplay:!0;t.start!=null&&typeof t.start=="number"&&!isNaN(t.start)&&(o.style.visibility="hidden");const u=this.jsPsych.pluginAPI.getVideoBuffer(t.stimulus[0]);if(u)o.src=u;else for(let d of t.stimulus){d.indexOf("?")>-1&&(d=d.substring(0,d.indexOf("?")));const h=d.substring(d.lastIndexOf(".")+1).toLowerCase();h==="mov"&&console.warn("Warning: VideoComponent does not reliably support .mov files.");const f=document.createElement("source");f.src=d,f.type="video/"+h,o.appendChild(f)}return o.playbackRate=t.rate||1,l&&t.start==null&&o.addEventListener("loadeddata",()=>{const d=o.play();d!==void 0&&d.catch(h=>{console.warn("Autoplay with audio failed, trying muted:",h),o.muted=!0,o.play().then(()=>{console.log("Playing muted - click video to unmute"),o.addEventListener("click",()=>{o.muted=!1},{once:!0})}).catch(f=>{console.error("Autoplay failed completely:",f),o.controls=!0})})},{once:!0}),t.start!=null&&typeof t.start=="number"&&!isNaN(t.start)&&(o.pause(),o.onseeked=()=>{o.style.visibility="visible",o.muted=!1,t.autoplay?o.play():o.pause(),o.onseeked=()=>{}},o.onplaying=()=>{o.currentTime=t.start,o.onplaying=()=>{}},o.muted=!0,o.play()),t.stop!=null&&typeof t.stop=="number"&&!isNaN(t.stop)&&o.addEventListener("timeupdate",()=>{o.currentTime>=t.stop&&!this.stopped&&(this.stopped=!0,o.pause())}),this.videoElement=o,this.wrapper=i,o}play(){this.videoElement&&this.videoElement.play()}pause(){this.videoElement&&this.videoElement.pause()}stop(){this.videoElement&&(this.videoElement.pause(),this.videoElement.currentTime=0)}addEventListener(e,t){this.videoElement&&this.videoElement.addEventListener(e,t)}removeEventListener(e,t){this.videoElement&&this.videoElement.removeEventListener(e,t)}hasEnded(){return this.videoElement?this.videoElement.ended:!0}getCurrentTime(){return this.videoElement?this.videoElement.currentTime:0}setCurrentTime(e){this.videoElement&&(this.videoElement.currentTime=e)}hide(){this.videoElement&&(this.videoElement.style.visibility="hidden")}show(){this.videoElement&&(this.videoElement.style.visibility="visible")}destroy(){this.videoElement&&(this.videoElement.pause(),this.videoElement.onended=()=>{}),this.wrapper&&this.wrapper.parentNode&&this.wrapper.parentNode.removeChild(this.wrapper),this.wrapper=null,this.videoElement=null}getVideoElement(){return this.videoElement}};Rp.info=jT;let ld=Rp;var UT="2.1.0";const WT={name:"HtmlComponent",version:UT,parameters:{name:{type:$.STRING,default:void 0},stimulus:{type:$.HTML_STRING,default:void 0},coordinates:{type:$.OBJECT,default:{x:0,y:0}}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},_p=class _p{constructor(e){this.stimulusElement=null,this.jsPsych=e}render(e,t){const s=o=>o<-1?-50:o>1?50:o*50,i=document.createElement("div");i.id=t.name?`jspsych-dynamic-${t.name}-stimulus`:"jspsych-dynamic-html-stimulus",i.className="dynamic-html-component-stimulus",i.style.position="absolute",i.style.width="max-content";const r=s(t.coordinates.x),a=s(t.coordinates.y);return i.style.left=`calc(50% + ${r}vw)`,i.style.top=`calc(50% + ${a}vh)`,i.style.transform="translate(-50%, -50%)",i.innerHTML=t.stimulus,e.appendChild(i),this.stimulusElement=i,i}hide(){this.stimulusElement&&(this.stimulusElement.style.visibility="hidden")}show(){this.stimulusElement&&(this.stimulusElement.style.visibility="visible")}destroy(){this.stimulusElement&&this.stimulusElement.parentNode&&this.stimulusElement.parentNode.removeChild(this.stimulusElement),this.stimulusElement=null}getElement(){return this.stimulusElement}getStimulus(){return this.stimulusElement?this.stimulusElement.innerHTML:""}};_p.info=WT;let ud=_p;var $T="2.1.0";const GT={name:"AudioComponent",version:$T,parameters:{name:{type:$.STRING,default:void 0},stimulus:{type:$.AUDIO,default:void 0},show_controls:{type:$.BOOL,default:!1},autoplay:{type:$.BOOL,default:!0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Lp=class Lp{constructor(e){this.audio=null,this.element=null,this.context=null,this.jsPsych=e,this.context=this.jsPsych.pluginAPI.audioContext()}async render(e,t){if(this.audio=await this.jsPsych.pluginAPI.getAudioPlayer(t.stimulus),t.show_controls){const i=document.createElement("div");i.id=t.name?`jspsych-dynamic-${t.name}-stimulus`:"jspsych-dynamic-audio-stimulus",i.className="dynamic-audio-component",i.innerHTML=`
        <div class="audio-controls">
          <span> Audio playing</span>
        </div>
      `,e.appendChild(i),this.element=i}if((t.autoplay!==void 0?t.autoplay:!0)&&this.audio)try{await this.audio.play()}catch(i){console.warn("Audio autoplay failed:",i),this.element&&(this.element.innerHTML=`
            <div class="audio-controls">
              <button onclick="this.parentElement.parentElement.click()">Click to play audio</button>
            </div>
          `,this.element.addEventListener("click",()=>{this.play()},{once:!0}))}return this.element}play(){this.audio&&this.audio.play()}pause(){this.audio&&this.audio.pause()}stop(){this.audio&&this.audio.stop()}addEventListener(e,t){this.audio&&this.audio.addEventListener(e,t)}removeEventListener(e,t){this.audio&&this.audio.removeEventListener(e,t)}hasEnded(){return this.audio?this.audio.ended:!0}destroy(){this.audio&&this.audio.stop(),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.audio=null}getAudio(){return this.audio}};Lp.info=GT;let hd=Lp;var JT="2.2.0";const KT={name:"ButtonResponseComponent",version:JT,parameters:{name:{type:$.STRING,default:void 0},choices:{type:$.STRING,default:void 0,array:!0},button_html:{type:$.FUNCTION,default:function(n,e){return`<button class="jspsych-btn">${n}</button>`}},image_button_width:{type:$.INT,default:150},image_button_height:{type:$.INT,default:150},button_layout:{type:$.STRING,default:"grid"},grid_rows:{type:$.INT,default:1},grid_columns:{type:$.INT,default:null},enable_button_after:{type:$.INT,default:0},coordinates:{type:$.OBJECT,default:{x:0,y:0}}},data:{response:{type:$.STRING},rt:{type:$.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Ap=class Ap{constructor(e){this.jsPsych=e,this.response=null,this.rt=null,this.start_time=null,this.buttonGroupElement=null,this.enableTimeout=null}isImageUrl(e){if(!e)return!1;try{const s=new URL(e).pathname.toLowerCase();return/\.(jpg|jpeg|png|gif|bmp|svg|webp)(\?.*)?$/i.test(s)}catch{return/\.(jpg|jpeg|png|gif|bmp|svg|webp)$/i.test(e.toLowerCase())}}generateButtonHtml(e,t,s){if(this.isImageUrl(e)){const i=s.image_button_width||150,r=s.image_button_height||150;return`<button class="jspsych-btn jspsych-btn-image" style="padding: 5px; border: 2px solid #ccc; background: white;">
        <img src="${e}" style="width: ${i}px; height: ${r}px; object-fit: cover; display: block; pointer-events: none;" />
      </button>`}else return`<button class="jspsych-btn">${e}</button>`}render(e,t,s){const i=u=>u<-1?-50:u>1?50:u*50;this.buttonGroupElement=document.createElement("div"),this.buttonGroupElement.id="jspsych-button-response-component-btngroup",this.buttonGroupElement.style.position="absolute",this.buttonGroupElement.style.width="max-content";const r=t.coordinates||{x:0,y:0},a=i(r.x),o=i(r.y);if(this.buttonGroupElement.style.left=`calc(50% + ${a}vw)`,this.buttonGroupElement.style.top=`calc(50% + ${o}vh)`,this.buttonGroupElement.style.transform="translate(-50%, -50%)",e.appendChild(this.buttonGroupElement),t.button_layout==="grid"){if(this.buttonGroupElement.classList.add("jspsych-btn-group-grid"),t.grid_rows===null&&t.grid_columns===null)throw new Error("You cannot set `grid_rows` to `null` without providing a value for `grid_columns`.");const u=t.grid_columns===null?Math.ceil(t.choices.length/t.grid_rows):t.grid_columns,d=t.grid_rows===null?Math.ceil(t.choices.length/t.grid_columns):t.grid_rows;this.buttonGroupElement.style.gridTemplateColumns=`repeat(${u}, 1fr)`,this.buttonGroupElement.style.gridTemplateRows=`repeat(${d}, 1fr)`}else t.button_layout==="flex"&&this.buttonGroupElement.classList.add("jspsych-btn-group-flex");const l=t.button_html?t.button_html:(u,d)=>this.generateButtonHtml(u,d,t);for(let u=0;u<t.choices.length;u++){const d=t.choices[u],h=l(d,u);this.buttonGroupElement.insertAdjacentHTML("beforeend",h);const f=this.buttonGroupElement.lastChild;f.dataset.choice=d,f.addEventListener("click",()=>{this.recordResponse(d),s&&s()})}this.start_time=performance.now(),t.enable_button_after>0&&(this.disableButtons(),this.enableTimeout=this.jsPsych.pluginAPI.setTimeout(()=>{this.enableButtons()},t.enable_button_after))}recordResponse(e){if(this.response!==null)return;const t=performance.now();this.rt=Math.round(t-this.start_time),this.response=e,this.disableButtons()}disableButtons(){if(!this.buttonGroupElement)return;this.buttonGroupElement.querySelectorAll("button").forEach(t=>{t.setAttribute("disabled","disabled")})}enableButtons(){if(!this.buttonGroupElement)return;this.buttonGroupElement.querySelectorAll("button").forEach(t=>{t.removeAttribute("disabled")})}getResponse(){return this.response}getRT(){return this.rt}destroy(){this.enableTimeout&&this.jsPsych.pluginAPI.clearTimeout(this.enableTimeout),this.buttonGroupElement&&this.buttonGroupElement.remove()}};Ap.info=KT;let dd=Ap;var ZT="2.1.1";const YT={name:"SliderResponseComponent",version:ZT,parameters:{name:{type:$.STRING,default:void 0},min:{type:$.INT,default:0},max:{type:$.INT,default:100},slider_start:{type:$.INT,default:50},step:{type:$.INT,default:1},labels:{type:$.STRING,default:[],array:!0},slider_width:{type:$.INT,default:null},require_movement:{type:$.BOOL,default:!1},coordinates:{type:$.OBJECT,default:{x:0,y:0}}},data:{response:{type:$.INT},rt:{type:$.INT},slider_start:{type:$.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Dp=class Dp{constructor(e){this.jsPsych=e,this.response=null,this.rt=null,this.slider_start=50,this.start_time=null,this.sliderContainer=null,this.sliderElement=null,this.hasMoved=!1}render(e,t,s){const i=d=>d<-1?-50:d>1?50:d*50;this.slider_start=t.slider_start,this.sliderContainer=document.createElement("div"),this.sliderContainer.classList.add("jspsych-slider-response-container"),this.sliderContainer.style.position="absolute",this.sliderContainer.style.margin="0 auto 0 auto";const a=t.coordinates||{x:0,y:0},o=i(a.x),l=i(a.y);this.sliderContainer.style.left=`calc(50% + ${o}vw)`,this.sliderContainer.style.top=`calc(50% + ${l}vh)`,this.sliderContainer.style.transform="translate(-50%, -50%)",e.appendChild(this.sliderContainer),t.slider_width!==null&&t.slider_width!==void 0&&(this.sliderContainer.style.width=t.slider_width+"px");let u=`<input type="range" class="jspsych-slider" value="${t.slider_start}" min="${t.min}" max="${t.max}" step="${t.step}" id="jspsych-slider-response-component"></input>`;u+='<div style="margin-bottom: 2em">';for(let d=0;d<t.labels.length;d++){const h=100/(t.labels.length-1),f=d*(100/(t.labels.length-1)),b=(f-50)/50*100*7.5/100;u+=`<div style="border: 1px solid transparent; display: inline-block; position: absolute; left:calc(${f}% - (${h}% / 2) - ${b}px); text-align: center; width: ${h}%;">`,u+=`<span style="text-align: center; font-size: 80%;">${t.labels[d]}</span>`,u+="</div>"}if(u+="</div>",this.sliderContainer.innerHTML=u,this.sliderElement=this.sliderContainer.querySelector("#jspsych-slider-response-component"),t.require_movement){const d=()=>{this.hasMoved=!0};this.sliderElement.addEventListener("mousedown",d),this.sliderElement.addEventListener("touchstart",d),this.sliderElement.addEventListener("change",d),this.sliderElement.addEventListener("input",d)}else this.hasMoved=!0;this.start_time=performance.now()}recordResponse(e){if(this.response!==null||e.require_movement&&!this.hasMoved)return!1;const t=performance.now();return this.rt=Math.round(t-this.start_time),this.response=this.sliderElement.valueAsNumber,!0}getResponse(){return this.response}getCurrentValue(){return this.sliderElement?this.sliderElement.valueAsNumber:this.slider_start}isValid(e){return!(e.require_movement&&!this.hasMoved)}getRT(){return this.rt}getSliderStart(){return this.slider_start}destroy(){this.sliderContainer&&this.sliderContainer.remove()}};Dp.info=YT;let cd=Dp;var XT="2.1.0";const eE={name:"KeyboardResponseComponent",version:XT,parameters:{name:{type:$.STRING,default:void 0},choices:{type:$.KEYS,default:"ALL_KEYS"}},data:{response:{type:$.STRING},rt:{type:$.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Op=class Op{constructor(e){this.jsPsych=e,this.response=null,this.rt=null,this.keyboardListener=null}render(e,t,s){t.choices!=="NO_KEYS"&&(this.keyboardListener=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:i=>{this.recordResponse(i),s&&s()},valid_responses:t.choices,rt_method:"performance",persist:!1,allow_held_key:!1}))}recordResponse(e){this.response===null&&(this.response=e.key,this.rt=e.rt)}getResponse(){return this.response}getRT(){return this.rt}destroy(){this.keyboardListener!==null&&this.jsPsych.pluginAPI.cancelKeyboardResponse(this.keyboardListener)}};Op.info=eE;let pd=Op;var tE="2.2.0";const sE={name:"InputResponseComponent",version:tE,parameters:{name:{type:$.STRING,default:void 0},text:{type:$.HTML_STRING,default:void 0},check_answers:{type:$.BOOL,default:!1},allow_blanks:{type:$.BOOL,default:!0},case_sensitivity:{type:$.BOOL,default:!0},autofocus:{type:$.BOOL,default:!0},coordinates:{type:$.OBJECT,default:{x:0,y:0}}},data:{response:{type:$.STRING,array:!0},rt:{type:$.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Mp=class Mp{constructor(e){this.jsPsych=e,this.response=null,this.rt=null,this.start_time=null,this.clozeContainer=null,this.solutions=[],this.inputCount=0,this.inputElements=[]}render(e,t,s){const i=h=>h<-1?-50:h>1?50:h*50;this.solutions=this.getSolutions(t.text,t.case_sensitivity),this.clozeContainer=document.createElement("div"),this.clozeContainer.classList.add("cloze"),this.clozeContainer.style.position="absolute",this.clozeContainer.style.width="max-content";const r=t.coordinates||{x:0,y:0},a=i(r.x),o=i(r.y);this.clozeContainer.style.left=`calc(50% + ${a}vw)`,this.clozeContainer.style.top=`calc(50% + ${o}vh)`,this.clozeContainer.style.transform="translate(-50%, -50%)";let l="";const u=t.text.split("%");let d=0;for(let h=0;h<u.length;h++)h%2===0?l+=u[h]:(l+=`<input type="text" class="jspsych-input-response" id="input${d}" value="">`,d++);this.inputCount=d,this.clozeContainer.innerHTML=l,e.appendChild(this.clozeContainer),this.inputElements=[];for(let h=0;h<this.inputCount;h++){const f=document.getElementById(`input${h}`);f&&this.inputElements.push(f)}t.autofocus&&this.inputElements.length>0&&this.inputElements[0].focus(),this.start_time=performance.now()}collectCurrentResponse(e){const t=[];let s=!0,i=!0;for(let r=0;r<this.solutions.length;r++){const a=this.inputElements[r];if(a){const o=e.case_sensitivity?a.value.trim():a.value.toLowerCase().trim();t.push(o),e.check_answers&&(this.solutions[r].includes(o)?a.style.color="black":(a.style.color="red",s=!1)),e.allow_blanks||o===""&&(i=!1)}}return e.check_answers&&!s||!e.allow_blanks&&!i?null:t}recordResponse(e){if(this.response!==null)return!1;const t=this.collectCurrentResponse(e);if(t===null)return!1;const s=performance.now();return this.rt=Math.round(s-this.start_time),this.response=t,!0}getSolutions(e,t){const s=[],i=e.split("%");for(let r=1;r<i.length;r+=2)s.push(t?i[r].trim().split("/"):i[r].toLowerCase().trim().split("/"));return s}getResponse(){return this.response}getRT(){return this.rt}isValid(e){return this.collectCurrentResponse(e)!==null}destroy(){this.clozeContainer&&this.clozeContainer.remove(),this.inputElements=[]}};Mp.info=sE;let gd=Mp;class he{static isAvailable(){return typeof window<"u"}static isFileReaderAvailable(){return he.isAvailable()?!!window.FileReader:!1}static getLocation(){if(he.isAvailable())return window.location}static getVisualViewport(){return he.isAvailable()?window.visualViewport:null}static getInnerWidth(){if(he.isAvailable())return window.innerWidth}static getInnerHeight(){return he.isAvailable()?window.innerHeight:null}static getDevicePixelRatio(){return he.isAvailable()?window.devicePixelRatio:null}static getWindow(){if(he.isAvailable())return window}static hasOwn(e){if(he.isAvailable())return e in window}static getSelection(){if(he.isAvailable()&&window.getSelection)return window.getSelection()}static requestAnimationFrame(e){if(he.isAvailable())return window.requestAnimationFrame(e)}static addEventListener(e,t){he.isAvailable()&&window.addEventListener(e,t)}static removeEventListener(e,t){he.isAvailable()&&window.removeEventListener(e,t)}static matchMedia(e){return!he.isAvailable()||typeof window.matchMedia>"u"?null:window.matchMedia(e)}}class oe{static isAvailable(){return typeof document<"u"}static getBody(){if(oe.isAvailable())return document.body}static getDocumentElement(){if(oe.isAvailable())return document.documentElement}static getDocument(){if(oe.isAvailable())return document}static getCookie(){if(oe.isAvailable())return document.cookie}static setCookie(e){oe.isAvailable()&&(document.cookie=e)}static activeElementBlur(){if(!oe.isAvailable())return;const e=document.activeElement;e&&e.blur&&e.blur()}static createElement(e){if(oe.isAvailable())return document.createElement(e)}static getComputedStyle(e){return oe.isAvailable()?document.defaultView.getComputedStyle(e):new CSSStyleDeclaration}static addEventListener(e,t){oe.isAvailable()&&document.addEventListener(e,t)}static removeEventListener(e,t){oe.isAvailable()&&document.removeEventListener(e,t)}}function Ot(n,e){if(!e)return new Date;!D.storeUtcDates&&typeof e=="string"&&iE(e)&&(e+="T00:00:00");const t=new Date(e);return D.onDateCreated(t,n,e)}function iE(n){return n.indexOf("T")>0||!/\d{4}-\d{2}-\d{2}/.test(n)?!1:!isNaN(new Date(n).getTime())}class L{static isValueEmpty(e){if(Array.isArray(e)&&e.length===0)return!0;if(e&&L.isValueObject(e)&&e.constructor===Object){for(var t in e)if(!L.isValueEmpty(e[t]))return!1;return!0}return!e&&e!==0&&e!==!1}static isValueUndefined(e){return e==null||typeof e=="number"&&isNaN(e)}static isArrayContainsEqual(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var s=0;s<e.length;s++){for(var i=0;i<t.length&&!L.isTwoValueEquals(e[s],t[i]);i++);if(i===t.length)return!1}return!0}static checkIfArraysEqual(e,t,s){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;if(s.ignoreOrder!==void 0?s.ignoreOrder:!1){for(var r=[],a=[],o=0;o<e.length;o++)r.push(e[o]),a.push(t[o]);r.sort(),a.sort(),e=r,t=a}for(var o=0;o<e.length;o++)if(!L.checkIfValuesEqual(e[o],t[o],s))return!1;return!0}static isArraysEqual(e,t,s=!1,i,r){return L.checkIfArraysEqual(e,t,{ignoreOrder:s,caseSensitive:i,trimStrings:r})}static compareStrings(e,t){const s=D.comparator.normalizeTextCallback;if(e&&(e=s(e,"compare").trim()),t&&(t=s(t,"compare").trim()),!e&&!t)return 0;if(!e)return-1;if(!t)return 1;if(e===t)return 0;let i=-1;for(let r=0;r<e.length&&r<t.length;r++){if(this.isCharDigit(e[r])&&this.isCharDigit(t[r])){i=r;break}if(e[r]!==t[r])break}if(i>-1){let r=this.getNumberFromStr(e,i),a=this.getNumberFromStr(t,i);if(!Number.isNaN(r)&&!Number.isNaN(a)&&r!==a)return r>a?1:-1}return e>t?1:-1}static checkIfValuesEqual(e,t,s){if(e===t||Array.isArray(e)&&e.length===0&&typeof t>"u"||Array.isArray(t)&&t.length===0&&typeof e>"u"||e==null&&t===""||t==null&&e==="")return!0;const i=s.caseSensitive!==void 0?s.caseSensitive:D.comparator.caseSensitive,r=s.trimStrings!==void 0?s.trimStrings:D.comparator.trimStrings;if(typeof e=="string"&&typeof t=="string"){const d=D.comparator.normalizeTextCallback;return e=d(e,"compare"),t=d(t,"compare"),r&&(e=e.trim(),t=t.trim()),i||(e=e.toLowerCase(),t=t.toLowerCase()),e===t}if(e instanceof Date&&t instanceof Date)return e.getTime()==t.getTime();const a=!s.doNotConvertNumbers;if(a&&L.isConvertibleToNumber(e)&&L.isConvertibleToNumber(t)&&parseInt(e)===parseInt(t)&&parseFloat(e)===parseFloat(t))return!0;if(!L.isValueEmpty(e)&&L.isValueEmpty(t)||L.isValueEmpty(e)&&!L.isValueEmpty(t))return!1;if((e===!0||e===!1)&&typeof t=="string")return e.toString()===t.toLocaleLowerCase();if((t===!0||t===!1)&&typeof e=="string")return t.toString()===e.toLocaleLowerCase();const o=L.isValueObject(e),l=L.isValueObject(t);if(!o&&!l&&(a||typeof e!="number"&&typeof t!="number"))return e==t;if(!o||!l)return!1;if(e.equals&&t.equals)return e.equals(t);if(Array.isArray(e)&&Array.isArray(t))return L.checkIfArraysEqual(e,t,s);for(var u in e)if(e.hasOwnProperty(u)&&(!t.hasOwnProperty(u)||!this.checkIfValuesEqual(e[u],t[u],s)))return!1;for(u in t)if(t.hasOwnProperty(u)&&!e.hasOwnProperty(u))return!1;return!0}static isTwoValueEquals(e,t,s=!1,i,r){return this.checkIfValuesEqual(e,t,{ignoreOrder:s,caseSensitive:i,trimStrings:r})}static randomizeArray(e){for(var t=e.length-1;t>0;t--){var s=Math.floor(Math.random()*(t+1)),i=e[t];e[t]=e[s],e[s]=i}return e}static getUnbindValue(e){if(Array.isArray(e)){const t=[];for(let s=0;s<e.length;s++)t.push(L.getUnbindValue(e[s]));return t}return e&&L.isValueObject(e)&&!(e instanceof Date)?JSON.parse(JSON.stringify(e)):e}static createCopy(e){return this.createCopyWithPrefix(e,void 0)}static createCopyWithPrefix(e,t){var s={};if(!e)return s;for(var i in e){const r=t?t+i:i;s[r]=e[i]}return s}static isConvertibleToNumber(e){return e!=null&&!Array.isArray(e)&&!isNaN(e)}static isValueObject(e,t){return e instanceof Object&&(!t||!Array.isArray(e))}static isNumber(e){return!isNaN(this.getNumber(e))}static getNumber(e){const t=L.getNumberCore(e);return D.parseNumber(e,t)}static getNumberCore(e){if(typeof e=="string"){if(e=e.trim(),!e)return NaN;if(e.indexOf("0x")==0)return e.length>32?NaN:parseInt(e);if(e.length>15&&L.isDigitsOnly(e))return NaN;if(L.isStringHasOperator(e))return NaN}e=this.prepareStringToNumber(e);const t=parseFloat(e);return isNaN(t)||!isFinite(e)?NaN:t}static isStringHasOperator(e){if(e.lastIndexOf("-")>0||e.lastIndexOf("+")>0)return!1;const t="*^/%";for(let s=0;s<t.length;s++)if(e.indexOf(t[s])>-1)return!0;return!1}static prepareStringToNumber(e){if(typeof e!="string"||!e)return e;let t=e.indexOf(",");return t>-1&&e.indexOf(",",t+1)<0?e.replace(",","."):e}static getMaxLength(e,t){return e<0&&(e=t),e>0?e:null}static getRemainingCharacterCounterText(e,t){return!t||t<=0||!D.showMaxLengthIndicator?"":[e?e.length:"0",t].join("/")}static getNumberByIndex(e,t,s){if(e<0)return"";var i=1,r="",a=t&&t[t.length-1]!=="."?"":".",o=!0,l="A",u="";const d=x=>{if(!x)return!1;for(var V=0;V<x.length;V++)if(L.isCharDigit(x[V]))return!0;return!1};if(t){u=t;for(var h=u.length-1,f=d(u),C=function(){return f&&!L.isCharDigit(u[h])||L.isCharNotLetterAndDigit(u[h])};h>=0&&C();)h--;var b="";for(h<u.length-1&&(b=u.substring(h+1),u=u.substring(0,h+1)),h=u.length-1;h>=0&&!(C()||(h--,!f)););l=u.substring(h+1),r=u.substring(0,h+1),parseInt(l)?i=parseInt(l):l.length==1&&(o=!1),(b||r)&&(a=b)}if(s>-1&&d(r)&&(r=this.getNumberByIndex(s,r)),o){let x=(e+i).toString();for(;x.length<l.length;)x="0"+x;return r+x+a}return r+String.fromCharCode(l.charCodeAt(0)+e)+a}static isCharNotLetterAndDigit(e){return e.toUpperCase()==e.toLowerCase()&&!L.isCharDigit(e)}static isCharDigit(e){return e>="0"&&e<="9"}static isDigitsOnly(e){if(!e)return!1;for(let t=0;t<e.length;t++)if(!L.isCharDigit(e[t]))return!1;return!0}static getNumberFromStr(e,t){if(!this.isCharDigit(e[t]))return NaN;let s="";for(;t<e.length&&this.isCharDigit(e[t]);)s+=e[t],t++;return s?this.getNumber(s):NaN}static countDecimals(e){if(L.isNumber(e)&&Math.floor(e)!==e){const t=e.toString().split(".");return t.length>1&&t[1].length||0}return 0}static correctAfterPlusMinis(e,t,s){const i=L.countDecimals(e),r=L.countDecimals(t);if(i>0||r>0){const a=Math.max(i,r);s=parseFloat(s.toFixed(a))}return s}static sumAnyValues(e,t){if(!L.isNumber(e)||!L.isNumber(t)){if(Array.isArray(e)&&Array.isArray(t))return[].concat(e).concat(t);if(Array.isArray(e)||Array.isArray(t)){const i=Array.isArray(e)?e:t,r=i===e?t:e;if(typeof r=="string"){const a=i.join(", ");return i===e?a+r:r+a}if(typeof r=="number"){let a=0;for(var s=0;s<i.length;s++)typeof i[s]=="number"&&(a=L.correctAfterPlusMinis(a,i[s],a+i[s]));return L.correctAfterPlusMinis(a,r,a+r)}}return e+t}return typeof e=="string"||typeof t=="string"?e+t:L.correctAfterPlusMinis(e,t,e+t)}static correctAfterMultiple(e,t,s){const i=L.countDecimals(e)+L.countDecimals(t);return i>0&&(s=parseFloat(s.toFixed(i))),s}static findObjByPropValue(e,t,s){for(var i=0;i<e.length;i++)if(L.isTwoValueEquals(e[i][t],s))return e[i]}static convertArrayObjectToValue(e,t){const s=new Array;if(!e||!Array.isArray(e))return s;for(var i=0;i<e.length;i++){const r=e[i]?e[i][t]:void 0;L.isValueEmpty(r)||s.push(r)}return s}static convertDateToString(e){const t=s=>s<10?"0"+s.toString():s.toString();return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())}static convertDateTimeToString(e){const t=s=>s<10?"0"+s.toString():s.toString();return this.convertDateToString(e)+" "+t(e.getHours())+":"+t(e.getMinutes())}static convertValToQuestionVal(e,t){return e instanceof Date?t==="datetime-local"?L.convertDateTimeToString(e):L.convertDateToString(e):this.getUnbindValue(e)}static compareVerions(e,t){if(!e&&!t)return 0;const s=e.split("."),i=t.split("."),r=s.length,a=i.length;for(let o=0;o<r&&o<a;o++){const l=s[o],u=i[o];if(l.length===u.length){if(l!==u)return l<u?-1:1}else return l.length<u.length?-1:1}return r===a?0:r<a?-1:1}static isUrlYoutubeVideo(e){if(!e)return!1;const t=["www.youtube.com","m.youtube.com","youtube.com","youtu.be"];e=e.toLowerCase(),e=e.replace(/^https?:\/\//,"");for(let s=0;s<t.length;s++)if(e.indexOf(t[s]+"/")===0)return!0;return!1}}String.prototype.format||(String.prototype.format=function(){var n=arguments;return this.replace(/{(\d+)}/g,function(e,t){return typeof n[t]<"u"?n[t]:e})});var rE={pagePrevText:"Previous",pageNextText:"Next",completeText:"Complete",previewText:"Preview",editText:"Edit",startSurveyText:"Start",commentText:"Please leave a comment",otherItemText:"Other (describe)",noneItemText:"None",refuseItemText:"Refuse to answer",dontKnowItemText:"Don't know",selectAllItemText:"Select All",deselectAllItemText:"Deselect all",progressText:"Page {0} of {1}",indexText:"{0} of {1}",panelDynamicProgressText:"{0} of {1}",panelDynamicTabTextFormat:"Panel {panelIndex}",questionsProgressText:"Answered {0}/{1} questions",emptySurvey:"The survey doesn't contain any visible elements.",completingSurvey:"Thank you for completing the survey",completingSurveyBefore:"You have already completed this survey.",loadingSurvey:"Loading Survey...",placeholder:"Select...",ratingOptionsCaption:"Select...",buttongroupOptionsCaption:"Select...",value:"value",requiredError:"Response required.",requiredErrorInPanel:"Response required: answer at least one question.",requiredInAllRowsError:"Response required: answer questions in all rows.",eachRowUniqueError:"Each row must have a unique value.",numericError:"The value should be numeric.",minError:"The value should not be less than {0}",stepError:"Please enter a value that matches the step size of {0}.",maxError:"The value should not be greater than {0}",textNoDigitsAllow:"Numbers are not allowed.",textMinLength:"Please enter at least {0} character(s).",textMaxLength:"Please enter no more than {0} character(s).",textMinMaxLength:"Please enter at least {0} and no more than {1} characters.",minRowCountError:"Please fill in at least {0} row(s).",minSelectError:"Please select at least {0} option(s).",maxSelectError:"Please select no more than {0} option(s).",numericMinMax:"The '{0}' should be at least {1} and at most {2}",numericMin:"The '{0}' should be at least {1}",numericMax:"The '{0}' should be at most {1}",invalidEmail:"Please enter a valid e-mail address.",invalidExpression:"The expression: {0} should return 'true'.",urlRequestError:"The request returned error '{0}'. {1}",urlGetChoicesError:"The request returned empty data or the 'path' property is incorrect",exceedMaxSize:"The file size should not exceed {0}.",exceedMaxFiles:"The maximum number of files you can upload is {0}.",noUploadFilesHandler:"Files cannot be uploaded. Please add a handler for the 'onUploadFiles' event.",otherRequiredError:"Response required: enter another value.",uploadingFile:"Your file is uploading. Please wait several seconds and try again.",loadingFile:"Loading...",chooseFile:"Choose file(s)...",noFileChosen:"No file selected",filePlaceholder:"Drag and drop a file here or click the button below to select a file to upload.",confirmDelete:"Are you sure you want to delete this record?",keyDuplicationError:"This value should be unique.",addColumn:"Add Column",addRow:"Add Row",removeRow:"Remove",noRowsText:"There are no rows.",rowIndexTemplateTitle:"Row {rowIndex}",rowNameTemplateTitle:"{rowTitle}",addPanel:"Add new",removePanel:"Remove",showDetails:"Show Details",hideDetails:"Hide Details",choices_Item:"item",choices_Choice:"Choice option",matrix_column:"Column",matrix_row:"Row",multipletext_itemname:"text",savingData:"The results are being saved on the server...",savingDataError:"An error occurred and we could not save the results.",savingDataSuccess:"The results were saved successfully!",savingExceedSize:"Your response exceeds 64KB. Please reduce the size of your file(s) and try again or contact the survey owner.",saveAgainButton:"Try again",timerMin:"min",timerSec:"sec",timerSpentAll:"You have spent {0} on this page and {1} in total.",timerSpentPage:"You have spent {0} on this page.",timerSpentSurvey:"You have spent {0} in total.",timerLimitAll:"You have spent {0} of {1} on this page and {2} of {3} in total.",timerLimitPage:"You have spent {0} of {1} on this page.",timerLimitSurvey:"You have spent {0} of {1} in total.",clearCaption:"Clear",selectCaption:"Select",signaturePlaceHolder:"Sign here",signaturePlaceHolderReadOnly:"No signature",chooseFileCaption:"Select File",takePhotoCaption:"Take Photo",photoPlaceholder:"Click the button below to take a photo using the camera.",fileOrPhotoPlaceholder:"Drag and drop or select a file to upload or take a photo using the camera.",replaceFileCaption:"Replace file",removeFileCaption:"Remove this file",booleanCheckedLabel:"Yes",booleanUncheckedLabel:"No",confirmRemoveFile:"Are you sure that you want to remove this file: {0}?",confirmRemoveAllFiles:"Are you sure that you want to remove all files?",questionTitlePatternText:"Question Title",modalCancelButtonText:"Cancel",modalApplyButtonText:"Apply",filterStringPlaceholder:"Type to search...",emptyMessage:"No data to display",loadingPage:"Loading...",loadingData:"Loading...",noEntriesText:`No entries yet.
Click the button below to add a new entry.`,noEntriesReadonlyText:"No entries",tabTitlePlaceholder:"New Panel",more:"More",tagboxDoneButtonCaption:"OK",selectToRankEmptyRankedAreaText:"All choices are selected for ranking",selectToRankEmptyUnrankedAreaText:"Drag choices here to rank them",ok:"OK",cancel:"Cancel",createCustomItem:'Create "{0}" item...',toc:"Table of contents",progressbar:"Progress bar"},os={currentLocaleValue:"",defaultLocaleValue:"en",locales:{},localeNames:{},localeNamesInEnglish:{},localeDirections:{},supportedLocales:[],useEnglishNames:!1,get showNamesInEnglish(){return this.useEnglishNames},set showNamesInEnglish(n){this.useEnglishNames=n},setupLocale(n){const e=n.localeCode;this.locales[e]=n.strings,this.localeNames[e]=n.nativeName,this.localeNamesInEnglish[e]=n.englishName,n.rtl!==void 0&&(this.localeDirections[e]=n.rtl?"rtl":"ltr")},get currentLocale(){return this.currentLocaleValue===this.defaultLocaleValue?"":this.currentLocaleValue},set currentLocale(n){this.currentLocaleValue=this.getCorrectLocaleName(n)},get defaultLocale(){return this.defaultLocaleValue},set defaultLocale(n){this.defaultLocaleValue=this.getCorrectLocaleName(n)},getCorrectLocaleName(n){return n==="cz"&&(n="cs"),n==="gr"&&(n="el"),n==="rs"&&(n="sr"),n==="ua"&&(n="uk"),n},getLocaleStrings(n){return this.locales[n]},getString:function(n,e=null){const t=new Array,s=r=>{const a=this.locales[r];a&&t.push(a)},i=r=>{if(!r)return;s(r);const a=r.indexOf("-");a<1||(r=r.substring(0,a),s(r))};i(e),i(this.currentLocale),i(this.defaultLocale),this.defaultLocale!=="en"&&s("en");for(let r=0;r<t.length;r++){const a=t[r][n];if(a!==void 0)return a}return this.onGetExternalString(n,e)},getLocaleName(n,e){if(!n)return"";e===void 0&&(e=this.showNamesInEnglish);const t=e?this.localeNamesInEnglish:this.localeNames,s=e?this.localeNames:this.localeNamesInEnglish;return t[n]||s[n]||n},getLocales:function(n=!1){var e=[];e.push("");var t=this.locales;if(this.supportedLocales&&this.supportedLocales.length>0){t={};for(var s=0;s<this.supportedLocales.length;s++)t[this.supportedLocales[s]]=!0}for(var i in t)n&&i==this.defaultLocale||e.push(i);var r=a=>this.getLocaleName(a).toLowerCase();return e.sort((a,o)=>{var l=r(a),u=r(o);return l===u?0:l<u?-1:1}),e},onGetExternalString:function(n,e){}};function bt(n,e=null){return os.getString(n,e)}os.locales.en=rE,os.localeNames.en="english";function md(n,e,t){let s=n.getLocalizableString(t);if(!s){let i;typeof e.localizable=="object"&&e.localizable.defaultStr&&(i=e.localizable.defaultStr),s=n.createLocalizableString(t,n,!0,i),typeof e.localizable=="object"&&typeof e.localizable.onGetTextCallback=="function"&&(s.onGetTextCallback=e.localizable.onGetTextCallback)}}function nE(n,e,t){md(n,e,t);let s=n.getLocalizableStringText(t);if(s)return s;if(typeof e.localizable=="object"&&e.localizable.defaultStr){const i=n.getLocale?n.getLocale():"";return bt(e.localizable.defaultStr,i)}return""}function R(n={}){return function(e,t){let s=(i,r)=>{if(r&&typeof r=="object"&&r.type===Ue.ComputedUpdaterType){de.startCollectDependencies(()=>i[t]=r.updater(),i,t);const a=r.updater(),o=de.finishCollectDependencies();return r.setDependencies(o),i.dependencies[t]&&i.dependencies[t].dispose(),i.dependencies[t]=r,a}return r};!n||!n.localizable?Object.defineProperty(e,t,{get:function(){let i=null;return n&&(typeof n.getDefaultValue=="function"&&(i=n.getDefaultValue(this)),n.defaultValue!==void 0&&(i=n.defaultValue)),this.getPropertyValue(t,i)},set:function(i){const r=s(this,i),a=this.getPropertyValue(t);r!==a&&(this.setPropertyValue(t,r),n&&n.onSet&&n.onSet(r,this,a))}}):(Object.defineProperty(e,t,{get:function(){return nE(this,n,t)},set:function(i){md(this,n,t);const r=s(this,i);this.setLocalizableStringText(t,r),n&&n.onSet&&n.onSet(r,this)}}),Object.defineProperty(e,typeof n.localizable=="object"&&n.localizable.name?n.localizable.name:"loc"+t.charAt(0).toUpperCase()+t.slice(1),{get:function(){return md(this,n,t),this.getLocalizableString(t)}}))}}function GC(n,e,t){n.ensureArray(t,(s,i)=>{const r=e?e.onPush:null;r&&r(s,i,n)},(s,i)=>{const r=e?e.onRemove:null;r&&r(s,i,n)})}function Ft(n){return function(e,t){Object.defineProperty(e,t,{get:function(){return GC(this,n,t),this.getPropertyValue(t)},set:function(s){GC(this,n,t);const i=this.getPropertyValue(t);s!==i&&(i?i.splice(0,i.length,...s||[]):this.setPropertyValue(t,s),n&&n.onSet&&n.onSet(s,this))}})}}class Ds{constructor(e,t,s=!1){this.name=t,this.isRequiredValue=!1,this.isUniqueValue=!1,this.isSerializable=!0,this.isLightSerializable=!0,this.isCustom=!1,this.isDynamicChoices=!1,this.isBindable=!1,this.category="",this.categoryIndex=-1,this.visibleIndex=-1,this.maxLength=-1,this.isArray=!1,this.classInfoValue=e,this.isRequiredValue=s,this.idValue=Ds.Index++}get id(){return this.idValue}get classInfo(){return this.classInfoValue}get type(){return this.typeValue?this.typeValue:"string"}set type(e){e==="itemvalues"&&(e="itemvalue[]"),e==="textitems"&&(e="textitem[]"),this.typeValue=e,this.typeValue.indexOf("[]")===this.typeValue.length-2&&(this.isArray=!0,this.className=this.typeValue.substring(0,this.typeValue.length-2))}get locationInTable(){return this.locationInTableValue||"column"}set locationInTable(e){this.locationInTableValue=e}get showMode(){const e=this.locationInTableValue;return e==="detail"?"form":e==="column"?"list":""}set showMode(e){this.locationInTable=e==="form"?"detail":e==="list"?"column":void 0}get isRequired(){return this.isRequiredValue}set isRequired(e){e!==this.isRequired&&(this.isRequiredValue=e,this.classInfo&&this.classInfo.resetAllProperties())}get isUnique(){return this.isUniqueValue}set isUnique(e){this.isUniqueValue=e}get uniquePropertyName(){return this.uniquePropertyValue}set uniquePropertyName(e){this.uniquePropertyValue=e}isPropertySerializable(e){return this.isSerializableFunc?this.isSerializableFunc(e):this.isSerializable}getDefaultValue(e){let t=this.defaultValueFunc?this.defaultValueFunc(e):this.defaultValueValue;return Ds.getItemValuesDefaultValue&&B.isDescendantOf(this.className,"itemvalue")&&(t=Ds.getItemValuesDefaultValue(this.defaultValueValue||[],this.className)),t}get defaultValue(){return this.getDefaultValue(void 0)}set defaultValue(e){this.defaultValueValue=e,e!==void 0&&(this.defaultValueFunc=void 0)}isDefaultValue(e){return this.isDefaultValueByObj(void 0,e)}isDefaultValueByObj(e,t){if(this.isLocalizable)return t==null;const s=this.getDefaultValue(e);return s!==void 0?typeof s!="object"?s===t:L.isTwoValueEquals(t,s,!1,!0,!1):t===!1&&this.isBooleanType&&!this.defaultValueFunc||t===""||L.isValueEmpty(t)}getSerializableValue(e,t){if(this.onSerializeValue)return this.onSerializeValue(e);const s=this.getValue(e);if(s!=null&&!(!t&&this.isDefaultValueByObj(e,s)))return s}getValue(e){return this.onGetValue?(e=this.getOriginalObj(e),this.onGetValue(e)):this.serializationProperty&&e[this.serializationProperty]?e[this.serializationProperty].getJson():e[this.name]}getPropertyValue(e){return this.isLocalizable?e[this.serializationProperty]?e[this.serializationProperty].text:null:this.getValue(e)}get hasToUseSetValue(){return this.onSetValue||this.serializationProperty}settingValue(e,t){return!this.onSettingValue||e.isLoadingFromJson?t:this.onSettingValue(e,t)}setValue(e,t,s){if(this.onSetValue)e=this.getOriginalObj(e),this.onSetValue(e,t,s);else if(this.serializationProperty&&e[this.serializationProperty])e[this.serializationProperty].setJson(t,!0);else{if(t&&typeof t=="string"&&(this.type=="number"&&(t=parseInt(t)),this.isBooleanType)){const i=t.toLowerCase();(i==="false"||i==="true")&&(t=i==="true")}e[this.name]=t}}get isBooleanType(){return this.type==="boolean"||this.type==="switch"}validateValue(e){const t=this.choices;return!Array.isArray(t)||t.length===0?!0:t.indexOf(e)>-1}getObjType(e){return this.classNamePart?e.replace(this.classNamePart,""):e}get choices(){return this.getChoices(null)}get hasChoices(){return!!this.choicesValue||!!this.choicesfunc}getChoices(e,t=null){return this.choicesValue!=null?this.choicesValue:this.choicesfunc!=null?this.choicesfunc(e,t):null}setChoices(e,t=null){this.choicesValue=e,this.choicesfunc=t}getBaseValue(){return this.baseValue?typeof this.baseValue=="function"?this.baseValue():this.baseValue:""}setBaseValue(e){this.baseValue=e}get readOnly(){return this.readOnlyValue!=null?this.readOnlyValue:!1}set readOnly(e){this.readOnlyValue=e}isEnable(e){return this.readOnly?!1:!e||!this.enableIf?!0:this.enableIf(this.getOriginalObj(e))}isVisible(e,t=null){let s=!this.layout||!e||this.layout===e;return!this.visible||!s?!1:this.visibleIf&&t?this.visibleIf(this.getOriginalObj(t)):!0}getOriginalObj(e){if(e&&e.getOriginalObj){const t=e.getOriginalObj();if(t&&B.findProperty(t.getType(),this.name))return t}return e}get visible(){return this.visibleValue!=null?this.visibleValue:!0}set visible(e){this.visibleValue=e}isAvailableInVersion(e){return this.alternativeName||this.oldName?!0:this.isAvailableInVersionCore(e)}getSerializedName(e){return this.alternativeName?this.isAvailableInVersionCore(e)?this.name:this.alternativeName||this.oldName:this.name}getSerializedProperty(e,t){return!this.oldName||this.isAvailableInVersionCore(t)?this:!e||!e.getType?null:B.findProperty(e.getType(),this.oldName)}isAvailableInVersionCore(e){return!e||!this.version?!0:L.compareVerions(this.version,e)<=0}get isLocalizable(){return this.isLocalizableValue!=null?this.isLocalizableValue:!1}set isLocalizable(e){this.isLocalizableValue=e}get dataList(){return Array.isArray(this.dataListValue)?this.dataListValue:[]}set dataList(e){this.dataListValue=e}mergeWith(e){for(var t=Ds.mergableValues,s=0;s<t.length;s++)this.mergeValue(e,t[s]);this.isArray=e.isArray}addDependedProperty(e){this.dependedProperties||(this.dependedProperties=[]),this.dependedProperties.indexOf(e)<0&&this.dependedProperties.push(e)}getDependedProperties(){return this.dependedProperties?this.dependedProperties:[]}schemaType(){if(this.className!=="choicesByUrl")return this.className==="string"?this.className:this.className||this.baseClassName?"array":this.type=="switch"?"boolean":this.type=="boolean"||this.type=="number"?this.type:"string"}schemaRef(){if(this.className)return this.className}mergeValue(e,t){this[t]==null&&e[t]!=null&&(this[t]=e[t])}}Ds.Index=1,Ds.mergableValues=["typeValue","choicesValue","baseValue","readOnlyValue","visibleValue","isSerializable","isLightSerializable","isCustom","isBindable","isUnique","uniquePropertyName","isDynamicChoices","isLocalizableValue","className","alternativeName","oldName","layout","version","classNamePart","baseClassName","defaultValue","defaultValueFunc","serializationProperty","onGetValue","onSetValue","onSettingValue","displayName","category","categoryIndex","visibleIndex","nextToProperty","overridingProperty","locationInTable","dependedProperties","visibleIf","enableIf","onExecuteExpression","onPropertyEditorUpdate","maxLength","maxValue","minValue","dataListValue"];class it{static addProperty(e,t){e=e.toLowerCase();var s=it.properties;s[e]||(s[e]=[]),s[e].push(t)}static removeProperty(e,t){e=e.toLowerCase();var s=it.properties;if(s[e]){for(var i=s[e],r=0;r<i.length;r++)if(i[r].name==t){s[e].splice(r,1);break}}}static removeAllProperties(e){e=e.toLowerCase(),delete it.properties[e]}static addClass(e,t){e=e.toLowerCase(),t&&(t=t.toLowerCase()),it.parentClasses[e]=t}static getProperties(e){e=e.toLowerCase();for(var t=[],s=it.properties;e;){var i=s[e];if(i)for(var r=0;r<i.length;r++)t.push(i[r]);e=it.parentClasses[e]}return t}static createProperties(e){!e||!e.getType||it.createPropertiesCore(e,e.getType())}static createPropertiesCore(e,t){var s=it.properties;s[t]&&it.createPropertiesInObj(e,s[t]);var i=it.parentClasses[t];i&&it.createPropertiesCore(e,i)}static createPropertiesInObj(e,t){for(var s=0;s<t.length;s++)it.createPropertyInObj(e,t[s])}static createPropertyInObj(e,t){if(!it.checkIsPropertyExists(e,t.name)&&!(t.serializationProperty&&it.checkIsPropertyExists(e,t.serializationProperty))){if(t.isLocalizable&&t.serializationProperty&&e.createCustomLocalizableObj){const a=e.createCustomLocalizableObj(t.name);a.defaultValue=t.getDefaultValue(e);var s={get:function(){return e.getLocalizableString(t.name)}};Object.defineProperty(e,t.serializationProperty,s);var i={get:function(){return e.getLocalizableStringText(t.name)},set:function(o){e.setLocalizableStringText(t.name,o)}};Object.defineProperty(e,t.name,i)}else{var r=t.isArray||t.type==="multiplevalues";if(typeof e.createNewArray=="function"&&(B.isDescendantOf(t.className,"itemvalue")?(e.createNewArray(t.name,function(a){a.locOwner=e,a.ownerPropertyName=t.name}),r=!0):r&&e.createNewArray(t.name),r)){const a=t.getDefaultValue(e);Array.isArray(a)&&e.setPropertyValue(t.name,a)}if(e.getPropertyValue&&e.setPropertyValue){var i={get:()=>t.onGetValue?t.onGetValue(e):e.getPropertyValue(t.name,void 0),set:function(o){t.onSetValue?t.onSetValue(e,o,null):e.setPropertyValue(t.name,o)}};Object.defineProperty(e,t.name,i)}}(t.type==="condition"||t.type==="expression")&&t.onExecuteExpression&&e.addExpressionProperty(t.name,t.onExecuteExpression)}}static checkIsPropertyExists(e,t){return e.hasOwnProperty(t)||e[t]}}it.properties={},it.parentClasses={};class Lr{constructor(e,t,s=null,i=null){this.name=e,this.creator=s,this.parentName=i,e=e.toLowerCase(),this.isCustomValue=!s&&e!=="survey",this.parentName&&(this.parentName=this.parentName.toLowerCase(),it.addClass(e,this.parentName),s&&this.makeParentRegularClass()),this.properties=new Array;for(var r=0;r<t.length;r++)this.createProperty(t[r],this.isCustom)}find(e){for(var t=0;t<this.properties.length;t++)if(this.properties[t].name==e)return this.properties[t];return null}findProperty(e){return this.fillAllProperties(),this.hashProperties[e]}getAllProperties(){return this.fillAllProperties(),this.allProperties}getRequiredProperties(){if(this.requiredProperties)return this.requiredProperties;this.requiredProperties=[];const e=this.getAllProperties();for(let t=0;t<e.length;t++)e[t].isRequired&&this.requiredProperties.push(e[t]);return this.requiredProperties}resetAllProperties(){this.allProperties=void 0,this.requiredProperties=void 0,this.hashProperties=void 0;for(var e=B.getChildrenClasses(this.name),t=0;t<e.length;t++)e[t].resetAllProperties()}get isCustom(){return this.isCustomValue}fillAllProperties(){if(this.allProperties)return;this.allProperties=[],this.hashProperties={};const e={};this.properties.forEach(s=>e[s.name]=s);const t=this.parentName?B.findClass(this.parentName):null;t&&t.getAllProperties().forEach(i=>{const r=e[i.name];r?(r.mergeWith(i),this.addPropCore(r)):this.addPropCore(i)}),this.properties.forEach(s=>{this.hashProperties[s.name]||this.addPropCore(s)})}addPropCore(e){this.allProperties.push(e),this.hashProperties[e.name]=e,e.alternativeName&&(this.hashProperties[e.alternativeName]=e)}isOverridedProp(e){return!!this.parentName&&!!B.findProperty(this.parentName,e)}hasRegularChildClass(){if(this.isCustom){this.isCustomValue=!1;for(var e=0;e<this.properties.length;e++)this.properties[e].isCustom=!1;it.removeAllProperties(this.name),this.makeParentRegularClass()}}makeParentRegularClass(){if(!this.parentName)return;const e=B.findClass(this.parentName);e&&e.hasRegularChildClass()}createProperty(e,t=!1){var s=typeof e=="string"?e:e.name;if(s){var i=null,r=s.indexOf(Lr.typeSymbol);r>-1&&(i=s.substring(r+1),s=s.substring(0,r));var a=this.getIsPropertyNameRequired(s)||!!e.isRequired;s=this.getPropertyName(s);var o=new Ds(this,s,a);if(i&&(o.type=i),typeof e=="object"){if(e.type&&(o.type=e.type),e.default!==void 0&&(o.defaultValue=e.default),e.defaultFunc!==void 0&&(o.defaultValueFunc=e.defaultFunc),L.isValueEmpty(e.isSerializable)||(o.isSerializable=e.isSerializable),L.isValueEmpty(e.isSerializableFunc)||(o.isSerializableFunc=e.isSerializableFunc),L.isValueEmpty(e.isLightSerializable)||(o.isLightSerializable=e.isLightSerializable),L.isValueEmpty(e.maxLength)||(o.maxLength=e.maxLength),e.displayName!==void 0&&(o.displayName=e.displayName),L.isValueEmpty(e.category)||(o.category=e.category),L.isValueEmpty(e.categoryIndex)||(o.categoryIndex=e.categoryIndex),L.isValueEmpty(e.nextToProperty)||(o.nextToProperty=e.nextToProperty),L.isValueEmpty(e.overridingProperty)||(o.overridingProperty=e.overridingProperty),L.isValueEmpty(e.visibleIndex)||(o.visibleIndex=e.visibleIndex),L.isValueEmpty(e.showMode)||(o.showMode=e.showMode),L.isValueEmpty(e.locationInTable)||(o.locationInTable=e.locationInTable),L.isValueEmpty(e.maxValue)||(o.maxValue=e.maxValue),L.isValueEmpty(e.minValue)||(o.minValue=e.minValue),L.isValueEmpty(e.dataList)||(o.dataList=e.dataList),L.isValueEmpty(e.isDynamicChoices)||(o.isDynamicChoices=e.isDynamicChoices),L.isValueEmpty(e.isBindable)||(o.isBindable=e.isBindable),L.isValueEmpty(e.isUnique)||(o.isUnique=e.isUnique),L.isValueEmpty(e.uniqueProperty)||(o.uniquePropertyName=e.uniqueProperty),L.isValueEmpty(e.isArray)||(o.isArray=e.isArray),(e.visible===!0||e.visible===!1)&&(o.visible=e.visible),e.visibleIf&&(o.visibleIf=e.visibleIf),e.enableIf&&(o.enableIf=e.enableIf),e.onExecuteExpression&&(o.onExecuteExpression=e.onExecuteExpression),e.onPropertyEditorUpdate&&(o.onPropertyEditorUpdate=e.onPropertyEditorUpdate),e.readOnly===!0&&(o.readOnly=!0),e.availableInMatrixColumn===!0&&(o.availableInMatrixColumn=!0),e.choices){var l=typeof e.choices=="function"?e.choices:null,u=typeof e.choices!="function"?e.choices:null;o.setChoices(u,l)}e.baseValue&&o.setBaseValue(e.baseValue),e.onSerializeValue&&(o.onSerializeValue=e.onSerializeValue),e.onGetValue&&(o.onGetValue=e.onGetValue),e.onSetValue&&(o.onSetValue=e.onSetValue),e.onSettingValue&&(o.onSettingValue=e.onSettingValue),e.isLocalizable&&(e.serializationProperty="loc"+o.name),e.serializationProperty&&(o.serializationProperty=e.serializationProperty,o.serializationProperty&&o.serializationProperty.indexOf("loc")==0&&(o.isLocalizable=!0)),e.isLocalizable&&(o.isLocalizable=e.isLocalizable),e.className&&(o.className=e.className),e.baseClassName&&(o.baseClassName=e.baseClassName,o.isArray=!0),o.isArray===!0&&(o.isArray=!0),e.classNamePart&&(o.classNamePart=e.classNamePart),e.alternativeName&&(o.alternativeName=e.alternativeName),e.oldName&&(o.oldName=e.oldName),e.layout&&(o.layout=e.layout),e.version&&(o.version=e.version),e.dependsOn&&this.addDependsOnProperties(o,e.dependsOn)}return this.properties.push(o),t&&!this.isOverridedProp(o.name)&&(o.isCustom=!0,it.addProperty(this.name,o)),o}}addDependsOnProperties(e,t){const s=Array.isArray(t)?t:[t];e.dependsOn=s;for(var i=0;i<s.length;i++)this.addDependsOnProperty(e,s[i])}addDependsOnProperty(e,t){var s=this.find(t);s||(s=B.findProperty(this.parentName,t)),s&&s.addDependedProperty(e.name)}getIsPropertyNameRequired(e){return e.length>0&&e[0]==Lr.requiredSymbol}getPropertyName(e){return this.getIsPropertyNameRequired(e)&&(e=e.slice(1)),e}}Lr.requiredSymbol="!",Lr.typeSymbol=":";class aE{constructor(){this.classes={},this.alternativeNames={},this.childrenClasses={},this.dynamicPropsCache={}}getObjPropertyValue(e,t){if(this.isObjWrapper(e)&&this.isNeedUseObjWrapper(e,t)){const i=e.getOriginalObj(),r=B.findProperty(i.getType(),t);if(r)return this.getObjPropertyValueCore(i,r)}const s=B.findProperty(e.getType(),t);return s?this.getObjPropertyValueCore(e,s):e[t]}setObjPropertyValue(e,t,s){if(e[t]!==s)if(e[t]&&e[t].setJson)e[t].setJson(s,!0);else{if(Array.isArray(s)){const r=[];for(var i=0;i<s.length;i++)r.push(s[i]);s=r}e[t]=s}}getObjPropertyValueCore(e,t){if(!t.isPropertySerializable(e))return e[t.name];if(t.isLocalizable){if(t.isArray)return e[t.name];const s=e.getLocalizableString(t.name);if(s)return s.isDefautlLocale?s.text:s.getValue(s.locale);if(t.serializationProperty)return e[t.serializationProperty].text}return e.getPropertyValue(t.name)}isObjWrapper(e){return!!e.getOriginalObj&&!!e.getOriginalObj()}isNeedUseObjWrapper(e,t){if(!e.getDynamicProperties)return!0;const s=e.getDynamicProperties();if(!Array.isArray(s))return!1;for(let i=0;i<s.length;i++)if(s[i].name===t)return!0;return!1}addClass(e,t,s=null,i=null){e=e.toLowerCase();var r=new Lr(e,t,s,i);if(this.classes[e]=r,i){i=i.toLowerCase();var a=this.childrenClasses[i];a||(this.childrenClasses[i]=[]),this.childrenClasses[i].push(r)}return r}removeClass(e){var t=this.findClass(e);if(t&&(delete this.classes[t.name],t.parentName)){var s=this.childrenClasses[t.parentName].indexOf(t);s>-1&&this.childrenClasses[t.parentName].splice(s,1)}}overrideClassCreatore(e,t){this.overrideClassCreator(e,t)}overrideClassCreator(e,t){e=e.toLowerCase();var s=this.findClass(e);s&&(s.creator=t)}getProperties(e){var t=this.findClass(e);return t?t.getAllProperties():[]}getPropertiesByObj(e){const t=e&&e.getType?e.getType():void 0;if(!t)return[];const s=this.getProperties(t),i=this.getDynamicPropertiesByObj(e);for(let r=i.length-1;r>=0;r--)this.findProperty(t,i[r].name)&&i.splice(r,1);return i.length===0?s:[].concat(s).concat(i)}addDynamicPropertiesIntoObj(e,t,s){s.forEach(i=>{this.addDynamicPropertyIntoObj(e,t,i.name,!1),i.serializationProperty&&this.addDynamicPropertyIntoObj(e,t,i.serializationProperty,!0),i.alternativeName&&this.addDynamicPropertyIntoObj(e,t,i.alternativeName,!1)})}addDynamicPropertyIntoObj(e,t,s,i){var r={configurable:!0,get:function(){return t[s]}};i||(r.set=function(a){t[s]=a}),Object.defineProperty(e,s,r)}getDynamicPropertiesByObj(e,t=null){if(!e||!e.getType)return[];if(e.getDynamicProperties)return e.getDynamicProperties();if(!e.getDynamicType&&!t)return[];const s=t||e.getDynamicType();return this.getDynamicPropertiesByTypes(e.getType(),s)}getDynamicPropertiesByTypes(e,t,s){if(!t)return[];const i=t+"-"+e;if(this.dynamicPropsCache[i])return this.dynamicPropsCache[i];var r=this.getProperties(t);if(!r||r.length==0)return[];const a={},o=this.getProperties(e);for(var l=0;l<o.length;l++)a[o[l].name]=o[l];const u=[];s||(s=[]);for(let d=0;d<r.length;d++){let h=r[d];if(this.canAddDynamicProp(h,a[h.name])){if(s.indexOf(h.name)>-1){const f=new Ds(h.classInfo,h.name,h.isRequired);f.mergeWith(h),h=f,h.visible=!1,h.isSerializable=!1}u.push(h)}}return this.dynamicPropsCache[i]=u,u}canAddDynamicProp(e,t){if(!t)return!0;if(e===t)return!1;let s=e.classInfo;for(;s&&s.parentName;){if(e=this.findProperty(s.parentName,e.name),e&&e===t)return!0;s=e?e.classInfo:void 0}return!1}hasOriginalProperty(e,t){return!!this.getOriginalProperty(e,t)}getOriginalProperty(e,t){var s=this.findProperty(e.getType(),t);return s||(this.isObjWrapper(e)?this.findProperty(e.getOriginalObj().getType(),t):null)}getProperty(e,t){const s=this.findProperty(e,t);if(!s)return s;const i=this.findClass(e);if(s.classInfo===i)return s;const r=new Ds(i,s.name,s.isRequired);return r.mergeWith(s),i.properties.push(r),i.resetAllProperties(),r}findProperty(e,t){const s=this.findClass(e);return s?s.findProperty(t):null}findProperties(e,t){var s=new Array;const i=this.findClass(e);if(!i)return s;for(var r=0;r<t.length;r++){var a=i.findProperty(t[r]);a&&s.push(a)}return s}getAllPropertiesByName(e){for(var t=new Array,s=this.getAllClasses(),i=0;i<s.length;i++)for(var r=this.findClass(s[i]),a=0;a<r.properties.length;a++)if(r.properties[a].name==e){t.push(r.properties[a]);break}return t}getAllClasses(){var e=new Array;for(var t in this.classes)e.push(t);return e}createClass(e,t=void 0){e=e.toLowerCase();var s=this.findClass(e);if(!s)return null;if(s.creator)return s.creator(t);for(var i=s.parentName;i;){if(s=this.findClass(i),!s)return null;if(i=s.parentName,s.creator)return this.createCustomType(e,s.creator,t)}return null}createCustomType(e,t,s=void 0){e=e.toLowerCase();var i=t(s),r=e,a=i.getTemplate?i.getTemplate():i.getType();return i.getType=function(){return r},i.getTemplate=function(){return a},it.createProperties(i),i}getChildrenClasses(e,t=!1){e=e.toLowerCase();var s=[];return this.fillChildrenClasses(e,t,s),s}getRequiredProperties(e){const t=this.findClass(e);if(!t)return[];const s=t.getRequiredProperties();for(var i=[],r=0;r<s.length;r++)i.push(s[r].name);return i}addProperties(e,t){e=e.toLowerCase();for(var s=this.findClass(e),i=0;i<t.length;i++)this.addCustomPropertyCore(s,t[i])}addProperty(e,t){return this.addCustomPropertyCore(this.findClass(e),t)}addCustomPropertyCore(e,t){if(!e)return null;var s=e.createProperty(t,!0);return s&&(this.clearDynamicPropsCache(e),e.resetAllProperties()),s}removeProperty(e,t){var s=this.findClass(e);if(!s)return!1;var i=s.find(t);i&&(this.clearDynamicPropsCache(s),this.removePropertyFromClass(s,i),s.resetAllProperties(),it.removeProperty(s.name,t))}clearDynamicPropsCache(e){this.dynamicPropsCache={}}removePropertyFromClass(e,t){var s=e.properties.indexOf(t);s<0||e.properties.splice(s,1)}fillChildrenClasses(e,t,s){var i=this.childrenClasses[e];if(i)for(var r=0;r<i.length;r++)(!t||i[r].creator)&&s.push(i[r]),this.fillChildrenClasses(i[r].name,t,s)}findClass(e){e=e.toLowerCase();var t=this.classes[e];if(!t){var s=this.alternativeNames[e];if(s&&s!=e)return this.findClass(s)}return t}isDescendantOf(e,t){if(!e||!t)return!1;e=e.toLowerCase(),t=t.toLowerCase();var s=this.findClass(e);if(!s)return!1;var i=s;do{if(i.name===t)return!0;i=this.classes[i.parentName]}while(i);return!1}addAlterNativeClassName(e,t){this.alternativeNames[t.toLowerCase()]=e.toLowerCase()}generateSchema(e=void 0){e||(e="survey");var t=this.findClass(e);if(!t)return null;var s={$schema:"http://json-schema.org/draft-07/schema#",title:"SurveyJS Library json schema",type:"object",properties:{},definitions:{locstring:this.generateLocStrClass()}};return this.generateSchemaProperties(t,s,s.definitions,!0),s}generateLocStrClass(){const e={},t=B.findProperty("survey","locale");if(t){const s=t.getChoices(null);Array.isArray(s)&&(s.indexOf("en")<0&&s.splice(0,0,"en"),s.splice(0,0,"default"),s.forEach(i=>{i&&(e[i]={type:"string"})}))}return{$id:"locstring",type:"object",properties:e}}generateSchemaProperties(e,t,s,i){if(!e)return;const r=t.properties,a=[];e.name==="question"&&(r.type={type:"string"},a.push("type"));for(let o=0;o<e.properties.length;o++){const l=e.properties[o];l.isSerializable!==!1&&(e.parentName&&B.findProperty(e.parentName,l.name)||(r[l.name]=this.generateSchemaProperty(l,s,i),l.isRequired&&a.push(l.name)))}a.length>0&&(t.required=a)}generateSchemaProperty(e,t,s){if(e.isLocalizable)return{oneOf:[{type:"string"},{$ref:this.getChemeRefName("locstring",s)}]};const i=e.schemaType(),r=e.schemaRef();var a={};if(i&&(a.type=i),e.hasChoices){const d=e.getChoices(null);Array.isArray(d)&&d.length>0&&(a.enum=this.getChoicesValues(d))}if(r&&(i==="array"?e.className==="string"?a.items={type:e.className}:a.items={$ref:this.getChemeRefName(e.className,s)}:a.$ref=this.getChemeRefName(r,s),this.generateChemaClass(e.className,t,!1)),e.baseClassName){var o=this.getChildrenClasses(e.baseClassName,!0);e.baseClassName=="question"&&o.push(this.findClass("panel")),a.items={anyOf:[]};for(var l=0;l<o.length;l++){var u=o[l].name;a.items.anyOf.push({$ref:this.getChemeRefName(u,s)}),this.generateChemaClass(u,t,!1)}}return a}getChemeRefName(e,t){return t?"#/definitions/"+e:e}generateChemaClass(e,t,s){if(t[e])return;var i=this.findClass(e);if(!i)return;var r=!!i.parentName&&i.parentName!="base";r&&this.generateChemaClass(i.parentName,t,s);const a={type:"object",$id:e};t[e]=a;const o={properties:{}};this.generateSchemaProperties(i,o,t,s),r?a.allOf=[{$ref:this.getChemeRefName(i.parentName,s)},{properties:o.properties}]:a.properties=o.properties,Array.isArray(o.required)&&(a.required=o.required)}getChoicesValues(e){const t=new Array;return e.forEach(s=>{typeof s=="object"&&s.value!==void 0?t.push(s.value):t.push(s)}),t}}class Cn{constructor(e,t){this.type=e,this.message=t,this.description="",this.at=-1,this.end=-1}getFullDescription(){return this.message+(this.description?`
`+this.description:"")}}class oE extends Cn{constructor(e,t){super("unknownproperty","Unknown property in class '"+t+"': '"+e+"'."),this.propertyName=e,this.className=t}}class JC extends Cn{constructor(e,t,s){super(t,s),this.baseClassName=e,this.type=t,this.message=s}}class lE extends JC{constructor(e,t){super(t,"missingtypeproperty","The property type is missing in the object. Please take a look at property: '"+e+"'."),this.propertyName=e,this.baseClassName=t}}class uE extends JC{constructor(e,t){super(t,"incorrecttypeproperty","The property type is incorrect in the object. Please take a look at property: '"+e+"'."),this.propertyName=e,this.baseClassName=t}}class hE extends Cn{constructor(e,t){super("requiredproperty","The property '"+e+"' is required in class '"+t+"'."),this.propertyName=e,this.className=t}}class dE extends Cn{constructor(e,t){super("arrayproperty","The property '"+e+"' should be an array in '"+t+"'."),this.propertyName=e,this.className=t}}class cE extends Cn{constructor(e,t){super("incorrectvalue","The property value: '"+t+"' is incorrect for property '"+e.name+"'."),this.property=e,this.value=t}}class rt{constructor(){this.errors=new Array,this.lightSerializing=!1}static get metaData(){return rt.metaDataValue}toJsonObject(e,t){return this.toJsonObjectCore(e,null,t)}toObject(e,t,s){this.toObjectCore(e,t,s);var i=this.getRequiredError(t,e);i&&this.addNewError(i,e,t)}toObjectCore(e,t,s){if(!e)return;var i=null,r=void 0,a=!0;if(t.getType&&(r=t.getType(),i=B.getProperties(r),a=!!r&&!B.isDescendantOf(r,"itemvalue")),!i)return;t.startLoadingFromJson&&t.startLoadingFromJson(e),i=this.addDynamicProperties(t,e,i),this.options=s;const o={};o[rt.typePropertyName]=!0;const l={};for(var u in e)this.setPropertyValueToObj(e,t,u,i,o,l,r,a,s);this.options=void 0,t.endLoadingFromJson&&t.endLoadingFromJson()}setPropertyValueToObj(e,t,s,i,r,a,o,l,u){if(r[s])return;if(s===rt.positionPropertyName){t[s]=e[s];return}const d=this.findProperty(i,s);if(!d&&l&&this.addNewError(new oE(s.toString(),o),e,t),d){const h=d.dependsOn;Array.isArray(h)&&(a[s]=!0,h.forEach(f=>{a[f]||this.setPropertyValueToObj(e,t,f,i,r,a,o,!1,u)})),this.valueToObj(e[s],t,d,e,u),r[s]=!0}}toJsonObjectCore(e,t,s){if(!e||!e.getType)return e;if(!e.isSurvey&&typeof e.getData=="function")return e.getData();var i={};t!=null&&!t.className&&(i[rt.typePropertyName]=t.getObjType(e.getType()));const r=s===!0;return(!s||s===!0)&&(s={}),r&&(s.storeDefaults=r),this.propertiesToJson(e,B.getProperties(e.getType()),i,s),this.propertiesToJson(e,this.getDynamicProperties(e),i,s),i}getDynamicProperties(e){return B.getDynamicPropertiesByObj(e)}addDynamicProperties(e,t,s){if(!e.getDynamicPropertyName&&!e.getDynamicProperties)return s;if(e.getDynamicPropertyName){const r=e.getDynamicPropertyName();if(!r)return s;r&&t[r]&&(e[r]=t[r])}const i=this.getDynamicProperties(e);return i.length===0?s:[].concat(s).concat(i)}propertiesToJson(e,t,s,i){for(var r=0;r<t.length;r++)this.valueToJson(e,s,t[r],i)}valueToJson(e,t,s,i){i||(i={}),!(!s.isPropertySerializable(e)||s.isLightSerializable===!1&&this.lightSerializing)&&(i.version&&!s.isAvailableInVersion(i.version)||this.valueToJsonCore(e,t,s,i))}valueToJsonCore(e,t,s,i){const r=s.getSerializedProperty(e,i.version);if(r&&r!==s){this.valueToJsonCore(e,t,r,i);return}var a=s.getSerializableValue(e,i.storeDefaults);if(a===void 0)return;if(this.isValueArray(a)){for(var o=[],l=0;l<a.length;l++)o.push(this.toJsonObjectCore(a[l],s,i));a=o.length>0?o:null}else a=this.toJsonObjectCore(a,s,i);if(a==null)return;const u=s.getSerializedName(i.version);var d=typeof e.getPropertyValue=="function"&&e.getPropertyValue(u,null)!==null;(i.storeDefaults&&d||!s.isDefaultValueByObj(e,a))&&(!B.onSerializingProperty||!B.onSerializingProperty(e,s,a,t))&&(t[u]=this.removePosOnValueToJson(s,a))}valueToObj(e,t,s,i,r){if(e!=null){if(this.removePos(s,e),s!=null&&s.hasToUseSetValue){s.setValue(t,e,this);return}if(s.isArray&&!Array.isArray(e)&&e){e=[e];const o=i&&s.alternativeName&&i[s.alternativeName]?s.alternativeName:s.name;this.addNewError(new dE(o,t.getType()),i||e,t)}if(this.isValueArray(e)){this.valueToArray(e,t,s.name,s,r);return}var a=this.createNewObj(e,s);a.newObj&&(this.toObjectCore(e,a.newObj,r),e=a.newObj),a.error||(s!=null?(s.setValue(t,e,this),r&&r.validatePropertyValues&&(s.validateValue(e)||this.addNewError(new cE(s,e),i,t))):t[s.name]=e)}}removePosOnValueToJson(e,t){return!e.isCustom||!t||this.removePosFromObj(t),t}removePos(e,t){!e||!e.type||e.type.indexOf("value")<0||this.removePosFromObj(t)}removePosFromObj(e){if(!(!e||typeof e.getType=="function")){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.removePosFromObj(e[t]);if(typeof e=="object"){e[rt.positionPropertyName]&&delete e[rt.positionPropertyName];for(let s in e)this.removePosFromObj(e[s])}}}isValueArray(e){return e&&Array.isArray(e)}createNewObj(e,t){var s={newObj:null,error:null};const i=this.getClassNameForNewObj(e,t);return s.newObj=i?B.createClass(i,e):null,s.error=this.checkNewObjectOnErrors(s.newObj,e,t,i),s}getClassNameForNewObj(e,t){var s=t!=null&&t.className?t.className:void 0;if(s||(s=e[rt.typePropertyName]),!s)return s;s=s.toLowerCase();const i=t.classNamePart;return i&&s.indexOf(i)<0&&(s+=i),s}checkNewObjectOnErrors(e,t,s,i){var r=null;return e?r=this.getRequiredError(e,t):s.baseClassName&&(i?r=new uE(s.name,s.baseClassName):r=new lE(s.name,s.baseClassName)),r&&this.addNewError(r,t,e),r}getRequiredError(e,t){if(!e.getType||typeof e.getData=="function")return null;const s=B.findClass(e.getType());if(!s)return null;const i=s.getRequiredProperties();if(!Array.isArray(i))return null;for(var r=0;r<i.length;r++){const a=i[r];if(L.isValueEmpty(a.defaultValue)&&!t[a.name])return new hE(a.name,e.getType())}return null}addNewError(e,t,s){if(e.jsonObj=t,e.element=s,this.errors.push(e),!t)return;const i=t[rt.positionPropertyName];i&&(e.at=i.start,e.end=i.end)}valueToArray(e,t,s,i,r){if(!(t[s]&&!this.isValueArray(t[s]))){t[s]&&e.length>0&&t[s].splice(0,t[s].length);var a=t[s]?t[s]:[];this.addValuesIntoArray(e,a,i,r),t[s]||(t[s]=a)}}addValuesIntoArray(e,t,s,i){for(var r=0;r<e.length;r++){var a=this.createNewObj(e[r],s);a.newObj?(e[r].name&&(a.newObj.name=e[r].name),e[r].valueName&&(a.newObj.valueName=e[r].valueName.toString()),t.push(a.newObj),this.toObjectCore(e[r],a.newObj,i)):a.error||t.push(e[r])}}findProperty(e,t){if(!e)return null;for(var s=0;s<e.length;s++){var i=e[s];if(i.name==t||i.alternativeName==t)return i}return null}}rt.typePropertyName="type",rt.positionPropertyName="pos",rt.metaDataValue=new aE;var B=rt.metaData;class Di{constructor(){}getValueInfo(e){const t=this.getValueInfoCore(e);return!t.isFound&&t.value===void 0&&e.name.endsWith(".length")&&(t.isFound=!0,t.value=0),t}getValueInfoCore(e){const t=e.name,s=e.context;let i=this.run(e.name,s,e.createObjects);if((!i||!i.isFound)&&s&&s.getRootObj){const a=s.getRootObj();if(a)return e.context=a.getValueGetterContext(),this.getValueInfo(e)}const r={isFound:!1,value:void 0};return!i||!i.isFound||(r.isFound=!0,r.value=i.value,r.strictCompare=i.requireStrictCompare,i.context&&(e.isText&&i.context.getTextValue&&(r.value=i.context.getTextValue(t,r.value,e.isDisplayValue)),i.context.getQuestion&&(r.question=i.context.getQuestion()))),r}getValue(e,t,s,i){const r=this.getValueInfo({name:e,context:t,isText:s,isDisplayValue:i});return r.isFound?r.value:void 0}getDisplayValue(e,t,s=!0){return this.getValue(e,t,!0,s)}isAnyKeyChanged(e,t){for(var s=0;s<t.length;s++){const a=t[s];if(!a)continue;const o=a.toLowerCase();if(e.hasOwnProperty(a)||a!==o&&e.hasOwnProperty(o))return!0;const l=this.getFirstNameByKeys(e,a);if(!l)continue;if(a===l)return!0;const u=e[l];if(u==null)continue;if(!u.hasOwnProperty("oldValue")||!u.hasOwnProperty("newValue"))return!0;const d={};d[l]=u.oldValue;var i=this.getValueFromObject(d,a);d[l]=u.newValue;var r=this.getValueFromObject(d,a);if(!L.isTwoValueEquals(i,r,!1,!1,!1))return!0}return!1}getFirstNameByKeys(e,t){const s=this.getPath(t);let i="";for(let r=0;r<s.length;r++)if(i+=(r>0?".":"")+s[r].name,e.hasOwnProperty(i))return i;return""}getValueFromObject(e,t){const s=this.getValueInfo({name:t,context:new ws(e)});return s.isFound?s.value:void 0}run(e,t,s){if(!t)return;let i=this.getPath(e);const r=t.getValue(i,!0,-1,s);return r&&r.isFound?r:void 0}getPath(e){const t=[],s=e.split(".");for(let i=0;i<s.length;i++)t.push(this.getValueItem(s[i]));return t}getValueItem(e){let t;if(e.lastIndexOf("]")===e.length-1){const i=e.lastIndexOf("[");if(i>-1){const r=e.substring(i+1,e.length-1);t=L.getNumber(r),(isNaN(t)||t<0)&&(t=void 0),t!==void 0&&(e=e.substring(0,i))}}const s={name:e};return t!==void 0&&(s.index=t),s}}class Zi{constructor(){}getValue(e,t,s,i){let r=0;const a={isFound:!1,value:this.getInitialvalue(),context:this};for(;r<e.length;){if(r=this.checkValueByPath(e,r,a),!a.isFound)return;const o=e[r];if(r++,a.context!==this&&a.context)return a.context.getValue([].concat(e.slice(r)),!1,o.index,i);if(o.index!==void 0&&(this.updateItemByIndex(o.index,a),!a.isFound))return}return a}isSearchNameRevert(){return!1}checkValueByPath(e,t,s){const i=this.isSearchNameRevert(),r=t,a=this.getMaxIndexByPath(e,t);for(s.isFound=!1,i&&(t=a);!s.isFound&&t<=a&&t>=r;){const o=this.getNameByPath(e,r,t+1);if(this.updateValueByItem(o,s),s.isFound)break;t+=i?-1:1}return t}getNameByPath(e,t,s){let i="";for(let r=t;r<s;r++)r>t&&(i+="."),i+=e[r].name;return i}getMaxIndexByPath(e,t){let s=t;for(;s<e.length&&e[s].index===void 0;)s++;return s<e.length?s:e.length-1}getTextValue(e,t,s){return s?t==null?"":t.toString():t}getInitialvalue(){}updateValueByItem(e,t){}updateItemByIndex(e,t){}}class ws extends Zi{constructor(e){super(),this.variables=e}getInitialvalue(){return this.variables}isSearchNameRevert(){return!0}updateValueByItem(e,t){const s=this.getValueByItemCore(t.value,e);t.isFound=s!==void 0,t.isFound&&(t.value=s)}updateItemByIndex(e,t){const s=t.value;Array.isArray(s)&&e<s.length?(t.value=s[e],t.isFound=!0):t.isFound=!1}getValueByItemCore(e,t){if(!e||!t)return;const s=t.toLowerCase();if(t==="length"&&(Array.isArray(e)||typeof e=="string"))return e.length;if(typeof e!="object")return;let i=s[0],r=t[0].toLocaleUpperCase();for(var a in e){var o=a[0];if(o===i||o===r){var l=a.toLowerCase();if(l==s)return e[a]}}}}class pE extends ws{constructor(e){super(e),this.obj=e}getValueByItemCore(e,t){if(!(!e||!t))return e[t]}}class fd extends ws{constructor(e,t){super(e),this.second=t}getValue(e,t,s,i){const r=super.getValue(e,t,s,i);return!this.second||r?.isFound?r:this.second.getValue(e,t,s,i)}}class gE{constructor(e){this.properties=null,this.asyncValues={},this.contextValue=e}get context(){return this.contextValue}hasValue(e){return this.context?this.getValueInfoByContext(e).isFound:!1}getValue(e){if(this.context)return this.getValueInfoByContext(e).value}getValueInfoByContext(e){return new Di().getValueInfo({name:e,context:this.context,isText:!1})}getValueInfo(e){if(this.context){const t=this.getValueInfoByContext(e.name);e.value=t.value,e.hasValue=t.isFound,e.strictCompare=t.strictCompare;return}return{hasValue:!1}}}class xs{static disposedObjectChangedProperty(e,t){xs.warn('An attempt to set a property "'+e+'" of a disposed object "'+t+'"')}static inCorrectQuestionValue(e,t){const s=JSON.stringify(t,null,3);xs.warn("An attempt to assign an incorrect value"+s+' to the following question: "'+e+'"')}static warn(e){console.warn(e)}static error(e){console.error(e)}}class Ae{constructor(){this.functionHash={},this.isAsyncHash={}}register(e,t,s=!1){this.functionHash[e]=t,s&&(this.isAsyncHash[e]=!0)}unregister(e){delete this.functionHash[e],delete this.isAsyncHash[e]}hasFunction(e){return!!this.functionHash[e]}isAsyncFunction(e){return!!this.isAsyncHash[e]}clear(){this.functionHash={}}getAll(){var e=[];for(var t in this.functionHash)e.push(t);return e.sort()}run(e,t,s=null,i){const r=this.functionHash[e];if(!r)return xs.warn(this.getUnknownFunctionErrorText(e,s)),null;let a={func:r};if(s)for(var o in s)a[o]=s[o];return a.func(t,i)}getUnknownFunctionErrorText(e,t){return"Unknown function name: '"+e+"'."+Ar.getQuestionErrorText(t)}}Ae.Instance=new Ae,Ae.Instance.register;function Yi(n,e){if(n!=null)if(Array.isArray(n))for(var t=0;t<n.length;t++)Yi(n[t],e);else L.isNumber(n)&&(n=L.getNumber(n)),e.push(n)}function KC(n){var e=[];Yi(n,e);for(var t=0,s=0;s<e.length;s++)t=L.correctAfterPlusMinis(t,e[s],t+e[s]);return t}Ae.Instance.register("sum",KC);function ZC(n,e){var t=[];Yi(n,t);for(var s=void 0,i=0;i<t.length;i++)s===void 0&&(s=t[i]),e?s>t[i]&&(s=t[i]):s<t[i]&&(s=t[i]);return s}function mE(n){return ZC(n,!0)}Ae.Instance.register("min",mE);function fE(n){return ZC(n,!1)}Ae.Instance.register("max",fE);function yE(n){var e=[];return Yi(n,e),e.length}Ae.Instance.register("count",yE);function vE(n){var e=[];Yi(n,e);const t=KC(n);return e.length>0?t/e.length:0}Ae.Instance.register("avg",vE);function CE(n){var e=[];if(Yi(n,e),e.length>0){const t=e[0],s=e[1]||0;if(L.isNumber(t)&&L.isNumber(s)){const i=Math.pow(10,s),r=t*i*(1+Number.EPSILON);return Math.round(r)/i}}return NaN}Ae.Instance.register("round",CE);function bE(n){var e=[];if(Yi(n,e),e.length>0){const t=e[0],s=e[1]||-1;if(L.isNumber(t)&&L.isNumber(s)){const i=new RegExp("^-?\\d+(?:.\\d{0,"+s+"})?");return Number(t.toString().match(i)[0])}}return NaN}Ae.Instance.register("trunc",bE);function wE(n,e){if(n.length<2||n.length>3)return null;const t=n[0];if(!t||!Array.isArray(t)&&!Array.isArray(Object.keys(t)))return null;const s=n[1];if(typeof s!="string"&&!(s instanceof String))return null;let i=n.length>2?n[2]:void 0;if(typeof i!="string"&&!(i instanceof String)&&(i=void 0),!i){const r=Array.isArray(e)&&e.length>2?e[2]:void 0;r&&r.toString()&&(i=r.toString())}return{data:t,name:s,expression:i}}function xE(n){return typeof n=="string"?L.isNumber(n)?L.getNumber(n):void 0:n}function YC(n,e,t,s,i,r,a){if(!n||L.isValueEmpty(n[e])||r&&!r.runValues(n,a))return t;const o=i?xE(n[e]):1;return s(t,o)}function Ho(n,e,t,s,i=!0){var r=wE(e,t);if(!r)return;let a=r.expression?new Gs(r.expression):void 0;a&&a.isAsync&&(a=void 0);var o=void 0;if(Array.isArray(r.data))for(var l=0;l<r.data.length;l++)o=YC(r.data[l],r.name,o,s,i,a,n);else for(var u in r.data)o=YC(r.data[u],r.name,o,s,i,a,n);return o}function bn(n){var e;return{survey:n.survey,question:n.question,context:(e=n.survey)===null||e===void 0?void 0:e.getValueGetterContext()}}function VE(n,e){var t=Ho(bn(this),n,e,function(s,i){return s==null&&(s=0),i==null||i==null?s:L.correctAfterPlusMinis(s,i,s+i)});return t!==void 0?t:0}Ae.Instance.register("sumInArray",VE);function PE(n,e){return Ho(bn(this),n,e,function(t,s){return t==null?s:s==null||s==null||t<s?t:s})}Ae.Instance.register("minInArray",PE);function SE(n,e){return Ho(bn(this),n,e,function(t,s){return t==null?s:s==null||s==null||t>s?t:s})}Ae.Instance.register("maxInArray",SE);function IE(n,e){var t=Ho(bn(this),n,e,function(s,i){return s==null&&(s=0),i==null||i==null?s:s+1},!1);return t!==void 0?t:0}Ae.Instance.register("countInArray",IE);function TE(n,e){const t=bn(this),s=r=>Ae.Instance.run(r,n,t,e),i=s("countInArray");return i==0?0:s("sumInArray")/i}Ae.Instance.register("avgInArray",TE);function EE(n){if(!Array.isArray(n)||n.length<2)return null;const e=n.length>2?n[2]:void 0;return n[0]?n[1]:e}Ae.Instance.register("iif",EE);function RE(n){return!Array.isArray(n)||n.length<1||!n[0]?null:Ot("function-getDate",n[0])}Ae.Instance.register("getDate",RE);function XC(n,e,t){if(t==="days")return s1([n,e]);const s=Ot("function-dateDiffMonths",n),i=Ot("function-dateDiffMonths",e),r=i.getFullYear()-s.getFullYear();t=t||"years";let a=r*12+i.getMonth()-s.getMonth();return i.getDate()<s.getDate()&&(a-=1),t==="months"?a:~~(a/12)}function _E(n){return!Array.isArray(n)||n.length<1||!n[0]?null:XC(n[0],void 0,(n.length>1?n[1]:"")||"years")}Ae.Instance.register("age",_E);function LE(n){if(!Array.isArray(n)||n.length<2||!n[0]||!n[1])return null;const e=(n.length>2?n[2]:"")||"days",t=e==="hours"||e==="minutes"||e==="seconds",s=t?"days":e;let i=XC(n[0],n[1],s);if(t){const r=Ot("function-dateDiffMonths",n[0]),a=Ot("function-dateDiffMonths",n[1]);(a.getHours()>r.getHours()||e!=="hours"&&a.getHours()===r.getHours()&&a.getMinutes()>r.getMinutes())&&(i-=1);let o=i*24+a.getHours()-r.getHours();if(e==="hours")return o;a.getMinutes()<r.getMinutes()&&(o-=1);const l=o*60+a.getMinutes()-r.getMinutes();return e==="minutes"?l:l*60+a.getSeconds()-r.getSeconds()}return i}Ae.Instance.register("dateDiff",LE);function AE(n){if(!Array.isArray(n)||n.length<2||!n[0]||!n[1])return null;const e=Ot("function-dateAdd",n[0]),t=n[1],s=n[2]||"days";return s==="days"&&e.setDate(e.getDate()+t),s==="months"&&e.setMonth(e.getMonth()+t),s==="years"&&e.setFullYear(e.getFullYear()+t),e}Ae.Instance.register("dateAdd",AE);function e1(n){if(!n)return!1;for(var e=n.questions,t=0;t<e.length;t++)if(!e[t].validate(!1))return!1;return!0}function DE(n){if(!n&&n.length<1||!n[0]||!this.survey)return!1;const e=n[0];let t=this.survey.getPageByName(e);if(t||(t=this.survey.getPanelByName(e)),!t){const s=this.survey.getQuestionByName(e);if(!s||!Array.isArray(s.panels))return!1;if(n.length>1)n[1]<s.panels.length&&(t=s.panels[n[1]]);else{for(let i=0;i<s.panels.length;i++)if(!e1(s.panels[i]))return!1;return!0}}return e1(t)}Ae.Instance.register("isContainerReady",DE);function OE(){return this.survey&&this.survey.isDisplayMode}Ae.Instance.register("isDisplayMode",OE);function ME(){return Ot("function-currentDate")}Ae.Instance.register("currentDate",ME);function t1(n){var e=Ot("function-today");return D.storeUtcDates?e.setUTCHours(0,0,0,0):e.setHours(0,0,0,0),Array.isArray(n)&&n.length==1&&e.setDate(e.getDate()+n[0]),e}Ae.Instance.register("today",t1);function kE(n){if(!(n.length!==1||!n[0]))return Ot("function-getYear",n[0]).getFullYear()}Ae.Instance.register("getYear",kE);function NE(){return Ot("function-currentYear").getFullYear()}Ae.Instance.register("currentYear",NE);function s1(n){if(!Array.isArray(n)||n.length!==2||!n[0]||!n[1])return 0;const e=Ot("function-diffDays",n[0]),t=Ot("function-diffDays",n[1]),s=Math.abs(t-e);return Math.ceil(s/(1e3*60*60*24))}Ae.Instance.register("diffDays",s1);function zo(n,e){let t=t1(void 0);return e&&e[0]&&(t=Ot("function-"+n,e[0])),t}function qE(n){return zo("year",n).getFullYear()}Ae.Instance.register("year",qE);function BE(n){return zo("month",n).getMonth()+1}Ae.Instance.register("month",BE);function FE(n){return zo("day",n).getDate()}Ae.Instance.register("day",FE);function QE(n){return zo("weekday",n).getDay()}Ae.Instance.register("weekday",QE);function i1(n,e){if(!n||!e)return;let t=n.question;for(;t&&t.parent;){const i=t.parent.getQuestionByName(e);if(i)return i;t=t.parentQuestion}const s=["row","panel","survey"];for(let i=0;i<s.length;i++){const r=n[s[i]];if(r&&r.getQuestionByName){const a=r.getQuestionByName(e);if(a)return a}}return null}function r1(n,e){return e.length>1&&!L.isValueEmpty(e[1])?n.getDisplayValue(!0,e[1]):n.displayValue}function HE(n){const e=i1(this,n[0]);if(!e)return"";if(e.isReady)this.returnResult(r1(e,n));else{const t=(s,i)=>{s.isReady&&(s.onReadyChanged.remove(t),this.returnResult(r1(s,n)))};e.onReadyChanged.add(t)}}Ae.Instance.register("displayValue",HE,!0);function zE(n){if(n.length!==2||!n[0]||!n[1])return;const e=i1(this,n[0]);return e?e[n[1]]:void 0}Ae.Instance.register("propertyValue",zE);function jE(n){if(n.length<2)return"";const e=n[0];if(!e||typeof e!="string")return"";const t=n[1];if(!L.isNumber(t))return"";const s=n.length>2?n[2]:void 0;return L.isNumber(s)?e.substring(t,s):e.substring(t)}Ae.Instance.register("substring",jE);function UE(n){if(n.length<1||!n[0]||!this.survey)return;const e=this.survey.getQuestionByName(n[0]);if(!e)return"";const t=n.length>1?n[1]:void 0;if(t!=null){const s=e.getItemByValue(t);return s?e.getCommentValue(s):void 0}return e.getCommentValue(e.otherItem)||e.comment}Ae.Instance.register("getComment",UE);class Oi{constructor(){this._id=Oi.counter++}get id(){return this._id}toString(e=void 0){return""}hasFunction(){return!1}hasAsyncFunction(){return!1}addToAsyncList(e){}addOperandsToList(e){e.push(this),this.addChildrenToList(e)}isEqual(e){return!!e&&e.getType()===this.getType()&&this.isContentEqual(e)}areOperatorsEquals(e,t){return!e&&!t||!!e&&e.isEqual(t)}addChildrenToList(e){}}Oi.counter=1;class WE extends Oi{constructor(e,t=null,s=null,i=!1){super(),this.operatorName=e,this.left=t,this.right=s,this.isArithmeticValue=i,i?this.consumer=Re.binaryFunctions.arithmeticOp(e):this.consumer=Re.binaryFunctions[e],this.consumer==null&&Re.throwInvalidOperatorError(e)}get requireStrictCompare(){return this.getIsOperandRequireStrict(this.left)||this.getIsOperandRequireStrict(this.right)}getIsOperandRequireStrict(e){return!!e&&e.requireStrictCompare}getType(){return"binary"}get isArithmetic(){return this.isArithmeticValue}get isConjunction(){return this.operatorName=="or"||this.operatorName=="and"}get conjunction(){return this.isConjunction?this.operatorName:""}get operator(){return this.operatorName}get leftOperand(){return this.left}get rightOperand(){return this.right}isContentEqual(e){const t=e;return t.operator===this.operator&&this.areOperatorsEquals(this.left,t.left)&&this.areOperatorsEquals(this.right,t.right)}evaluateParam(e,t){return e==null?null:e.evaluate(t)}evaluate(e){return this.consumer.call(this,this.evaluateParam(this.left,e),this.evaluateParam(this.right,e),this.requireStrictCompare)}toString(e=void 0){if(e){var t=e(this);if(t)return t}return"("+Re.safeToString(this.left,e)+" "+Re.operatorToString(this.operatorName)+" "+Re.safeToString(this.right,e)+")"}setVariables(e){this.left!=null&&this.left.setVariables(e),this.right!=null&&this.right.setVariables(e)}hasFunction(){return!!this.left&&this.left.hasFunction()||!!this.right&&this.right.hasFunction()}addChildrenToList(e){this.left&&this.left.addOperandsToList(e),this.right&&this.right.addOperandsToList(e)}hasAsyncFunction(){return!!this.left&&this.left.hasAsyncFunction()||!!this.right&&this.right.hasAsyncFunction()}addToAsyncList(e){this.left&&this.left.addToAsyncList(e),this.right&&this.right.addToAsyncList(e)}}class n1 extends Oi{constructor(e,t){super(),this.expressionValue=e,this.operatorName=t,this.consumer=Re.unaryFunctions[t],this.consumer==null&&Re.throwInvalidOperatorError(t)}get operator(){return this.operatorName}get expression(){return this.expressionValue}getType(){return"unary"}toString(e=void 0){if(e){var t=e(this);if(t)return t}const s=Re.operatorToString(this.operator),i=this.expression.toString(e);return this.isRigtOperator?i+" "+s:s+" "+i}get isRigtOperator(){const e=this.operatorName.toLowerCase();return e==="notempty"||e==="empty"}isContentEqual(e){const t=e;return t.operator==this.operator&&this.areOperatorsEquals(this.expression,t.expression)}hasFunction(){return this.expression.hasFunction()}addChildrenToList(e){this.expression.addOperandsToList(e)}hasAsyncFunction(){return this.expression.hasAsyncFunction()}addToAsyncList(e){this.expression.addToAsyncList(e)}evaluate(e){let t=this.expression.evaluate(e);return this.consumer.call(this,t)}setVariables(e){this.expression.setVariables(e)}}class yd extends Oi{constructor(e){super(),this.values=e}getType(){return"array"}toString(e=void 0){if(e){var t=e(this);if(t)return t}return"["+this.values.map(function(s){return s.toString(e)}).join(", ")+"]"}evaluate(e){return this.values.map(function(t){return t.evaluate(e)})}setVariables(e){this.values.forEach(t=>{t.setVariables(e)})}hasFunction(){return this.values.some(e=>e.hasFunction())}addChildrenToList(e){this.values.forEach(t=>{t.addOperandsToList(e)})}hasAsyncFunction(){return this.values.some(e=>e.hasAsyncFunction())}addToAsyncList(e){this.values.forEach(t=>t.addToAsyncList(e))}isContentEqual(e){const t=e;if(t.values.length!==this.values.length)return!1;for(var s=0;s<this.values.length;s++)if(!t.values[s].isEqual(this.values[s]))return!1;return!0}}class a1 extends Oi{constructor(e){super(),this.value=e}getType(){return"const"}toString(e=void 0){if(e){var t=e(this);if(t)return t}return this.value.toString()}get correctValue(){return this.getCorrectValue(this.value)}get requireStrictCompare(){return!1}evaluate(){return this.getCorrectValue(this.value)}setVariables(e){}getCorrectValue(e){if(!e||typeof e!="string")return e;if(Re.isBooleanValue(e))return e.toLowerCase()==="true";if(e.length>1&&this.isQuote(e[0])&&this.isQuote(e[e.length-1]))return e.substring(1,e.length-1);if(L.isNumber(e)){if(e[0]==="0"&&e.indexOf("0x")!=0){const t=e.length,s=t>1&&(e[1]==="."||e[1]===",");if(!s&&t>1||s&&t<2)return e}return L.getNumber(e)}return e}isContentEqual(e){return e.value==this.value}isQuote(e){return e=="'"||e=='"'}}class jo extends a1{static get DisableConversionChar(){return D.expressionDisableConversionChar}static set DisableConversionChar(e){D.expressionDisableConversionChar=e}constructor(e){super(e),this.variableName=e,this.valueInfo={},this.useValueAsItIs=!1,this.variableName&&this.variableName.length>1&&this.variableName[0]===jo.DisableConversionChar&&(this.variableName=this.variableName.substring(1),this.useValueAsItIs=!0)}get requireStrictCompare(){return this.valueInfo.strictCompare===!0}getType(){return"variable"}toString(e=void 0){if(e){var t=e(this);if(t)return t}var s=this.useValueAsItIs?jo.DisableConversionChar:"";return"{"+s+this.variableName+"}"}get variable(){return this.variableName}evaluate(e){if(this.valueInfo.name=this.variableName,e.getValueInfo(this.valueInfo),!this.valueInfo.hasValue)return this.returnJSONObject(this.variableName);let t=this.valueInfo.value;return this.valueInfo.onProcessValue&&(t=this.valueInfo.onProcessValue(t)),this.getCorrectValue(t)}setVariables(e){e.push(this.variableName)}getCorrectValue(e){return this.useValueAsItIs?e:super.getCorrectValue(e)}isContentEqual(e){return e.variable==this.variable}returnJSONObject(e){if(!e||e.length<2||e.indexOf(":")<1)return null;try{return JSON.parse("{"+e+"}")}catch{return null}}}class $E extends Oi{constructor(e,t){super(),this.originalValue=e,this.parameters=t,Array.isArray(t)&&t.length===0&&(this.parameters=new yd([]))}getType(){return"function"}evaluate(e){const t=this.getAsynValue(e);return t?t.value:this.evaluateCore(e)}evaluateCore(e){let t=e.properties;if(this.isAsyncFunction){t=L.createCopy(e.properties);const s=this.id,i=e.asyncValues,r=e.onCompleteAsyncFunc,a=this;t.returnResult=o=>{i[s]={value:o},r(a)}}return Ae.Instance.run(this.originalValue,this.parameters.evaluate(e),t,this.parameters.values)}toString(e=void 0){if(e){var t=e(this);if(t)return t}return this.originalValue+"("+this.parameters.toString(e)+")"}setVariables(e){this.parameters.setVariables(e)}isReady(e){return!!this.getAsynValue(e)}addChildrenToList(e){this.parameters.addOperandsToList(e)}getAsynValue(e){return e.asyncValues[this.id]}hasFunction(){return!0}hasAsyncFunction(){return this.isAsyncFunction()||this.parameters.hasAsyncFunction()}isAsyncFunction(){return Ae.Instance.isAsyncFunction(this.originalValue)}addToAsyncList(e){let t;if(this.isAsyncFunction()&&(t={operand:this}),this.parameters.hasAsyncFunction()){const s=new Array;this.parameters.addToAsyncList(s),s.forEach(i=>i.parent=t),t||(t={}),t.children=s}t&&e.push(t)}isContentEqual(e){const t=e;return t.originalValue==this.originalValue&&this.areOperatorsEquals(t.parameters,this.parameters)}}class Re{static throwInvalidOperatorError(e){throw new Error("Invalid operator: '"+e+"'")}static safeToString(e,t){return e==null?"":e.toString(t)}static toOperandString(e){return e&&!L.isNumber(e)&&!Re.isBooleanValue(e)&&(e="'"+e+"'"),e}static isBooleanValue(e){return!!e&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")}static countDecimals(e){if(L.isNumber(e)&&Math.floor(e)!==e){const t=e.toString().split(".");return t.length>1&&t[1].length||0}return 0}static plusMinus(e,t,s){const i=Re.countDecimals(e),r=Re.countDecimals(t);if(i>0||r>0){const a=Math.max(i,r);s=parseFloat(s.toFixed(a))}return s}static isTwoValueEquals(e,t,s=!0){return e==="undefined"&&(e=void 0),t==="undefined"&&(t=void 0),L.isTwoValueEquals(e,t,s)}static operatorToString(e){let t=Re.signs[e];return t??e}static convertValForDateCompare(e,t){if(t instanceof Date&&typeof e=="string"){let s=Ot("expression-operand",e);return s.setHours(0,0,0),s}return e}}Re.unaryFunctions={empty:function(n){return L.isValueEmpty(n)},notempty:function(n){return!Re.unaryFunctions.empty(n)},negate:function(n){return!n}},Re.binaryFunctions={arithmeticOp(n){const e=(t,s)=>L.isValueEmpty(t)?typeof s=="number"?0:typeof t=="string"?t:typeof s=="string"?"":Array.isArray(s)?[]:0:t;return function(t,s){t=e(t,s),s=e(s,t);let i=Re.binaryFunctions[n];return i==null?null:i.call(this,t,s)}},and:function(n,e){return n&&e},or:function(n,e){return n||e},plus:function(n,e){return L.sumAnyValues(n,e)},minus:function(n,e){return L.correctAfterPlusMinis(n,e,n-e)},mul:function(n,e){return L.correctAfterMultiple(n,e,n*e)},div:function(n,e){return e?n/e:null},mod:function(n,e){return e?n%e:null},power:function(n,e){return Math.pow(n,e)},greater:function(n,e){return n==null||e==null?!1:(n=Re.convertValForDateCompare(n,e),e=Re.convertValForDateCompare(e,n),n>e)},less:function(n,e){return n==null||e==null?!1:(n=Re.convertValForDateCompare(n,e),e=Re.convertValForDateCompare(e,n),n<e)},greaterorequal:function(n,e){return Re.binaryFunctions.equal(n,e)?!0:Re.binaryFunctions.greater(n,e)},lessorequal:function(n,e){return Re.binaryFunctions.equal(n,e)?!0:Re.binaryFunctions.less(n,e)},equal:function(n,e,t){return n=Re.convertValForDateCompare(n,e),e=Re.convertValForDateCompare(e,n),Re.isTwoValueEquals(n,e,t!==!0)},notequal:function(n,e,t){return!Re.binaryFunctions.equal(n,e,t)},contains:function(n,e){return Re.binaryFunctions.containsCore(n,e,!0)},notcontains:function(n,e){return!n&&!L.isValueEmpty(e)?!0:Re.binaryFunctions.containsCore(n,e,!1)},anyof:function(n,e){if(L.isValueEmpty(n)&&L.isValueEmpty(e))return!0;if(L.isValueEmpty(n)||!Array.isArray(n)&&n.length===0)return!1;if(L.isValueEmpty(e))return!0;if(!Array.isArray(n))return Re.binaryFunctions.contains(e,n);if(!Array.isArray(e))return Re.binaryFunctions.contains(n,e);for(var t=0;t<e.length;t++)if(Re.binaryFunctions.contains(n,e[t]))return!0;return!1},allof:function(n,e){if(!n&&!L.isValueEmpty(e))return!1;if(!Array.isArray(e))return Re.binaryFunctions.contains(n,e);for(var t=0;t<e.length;t++)if(!Re.binaryFunctions.contains(n,e[t]))return!1;return!0},containsCore:function(n,e,t){if(!n&&n!==0&&n!==!1)return!1;if(n.length||(n=n.toString(),(typeof e=="string"||e instanceof String)&&(n=n.toUpperCase(),e=e.toUpperCase())),typeof n=="string"||n instanceof String){if(!e)return!1;e=e.toString();var s=n.indexOf(e)>-1;return t?s:!s}for(var i=Array.isArray(e)?e:[e],r=0;r<i.length;r++){var a=0;for(e=i[r];a<n.length&&!Re.isTwoValueEquals(n[a],e);a++);if(a==n.length)return!t}return t}},Re.signs={less:"<",lessorequal:"<=",greater:">",greaterorequal:">=",equal:"==",notequal:"!=",plus:"+",minus:"-",mul:"*",div:"/",and:"and",or:"or",power:"^",mod:"%",negate:"!"};const vd=(function(){class n extends SyntaxError{constructor(s,i,r,a){super(s),this.expected=i,this.found=r,this.location=a,this.name="SyntaxError"}format(s){let i="Error: "+this.message;if(this.location){let r=null;const a=s.find(d=>d.source===this.location.source);a&&(r=a.text.split(/\r\n|\n|\r/g));const o=this.location.start,l=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(o):o,u=this.location.source+":"+l.line+":"+l.column;if(r){const d=this.location.end,h="".padEnd(l.line.toString().length," "),f=r[o.line-1],b=(o.line===d.line?d.column:f.length+1)-o.column||1;i+=`
 --> `+u+`
`+h+` |
`+l.line+" | "+f+`
`+h+" | "+"".padEnd(o.column-1," ")+"".padEnd(b,"^")}else i+=`
 at `+u}return i}static buildMessage(s,i){function r(b){return b.codePointAt(0).toString(16).toUpperCase()}const a=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function o(b){return a?b.replace(a,x=>"\\u{"+r(x)+"}"):b}function l(b){return o(b.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,x=>"\\x0"+r(x)).replace(/[\x10-\x1F\x7F-\x9F]/g,x=>"\\x"+r(x)))}function u(b){return o(b.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,x=>"\\x0"+r(x)).replace(/[\x10-\x1F\x7F-\x9F]/g,x=>"\\x"+r(x)))}const d={literal(b){return'"'+l(b.text)+'"'},class(b){const x=b.parts.map(V=>Array.isArray(V)?u(V[0])+"-"+u(V[1]):u(V));return"["+(b.inverted?"^":"")+x.join("")+"]"+(b.unicode?"u":"")},any(){return"any character"},end(){return"end of input"},other(b){return b.description}};function h(b){return d[b.type](b)}function f(b){const x=b.map(h);if(x.sort(),x.length>0){let V=1;for(let P=1;P<x.length;P++)x[P-1]!==x[P]&&(x[V]=x[P],V++);x.length=V}switch(x.length){case 1:return x[0];case 2:return x[0]+" or "+x[1];default:return x.slice(0,-1).join(", ")+", or "+x[x.length-1]}}function C(b){return b?'"'+l(b)+'"':"end of input"}return"Expected "+f(s)+" but "+C(i)+" found."}}function e(t,s){s=s!==void 0?s:{};const i={},r=s.grammarSource,a={Expression:gs};let o=gs;const l="||",u="or",d="&&",h="and",f="<=",C="lessorequal",b=">=",x="greaterorequal",V="==",P="equal",M="=",X="!=",N="notequal",W="<",J="less",ie=">",ne="greater",ce="+",ye="-",le="*",be="/",F="%",Z="^",ae="power",ue="*=",me="contains",Xe="contain",xt="notcontains",si="notcontain",ii="anyof",Ts="allof",Ht="(",nr="!",Fp="negate",Qp="empty",Hp="notempty",Fn="undefined",Qn="null",zp="{",jp="}",Hn="''",zn='""',jn="'",Un='"',Up="[",Wp="]",Wn=",",$p="true",Gp="false",$n="0x",Jp=".",Kp="0",Gn="\\'",Jn='\\"',Zp=/^[\-]/,Yp=/^[^"']/,Xp=/^[^{}]/,Kn=/^[0-9]/,Zn=/^[1-9]/,Yn=/^[a-zA-Z_]/,Xn=/^[ \t\n\r]/,eg=Y("||",!1),tg=Y("or",!0),sg=Y("&&",!1),ig=Y("and",!0),rg=Y("<=",!1),ng=Y("lessorequal",!0),ag=Y(">=",!1),og=Y("greaterorequal",!0),lg=Y("==",!1),ea=Y("equal",!0),ug=Y("=",!1),hg=Y("!=",!1),dg=Y("notequal",!0),cg=Y("<",!1),pg=Y("less",!0),gg=Y(">",!1),mg=Y("greater",!0),fg=Y("+",!1),yg=Y("-",!1),vg=Y("*",!1),Cg=Y("/",!1),bg=Y("%",!1),wg=Y("^",!1),xg=Y("power",!0),Vg=Y("*=",!1),Pg=Y("contains",!0),Sg=Y("contain",!0),Ig=Y("notcontains",!0),Tg=Y("notcontain",!0),Eg=Y("anyof",!0),Rg=Y("allof",!0),ta=Y("(",!1),sa=Y(")",!1),_g=Y("!",!1),Lg=Y("negate",!0),Ag=Y("empty",!0),Dg=Y("notempty",!0),Og=Y("undefined",!1),Mg=Y("null",!1),kg=Y("{",!1),Ng=Y("}",!1),qg=Y("''",!1),Bg=Y('""',!1),ia=Y("'",!1),ra=Y('"',!1),Fg=Y("[",!1),Qg=Y("]",!1),na=Y(",",!1),Hg=Y("true",!0),zg=Y("false",!0),jg=Y("0x",!1),Ug=Gt(["-"],!1,!1,!1),Wg=Y(".",!1),$g=Y("0",!1),Gg=Y("\\'",!1),Jg=Y('\\"',!1),Kg=Gt(['"',"'"],!0,!1,!1),Zg=Gt(["{","}"],!0,!1,!1),aa=Gt([["0","9"]],!1,!1,!1),oa=Gt([["1","9"]],!1,!1,!1),la=Gt([["a","z"],["A","Z"],"_"],!1,!1,!1),ua=Gt([" ","	",`
`,"\r"],!1,!1,!1);function Yg(c,p){return Jt(c,p,!0)}function Xg(){return"or"}function em(c,p){return Jt(c,p,!0)}function tm(){return"and"}function sm(c,p){return Jt(c,p)}function im(){return"lessorequal"}function rm(){return"greaterorequal"}function nm(){return"equal"}function am(){return"equal"}function om(){return"notequal"}function lm(){return"less"}function um(){return"greater"}function hm(c,p){return Jt(c,p,!0)}function dm(){return"plus"}function cm(){return"minus"}function pm(c,p){return Jt(c,p,!0)}function gm(){return"mul"}function mm(){return"div"}function fm(){return"mod"}function ym(c,p){return Jt(c,p,!0)}function vm(){return"power"}function Cm(c,p){return Jt(c,p)}function bm(){return"contains"}function wm(){return"notcontains"}function xm(){return"anyof"}function Vm(){return"allof"}function S4(c){return c}function Pm(c,p){return new $E(c,p)}function Sm(c){return new n1(c,"negate")}function Im(c,p){return new n1(c,p)}function Tm(){return"empty"}function Em(){return"notempty"}function Rm(){return null}function _m(c){return new a1(c)}function Lm(c){return new jo(c)}function I4(c){return c}function T4(c){return c}function E4(c){return c}function Am(){return""}function Dm(){return""}function Om(c){return"'"+c+"'"}function Mm(c){return"'"+c+"'"}function R4(c){return c}function km(c,p){if(c==null)return new yd([]);var T=[c];if(Array.isArray(p))for(var w=df(p),_=3;_<w.length;_+=4)T.push(w[_]);return new yd(T)}function Nm(){return!0}function qm(){return!1}function Bm(){return parseInt(ps(),16)}function Fm(c,p){return c==null?p:-p}function Qm(){return parseFloat(ps())}function Hm(){return parseInt(ps(),10)}function zm(){return 0}function jm(c){return c.join("")}function Um(c){return c.join("")}function Wm(){return"'"}function $m(){return'"'}function Gm(){return ps()}function Jm(){return ps()}function Km(){return ps()}let g=s.peg$currPos|0,K=g;const cs=[{line:1,column:1}];let mt=g,bi=s.peg$maxFailExpected||[],Q=s.peg$silentFails|0,U={},Ns;if(s.startRule){if(!(s.startRule in a))throw new Error(`Can't start parsing from rule "`+s.startRule+'".');o=a[s.startRule]}function ps(){return t.substring(K,g)}function Zm(c=g){const p=t.codePointAt(c);return p===void 0?"":String.fromCodePoint(p)}function Y(c,p){return{type:"literal",text:c,ignoreCase:p}}function Gt(c,p,T,w){return{type:"class",parts:c,inverted:p,ignoreCase:T,unicode:w}}function Ym(){return{type:"end"}}function ha(c){let p=cs[c],T;if(p)return p;if(c>=cs.length)T=cs.length-1;else for(T=c;!cs[--T];);for(p=cs[T],p={line:p.line,column:p.column};T<c;)t.charCodeAt(T)===10?(p.line++,p.column=1):p.column++,T++;return cs[c]=p,p}function da(c,p,T){const w=ha(c),_=ha(p);return{source:r,start:{offset:c,line:w.line,column:w.column},end:{offset:p,line:_.line,column:_.column}}}function H(c){g<mt||(g>mt&&(mt=g,bi=[]),bi.push(c))}function Xm(c,p,T){return new n(n.buildMessage(c,p),c,p,T)}function gs(){let c,p,T,w,_,k,se,G;const ve=g*34+0,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,re(),p=ar(),p!==i){for(T=[],w=g,_=re(),k=ca(),k!==i?(se=re(),G=ar(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=ca(),k!==i?(se=re(),G=ar(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w=re(),K=c,c=Yg(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function ca(){let c,p;const T=g*34+1,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.substr(g,2)===l?(p=l,g+=2):(p=i,Q===0&&H(eg)),p===i&&(p=t.substr(g,2),p.toLowerCase()===u?g+=2:(p=i,Q===0&&H(tg))),p!==i&&(K=c,p=Xg()),c=p,U[T]={nextPos:g,result:c},c)}function ar(){let c,p,T,w,_,k,se,G;const ve=g*34+2,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,p=or(),p!==i){for(T=[],w=g,_=re(),k=pa(),k!==i?(se=re(),G=or(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=pa(),k!==i?(se=re(),G=or(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);K=c,c=em(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function pa(){let c,p;const T=g*34+3,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.substr(g,2)===d?(p=d,g+=2):(p=i,Q===0&&H(sg)),p===i&&(p=t.substr(g,3),p.toLowerCase()===h?g+=3:(p=i,Q===0&&H(ig))),p!==i&&(K=c,p=tm()),c=p,U[T]={nextPos:g,result:c},c)}function or(){let c,p,T,w,_,k,se,G;const ve=g*34+4,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,p=lr(),p!==i){for(T=[],w=g,_=re(),k=ga(),k!==i?(se=re(),G=lr(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=ga(),k!==i?(se=re(),G=lr(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);K=c,c=sm(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function ga(){let c,p;const T=g*34+5,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.substr(g,2)===f?(p=f,g+=2):(p=i,Q===0&&H(rg)),p===i&&(p=t.substr(g,11),p.toLowerCase()===C?g+=11:(p=i,Q===0&&H(ng))),p!==i&&(K=c,p=im()),c=p,c===i&&(c=g,t.substr(g,2)===b?(p=b,g+=2):(p=i,Q===0&&H(ag)),p===i&&(p=t.substr(g,14),p.toLowerCase()===x?g+=14:(p=i,Q===0&&H(og))),p!==i&&(K=c,p=rm()),c=p,c===i&&(c=g,t.substr(g,2)===V?(p=V,g+=2):(p=i,Q===0&&H(lg)),p===i&&(p=t.substr(g,5),p.toLowerCase()===P?g+=5:(p=i,Q===0&&H(ea))),p!==i&&(K=c,p=nm()),c=p,c===i&&(c=g,t.charCodeAt(g)===61?(p=M,g++):(p=i,Q===0&&H(ug)),p===i&&(p=t.substr(g,5),p.toLowerCase()===P?g+=5:(p=i,Q===0&&H(ea))),p!==i&&(K=c,p=am()),c=p,c===i&&(c=g,t.substr(g,2)===X?(p=X,g+=2):(p=i,Q===0&&H(hg)),p===i&&(p=t.substr(g,8),p.toLowerCase()===N?g+=8:(p=i,Q===0&&H(dg))),p!==i&&(K=c,p=om()),c=p,c===i&&(c=g,t.charCodeAt(g)===60?(p=W,g++):(p=i,Q===0&&H(cg)),p===i&&(p=t.substr(g,4),p.toLowerCase()===J?g+=4:(p=i,Q===0&&H(pg))),p!==i&&(K=c,p=lm()),c=p,c===i&&(c=g,t.charCodeAt(g)===62?(p=ie,g++):(p=i,Q===0&&H(gg)),p===i&&(p=t.substr(g,7),p.toLowerCase()===ne?g+=7:(p=i,Q===0&&H(mg))),p!==i&&(K=c,p=um()),c=p)))))),U[T]={nextPos:g,result:c},c)}function lr(){let c,p,T,w,_,k,se,G;const ve=g*34+6,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,p=ur(),p!==i){for(T=[],w=g,_=re(),k=ma(),k!==i?(se=re(),G=ur(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=ma(),k!==i?(se=re(),G=ur(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);K=c,c=hm(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function ma(){let c,p;const T=g*34+7,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.charCodeAt(g)===43?(p=ce,g++):(p=i,Q===0&&H(fg)),p!==i&&(K=c,p=dm()),c=p,c===i&&(c=g,t.charCodeAt(g)===45?(p=ye,g++):(p=i,Q===0&&H(yg)),p!==i&&(K=c,p=cm()),c=p),U[T]={nextPos:g,result:c},c)}function ur(){let c,p,T,w,_,k,se,G;const ve=g*34+8,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,p=hr(),p!==i){for(T=[],w=g,_=re(),k=fa(),k!==i?(se=re(),G=hr(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=fa(),k!==i?(se=re(),G=hr(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);K=c,c=pm(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function fa(){let c,p;const T=g*34+9,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.charCodeAt(g)===42?(p=le,g++):(p=i,Q===0&&H(vg)),p!==i&&(K=c,p=gm()),c=p,c===i&&(c=g,t.charCodeAt(g)===47?(p=be,g++):(p=i,Q===0&&H(Cg)),p!==i&&(K=c,p=mm()),c=p,c===i&&(c=g,t.charCodeAt(g)===37?(p=F,g++):(p=i,Q===0&&H(bg)),p!==i&&(K=c,p=fm()),c=p)),U[T]={nextPos:g,result:c},c)}function hr(){let c,p,T,w,_,k,se,G;const ve=g*34+10,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,p=dr(),p!==i){for(T=[],w=g,_=re(),k=ya(),k!==i?(se=re(),G=dr(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=ya(),k!==i?(se=re(),G=dr(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);K=c,c=ym(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function ya(){let c,p;const T=g*34+11,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.charCodeAt(g)===94?(p=Z,g++):(p=i,Q===0&&H(wg)),p===i&&(p=t.substr(g,5),p.toLowerCase()===ae?g+=5:(p=i,Q===0&&H(xg))),p!==i&&(K=c,p=vm()),c=p,U[T]={nextPos:g,result:c},c)}function dr(){let c,p,T,w,_,k,se,G;const ve=g*34+12,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;if(c=g,p=wi(),p!==i){for(T=[],w=g,_=re(),k=va(),k!==i?(se=re(),G=wi(),G===i&&(G=null),_=[_,k,se,G],w=_):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),k=va(),k!==i?(se=re(),G=wi(),G===i&&(G=null),_=[_,k,se,G],w=_):(g=w,w=i);K=c,c=Cm(p,T)}else g=c,c=i;return U[ve]={nextPos:g,result:c},c}function va(){let c,p;const T=g*34+13,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.substr(g,2)===ue?(p=ue,g+=2):(p=i,Q===0&&H(Vg)),p===i&&(p=t.substr(g,8),p.toLowerCase()===me?g+=8:(p=i,Q===0&&H(Pg)),p===i&&(p=t.substr(g,7),p.toLowerCase()===Xe?g+=7:(p=i,Q===0&&H(Sg)))),p!==i&&(K=c,p=bm()),c=p,c===i&&(c=g,p=t.substr(g,11),p.toLowerCase()===xt?g+=11:(p=i,Q===0&&H(Ig)),p===i&&(p=t.substr(g,10),p.toLowerCase()===si?g+=10:(p=i,Q===0&&H(Tg))),p!==i&&(K=c,p=wm()),c=p,c===i&&(c=g,p=t.substr(g,5),p.toLowerCase()===ii?g+=5:(p=i,Q===0&&H(Eg)),p!==i&&(K=c,p=xm()),c=p,c===i&&(c=g,p=t.substr(g,5),p.toLowerCase()===Ts?g+=5:(p=i,Q===0&&H(Rg)),p!==i&&(K=c,p=Vm()),c=p))),U[T]={nextPos:g,result:c},c)}function wi(){let c,p,T;const w=g*34+14,_=U[w];return _?(g=_.nextPos,_.result):(c=g,t.charCodeAt(g)===40?(p=Ht,g++):(p=i,Q===0&&H(ta)),p!==i?(re(),T=gs(),T!==i?(re(),t.charCodeAt(g)===41?g++:Q===0&&H(sa),K=c,c=T):(g=c,c=i)):(g=c,c=i),c===i&&(c=ef(),c===i&&(c=tf(),c===i&&(c=Ca(),c===i&&(c=nf())))),U[w]={nextPos:g,result:c},c)}function ef(){let c,p,T,w;const _=g*34+15,k=U[_];return k?(g=k.nextPos,k.result):(c=g,p=Pa(),p!==i?(t.charCodeAt(g)===40?(T=Ht,g++):(T=i,Q===0&&H(ta)),T!==i?(w=ba(),t.charCodeAt(g)===41?g++:Q===0&&H(sa),K=c,c=Pm(p,w)):(g=c,c=i)):(g=c,c=i),U[_]={nextPos:g,result:c},c)}function tf(){let c,p,T;const w=g*34+16,_=U[w];return _?(g=_.nextPos,_.result):(c=g,t.charCodeAt(g)===33?(p=nr,g++):(p=i,Q===0&&H(_g)),p===i&&(p=t.substr(g,6),p.toLowerCase()===Fp?g+=6:(p=i,Q===0&&H(Lg))),p!==i?(re(),T=wi(),T!==i?(K=c,c=Sm(T)):(g=c,c=i)):(g=c,c=i),c===i&&(c=g,p=Ca(),p!==i?(re(),T=sf(),T!==i?(K=c,c=Im(p,T)):(g=c,c=i)):(g=c,c=i)),U[w]={nextPos:g,result:c},c)}function sf(){let c,p;const T=g*34+17,w=U[T];return w?(g=w.nextPos,w.result):(c=g,p=t.substr(g,5),p.toLowerCase()===Qp?g+=5:(p=i,Q===0&&H(Ag)),p!==i&&(K=c,p=Tm()),c=p,c===i&&(c=g,p=t.substr(g,8),p.toLowerCase()===Hp?g+=8:(p=i,Q===0&&H(Dg)),p!==i&&(K=c,p=Em()),c=p),U[T]={nextPos:g,result:c},c)}function Ca(){let c,p,T,w;const _=g*34+18,k=U[_];return k?(g=k.nextPos,k.result):(c=g,re(),t.substr(g,9)===Fn?(p=Fn,g+=9):(p=i,Q===0&&H(Og)),p===i&&(t.substr(g,4)===Qn?(p=Qn,g+=4):(p=i,Q===0&&H(Mg))),p!==i?(K=c,c=Rm()):(g=c,c=i),c===i&&(c=g,re(),p=rf(),p!==i?(K=c,c=_m(p)):(g=c,c=i),c===i&&(c=g,re(),t.charCodeAt(g)===123?(p=zp,g++):(p=i,Q===0&&H(kg)),p!==i?(T=uf(),T!==i?(t.charCodeAt(g)===125?(w=jp,g++):(w=i,Q===0&&H(Ng)),w!==i?(K=c,c=Lm(T)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i))),U[_]={nextPos:g,result:c},c)}function rf(){let c,p,T,w;const _=g*34+19,k=U[_];return k?(g=k.nextPos,k.result):(c=g,p=af(),p!==i&&(K=c,p=p),c=p,c===i&&(c=g,p=of(),p!==i&&(K=c,p=p),c=p,c===i&&(c=g,p=Pa(),p!==i&&(K=c,p=p),c=p,c===i&&(c=g,t.substr(g,2)===Hn?(p=Hn,g+=2):(p=i,Q===0&&H(qg)),p!==i&&(K=c,p=Am()),c=p,c===i&&(c=g,t.substr(g,2)===zn?(p=zn,g+=2):(p=i,Q===0&&H(Bg)),p!==i&&(K=c,p=Dm()),c=p,c===i&&(c=g,t.charCodeAt(g)===39?(p=jn,g++):(p=i,Q===0&&H(ia)),p!==i?(T=wa(),T!==i?(t.charCodeAt(g)===39?(w=jn,g++):(w=i,Q===0&&H(ia)),w!==i?(K=c,c=Om(T)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i),c===i&&(c=g,t.charCodeAt(g)===34?(p=Un,g++):(p=i,Q===0&&H(ra)),p!==i?(T=wa(),T!==i?(t.charCodeAt(g)===34?(w=Un,g++):(w=i,Q===0&&H(ra)),w!==i?(K=c,c=Mm(T)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i))))))),U[_]={nextPos:g,result:c},c)}function nf(){let c,p,T,w;const _=g*34+20,k=U[_];return k?(g=k.nextPos,k.result):(c=g,t.charCodeAt(g)===91?(p=Up,g++):(p=i,Q===0&&H(Fg)),p!==i?(T=ba(),t.charCodeAt(g)===93?(w=Wp,g++):(w=i,Q===0&&H(Qg)),w!==i?(K=c,c=T):(g=c,c=i)):(g=c,c=i),U[_]={nextPos:g,result:c},c)}function ba(){let c,p,T,w,_,k,se,G;const ve=g*34+21,pe=U[ve];if(pe)return g=pe.nextPos,pe.result;for(c=g,p=gs(),p===i&&(p=null),T=[],w=g,_=re(),t.charCodeAt(g)===44?(k=Wn,g++):(k=i,Q===0&&H(na)),k!==i?(se=re(),G=gs(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);w!==i;)T.push(w),w=g,_=re(),t.charCodeAt(g)===44?(k=Wn,g++):(k=i,Q===0&&H(na)),k!==i?(se=re(),G=gs(),G!==i?(_=[_,k,se,G],w=_):(g=w,w=i)):(g=w,w=i);return K=c,c=km(p,T),U[ve]={nextPos:g,result:c},c}function af(){let c,p;const T=g*34+22,w=U[T];return w?(g=w.nextPos,w.result):(c=g,p=t.substr(g,4),p.toLowerCase()===$p?g+=4:(p=i,Q===0&&H(Hg)),p!==i&&(K=c,p=Nm()),c=p,c===i&&(c=g,p=t.substr(g,5),p.toLowerCase()===Gp?g+=5:(p=i,Q===0&&H(zg)),p!==i&&(K=c,p=qm()),c=p),U[T]={nextPos:g,result:c},c)}function of(){let c,p,T;const w=g*34+23,_=U[w];return _?(g=_.nextPos,_.result):(c=g,t.substr(g,2)===$n?(p=$n,g+=2):(p=i,Q===0&&H(jg)),p!==i?(T=ms(),T!==i?(K=c,c=Bm()):(g=c,c=i)):(g=c,c=i),c===i&&(c=g,p=t.charAt(g),Zp.test(p)?g++:(p=i,Q===0&&H(Ug)),p===i&&(p=null),T=lf(),T!==i?(K=c,c=Fm(p,T)):(g=c,c=i)),U[w]={nextPos:g,result:c},c)}function lf(){let c,p,T,w;const _=g*34+24,k=U[_];return k?(g=k.nextPos,k.result):(c=g,p=ms(),p!==i?(t.charCodeAt(g)===46?(T=Jp,g++):(T=i,Q===0&&H(Wg)),T!==i?(w=ms(),w!==i?(K=c,c=Qm()):(g=c,c=i)):(g=c,c=i)):(g=c,c=i),c===i&&(c=g,p=hf(),p!==i?(T=ms(),T===i&&(T=null),K=c,c=Hm()):(g=c,c=i),c===i&&(c=g,t.charCodeAt(g)===48?(p=Kp,g++):(p=i,Q===0&&H($g)),p!==i&&(K=c,p=zm()),c=p)),U[_]={nextPos:g,result:c},c)}function uf(){let c,p,T;const w=g*34+25,_=U[w];if(_)return g=_.nextPos,_.result;if(c=g,p=[],T=Va(),T!==i)for(;T!==i;)p.push(T),T=Va();else p=i;return p!==i&&(K=c,p=jm(p)),c=p,U[w]={nextPos:g,result:c},c}function wa(){let c,p,T;const w=g*34+26,_=U[w];if(_)return g=_.nextPos,_.result;if(c=g,p=[],T=xa(),T!==i)for(;T!==i;)p.push(T),T=xa();else p=i;return p!==i&&(K=c,p=Um(p)),c=p,U[w]={nextPos:g,result:c},c}function xa(){let c,p;const T=g*34+27,w=U[T];return w?(g=w.nextPos,w.result):(c=g,t.substr(g,2)===Gn?(p=Gn,g+=2):(p=i,Q===0&&H(Gg)),p!==i&&(K=c,p=Wm()),c=p,c===i&&(c=g,t.substr(g,2)===Jn?(p=Jn,g+=2):(p=i,Q===0&&H(Jg)),p!==i&&(K=c,p=$m()),c=p,c===i&&(c=g,p=t.charAt(g),Yp.test(p)?g++:(p=i,Q===0&&H(Kg)),p!==i&&(K=c,p=Gm()),c=p)),U[T]={nextPos:g,result:c},c)}function Va(){let c,p;const T=g*34+28,w=U[T];return w?(g=w.nextPos,w.result):(c=g,p=t.charAt(g),Xp.test(p)?g++:(p=i,Q===0&&H(Zg)),p!==i&&(K=c,p=Jm()),c=p,U[T]={nextPos:g,result:c},c)}function Pa(){let c,p,T,w,_,k,se;const G=g*34+29,ve=U[G];if(ve)return g=ve.nextPos,ve.result;if(c=g,p=qs(),p!==i){if(T=[],w=g,_=ms(),_!==i){for(k=[],se=qs();se!==i;)k.push(se),se=qs();_=[_,k],w=_}else g=w,w=i;for(;w!==i;)if(T.push(w),w=g,_=ms(),_!==i){for(k=[],se=qs();se!==i;)k.push(se),se=qs();_=[_,k],w=_}else g=w,w=i;K=c,c=Km()}else g=c,c=i;return U[G]={nextPos:g,result:c},c}function ms(){let c,p;const T=g*34+30,w=U[T];if(w)return g=w.nextPos,w.result;if(c=[],p=t.charAt(g),Kn.test(p)?g++:(p=i,Q===0&&H(aa)),p!==i)for(;p!==i;)c.push(p),p=t.charAt(g),Kn.test(p)?g++:(p=i,Q===0&&H(aa));else c=i;return U[T]={nextPos:g,result:c},c}function hf(){let c,p;const T=g*34+31,w=U[T];if(w)return g=w.nextPos,w.result;if(c=[],p=t.charAt(g),Zn.test(p)?g++:(p=i,Q===0&&H(oa)),p!==i)for(;p!==i;)c.push(p),p=t.charAt(g),Zn.test(p)?g++:(p=i,Q===0&&H(oa));else c=i;return U[T]={nextPos:g,result:c},c}function qs(){let c,p;const T=g*34+32,w=U[T];if(w)return g=w.nextPos,w.result;if(c=[],p=t.charAt(g),Yn.test(p)?g++:(p=i,Q===0&&H(la)),p!==i)for(;p!==i;)c.push(p),p=t.charAt(g),Yn.test(p)?g++:(p=i,Q===0&&H(la));else c=i;return U[T]={nextPos:g,result:c},c}function re(){let c,p;const T=g*34+33,w=U[T];if(w)return g=w.nextPos,w.result;for(Q++,c=[],p=t.charAt(g),Xn.test(p)?g++:(p=i,Q===0&&H(ua));p!==i;)c.push(p),p=t.charAt(g),Xn.test(p)?g++:(p=i,Q===0&&H(ua));return Q--,U[T]={nextPos:g,result:c},c}function Jt(c,p,T=!1){return p.reduce(function(w,_){return new WE(_[1],w,_[3],T)},c)}function df(c){return[].concat.apply([],c)}Ns=o();const cr=Ns!==i&&g===t.length;function Sa(){throw Ns!==i&&g<t.length&&H(Ym()),Xm(bi,mt<t.length?Zm(mt):null,mt<t.length?da(mt,mt+1):da(mt,mt))}if(s.peg$library)return{peg$result:Ns,peg$currPos:g,peg$FAILED:i,peg$maxFailExpected:bi,peg$maxFailPos:mt,peg$success:cr,peg$throw:cr?void 0:Sa};if(cr)return Ns;Sa()}return{StartRules:["Expression"],SyntaxError:n,parse:e}})();vd.SyntaxError.prototype.name="PeggySyntaxError";const GE=vd.parse,JE=vd.SyntaxError;class KE{constructor(e,t){this.at=e,this.code=t}}class ZE{patchExpression(e){return e.replace(/=>/g,">=").replace(/=</g,"<=").replace(/<>/g,"!=").replace(/equals/g,"equal ").replace(/notequals/g,"notequal ")}createCondition(e){return this.parseExpression(e)}parseExpression(e){try{return GE(this.patchExpression(e))}catch(t){t instanceof JE&&(this.conditionError=new KE(t.location.start.offset,t.message))}}get error(){return this.conditionError}}class YE{constructor(e,t,s,i,r){this.operand=e,this.id=t,this.onComplete=s,this.processValue=new gE(r),this.processValue.properties=i}run(e){if(!e)return this.runValues();this.processValue.onCompleteAsyncFunc=s=>{const i=this.getAsyncItemByOperand(s,this.asyncFuncList);i&&this.doAsyncFunctionReady(i)},this.asyncFuncList=new Array,this.operand.addToAsyncList(this.asyncFuncList);for(var t=0;t<this.asyncFuncList.length;t++)this.runAsyncItem(this.asyncFuncList[t]);return!1}getAsyncItemByOperand(e,t){if(!Array.isArray(t))return null;for(let s=0;s<t.length;s++){if(t[s].operand===e)return t[s];const i=this.getAsyncItemByOperand(e,t[s].children);if(i)return i}return null}runAsyncItem(e){e.children?e.children.forEach(t=>this.runAsyncItem(t)):this.runAsyncItemCore(e)}runAsyncItemCore(e){e.operand?e.operand.evaluate(this.processValue):this.doAsyncFunctionReady(e)}doAsyncFunctionReady(e){if(e.parent&&this.isAsyncChildrenReady(e)){this.runAsyncItemCore(e.parent);return}for(var t=0;t<this.asyncFuncList.length;t++)if(!this.isAsyncFuncReady(this.asyncFuncList[t]))return;this.runValues()}isAsyncFuncReady(e){return e.operand&&!e.operand.isReady(this.processValue)?!1:this.isAsyncChildrenReady(e)}isAsyncChildrenReady(e){if(e.children){for(let t=0;t<e.children.length;t++)if(!this.isAsyncFuncReady(e.children[t]))return!1}return!0}runValues(){var e=this.operand.evaluate(this.processValue);return this.onComplete&&this.onComplete(e,this.id),e}}class Ar{static getQuestionErrorText(e){if(e){const t=e.question;if(t&&t.name)return" It is used in the question: '"+t.name+"'."}return""}constructor(e){this.parser=new ZE,this.isAsyncValue=!1,this.hasFunctionValue=!1,this.setExpression(e)}get expression(){return this.expressionValue}setExpression(e){this.expression!==e&&(this.expressionValue=e,this.operand=this.parser.parseExpression(e),this.hasFunctionValue=this.canRun()?this.operand.hasFunction():!1,this.isAsyncValue=this.hasFunction()?this.operand.hasAsyncFunction():!1)}getVariables(){if(!this.operand)return[];var e=[];return this.operand.setVariables(e),e}hasFunction(){return this.hasFunctionValue}get isAsync(){return this.isAsyncValue}canRun(){return!!this.operand}run(e,t,s){return this.runContext(new fd(e,t?.context),t,s)}runContext(e,t=null,s){return this.operand?new YE(this.operand,s,this.onComplete,t,e).run(this.isAsync):(this.expression&&xs.warn("Invalid expression: '"+this.expression+"'."+Ar.getQuestionErrorText(t)),null)}}Ar.createExpressionExecutor=n=>new Ar(n);class wn{constructor(e){this.expression=e}get expression(){return this.expressionExecutor?this.expressionExecutor.expression:""}set expression(e){this.expressionExecutor&&e===this.expression||(this.expressionExecutor=Ar.createExpressionExecutor(e),this.expressionExecutor.onComplete=(t,s)=>{this.doOnComplete(t,s)},this.variables=void 0,this.containsFunc=void 0)}getVariables(){return this.variables===void 0&&(this.variables=this.expressionExecutor.getVariables()),this.variables}hasFunction(){return this.containsFunc===void 0&&(this.containsFunc=this.expressionExecutor.hasFunction()),this.containsFunc}get isAsync(){return this.expressionExecutor.isAsync}canRun(){return this.expressionExecutor.canRun()}runContextCore(e,t){const s=wn.IdRunnerCounter++;return this.onBeforeAsyncRun&&this.isAsync&&this.onBeforeAsyncRun(s),this.expressionExecutor.runContext(e,t,s)}doOnComplete(e,t){this.onAfterAsyncRun&&this.isAsync&&this.onAfterAsyncRun(t)}}wn.IdRunnerCounter=1;class Gs extends wn{runValues(e,t){return this.runContext(new fd(e,t?.context),t)}runContext(e,t){return this.runContextCore(e,t)==!0}doOnComplete(e,t){this.onRunComplete&&this.onRunComplete(e==!0),super.doOnComplete(e,t)}}class XE extends wn{runValues(e,t){return this.runContext(new fd(e,t?.context),t)}runContext(e,t){return this.runContextCore(e,t)}doOnComplete(e,t){this.onRunComplete&&this.onRunComplete(e),super.doOnComplete(e,t)}}class eR{constructor(e){this.obj=e,this.properties=null,this.values=null}getType(){return"bindings"}get isSurveyObj(){return!0}getNames(){var e=[];this.fillProperties();for(var t=0;t<this.properties.length;t++)this.properties[t].isVisible("",this.obj)&&e.push(this.properties[t].name);return e}getProperties(){var e=[];this.fillProperties();for(var t=0;t<this.properties.length;t++)e.push(this.properties[t]);return e}setBinding(e,t){this.values||(this.values={});const s=this.getJson();s!==t&&(t?this.values[e]=t:(delete this.values[e],Object.keys(this.values).length==0&&(this.values=null)),this.onChangedJSON(s))}clearBinding(e){this.setBinding(e,"")}isEmpty(){if(!this.values)return!0;for(var e in this.values)return!1;return!0}getValueNameByPropertyName(e){if(this.values)return this.values[e]}getPropertiesByValueName(e){if(!this.values)return[];var t=[];for(var s in this.values)this.values[s]==e&&t.push(s);return t}getJson(){if(this.isEmpty())return;const e={};return this.getNames().forEach(t=>{this.values[t]!==void 0&&(e[t]=this.values[t])}),e}setJson(e,t){const s=this.getJson();this.values=null,e&&this.getNames().forEach(i=>{e[i]!==void 0&&(this.values||(this.values={}),this.values[i]=e[i])}),!t&&!L.isTwoValueEquals(s,this.values)&&this.onChangedJSON(s)}fillProperties(){if(this.properties===null){this.properties=[];for(var e=B.getPropertiesByObj(this.obj),t=0;t<e.length;t++)e[t].isBindable&&this.properties.push(e[t])}}onChangedJSON(e){this.obj&&this.obj.onBindingChanged(e,this.getJson())}}class Uo{constructor(e,t,s){this.currentDependency=e,this.target=t,this.property=s,this.dependencies=[],this.id=""+ ++Uo.DependenciesCount}addDependency(e,t){this.target===e&&this.property===t||this.dependencies.some(s=>s.obj===e&&s.prop===t)||(this.dependencies.push({obj:e,prop:t,id:this.id}),e.registerPropertyChangedHandlers([t],this.currentDependency,this.id))}dispose(){this.dependencies.forEach(e=>{e.obj.unregisterPropertyChangedHandlers([e.prop],e.id)})}}Uo.DependenciesCount=0;class Ue{constructor(e){this._updater=e,this.dependencies=void 0,this.type=Ue.ComputedUpdaterType}get updater(){return this._updater}setDependencies(e){this.clearDependencies(),this.dependencies=e}getDependencies(){return this.dependencies}clearDependencies(){this.dependencies&&(this.dependencies.dispose(),this.dependencies=void 0)}dispose(){this.clearDependencies(),this._updater=void 0}}Ue.ComputedUpdaterType="__dependency_computed";class de{static finishCollectDependencies(){const e=de.currentDependencis;return de.currentDependencis=void 0,e}static startCollectDependencies(e,t,s){if(de.currentDependencis!==void 0)throw new Error("Attempt to collect nested dependencies. Nested dependencies are not supported.");de.currentDependencis=new Uo(e,t,s)}static collectDependency(e,t){de.currentDependencis!==void 0&&de.currentDependencis.addDependency(e,t)}static get commentSuffix(){return D.commentSuffix}static set commentSuffix(e){D.commentSuffix=e}static get commentPrefix(){return de.commentSuffix}static set commentPrefix(e){de.commentSuffix=e}isValueEmpty(e,t=!0){return t&&(e=this.trimValue(e)),L.isValueEmpty(e)}equals(e){return!e||this.isDisposed||e.isDisposed||this.getType()!=e.getType()?!1:this.equalsCore(e)}equalsCore(e){return this.name!==e.name?!1:L.isTwoValueEquals(this.toJSON(),e.toJSON(),!1,!0,!1)}trimValue(e){return e&&(typeof e=="string"||e instanceof String)?e.trim():e}static createPropertiesHash(){return{}}constructor(){this.uniqueIdValue=de.UniqueId++,this.dependencies={},this.propertyHash=de.createPropertiesHash(),this.eventList=[],this.isLoadingFromJsonValue=!1,this.loadingOwner=null,this.onPropertyChanged=this.addEvent(),this.onNestedPropertyChanged=this.addEvent(),this.onItemValuePropertyChanged=this.addEvent(),this.isCreating=!0,this.animationAllowedLock=0,this.supportOnElementRerenderedEvent=!0,this.onElementRerenderedEventEnabled=!1,this._onElementRerendered=new Xt,it.createProperties(this),this.onBaseCreating(),this.isCreating=!1}dispose(){for(var e=0;e<this.eventList.length;e++)this.eventList[e].clear();this.onPropertyValueChangedCallback=void 0,this.isDisposedValue=!0,Object.keys(this.dependencies).forEach(t=>this.dependencies[t].dispose()),Object.keys(this.propertyHash).forEach(t=>{const s=this.getPropertyValueCore(this.propertyHash,t);s&&s.type==Ue.ComputedUpdaterType&&s.dispose()})}get isDisposed(){return this.isDisposedValue===!0}get uniqueId(){return this.uniqueIdValue}get isSurveyObj(){return!0}addEvent(){const e=new Xt;return this.eventList.push(e),e}onBaseCreating(){}getType(){return"base"}isDescendantOf(e){return B.isDescendantOf(this.getType(),e)}getSurvey(e=!1){return null}getValueGetterContext(){const e=this.getSurvey();return e?e.getValueGetterContext():new ws({})}get isDesignMode(){const e=this.getSurvey();return!!e&&e.isDesignMode}get inSurvey(){return!!this.getSurvey(!0)}get bindings(){return this.bindingsValue||(this.bindingsValue=new eR(this)),this.bindingsValue}isBindingEmpty(){return!this.bindingsValue||this.bindingsValue.isEmpty()}checkBindings(e,t){}canUpdateBindings(){return!0}updateBindings(e,t){if(!(!this.bindingsValue||!this.canUpdateBindings())){var s=this.bindings.getValueNameByPropertyName(e);s&&this.updateBindingValue(s,t)}}updateBindingValue(e,t){}getTemplate(){return this.getType()}get isLoadingFromJson(){return this.isLoadingFromJsonValue||this.getIsLoadingFromJson()}getIsLoadingFromJson(){return this.loadingOwner&&this.loadingOwner.isLoadingFromJson?!0:this.isLoadingFromJsonValue}startLoadingFromJson(e){this.isLoadingFromJsonValue=!0,this.jsonObj=e}endLoadingFromJson(){this.isLoadingFromJsonValue=!1}toJSON(e){return new rt().toJsonObject(this,e)}fromJSON(e,t){new rt().toObject(e,this,t),this.onSurveyLoad()}onSurveyLoad(){}clone(){var e=B.createClass(this.getType());return e.fromJSON(this.toJSON()),e}getPropertyByName(e){const t=this.getType();return(!this.classMetaData||this.classMetaData.name!==t)&&(this.classMetaData=B.findClass(t)),this.classMetaData?this.classMetaData.findProperty(e):null}isPropertyVisible(e){const t=this.getPropertyByName(e);return t?t.isVisible("",this):!1}static createProgressInfo(){return{questionCount:0,answeredQuestionCount:0,requiredQuestionCount:0,requiredAnsweredQuestionCount:0}}getProgressInfo(){return de.createProgressInfo()}localeChanged(){}locStrsChanged(){if(this.arraysInfo)for(let t in this.arraysInfo){let s=this.arraysInfo[t];if(s&&s.isItemValues){var e=this.getPropertyValue(t);e&&de.itemValueLocStrChanged&&de.itemValueLocStrChanged(e)}}if(this.localizableStrings)for(let t in this.localizableStrings){let s=this.getLocalizableString(t);s&&s.strChanged()}}getPropertyValue(e,t,s){const i=this.getPropertyValueWithoutDefault(e);if(s&&Array.isArray(i)&&i.length===0&&i.isReset===!0)return delete i.isReset,this.setArrayPropertyDirectly(e,s(),!1),i;if(this.isValueUndefined(i)){const r=this.localizableStrings?this.localizableStrings[e]:void 0;if(r)return r.text;if(!this.isValueUndefined(t))return t;if(s){const o=s();if(o!==void 0)if(Array.isArray(o)){const l=this.createNewArray(e);return l.splice(0,0,...o),l}else return this.setPropertyValueDirectly(e,o,!0),o}const a=this.getDefaultPropertyValue(e);if(a!==void 0)return a}return i}isValueUndefined(e){return L.isValueUndefined(e)}getDefaultPropertyValue(e){const t=this.getPropertyByName(e);if(!t||t.isCustom&&this.isCreating)return;if(t.defaultValueFunc)return t.defaultValueFunc(this);const s=t.getDefaultValue(this);if(!this.isValueUndefined(s)&&!Array.isArray(s))return s;const i=this.localizableStrings?this.localizableStrings[e]:void 0;if(i&&i.localizationName)return this.getLocalizationString(i.localizationName);if(t.type=="boolean"||t.type=="switch")return!1;if(t.isCustom&&t.onGetValue)return t.onGetValue(this)}hasDefaultPropertyValue(e){return this.getDefaultPropertyValue(e)!==void 0}resetPropertyValue(e){const t=this.localizableStrings?this.localizableStrings[e]:void 0;t?(this.setLocalizableStringText(e,void 0),t.clear()):this.setPropertyValue(e,void 0)}getPropertyValueWithoutDefault(e){return this.getPropertyValueCore(this.propertyHash,e)}getPropertyValueCore(e,t){return this.isLoadingFromJson||de.collectDependency(this,t),this.getPropertyValueCoreHandler?this.getPropertyValueCoreHandler(e,t):e[t]}geValueFromHash(){return this.propertyHash.value}setPropertyValueCore(e,t,s,i){let r=!1;this.setPropertyValueCoreHandler?(r=this.isDisposedValue,r||this.setPropertyValueCoreHandler(e,t,s)):e[t]!==s&&(e[t]=s,!i&&this.onPropertyValueCoreChanged&&(r=this.isDisposedValue,r||this.onPropertyValueCoreChanged.fire(this,{name:t,newValue:s}))),r&&xs.disposedObjectChangedProperty(t,this.getType())}get isEditingSurveyElement(){var e=this.getSurvey();return!!e&&e.isEditingSurveyElement}iteratePropertiesHash(e){var t=[];for(var s in this.propertyHash)t.push(s);t.forEach(i=>e(this.propertyHash,i))}setPropertyValue(e,t){if(!this.isDisposedValue){if(!this.isLoadingFromJson){const i=this.getPropertyByName(e);i&&(t=i.settingValue(this,t))}var s=this.getPropertyValue(e);s&&Array.isArray(s)&&this.arraysInfo&&(!t||Array.isArray(t))?this.isTwoValueEquals(s,t)||this.setArrayPropertyDirectly(e,t):t!==s&&(this.setPropertyValueDirectly(e,t),this.isTwoValueEquals(s,t)||this.propertyValueChanged(e,s,t))}}setArrayPropertyDirectly(e,t,s=!0){var i=this.arraysInfo[e];this.setArray(e,this.getPropertyValue(e),t,i?i.isItemValues:!1,i?s&&i.onPush:null)}setPropertyValueDirectly(e,t,s){this.setPropertyValueCore(this.propertyHash,e,t,s)}clearPropertyValue(e){this.setPropertyValueCore(this.propertyHash,e,null),delete this.propertyHash[e]}onPropertyValueChangedCallback(e,t,s,i,r){}itemValuePropertyChanged(e,t,s,i){this.onItemValuePropertyChanged.fire(this,{obj:e,name:t,oldValue:s,newValue:i,propertyName:e.ownerPropertyName})}onPropertyValueChanged(e,t,s){}propertyValueChanged(e,t,s,i,r){if(!this.isLoadingFromJson&&(this.updateBindings(e,s),this.onPropertyValueChanged(e,t,s),this.onPropertyChanged.fire(this,{name:e,oldValue:t,newValue:s,arrayChanges:i,target:r}),this.doPropertyValueChangedCallback(e,t,s,i,this),this.checkConditionPropertyChanged(e),!!this.onPropChangeFunctions))for(var a=0;a<this.onPropChangeFunctions.length;a++)this.onPropChangeFunctions[a].name==e&&this.onPropChangeFunctions[a].func(s,i)}onBindingChanged(e,t){this.isLoadingFromJson||this.doPropertyValueChangedCallback("bindings",e,t)}get isInternal(){return!1}doPropertyValueChangedCallback(e,t,s,i,r){const a=l=>{l&&l.onPropertyValueChangedCallback&&l.onPropertyValueChangedCallback(e,t,s,r,i)};if(this.isInternal){a(this);return}r||(r=this);var o=this.getSurvey();o||(o=this),a(o),o!==this&&a(this)}addExpressionProperty(e,t,s){this.expressionInfo||(this.expressionInfo={}),this.expressionInfo[e]={onExecute:t,canRun:s}}getDataFilteredProperties(){return{}}runConditionCore(e){if(this.expressionInfo)for(var t in this.expressionInfo)this.runConditionItemCore(t,e)}canRunConditions(){return!this.isDesignMode}checkConditionPropertyChanged(e){!this.expressionInfo||!this.expressionInfo[e]||this.canRunConditions()&&this.runConditionItemCore(e,this.getDataFilteredProperties())}runConditionItemCore(e,t){const s=this.expressionInfo[e];this.getPropertyValue(e)&&(s.canRun&&!s.canRun(this)||this.runExpressionByProperty(e,t,r=>{s.onExecute(this,r)}))}doBeforeAsynRun(e){this.asynExpressionHash||(this.asynExpressionHash={});const t=!this.isAsyncExpressionRunning;this.asynExpressionHash[e]=!0,t&&this.onAsyncRunningChanged()}doAfterAsynRun(e){this.asynExpressionHash&&(delete this.asynExpressionHash[e],this.isAsyncExpressionRunning||this.onAsyncRunningChanged())}onAsyncRunningChanged(){}get isAsyncExpressionRunning(){return!!this.asynExpressionHash&&Object.keys(this.asynExpressionHash).length>0}createExpressionRunner(e){const t=new XE(e);return t.onBeforeAsyncRun=s=>{this.doBeforeAsynRun(s)},t.onAfterAsyncRun=s=>{this.doAfterAsynRun(s)},t}getExpressionFromSurvey(e){let t=this[e];if(!t)return"";const s=this.getSurvey();return s?s.beforeExpressionRunning(this,e,t):t}runExpressionByProperty(e,t,s,i){if(!this[e])return!1;const r=this.getExpressionFromSurvey(e);if(r){const a=this.getExpressionInfoByProperty(e,r),o=a.runner;!a.isRunning&&(!i||i(o))&&(a.isRunning=!0,o.onRunComplete=l=>{s(l),a.isRunning=!1},o.runContext(this.getValueGetterContext(),this.getPropertiesCopy(t,e)))}return!0}getPropertiesCopy(e,t){const s={};for(const i in e)s[i]=e[i];return t&&(s.propertyName=t),s}getExpressionByProperty(e){const t=this.getExpressionFromSurvey(e);return t?this.getExpressionInfoByProperty(e,t).runner:null}getExpressionInfoByProperty(e,t){this.runExpressionHash||(this.runExpressionHash={});let s=this.runExpressionHash[e];return s?s.runner.expression=t:(s={runner:this.createExpressionRunner(t)},this.runExpressionHash[e]=s),s}registerPropertyChangedHandlers(e,t,s=null){for(var i=0;i<e.length;i++)this.registerFunctionOnPropertyValueChanged(e[i],t,s)}unregisterPropertyChangedHandlers(e,t=null){for(var s=0;s<e.length;s++)this.unRegisterFunctionOnPropertyValueChanged(e[s],t)}registerFunctionOnPropertyValueChanged(e,t,s=null){if(this.onPropChangeFunctions||(this.onPropChangeFunctions=[]),s)for(var i=0;i<this.onPropChangeFunctions.length;i++){var r=this.onPropChangeFunctions[i];if(r.name==e&&r.key==s){r.func=t;return}}this.onPropChangeFunctions.push({name:e,func:t,key:s})}registerFunctionOnPropertiesValueChanged(e,t,s=null){this.registerPropertyChangedHandlers(e,t,s)}unRegisterFunctionOnPropertyValueChanged(e,t=null){if(this.onPropChangeFunctions)for(var s=0;s<this.onPropChangeFunctions.length;s++){var i=this.onPropChangeFunctions[s];if(i.name==e&&i.key==t)return this.onPropChangeFunctions.splice(s,1)}}unRegisterFunctionOnPropertiesValueChanged(e,t=null){this.unregisterPropertyChangedHandlers(e,t)}createCustomLocalizableObj(e){const t=this.getLocalizableString(e);return t||this.createLocalizableString(e,this,!1,!0)}getLocale(){const e=this.getSurvey();return e?e.getLocale():""}getLocalizationString(e){return bt(e,this.getLocale())}getLocalizationFormatString(e,...t){const s=this.getLocalizationString(e);return!s||!s.format?"":s.format(...t)}createLocString(e){return e.hasTranslation&&!e.translationKey&&(e.translationKey=e.name),this.createLocalizableString(e.name,e.owner,e.supportsMarkdown,e.translationKey)}createLocalizableString(e,t,s=!1,i=!1){t||(t=this);let r;i&&(r=i===!0?e:i);const a=new wt(t,s,e,r);a.onStrChanged=(l,u)=>{this.propertyValueChanged(e,l,u)},this.localizableStrings||(this.localizableStrings={}),this.localizableStrings[e]=a;const o=this.getPropertyByName(e);return a.disableLocalization=o&&o.isLocalizable===!1,a}removeLocalizableString(e){this.localizableStrings&&delete this.localizableStrings[e]}getLocalizableString(e){return this.localizableStrings?this.localizableStrings[e]:null}getLocalizableStringText(e,t=""){de.collectDependency(this,e);var s=this.getLocalizableString(e);if(!s)return"";var i=s.text;return i||t}setLocalizableStringText(e,t){let s=this.getLocalizableString(e);if(!s)return;s.text!=t&&(s.text=t)}addUsedLocales(e){if(this.localizableStrings)for(let t in this.localizableStrings){let s=this.getLocalizableString(t);s&&this.AddLocStringToUsedLocales(s,e)}if(this.arraysInfo)for(let t in this.arraysInfo){const s=this.getPropertyByName(t);if(!s||!s.isPropertySerializable(this))continue;let i=this.getPropertyValue(t);if(!(!i||!i.length))for(let r=0;r<i.length;r++){let a=i[r];a&&a.addUsedLocales&&a.addUsedLocales(e)}}}searchText(e,t){var s=[];this.getSearchableLocalizedStrings(s);for(var i=0;i<s.length;i++)s[i].setFindText(e)&&t.push({element:this,str:s[i]})}getSearchableLocalizedStrings(e){if(this.localizableStrings){let a=[];this.getSearchableLocKeys(a);for(var t=0;t<a.length;t++){let o=this.getLocalizableString(a[t]);o&&e.push(o)}}if(!this.arraysInfo)return;let s=[];this.getSearchableItemValueKeys(s);for(var t=0;t<s.length;t++){var i=this.getPropertyValue(s[t]);if(i)for(var r=0;r<i.length;r++)e.push(i[r].locText)}}getSearchableLocKeys(e){}getSearchableItemValueKeys(e){}AddLocStringToUsedLocales(e,t){for(var s=e.getLocales(),i=0;i<s.length;i++)t.indexOf(s[i])<0&&t.push(s[i])}createItemValues(e){var t=this,s=this.createNewArray(e,function(i){if(i.locOwner=t,i.ownerPropertyName=e,typeof i.getSurvey=="function"){const r=i.getSurvey();r&&typeof r.makeReactive=="function"&&r.makeReactive(i)}});return this.arraysInfo[e].isItemValues=!0,s}addOnArrayChangedCallback(e){this.onArrayChanged||(this.onArrayChanged=new Xt),this.onArrayChanged.add(e)}removeOnArrayChangedCallback(e){this.onArrayChanged&&(this.onArrayChanged.remove(e),this.onArrayChanged.isEmpty&&(this.onArrayChanged=void 0))}notifyArrayChanged(e,t,s){this.onArrayChanged&&this.onArrayChanged.fire(this,{arrayChanges:s,name:e,newValue:t,valueFromHash:this.propertyHash[e]})}addOnPropertyValueChangedCallback(e){this.onPropertyValueCoreChanged||(this.onPropertyValueCoreChanged=new Xt),this.onPropertyValueCoreChanged.add(e)}removeOnPropertyValueChangedCallback(e){this.onPropertyValueCoreChanged&&(this.onPropertyValueCoreChanged.remove(e),this.onPropertyValueCoreChanged.isEmpty&&(this.onPropertyValueCoreChanged=void 0))}createNewArrayCore(e){var t=null;return this.createArrayCoreHandler&&(t=this.createArrayCoreHandler(this.propertyHash,e)),t||(t=new Array,this.setPropertyValueCore(this.propertyHash,e,t)),t}ensureArray(e,t=null,s=null){if(!(this.arraysInfo&&this.arraysInfo[e]))return this.createNewArray(e,t,s)}createNewArray(e,t=null,s=null){var i=this.createNewArrayCore(e);this.arraysInfo||(this.arraysInfo={}),this.arraysInfo[e]={onPush:t,isItemValues:!1};var r=this;return i.push=function(a){var o=Object.getPrototypeOf(i).push.call(i,a);if(!r.isDisposedValue){t&&t(a,i.length-1);const l=new Dr(i.length-1,0,[a],[]);r.propertyValueChanged(e,i,i,l),r.notifyArrayChanged(e,i,l)}return o},i.shift=function(){var a=Object.getPrototypeOf(i).shift.call(i);if(!r.isDisposedValue&&a){s&&s(a);const o=new Dr(i.length-1,1,[],[]);r.propertyValueChanged(e,i,i,o),r.notifyArrayChanged(e,i,o)}return a},i.unshift=function(a){var o=Object.getPrototypeOf(i).unshift.call(i,a);if(!r.isDisposedValue){t&&t(a,i.length-1);const l=new Dr(0,0,[a],[]);r.propertyValueChanged(e,i,i,l),r.notifyArrayChanged(e,i,l)}return o},i.pop=function(){var a=Object.getPrototypeOf(i).pop.call(i);if(!r.isDisposedValue){s&&s(a);const o=new Dr(i.length-1,1,[],[]);r.propertyValueChanged(e,i,i,o),r.notifyArrayChanged(e,i,o)}return a},i.splice=function(a,o,...l){a||(a=0),o||(o=0);var u=Object.getPrototypeOf(i).splice.call(i,a,o,...l);if(l||(l=[]),!r.isDisposedValue){if(s&&u)for(var d=0;d<u.length;d++)s(u[d]);if(t)for(var d=0;d<l.length;d++)t(l[d],a+d);const h=new Dr(a,o,l,u);r.propertyValueChanged(e,i,i,h),r.notifyArrayChanged(e,i,h)}return u},i}getItemValueType(){}setArray(e,t,s,i,r){var a=[].concat(t);if(Object.getPrototypeOf(t).splice.call(t,0,t.length),s){for(var o=0;o<s.length;o++){var l=s[o];i&&de.createItemValue&&(l=de.createItemValue(l,this.getItemValueType())),Object.getPrototypeOf(t).push.call(t,l),r&&r(t[o])}delete t.isReset}else t.isReset=!0;const u=new Dr(0,a.length,t,a);this.propertyValueChanged(e,a,t,u),this.notifyArrayChanged(e,t,u)}isTwoValueEquals(e,t,s=!1,i=!1){return L.checkIfValuesEqual(e,t,{ignoreOrder:!1,caseSensitive:!s,trimStrings:i,doNotConvertNumbers:!0})}static copyObject(e,t){for(var s in t){var i=t[s];typeof i=="object"&&(i={},this.copyObject(i,t[s])),e[s]=i}}copyCssClasses(e,t){t&&(typeof t=="string"||t instanceof String?e.root=t:de.copyObject(e,t))}getValueInLowCase(e){return e&&typeof e=="string"?e.toLowerCase():e}getElementsInDesign(e=!1){return[]}get animationAllowed(){return this.getIsAnimationAllowed()}getIsAnimationAllowed(){return D.animationEnabled&&this.animationAllowedLock>=0&&!this.isLoadingFromJson&&!this.isDisposed&&(!!this.onElementRerendered||!this.supportOnElementRerenderedEvent)}blockAnimations(){this.animationAllowedLock--}releaseAnimations(){this.animationAllowedLock++}enableOnElementRerenderedEvent(){this.onElementRerenderedEventEnabled=!0}disableOnElementRerenderedEvent(){var e;(e=this.onElementRerendered)===null||e===void 0||e.fire(this,{isCancel:!0}),this.onElementRerenderedEventEnabled=!1}get onElementRerendered(){return this.supportOnElementRerenderedEvent&&this.onElementRerenderedEventEnabled?this._onElementRerendered:void 0}afterRerender(){var e;(e=this.onElementRerendered)===null||e===void 0||e.fire(this,{isCancel:!1})}}de.UniqueId=0,de.currentDependencis=void 0;class Dr{constructor(e,t,s,i){this.index=e,this.deleteCount=t,this.itemsToAdd=s,this.deletedItems=i}}class o1{get isEmpty(){return this.length===0}get length(){return this.callbacks?this.callbacks.length:0}fireByCreatingOptions(e,t){if(this.callbacks){for(var s=0;s<this.callbacks.length;s++)if(this.callbacks[s](e,t()),!this.callbacks)return}}fire(e,t){if(!this.callbacks)return;const s=[].concat(this.callbacks);for(var i=0;i<s.length;i++)if(s[i](e,t),!this.callbacks)return}clear(){this.callbacks=void 0}add(e){this.hasFunc(e)||(this.callbacks||(this.callbacks=new Array),this.callbacks.push(e),this.fireCallbackChanged())}remove(e){if(this.hasFunc(e)){var t=this.callbacks.indexOf(e,0);this.callbacks.splice(t,1),this.fireCallbackChanged()}}hasFunc(e){return this.callbacks==null?!1:this.callbacks.indexOf(e,0)>-1}fireCallbackChanged(){this.onCallbacksChanged&&this.onCallbacksChanged()}}class Xt extends o1{}function I(n,e,t,s){var i=arguments.length,r=i<3?e:s,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,s);else for(var o=n.length-1;o>=0;o--)(a=n[o])&&(r=(i<3?a(r):i>3?a(e,t,r):a(e,t))||r);return i>3&&r&&Object.defineProperty(e,t,r),r}class tR{constructor(e,t,s){this.container=e,this.model=t,this.afterInitializeCallback=s,this.resizeObserver=void 0,this.isInitialized=!1,this.isResizeObserverStarted=!1,this.getComputedStyle=i=>oe.getComputedStyle(i),this.isDisposed=!1,typeof ResizeObserver<"u"&&(this.resizeObserver=new ResizeObserver(i=>{he.requestAnimationFrame(()=>{this.isResizeObserverStarted=!0,this.process()})}),this.resizeObserver.observe(this.container.parentElement))}getDimensions(e){return{scroll:e.scrollWidth,offset:e.offsetWidth}}getAvailableSpace(){const e=this.getComputedStyle(this.container);let t=this.container.offsetWidth;return e.boxSizing==="border-box"&&(t-=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight)),t}getGap(){const e=this.getComputedStyle(this.container);if(e.display=="flex"){const t=parseFloat(e.rowGap);return isNaN(t)?0:t}return 0}calcItemSize(e){return e.offsetWidth||e.getBoundingClientRect().width}updateItemsDimensions(e){if(!this.container)return;const t=this.isInitialized?this.model.renderedActions.filter(r=>r.needUpdateMaxDimension||r.needUpdateMinDimension):this.model.renderedActions;let s=t.length;s==0&&e();const i=()=>{--s<=0&&e()};t.forEach(r=>{const a=!this.isInitialized||r.needUpdateMaxDimension,l=!this.isInitialized||r.needUpdateMinDimension?a?void 0:"small":"large";r.updateDimensions(u=>this.calcItemSize(u),()=>{r.needUpdateMaxDimension=!1,r.needUpdateMinDimension=!1,i()},l)})}get isContainerVisible(){return!!this.container&&Ed(this.container)}shouldProcessResponsiveness(){return this.isContainerVisible&&!this.model.isResponsivenessDisabled&&!this.isDisposed}process(){this.shouldProcessResponsiveness()&&this.updateItemsDimensions(()=>{this.shouldProcessResponsiveness()&&this.model.fit({availableSpace:this.getAvailableSpace(),gap:this.getGap()}),this.isInitialized||(this.isInitialized=!0,this.afterInitializeCallback&&this.afterInitializeCallback())})}update(e){this.isResizeObserverStarted&&(this.model.isResponsivenessDisabled||(e&&(this.isInitialized=!1),this.process()))}dispose(){this.isDisposed=!0,this.resizeObserver&&this.resizeObserver.disconnect(),this.isResizeObserverStarted=!1,this.resizeObserver=void 0,this.container=void 0}}class j{constructor(){this.classes=[]}isEmpty(){return this.toString()===""}append(e,t=!0){return e&&t&&(typeof e=="string"&&(e=e.trim()),this.classes.push(e)),this}toString(){return this.classes.join(" ")}}function l1(n){let e=!1,t=!1,s;const i=()=>{t=!0,s=void 0};return{run:((...r)=>{t=!1,s=r,e||(e=!0,queueMicrotask(()=>{t||n.apply(this,s),s=void 0,t=!1,e=!1}))}),cancel:i,getLastArguments:()=>s,flushSync:()=>{!t&&e&&(n.apply(this,s),i())}}}let Os={root:"sv-action-bar",defaultSizeMode:"sv-action-bar--default-size-mode",smallSizeMode:"sv-action-bar--small-size-mode",item:"sv-action-bar-item",itemWithTitle:"",itemAsIcon:"sv-action-bar-item--icon",itemActive:"sv-action-bar-item--active",itemPressed:"sv-action-bar-item--pressed",itemIcon:"sv-action-bar-item__icon",itemTitle:"sv-action-bar-item__title",itemTitleWithIcon:"sv-action-bar-item__title--with-icon"};class Vt extends de{constructor(){super(...arguments),this.id=Vt.ContainerID++,this.visibleActions=[],this.sizeMode="default",this.raiseUpdateCallback=l1(e=>{this.update(e)}),this.onActionPropertyChangedCallback=this.onActionPropertyChanged.bind(this)}getMarkdownHtml(e,t,s){return this.locOwner?this.locOwner.getMarkdownHtml(e,t,s):void 0}getRenderer(e){return this.locOwner?this.locOwner.getRenderer(e):null}getRendererContext(e){return this.locOwner?this.locOwner.getRendererContext(e):e}getProcessedText(e){return this.locOwner?this.locOwner.getProcessedText(e):e}getLocale(){return this.locOwner?this.locOwner.getLocale():""}getRenderedActions(){return this.visibleActions}locStrsChanged(){super.locStrsChanged(),this.actions.forEach(e=>{e.locTitle&&e.locTitle.strChanged(),e.locStrsChanged()})}flushUpdates(){this.raiseUpdateCallback.flushSync()}raiseUpdate(e){var t;const s=this.raiseUpdateCallback.getLastArguments(),i=(t=s&&s[0])!==null&&t!==void 0?t:{};this.raiseUpdateCallback.run(this.mergeUpdateOptions(e,i))}mergeUpdateOptions(e,t){const s=Object.assign({},e);return s.needUpdateActions=!!s.needUpdateActions||!!t.needUpdateActions,s.needUpdateIsEmpty=!!s.needUpdateIsEmpty||!!t.needUpdateIsEmpty,s}update(e){e?.needUpdateActions&&this.updateVisibleActions(),e?.needUpdateIsEmpty&&this.updateIsEmpty()}updateVisibleActions(){this.visibleActions=this.getVisibleActions()}updateIsEmpty(){this.isEmpty=this.getIsEmpty()}getIsEmpty(){return this.visibleActions.length<=0}getVisibleActions(){return this.actions.filter(e=>e.visible!==!1)}onSet(){this.actions.forEach(e=>{this.patchAction(e)})}onPush(e){this.patchAction(e),this.raiseUpdate({needUpdateActions:!0,needUpdateIsEmpty:!0})}onRemove(e){this.unPatchAction(e),this.raiseUpdate({needUpdateActions:!0,needUpdateIsEmpty:!0})}onActionPropertyChanged(e,t){t.name=="_visible"&&this.raiseUpdate({needUpdateActions:!0,needUpdateIsEmpty:!0})}patchAction(e){this.setActionCssClasses(e),e.owner=this,e.onPropertyChanged.add(this.onActionPropertyChangedCallback)}unPatchAction(e){e.owner=null,e.onPropertyChanged.remove(this.onActionPropertyChangedCallback)}setActionCssClasses(e){e.cssClasses=this.cssClasses}get hasActions(){return(this.actions||[]).length>0}get hasVisibleActions(){return!this.isEmpty}get renderedActions(){return this.getRenderedActions()}getRootStyle(){}getRootCss(){const e=this.sizeMode==="small"?this.cssClasses.smallSizeMode:this.cssClasses.defaultSizeMode;return new j().append(this.cssClasses.root+(e?" "+e:"")+(this.containerCss?" "+this.containerCss:"")).append(this.cssClasses.root+"--empty",this.isEmpty).toString()}getDefaultCssClasses(){return Os}getAllActions(){return this.actions}setCssClasses(e,t=!0){this.cssClassesValue={},t&&this.copyCssClasses(this.cssClassesValue,this.getDefaultCssClasses()),xn(e,this.cssClasses),this.getAllActions().forEach(s=>{this.setActionCssClasses(s)})}set cssClasses(e){this.setCssClasses(e)}get cssClasses(){return this.cssClassesValue||(this.cssClassesValue=this.getDefaultCssClasses()),this.cssClassesValue}createAction(e){return e instanceof Je?e:this.createActionCore(e)}createActionCore(e){return new xe(e)}addAction(e,t=!0){const s=this.createAction(e);if(t&&!this.isActionVisible(s))return s;const i=[].concat(this.actions,s);return this.sortItems(i),this.actions=i,s}removeActionById(e){const t=this.getActionIndexById(e);return t<0?!1:(this.actions.splice(t,1),!0)}setItems(e,t=!0){const s=[];e.forEach(i=>{(!t||this.isActionVisible(i))&&s.push(this.createAction(i))}),t&&this.sortItems(s),this.actions=s}sortItems(e){this.hasSetVisibleIndex(e)&&e.sort(this.compareByVisibleIndex)}hasSetVisibleIndex(e){for(let t=0;t<e.length;t++){const s=e[t].visibleIndex;if(s!==void 0&&s>=0)return!0}return!1}compareByVisibleIndex(e,t){return e.visibleIndex-t.visibleIndex}isActionVisible(e){return e.visibleIndex>=0||e.visibleIndex===void 0}popupAfterShowCallback(e){}mouseOverHandler(e){e.isHovered=!0;let t=!1,s=!1;if(this.actions.forEach(i=>{i===e&&e.popupModel&&(t=!0),i.popupModel&&i.popupModel.isVisible&&(s=!0)}),t){const i=s?Math.max(this.subItemsShowDelay,this.subItemsHideDelay):this.subItemsShowDelay;e.showPopupDelayed(i),this.popupAfterShowCallback(e)}}initResponsivityManager(e,t){}resetResponsivityManager(){}getActionById(e){const t=this.getActionIndexById(e);return t>-1?this.actions[t]:null}getActionIndexById(e){for(var t=0;t<this.actions.length;t++)if(this.actions[t].id===e)return t;return-1}dispose(){super.dispose(),this.resetResponsivityManager(),this.actions.forEach(e=>e.dispose()),this.actions.length=0}}Vt.ContainerID=1,I([Ft({})],Vt.prototype,"visibleActions",void 0),I([Ft({onSet:(n,e)=>{e.onSet()},onPush:(n,e,t)=>{t.onPush(n)},onRemove:(n,e,t)=>{t.onRemove(n)}})],Vt.prototype,"actions",void 0),I([R({})],Vt.prototype,"containerCss",void 0),I([R({defaultValue:!0})],Vt.prototype,"isEmpty",void 0),I([R({defaultValue:300})],Vt.prototype,"subItemsShowDelay",void 0),I([R({defaultValue:300})],Vt.prototype,"subItemsHideDelay",void 0);class Or{static focusElement(e){e&&e.focus()}static visibility(e){var t=oe.getComputedStyle(e);return t.display==="none"||t.visibility==="hidden"?!1:e.parentElement?this.visibility(e.parentElement):!0}static getNextElementPreorder(e){const t=e.nextElementSibling?e.nextElementSibling:e.parentElement.firstElementChild;return this.visibility(t)?t:this.getNextElementPreorder(t)}static getNextElementPostorder(e){const t=e.previousElementSibling?e.previousElementSibling:e.parentElement.lastElementChild;return this.visibility(t)?t:this.getNextElementPostorder(t)}static hasHorizontalScroller(e){return e?e.scrollWidth>e.offsetWidth:!1}static hasVerticalScroller(e){return e?e.scrollHeight>e.offsetHeight:!1}}let Cd=!1,u1=null;typeof navigator<"u"&&navigator&&he.isAvailable()&&(u1=navigator.userAgent||navigator.vendor||he.hasOwn("opera")),(function(n){n&&(navigator.platform==="MacIntel"&&navigator.maxTouchPoints>0||navigator.platform==="iPad"||/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substring(0,4)))&&(Cd=!0)})(u1);const bd=Cd||!1;var h1={get isTouch(){return!this.hasMouse&&this.hasTouchEvent},get hasTouchEvent(){return he.isAvailable()&&(he.hasOwn("ontouchstart")||navigator.maxTouchPoints>0)},hasMouse:!0};const sR=he.matchMedia;h1.hasMouse=rR(sR);let vt=h1.isTouch;function iR(n,e,t=600){const s=n||he.getInnerWidth(),i=e||he.getInnerHeight();return Math.min(s,i)>=t}function rR(n){if(!n||bd)return!1;const e=n("(pointer:fine)"),t=n("(any-hover:hover)");return!!e&&e.matches||!!t&&t.matches}let nR={root:"sv-list__container",item:"sv-list__item",searchClearButtonIcon:"sv-list__filter-clear-button",loadingIndicator:"sv-list__loading-indicator",itemSelected:"sv-list__item--selected",itemGroup:"sv-list__item--group",itemGroupSelected:"sv-list__item--group-selected",itemWithIcon:"sv-list__item--with-icon",itemDisabled:"sv-list__item--disabled",itemFocused:"sv-list__item--focused",itemHovered:"sv-list__item--hovered",itemTextWrap:"sv-list__item-text--wrap",itemIcon:"sv-list__item-icon",itemMarkerIcon:"sv-list-item__marker-icon",itemSeparator:"sv-list__item-separator",itemBody:"sv-list__item-body",itemsContainer:"sv-list",itemsContainerFiltering:"sv-list--filtering",filter:"sv-list__filter",filterIcon:"sv-list__filter-icon",filterInput:"sv-list__input",emptyContainer:"sv-list__empty-container",emptyText:"sv-list__empty-text"};class lt extends Vt{hasText(e,t){if(!t)return!0;const s=e.title||"";if(this.onTextSearchCallback)return this.onTextSearchCallback(e,t);let i=s.toLocaleLowerCase();return i=D.comparator.normalizeTextCallback(i,"filter"),i.indexOf(t.toLocaleLowerCase())>-1}isItemVisible(e){return e.id===this.loadingIndicator.id||this.disableSearch?e.visible:e.visible&&this.hasText(e,this.filterString)}getRenderedActions(){let e=super.getRenderedActions();if(this.filterString){let t=[];return e.forEach(s=>{t.push(s),s.items&&s.items.forEach(i=>{const r=new xe(i);r.iconName||(r.iconName=s.iconName),t.push(r)})}),t}return e}get visibleItems(){return this.actions.filter(e=>this.isItemVisible(e))}onFilterStringChanged(e){this.onFilterStringChangedCallback&&this.onFilterStringChangedCallback(e),this.raiseUpdate({needUpdateIsEmpty:!0})}getIsEmpty(){return!this.renderedActions.some(e=>this.isItemVisible(e))}scrollToItem(e,t=0){setTimeout(()=>{if(!this.listContainerHtmlElement)return;const s=this.listContainerHtmlElement.querySelector(ls(e));s&&setTimeout(()=>{s.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})},t)},t)}constructor(e,t,s,i,r){if(super(),this.onSelectionChanged=t,this.allowSelection=s,this.elementId=r,this.onItemClick=a=>{if(this.isItemDisabled(a))return;this.isExpanded=!1,this.allowSelection&&(this.selectedItem=a),this.onSelectionChanged&&this.onSelectionChanged(a);const o=a.action;o&&o(a)},this.onItemHover=a=>{this.mouseOverHandler(a)},this.isItemDisabled=a=>a.enabled!==void 0&&!a.enabled,this.getA11yItemAriaSelected=a=>{if(this.listItemRole=="option")return this.isItemSelected(a)?"true":"false"},this.getA11yItemAriaChecked=a=>{if(this.listItemRole=="menuitemradio")return this.isItemSelected(a)?"true":"false"},this.isItemSelected=a=>this.areSameItems(this.selectedItem,a),this.isItemFocused=a=>this.areSameItems(this.focusedItem,a),this.getListClass=()=>new j().append(this.cssClasses.itemsContainer).append(this.cssClasses.itemsContainerFiltering,!!this.filterString&&this.visibleActions.length!==this.visibleItems.length).toString(),this.getItemClass=a=>{const o=this.isItemSelected(a);return new j().append(this.cssClasses.item).append(this.cssClasses.itemWithIcon,!!a.iconName).append(this.cssClasses.itemDisabled,this.isItemDisabled(a)).append(this.cssClasses.itemFocused,this.isItemFocused(a)).append(this.cssClasses.itemSelected,!a.hasSubItems&&o).append(this.cssClasses.itemGroup,a.hasSubItems).append(this.cssClasses.itemGroupSelected,a.hasSubItems&&o).append(this.cssClasses.itemHovered,a.isHovered).append(this.cssClasses.itemTextWrap,this.textWrapEnabled).append(a.css).toString()},this.getItemStyle=a=>({"--sjs-list-item-level":(a.level||0)+1}),Object.keys(e).indexOf("items")!==-1){const a=e;Object.keys(a).forEach(o=>{switch(o){case"items":this.setItems(a.items);break;case"onFilterStringChangedCallback":this.setOnFilterStringChangedCallback(a.onFilterStringChangedCallback);break;case"onTextSearchCallback":this.setOnTextSearchCallback(a.onTextSearchCallback);break;default:this[o]=a[o]}}),this.updateActionsIds()}else this.setItems(e),this.selectedItem=i}setOnFilterStringChangedCallback(e){this.onFilterStringChangedCallback=e}setOnTextSearchCallback(e){this.onTextSearchCallback=e}setItems(e,t=!0){super.setItems(e,t),this.updateActionsIds(),!this.isAllDataLoaded&&this.actions.length&&this.actions.push(this.loadingIndicator)}updateActionsIds(){this.elementId&&this.actions.forEach(e=>{e.elementId=this.elementId+e.id})}setSearchEnabled(e){this.searchEnabled=e,this.showSearchClearButton=e}onSet(){this.showFilter=this.searchEnabled&&(this.forceShowFilter||(this.actions||[]).length>lt.MINELEMENTCOUNT),super.onSet()}getDefaultCssClasses(){return nR}popupAfterShowCallback(e){this.addScrollEventListener(()=>{e.hidePopup()})}onItemLeave(e){e.hidePopupDelayed(this.subItemsHideDelay)}areSameItems(e,t){return this.areSameItemsCallback?this.areSameItemsCallback(e,t):!!e&&!!t&&e.id==t.id}get a11ya11y_input_ariaLabel(){return this.listAriaLabel}get filterStringPlaceholder(){return this.getLocalizationString("filterStringPlaceholder")}get emptyMessage(){return this.isAllDataLoaded?this.getLocalizationString("emptyMessage"):this.getLocalizationString("loadingData")}get scrollableContainer(){return this.listContainerHtmlElement.querySelector(ls(this.cssClasses.itemsContainer))}get loadingIndicator(){if(!this.loadingIndicatorValue){const e=new xe({id:"loadingIndicator",title:this.getLocalizationString("loadingPage"),action:()=>{},css:this.cssClasses.loadingIndicator});e.initLoadingIndicatorVisibilityObserver(this.loadingIndicatorVisibilityObserver),this.loadingIndicatorValue=e}return this.loadingIndicatorValue}goToItems(e){if(e.key==="ArrowDown"||e.keyCode===40){const s=e.target.parentElement.parentElement.querySelector("ul"),i=VR(s);s&&i&&(Or.focusElement(i),e.preventDefault())}}onMouseMove(e){this.resetFocusedItem()}onKeyDown(e){const t=e.target;e.key==="ArrowDown"||e.keyCode===40?(Or.focusElement(Or.getNextElementPreorder(t)),e.preventDefault()):(e.key==="ArrowUp"||e.keyCode===38)&&(Or.focusElement(Or.getNextElementPostorder(t)),e.preventDefault())}onPointerDown(e,t){}refresh(){this.filterString==""&&this.raiseUpdate({needUpdateIsEmpty:!0}),this.resetFocusedItem()}onClickSearchClearButton(e){e.currentTarget.parentElement.querySelector("input").focus(),this.refresh()}resetFocusedItem(){this.focusedItem=void 0}focusFirstVisibleItem(){vt||(this.focusedItem=this.visibleItems[0])}focusLastVisibleItem(){this.focusedItem=this.visibleItems[this.visibleItems.length-1]}initFocusedItem(){this.focusedItem=this.visibleItems.filter(e=>e.visible&&this.isItemSelected(e))[0],this.focusedItem||this.focusFirstVisibleItem()}focusNextVisibleItem(){if(!this.focusedItem)this.initFocusedItem();else{const e=this.visibleItems,t=e.indexOf(this.focusedItem),s=e[t+1];s?this.focusedItem=s:this.focusFirstVisibleItem()}}focusPrevVisibleItem(){if(!this.focusedItem)this.initFocusedItem();else{const e=this.visibleItems,t=e.indexOf(this.focusedItem),s=e[t-1];s?this.focusedItem=s:this.focusLastVisibleItem()}}selectFocusedItem(){this.focusedItem&&this.onItemClick(this.focusedItem)}initListContainerHtmlElement(e){this.listContainerHtmlElement=e}onItemRended(e,t){this.isAllDataLoaded||(e===this.actions[this.actions.length-1]&&this.listContainerHtmlElement&&(this.hasVerticalScroller=Or.hasVerticalScroller(this.scrollableContainer)),e.id===this.loadingIndicator.id&&t&&this.loadingIndicator.intersectionVisibilityObserver&&this.loadingIndicator.intersectionVisibilityObserver.observe(t))}scrollToFocusedItem(){this.scrollToItem(this.cssClasses.itemFocused)}scrollToSelectedItem(){this.selectedItem&&this.selectedItem.items&&this.selectedItem.items.length>0?this.scrollToItem(this.cssClasses.itemGroupSelected,110):this.scrollToItem(this.cssClasses.itemSelected,110)}setLoadingIndicatorVisibilityObserver(e){e&&(this.loadingIndicatorVisibilityObserver=e)}addScrollEventListener(e){e&&(this.removeScrollEventListener(),this.scrollHandler=e),this.scrollHandler&&this.scrollableContainer.addEventListener("scroll",this.scrollHandler)}removeScrollEventListener(){this.scrollHandler&&this.scrollableContainer.removeEventListener("scroll",this.scrollHandler)}dispose(){super.dispose(),this.loadingIndicatorValue&&this.loadingIndicatorValue.dispose(),this.listContainerHtmlElement=void 0}}lt.INDENT=16,lt.MINELEMENTCOUNT=10,I([R({defaultValue:!0,onSet:(n,e)=>{e.onSet()}})],lt.prototype,"searchEnabled",void 0),I([R({defaultValue:!1})],lt.prototype,"showFilter",void 0),I([R({defaultValue:!1})],lt.prototype,"forceShowFilter",void 0),I([R({defaultValue:!1})],lt.prototype,"isExpanded",void 0),I([R({})],lt.prototype,"selectedItem",void 0),I([R()],lt.prototype,"focusedItem",void 0),I([R({onSet:(n,e)=>{e.onFilterStringChanged(e.filterString)}})],lt.prototype,"filterString",void 0),I([R({defaultValue:!1})],lt.prototype,"hasVerticalScroller",void 0),I([R({defaultValue:!0})],lt.prototype,"isAllDataLoaded",void 0),I([R({defaultValue:!1})],lt.prototype,"showSearchClearButton",void 0),I([R({defaultValue:!0})],lt.prototype,"renderElements",void 0),I([R({defaultValue:!1})],lt.prototype,"textWrapEnabled",void 0),I([R({defaultValue:"sv-list-item-content"})],lt.prototype,"itemComponent",void 0),I([R({defaultValue:"listbox"})],lt.prototype,"listRole",void 0),I([R({defaultValue:"option"})],lt.prototype,"listItemRole",void 0),I([R()],lt.prototype,"listAriaLabel",void 0),I([R({defaultValue:!1})],lt.prototype,"disableSearch",void 0);class Mt extends de{refreshInnerModel(){const e=this.contentComponentData.model;e&&e.refresh&&e.refresh()}constructor(e,t,s){if(super(),this.focusFirstInputSelector="",this.onCancel=()=>{},this.onApply=()=>!0,this.onHide=()=>{},this.onShow=()=>{},this.onBlur=()=>{},this.onDispose=()=>{},this.onVisibilityChanged=this.addEvent(),this.onFooterActionsCreated=this.addEvent(),this.onRecalculatePosition=this.addEvent(),this.contentComponentName=e,this.contentComponentData=t,s)for(var i in s)this[i]=s[i]}get isVisible(){return this.getPropertyValue("isVisible",!1)}set isVisible(e){this.isVisible!==e&&(this.setPropertyValue("isVisible",e),this.onVisibilityChanged.fire(this,{model:this,isVisible:e}))}toggleVisibility(){this.isVisible=!this.isVisible}show(){this.isVisible||(this.isVisible=!0)}hide(){this.isVisible&&(this.isVisible=!1)}recalculatePosition(e){this.onRecalculatePosition.fire(this,{isResetHeight:e})}updateFooterActions(e){const t={actions:e};return this.onFooterActionsCreated.fire(this,t),t.actions}getDisplayMode(){if(this.isModal)return this.displayMode==="popup"?"modal-popup":"modal-overlay";if(this.displayMode==="popup")return"menu-popup";{let e;switch(this.overlayDisplayMode){case"plain":{e="menu-popup";break}case"dropdown-overlay":{e="menu-overlay";break}case"tablet-dropdown-overlay":{e="menu-popup-overlay";break}case"auto":{vt?e="menu-popup-overlay":e="menu-popup";break}}return e}}updateDisplayMode(e){let t,s;switch(e){case"dropdown":{t="popup",s="auto";break}case"popup":{t="overlay",s="tablet-dropdown-overlay";break}case"overlay":{t="overlay",s="dropdown-overlay";break}}if(this.displayMode!==t){const i=e==="dropdown";this.setWidthByTarget=i,this.isFocusedContent=!i}return this.displayMode!==t||this.overlayDisplayMode!==s?(this.displayMode=t,this.overlayDisplayMode=s,!0):!1}onHiding(){this.refreshInnerModel(),this.onHide()}dispose(){super.dispose(),this.onDispose()}}I([R()],Mt.prototype,"contentComponentName",void 0),I([R()],Mt.prototype,"contentComponentData",void 0),I([R({defaultValue:"bottom"})],Mt.prototype,"verticalPosition",void 0),I([R({defaultValue:"left"})],Mt.prototype,"horizontalPosition",void 0),I([R({defaultValue:!0})],Mt.prototype,"showPointer",void 0),I([R({defaultValue:!1})],Mt.prototype,"isModal",void 0),I([R({defaultValue:!0})],Mt.prototype,"canShrink",void 0),I([R({defaultValue:!0})],Mt.prototype,"isFocusedContent",void 0),I([R({defaultValue:!0})],Mt.prototype,"isFocusedContainer",void 0),I([R({defaultValue:""})],Mt.prototype,"cssClass",void 0),I([R({defaultValue:""})],Mt.prototype,"title",void 0),I([R({defaultValue:"auto"})],Mt.prototype,"overlayDisplayMode",void 0),I([R({defaultValue:"popup"})],Mt.prototype,"displayMode",void 0),I([R({defaultValue:"flex"})],Mt.prototype,"positionMode",void 0);function aR(n,e,t){var s;const i=e.onSelectionChanged;e.onSelectionChanged=(l,...u)=>{o.hasTitle&&(o.title=l.title),i&&i(l,u)};const r=d1(e,t);r.getTargetCallback=oR;const a=Object.assign({},n,{component:"sv-action-bar-item-dropdown",popupModel:r,action:(l,u)=>{n.action&&n.action(),r.isFocusedContent=r.isFocusedContent||!u,r.show()}}),o=new xe(a);return o.data=(s=r.contentComponentData)===null||s===void 0?void 0:s.model,o}function d1(n,e){n.listRole||(n.listRole="menu"),n.listItemRole||(n.listItemRole=n.allowSelection?"menuitemradio":"menuitem");const t=new lt(n);t.onSelectionChanged=r=>{n.onSelectionChanged&&n.onSelectionChanged(r),i.hide()};const s=e||{};s.onDispose=()=>{t.dispose()};const i=new Mt("sv-list",{model:t},s);return i.isFocusedContent=t.showFilter,i.onShow=()=>{s.onShow&&s.onShow(),t.scrollToSelectedItem()},i.onHide=()=>{s.onHide&&s.onHide(),t.filterString=""},i}function oR(n){return n?.previousElementSibling}class Je extends de{constructor(){super(...arguments),this.rendredIdValue=Je.getNextRendredId()}static getNextRendredId(){return Je.renderedId++}get data(){return this._data}set data(e){this._data=e}get id(){return this.getId()}set id(e){this.setId(e)}getId(){return this.idValue}setId(e){this.idValue=e}addVisibilityChangedCallback(e){}removeVisibilityChangedCallback(e){}get renderedId(){return this.rendredIdValue}get owner(){return this.ownerValue}set owner(e){e!==this.owner&&(this.ownerValue=e,this.locStrsChanged())}get visible(){return this.getVisible()}set visible(e){this.setVisible(e)}get enabled(){return this.getEnabled()}set enabled(e){this.setEnabled(e)}get component(){return this.getComponent()}set component(e){this.setComponent(e)}get locTitle(){return this.getLocTitle()}set locTitle(e){this.setLocTitle(e)}get title(){return this.getTitle()}set title(e){this.setTitle(e)}get titles(){return this.locTitle.getJson()}set titles(e){this.locTitle.setJson(e)}set cssClasses(e){this.cssClassesValue=e}get cssClasses(){return this.cssClassesValue||Os}get isVisible(){return this.visible&&this.mode!=="popup"&&this.mode!=="removed"}get disabled(){return this.enabled!==void 0&&!this.enabled}get canShrink(){return!this.disableShrink&&!!this.iconName}get hasTitle(){return(this.mode!="small"&&(this.showTitle||this.showTitle===void 0)||!this.iconName)&&!!this.title}get hasSubItems(){return!!this.items&&this.items.length>0}getActionBarItemTitleCss(){return new j().append(this.cssClasses.itemTitle).append(this.cssClasses.itemTitleWithIcon,!!this.iconName).toString()}getActionBarItemCss(){const e=this.hasTitle;return new j().append(this.cssClasses.item).append(this.cssClasses.itemWithTitle,e).append(this.cssClasses.itemAsIcon,!e).append(this.cssClasses.itemActive,!!this.active).append(this.cssClasses.itemPressed,!!this.pressed).append(this.innerCss).toString()}getActionRootCss(){return new j().append("sv-action").append(this.css).append("sv-action--space",this.needSpace).append("sv-action--hidden",!this.isVisible).toString()}getTooltip(){return this.tooltip||this.title}getIsTrusted(e){return e.originalEvent?e.originalEvent.isTrusted:e.isTrusted}showPopup(){this.popupModel&&this.popupModel.show()}hidePopup(){this.popupModel&&this.popupModel.hide()}clearPopupTimeouts(){this.showPopupTimeout&&clearTimeout(this.showPopupTimeout),this.hidePopupTimeout&&clearTimeout(this.hidePopupTimeout)}showPopupDelayed(e){this.clearPopupTimeouts(),this.showPopupTimeout=setTimeout(()=>{this.clearPopupTimeouts(),this.showPopup()},e)}hidePopupDelayed(e){var t;!((t=this.popupModel)===null||t===void 0)&&t.isVisible?(this.clearPopupTimeouts(),this.hidePopupTimeout=setTimeout(()=>{this.clearPopupTimeouts(),this.hidePopup(),this.isHovered=!1},e)):(this.clearPopupTimeouts(),this.isHovered=!1)}}Je.renderedId=1,I([R()],Je.prototype,"tooltip",void 0),I([R()],Je.prototype,"showTitle",void 0),I([R()],Je.prototype,"innerCss",void 0),I([R()],Je.prototype,"active",void 0),I([R()],Je.prototype,"pressed",void 0),I([R()],Je.prototype,"popupModel",void 0),I([R()],Je.prototype,"needSeparator",void 0),I([R()],Je.prototype,"template",void 0),I([R({defaultValue:"large"})],Je.prototype,"mode",void 0),I([R()],Je.prototype,"visibleIndex",void 0),I([R()],Je.prototype,"disableTabStop",void 0),I([R()],Je.prototype,"disableShrink",void 0),I([R()],Je.prototype,"disableHide",void 0),I([R({defaultValue:!1})],Je.prototype,"needSpace",void 0),I([R()],Je.prototype,"ariaChecked",void 0),I([R()],Je.prototype,"ariaExpanded",void 0),I([R({defaultValue:"button"})],Je.prototype,"ariaRole",void 0),I([R()],Je.prototype,"iconName",void 0),I([R({defaultValue:24})],Je.prototype,"iconSize",void 0),I([R()],Je.prototype,"markerIconName",void 0),I([R()],Je.prototype,"css",void 0),I([R({defaultValue:!1})],Je.prototype,"isPressed",void 0),I([R({defaultValue:!1})],Je.prototype,"isHovered",void 0);class xe extends Je{constructor(e){super(),this.locTitleChanged=()=>{const i=this.locTitle.renderedHtml;this.setPropertyValue("_title",i||void 0)},this.needUpdateMaxDimension=!1,this.needUpdateMinDimension=!1;const t=e instanceof xe?e.innerItem:e;if(this.innerItem=t,this.locTitle=t?t.locTitle:null,t)for(var s in t)s==="locTitle"||s==="title"&&this.title||(this[s]=t[s]);this.locTitleName&&this.locTitleChanged(),this.locStrChangedInPopupModel()}createLocTitle(){return this.createLocalizableString("title",this,!0)}setSubItems(e){this.markerIconName="icon-next_16x16",this.items=[...e.items],this.popupModel?this.popupModel.contentComponentData.model.setItems(this.items):this.createPopupForSubitems(e),this.component=this.getGroupComponentName()}createPopupForSubitems(e){const t=Object.assign({},e);t.searchEnabled=!1;const s=d1(t,{horizontalPosition:"right",showPointer:!1,canShrink:!1});s.cssClass="sv-popup-inner",this.popupModel=s}getId(){return this.getPropertyValue("id")}setId(e){this.setPropertyValue("id",e)}getLocTitle(){return this.locTitleValue}setLocTitle(e){!e&&!this.locTitleValue&&(e=this.createLocTitle()),this.locTitleValue&&this.locTitleValue.onStringChanged.remove(this.locTitleChanged),this.locTitleValue=e,this.locTitleValue.onStringChanged.add(this.locTitleChanged),this.locTitleChanged()}getTitle(){return this._title}setTitle(e){this._title=e}get locTitleName(){return this.locTitle.localizationName}set locTitleName(e){this.locTitle.localizationName=e}locStrsChanged(){super.locStrsChanged(),this.locTooltipChanged(),this.locStrChangedInPopupModel()}doAction(e){const t=e.originalEvent?e.originalEvent:e;return this.action(this,t.isTrusted),t.preventDefault(),t.stopPropagation(),!0}doMouseDown(e){this.isMouseDown=!0}doFocus(e){if(this.onFocus){const t=e.originalEvent?e.originalEvent:e;this.onFocus(this.isMouseDown,t)}this.isMouseDown=!1}locStrChangedInPopupModel(){if(!this.popupModel||!this.popupModel.contentComponentData||!this.popupModel.contentComponentData.model)return;const e=this.popupModel.contentComponentData.model;Array.isArray(e.actions)&&e.actions.forEach(s=>{s.locStrsChanged&&s.locStrsChanged()})}locTooltipChanged(){this.locTooltipName&&(this.tooltip=bt(this.locTooltipName,this.locTitle.locale))}getLocale(){return this.owner?this.owner.getLocale():""}getMarkdownHtml(e,t,s){return this.owner?this.owner.getMarkdownHtml(e,t,s):void 0}getProcessedText(e){return this.owner?this.owner.getProcessedText(e):e}getRenderer(e){return this.owner?this.owner.getRenderer(e):null}getRendererContext(e){return this.owner?this.owner.getRendererContext(e):e}setVisible(e){this.visible!==e&&(this._visible=e)}getVisible(){return this._visible}setEnabled(e){this._enabled=e}getEnabled(){return this.enabledIf?this.enabledIf():this._enabled}setComponent(e){this._component=e}getComponent(){return this._component}getGroupComponentName(){return"sv-list-item-group"}initLoadingIndicatorVisibilityObserver(e){typeof IntersectionObserver<"u"&&(this.intersectionVisibilityObserver=new IntersectionObserver(t=>{t.forEach(s=>{const i=s.isIntersecting;e(i)})},{trackVisibility:!0,delay:100}))}dispose(){this.locTitleValue&&this.locTitleValue.onStringChanged.remove(this.locTitleChanged),this.locTitleChanged=void 0,this.action=void 0,super.dispose(),this.popupModel&&this.popupModel.dispose(),this.intersectionVisibilityObserver&&(this.intersectionVisibilityObserver.disconnect(),this.intersectionVisibilityObserver=void 0)}updateDimension(e,t,s){const i=e=="small"?"minDimension":"maxDimension";if(t){const r=t;r.classList.contains("sv-action--hidden")?(r.classList.remove("sv-action--hidden"),this[i]=s(t),r.classList.add("sv-action--hidden")):this[i]=s(t)}}afterRender(){this.afterRenderCallback&&this.afterRenderCallback()}updateMode(e,t){this.updateModeCallback?this.updateModeCallback(e,t):this.afterRenderCallback=()=>{this.updateModeCallback(e,t),this.afterRenderCallback=void 0}}updateDimensions(e,t,s){const i=!s||s=="large"&&this.mode!=="small"?this.mode:s;this.updateMode(i,(r,a)=>{this.updateDimension(r,a,e),s?t():this.updateMode(r!=="small"?"small":"large",(o,l)=>{this.updateDimension(o,l,e),t()})})}}I([R({defaultValue:!0})],xe.prototype,"_visible",void 0),I([R({onSet:(n,e)=>{e.locTooltipChanged()}})],xe.prototype,"locTooltipName",void 0),I([R()],xe.prototype,"_enabled",void 0),I([R()],xe.prototype,"action",void 0),I([R()],xe.prototype,"onFocus",void 0),I([R()],xe.prototype,"_component",void 0),I([R()],xe.prototype,"items",void 0),I([R({onSet:(n,e)=>{e.locTitleValue.text!==n&&(e.locTitleValue.text=n)}})],xe.prototype,"_title",void 0);class lR{constructor(e){this.item=e,this.funcKey="sv-dropdown-action",this.setupPopupCallbacks()}setupPopupCallbacks(){const e=this.popupModel=this.item.popupModel;e&&e.registerPropertyChangedHandlers(["isVisible"],()=>{e.isVisible?this.item.pressed=!0:this.item.pressed=!1},this.funcKey)}removePopupCallbacks(){this.popupModel&&this.popupModel.unregisterPropertyChangedHandlers(["isVisible"],this.funcKey)}dispose(){this.removePopupCallbacks()}}var Mi;(function(n){n[n.None=0]="None",n[n.Light=1]="Light",n[n.Hard=3]="Hard"})(Mi||(Mi={}));class Wo extends Vt{hideItemsGreaterN(e){const t=this.getActionsToHide();e=Math.max(e,this.minVisibleItemsCount-(this.visibleActions.length-t.length));const s=[];t.forEach(i=>{e<=0&&(i.mode="popup",s.push(i.innerItem)),e--}),this.hiddenItemsListModel.setItems(s)}getActionsToHide(){return this.visibleActions.filter(e=>!e.disableHide)}updateItemMode(e,t){const s=this.visibleActions;for(let i=s.length-1;i>=0;i--)t>e&&!s[i].disableShrink?(t-=s[i].maxDimension-s[i].minDimension,s[i].mode="small"):s[i].mode="large"}constructor(){super(),this.minVisibleItemsCount=0,this.isResponsivenessDisabled=!1,this.isInitialized=!1,this.dotsItem=aR({id:"dotsItem-id"+this.id++,css:"sv-dots",innerCss:"sv-dots__item",iconName:"icon-more",visible:!1,tooltip:bt("more")},{items:[],allowSelection:!1})}get hiddenItemsListModel(){return this.dotsItem.data}onSet(){super.onSet(),this.raiseUpdate({updateResponsivenessMode:Mi.Hard})}onPush(e){super.onPush(e),this.raiseUpdate({updateResponsivenessMode:Mi.Hard})}onRemove(e){super.onRemove(e),this.raiseUpdate({updateResponsivenessMode:Mi.Hard})}onActionPropertyChanged(e,t){super.onActionPropertyChanged(e,t),(t.name=="_visible"||t.name=="_title")&&(e.needUpdateMaxDimension=e.visible,e.needUpdateMinDimension=e.visible,this.raiseUpdate({updateResponsivenessMode:Mi.Light})),t.name=="disableHide"&&t.newValue&&e.mode=="popup"&&this.raiseUpdate({updateResponsivenessMode:Mi.Light})}getRenderedActions(){const e=super.getRenderedActions();return e.length==0||e.length===1&&e[0].iconName?e:e.concat([this.dotsItem])}getAllActions(){return this.actions.concat(this.dotsItem)}getActionMinDimension(e){return e.disableShrink?e.maxDimension:e.minDimension}getVisibleItemsCount(e){let{availableSpace:t,gap:s}=e;t-=this.dotsItem.minDimension+s;let i=0;this.visibleActions[0].disableHide?t+=s:i-=s,this.visibleActions.filter(a=>a.disableHide).forEach(a=>t-=this.getActionMinDimension(a)+s);const r=this.getActionsToHide();if(r.length===1&&r[0].iconName)return 1;for(let a=0;a<r.length;a++)if(i+=this.getActionMinDimension(r[a])+s,i>t)return a}fit(e){var t;if(e.availableSpace<=0)return;e.gap=(t=e.gap)!==null&&t!==void 0?t:0;const{availableSpace:s,gap:i}=e;this.dotsItem.visible=!1;const r=this.visibleActions;let a=-1*e.gap,o=-1*e.gap;r.forEach(l=>{a+=this.getActionMinDimension(l)+i,o+=l.maxDimension+i}),s>=o?this.setActionsMode("large"):s<a?(this.setActionsMode("small"),this.hideItemsGreaterN(this.getVisibleItemsCount(e)),this.dotsItem.visible=!!this.hiddenItemsListModel.actions.length):this.updateItemMode(e.availableSpace,o)}createResponsivityManager(e){return new tR(e,this)}mergeUpdateOptions(e,t){const s=super.mergeUpdateOptions(e,t);return s.updateResponsivenessMode=s.updateResponsivenessMode|t.updateResponsivenessMode,s}raiseUpdate(e){super.raiseUpdate(e)}update(e){var t;super.update(e),e.updateResponsivenessMode&&((t=this.responsivityManager)===null||t===void 0||t.update(e.updateResponsivenessMode==Mi.Hard))}initResponsivityManager(e){if(this.responsivityManager){if(this.responsivityManager.container==e)return;this.responsivityManager.dispose()}this.isInitialized=!1,this.responsivityManager=this.createResponsivityManager(e),this.responsivityManager.afterInitializeCallback=()=>{this.isInitialized=!0}}resetResponsivityManager(){this.responsivityManager&&(this.responsivityManager.dispose(),this.responsivityManager=void 0)}getRootStyle(){if(!this.isInitialized&&!this.isResponsivenessDisabled)return{opacity:0}}setActionsMode(e){this.actions.forEach(t=>{e=="small"&&t.disableShrink?t.mode="large":t.mode=e})}dispose(){super.dispose(),this.dotsItem.data.dispose(),this.dotsItem.dispose(),this.resetResponsivityManager()}}I([R()],Wo.prototype,"isInitialized",void 0);class c1{constructor(){this.cancelQueue=[]}getMsFromRule(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}reflow(e){return e.offsetHeight}getAnimationsCount(e){let t="";return getComputedStyle&&(t=getComputedStyle(e).animationName),t&&t!="none"?t.split(", ").length:0}getAnimationDuration(e){const t=getComputedStyle(e),s=t.animationDelay.split(", "),i=t.animationDuration.split(", ");let r=0;for(let a=0;a<Math.max(i.length,s.length);a++)r=Math.max(r,this.getMsFromRule(i[a%i.length])+this.getMsFromRule(s[a%s.length]));return r}addCancelCallback(e){this.cancelQueue.push(e)}removeCancelCallback(e){this.cancelQueue.indexOf(e)>=0&&this.cancelQueue.splice(this.cancelQueue.indexOf(e),1)}onAnimationEnd(e,t,s){let i,r=this.getAnimationsCount(e);const a=(l=!0)=>{t(l),clearTimeout(i),this.removeCancelCallback(a),e.removeEventListener("animationend",o)},o=l=>{l.target==l.currentTarget&&--r<=0&&a(!1)};r>0?(e.addEventListener("animationend",o),this.addCancelCallback(a),i=setTimeout(()=>{a(!1)},this.getAnimationDuration(e)+10)):t(!0)}afterAnimationRun(e,t){e&&t&&t.onAfterRunAnimation&&t.onAfterRunAnimation(e)}beforeAnimationRun(e,t){e&&t&&t.onBeforeRunAnimation&&t.onBeforeRunAnimation(e)}getCssClasses(e){return e.cssClass.replace(/\s+$/,"").split(/\s+/)}runAnimation(e,t,s){e&&t?.cssClass?(this.reflow(e),this.getCssClasses(t).forEach(i=>{e.classList.add(i)}),this.onAnimationEnd(e,s,t)):s(!0)}clearHtmlElement(e,t){e&&t.cssClass&&this.getCssClasses(t).forEach(s=>{e.classList.remove(s)}),this.afterAnimationRun(e,t)}onNextRender(e,t=!1){if(!t&&he.isAvailable()){let s;const i=()=>{e(!0),cancelAnimationFrame(s)};s=he.requestAnimationFrame(()=>{s=he.requestAnimationFrame(()=>{e(!1),this.removeCancelCallback(i)})}),this.addCancelCallback(i)}else e(!0)}cancel(){[].concat(this.cancelQueue).forEach(t=>t()),this.cancelQueue=[]}}class uR extends c1{onEnter(e){const t=e.getAnimatedElement(),s=e.getEnterOptions?e.getEnterOptions():{};this.beforeAnimationRun(t,s),this.runAnimation(t,s,()=>{this.clearHtmlElement(t,s)})}onLeave(e,t){const s=e.getAnimatedElement(),i=e.getLeaveOptions?e.getLeaveOptions():{};this.beforeAnimationRun(s,i),this.runAnimation(s,i,r=>{t(),this.onNextRender(()=>{this.clearHtmlElement(s,i)},r)})}}class p1 extends c1{runGroupAnimation(e,t,s,i,r){const a={isAddingRunning:t.length>0,isDeletingRunning:s.length>0,isReorderingRunning:i.length>0},o=t.map(x=>e.getAnimatedElement(x)),l=t.map(x=>e.getEnterOptions?e.getEnterOptions(x,a):{}),u=s.map(x=>e.getAnimatedElement(x)),d=s.map(x=>e.getLeaveOptions?e.getLeaveOptions(x,a):{}),h=i.map(x=>e.getAnimatedElement(x.item)),f=i.map(x=>e.getReorderOptions?e.getReorderOptions(x.item,x.movedForward,a):{});t.forEach((x,V)=>{this.beforeAnimationRun(o[V],l[V])}),s.forEach((x,V)=>{this.beforeAnimationRun(u[V],d[V])}),i.forEach((x,V)=>{this.beforeAnimationRun(h[V],f[V])});let C=t.length+s.length+h.length;const b=x=>{--C<=0&&(r&&r(),this.onNextRender(()=>{t.forEach((V,P)=>{this.clearHtmlElement(o[P],l[P])}),s.forEach((V,P)=>{this.clearHtmlElement(u[P],d[P])}),i.forEach((V,P)=>{this.clearHtmlElement(h[P],f[P])})},x))};t.forEach((x,V)=>{this.runAnimation(o[V],l[V],b)}),s.forEach((x,V)=>{this.runAnimation(u[V],d[V],b)}),i.forEach((x,V)=>{this.runAnimation(h[V],f[V],b)})}}class wd{constructor(e,t,s){this.animationOptions=e,this.update=t,this.getCurrentValue=s,this._debouncedSync=l1(i=>{this.cancelAnimations();try{this._sync(i)}catch{this.update(i)}})}onNextRender(e,t){const s=this.animationOptions.getRerenderEvent();if(s){const i=()=>{s.remove(r),this.cancelCallback=void 0},r=(a,o)=>{o.isCancel?t&&t():e(),i()};this.cancelCallback=()=>{t&&t(),i()},s.add(r)}else if(he.isAvailable()){const i=he.requestAnimationFrame(()=>{e(),this.cancelCallback=void 0});this.cancelCallback=()=>{t&&t(),cancelAnimationFrame(i),this.cancelCallback=void 0}}else throw new Error("Can't get next render")}sync(e){this.animationOptions.isAnimationEnabled()?this._debouncedSync.run(e):(this.cancel(),this.update(e))}cancel(){this._debouncedSync.cancel(),this.cancelAnimations()}cancelAnimations(){this.cancelCallback&&this.cancelCallback(),this.animation.cancel()}}class g1 extends wd{constructor(){super(...arguments),this.animation=new uR}_sync(e){e!==this.getCurrentValue()?e?(this.onNextRender(()=>{this.animation.onEnter(this.animationOptions)}),this.update(e)):this.animation.onLeave(this.animationOptions,()=>{this.update(e)}):this.update(e)}}class Xi extends wd{constructor(){super(...arguments),this.animation=new p1}_sync(e){var t,s;e=[].concat(e);const i=[].concat(this.getCurrentValue()),r=(t=this.animationOptions.allowSyncRemovalAddition)!==null&&t!==void 0?t:!0;let a=IR(i,e,(s=this.animationOptions.getKey)!==null&&s!==void 0?s:(f=>f));!r&&(a.reorderedItems.length>0||a.addedItems.length>0)&&(a.deletedItems=[],a.mergedItems=e),this.animationOptions.onCompareArrays&&this.animationOptions.onCompareArrays(a);let{addedItems:o,reorderedItems:l,deletedItems:u,mergedItems:d}=a;const h=()=>{this.animation.runGroupAnimation(this.animationOptions,o,u,l,()=>{u.length>0&&this.update(e)})};[o,u,l].some(f=>f.length>0)?u.length<=0||l.length>0||o.length>0?(this.onNextRender(h,()=>{this.update(e)}),this.update(d)):h():this.update(e)}}class m1 extends wd{constructor(e,t,s,i){super(e,t,s),this.mergeValues=i,this.animation=new p1}_sync(e){const t=[].concat(this.getCurrentValue());if(t[0]!==e[0]){const s=this.mergeValues?this.mergeValues(e,t):[].concat(t,e);this.onNextRender(()=>{this.animation.runGroupAnimation(this.animationOptions,e,t,[],()=>{this.update(e)})},()=>this.update(e)),this.update(s,!0)}else this.update(e)}}class $o extends de{constructor(){super(),this.createLocTitleProperty()}createLocTitleProperty(){return this.createLocalizableString("title",this,!0)}get isPage(){return!1}get isPanel(){return!1}get isQuestion(){return!1}get isSurvey(){return!1}get title(){return this.getLocalizableStringText("title",this.getDefaultTitleValue())}set title(e){this.setTitleValue(e)}get locTitle(){return this.getLocalizableString("title")}get locRenderedTitle(){return this.locTitle}getDefaultTitleValue(){}setTitleValue(e){this.setLocalizableStringText("title",e)}get hasDescription(){return this.getPropertyValue("hasDescription",void 0,()=>this.calcDescriptionVisibility())}set hasDescription(e){this.setPropertyValue("hasDescription",e)}calcDescriptionVisibility(){const e=this.description;let t=!1;if(this.isDesignMode){const s=B.findProperty(this.getType(),"description");t=!!s?.placeholder}return!!e||t&&this.isDesignMode}resetDescriptionVisibility(){this.resetPropertyValue("hasDescription")}get locDescription(){return this.getLocalizableString("description")}get titleTagName(){let e=this.getDefaultTitleTagName();const t=this.getSurvey();return t?t.getElementTitleTagName(this,e):e}getDefaultTitleTagName(){return D.titleTags[this.getType()]}get hasTitle(){return this.title.length>0}get hasTitleActions(){return!1}get hasTitleEvents(){return this.hasTitleActions}getTitleToolbar(){return null}getTitleOwner(){}get isTitleOwner(){return!!this.getTitleOwner()}get isTitleRenderedAsString(){return this.getIsTitleRenderedAsString()}toggleState(){}get cssClasses(){return{}}get cssTitle(){return""}get ariaTitleId(){}get ariaDescriptionId(){}get titleTabIndex(){}get titleAriaExpanded(){}get titleAriaRole(){}get ariaLabel(){return this.locTitle.renderedHtml}get titleAriaLabel(){return this.ariaLabel}getIsTitleRenderedAsString(){return!this.isTitleOwner}}I([R({localizable:!0,onSet:(n,e)=>{e.resetDescriptionVisibility()}})],$o.prototype,"description",void 0);class Ke extends $o{static getProgressInfoByElements(e,t){const s=de.createProgressInfo();for(let i=0;i<e.length;i++){if(!e[i].isVisible)continue;const r=e[i].getProgressInfo();s.questionCount+=r.questionCount,s.answeredQuestionCount+=r.answeredQuestionCount,s.requiredQuestionCount+=r.requiredQuestionCount,s.requiredAnsweredQuestionCount+=r.requiredAnsweredQuestionCount}return t&&s.questionCount>0&&(s.requiredQuestionCount==0&&(s.requiredQuestionCount=1),s.answeredQuestionCount>0&&(s.requiredAnsweredQuestionCount=1)),s}static IsNeedScrollIntoView(e,t,s){const i=s?-1:e.getBoundingClientRect().top;let r=i<0,a=-1;if(!r&&t&&(a=e.getBoundingClientRect().left,r=a<0),!r&&he.isAvailable()){const o=he.getInnerHeight();if(r=o>0&&o<i,!r&&t){const l=he.getInnerWidth();r=l>0&&l<a}}return r}static ScrollIntoView(e,t,s){if(e.scrollIntoView(t),typeof s=="function"){let i=null,r=0;const a=()=>{const o=e.getBoundingClientRect().top;if(o===i){if(r++>2){s();return}}else i=o,r=0;requestAnimationFrame(a)};he.requestAnimationFrame(a)}}static ScrollElementToTop(e,t,s,i){return Ke.ScrollElementToViewCore(e,!1,t,s,i)}static ScrollElementToViewCore(e,t,s,i,r){if(!e||!e.scrollIntoView)return r&&r(),!1;const a=Ke.IsNeedScrollIntoView(e,t,s);return a?Ke.ScrollIntoView(e,i,r):r&&r(),a}static GetFirstNonTextElement(e,t=!1){if(!e||!e.length||e.length==0)return null;if(t){let s=e[0];s.nodeName==="#text"&&(s.data=""),s=e[e.length-1],s.nodeName==="#text"&&(s.data="")}for(let s=0;s<e.length;s++)if(e[s].nodeName!="#text"&&e[s].nodeName!="#comment")return e[s];return null}static FocusElement(e,t,s){if(!e||!oe.isAvailable())return!1;const i=t?!1:Ke.focusElementCore(e,s);return i||setTimeout(()=>{Ke.focusElementCore(e,s)},t?100:10),i}static focusElementCore(e,t){const{root:s}=D.environment;if(!s&&!t)return!1;const i=t?t.querySelector(`#${CSS.escape(e)}`):s.getElementById(e);return i&&!i.disabled&&i.style.display!=="none"&&i.offsetParent!==null?(Ke.ScrollElementToViewCore(i,!0,!1),i.focus(),!0):!1}get effectiveColSpan(){const e=this.getPropertyValueWithoutDefault("effectiveColSpan");return e!==void 0?e:(this.setRootStyle(),this.getPropertyValue("effectiveColSpan"))}get colSpan(){return this.getPropertyValue("colSpan",1)}set colSpan(e){this.setPropertyValue("colSpan",e)}constructor(e){super(),this.selectedElementInDesignValue=this,this.disableDesignActions=Ke.CreateDisabledDesignElements,this.parentQuestionValue=null,this.isContentElement=!1,this.isEditableTemplateElement=!1,this.isInteractiveDesignElement=!0,this.isSingleInRow=!0,this._renderedIsExpanded=!0,this._isAnimatingCollapseExpand=!1,this.animationCollapsed=new g1(this.getExpandCollapseAnimationOptions(),t=>{this._renderedIsExpanded=t,this.animationAllowed&&(t?this.isAnimatingCollapseExpand=!0:this.updateElementCss(!1))},()=>this.renderedIsExpanded),this.onAfterRenderElement=this.addEvent(),this.setPropertyValueDirectly("name",this.getValidName(e)),this.createNewArray("errors"),this.createNewArray("renderedErrors"),this.createNewArray("titleActions"),this.registerPropertyChangedHandlers(["isReadOnly"],()=>{this.onReadOnlyChanged()}),this.registerPropertyChangedHandlers(["errors"],()=>{this.updateVisibleErrors()}),this.registerPropertyChangedHandlers(["isSingleInRow"],()=>{this.updateElementCss(!1)}),this.registerPropertyChangedHandlers(["minWidth","maxWidth","renderWidth","allowRootStyle","parent"],()=>{this.updateRootStyle()}),this.registerPropertyChangedHandlers(["effectiveColSpan"],t=>{this.colSpan=t})}onPropertyValueChanged(e,t,s){super.onPropertyValueChanged(e,t,s),e==="state"&&(this.updateElementCss(!1),this.notifyStateChanged(t),this.stateChangedCallback&&this.stateChangedCallback())}getSkeletonComponentNameCore(){return this.survey?this.survey.getSkeletonComponentName(this):"sv-skeleton"}canUpdateValueOnVisibleChanged(){return!this.isLoadingFromJson&&!!this.survey&&!this.survey.isSettingData()}get parentQuestion(){return this.parentQuestionValue}setParentQuestion(e){this.parentQuestionValue=e,this.onParentQuestionChanged()}onParentQuestionChanged(){}getPanelInDesignMode(){return null}updateElementVisibility(){this.setPropertyValue("isVisible",this.isVisible)}get skeletonComponentName(){return this.getSkeletonComponentNameCore()}get state(){return this.getPropertyValue("state")}set state(e){this.setPropertyValue("state",e),this.renderedIsExpanded=!this.isCollapsed}notifyStateChanged(e){this.survey&&this.survey.elementContentVisibilityChanged(this)}get isCollapsed(){return this.state==="collapsed"&&!this.isDesignMode}get isExpanded(){return this.state==="expanded"}collapse(){this.isDesignMode||(this.state="collapsed")}expand(){this.state="expanded"}toggleState(){return this.isCollapsed?(this.expand(),!0):this.isExpanded?(this.collapse(),!1):!0}get hasStateButton(){return this.isExpanded||this.isCollapsed}get shortcutText(){return this.title||this.name}getTitleToolbar(){return this.titleToolbarValue||(this.titleToolbarValue=this.createActionContainer(!0),this.titleToolbarValue.locOwner=this,this.titleToolbarValue.containerCss=(this.isPanel?this.cssClasses.panel.titleBar:this.cssClasses.titleBar)||"sv-action-title-bar",this.titleToolbarValue.setItems(this.getTitleActions()),this.titleToolbarValue.flushUpdates()),this.titleToolbarValue}createActionContainer(e){const t=e?new Wo:new Vt;return this.survey&&this.survey.getCss().actionBar&&(t.cssClasses=this.survey.getCss().actionBar),t}get titleActions(){return this.getPropertyValue("titleActions")}getTitleActions(){return this.isTitleActionRequested||(this.updateTitleActions(),this.isTitleActionRequested=!0),this.titleActions}getDefaultTitleActions(){return[]}updateTitleActions(){let e=this.getDefaultTitleActions();this.survey&&(e=this.survey.getUpdatedElementTitleActions(this,e)),this.setPropertyValue("titleActions",e)}locStrsChanged(){super.locStrsChanged(),this.titleToolbarValue&&this.titleToolbarValue.locStrsChanged()}get hasTitleActions(){return this.getTitleActions().length>0}get hasTitleEvents(){return this.state!==void 0&&this.state!=="default"}get titleTabIndex(){return!this.isPage&&this.state!=="default"?0:void 0}get titleAriaExpanded(){if(!(this.isPage||this.state==="default"))return this.state==="expanded"?"true":"false"}get titleAriaRole(){if(!(this.isPage||this.state==="default"))return"button"}setSurveyImpl(e,t){this.surveyImplValue=e,this.surveyImplValue?(this.surveyDataValue=this.surveyImplValue.getSurveyData(),this.setSurveyCore(this.surveyImplValue.getSurvey()),this.textProcessorValue=this.createTextProcessor(),this.onSetData()):(this.setSurveyCore(null),this.surveyDataValue=null,this.textProcessorValue=null),this.survey&&(this.resetDescriptionVisibility(),this.clearCssClasses()),this.blockAnimations(),this.renderedIsExpanded=!this.isCollapsed,this.releaseAnimations()}getValueGetterContext(){const e=this.data;return e?e.getValueGetterContext():super.getValueGetterContext()}createTextProcessor(){return this.surveyImplValue.getTextProcessor()}canRunConditions(){return super.canRunConditions()&&!!this.data}getDataFilteredProperties(){var e=this.data?this.data.getFilteredProperties():{};return e.question=this,e}get surveyImpl(){return this.surveyImplValue}__setData(e){this.surveyDataValue=e}get data(){return this.surveyDataValue}get survey(){return this.getSurvey()}getSurvey(e=!1){return this.surveyValue?this.surveyValue:(this.surveyImplValue&&this.setSurveyCore(this.surveyImplValue.getSurvey()),this.surveyValue)}setSurveyCore(e){this.surveyValue=e,this.surveyChangedCallback&&this.surveyChangedCallback()}get skeletonHeight(){let e;return this.survey&&this.survey.skeletonHeight&&(e=this.survey.skeletonHeight+"px"),e}get isInternal(){return this.isContentElement}get areInvisibleElementsShowing(){const e=this.parentQuestion;return e&&e.areInvisibleElementsShowing===!1?!1:!!this.survey&&this.survey.areInvisibleElementsShowing&&!this.isContentElement}get isVisible(){return!0}get isReadOnly(){return this.readOnly}get readOnly(){return this.getPropertyValue("readOnly")}set readOnly(e){this.readOnly!=e&&(this.setPropertyValue("readOnly",e),this.isLoadingFromJson||this.setPropertyValue("isReadOnly",this.isReadOnly))}onReadOnlyChanged(){this.readOnlyChangedCallback&&this.readOnlyChangedCallback()}get css(){return this.survey?this.survey.getCss():{}}get cssClassesValue(){let e=this.getPropertyValueWithoutDefault("cssClassesValue");return!e&&!this.isCssValueCalculating&&(this.isCssValueCalculating=!0,e=this.createCssClassesValue(),this.isCssValueCalculating=!1),e}createCssClassesValue(){const e=this.calcCssClasses(this.css);return this.setPropertyValue("cssClassesValue",e),this.onCalcCssClasses(e),this.updateElementCssCore(this.cssClassesValue),e}onCalcCssClasses(e){}get cssClasses(){return this.cssClassesValue,this.survey?(this.cssClassesValue||this.createCssClassesValue(),this.cssClassesValue):this.calcCssClasses(this.css)}get cssTitleNumber(){const e=this.cssClasses;return e.number?e.number:e.panel?e.panel.number:void 0}get cssRequiredMark(){const e=this.cssClasses;return e.requiredMark||e.panel&&e.panel.requiredMark}getCssTitleExpandableSvg(){return this.state==="default"?null:this.cssClasses.titleExpandableSvg}calcCssClasses(e){}updateElementCssCore(e){}get cssError(){return""}updateElementCss(e){this.clearCssClasses()}clearCssClasses(){this.resetPropertyValue("cssClassesValue")}getIsLoadingFromJson(){return super.getIsLoadingFromJson()?!0:this.surveyValue?this.surveyValue.isLoadingFromJson:!1}get name(){return this.getPropertyValue("name","")}set name(e){var t=this.name;this.setPropertyValue("name",this.getValidName(e)),!this.isLoadingFromJson&&t&&this.onNameChanged(t)}getValidName(e){if(e){e=e.trim();const t=D.itemValueSeparator;t&&e.indexOf(t)>-1&&(e=e.replace(t,""))}return e}onNameChanged(e){}updateBindingValue(e,t){this.data&&!this.isTwoValueEquals(t,this.data.getValue(e))&&this.data.setValue(e,t,!1)}get errors(){return this.getPropertyValue("errors")}set errors(e){this.setPropertyValue("errors",e)}get renderedErrors(){return this.getPropertyValue("renderedErrors")}set renderedErrors(e){this.setPropertyValue("renderedErrors",e)}calcRenderedErrors(){const e=this.currentNotificationType;return this.errors.filter((t=>t.visible&&t.notificationType===e))}get currentNotificationType(){return this.getPropertyValue("currentNotificationType",void 0,()=>this.calcCurrentNotificationType())}calcCurrentNotificationType(){let e="";const t=["info","warning","error"];for(let s=0;s<this.errors.length;s++){const i=this.errors[s];if(!i.visible)continue;const r=i.notificationType;if(!e){e=r;continue}const a=t.indexOf(r),o=t.indexOf(e);a>o&&(e=r)}return e}updateVisibleErrors(){this.resetPropertyValue("currentNotificationType");for(var e=0,t=0;t<this.errors.length;t++)this.errors[t].visible&&e++;this.hasVisibleErrors=e>0,this.renderedErrors=this.calcRenderedErrors()}get containsErrors(){return this.getPropertyValue("containsErrors",!1)}updateContainsErrors(){this.setPropertyValue("containsErrors",this.getContainsErrors())}getContainsErrors(){return this.errors.length>0}get selectedElementInDesign(){return this.selectedElementInDesignValue}set selectedElementInDesign(e){this.selectedElementInDesignValue=e}updateCustomWidgets(){}onSurveyLoad(){}get wasRendered(){return!!this.wasRenderedValue}resetWasRendered(){this.wasRenderedValue=!1}onFirstRendering(){!this.wasRendered&&!this.isLoadingFromJson&&(this.wasRenderedValue=!0,this.onFirstRenderingCore())}onFirstRenderingCore(){}endLoadingFromJson(){super.endLoadingFromJson(),this.survey||this.onSurveyLoad()}setVisibleIndex(e){return 0}getPageVisibleIndex(){return-1}getStartIndex(){return this.parent?this.parent.getQuestionStartIndex():this.survey?this.survey.getQuestionStartIndex(this.getPageVisibleIndex()):""}delete(e){}getLocale(){return this.survey?this.survey.getLocale():this.locOwner?this.locOwner.getLocale():""}getMarkdownHtml(e,t,s){return this.survey?this.survey.getSurveyMarkdownHtml(this,e,t,s):this.locOwner?this.locOwner.getMarkdownHtml(e,t,s):void 0}getRenderer(e,t){return this.survey&&typeof this.survey.getRendererForString=="function"?this.survey.getRendererForString(this,e,t):this.locOwner&&typeof this.locOwner.getRenderer=="function"?this.locOwner.getRenderer(e):null}getRendererContext(e,t){return this.survey&&typeof this.survey.getRendererContextForString=="function"?this.survey.getRendererContextForString(this,e,t):this.locOwner&&typeof this.locOwner.getRendererContext=="function"?this.locOwner.getRendererContext(e):e}getProcessedText(e){return this.isLoadingFromJson?e:this.textProcessor?this.textProcessor.processText(e,this.getUseDisplayValuesInDynamicTexts()):this.locOwner?this.locOwner.getProcessedText(e):e}getUseDisplayValuesInDynamicTexts(){return!0}removeSelfFromList(e){if(!e||!Array.isArray(e))return;const t=e.indexOf(this);t>-1&&e.splice(t,1)}get textProcessor(){return this.textProcessorValue}getProcessedHtml(e){return!e||!this.textProcessor?e:this.textProcessor.processText(e,!0)}onSetData(){}get parent(){return this.getPropertyValue("parent",null)}set parent(e){this.setPropertyValue("parent",e)}getPage(e){for(;e&&e.parent;)e=e.parent;return e&&e.isPage?e:null}moveToBase(e,t,s=null){if(!t)return!1;e.removeElement(this);let i=-1;return L.isNumber(s)&&(i=parseInt(s)),i==-1&&s&&s.getType&&(i=t.indexOf(s)),t.addElement(this,i),!0}setPage(e,t){const s=this.getPage(e);this.prevSurvey=this.survey,typeof t=="string"&&this.getSurvey().pages.forEach(r=>{t===r.name&&(t=r)}),s!==t&&(e&&e.removeElement(this),t&&t.addElement(this,-1),this.prevSurvey=void 0)}getSearchableLocKeys(e){e.push("title"),e.push("description")}get hasParent(){return this.parent&&!this.parent.isPage||this.parent===void 0}shouldAddRunnerStyles(){return!this.isDesignMode}get isCompact(){return this.survey&&this.survey.isCompact}canHaveFrameStyles(){var e;return((e=this.survey)===null||e===void 0?void 0:e.currentSingleElement)===this?!0:this.isInternalNested===!0?!1:this.parent!==void 0&&(!this.hasParent||this.parent&&this.parent.showPanelAsPage)}getHasFrameV2(){return this.shouldAddRunnerStyles()&&this.canHaveFrameStyles()}getIsNested(){return this.shouldAddRunnerStyles()&&!this.canHaveFrameStyles()}getCssRoot(e){const t=!!this.isCollapsed||!!this.isExpanded;return new j().append(e.withFrame,this.getHasFrameV2()&&!this.isCompact).append(e.compact,this.isCompact&&this.getHasFrameV2()).append(e.collapsed,!!this.isCollapsed).append(e.expandableAnimating,t&&this.isAnimatingCollapseExpand).append(e.expanded,!!this.isExpanded&&this.renderedIsExpanded).append(e.expandable,t).append(e.nested,this.getIsNested()).toString()}get width(){return this.getPropertyValue("width","")}set width(e){this.setPropertyValue("width",e)}get minWidth(){return this.getPropertyValue("minWidth")}set minWidth(e){this.setPropertyValue("minWidth",e)}get maxWidth(){return this.getPropertyValue("maxWidth")}set maxWidth(e){this.setPropertyValue("maxWidth",e)}get renderWidth(){return this.getPropertyValue("renderWidth","")}set renderWidth(e){this.setPropertyValue("renderWidth",e)}get indent(){return this.getPropertyValue("indent")}set indent(e){this.setPropertyValue("indent",e)}get rightIndent(){return this.getPropertyValue("rightIndent",0)}set rightIndent(e){this.setPropertyValue("rightIndent",e)}getRootStyle(){const e={};return this.paddingLeft&&(e["--sv-element-add-padding-left"]=this.paddingLeft),this.paddingRight&&(e["--sv-element-add-padding-right"]=this.paddingRight),e}get paddingLeft(){return this.getPropertyValue("paddingLeft",void 0,()=>this.calcPaddingLeft())}calcPaddingLeft(){return""}get paddingRight(){return this.getPropertyValue("paddingRight",void 0,()=>this.calcPaddingRight())}set paddingRight(e){this.setPropertyValue("paddingRight",e)}calcPaddingRight(){return""}resetIndents(){this.resetPropertyValue("paddingLeft"),this.resetPropertyValue("paddingRight")}get rootStyle(){return this.getPropertyValue("rootStyle",void 0,()=>this.calcRootStyle())}set rootStyle(e){this.setPropertyValue("rootStyle",e)}updateRootStyle(){this.getPropertyValueWithoutDefault("rootStyle")?this.setRootStyle():this.resetPropertyValue("effectiveColSpan")}setRootStyle(){this.rootStyle=this.calcRootStyle()}calcRootStyle(){const e={};let t;if(this.parent&&(t=this.parent.getColumsForElement(this).reduce((i,r)=>r.effectiveWidth+i,0),t&&t!==100&&(e.flexGrow=1,e.flexShrink=0,e.flexBasis=t+"%",e.minWidth=void 0,e.maxWidth=this.maxWidth)),Object.keys(e).length==0){let s=""+this.minWidth;if(s&&s!="auto"){if(s.indexOf("px")!=-1&&this.survey){s=s.replace("px","");let i=parseFloat(s);isNaN(i)||(s=i*this.survey.widthScale/100,s=""+s+"px")}s="min(100%, "+s+")"}this.allowRootStyle&&this.renderWidth&&(e.flexGrow=1,e.flexShrink=1,e.flexBasis=this.renderWidth,e.minWidth=s,e.maxWidth=this.maxWidth)}return e}isContainsSelection(e){let t;const s=oe.getDocument();if(oe.isAvailable()&&s&&s.selection)t=s.selection.createRange().parentElement();else{var i=he.getSelection();if(i&&i.rangeCount>0){const r=i.getRangeAt(0);r.startOffset!==r.endOffset&&(t=r.startContainer.parentNode)}}return t==e}get clickTitleFunction(){if(this.needClickTitleFunction())return e=>{if(!(e&&this.isContainsSelection(e.target)))return this.processTitleClick()}}needClickTitleFunction(){return this.state!=="default"}processTitleClick(){this.state!=="default"&&this.toggleState()}get hasAdditionalTitleToolbar(){return!1}get additionalTitleToolbar(){return this.getAdditionalTitleToolbar()}getAdditionalTitleToolbar(){return null}getCssTitle(e){if(!e)return"";const t=this.state!=="default";return new j().append(e.title).append(e.titleNumInline,(this.no||"").length>4||t).append(e.titleExpandable,t).append(e.titleExpanded,this.isExpanded).append(e.titleCollapsed,this.isCollapsed).append(e.titleDisabled,this.isDisabledStyle).append(e.titleReadOnly,this.isReadOnly).append(e.titleOnError,this.containsErrors).toString()}get isDisabledStyle(){return this.getIsDisableAndReadOnlyStyles(!1)[1]}get isReadOnlyStyle(){return this.getIsDisableAndReadOnlyStyles(!1)[0]}getIsDisableAndReadOnlyStyles(e){const t=this.isPreviewStyle;return[(e||this.isReadOnly)&&!t,!1]}get isPreviewStyle(){return!!this.survey&&this.survey.state==="preview"}localeChanged(){super.localeChanged(),this.resetDescriptionVisibility(),this.errors.length>0&&this.errors.forEach(e=>{e.updateText()})}setWrapperElement(e){this.wrapperElement=e}getWrapperElement(){return this.wrapperElement}set isAnimatingCollapseExpand(e){e!==this._isAnimatingCollapseExpand&&(this._isAnimatingCollapseExpand=e,this.updateElementCss(!1))}get isAnimatingCollapseExpand(){return this._isAnimatingCollapseExpand||this._renderedIsExpanded!=this.isExpanded}onElementExpanded(e){}getExpandCollapseAnimationOptions(){const e=s=>{this.isAnimatingCollapseExpand=!0,ci(s)},t=s=>{this.isAnimatingCollapseExpand=!1,Vs(s)};return{getRerenderEvent:()=>this.onElementRerendered,getEnterOptions:()=>({cssClass:(this.isPanel?this.cssClasses.panel:this.cssClasses).contentEnter,onBeforeRunAnimation:e,onAfterRunAnimation:i=>{t(i),this.onElementExpanded(!0)}}),getLeaveOptions:()=>({cssClass:(this.isPanel?this.cssClasses.panel:this.cssClasses).contentLeave,onBeforeRunAnimation:e,onAfterRunAnimation:t}),getAnimatedElement:()=>{var s;const i=this.isPanel?this.cssClasses.panel:this.cssClasses;if(i.content){const r=ls(i.content);if(r)return(s=this.getWrapperElement())===null||s===void 0?void 0:s.querySelector(`:scope ${r}`)}},isAnimationEnabled:()=>this.isExpandCollapseAnimationEnabled}}get isExpandCollapseAnimationEnabled(){return this.animationAllowed&&!this.isDesignMode}set renderedIsExpanded(e){const t=this._renderedIsExpanded;this.animationCollapsed.sync(e),!this.isExpandCollapseAnimationEnabled&&!t&&this.renderedIsExpanded&&this.onElementExpanded(!1)}get renderedIsExpanded(){return!!this._renderedIsExpanded}getIsAnimationAllowed(){return super.getIsAnimationAllowed()&&!!this.survey&&!this.survey.isEndLoadingFromJson}afterRenderCore(e){this.onAfterRenderElement.fire(this,{htmlElement:e})}dispose(){super.dispose(),this.titleToolbarValue&&this.titleToolbarValue.dispose()}}Ke.CreateDisabledDesignElements=!1,I([R({defaultValue:!1})],Ke.prototype,"hasVisibleErrors",void 0),I([R({defaultValue:!0})],Ke.prototype,"isSingleInRow",void 0),I([R({defaultValue:!0})],Ke.prototype,"allowRootStyle",void 0),I([R()],Ke.prototype,"_renderedIsExpanded",void 0);class hR{constructor(e,t,s=100){this._elements=e,this._renderedHandler=t,this._elementsToRenderCount=0,this._elementsToRenderTimer=void 0,this._elementRenderedHandler=(i,r)=>{var a;(a=i.onAfterRenderElement)===null||a===void 0||a.remove(this._elementRenderedHandler),this._elementsToRenderCount--,this._elementsToRenderCount<=0&&this.visibleElementsRendered()},this._elements.forEach(i=>{i.onAfterRenderElement&&(i.onAfterRenderElement.add(this._elementRenderedHandler),this._elementsToRenderCount++)}),this._elementsToRenderCount>0?this._elementsToRenderTimer=setTimeout(()=>{this._elementsToRenderCount>0&&this.visibleElementsRendered()},s):this.visibleElementsRendered()}stopWaitingForElementsRendering(){this._elementsToRenderTimer&&(clearTimeout(this._elementsToRenderTimer),this._elementsToRenderTimer=void 0),this._elements.forEach(e=>{var t;(t=e.onAfterRenderElement)===null||t===void 0||t.remove(this._elementRenderedHandler)}),this._elementsToRenderCount=0}visibleElementsRendered(){const e=this._renderedHandler;this.dispose(),typeof e=="function"&&e()}dispose(){this.stopWaitingForElementsRendering(),this._elements=void 0,this._renderedHandler=void 0}}class wt{static get defaultLocale(){return D.localization.defaultLocaleName}static set defaultLocale(e){D.localization.defaultLocaleName=e}get localizationName(){return this._localizationName}set localizationName(e){this._localizationName!=e&&(this._localizationName=e,this.strChanged())}get allowLineBreaks(){var e;return this._allowLineBreaks===void 0&&(this._allowLineBreaks=!1,this.name&&this.owner instanceof $o&&(this._allowLineBreaks=((e=B.findProperty(this.owner.getType(),this.name))===null||e===void 0?void 0:e.type)=="text")),this._allowLineBreaks}constructor(e,t=!1,s,i){this.owner=e,this.useMarkdown=t,this.name=s,this.values={},this.htmlValues={},this.onStringChanged=new Xt,this._localizationName=i,this.onCreating()}getIsMultiple(){return!1}get locale(){if(this.owner&&this.owner.getLocale){const e=this.owner.getLocale();if(e||!this.sharedData)return e}return this.sharedData?this.sharedData.locale:""}get isDefautlLocale(){const e=this.locale;return!e||e===D.defaultLocaleName}strChanged(){this.isTextRequested&&(this.searchableText=void 0,!(this.renderedText===void 0&&this.isEmpty&&!this.onGetTextCallback&&!this.localizationName)&&(this.calculatedTextValue=this.calcText(),this.renderedText!==this.calculatedTextValue&&(this.renderedText=void 0,this.calculatedTextValue=void 0),this.htmlValues={},this.onChanged(),this.onStringChanged.fire(this,{})))}get text(){return this.pureText}set text(e){this.setLocaleText(this.locale,e)}get calculatedText(){return this.renderedText=this.calculatedTextValue!==void 0?this.calculatedTextValue:this.calcText(),this.calculatedTextValue=void 0,this.renderedText}getPlaceholder(){let e="";if(!this.isDefautlLocale){const t=this.getRootDialect(this.locale);e=this.getLocaleText(t||D.defaultLocaleName)}return!e&&this.onGetTextCallback&&(e=this.onGetTextCallback("","")),e}calcText(){const e=this.pureText;let t=e;return t&&this.owner&&this.owner.getProcessedText&&t.indexOf("{")>-1&&(t=this.owner.getProcessedText(t)),this.onGetTextCallback&&(t=this.onGetTextCallback(t,e)),t}get pureText(){this.isTextRequested=!0;var e=this.locale;e||(e=this.defaultLoc);var t=this.getValue(e);if(this.isValueEmpty(t)&&e===this.defaultLoc&&(t=this.getValue(os.defaultLocale)),this.isValueEmpty(t)){const s=this.getRootDialect(e);s&&(t=this.getValue(s))}return this.isValueEmpty(t)&&e!==this.defaultLoc&&(t=this.getValue(this.defaultLoc)),this.isValueEmpty(t)&&this.getLocalizationName()&&(t=this.getLocalizationStr()),t||(t=this.defaultValue||""),t}getRootDialect(e){if(!e)return e;const t=e.indexOf("-");return t>-1?e.substring(0,t):""}getLocalizationName(){return this.sharedData?this.sharedData.localizationName:this.localizationName}getLocalizationStr(){const e=this.getLocalizationName();return e?bt(e,this.locale):""}get hasHtml(){return this.hasHtmlValue()}get html(){return this.hasHtml?this.getHtmlValue():""}get isEmpty(){return this.getValuesKeys().length==0}get textOrHtml(){return this.hasHtml?this.getHtmlValue():this.calculatedText}get renderedHtml(){return this.textOrHtml}getLocaleText(e){const t=this.getLocaleTextCore(e);return t||""}getLocaleTextCore(e){return e||(e=this.defaultLoc),this.getValue(e)}isLocaleTextEqualsWithDefault(e,t){let s=this.getLocaleTextCore(e);return s===t?!0:this.isValueEmpty(s)&&this.isValueEmpty(t)}clear(){this.setJson(void 0)}clearLocale(e){this.setLocaleText(e,void 0)}setLocaleText(e,t){if(e=this.getValueLoc(e),this.lastChangedLoc=e,e&&t===void 0){const r=this.getValue(e);r!==void 0&&(this.deleteValue(e),this.fireStrChanged(e,r));return}if(!this.storeDefaultText&&this.isLocaleTextEqualsWithDefault(e,t)){if(!this.isValueEmpty(t)||e&&e!==this.defaultLoc)return;let r=os.defaultLocale,a=this.getValue(r);r&&!this.isValueEmpty(a)&&(this.setValue(r,t),this.fireStrChanged(r,a));return}if(!(!D.localization.storeDuplicatedTranslations&&!this.isValueEmpty(t)&&e&&e!=this.defaultLoc&&!this.getValue(e)&&t==this.getLocaleText(this.defaultLoc))){var s=this.curLocale;e||(e=this.defaultLoc);var i=this.onStrChanged&&e===s?this.pureText:void 0;delete this.htmlValues[e],this.isValueEmpty(t)?this.deleteValue(e):typeof t=="string"&&(this.canRemoveLocValue(e,t)?this.setLocaleText(e,null):(this.setValue(e,t),e==this.defaultLoc&&this.deleteValuesEqualsToDefault(t))),this.fireStrChanged(e,i)}}isValueEmpty(e){return e==null?!0:this.localizationName?!1:e===""}get curLocale(){return this.locale?this.locale:this.defaultLoc}canRemoveLocValue(e,t){if(D.localization.storeDuplicatedTranslations||e===this.defaultLoc)return!1;const s=this.getRootDialect(e);if(s){const i=this.getLocaleText(s);return i?i==t:this.canRemoveLocValue(s,t)}else return t==this.getLocaleText(this.defaultLoc)}fireStrChanged(e,t){if(this.strChanged(),!this.onStrChanged)return;const s=this.pureText;(e!==this.curLocale||t!==s)&&this.onStrChanged(t,s)}hasNonDefaultText(){var e=this.getValuesKeys();return e.length==0?!1:e.length>1||e[0]!=this.defaultLoc}getLocales(){var e=this.getValuesKeys();return e.length==0?[]:e}getJson(){if(this.sharedData)return this.sharedData.getJson();const e=this.getValuesKeys();if(e.length==0){if(this.serializeCallBackText){const s=this.calcText();if(s)return s}return null}if(e.length==1&&e[0]==D.localization.defaultLocaleName&&!D.serialization.localizableStringSerializeAsObject)return this.values[e[0]];const t={};for(let s in this.values)t[s]=this.values[s];return t}setJson(e,t){if(this.sharedData){this.sharedData.setJson(e,t);return}if(this.lastChangedLoc=void 0,this.values={},this.htmlValues={},e!=null)if(t)typeof e=="string"?this.values[D.defaultLocaleName]=e:(this.values=e,delete this.values.pos);else{if(typeof e=="string")this.setLocaleText(null,e);else for(var s in e)this.setLocaleText(s,e[s]);this.strChanged()}}get renderAs(){return!this.owner||typeof this.owner.getRenderer!="function"?wt.defaultRenderer:this.owner.getRenderer(this.name)||wt.defaultRenderer}get renderAsData(){return!this.owner||typeof this.owner.getRendererContext!="function"?this:this.owner.getRendererContext(this)||this}equals(e){return this.sharedData?this.sharedData.equals(e):!e||!e.values?!1:L.isTwoValueEquals(this.values,e.values,!1,!0,!1)}setFindText(e){if(this.searchText!=e){if(this.searchText=e,!this.searchableText){let i=this.textOrHtml;this.searchableText=i?i.toLowerCase():""}var t=this.searchableText,s=t&&e?t.indexOf(e):void 0;return s<0&&(s=void 0),(s!=null||this.searchIndex!=s)&&(this.searchIndex=s,this.onSearchChanged&&this.onSearchChanged()),this.searchIndex!=null}}onChanged(){}onCreating(){}hasHtmlValue(){if(!this.owner||!this.useMarkdown)return!1;let e=this.locale;if(e||(e=this.defaultLoc),this.htmlValues[e]!==void 0)return!!this.htmlValues[e];let t=this.calculatedText;if(!t)return this.setHtmlValue(e,""),!1;if(this.getLocalizationName()&&t===this.getLocalizationStr())return this.setHtmlValue(e,""),!1;const s=this.owner.getMarkdownHtml(t,this.name);return this.setHtmlValue(e,s),!!s}setHtmlValue(e,t){this.htmlValues[e]=t}getHtmlValue(){var e=this.locale;return e||(e=this.defaultLoc),this.htmlValues[e]}deleteValuesEqualsToDefault(e){if(!D.localization.storeDuplicatedTranslations)for(var t=this.getValuesKeys(),s=0;s<t.length;s++)t[s]!=this.defaultLoc&&this.getValue(t[s])==e&&this.deleteValue(t[s])}getValue(e){return this.sharedData?this.sharedData.getValue(e):this.values[this.getValueLoc(e)]}setValue(e,t){this.sharedData?this.sharedData.setValue(e,t):this.values[this.getValueLoc(e)]=t}deleteValue(e){this.sharedData?this.sharedData.deleteValue(e):delete this.values[this.getValueLoc(e)]}getValueLoc(e){return this.disableLocalization?D.localization.defaultLocaleName:e}getValuesKeys(){return this.sharedData?this.sharedData.getValuesKeys():Object.keys(this.values)}get defaultLoc(){return D.localization.defaultLocaleName}}wt.SerializeAsObject=!1,wt.defaultRenderer="sv-string-viewer",wt.editableRenderer="sv-string-editor";class dR{constructor(e){this.owner=e,this.values={}}getIsMultiple(){return!0}get locale(){return this.owner&&this.owner.getLocale?this.owner.getLocale():""}get value(){return this.getValue("")}set value(e){this.setValue("",e)}get text(){return Array.isArray(this.value)?this.value.join(`
`):""}set text(e){this.value=e?e.split(`
`):[]}getLocaleText(e){var t=this.getValueCore(e,!e||e===this.locale);return!t||!Array.isArray(t)||t.length==0?"":t.join(`
`)}setLocaleText(e,t){var s=t?t.split(`
`):null;this.setValue(e,s)}getValue(e){return this.getValueCore(e)}getValueCore(e,t=!0){if(e=this.getLocale(e),this.values[e])return this.values[e];if(t){var s=D.localization.defaultLocaleName;if(e!==s&&this.values[s])return this.values[s]}return[]}setValue(e,t){e=this.getLocale(e);const s=L.createCopy(this.values);!t||t.length==0?delete this.values[e]:this.values[e]=t,this.onValueChanged&&this.onValueChanged(s,this.values)}hasValue(e=""){return!this.isEmpty&&this.getValue(e).length>0}get isEmpty(){return this.getValuesKeys().length==0}getLocale(e){return e||(e=this.locale,e||D.localization.defaultLocaleName)}getLocales(){var e=this.getValuesKeys();return e.length==0?[]:e}getJson(){var e=this.getValuesKeys();return e.length==0?null:e.length==1&&e[0]==D.localization.defaultLocaleName&&!D.serialization.localizableStringSerializeAsObject?this.values[e[0]]:L.createCopy(this.values)}setJson(e){if(this.values={},!!e)if(Array.isArray(e))this.setValue(null,e);else for(var t in e)this.setValue(t,e[t])}getValuesKeys(){return Object.keys(this.values)}}function cR(n){return D&&D.confirmActionFunc?D.confirmActionFunc(n):confirm(n)}function Go(n){const e=t=>{t?n.funcOnYes():n.funcOnNo&&n.funcOnNo()};if(D&&D.confirmActionFunc){e(cR(n.message));return}D&&D.confirmActionAsync?D.confirmActionAsync(n.message,e,n):b1(n.message,e,n)}function Jo(){if(typeof Jo.isIEOrEdge>"u"){const n=navigator.userAgent,e=n.indexOf("MSIE "),t=n.indexOf("Trident/"),s=n.indexOf("Edge/");Jo.isIEOrEdge=s>0||t>0||e>0}return Jo.isIEOrEdge}function pR(n,e){try{const t=atob(n.split(",")[1]),s=n.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),r=new Uint8Array(i);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);const a=new Blob([i],{type:s});navigator&&navigator.msSaveBlob&&navigator.msSaveOrOpenBlob(a,e)}catch{}}const Ko=n=>!!n&&!!("host"in n&&n.host),gR=n=>{const{root:e}=D.environment;return typeof n=="string"?e.getElementById(n):n};function mR(n,e=0){if(typeof D.environment>"u"||!n.offsetHeight)return!1;const{root:t}=D.environment,s=Ko(t)?t.host.clientHeight:t.documentElement.clientHeight,i=n.getBoundingClientRect(),r=Math.max(s,he.getInnerHeight()),a=-e,o=r+e,l=i.top,u=i.bottom,d=Math.max(a,l),h=Math.min(o,u);return d<=h}function Zo(n){if(!n)return oe.isAvailable()?oe.getDocument().documentElement:void 0;if(n.scrollHeight>n.clientHeight&&(getComputedStyle(n).overflowY==="scroll"||getComputedStyle(n).overflowY==="auto")||n.scrollWidth>n.clientWidth&&(getComputedStyle(n).overflowX==="scroll"||getComputedStyle(n).overflowX==="auto"))return n;if(!n.parentElement){const e=n.getRootNode();if(e instanceof Document||e instanceof ShadowRoot)return Ko(e)?e.host:e.documentElement}return Zo(n.parentElement)}function xd(n){if(!n)return;const e=Zo(n);e&&setTimeout(()=>e.dispatchEvent(new CustomEvent("scroll")),10)}function fR(n){const e=he.getLocation();!n||!e||(e.href=wR(n))}function Vd(n){return n?["url(",n,")"].join(""):""}function yR(n){return typeof n=="string"?/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[^;]+?)*),(.+)$/.test(n):null}const f1={changecamera:"flip-24x24",clear:"clear-24x24",cancel:"cancel-24x24",closecamera:"close-24x24",defaultfile:"file-72x72",choosefile:"folder-24x24",file:"toolbox-file-24x24",left:"chevronleft-16x16",modernbooleancheckchecked:"plus-32x32",modernbooleancheckunchecked:"minus-32x32",more:"more-24x24",navmenu_24x24:"navmenu-24x24",removefile:"error-24x24",takepicture:"camera-32x32",takepicture_24x24:"camera-24x24",v2check:"check-16x16",checked:"check-16x16",v2check_24x24:"check-24x24","back-to-panel_16x16":"restoredown-16x16",clear_16x16:"clear-16x16",close_16x16:"close-16x16",collapsedetail:"collapsedetails-16x16",expanddetail:"expanddetails-16x16","full-screen_16x16":"maximize-16x16",loading:"loading-48x48",minimize_16x16:"minimize-16x16",next_16x16:"chevronright-16x16",previous_16x16:"chevronleft-16x16","no-image":"noimage-48x48","ranking-dash":"rankingundefined-16x16","drag-n-drop":"drag-24x24","ranking-arrows":"reorder-24x24",restore_16x16:"fullsize-16x16",reset:"restore-24x24",search:"search-24x24",average:"smiley-rate5-24x24",excellent:"smiley-rate9-24x24",good:"smiley-rate7-24x24",normal:"smiley-rate6-24x24","not-good":"smiley-rate4-24x24",perfect:"smiley-rate10-24x24",poor:"smiley-rate3-24x24",terrible:"smiley-rate1-24x24","very-good":"smiley-rate8-24x24","very-poor":"smiley-rate2-24x24",add_16x16:"add-16x16",add_24x24:"add-24x24",alert_24x24:"warning-24x24",apply:"apply-24x24","arrow-down":"arrowdown-24x24","arrow-left":"arrowleft-24x24","arrow-left_16x16":"arrowleft-16x16",arrowleft:"arrowleft-16x16","arrow-right":"arrowright-24x24","arrow-right_16x16":"arrowright-16x16",arrowright:"arrowright-16x16","arrow-up":"arrowup-24x24",boolean:"toolbox-boolean-24x24","change-question-type_16x16":"speechbubble-16x16",checkbox:"toolbox-checkbox-24x24","collapse-detail_16x16":"minusbox-16x16","collapse-panel":"collapse-pg-24x24",collapse_16x16:"collapse-16x16","color-picker":"dropper-16x16",comment:"toolbox-longtext-24x24",config:"wrench-24x24",copy:"copy-24x24",default:"toolbox-customquestion-24x24",delete_16x16:"delete-16x16",delete_24x24:"delete-24x24",delete:"delete-24x24","description-hide":"hidehint-16x16",description:"hint-16x16","device-desktop":"desktop-24x24","device-phone":"phone-24x24","device-rotate":"rotate-24x24","device-tablet":"tablet-24x24",download:"download-24x24","drag-area-indicator":"drag-24x24","drag-area-indicator_24x16":"draghorizontal-24x16",v2dragelement_16x16:"draghorizontal-24x16","drop-down-arrow":"chevrondown-24x24","drop-down-arrow_16x16":"chevrondown-16x16",chevron_16x16:"chevrondown-16x16",dropdown:"toolbox-dropdown-24x24",duplicate_16x16:"copy-16x16",edit:"edit-24x24",edit_16x16:"edit-16x16","editing-finish":"finishedit-24x24",error:"error-16x16","expand-detail_16x16":"plusbox-16x16","expand-panel":"expand-pg-24x24",expand_16x16:"expand-16x16",expression:"toolbox-expression-24x24","fast-entry":"textedit-24x24",fix:"fix-24x24",html:"toolbox-html-24x24",image:"toolbox-image-24x24",imagepicker:"toolbox-imagepicker-24x24",import:"import-24x24","invisible-items":"invisible-24x24",language:"language-24x24",load:"import-24x24","logic-collapse":"collapse-24x24","logic-expand":"expand-24x24",logo:"image-48x48",matrix:"toolbox-matrix-24x24",matrixdropdown:"toolbox-multimatrix-24x24",matrixdynamic:"toolbox-dynamicmatrix-24x24",multipletext:"toolbox-multipletext-24x24",panel:"toolbox-panel-24x24",paneldynamic:"toolbox-dynamicpanel-24x24",preview:"preview-24x24",radiogroup:"toolbox-radiogroup-24x24",ranking:"toolbox-ranking-24x24",rating:"toolbox-rating-24x24",slider:"toolbox-slider-24x24",redo:"redo-24x24",remove_16x16:"remove-16x16",required:"required-16x16",save:"save-24x24","select-page":"selectpage-24x24",settings:"settings-24x24",settings_16x16:"settings-16x16",signaturepad:"toolbox-signature-24x24","switch-active_16x16":"switchon-16x16","switch-inactive_16x16":"switchoff-16x16",tagbox:"toolbox-tagbox-24x24",text:"toolbox-singleline-24x24",theme:"theme-24x24",toolbox:"toolbox-24x24",undo:"undo-24x24",visible:"visible-24x24",wizard:"wand-24x24",searchclear:"clear-16x16","chevron-16x16":"chevrondown-16x16",chevron:"chevrondown-24x24",progressbuttonv2:"arrowleft-16x16",right:"chevronright-16x16","add-lg":"add-24x24",add:"add-24x24"};function vR(n){return CR(n)||Pd(n)}function Pd(n){const e="icon-",t=n.replace(e,""),s=f1[t]||t;return e+s}function CR(n){let e=D.customIcons[n];return e?Pd(e):(n=Pd(n),e=D.customIcons[n],e||null)}function bR(n,e,t,s,i,r){if(!i)return;n!=="auto"&&(i.style.width=(n||e||16)+"px",i.style.height=(n||t||16)+"px");const a=i.childNodes[0],o=vR(s);a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#"+o);let l=i.getElementsByTagName("title")[0];if(r)l||(l=oe.getDocument().createElementNS("http://www.w3.org/2000/svg","title"),i.appendChild(l));else{l&&i.removeChild(l);return}l.textContent=r}function wR(n){return n&&(n.toLocaleLowerCase().indexOf("javascript:")>-1?encodeURIComponent(n):n)}function er(n){if(typeof n=="string")if(isNaN(Number(n))){if(n.includes("px"))return parseFloat(n)}else return Number(n);if(typeof n=="number")return n}function Yo(n){if(er(n)===void 0)return n}const Sd="sv-focused--by-key";function y1(n){const e=n.target;!e||!e.classList||e.classList.remove(Sd)}function Id(n,e){if(n.target&&n.target.contentEditable==="true")return;const t=n.target;if(!t)return;const s=n.which||n.keyCode;if(s===9){t.classList&&!t.classList.contains(Sd)&&t.classList.add(Sd);return}if(e){if(!e.__keyDownReceived)return;e.__keyDownReceived=!1}s===13||s===32?t.click&&t.click():(!e||e.processEsc)&&s===27&&t.blur&&t.blur()}function xR(n,e={processEsc:!0}){if(e&&(e.__keyDownReceived=!0),n.target&&n.target.contentEditable==="true")return;var t=n.which||n.keyCode;const s=[13,32];e.processEsc&&s.push(27),s.indexOf(t)!==-1&&n.preventDefault()}function v1(n,e){if(!n)return;e||(e=a=>oe.getComputedStyle(a));const t=parseFloat(n.getAttribute("rows")||"2"),s=e(n),i=s.overflowY,r=parseFloat(s.lineHeight);if(n.scrollHeight){const a=parseFloat(s.borderTopWidth)+parseFloat(s.borderBottomWidth)+parseFloat(s.paddingBottom)+parseFloat(s.paddingTop);let o=(n.scrollHeight-a)/r;const l=u=>{n.style.height=u*r+a+"px"};for(l(o),n.style.overflowY="hidden";n.scrollHeight<=n.offsetHeight&&o>t;)o--,l(o);n.style.overflowY=i,n.scrollHeight>n.offsetHeight&&(o++,l(o))}else n.style.height="auto"}function C1(n){n.preventDefault(),n.stopPropagation()}function ls(n){if(!n)return n;const e=/\s*?([\w-]+)\s*?/g;return n.replace(e,".$1")}function Td(n){return getComputedStyle?Number.parseFloat(getComputedStyle(n).width):n.offsetWidth}function Ed(n){return!!(n.offsetWidth||n.offsetHeight||n.getClientRects().length)}function VR(n){let e;for(let t=0;t<n.children.length;t++)!e&&getComputedStyle(n.children[t]).display!=="none"&&(e=n.children[t]);return e}function xn(n,e){if(!(!e||!n)&&typeof e=="object")for(var t in n){var s=n[t];!Array.isArray(s)&&s&&typeof s=="object"?((!e[t]||typeof e[t]!="object")&&(e[t]={}),xn(s,e[t])):e[t]=s}}function Xo(n,e){const t={};xn(e.list,t),xn(n.list,t),n.list=t}function b1(n,e,t={}){const s=new wt(void 0,!1);s.defaultValue=n||t.message;const i=D.showDialog({componentName:"sv-string-viewer",data:{locStr:s,locString:s,model:s},onApply:()=>(e(!0),!0),onCancel:()=>(e(!1),!1),displayMode:"popup",isFocusedContent:!1,cssClass:t.cssClass||"sv-popup--confirm"},t.rootElement),r=i.footerToolbar,a=r.getActionById("apply"),o=r.getActionById("cancel");return o.title=bt("cancel",t.locale),a.title=t.applyTitle||bt("ok",t.locale),a.innerCss="sd-btn--danger",PR(i),!0}function PR(n){n.width="min-content"}function SR(n,e){he.isFileReaderAvailable()&&(n.value="",n.onchange=t=>{if(!he.isFileReaderAvailable()||!n||!n.files||n.files.length<1)return;let s=[];for(let i=0;i<n.files.length;i++)s.push(n.files[i]);e(s)},n.click())}function IR(n,e,t){const s=new Map,i=new Map,r=new Map,a=new Map;n.forEach(V=>{const P=t(V);if(!s.has(P))s.set(t(V),V);else throw new Error("keys must be unique")}),e.forEach(V=>{const P=t(V);if(!i.has(P))i.set(P,V);else throw new Error("keys must be unique")});const o=[],l=[];i.forEach((V,P)=>{s.has(P)?r.set(P,r.size):o.push(V)}),s.forEach((V,P)=>{i.has(P)?a.set(P,a.size):l.push(V)});const u=[];r.forEach((V,P)=>{const M=a.get(P),X=i.get(P);M!==V&&u.push({item:X,movedForward:M<V})});const d=new Array(n.length);let h=0;const f=Array.from(r.keys());n.forEach((V,P)=>{r.has(t(V))?(d[P]=i.get(f[h]),h++):d[P]=V});const C=new Map;let b=[];d.forEach(V=>{const P=t(V);i.has(P)?b.length>0&&(C.set(P,b),b=[]):b.push(V)});const x=new Array;return i.forEach((V,P)=>{C.has(P)&&C.get(P).forEach(M=>{x.push(M)}),x.push(V)}),b.forEach(V=>{x.push(V)}),{reorderedItems:u,deletedItems:l,addedItems:o,mergedItems:x}}function TR(n){if(oe.isAvailable()){const{paddingTop:e,paddingBottom:t,borderTopWidth:s,borderBottomWidth:i,marginTop:r,marginBottom:a,boxSizing:o}=oe.getComputedStyle(n);let l=n.offsetHeight+"px";if(o=="content-box"){let u=n.offsetHeight;[i,s,t,e].forEach(d=>{u-=parseFloat(d)}),l=u+"px"}return{paddingTop:e,paddingBottom:t,borderTopWidth:s,borderBottomWidth:i,marginTop:r,marginBottom:a,heightFrom:"0px",heightTo:l}}else return}function Vn(n,e,t="--animation-"){var s;n.__sv_created_properties=(s=n.__sv_created_properties)!==null&&s!==void 0?s:[],Object.keys(e).forEach(i=>{const r=`${t}${i.split(/\.?(?=[A-Z])/).join("-").toLowerCase()}`;n.style.setProperty(r,e[i]),n.__sv_created_properties.push(r)})}function ci(n){Vn(n,TR(n))}function Vs(n){Array.isArray(n.__sv_created_properties)&&(n.__sv_created_properties.forEach(e=>{n.style.removeProperty(e)}),delete n.__sv_created_properties)}function ER(n){return Math.floor(n*100)/100}const el=typeof globalThis<"u"?globalThis.document:(void 0).document,RR=el?{root:el,_rootElement:oe.getBody(),get rootElement(){var n;return(n=this._rootElement)!==null&&n!==void 0?n:oe.getBody()},set rootElement(n){this._rootElement=n},_popupMountContainer:oe.getBody(),get popupMountContainer(){var n;return(n=this._popupMountContainer)!==null&&n!==void 0?n:oe.getBody()},set popupMountContainer(n){this._popupMountContainer=n},svgMountContainer:el.head,stylesSheetsMountContainer:el.head}:void 0;var D={version:"",designMode:{showEmptyDescriptions:!0,showEmptyTitles:!0},get allowShowEmptyDescriptionInDesignMode(){return this.designMode.showEmptyDescriptions},set allowShowEmptyDescriptionInDesignMode(n){this.designMode.showEmptyDescriptions=n},get allowShowEmptyTitleInDesignMode(){return this.designMode.showEmptyTitles},set allowShowEmptyTitleInDesignMode(n){this.designMode.showEmptyTitles=n},localization:{useLocalTimeZone:!0,storeDuplicatedTranslations:!1,defaultLocaleName:"default"},get useLocalTimeZone(){return this.localization.useLocalTimeZone},set useLocalTimeZone(n){this.localization.useLocalTimeZone=n},get storeDuplicatedTranslations(){return this.localization.storeDuplicatedTranslations},set storeDuplicatedTranslations(n){this.localization.storeDuplicatedTranslations=n},get defaultLocaleName(){return this.localization.defaultLocaleName},set defaultLocaleName(n){this.localization.defaultLocaleName=n},web:{onBeforeRequestChoices:(n,e)=>{},encodeUrlParams:!0,cacheLoadedChoices:!0,disableQuestionWhileLoadingChoices:!1},get webserviceEncodeParameters(){return this.web.encodeUrlParams},set webserviceEncodeParameters(n){this.web.encodeUrlParams=n},get useCachingForChoicesRestful(){return this.web.cacheLoadedChoices},set useCachingForChoicesRestful(n){this.web.cacheLoadedChoices=n},get useCachingForChoicesRestfull(){return this.web.cacheLoadedChoices},set useCachingForChoicesRestfull(n){this.web.cacheLoadedChoices=n},get disableOnGettingChoicesFromWeb(){return this.web.disableQuestionWhileLoadingChoices},set disableOnGettingChoicesFromWeb(n){this.web.disableQuestionWhileLoadingChoices=n},triggers:{changeNavigationButtonsOnComplete:!0,executeCompleteOnValueChanged:!1,executeSkipOnValueChanged:!0},get executeCompleteTriggerOnValueChanged(){return this.triggers.executeCompleteOnValueChanged},set executeCompleteTriggerOnValueChanged(n){this.triggers.executeCompleteOnValueChanged=n},get changeNavigationButtonsOnCompleteTrigger(){return this.triggers.changeNavigationButtonsOnComplete},set changeNavigationButtonsOnCompleteTrigger(n){this.triggers.changeNavigationButtonsOnComplete=n},get executeSkipTriggerOnValueChanged(){return this.triggers.executeSkipOnValueChanged},set executeSkipTriggerOnValueChanged(n){this.triggers.executeSkipOnValueChanged=n},serialization:{itemValueSerializeAsObject:!1,itemValueSerializeDisplayText:!1,localizableStringSerializeAsObject:!1,matrixDropdownColumnSerializeTitle:!1},get itemValueAlwaysSerializeAsObject(){return this.serialization.itemValueSerializeAsObject},set itemValueAlwaysSerializeAsObject(n){this.serialization.itemValueSerializeAsObject=n},get itemValueAlwaysSerializeText(){return this.serialization.itemValueSerializeDisplayText},set itemValueAlwaysSerializeText(n){this.serialization.itemValueSerializeDisplayText=n},get serializeLocalizableStringAsObject(){return this.serialization.localizableStringSerializeAsObject},set serializeLocalizableStringAsObject(n){this.serialization.localizableStringSerializeAsObject=n},lazyRender:{enabled:!1,firstBatchSize:3},get lazyRowsRendering(){return this.lazyRender.enabled},set lazyRowsRendering(n){this.lazyRender.enabled=n},get lazyRowsRenderingStartRow(){return this.lazyRender.firstBatchSize},set lazyRowsRenderingStartRow(n){this.lazyRender.firstBatchSize=n},matrix:{defaultCellType:"dropdown",defaultRowName:"default",totalsSuffix:"-total",maxRowCount:1e3,maxRowCountInCondition:1,renderRemoveAsIcon:!0,columnWidthsByType:{file:{minWidth:"240px"},comment:{minWidth:"200px"}},rateSize:"small"},get matrixDefaultRowName(){return this.matrix.defaultRowName},set matrixDefaultRowName(n){this.matrix.defaultRowName=n},get matrixDefaultCellType(){return this.matrix.defaultCellType},set matrixDefaultCellType(n){this.matrix.defaultCellType=n},get matrixTotalValuePostFix(){return this.matrix.totalsSuffix},set matrixTotalValuePostFix(n){this.matrix.totalsSuffix=n},get matrixMaximumRowCount(){return this.matrix.maxRowCount},set matrixMaximumRowCount(n){this.matrix.maxRowCount=n},get matrixMaxRowCountInCondition(){return this.matrix.maxRowCountInCondition},set matrixMaxRowCountInCondition(n){this.matrix.maxRowCountInCondition=n},get matrixRenderRemoveAsIcon(){return this.matrix.renderRemoveAsIcon},set matrixRenderRemoveAsIcon(n){this.matrix.renderRemoveAsIcon=n},panel:{maxPanelCount:100,maxPanelCountInCondition:1},get panelDynamicMaxPanelCountInCondition(){return this.panel.maxPanelCountInCondition},set panelDynamicMaxPanelCountInCondition(n){this.panel.maxPanelCountInCondition=n},get panelMaximumPanelCount(){return this.panel.maxPanelCount},set panelMaximumPanelCount(n){this.panel.maxPanelCount=n},readOnly:{enableValidation:!1,commentRenderMode:"textarea",textRenderMode:"input"},get readOnlyCommentRenderMode(){return this.readOnly.commentRenderMode},set readOnlyCommentRenderMode(n){this.readOnly.commentRenderMode=n},get readOnlyTextRenderMode(){return this.readOnly.textRenderMode},set readOnlyTextRenderMode(n){this.readOnly.textRenderMode=n},numbering:{includeQuestionsWithHiddenNumber:!1,includeQuestionsWithHiddenTitle:!1},get setQuestionVisibleIndexForHiddenTitle(){return this.numbering.includeQuestionsWithHiddenTitle},set setQuestionVisibleIndexForHiddenTitle(n){this.numbering.includeQuestionsWithHiddenTitle=n},get setQuestionVisibleIndexForHiddenNumber(){return this.numbering.includeQuestionsWithHiddenNumber},set setQuestionVisibleIndexForHiddenNumber(n){this.numbering.includeQuestionsWithHiddenNumber=n},enterKeyAction:"default",comparator:{trimStrings:!0,caseSensitive:!1,normalizeTextCallback:(n,e)=>n},expressionDisableConversionChar:"#",get commentPrefix(){return D.commentSuffix},set commentPrefix(n){D.commentSuffix=n},commentSuffix:"-Comment",itemValueSeparator:"|",ratingMaximumRateValueCount:20,tagboxCloseOnSelect:!1,dropdownSearchDelay:500,confirmActionFunc:void 0,confirmActionAsync:(n,e,t)=>{b1(n,e,t)},minWidth:"300px",maxWidth:"100%",maxConditionRunCountOnValueChanged:10,notifications:{lifetime:2e3},autoAdvanceDelay:300,itemFlowDirection:"column",get showItemsInOrder(){return D.itemFlowDirection},set showItemsInOrder(n){D.itemFlowDirection=n},noneItemValue:"none",refuseItemValue:"refused",dontKnowItemValue:"dontknow",specialChoicesOrder:{selectAllItem:[-1],noneItem:[1],refuseItem:[2],dontKnowItem:[3],otherItem:[4]},choicesSeparator:", ",supportedValidators:{question:["expression"],comment:["text","regex"],text:["numeric","text","regex","email"],checkbox:["answercount"],imagepicker:["answercount"]},expressionVariables:{question:"self",matrix:"matrix",composite:"composite",item:"item",choice:"choice",row:"row",totalRow:"totalRow",rowIndex:"rowIndex",visibleRowIndex:"visibleRowIndex",rowValue:"rowValue",rowName:"rowName",rowTitle:"rowTitle",panel:"panel",parentPanel:"parentPanel",panelIndex:"panelIndex",visiblePanelIndex:"visiblePanelIndex",unwrapPostfix:"-unwrapped"},minDate:"",maxDate:"2999-12-31",showDialog:void 0,showDefaultItemsInCreator:!0,customIcons:{},rankingDragHandleArea:"entireItem",environment:RR,showMaxLengthIndicator:!0,animationEnabled:!0,titleTags:{survey:"div",page:"div",panel:"div",question:"div"},questions:{inputTypes:["color","date","datetime-local","email","month","number","password","range","tel","text","time","url","week"],dataList:["","name","honorific-prefix","given-name","additional-name","family-name","honorific-suffix","nickname","organization-title","username","new-password","current-password","organization","street-address","address-line1","address-line2","address-line3","address-level4","address-level3","address-level2","address-level1","country","country-name","postal-code","cc-name","cc-given-name","cc-additional-name","cc-family-name","cc-number","cc-exp","cc-exp-month","cc-exp-year","cc-csc","cc-type","transaction-currency","transaction-amount","language","bday","bday-day","bday-month","bday-year","sex","url","photo","tel","tel-country-code","tel-national","tel-area-code","tel-local","tel-local-prefix","tel-local-suffix","tel-extension","email","impp"]},legacyProgressBarView:!1,maskSettings:{patternPlaceholderChar:"_",patternEscapeChar:"\\",patternDefinitions:{9:/[0-9]/,a:/[a-zA-Z]/,"#":/[a-zA-Z0-9]/}},storeUtcDates:!1,onDateCreated:(n,e,t)=>n,parseNumber:(n,e)=>e};class es{constructor(e=null,t=null){this.text=e,this.errorOwner=t,this.visible=!0,this.onUpdateErrorTextCallback=void 0}equals(e){return!e||!e.getErrorType||this.getErrorType()!==e.getErrorType()?!1:this.text===e.text&&this.visible===e.visible}get locText(){return this.locTextValue||(this.locTextValue=new wt(this.errorOwner,!0),this.locTextValue.storeDefaultText=!0,this.locTextValue.text=this.getText()),this.locTextValue}get notificationType(){return this.notificationTypeValue||"error"}set notificationType(e){this.notificationTypeValue=e}get isWarning(){return this.notificationTypeValue==="warning"}get isInfo(){return this.notificationTypeValue==="info"}get isError(){return!this.isInfo&&!this.isWarning}getCssIcon(e){const t=this.getCssError(e);return(this.isWarning?t.warningIcon:this.isInfo?t.infoIcon:t.icon)||t.icon||void 0}getCssError(e){return e=e||{},e.error||{}}getText(){var e=this.text;return e||(e=this.getDefaultText()),this.errorOwner&&(e=this.errorOwner.getErrorCustomText(e,this)),e}getErrorType(){return"base"}getDefaultText(){return""}getLocale(){return this.errorOwner?this.errorOwner.getLocale():""}getLocalizationString(e){return bt(e,this.getLocale())}updateText(){this.onUpdateErrorTextCallback&&this.onUpdateErrorTextCallback(this),this.locText.text=this.getText()}}class _R extends es{constructor(e=null,t=null){super(e,t),this.text=e}getErrorType(){return"required"}getDefaultText(){return this.getLocalizationString("requiredError")}}class LR extends es{constructor(e=null,t=null){super(e,t),this.text=e}getErrorType(){return"requireoneanswer"}getDefaultText(){return this.getLocalizationString("requiredErrorInPanel")}}class AR extends es{constructor(e=null,t=null){super(e,t),this.text=e}getErrorType(){return"requirenumeric"}getDefaultText(){return this.getLocalizationString("numericError")}}class DR extends es{constructor(e,t=null){super(null,t),this.maxSize=e,this.locText.text=this.getText()}getErrorType(){return"exceedsize"}getDefaultText(){return this.getLocalizationString("exceedMaxSize").format(this.getTextSize())}getTextSize(){var e=["Bytes","KB","MB","GB","TB"],t=[0,0,2,3,3];if(this.maxSize===0)return"0 Byte";var s=Math.floor(Math.log(this.maxSize)/Math.log(1024)),i=this.maxSize/Math.pow(1024,s);return i.toFixed(t[s])+" "+e[s]}}class OR extends es{constructor(e,t=null){super(null,t),this.maxFiles=e,this.locText.text=this.getText()}getErrorType(){return"exceedfilescount"}getDefaultText(){return this.getLocalizationString("exceedMaxFiles").format(this.maxFiles)}}class w1 extends es{constructor(e,t,s=null){super(null,s),this.status=e,this.response=t}getErrorType(){return"webrequest"}getDefaultText(){const e=this.getLocalizationString("urlRequestError");return e?e.format(this.status,this.response):""}}class MR extends es{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"webrequestempty"}getDefaultText(){return this.getLocalizationString("urlGetChoicesError")}}class kR extends es{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"otherempty"}getDefaultText(){return this.getLocalizationString("otherRequiredError")}}class tl extends es{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"uploadingfile"}getDefaultText(){return this.getLocalizationString("uploadingFile")}}class NR extends es{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"requiredinallrowserror"}getDefaultText(){return this.getLocalizationString("requiredInAllRowsError")}}class qR extends es{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"eachrowuniqueeerror"}getDefaultText(){return this.getLocalizationString("eachRowUniqueError")}}class BR extends es{constructor(e,t=null){super(null,t),this.minRowCount=e}getErrorType(){return"minrowcounterror"}getDefaultText(){return this.getLocalizationString("minRowCountError").format(this.minRowCount)}}class x1 extends es{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"keyduplicationerror"}getDefaultText(){return this.getLocalizationString("keyDuplicationError")}}class Ps extends es{constructor(e,t=null){super(e,t),this.text=e}getErrorType(){return"custom"}}class V1{constructor(e){this.onCompleted=e,this.asyncElements={},this.isRunningValue=!0}addElement(e){this.asyncElements[e]=!0}removeElement(e){delete this.asyncElements[e],this.tryComplete()}finish(){this.isRunningValue=!1,this.tryComplete()}get isRunning(){return this.isRunningValue||Object.keys(this.asyncElements).length>0}doCompleted(){this.onCompleted&&this.onCompleted()}tryComplete(){this.isRunning||this.doCompleted()}}class Js{constructor(e,t=null){this.value=e,this.error=t}}class Mr extends de{constructor(){super(),this.createLocalizableString("text",this,!0)}get id(){return"svd"+this.uniqueId}get isValidator(){return!0}getSurvey(e=!1){return this.errorOwner&&this.errorOwner.getSurvey?this.errorOwner.getSurvey():null}get notificationType(){return this.getPropertyValue("notificationType")}set notificationType(e){this.setPropertyValue("notificationType",e)}get text(){return this.getLocalizableStringText("text")}set text(e){this.setLocalizableStringText("text",e)}get locText(){return this.getLocalizableString("text")}getErrorText(e){return this.text?this.text:this.getDefaultErrorText(e)}getDefaultErrorText(e){return""}validateOnCallback(e,t,s,i){const r=this.validate(e,s,i);return t&&t(r),r}validate(e,t,s){return null}getLocale(){return this.errorOwner?this.errorOwner.getLocale():""}getMarkdownHtml(e,t,s){return this.errorOwner?this.errorOwner.getMarkdownHtml(e,t,s):void 0}getRenderer(e){return this.errorOwner?this.errorOwner.getRenderer(e):null}getRendererContext(e){return this.errorOwner?this.errorOwner.getRendererContext(e):e}getProcessedText(e){return this.errorOwner?this.errorOwner.getProcessedText(e):e}createCustomError(e){const t=new Ps(this.getErrorText(e),this.errorOwner);return t.onUpdateErrorTextCallback=(s=>s.text=this.getErrorText(e)),t}toString(){var e=this.getType().replace("validator","");return this.text&&(e+=", "+this.text),e}}class FR{run(e){const t=e.getValidators(),s=new Array,i=new V1(()=>{this.onAsyncCompleted&&this.onAsyncCompleted(s)});if(t.length>0){const a=e.getDataFilteredProperties(),o=e.validatedValue,l=e.getValidatorTitle();t.forEach(u=>{i.addElement(u.id),u.validateOnCallback(o,d=>{d&&d.error&&(d.error.notificationType=u.notificationType,s.push(d.error)),i.removeElement(u.id)},l,a)})}const r=[].concat(...s);return s.length=0,i.finish(),r}}class QR extends Mr{constructor(e=null,t=null){super(),this.minValue=e,this.maxValue=t}getType(){return"numericvalidator"}validate(e,t,s){if(this.isValueEmpty(e))return null;if(!L.isNumber(e))return new Js(null,new AR(this.text,this.errorOwner));const i=new Js(L.getNumber(e));return this.minValue!==null&&this.minValue>i.value?(i.error=this.createCustomError(t),i):this.maxValue!==null&&this.maxValue<i.value?(i.error=this.createCustomError(t),i):typeof e=="number"?null:i}getDefaultErrorText(e){var t=e||this.getLocalizationString("value");return this.minValue!==null&&this.maxValue!==null?this.getLocalizationFormatString("numericMinMax",t,this.minValue,this.maxValue):this.minValue!==null?this.getLocalizationFormatString("numericMin",t,this.minValue):this.getLocalizationFormatString("numericMax",t,this.maxValue)}get minValue(){return this.getPropertyValue("minValue")}set minValue(e){this.setPropertyValue("minValue",e)}get maxValue(){return this.getPropertyValue("maxValue")}set maxValue(e){this.setPropertyValue("maxValue",e)}}class HR extends Mr{constructor(){super()}getType(){return"textvalidator"}validate(e,t,s){if(this.isValueEmpty(e))return null;if(!this.allowDigits){var i=/\d+$/;if(i.test(e))return new Js(null,this.createCustomError("textNoDigitsAllow"))}return this.minLength>0&&e.length<this.minLength?new Js(null,this.createCustomError(t)):this.maxLength>0&&e.length>this.maxLength?new Js(null,this.createCustomError(t)):null}getDefaultErrorText(e){return e==="textNoDigitsAllow"?this.getLocalizationString(e):this.minLength>0&&this.maxLength>0?this.getLocalizationFormatString("textMinMaxLength",this.minLength,this.maxLength):this.minLength>0?this.getLocalizationFormatString("textMinLength",this.minLength):this.getLocalizationFormatString("textMaxLength",this.maxLength)}get minLength(){return this.getPropertyValue("minLength")}set minLength(e){this.setPropertyValue("minLength",e)}get maxLength(){return this.getPropertyValue("maxLength")}set maxLength(e){this.setPropertyValue("maxLength",e)}get allowDigits(){return this.getPropertyValue("allowDigits")}set allowDigits(e){this.setPropertyValue("allowDigits",e)}}class zR extends Mr{constructor(e=null,t=null){super(),this.minCount=e,this.maxCount=t}getType(){return"answercountvalidator"}validate(e,t,s){if(e==null||e.constructor!=Array)return null;var i=e.length;return i==0?null:this.minCount&&i<this.minCount?new Js(null,this.createCustomError(this.getLocalizationFormatString("minSelectError",this.minCount))):this.maxCount&&i>this.maxCount?new Js(null,this.createCustomError(this.getLocalizationFormatString("maxSelectError",this.maxCount))):null}getDefaultErrorText(e){return e}get minCount(){return this.getPropertyValue("minCount")}set minCount(e){this.setPropertyValue("minCount",e)}get maxCount(){return this.getPropertyValue("maxCount")}set maxCount(e){this.setPropertyValue("maxCount",e)}}class jR extends Mr{constructor(e=null){super(),this.regex=e}getType(){return"regexvalidator"}validate(e,t,s){if(!this.regex||this.isValueEmpty(e))return null;const i=this.createRegExp();if(Array.isArray(e))for(let r=0;r<e.length;r++){const a=this.hasError(i,e[r],t);if(a)return a}return this.hasError(i,e,t)}hasError(e,t,s){return e.test(t)?null:new Js(t,this.createCustomError(s))}get regex(){return this.getPropertyValue("regex")}set regex(e){this.setPropertyValue("regex",e)}get caseInsensitive(){return this.getPropertyValue("caseInsensitive")}set caseInsensitive(e){this.setPropertyValue("caseInsensitive",e)}get insensitive(){return this.caseInsensitive}set insensitive(e){this.caseInsensitive=e}createRegExp(){return new RegExp(this.regex,this.caseInsensitive?"i":"")}}class P1 extends Mr{constructor(){super(),this.re=/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()=[\]\.,;:\s@\"]+\.)+[^<>()=[\]\.,;:\s@\"]{2,})$/i}getType(){return"emailvalidator"}validate(e,t,s){return!e||this.re.test(e)?null:new Js(e,this.createCustomError(t))}getDefaultErrorText(e){return this.getLocalizationString("invalidEmail")}}class UR extends Mr{constructor(e=null){super(),this.conditionRunner=null,this.expression=e}getType(){return"expressionvalidator"}validateOnCallback(e,t,s,i){this.conditionRunner&&(this.conditionRunner.onRunComplete=null);let r=null;const a=l=>{r=this.generateError(l,e,s),t&&t(r)};if(!this.ensureConditionRunner())return a(!0),null;if(this.conditionRunner.onRunComplete=l=>{a(l)},!this.conditionRunner.canRun())return a(o),r;var o=this.conditionRunner.runContext(this.getValueGetterContext(),this.getPropertiesCopy(i,"expression"));return r||this.generateError(o,e,s)}generateError(e,t,s){return e?null:new Js(t,this.createCustomError(s))}getDefaultErrorText(e){return this.getLocalizationFormatString("invalidExpression",this.expression)}ensureConditionRunner(){const e=this.getExpressionFromSurvey("expression");return e?(this.conditionRunner=new Gs(e),!0):!1}get expression(){return this.getPropertyValue("expression")}set expression(e){this.setPropertyValue("expression",e)}getValueGetterContext(){const e=this.errorOwner;return e&&e.getValueGetterContext?e.getValueGetterContext():super.getValueGetterContext()}}B.addClass("surveyvalidator",[{name:"text",serializationProperty:"locText"},{name:"notificationType",choices:["error","warning","info"],default:"error",visible:!0,category:"general",visibleIndex:100}]),B.addClass("numericvalidator",["minValue:number","maxValue:number"],function(){return new QR},"surveyvalidator"),B.addClass("textvalidator",[{name:"minLength:number",default:0},{name:"maxLength:number",default:0},{name:"allowDigits:boolean",default:!0}],function(){return new HR},"surveyvalidator"),B.addClass("answercountvalidator",["minCount:number","maxCount:number"],function(){return new zR},"surveyvalidator"),B.addClass("regexvalidator",["regex",{name:"caseInsensitive:boolean",alternativeName:"insensitive"}],function(){return new jR},"surveyvalidator"),B.addClass("emailvalidator",[],function(){return new P1},"surveyvalidator"),B.addClass("expressionvalidator",["expression:condition"],function(){return new UR},"surveyvalidator");class WR{constructor(e,t){this.name=e,this.widgetJson=t,this.htmlTemplate=t.htmlTemplate?t.htmlTemplate:""}afterRender(e,t){this.widgetJson.afterRender&&(e.localeChangedCallback=()=>{this.widgetJson.willUnmount&&this.widgetJson.willUnmount(e,t),this.widgetJson.afterRender(e,t)},this.widgetJson.afterRender(e,t))}willUnmount(e,t){this.widgetJson.willUnmount&&this.widgetJson.willUnmount(e,t)}getDisplayValue(e,t=void 0){return this.widgetJson.getDisplayValue?this.widgetJson.getDisplayValue(e,t):null}validate(e){if(this.widgetJson.validate)return this.widgetJson.validate(e)}isFit(e){return this.isLibraryLoaded()&&this.widgetJson.isFit?this.widgetJson.isFit(e):!1}get canShowInToolbox(){return this.widgetJson.showInToolbox===!1||sl.Instance.getActivatedBy(this.name)!="customtype"?!1:!this.widgetJson.widgetIsLoaded||this.widgetJson.widgetIsLoaded()}get showInToolbox(){return this.widgetJson.showInToolbox!==!1}set showInToolbox(e){this.widgetJson.showInToolbox=e}init(){this.widgetJson.init&&this.widgetJson.init()}activatedByChanged(e){this.isLibraryLoaded()&&this.widgetJson.activatedByChanged&&this.widgetJson.activatedByChanged(e)}isLibraryLoaded(){return this.widgetJson.widgetIsLoaded?this.widgetJson.widgetIsLoaded()==!0:!0}get isDefaultRender(){return this.widgetJson.isDefaultRender}get pdfQuestionType(){return this.widgetJson.pdfQuestionType}get pdfRender(){return this.widgetJson.pdfRender}}class sl{constructor(){this.widgetsValues=[],this.widgetsActivatedBy={},this.onCustomWidgetAdded=new o1}get widgets(){return this.widgetsValues}add(e,t="property"){this.addCustomWidget(e,t)}addCustomWidget(e,t="property"){var s=e.name;s||(s="widget_"+this.widgets.length+1);var i=new WR(s,e);return this.widgetsValues.push(i),i.init(),this.widgetsActivatedBy[s]=t,i.activatedByChanged(t),this.onCustomWidgetAdded.fire(i,null),i}getActivatedBy(e){var t=this.widgetsActivatedBy[e];return t||"property"}setActivatedBy(e,t){if(!(!e||!t)){var s=this.getCustomWidgetByName(e);s&&(this.widgetsActivatedBy[e]=t,s.activatedByChanged(t))}}clear(){this.widgetsValues=[]}getCustomWidgetByName(e){for(var t=0;t<this.widgets.length;t++)if(this.widgets[t].name==e)return this.widgets[t];return null}getCustomWidget(e){for(var t=0;t<this.widgetsValues.length;t++)if(this.widgetsValues[t].isFit(e))return this.widgetsValues[t];return null}}sl.Instance=new sl;class pi{constructor(){this.renderersHash={},this.defaultHash={}}unregisterRenderer(e,t){delete this.renderersHash[e][t],this.defaultHash[e]===t&&delete this.defaultHash[e]}registerRenderer(e,t,s,i=!1){this.renderersHash[e]||(this.renderersHash[e]={}),this.renderersHash[e][t]=s,i&&(this.defaultHash[e]=t)}getRenderer(e,t){const s=this.renderersHash[e];if(s){if(t&&s[t])return s[t];const i=this.defaultHash[e];if(i&&s[i])return s[i]}return"default"}getRendererByQuestion(e){return this.getRenderer(e.getType(),e.renderAs)}clear(){this.renderersHash={}}}pi.Instance=new pi;class Rd{updateElement(){this.element&&this.autoGrow&&setTimeout(()=>v1(this.element),1)}constructor(e){this.options=e,this.onPropertyChangedCallback=()=>{this.element&&(this.element.value=this.getTextValue(),this.updateElement())},this.question.registerFunctionOnPropertiesValueChanged(this.options.propertyNames,this.onPropertyChangedCallback,"__textarea")}setElement(e){e&&(this.element=e,this.updateElement())}resetElement(){this.element=void 0}getTextValue(){return this.options.getTextValue&&this.options.getTextValue()||""}onTextAreaChange(e){this.options.onTextAreaChange&&this.options.onTextAreaChange(e)}onTextAreaInput(e){this.options.onTextAreaInput&&this.options.onTextAreaInput(e),this.element&&this.autoGrow&&v1(this.element)}onTextAreaKeyDown(e){this.options.onTextAreaKeyDown&&this.options.onTextAreaKeyDown(e)}onTextAreaBlur(e){this.onTextAreaChange(e),this.options.onTextAreaBlur&&this.options.onTextAreaBlur(e)}onTextAreaFocus(e){var t;this.options.onTextAreaFocus&&this.options.onTextAreaFocus(e),this.isReadOnlyAttr&&((t=e?.target)===null||t===void 0||t.select())}get question(){return this.options.question}get id(){return this.options.id()}get placeholder(){return this.options.placeholder()}get className(){return this.options.className()}get maxLength(){if(this.options.maxLength)return this.options.maxLength()}get autoGrow(){if(this.options.autoGrow)return this.options.autoGrow()}get rows(){if(this.options.rows)return this.options.rows()}get cols(){if(this.options.cols)return this.options.cols()}get isDisabledAttr(){return this.options.isDisabledAttr()}get isReadOnlyAttr(){if(this.options.isReadOnlyAttr)return this.options.isReadOnlyAttr()}get ariaRequired(){if(this.options.ariaRequired)return this.options.ariaRequired()}get ariaLabel(){if(this.options.ariaLabel)return this.options.ariaLabel()}get ariaInvalid(){if(this.options.ariaInvalid)return this.options.ariaInvalid()}get ariaLabelledBy(){if(this.options.ariaLabelledBy)return this.options.ariaLabelledBy()}get ariaDescribedBy(){if(this.options.ariaDescribedBy)return this.options.ariaDescribedBy()}get ariaErrormessage(){if(this.options.ariaErrormessage)return this.options.ariaErrormessage()}dispose(){this.question&&this.question.unRegisterFunctionOnPropertiesValueChanged(this.options.propertyNames,"__textarea"),this.resetElement()}}class il{constructor(e,t){this.question=e,this.isUnwrapped=t}getValue(e,t,s,i){const r=D.expressionVariables;if(e.length===0||e.length===1&&e[0].name===r.question)return this.getQuestionValue(s);if(e.length>1&&e[0].name===r.panel){const a=this.question.parent;if(a&&a.isPanel)return e.shift(),new _d(a.questions).getValue(e,!1,s,i)}if(!this.question.isEmpty()){let a=this.question.value;if(s>=0){if(!Array.isArray(a||s>=a.length))return;a=a[s]}return new ws(a).getValue(e,!1,s,i)}}getTextValue(e,t,s){return s?this.question.getDisplayValue(!0,t):t}getRootObj(){return this.question.data}getQuestion(){return this.question}getSurveyValue(e,t){const s=this.question.getSurvey();if(s)return s.getValueGetterContext().getValue(e,!1,t,!1)}getQuestionValue(e){const t=this.question;let s=t.getFilteredValue(this.isUnwrapped);return e>-1&&Array.isArray(s)&&(s=e<s.length?s[e]:void 0),{isFound:!0,context:this,value:s,requireStrictCompare:t.requireStrictCompare}}}class S1 extends Zi{getValueFromBindedQuestions(e,t){typeof t!="object"&&(t=void 0);const s=e.length===1?e[0].name:"",i=this.getQuestionsBySameValueNames();for(let r=0;r<i.length;r++){const a=i[r];if(s&&a.valuePropertyName===s&&t&&t.hasOwnProperty(s))return{isFound:!0,value:t[s],context:a.getValueGetterContext()};const o=a.getValueGetterContext().getValue(e,!1,this.getIndex(),!1);if(o&&o.isFound)return o}}getQuestionsBySameValueNames(){const e=new Array,t=this.getQuestionData();return!t||!t.isQuestion||(t.parent&&t.parent.isPanel&&this.fillQuestions(t.parent.getQuestionsByValueName(t.getValueName()),t,e),e.length===0&&t.survey&&this.fillQuestions(t.survey.getQuestionsByValueName(t.getValueName()),t,e)),e}fillQuestions(e,t,s){Array.isArray(e)&&e.forEach(i=>{i!==t&&s.push(i)})}getRootObj(){return this.getQuestionData()}}class _d extends Zi{constructor(e){super(),this.questions=e}isSearchNameRevert(){return!0}updateValueByItem(e,t){const s=e.toLocaleLowerCase(),i=D.expressionVariables.unwrapPostfix;for(let r=0;r<this.questions.length;r++){const a=this.questions[r],o=a.getFilteredName().toLocaleLowerCase();if(o.toLocaleLowerCase()===s){t.isFound=!0,t.context=a.getValueGetterContext(o.endsWith(i));break}}}}class kr extends V1{constructor(e){super(()=>{this.setCallbackResult()}),this.res=!0,this.errorCountValue=0,e||(e={fireCallback:!0}),this.fireCallbackValue=e.fireCallback||!1,this.isOnValueChangedValue=e.isOnValueChanged||!1,this.focusOnFirstErrorValue=e.focusOnFirstError||!1,this.callbackResult=e.callbackResult||null,this.changeCurrentPage=e.changeCurrentPage||!1}get fireCallback(){return this.fireCallbackValue}get isOnValueChanged(){return this.isOnValueChangedValue}get focusOnFirstError(){return this.focusOnFirstErrorValue}get result(){return this.res}get runningResult(){return!this.res||!this.isRunning||!this.callbackResult?this.res:void 0}setErrorElement(e,t){Array.isArray(t)&&this.isWarningOnlyOrEmpty(t)||(this.errorCountValue++,this.res=!1,e&&(e.isQuestion?this.setQuestionError(e):e.isCollapsed&&e.expand()))}isWarningOnlyOrEmpty(e){for(let t=0;t<e.length;t++){const s=e[t];if(s.isError&&s.visible)return!1}return!0}get firstErrorQuestion(){return this.firstErrorQuestionValue}get errorCount(){return this.errorCountValue}setCallbackResult(){this.callbackResult&&!this.isCallbackFired&&(this.isCallbackFired=!0,this.callbackResult(this.res,this.firstErrorQuestion))}setQuestionError(e){if(e.expandAllParents(),!this.firstErrorQuestionValue){if(this.firstErrorQuestionValue=e,this.focusOnFirstError||this.changeCurrentPage)if(this.focusOnFirstError)e.focus(!0);else{const t=e.getSurvey();t&&e.page&&(t.currentPage=e.page)}this.setCallbackResult()}}}class kt extends Ke{isReadOnlyRenderDiv(){return this.isReadOnly&&D.readOnly.commentRenderMode==="div"}allowMobileInDesignMode(){return!1}updateIsMobileFromSurvey(){this.setIsMobile(this.survey._isMobile)}setIsMobile(e){const t=e&&(this.allowMobileInDesignMode()||!this.isDesignMode);this.isMobile=t}getIsMobile(){return this._isMobile}get isMobile(){return this.getIsMobile()}set isMobile(e){this._isMobile=e}themeChanged(e){}get _isMobile(){return this.getPropertyValue("_isMobile",!1)}set _isMobile(e){this.setPropertyValue("_isMobile",e)}get forceIsInputReadOnly(){return this.getPropertyValue("forceIsInputReadOnly")}set forceIsInputReadOnly(e){this.setPropertyValue("forceIsInputReadOnly",e)}get ariaExpanded(){return this.isNewA11yStructure?null:this.getPropertyValue("ariaExpanded")}set ariaExpanded(e){this.setPropertyValue("ariaExpanded",e)}constructor(e){super(e),this.customWidgetData={isNeedRender:!0},this.hasCssErrorCallback=()=>!1,this.triggersInfo=[],this.isReadyValue=!0,this.dependedQuestions=[],this.onReadyChanged=this.addEvent(),this.isValueChangedInSurvey=!1,this.allowNotifyValueChanged=!0,this._syncPropertiesChanging=!1,this.setPropertyValueDirectly("id","sq_"+this.uniqueId),this.onCreating(),this.createNewArray("validators",t=>{t.errorOwner=this}),this.addExpressionProperty("visibleIf",(t,s)=>{this.visible=s===!0}),this.addExpressionProperty("enableIf",(t,s)=>{this.readOnly=s===!1}),this.addExpressionProperty("requiredIf",(t,s)=>{this.isRequired=s===!0}),this.createLocalizableString("commentText",this,!0,!0),this.createLocalizableString("requiredErrorText"),this.createLocalizableString("commentPlaceholder"),this.createLocalizableString("defaultDisplayValue"),this.addTriggersInfo(),this.registerPropertyChangedHandlers(["width"],()=>{this.updateQuestionCss(),this.parent&&this.parent.elementWidthChanged(this)}),this.registerPropertyChangedHandlers(["isRequired"],()=>{!this.isRequired&&this.errors.length>0&&this.validate(),this.locTitle.strChanged(),this.clearCssClasses()}),this.registerPropertyChangedHandlers(["indent","rightIndent"],()=>{this.resetIndents()}),this.registerPropertyChangedHandlers(["showCommentArea","showOtherItem"],()=>{this.initCommentFromSurvey()}),this.registerPropertyChangedHandlers(["commentPlaceholder"],()=>{this.resetRenderedCommentPlaceholder()}),this.registerFunctionOnPropertiesValueChanged(["no","readOnly","hasVisibleErrors","containsErrors"],()=>{this.updateQuestionCss()}),this.registerPropertyChangedHandlers(["_isMobile"],()=>{this.onMobileChanged()}),this.registerPropertyChangedHandlers(["colSpan"],()=>{var t;(t=this.parent)===null||t===void 0||t.updateColumns()})}getDefaultTitle(){return this.name}createLocTitleProperty(){const e=super.createLocTitleProperty();return e.storeDefaultText=!0,e.onGetTextCallback=(t,s)=>(!t&&!s&&(t=this.getDefaultTitle()),this.survey?this.survey.getUpdatedQuestionTitle(this,t):t),this.locProcessedTitle=new wt(this,!0),this.locProcessedTitle.sharedData=e,e}get locRenderedTitle(){return this.isSingleInputActive&&this.singleInputLocTitle?this.singleInputLocTitle:this.locTitle}get commentTextAreaModel(){return this.commentTextAreaModelValue||(this.commentTextAreaModelValue=new Rd(this.getCommentTextAreaOptions())),this.commentTextAreaModelValue}getCommentTextAreaOptions(){return{question:this,id:()=>this.commentId,propertyNames:["comment"],className:()=>this.cssClasses.comment,placeholder:()=>this.renderedCommentPlaceholder,isDisabledAttr:()=>this.isInputReadOnly||!1,rows:()=>this.commentAreaRows,autoGrow:()=>this.autoGrowComment,maxLength:()=>this.getOthersMaxLength(),ariaRequired:()=>this.a11y_input_ariaRequired,ariaLabel:()=>this.a11y_input_ariaLabel,getTextValue:()=>this.comment,onTextAreaChange:t=>{this.onCommentChange(t)},onTextAreaInput:t=>{this.onCommentInput(t)}}}getSurvey(e=!1){return e?this.parent?this.parent.getSurvey(e):null:this.onGetSurvey?this.onGetSurvey():super.getSurvey()}getValueName(){return this.valueName?this.valueName.toString():this.name}get valueName(){return this.getPropertyValue("valueName","")}set valueName(e){var t=this.getValueName();this.setPropertyValue("valueName",e),this.onValueNameChanged(t)}onValueNameChanged(e){this.survey&&(this.survey.questionRenamed(this,this.name,e||this.name),this.initDataFromSurvey())}onNameChanged(e){this.locTitle.strChanged(),this.survey&&this.survey.questionRenamed(this,e,this.valueName?this.valueName:e)}get isReady(){return this.isReadyValue}onAsyncRunningChanged(){this.updateIsReady()}ensureQuestionIsReady(){this.displayValue}waitForQuestionIsReady(e){return new Promise(t=>{if(this.ensureQuestionIsReady(),this.isReady)t(),e&&e();else{const s=(i,r)=>{r.isReady&&(this.onReadyChanged.remove(s),t(),e&&e())};this.onReadyChanged.add(s)}})}updateIsReady(){let e=this.getIsQuestionReady();if(e){const t=this.getIsReadyDependsOn();for(let s=0;s<t.length;s++)if(!t[s].getIsQuestionReady()){e=!1;break}}this.setIsReady(e)}getIsQuestionReady(){return!this.isAsyncExpressionRunning&&this.getAreNestedQuestionsReady()}getAreNestedQuestionsReady(){const e=this.getIsReadyNestedQuestions();if(!Array.isArray(e))return!0;for(let t=0;t<e.length;t++)if(!e[t].isReady)return!1;return!0}getIsReadyNestedQuestions(){return this.getNestedQuestions()}setIsReady(e){const t=this.isReadyValue;this.isReadyValue=e,t!=e&&(this.getIsReadyDependends().forEach(s=>s.updateIsReady()),this.onReadyChanged.fire(this,{question:this,isReady:e,oldIsReady:t}))}getIsReadyDependsOn(){return this.getIsReadyDependendCore(!0)}getIsReadyDependends(){return this.getIsReadyDependendCore(!1)}getDependedQuestionsByValueName(e){return this.survey.questionsByValueName(this.getValueName())}getIsReadyDependendCore(e){if(!this.survey)return[];const t=this.getDependedQuestionsByValueName(e),s=new Array;return t.forEach(i=>{i!==this&&s.push(i)}),e||(this.parentQuestion&&s.push(this.parentQuestion),this.dependedQuestions.length>0&&this.dependedQuestions.forEach(i=>s.push(i))),s}choicesLoaded(){}get page(){return this.parentQuestion?this.parentQuestion.page:this.getPage(this.parent)}set page(e){this.setPage(this.parent,e)}getPanels(){return null}getPageVisibleIndex(){var e;return((e=this.page)===null||e===void 0?void 0:e.visibleIndex)||-1}delete(e=!0){this.removeFromParent(),e?this.dispose():this.resetDependedQuestions()}removeFromParent(){this.parent&&this.removeSelfFromList(this.parent.elements)}addDependedQuestion(e){!e||this.dependedQuestions.indexOf(e)>-1||this.dependedQuestions.push(e)}removeDependedQuestion(e){if(e){var t=this.dependedQuestions.indexOf(e);t>-1&&this.dependedQuestions.splice(t,1)}}updateDependedQuestions(){for(var e=0;e<this.dependedQuestions.length;e++)this.dependedQuestions[e].updateDependedQuestion()}updateDependedQuestion(){}resetDependedQuestion(){}get isFlowLayout(){return this.getLayoutType()==="flow"}getLayoutType(){return this.parent?this.parent.getChildrenLayoutType():"row"}isLayoutTypeSupported(e){return e!=="flow"}get visible(){return this.getPropertyValue("visible")}set visible(e){e!=this.visible&&(this.setPropertyValue("visible",e),this.onVisibleChangedCore(),this.notifySurveyVisibilityChanged())}onVisibleChanged(){const e=this.getPropertyValue("isVisible");this.onVisibleChangedCore();const t=this.getPropertyValue("isVisible");e!==void 0&&e!==t&&this.notifySurveyVisibilityChanged()}onVisibleChangedCore(){this.updateIsVisibleProp(),!this.isVisible&&this.errors&&this.errors.length>0&&(this.errors=[])}notifyStateChanged(e){super.notifyStateChanged(e),this.isCollapsed&&this.onHidingContent()}updateElementVisibility(){this.updateIsVisibleProp()}updateIsVisibleProp(){const e=this.getPropertyValue("isVisible"),t=this.isVisible;e!==t&&(this.setPropertyValue("isVisible",t),t||this.onHidingContent()),t!==this.visible&&this.areInvisibleElementsShowing&&this.updateQuestionCss(!0)}get useDisplayValuesInDynamicTexts(){return this.getPropertyValue("useDisplayValuesInDynamicTexts")}set useDisplayValuesInDynamicTexts(e){this.setPropertyValue("useDisplayValuesInDynamicTexts",e)}getUseDisplayValuesInDynamicTexts(){return this.useDisplayValuesInDynamicTexts}get visibleIf(){return this.getPropertyValue("visibleIf","")}set visibleIf(e){this.setPropertyValue("visibleIf",e)}get isVisible(){return this.survey&&this.survey.areEmptyElementsHidden&&this.isEmpty()?!1:this.areInvisibleElementsShowing?!0:this.isVisibleCore()}get isVisibleInSurvey(){return this.isVisible&&this.isParentVisible}isVisibleCore(){return this.visible}get visibleIndex(){return this.getPropertyValue("visibleIndex",-1)}onHidingContent(){}get showNumber(){return this.getPropertyValue("showNumber")}set showNumber(e){this.setPropertyValue("showNumber",e),this.notifySurveyVisibilityChanged()}get hideNumber(){return!this.showNumber}set hideNumber(e){this.showNumber=!e}get isAllowTitleLeft(){return!0}getType(){return"question"}get isQuestion(){return!0}moveTo(e,t=null){return this.moveToBase(this.parent,e,t)}getProgressInfo(){return this.hasInput?{questionCount:1,answeredQuestionCount:this.isEmpty()?0:1,requiredQuestionCount:this.isRequired?1:0,requiredAnsweredQuestionCount:!this.isEmpty()&&this.isRequired?1:0}:super.getProgressInfo()}runTriggerInfo(e,t,s){this.runExpressionByProperty(e.name,s,i=>{e.doComplete(i,s)},i=>e.canRun()?!t||this.canExecuteTriggerByKeys(t,i,this.getExpressionByProperty(e.secondName)):!1)}canExecuteTriggerByKeys(e,t,s){!t&&s&&(t=s,s=void 0);const i=this.canExecuteTriggerByKeysCore(e,t);return i==="var"?!0:s?this.canExecuteTriggerByKeysCore(e,s)!=="":i==="func"||i==="const"}canExecuteTriggerByKeysCore(e,t){if(!t.expression)return"";const s=t.getVariables();return!Array.isArray(s)||s.length===0?t.hasFunction()?"func":"const":new Di().isAnyKeyChanged(e,s)?"var":""}getValueGetterContext(e){return new il(this,e)}addTriggersInfo(){this.addTriggerInfo({name:"resetValueIf",canRun:()=>!this.isEmpty(),doComplete:(e,t)=>{e===!0&&(this.startSetValueOnExpression(),this.updateValueWithDefaultsOrClear(),this.finishSetValueOnExpression())}}),this.addTriggerInfo({name:"setValueIf",secondName:"setValueExpression",canRun:()=>!0,doComplete:(e,t)=>{if(e)if(!this.setValueExpression)this.clearValue();else{const s={name:"setValueExpression",canRun:()=>!0,doComplete:(i,r)=>this.runExpressionSetValue(i)};this.runTriggerInfo(s,void 0,t)}}}),this.addTriggerInfo({name:"setValueExpression",canRun:()=>!this.setValueIf,doComplete:(e,t)=>this.runExpressionSetValue(e)})}addTriggerInfo(e){this.triggersInfo.push(e)}runTriggers(e,t,s){if(this.isSettingQuestionValue||this.parentQuestion&&this.parentQuestion.getValueName()===e)return;s||(s={},s[e]=t);const i=this.getDataFilteredProperties();this.triggersInfo.forEach(r=>{this.runTriggerInfo(r,s,i)})}runConditions(){this.data&&!this.isLoadingFromJson&&(this.isDesignMode||this.runCondition(this.getDataFilteredProperties()),this.locStrsChanged())}setSurveyImpl(e,t){super.setSurveyImpl(e),this.survey&&(this.survey.questionCreated(this),t!==!0&&this.runConditions(),this.visible||this.updateIsVisibleProp(),this.updateIsMobileFromSurvey())}get parent(){return this.getPropertyValue("parent",null)}set parent(e){this.parent!==e&&(this.removeFromParent(),this.setPropertyValue("parent",e),e&&this.updateQuestionCss(),this.onParentChanged())}onParentChanged(){}calculateSingleInputQuestion(){if(!this.isSingleInputActive)return;const e=this.getSingleInputQuestions();if(Array.isArray(e)&&e.length>0){const t=e[0];return this.onBeforeSetSingleInputQuestion(t),t}}get singleInputQuestion(){const e=this.survey;if(!(!e||!e.isSingleVisibleInput))return this.getPropertyValue("singleInputQuestion",void 0,()=>this.calculateSingleInputQuestion())}get currentSingleInputQuestion(){let e=this.singleInputQuestion;for(;e&&e.singleInputQuestion&&e.singleInputQuestion!==e;)e=e.singleInputQuestion;return e}get currentSingleInputParentQuestion(){const e=this.currentSingleInputQuestion;return e?e.singleInputQuestion===e?e:e.parentQuestion||this:this}get singleInputSummary(){return this.getPropertyValue("singleInputSummary",void 0,()=>{if(!this.supportNestedSingleInput())return;const e=this.singleInputQuestion;if(!e||e!==this)return;const t=this.createSingleInputSummary();return t&&(this.calcSingleInputActions(),this.resetPropertyValue("singleInputLocTitle")),t})}createSingleInputSummary(){}get rootParentQuestion(){let e=this;for(;e.parentQuestion;)e=e.parentQuestion;return e}getParentQuestions(){const e=new Array;let t=this;for(;t.parentQuestion;)e.push(t.parentQuestion),t=t.parentQuestion;return e}resetSingleInput(){this.resetSingleInputCore()}resetSingleInputCore(){const e=this.getPropertyValue("singleInputQuestion");this.resetPropertyValue("singleInputQuestion"),e&&this.onSingleInputChanged()}onSingleInputChanged(e=!0){var t,s;e&&this.resetSingleInputSummary(),(t=this.singleInputLocTitle)===null||t===void 0||t.strChanged(),this.resetPropertyValue("singleInputLocTitle"),this.calcSingleInputActions(),(s=this.survey)===null||s===void 0||s.updateNavigationElements()}resetSingleInputSummary(){var e;(e=this.singleInputSummary)===null||e===void 0||e.dispose(),this.resetPropertyValue("singleInputSummary")}validateSingleInput(){const e=this.currentSingleInputQuestion;return e?e.validate(!0,!0):!0}getSingleInputElementPos(){if(this.singleInputQuestion===this)return 0;const e=this.currentSingleInputParentQuestion;if(e!==this&&e.getSingleInputElementPos()===2)return 2;const t=this.singleInputQuestion,s=this.getSingleInputQuestions();if(s.length<2)return 0;let i=s.indexOf(t);return i===0?-1:i>=s.length-1?1:2}get isSingleInputActive(){const e=this.survey;if(!e||!e.isSingleVisibleInput)return!1;const t=e.currentSingleQuestion;return!!t&&t===this.rootParentQuestion}singleInputOnAddItem(e){this.isSingleInputActive&&(e&&this.singleInputSummary?this.resetSingleInputSummary():this.setSingleQuestionOnChange(Number.MAX_VALUE))}singleInputOnRemoveItem(e){this.isSingleInputActive&&(this.singleInputSummary?this.onSingleInputChanged():this.setSingleQuestionOnChange(e))}getSingleQuestionOnChange(e){return null}setSingleQuestionOnChange(e){const t=this.getSingleQuestionOnChange(e);t?this.setSingleInputQuestion(t):this.resetSingleInput()}onSetAsSingleInput(){this.isSingleInputSummaryShown=!1;const e=!this.wasRendered||this.singleInputSummary;this.onFirstRendering(),e&&(this.resetSingleInputSummary(),this.resetPropertyValue("singleInputQuestion"),this.resetPropertyValue("singleInputLocTitle"))}nextSingleInput(){return this.nextPrevSingleInput(1)}prevSingleInput(){return this.nextPrevSingleInput(-1)}getSingleInputAddText(){const e=this.currentSingleInputQuestion;if(!e)return;if(e.singleInputSummary)return e.getSingleInputAddTextCore();const t=this.getSingleInputQuestions(),s=Array.isArray(t)?t.length:0;if(s>0&&t[s-1]===e)return this.getSingleInputAddTextCore()}singleInputAddItem(e){(!e||this.validateSingleInput())&&this.currentSingleInputQuestion.singleInputAddItemCore()}get singleInputLocTitle(){return this.getPropertyValue("singleInputLocTitle",void 0,()=>this.getSingleQuestionLocTitle())}get singleInputActions(){return this.getPropertyValue("singleInputActions",void 0,()=>this.createSingleInputActions())}get singleInputHasActions(){return this.getPropertyValue("singleInputHasActions",void 0,()=>this.createSingleInputActions())}get singleInputHideHeader(){var e;return!!((e=this.singleInputQuestion)===null||e===void 0?void 0:e.singleInputQuestion)&&this.singleInputQuestion!==this}set singleInputHasActions(e){this.setPropertyValue("singleInputHasActions",e)}get singleInputParentQuestion(){var e;return((e=this.singleInputQuestion)===null||e===void 0?void 0:e.parentQuestion)||this}createSingleInputActions(){var e;if(((e=this.survey)===null||e===void 0?void 0:e.currentSingleQuestion)!==this)return;const t=new Vt;return t.actions=this.getSingleQuestionActions(),t}calcSingleInputActions(){if(this.parentQuestion)this.parentQuestion.calcSingleInputActions();else{const e=this.getSingleQuestionActions();this.singleInputActions&&(this.singleInputActions.actions=e),this.singleInputHasActions=e.length>0?!0:void 0}}getSingleQuestionActions(){const e=new Array,t=this.currentSingleInputParentQuestion;if(!t||t===this)return e;const s=t.getSingleInputQuestions(),i=new Array;let r;s.length>1&&s[0]===t&&(r=t,i.push(t));let a=t.parentQuestion;for(;a;)i.push(a),a=a.parentQuestion;for(let o=i.length-1;o>=0;o--){const l=i[o];if(l!==r){const u=l.singleInputLocTitle,d=new xe({id:"single-action"+l.id,locTitle:u,css:this.cssClasses.breadcrumbsItem,innerCss:this.cssClasses.breadcrumbsItemButton,action:()=>{l.singleInputMoveToFirst()}});d.cssClasses={},e.push(d)}}return e}singleInputMoveToFirst(){const e=this.singleInputQuestion;e&&e!==this&&e.singleInputMoveToFirst(),this.singleInputMoveToFirstCore()}singleInputMoveToFirstCore(){}getSingleQuestionLocTitle(){return this.singleInputSummary?void 0:this.getSingleQuestionLocTitleCore()}getSingleQuestionLocTitleCore(){}supportNestedSingleInput(){var e;return(e=this.survey)===null||e===void 0?void 0:e.supportsNestedSingleInput(this)}getSingleInputQuestions(){if(!this.supportNestedSingleInput())return[];const e=this.getPropertyValue("singleInputQuestion");if(e===this)return[this];const t=this.getSingleInputQuestionsCore(e,!e||!this.isSingleInputSummaryShown);return this.survey&&this.survey.updateNestedSingleQuestions(this,t),t.forEach(s=>{s!==this&&this.onSingleInputQuestionAdded(s)}),t}getSingleInputQuestionsCore(e,t){return this.getNestedQuestions(!0,!1)}onSingleInputQuestionAdded(e){}fillSingleInputQuestionsInContainer(e,t){}getSingleInputQuestionsForDynamic(e,t){const s=new Array;return e&&e!==this&&t.indexOf(e)<0&&this.fillSingleInputQuestionsInContainer(s,e),t.forEach(i=>s.push(i)),this.isSingleInputSummaryShown&&s.length>0&&s.unshift(this),s.push(this),s}getSingleInputAddTextCore(){}singleInputAddItemCore(){}setSingleInputQuestionCore(e){this.onBeforeSetSingleInputQuestion(e),this.setPropertyValue("singleInputQuestion",e)}onBeforeSetSingleInputQuestion(e){e.onFirstRendering(),e===this&&(this.isSingleInputSummaryShown=!0)}setSingleInputQuestion(e,t){this.singleInputQuestion!==e&&(this.setSingleInputQuestionCore(e),this.onSingleInputChanged(!t||e!==this))}nextPrevSingleInput(e){let t=this.currentSingleInputParentQuestion;for(;t&&t!==this;){if(t.nextPrevSingleInput(e))return!0;t=t.parentQuestion}const s=this.singleInputQuestion;if(!s)return!1;const i=this.getSingleInputQuestions();let r=i.indexOf(s);if(r<0){if(i.length===0)return!1;r=0,e=0}return r+=e,r<0||r>=i.length?!1:(this.setSingleInputQuestion(i[r],e<0),!0)}get hasTitle(){return this.getTitleLocation()!=="hidden"&&!this.singleInputHideHeader}get titleLocation(){return this.getPropertyValue("titleLocation")}set titleLocation(e){var t=this.titleLocation=="hidden"||e=="hidden";this.setPropertyValue("titleLocation",e.toLowerCase()),this.updateQuestionCss(),t&&this.notifySurveyVisibilityChanged()}get showTitle(){return this.getTitleLocation()!=="hidden"}set showTitle(e){this.titleLocation=e?"default":"hidden"}getTitleOwner(){return this}getIsTitleRenderedAsString(){return this.titleLocation==="hidden"}notifySurveyOnChildrenVisibilityChanged(){return!1}notifySurveyVisibilityChanged(){if(!this.canUpdateValueOnVisibleChanged())return;this.survey.questionVisibilityChanged(this,this.isVisible,!this.parentQuestion||this.parentQuestion.notifySurveyOnChildrenVisibilityChanged());const e=this.isClearValueOnHidden;this.visible||this.clearValueOnHidding(e),e&&this.isVisibleInSurvey&&this.updateValueWithDefaults()}clearValueOnHidding(e){e&&this.clearValueIfInvisible()}get titleWidth(){if(this.parent&&this.getTitleLocation()==="left"){const e=this.parent.getColumsForElement(this),t=e.length;if(t!==0&&e[0].questionTitleWidth)return e[0].questionTitleWidth;const s=this.getQuestionParentTitleWidth(),i=this.getPercentQuestionTitleWidth(s);if(!i&&this.parent){let r=s;return r&&!isNaN(r)&&(r=r+"px"),r}return i/(t||1)+"%"}}getQuestionParentTitleWidth(){if(!this.parent)return;const e=this.parent.getQuestionTitleWidth();return!e&&this.parentQuestion?this.parentQuestion.getQuestionParentTitleWidth():e}getPercentQuestionTitleWidth(e){if(e&&e[e.length-1]==="%")return parseInt(e)}getTitleLocation(){if(this.isFlowLayout)return"hidden";var e=this.getTitleLocationCore();return e==="left"&&!this.isAllowTitleLeft&&(e="top"),e}getTitleLocationCore(){return this.titleLocation!=="default"?this.titleLocation:this.getParentTitleLocation()}getParentTitleLocation(){return this.parent?this.parent.getQuestionTitleLocation():this.survey?this.survey.questionTitleLocation:"top"}get hasTitleOnLeft(){return this.hasTitle&&this.getTitleLocation()==="left"}get hasTitleOnTop(){return this.hasTitle&&this.getTitleLocation()==="top"}get hasTitleOnBottom(){return this.hasTitle&&this.getTitleLocation()==="bottom"}get hasTitleOnLeftTop(){if(!this.hasTitle)return!1;const e=this.getTitleLocation();return e==="left"||e==="top"}get errorLocation(){return this.getPropertyValue("errorLocation")}set errorLocation(e){this.setPropertyValue("errorLocation",e)}getErrorLocation(){return this.errorLocation!=="default"?this.errorLocation:this.parentQuestion?this.parentQuestion.getChildErrorLocation(this):this.parent?this.parent.getQuestionErrorLocation():this.survey?this.survey.questionErrorLocation:"top"}getChildErrorLocation(e){return this.getErrorLocation()}get hasInput(){return!0}get hasSingleInput(){return this.hasInput&&!this.isContainer}get inputId(){return this.id+"i"}getDefaultTitleValue(){return this.name}getDefaultTitleTagName(){return D.titleTags.question}get descriptionLocation(){return this.getPropertyValue("descriptionLocation")}set descriptionLocation(e){this.setPropertyValue("descriptionLocation",e),this.updateQuestionCss()}get hasDescriptionUnderTitle(){return this.getDescriptionLocation()=="underTitle"&&this.hasDescription}get hasDescriptionUnderInput(){return this.getDescriptionLocation()=="underInput"&&this.hasDescription}getDescriptionLocation(){return this.descriptionLocation!=="default"?this.descriptionLocation:this.survey?this.survey.questionDescriptionLocation:"underTitle"}needClickTitleFunction(){return super.needClickTitleFunction()||this.hasInput}processTitleClick(){if(super.processTitleClick(),!this.isCollapsed)return setTimeout(()=>{this.focus()},1),!0}get requiredErrorText(){return this.getLocalizableStringText("requiredErrorText")}set requiredErrorText(e){this.setLocalizableStringText("requiredErrorText",e)}get locRequiredErrorText(){return this.getLocalizableString("requiredErrorText")}get commentText(){return this.getLocalizableStringText("commentText")}set commentText(e){this.setLocalizableStringText("commentText",e)}get locCommentText(){return this.getLocalizableString("commentText")}get commentPlaceholder(){return this.getLocalizableStringText("commentPlaceholder")}set commentPlaceholder(e){this.setLocalizableStringText("commentPlaceholder",e)}get locCommentPlaceholder(){return this.getLocalizableString("commentPlaceholder")}get commentPlaceHolder(){return this.commentPlaceholder}set commentPlaceHolder(e){this.commentPlaceholder=e}get renderedCommentPlaceholder(){var e;return(e=this.getPropertyValue("renderedCommentPlaceholder"))!==null&&e!==void 0?e:this.isReadOnly?void 0:this.commentPlaceholder}resetRenderedCommentPlaceholder(){this.resetPropertyValue("renderedCommentPlaceholder")}get defaultDisplayValue(){return this.getLocalizableStringText("defaultDisplayValue")}set defaultDisplayValue(e){this.setLocalizableStringText("defaultDisplayValue",e)}get locDefaultDisplayValue(){return this.getLocalizableString("defaultDisplayValue")}getAllErrors(){return this.errors.slice()}getErrorByType(e){for(let t=0;t<this.errors.length;t++)if(this.errors[t].getErrorType()===e)return this.errors[t];return null}get customWidget(){return!this.isCustomWidgetRequested&&!this.customWidgetValue&&(this.isCustomWidgetRequested=!0,this.updateCustomWidget()),this.customWidgetValue}updateCustomWidget(){this.customWidgetValue=sl.Instance.getCustomWidget(this)}localeChanged(){super.localeChanged(),this.resetRenderedCommentPlaceholder(),this.localeChangedCallback&&this.localeChangedCallback()}get isCompositeQuestion(){return!1}get isContainer(){return!1}onCommentInput(e){this.isInputTextUpdate&&e.target&&(this.comment=e.target.value)}onCommentChange(e){this.comment=e.target.value,this.comment!==e.target.value&&(e.target.value=this.comment)}afterRenderQuestionElement(e){!this.survey||!this.hasSingleInput||this.survey.afterRenderQuestionInput(this,e)}afterRender(e){this.afterRenderCore(e),this.survey&&(this.survey.afterRenderQuestion(this,e),this.afterRenderQuestionCallback&&this.afterRenderQuestionCallback(this,e),(this.supportComment()||this.supportOther())&&(this.commentElements=[],this.getCommentElementsId().forEach(t=>{const s=e?.querySelector(`#${t}`);s&&this.commentElements.push(s)})),this.checkForResponsiveness(e))}afterRenderCore(e){super.afterRenderCore(e)}getCommentElementsId(){return[this.commentId]}beforeDestroyQuestionElement(e){this.commentElements=void 0}get processedTitle(){var e=this.locProcessedTitle.textOrHtml;return e||this.name}get fullTitle(){return this.locTitle.renderedHtml}get titlePattern(){return this.survey?this.survey.questionTitlePattern:"numTitleRequire"}get isRequireTextOnStart(){return this.isRequired&&this.titlePattern=="requireNumTitle"}get isRequireTextBeforeTitle(){return this.isRequired&&this.titlePattern=="numRequireTitle"&&this.requiredMark!==""}get isRequireTextAfterTitle(){return this.isRequired&&this.titlePattern=="numTitleRequire"&&this.requiredMark!==""}get startWithNewLine(){return this.getPropertyValue("startWithNewLine")}set startWithNewLine(e){this.startWithNewLine!=e&&this.setPropertyValue("startWithNewLine",e)}calcCssClasses(e){const t={error:{}};return this.copyCssClasses(t,e.question),this.copyCssClasses(t.error,e.error),this.updateCssClasses(t,e),t}onCalcCssClasses(e){super.onCalcCssClasses(e),this.survey&&this.survey.updateQuestionCssClasses(this,e),this.onUpdateCssClassesCallback&&this.onUpdateCssClassesCallback(e)}get cssRoot(){return this.ensureElementCss(),this.getPropertyValue("cssRoot","")}setCssRoot(e){this.setPropertyValue("cssRoot",e)}getCssRoot(e){const t=this.hasCssError(!0);return new j().append(super.getCssRoot(e)).append(this.isFlowLayout&&!this.isDesignMode?e.flowRoot:e.mainRoot).append(e.titleLeftRoot,!this.isFlowLayout&&this.hasTitleOnLeft).append(e.titleTopRoot,!this.isFlowLayout&&this.hasTitleOnTop).append(e.titleBottomRoot,!this.isFlowLayout&&this.hasTitleOnBottom).append(e.descriptionUnderInputRoot,!this.isFlowLayout&&this.hasDescriptionUnderInput).append(e.hasError,t).append(e.hasErrorTop,t&&this.getErrorLocation()=="top").append(e.hasErrorBottom,t&&this.getErrorLocation()=="bottom").append(e.small,!this.width).append(e.answered,this.isAnswered).append(e.noPointerEventsMode,this.isReadOnlyAttr).toString()}get cssHeader(){return this.ensureElementCss(),this.getPropertyValue("cssHeader","")}setCssHeader(e){this.setPropertyValue("cssHeader",e)}getCssHeader(e){return new j().append(e.header).append(e.headerTop,this.hasTitleOnTop).append(e.headerLeft,this.hasTitleOnLeft).append(e.headerBottom,this.hasTitleOnBottom).toString()}supportContainerQueries(){return!1}get cssContent(){return this.ensureElementCss(),this.getPropertyValue("cssContent","")}setCssContent(e){this.setPropertyValue("cssContent",e)}getCssContent(e){return new j().append(e.content).append(e.contentSupportContainerQueries,this.supportContainerQueries()).append(e.contentLeft,this.hasTitleOnLeft).toString()}get cssTitle(){return this.ensureElementCss(),this.getPropertyValue("cssTitle","")}setCssTitle(e){this.setPropertyValue("cssTitle",e)}getCssTitle(e){return new j().append(super.getCssTitle(e)).append(e.singleInputTitle,!!this.singleInputQuestion).append(e.titleOnAnswer,!this.containsErrors&&this.isAnswered).append(e.titleEmpty,!this.title.trim()).toString()}get cssDescription(){return this.ensureElementCss(),this.getPropertyValue("cssDescription","")}setCssDescription(e){this.setPropertyValue("cssDescription",e)}getCssDescription(e){return new j().append(e.description).append(e.descriptionUnderInput,this.getDescriptionLocation()=="underInput").toString()}get showErrorsAboveQuestion(){return this.getErrorLocation()==="top"}get showErrorsBelowQuestion(){return this.getErrorLocation()==="bottom"}get cssError(){return this.ensureElementCss(),this.getPropertyValue("cssError","")}setCssError(e){this.setPropertyValue("cssError",e)}getCssError(e){return new j().append(e.error.root).append(e.error.warningMode,this.currentNotificationType==="warning").append(e.error.infoMode,this.currentNotificationType==="info").append(e.errorsContainer).append(e.errorsContainerTop,this.showErrorsAboveQuestion).append(e.errorsContainerBottom,this.showErrorsBelowQuestion).toString()}hasCssError(e){const t=this.errors;for(let s=0;s<t.length;s++){const i=t[s];if(i.visible&&(e||i.isError))return!0}return this.hasCssErrorCallback()}updateVisibleErrors(){super.updateVisibleErrors(),this.updateQuestionCss()}get isSingleInputQuestionMode(){var e;return!!this.parentQuestion&&((e=this.survey)===null||e===void 0?void 0:e.isSingleVisibleInput)}getIsNested(){return this.isSingleInputQuestionMode?!1:super.getIsNested()}getHasFrameV2(){return this.isSingleInputQuestionMode?!0:super.getHasFrameV2()}getRootCss(){return new j().append(this.cssRoot,!this.singleInputQuestion).append(this.cssClasses.mobile,this.isMobile).append(this.cssClasses.readOnly,this.isReadOnlyStyle).append(this.cssClasses.disabled,this.isDisabledStyle).append(this.cssClasses.preview,this.isPreviewStyle).append(this.cssClasses.invisible,!this.isDesignMode&&this.areInvisibleElementsShowing&&!this.visible).toString()}getQuestionRootCss(){return new j().append(this.cssClasses.root).append(this.cssClasses.rootMobile,this.isMobile).toString()}updateElementCss(e){this.wasRendered?(super.updateElementCss(e),e&&this.updateQuestionCss(!0)):this.clearCssClasses(),this.resetIndents()}updateQuestionCss(e){this.isLoadingFromJson||!this.survey||(this.wasRendered?this.updateElementCssCore(this.cssClasses):this.isRequireUpdateElements=!0)}ensureElementCss(){this.cssClassesValue||this.updateQuestionCss(!0)}updateElementCssCore(e){this.setCssRoot(this.getCssRoot(e)),this.setCssHeader(this.getCssHeader(e)),this.setCssContent(this.getCssContent(e)),this.setCssTitle(this.getCssTitle(e)),this.setCssDescription(this.getCssDescription(e)),this.setCssError(this.getCssError(e))}updateCssClasses(e,t){if(!t.question)return;const s=t[this.getCssType()],i=new j().append(e.title).append(t.question.titleRequired,this.isRequired);e.title=i.toString();const r=new j().append(e.root).append(s,this.isRequired&&!!t.question.required);if(s==null)e.root=r.toString();else if(typeof s=="string"||s instanceof String)e.root=r.append(s.toString()).toString();else{e.root=r.toString();for(const a in s)e[a]=s[a]}}getCssType(){return this.getType()}get renderCssRoot(){return this.cssClasses.root||void 0}calcPaddingLeft(){return this.getIndentSize(this.indent)}calcPaddingRight(){return this.getIndentSize(this.rightIndent)}getIndentSize(e){return e<1||!this.getSurvey()||!this.cssClasses||!this.cssClasses.indent?"":e*this.cssClasses.indent+"px"}focus(e=!1,t){if(this.isDesignMode||!this.isVisible||this.isReadOnly||!this.survey)return;let s=this.page;const i=!!s&&this.survey.activePage!==s,r=this.survey.isSingleVisibleInput;if(i&&!r)this.survey.focusQuestionByInstance(this,e);else if(r){this.survey.currentSingleQuestion=this.rootParentQuestion;const a=this.getParentQuestions();for(let o=a.length-1;o>=1;o--)o===a.length-1&&a[o].setSingleInputQuestion(a[o-1]);a.length>0&&a[0].setSingleInputQuestion(this),this.focusInputElement(e)}else{this.expandAllParents();const a=this.survey.isSmoothScrollEnabled?{behavior:"smooth"}:void 0;this.survey.scrollElementToTop(this,this,null,this.id,t,a,void 0,()=>{this.focusInputElement(e)})}}focusInputElement(e){var t;const s=e?this.getFirstErrorInputElementId():this.getFirstInputElementId(),i=(t=this.survey)===null||t===void 0?void 0:t.rootElement;(Ke.FocusElement(s,!1,i)||this.customWidget)&&this.fireCallback(this.focusCallback)}get isValidateVisitedEmptyFields(){return this.supportEmptyValidation()&&!!this.survey&&this.survey.getValidateVisitedEmptyFields()&&this.isEmpty()}supportEmptyValidation(){return!1}onBlur(e){this.onBlurCore(e)}onFocus(e){this.onFocusCore(e)}onBlurCore(e){this.isFocusEmpty&&this.isEmpty()&&this.validate(!0)}onFocusCore(e){this.isFocusEmpty=this.isValidateVisitedEmptyFields}expandAllParents(){this.expandAllParentsCore(this)}expandAllParentsCore(e){e&&(e.isCollapsed&&e.expand(),this.expandAllParentsCore(e.parent),this.expandAllParentsCore(e.parentQuestion))}focusIn(){!this.survey||this.isDisposed||this.isContainer||this.survey.whenQuestionFocusIn(this)}fireCallback(e){e&&e()}getOthersMaxLength(){return this.survey&&this.survey.maxCommentLength>0?this.survey.maxCommentLength:null}onCreating(){}getFirstQuestionToFocus(e){return this.hasInput&&(!e||this.currentErrorCount>0)?this:null}getFirstInputElementId(){return this.inputId}getFirstErrorInputElementId(){return this.getFirstInputElementId()}supportComment(){const e=this.getPropertyByName("showCommentArea");return!e||e.visible}supportOther(){return!1}get isRequired(){return this.getPropertyValue("isRequired")}set isRequired(e){this.setPropertyValue("isRequired",e)}get requiredIf(){return this.getPropertyValue("requiredIf","")}set requiredIf(e){this.setPropertyValue("requiredIf",e)}get showCommentArea(){return this.getPropertyValue("showCommentArea",!1)}set showCommentArea(e){this.supportComment()&&this.setPropertyValue("showCommentArea",e)}get hasComment(){return this.showCommentArea}set hasComment(e){this.showCommentArea=e}get id(){return this.getPropertyValue("id")}set id(e){this.setPropertyValue("id",e)}get ariaTitleId(){return this.id+"_ariaTitle"}get ariaDescriptionId(){return this.id+"_ariaDescription"}get commentId(){return this.id+"_comment"}get requireUpdateCommentValue(){return this.showCommentArea}get isReadOnly(){const e=!!this.parent&&this.parent.isReadOnly,t=!!this.parentQuestion&&this.parentQuestion.isReadOnly,s=!!this.survey&&this.survey.isDisplayMode,i=!!this.readOnlyCallback&&this.readOnlyCallback();return this.readOnly||e||s||t||i}get isInputReadOnly(){return this.forceIsInputReadOnly!==void 0?this.forceIsInputReadOnly:this.isReadOnly||this.isDesignMode}get renderedInputReadOnly(){return this.isInputReadOnly?"":void 0}get renderedInputDisabled(){return this.isInputReadOnly?"":void 0}get isReadOnlyAttr(){return this.isReadOnly}get isDisabledAttr(){return this.isDesignMode||!!this.readOnlyCallback&&this.readOnlyCallback()}onReadOnlyChanged(){this.setPropertyValue("isInputReadOnly",this.isInputReadOnly),super.onReadOnlyChanged(),this.isReadOnly&&this.clearErrors(),this.updateQuestionCss(),this.resetRenderedCommentPlaceholder()}get enableIf(){return this.getPropertyValue("enableIf","")}set enableIf(e){this.setPropertyValue("enableIf",e)}surveyChoiceItemVisibilityChange(){}runCondition(e){this.isDesignMode||(e||(e={}),e.question=this,this.runConditionCore(e),!this.isValueChangedDirectly&&(!this.isClearValueOnHidden||this.isVisibleInSurvey)&&this.runDefaultValueExpression(e))}get isInDesignMode(){return!this.isContentElement&&this.isDesignMode}get no(){return this.getPropertyValue("no",void 0,()=>this.calcNo())}calcNo(){let e="";const t=this.hasTitle&&this.showNumber&&this.visibleIndex>=0;return t&&(e=L.getNumberByIndex(this.visibleIndex,this.getStartIndex())),this.onGetNoCallback&&(e=this.onGetNoCallback(e)),t&&(this.parent&&(e=this.parent.addNoFromChild(e)),this.survey&&(e=this.survey.getUpdatedQuestionNo(this,e))),e}onSurveyLoad(){this.isCustomWidgetRequested=!1,this.fireCallback(this.surveyLoadCallback),this.updateValueWithDefaults(),this.isEmpty()&&this.initDataFromSurvey()}onSetData(){super.onSetData(),!this.isDesignMode&&this.survey&&!this.isLoadingFromJson&&(this.initDataFromSurvey(),this.onSurveyValueChanged(this.value),this.updateValueWithDefaults(),this.updateIsAnswered())}initDataFromSurvey(){if(this.data){const e=this.data.getValue(this.getValueName());(!L.isValueEmpty(e)||!this.isLoadingFromJson)&&this.updateValueFromSurvey(e),this.initCommentFromSurvey()}}initCommentFromSurvey(){this.data&&this.requireUpdateCommentValue?this.updateCommentFromSurvey(this.data.getComment(this.getValueName())):this.updateCommentFromSurvey("")}runExpression(e){if(!(!this.survey||!e))return this.survey.runExpression(e)}get commentAreaRows(){return this.survey&&this.survey.commentAreaRows}get autoGrowComment(){return this.survey&&this.survey.autoGrowComment}get allowResizeComment(){return this.survey&&this.survey.allowResizeComment}get questionValue(){return this.getPropertyValueWithoutDefault("value")}set questionValue(e){this.setPropertyValue("value",e)}get questionComment(){return this.getPropertyValueWithoutDefault("comment")}set questionComment(e){this.setPropertyValue("comment",e),this.fireCallback(this.commentChangedCallback)}get isValueArray(){return!1}get value(){return this.getValueCore()}set value(e){this.setNewValue(e)}getStructuredValue(e=-1){return this.value}get hasFilteredValue(){return!1}getFilteredValue(e){return this.value}getFilteredName(){return this.getValueName()}get valueForSurvey(){return this.valueForSurveyCore(this.value)}valueForSurveyCore(e){return this.valueToDataCallback?this.valueToDataCallback(e):e}valueFromDataCore(e){return this.valueFromDataCallback?this.valueFromDataCallback(e):e}clearValue(e,t){this.value!==void 0&&(this.value=void 0),this.comment&&e!==!0&&(this.comment=void 0),this.setValueChangedDirectly(t===!0)}clearValueFromUI(){this.clearValue(!0,!0)}clearValueOnly(){this.clearValue(!0)}unbindValue(){this.clearValue()}createValueCopy(){return this.getUnbindValue(this.value)}initDataUI(){}getUnbindValue(e){return this.isValueSurveyElement(e)?e:L.getUnbindValue(e)}isValueSurveyElement(e){return e?Array.isArray(e)?e.length>0?this.isValueSurveyElement(e[0]):!1:e.isSurveyObj===!0:!1}canClearValueAsInvisible(e){return e==="onHiddenContainer"&&!this.isParentVisible?!0:this.isVisibleInSurvey||this.page&&this.page.isStartPage?!1:this.survey?!this.survey.hasVisibleQuestionByValueName(this):!0}get isParentVisible(){if(this.parentQuestion&&!this.parentQuestion.isVisible)return!1;for(var e=this.parent;e;){if(!e.isVisible)return!1;e=e.parent}return!0}clearValueIfInvisible(e="onHidden"){const t=this.getClearIfInvisible();t!=="none"&&(e==="onHidden"&&t==="onComplete"||e==="onHiddenContainer"&&t!==e||this.clearValueIfInvisibleCore(e))}clearValueIfInvisibleCore(e){this.canClearValueAsInvisible(e)&&this.clearValue()}get clearIfInvisible(){return this.getPropertyValue("clearIfInvisible")}set clearIfInvisible(e){this.setPropertyValue("clearIfInvisible",e)}getClearIfInvisible(){const e=this.clearIfInvisible;return this.survey?this.survey.getQuestionClearIfInvisible(e):e!=="default"?e:"onComplete"}get displayValue(){return this.isLoadingFromJson?"":this.getDisplayValue(!0)}getDisplayValue(e,t=void 0){var s=this.calcDisplayValue(e,t);return this.survey&&(s=this.survey.getQuestionDisplayValue(this,s)),this.displayValueCallback?this.displayValueCallback(s):s}calcDisplayValue(e,t=void 0){if(this.customWidget){var s=this.customWidget.getDisplayValue(this,t);if(s)return s}return t=t??this.createValueCopy(),this.isValueEmpty(t)&&!this.locDefaultDisplayValue.isEmpty&&(t=this.defaultDisplayValue),this.isValueEmpty(t,!this.allowSpaceAsAnswer)?this.getDisplayValueEmpty():this.getDisplayValueCore(e,t)}getDisplayValueCore(e,t){return t}getDisplayValueEmpty(){return""}get defaultValue(){return this.getPropertyValue("defaultValue")}set defaultValue(e){if(this.isValueExpression(e)){this.defaultValueExpression=e.substring(1);return}this.setPropertyValue("defaultValue",this.valueToData(e)),this.updateValueWithDefaults()}get defaultValueExpression(){return this.getPropertyValue("defaultValueExpression")}set defaultValueExpression(e){this.setPropertyValue("defaultValueExpression",e),this.defaultValueRunner=void 0,this.updateValueWithDefaults()}get resetValueIf(){return this.getPropertyValue("resetValueIf")}set resetValueIf(e){this.setPropertyValue("resetValueIf",e)}get setValueIf(){return this.getPropertyValue("setValueIf")}set setValueIf(e){this.setPropertyValue("setValueIf",e)}get setValueExpression(){return this.getPropertyValue("setValueExpression")}set setValueExpression(e){this.setPropertyValue("setValueExpression",e)}get resizeStyle(){return this.allowResizeComment?"both":"none"}getPlainData(e){if(e||(e={includeEmpty:!0,includeQuestionTypes:!1}),e.includeEmpty||!this.isEmpty()){var t={name:this.name,title:this.locTitle.renderedHtml,value:this.value,displayValue:this.displayValue,isNode:!1,getString:s=>typeof s=="object"?JSON.stringify(s):s};return e.includeQuestionTypes===!0&&(t.questionType=this.getType()),(e.calculations||[]).forEach(s=>{t[s.propertyName]=this.getPlainDataCalculatedValue(s.propertyName)}),this.showCommentArea&&(t.isNode=!0,t.data=[{name:0,isComment:!0,title:"Comment",value:D.commentSuffix,displayValue:this.comment,getString:s=>typeof s=="object"?JSON.stringify(s):s,isNode:!1}]),t}}getPlainDataCalculatedValue(e){return this[e]}get correctAnswer(){return this.getPropertyValue("correctAnswer")}set correctAnswer(e){this.setPropertyValue("correctAnswer",this.valueToData(e))}get quizQuestionCount(){return this.isVisible&&this.hasInput&&!this.isValueEmpty(this.correctAnswer)?this.getQuizQuestionCount():0}get correctAnswerCount(){return!this.isEmpty()&&!this.isValueEmpty(this.correctAnswer)?this.getCorrectAnswerCount():0}getQuizQuestionCount(){return 1}getCorrectAnswerCount(){return this.checkIfAnswerCorrect()?1:0}checkIfAnswerCorrect(){const e=L.isTwoValueEquals(this.value,this.correctAnswer,this.getAnswerCorrectIgnoreOrder(),D.comparator.caseSensitive,!0),t=e?1:0,s=this.quizQuestionCount-t,i={result:e,correctAnswers:t,correctAnswerCount:t,incorrectAnswers:s,incorrectAnswerCount:s};return this.survey&&this.survey.onCorrectQuestionAnswer(this,i),i.result}getAnswerCorrectIgnoreOrder(){return!1}isAnswerCorrect(){return this.correctAnswerCount==this.quizQuestionCount}updateValueWithDefaults(){if(this.isLoadingFromJson||!this.isDesignMode&&this.isDefaultValueEmpty())return;const e=this.isEmpty();!this.isDesignMode&&!e||e&&this.isDefaultValueEmpty()||this.isClearValueOnHidden&&!this.isVisible||this.isDesignMode&&this.isContentElement&&this.isDefaultValueEmpty()||this.setDefaultValue()}get isValueDefault(){return!this.isEmpty()&&(this.isTwoValueEquals(this.defaultValue,this.value)||!this.isValueChangedDirectly&&!!this.defaultValueExpression)}get isClearValueOnHidden(){const e=this.getClearIfInvisible();return e==="none"||e==="onComplete"?!1:e==="onHidden"||e==="onHiddenContainer"}getQuestionFromArray(e,t){return null}getDefaultValue(){return this.defaultValue}isDefaultValueEmpty(){return!this.defaultValueExpression&&this.isValueEmpty(this.defaultValue,!this.allowSpaceAsAnswer)}setDefaultValue(){this.setDefaultValueCore(e=>{e=this.convertToCorrectValue(e),this.isTwoValueEquals(this.value,e)||this.setDefaultIntoValue(e)})}setDefaultIntoValue(e){this.value=e}setDefaultValueCore(e){const t=s=>{this.runExpressionSetValueCore(s,e)};this.runDefaultValueExpression(void 0,t)||t(this.getUnbindValue(this.defaultValue))}updateValueWithDefaultsOrClear(){this.isDesignMode||this.isLoadingFromJson||(this.isDefaultValueEmpty()?this.clearValue():this.setDefaultValue())}isValueExpression(e){return!!e&&typeof e=="string"&&e.length>0&&e[0]=="="}convertFuncValuetoQuestionValue(e){return L.convertValToQuestionVal(e)}runExpressionSetValueCore(e,t){t(this.convertFuncValuetoQuestionValue(e))}runExpressionSetValue(e){this.runExpressionSetValueCore(e,t=>{this.isTwoValueEquals(this.value,t)||(this.startSetValueOnExpression(),this.value=t,this.finishSetValueOnExpression())})}startSetValueOnExpression(){var e;(e=this.survey)===null||e===void 0||e.startSetValueOnExpression()}finishSetValueOnExpression(){var e;(e=this.survey)===null||e===void 0||e.finishSetValueOnExpression()}runDefaultValueExpression(e=null,t){return this.data?(t||(t=s=>{this.runExpressionSetValue(s)}),e||(e=this.defaultValueExpression?this.data.getFilteredProperties():{},e.question=this),this.runExpressionByProperty("defaultValueExpression",e,s=>{s==null&&(s=this.defaultValue),this.isChangingViaDefaultValue=!0,t(s),this.isChangingViaDefaultValue=!1})):!1}get comment(){return this.getQuestionComment()}set comment(e){if(e&&e!==this.comment){const t=e.toString().trim();t!==e&&(e=t,e===this.comment&&this.setPropertyValueDirectly("comment",e))}this.comment!=e&&this.setNewComment(e)}getCommentAreaCss(e=!1){return new j().append("form-group",e).append(this.cssClasses.formGroup,!e).append(this.cssClasses.commentArea).append(this.cssClasses.otherArea,e).toString()}getQuestionComment(){return this.questionComment}isEmpty(){return this.isValueEmpty(this.value,!this.allowSpaceAsAnswer)}get isAnswered(){return this.getPropertyValue("isAnswered")||!1}set isAnswered(e){this.setPropertyValue("isAnswered",e)}updateIsAnswered(){const e=this.isAnswered;this.setPropertyValue("isAnswered",this.getIsAnswered()),e!==this.isAnswered&&this.updateQuestionCss()}getIsAnswered(){return!this.isEmpty()}get validators(){return this.getPropertyValue("validators")}set validators(e){this.setPropertyValue("validators",e)}getValidators(){return this.validators}getSupportedValidators(){const e=[];let t=this.getType();for(;t;){const s=D.supportedValidators[t];if(s)for(let r=s.length-1;r>=0;r--)e.splice(0,0,s[r]);t=B.findClass(t).parentName}return e}addConditionObjectsByContext(e,t){e.push({name:this.getFilteredName(),text:this.processedTitle,question:this})}getNestedQuestions(e=!1,t=!0,s=!1){const i=[];return this.collectNestedQuestions(i,e,t,s),!s&&i.length===1&&i[0]===this?[]:i}collectNestedQuestions(e,t=!1,s=!0,i=!1){t&&!this.isVisible||this.collectNestedQuestionsCore(e,t,s,i)}collectNestedQuestionsCore(e,t,s,i){e.push(this)}addNestedQuestion(e,t,s,i){s?this.collectNestedQuestions(e,t,s,i):(!t||this.isVisible)&&e.push(this)}getConditionJson(e=null,t=null){const s=new rt().toJsonObject(this);return s.type=this.getType(),s}hasErrors(e=!0,t=!1){return!this.validateCore(e,!1,t)}validate(e=!0,t=!1,s=!1,i){return this.validateCore(e,!0,t,s,i)}validateCore(e,t,s=!1,i=!1,r){t&&i&&this.parent&&this.parent.validateContainerOnly();const a=new kr({isOnValueChanged:i,focusOnFirstError:s,fireCallback:e,callbackResult:r});return this.validateElement(a),a.finish(),a.runningResult}validateElement(e){return this.validateElementCore(e)}validateElementCore(e){const t=this.checkForErrors(e);return e.fireCallback&&(this.errors=t,this.errors!==t&&this.errors.forEach(s=>s.locText.strChanged())),e.setErrorElement(this,t),this.updateContainsErrors(),this.isCollapsed&&e.fireCallback&&t.length>0&&this.expand(),t.length===0}get currentErrorCount(){return this.errors.length}get requiredMark(){return this.survey!=null&&this.isRequired?this.survey.requiredMark:""}get requiredText(){return this.requiredMark}addError(e){if(!e)return;let t=null;typeof e=="string"||e instanceof String?t=this.addCustomError(e):t=e,this.errors.push(t)}addCustomError(e){return new Ps(e,this.survey)}removeError(e){if(!e)return!1;const t=this.errors,s=t.indexOf(e);return s!==-1&&t.splice(s,1),s!==-1}checkForErrors(e){var t=new Array;if(this.isVisible&&this.canCollectErrors()&&this.collectErrors(t,e),this.survey){if(this.validateValueCallback&&t.length===0){const s=this.validateValueCallback();s&&t.push(s)}this.survey.validateQuestion(this,t,e.fireCallback)}return t}canCollectErrors(){return!this.isReadOnly||D.readOnly.enableValidation}collectErrors(e,t){if(this.onCheckForErrors(e,t.isOnValueChanged,t.fireCallback),e.length>0||!this.canRunValidators(t.isOnValueChanged))return;const s=this.runValidators(t);if(s.length>0){e.length=0;for(var i=0;i<s.length;i++)e.push(s[i])}}canRunValidators(e){return!0}onCheckForErrors(e,t,s){if((!t||this.isOldAnswered)&&this.hasRequiredError()){const i=new _R(this.requiredErrorText,this);i.onUpdateErrorTextCallback=r=>{r.text=this.requiredErrorText},e.push(i)}if(!this.isEmpty()&&this.customWidget){const i=this.customWidget.validate(this);i&&e.push(this.addCustomError(i))}}hasRequiredError(){return this.isRequired&&this.isEmpty()}get isRunningValidators(){return this.getIsRunningValidators()}getIsRunningValidators(){return!!this.validatorRunner}runValidators(e){return this.validatorRunner&&(this.validatorRunner.onAsyncCompleted=null),this.validatorRunner=new FR,this.validatorRunner.onAsyncCompleted=t=>{this.doOnAsyncCompleted(e.fireCallback,t),e.setErrorElement(this,t),e.removeElement(this.id)},e.addElement(this.id),this.validatorRunner.run(this)}doOnAsyncCompleted(e,t){e&&t.forEach(s=>{this.errors.indexOf(s)<0&&this.errors.push(s)}),this.validatorRunner=null}setNewValue(e){if(this.survey&&(e=this.survey.questionValueChanging(this,e)),this.isNewValueEqualsToValue(e)||!this.checkIsValueCorrect(e))return;const t=this.getUnbindValue(this.value);this.isOldAnswered=this.isAnswered,this.isSettingQuestionValue=!0,this.setNewValueInData(e),this.allowNotifyValueChanged&&this.onValueChanged(),this.isSettingQuestionValue=!1,this.isAnswered!==this.isOldAnswered&&this.updateQuestionCss(),this.isOldAnswered=void 0,this.parent&&this.parent.onQuestionValueChanged(this),this.survey&&this.survey.questionValueChanged(this,t)}getValueChangingOptions(e){}checkIsValueCorrect(e){const t=this.isValueEmpty(e,!this.allowSpaceAsAnswer)||this.isNewValueCorrect(e);return t||xs.inCorrectQuestionValue(this.name,e),t}isNewValueCorrect(e){return!0}isNewValueEqualsToValue(e){const t=this.value;return this.isTwoValueEquals(e,t,!1,!1)?!(e===t&&!!t&&(Array.isArray(t)||typeof t=="object")):!1}isTextValue(){return!1}getIsInputTextUpdate(){return this.survey?this.survey.isUpdateValueTextOnTyping:!1}get requireStrictCompare(){return!1}getExpressionValue(e){return e}getDataLocNotification(){return this.isInputTextUpdate?"text":!1}get isInputTextUpdate(){return this.getIsInputTextUpdate()&&this.isTextValue()}setNewValueInData(e){e=this.valueToData(e),this.isValueChangedInSurvey||this.setValueCore(e)}getValueCore(){return this.questionValue}setValueCore(e){this.setQuestionValue(e),this.data!=null&&this.canSetValueToSurvey()&&(e=this.valueForSurvey,this.data.setValue(this.getValueName(),e,this.getDataLocNotification(),this.allowNotifyValueChanged,this.name)),this.isMouseDown=!1}canSetValueToSurvey(){return!0}valueFromData(e){return e}valueToData(e){return e}convertToCorrectValue(e){return e}onValueChanged(){}onMouseDown(){this.isMouseDown=!0}setNewComment(e){this.questionComment!==e&&(this.questionComment=e,this.setCommentIntoData(e))}setCommentIntoData(e){this.data!=null&&this.data.setComment(this.getValueName(),e,this.getIsInputTextUpdate()?"text":!1)}getValidName(e){return Ld(super.getValidName(e))}updateValueFromSurvey(e,t=!1){if(e=this.getUnbindValue(e),e=this.valueFromDataCore(e),!this.checkIsValueCorrect(e))return;const s=this.isValueEmpty(e);this.isUpdateingValueFromSurvey=!0,!s&&this.defaultValueExpression?this.setDefaultValueCore(i=>{this.updateValueFromSurveyCore(e,this.isTwoValueEquals(e,i))}):(this.updateValueFromSurveyCore(e,this.data!==this.getSurvey()),t&&s&&(this.isValueChangedDirectly=!1),s&&this.updateBindingsOnClearFromSurveyCore()),this.isUpdateingValueFromSurvey=!1,this.updateDependedQuestions(),this.updateIsAnswered()}canUpdateBindings(){return!this.isUpdateingValueFromSurvey}updateBindingsOnClearFromSurveyCore(){const e=this.data;e&&!this.isBindingEmpty()&&this.bindings.getNames().forEach(t=>{const s=this.bindings.getValueNameByPropertyName(t),i=e.getValue(s);this.isValueEmpty(i)||this.updateBindingProp(t,i)})}updateValueFromSurveyCore(e,t){this.isChangingViaDefaultValue=t,e=this.valueFromData(e);const s=this.isTwoValueEquals(this.questionValue,this.convertToCorrectValue(e));this.setQuestionValue(e),s||this.resetSingleInput(),this.isChangingViaDefaultValue=!1}updateCommentFromSurvey(e){this.questionComment=e}onChangeQuestionValue(e){}setValueChangedDirectly(e){this.isValueChangedDirectly=e,this.setValueChangedDirectlyCallback&&this.setValueChangedDirectlyCallback(e)}setQuestionValue(e,t=!0){e=this.convertToCorrectValue(e);const s=this.isTwoValueEquals(this.questionValue,e);!s&&!this.isChangingViaDefaultValue&&!this.isParentChangingViaDefaultValue&&this.setValueChangedDirectly(!0),this.questionValue=e,s||this.onChangeQuestionValue(e),!s&&this.allowNotifyValueChanged&&this.fireCallback(this.valueChangedCallback),t&&this.updateIsAnswered()}get isParentChangingViaDefaultValue(){var e;return((e=this.data)===null||e===void 0?void 0:e.isChangingViaDefaultValue)===!0}onSurveyValueChanged(e){}setVisibleIndex(e){return this.isVisibleIndexNegative(e)&&(e=-1),this.setPropertyValue("visibleIndex",e),this.resetPropertyValue("no"),e<0?0:1}isVisibleIndexNegative(e){return e<0||!this.isVisible||!this.hasTitle&&!D.numbering.includeQuestionsWithHiddenTitle||!this.showNumber&&!D.numbering.includeQuestionsWithHiddenNumber}removeElement(e){return!1}supportGoNextPageAutomatic(){return this.supportAutoAdvance()}supportAutoAdvance(){return!1}supportGoNextPageError(){return!0}clearIncorrectValues(){}clearOnDeletingContainer(){}clearErrors(){this.errors=[]}clearUnusedValues(){}onAnyValueChanged(e,t){}checkBindings(e,t){if(!(this.bindings.isEmpty()||!this.data))for(var s=this.bindings.getPropertiesByValueName(e),i=0;i<s.length;i++){const r=s[i];this.isValueEmpty(t)&&L.isNumber(this[r])&&(t=0),this.updateBindingProp(r,t)}}updateBindingProp(e,t){this[e]=t}getComponentName(){return pi.Instance.getRendererByQuestion(this)}isDefaultRendering(){return!!this.customWidget||this.getComponentName()==="default"}get renderAs(){return this.getPropertyValue("renderAs")}set renderAs(e){this.setPropertyValue("renderAs",e)}get inMatrixMode(){return this.getPropertyValue("inMatrixMode",!1)}set inMatrixMode(e){this.setPropertyValue("inMatrixMode",e)}getErrorCustomText(e,t){return this.survey?this.survey.getSurveyErrorCustomText(this,e,t):e}getValidatorTitle(){return null}get validatedValue(){return this.value}set validatedValue(e){this.value=e}getAllValues(){return this.data?this.data.getAllValues():null}processPopupVisiblilityChanged(e,t){this.survey.processPopupVisiblityChanged(this,e,t)}processOpenDropdownMenu(e){this.survey.processOpenDropdownMenu(this,e)}onTextKeyDownHandler(e){e.keyCode===13&&this.survey.questionEditFinishCallback(this,e)}transformToMobileView(){}transformToDesktopView(){}needResponsiveWidth(){return!1}supportResponsiveness(){return!1}needResponsiveness(){return this.supportResponsiveness()&&!this.isDesignMode}checkForResponsiveness(e){if(this.needResponsiveness())if(this.isCollapsed){const t=()=>{this.isExpanded&&(this.initResponsiveness(e),this.unregisterPropertyChangedHandlers(["state"],"for-responsiveness"))};this.registerPropertyChangedHandlers(["state"],t,"for-responsiveness")}else this.initResponsiveness(e)}getObservedElementSelector(){return".sd-scrollable-container"}onMobileChanged(){this.onMobileChangedCallback&&this.onMobileChangedCallback()}triggerResponsiveness(e=!0){this.triggerResponsivenessCallback&&this.triggerResponsivenessCallback(e)}initResponsiveness(e){if(oe.isAvailable()&&(this.destroyResizeObserver(),e&&this.isDefaultRendering())){const t=this.getObservedElementSelector();if(!t||!e.querySelector(t))return;let i=!1,r;this.triggerResponsivenessCallback=a=>{a&&(r=void 0,this.renderAs="default",i=!1);const o=()=>{const l=e.querySelector(t);if(this.isDefaultRendering()&&(r=l.scrollWidth),i||!Ed(l))i=!1;else{const u=Td(l);i=this.processResponsiveness(r,u)}};a?setTimeout(o,1):o()},this.resizeObserver=new ResizeObserver(a=>{he.requestAnimationFrame(()=>{this.triggerResponsiveness(!1)})}),this.onMobileChangedCallback=()=>{setTimeout(()=>{const a=e.querySelector(t);this.processResponsiveness(r,Td(a))},0)},this.resizeObserver.observe(e)}}getCompactRenderAs(){return"default"}getDesktopRenderAs(){return"default"}onBeforeSetCompactRenderer(){}onBeforeSetDesktopRenderer(){}processResponsiveness(e,t){if(t=Math.round(t),Math.abs(e-t)>2){const s=this.renderAs;return e>t?(this.onBeforeSetCompactRenderer(),this.renderAs=this.getCompactRenderAs()):(this.onBeforeSetDesktopRenderer(),this.renderAs=this.getDesktopRenderAs()),s!==this.renderAs}return!1}destroyResizeObserver(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=void 0,this.onMobileChangedCallback=void 0,this.triggerResponsivenessCallback=void 0,this.renderAs=this.getDesktopRenderAs())}dispose(){super.dispose(),this.resetDependedQuestions(),this.destroyResizeObserver()}resetDependedQuestions(){for(var e=0;e<this.dependedQuestions.length;e++)this.dependedQuestions[e].resetDependedQuestion()}get isNewA11yStructure(){return!1}get ariaLabel(){return this.isNewA11yStructure||this.hasTitle&&!this.parentQuestion?null:this.locTitle.renderedHtml}get ariaRole(){return this.isNewA11yStructure?null:"textbox"}get ariaRequired(){return this.isNewA11yStructure?null:this.isRequired?"true":"false"}get ariaInvalid(){return this.isNewA11yStructure?null:this.hasCssError()?"true":"false"}get ariaLabelledBy(){return this.isNewA11yStructure||!this.hasTitle||this.parentQuestion?null:this.ariaTitleId}get ariaDescribedBy(){return this.isNewA11yStructure?null:this.hasTitle&&this.hasDescription?this.ariaDescriptionId:null}getContentAriaHidden(){return null}get contentAriaHidden(){return this.getContentAriaHidden()}get ariaErrormessage(){return this.isNewA11yStructure?null:this.hasCssError()?this.id+"_errors":null}get a11y_input_ariaRole(){return null}get a11y_input_ariaRequired(){return this.isRequired?"true":"false"}get a11y_input_ariaInvalid(){return this.hasCssError()?"true":"false"}get a11y_input_ariaLabel(){return this.hasTitle&&!this.parentQuestion?null:this.locTitle.renderedHtml}get a11y_input_ariaLabelledBy(){return this.hasTitle&&!this.parentQuestion?this.ariaTitleId:null}get a11y_input_ariaDescribedBy(){let e=null;return this.hasCssError()?e=this.id+"_errors":this.hasTitle&&!this.parentQuestion&&this.hasDescription&&this.descriptionLocation!=="hidden"&&(e=this.ariaDescriptionId),e}get a11y_input_ariaErrormessage(){return null}get a11y_input_ariaExpanded(){return this.getPropertyValue("ariaExpanded")}get dragDropMatrixAttribute(){return null}registerSychProperties(e,t){this.registerFunctionOnPropertiesValueChanged(e,()=>{this._syncPropertiesChanging||(this._syncPropertiesChanging=!0,t(),this._syncPropertiesChanging=!1)})}}function Ld(n){if(!n)return n;for(n=n.trim().replace(/[\{\}]+/g,"");n&&n[0]===D.expressionDisableConversionChar;)n=n.substring(1);return n}B.addClass("question",[{name:"!name",onSettingValue:(n,e)=>Ld(e)},{name:"state",default:"default",choices:["default","collapsed","expanded"]},{name:"visible:switch",default:!0,overridingProperty:"visibleIf"},{name:"useDisplayValuesInDynamicTexts:boolean",alternativeName:"useDisplayValuesInTitle",default:!0,layout:"row"},"visibleIf:condition",{name:"width"},{name:"minWidth",defaultFunc:()=>D.minWidth},{name:"maxWidth",defaultFunc:()=>D.maxWidth},{name:"colSpan:number",visible:!1,onSerializeValue:n=>n.getPropertyValue("colSpan")},{name:"effectiveColSpan:number",minValue:1,isSerializable:!1,visibleIf:function(n){return!!n&&!!n.survey&&n.survey.gridLayoutEnabled}},{name:"startWithNewLine:boolean",default:!0,layout:"row"},{name:"indent:number",default:0,choices:[0,1,2,3],layout:"row"},{name:"page",isSerializable:!1,visibleIf:function(n){var e=n?n.survey:null;return!e||!e.pages||e.pages.length>1},choices:function(n){var e=n?n.survey:null;return e?e.pages.map(t=>({value:t.name,text:t.title})):[]}},{name:"title:text",serializationProperty:"locTitle",layout:"row",dependsOn:"name",onPropertyEditorUpdate:function(n,e){n&&e&&(e.placeholder=n.locTitle.getPlaceholder())}},{name:"titleLocation",default:"default",choices:["default","top","bottom","left","hidden"],layout:"row"},{name:"showTitle:boolean",isSerializable:!1,dependsOn:"titleLocation"},{name:"description:text",serializationProperty:"locDescription",layout:"row"},{name:"descriptionLocation",default:"default",choices:["default","underInput","underTitle"]},{name:"showNumber:boolean",dependsOn:"titleLocation",default:!0,visibleIf:function(n){if(!n)return!0;if(n.titleLocation==="hidden")return!1;var e=n?n.parent:null,t=!e||e.showQuestionNumbers!=="off";if(!t)return!1;var s=n?n.survey:null;return!s||s.showQuestionNumbers!=="off"||!!e&&e.showQuestionNumbers==="onpanel"}},{name:"hideNumber:boolean",visible:!1,isSerializable:!1},{name:"valueName",onSettingValue:(n,e)=>Ld(e)},"enableIf:condition","resetValueIf:condition","setValueIf:condition","setValueExpression:expression","defaultValue:value",{name:"defaultValueExpression:expression",category:"logic"},"correctAnswer:value",{name:"clearIfInvisible",default:"default",choices:["default","none","onComplete","onHidden","onHiddenContainer"]},{name:"isRequired:switch",overridingProperty:"requiredIf"},"requiredIf:condition",{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText"},{name:"errorLocation",default:"default",choices:["default","top","bottom"]},{name:"readOnly:switch",overridingProperty:"enableIf"},{name:"validators:validators",baseClassName:"surveyvalidator",classNamePart:"validator"},{name:"bindings:bindings",serializationProperty:"bindings",isSerializableFunc:n=>!n.isBindingEmpty(),visibleIf:function(n){return n.bindings.getNames().length>0}},{name:"renderAs",default:"default",visible:!1},{name:"showCommentArea:switch",visible:!1,default:!1,alternativeName:"hasComment",category:"general"},{name:"commentText",dependsOn:"showCommentArea",visibleIf:function(n){return n.showCommentArea},serializationProperty:"locCommentText"},{name:"commentPlaceholder",alternativeName:"commentPlaceHolder",serializationProperty:"locCommentPlaceholder",dependsOn:"showCommentArea",visibleIf:function(n){return n.showCommentArea}},{name:"defaultDisplayValue",serializationProperty:"locDefaultDisplayValue"}]),B.addAlterNativeClassName("question","questionbase");class $R{constructor(e){this.item=e}getValue(e,t,s,i){const r=e.length>0?e[0].name:"";if(e.length===1&&(r==="item"||r==="choice"))return{isFound:!0,value:this.item.value,context:this};if(e.length>1&&(r==="$item"||r==="$choice"))return new pE(this.item).getValue(e.slice(1),!0,-1,!1);const a=this.item.locOwner;if(a&&a.getValueGetterContext)return a.getValueGetterContext().getValue(e,t,s,i)}getRootObj(){const e=this.item.locOwner;return e&&e.getValueGetterContext?e:this.item.getSurvey()}getTextValue(e,t,s){return s&&t===this.item.value?this.item.textOrHtml:t!=null?t.toString():""}}class fe extends Je{getMarkdownHtml(e,t,s){return this.locOwner?this.locOwner.getMarkdownHtml(e,t,s||this):void 0}getRenderer(e){return this.locOwner?this.locOwner.getRenderer(e,this):null}getRendererContext(e){return this.locOwner?this.locOwner.getRendererContext(e,this):e}getProcessedText(e){return this.locOwner?this.locOwner.getProcessedText(e):e}static get Separator(){return D.itemValueSeparator}static set Separator(e){D.itemValueSeparator=e}static setData(e,t,s){e.length=0;for(let i=0;i<t.length;i++){const r=t[i],a=r&&typeof r.getType=="function"?r.getType():s??"itemvalue",o=B.createClass(a);o.setData(r),r.originalItem&&(o.originalItem=r.originalItem),r.data&&(o.data=r.data),e.push(o)}}static getData(e){for(var t=[],s=0;s<e.length;s++)t.push(e[s].getData());return t}static getItemByValue(e,t){if(!Array.isArray(e))return null;const s=L.isValueEmpty(t);for(var i=0;i<e.length;i++)if(s&&L.isValueEmpty(e[i].value)||L.isTwoValueEquals(e[i].value,t,!1,!0,!1))return e[i];return null}static getTextOrHtmlByValue(e,t){var s=fe.getItemByValue(e,t);return s!==null?s.textOrHtml:""}static locStrsChanged(e){for(var t=0;t<e.length;t++)e[t].locStrsChanged()}static runConditionsForItems(e,t,s,i,r=!0,a){return fe.runConditionsForItemsCore(e,t,s,i,!0,r,a)}static runEnabledConditionsForItems(e,t,s,i){return fe.runConditionsForItemsCore(e,null,t,s,!1,!0,i)}static runConditionsForItemsCore(e,t,s,i,r,a=!0,o){for(var l=!1,u=0;u<e.length;u++){var d=e[u],h=a&&d.getConditionRunner?d.getConditionRunner(r):!1;h||(h=s);var f=!0;h&&(f=h.runContext(d.getValueGetterContext(),i)),o&&(f=o(d,f)),t&&f&&t.push(d);var C=r?d.isVisible:d.isEnabled;f!=C&&(l=!0,r?d.setIsVisible&&d.setIsVisible(f):d.setIsEnabled&&d.setIsEnabled(f))}return l}constructor(e,t,s){super(),this.typeName=s,this.ownerPropertyName="",t&&(this.locText.text=t),e&&typeof e=="object"?this.setData(e,!0):this.setValue(e,!0),this.getType()!=this.getBaseType()&&it.createProperties(this),this.onCreating()}onCreating(){}getType(){return this.typeName||this.getBaseType()}getBaseType(){return"itemvalue"}getSurvey(e=!1){return this.locOwner&&this.locOwner.getSurvey?this.locOwner.getSurvey():null}getLocale(){return this.locOwner&&this.locOwner.getLocale?this.locOwner.getLocale():""}getLocalizableString(e){return e==="text"?this.locText:super.getLocalizableString(e)}getValueGetterContext(){return new $R(this)}get isInternal(){return this.isGhost===!0}createLocText(){const e=new wt(this,!0,"text");return e.onStrChanged=(t,s)=>{this.propertyValueChanged("text",t,s)},e.onGetTextCallback=t=>this.onGetText(t),e}onGetText(e){return e||this.getValueText()}getValueText(){const e=this.value;return L.isValueEmpty(e)?null:e.toString()}get locText(){return this.locTextValue||(this.locTextValue=this.createLocText()),this.locTextValue}setLocText(e){this.locTextValue=e}get locOwner(){return this._locOwner}set locOwner(e){this._locOwner=e,this.onLocOwnerChanged()}onLocOwnerChanged(){}get value(){return this.getPropertyValue("value")}set value(e){this.setValue(e,!1)}setValue(e,t){let s;e=this.getCorrectValue(e);const i=D.itemValueSeparator;if(i&&!L.isValueEmpty(e)){var r=e.toString(),a=r.indexOf(i);a>-1&&(e=r.slice(0,a),s=r.slice(a+1))}t?this.setPropertyValueDirectly("value",e):this.setPropertyValue("value",e),s&&(this.text=s),this.id=this.value}getCorrectValue(e){return e}get hasText(){return!!this.pureText}get pureText(){var e;return((e=this.locTextValue)===null||e===void 0?void 0:e.pureText)||""}set pureText(e){this.text=e}get text(){return this.calculatedText}set text(e){this.locText.text=e}get textOrHtml(){return this.locTextValue?this.locText.textOrHtml:this.getValueText()}get calculatedText(){return this.locTextValue?this.locText.calculatedText:this.getValueText()}get shortcutText(){return this.text}canSerializeValue(){const e=this.value;return e==null?!1:!Array.isArray(e)&&typeof e!="object"}getData(){var e=this.toJSON();if(e.value&&e.value.pos&&delete e.value.pos,L.isValueEmpty(e.value))return e;const t=this.canSerializeValue();return(!t||!D.serialization.itemValueSerializeAsObject&&!D.serialization.itemValueSerializeDisplayText)&&Object.keys(e).length==1?this.value:(D.serialization.itemValueSerializeDisplayText&&e.text===void 0&&t&&(e.text=this.value.toString()),e)}toJSON(){var e={},t=B.getProperties(this.getType());(!t||t.length==0)&&(t=B.getProperties(this.getBaseType()));for(var s=new rt,i=0;i<t.length;i++){const r=t[i];this.canAddPpropertyToJSON(r)&&s.valueToJson(this,e,r)}return e}canAddPpropertyToJSON(e){return!(e.name==="text"&&(!this.locTextValue||!this.locTextValue.hasNonDefaultText()&&L.isTwoValueEquals(this.value,this.locTextValue.getLocaleText(""),!1,!0,!1)))}setData(e,t){var s;if(!L.isValueEmpty(e)){if(typeof e.value>"u"&&typeof e.text<"u"&&Object.keys(e).length===1&&(e.value=e.text),typeof e.value<"u"){let r;if(typeof e.toJSON=="function")r=e.toJSON();else if(Array.isArray(e.elements)){r={};for(var i in e)i!=="elements"&&(r[i]=e[i])}else r=e;new rt().toObject(r,this)}else this.setValue(e,t);t||(s=this.locTextValue)===null||s===void 0||s.strChanged()}}get visibleIf(){return this.getPropertyValueWithoutDefault("visibleIf")||""}set visibleIf(e){this.setPropertyValue("visibleIf",e)}get enableIf(){return this.getPropertyValueWithoutDefault("enableIf")||""}set enableIf(e){this.setPropertyValue("enableIf",e)}get isVisible(){const e=this.getPropertyValueWithoutDefault("isVisible");return e!==void 0?e:!0}setIsVisible(e){this.setPropertyValue("isVisible",e)}get isEnabled(){const e=this.getPropertyValueWithoutDefault("isEnabled");return e!==void 0?e:!0}setIsEnabled(e){this.setPropertyValue("isEnabled",e)}addUsedLocales(e){this.locTextValue&&this.AddLocStringToUsedLocales(this.locTextValue,e)}locStrsChanged(){var e;super.locStrsChanged(),(e=this.locTextValue)===null||e===void 0||e.strChanged()}onPropertyValueChanged(e,t,s){var i;e==="value"&&!this.hasText&&((i=this.locTextValue)===null||i===void 0||i.strChanged());var r="itemValuePropertyChanged";!this.locOwner||!this.locOwner[r]||this.locOwner[r](this,e,t,s)}getConditionRunner(e){return e?this.getVisibleConditionRunner():this.getEnableConditionRunner()}getVisibleConditionRunner(){const e=this.getExpressionFromSurvey("visibleIf");return e?(this.visibleConditionRunner||(this.visibleConditionRunner=new Gs(e)),this.visibleConditionRunner.expression=e,this.visibleConditionRunner):null}getEnableConditionRunner(){const e=this.getExpressionFromSurvey("enableIf");return e?(this.enableConditionRunner||(this.enableConditionRunner=new Gs(e)),this.enableConditionRunner.expression=e,this.enableConditionRunner):null}get selected(){const e=this._locOwner;return e instanceof kt&&e.isItemSelected&&this.selectedValue===void 0&&(this.selectedValue=new Ue(()=>e.isItemSelected(this))),this.selectedValue}getComponent(){return this._locOwner instanceof kt?this.componentValue||this._locOwner.itemComponent:this.componentValue}setComponent(e){this.componentValue=e}setRootElement(e){this._htmlElement=e}getRootElement(){return this._htmlElement}getEnabled(){return this.isEnabled}setEnabled(e){this.setIsEnabled(e)}getVisible(){const e=this.isVisible===void 0?!0:this.isVisible,t=this._visible===void 0?!0:this._visible;return e&&t}setVisible(e){this.visible!==e&&(this._visible=e)}get _visible(){return this.getPropertyValue("visible",!0)}set _visible(e){this.setPropertyValue("visible",e)}getLocTitle(){return this.locText}getTitle(){return this.text}setLocTitle(e){}setTitle(e){}get icon(){return this.getPropertyValue("icon","")}set icon(e){this.setPropertyValue("icon",e)}}I([R()],fe.prototype,"selectedValue",void 0),de.createItemValue=function(n,e){var t=null;return e?t=rt.metaData.createClass(e,{}):typeof n.getType=="function"?t=new fe(null,void 0,n.getType()):t=new fe(null),t.setData(n),t},de.itemValueLocStrChanged=function(n){fe.locStrsChanged(n)},Ds.getItemValuesDefaultValue=(n,e)=>{const t=new Array;return fe.setData(t,Array.isArray(n)?n:[],e),t},B.addClass("itemvalue",[{name:"!value",isUnique:!0},{name:"text",serializationProperty:"locText"},{name:"visibleIf:condition",locationInTable:"detail"},{name:"enableIf:condition",locationInTable:"detail",visibleIf:n=>!n||n.ownerPropertyName!=="rateValues"}],n=>new fe(n));class GR extends de{constructor(e=null,t=null){super(),this.expressionIsRunning=!1,this.isCalculated=!1,e&&(this.name=e),t&&(this.expression=t)}setOwner(e){this.data=e,this.rerunExpression()}getType(){return"calculatedvalue"}getSurvey(e=!1){return this.data&&this.data.getSurvey?this.data.getSurvey():null}get owner(){return this.data}get name(){return this.getPropertyValue("name")||""}set name(e){this.setPropertyValue("name",e)}get includeIntoResult(){return this.getPropertyValue("includeIntoResult")}set includeIntoResult(e){this.setPropertyValue("includeIntoResult",e)}get expression(){return this.getPropertyValue("expression")||""}set expression(e){this.setPropertyValue("expression",e),this.rerunExpression()}locCalculation(){this.expressionIsRunning=!0}unlocCalculation(){this.expressionIsRunning=!1}resetCalculation(){this.isCalculated=!1}doCalculation(e,t){this.isCalculated||(this.runExpressionCore(e,t),this.isCalculated=!0)}runExpression(e){this.runExpressionCore(null,e)}get value(){if(this.data)return this.data.getVariable(this.name)}setValue(e){this.data&&this.data.setVariable(this.name,e)}get canRunExpression(){return!!this.data&&!this.isLoadingFromJson&&!!this.expression&&!this.expressionIsRunning&&!!this.name}rerunExpression(){this.canRunExpression&&this.runExpression(this.data.getFilteredProperties())}runExpressionCore(e,t){!this.canRunExpression||!this.ensureExpression()||(this.locCalculation(),e&&this.runDependentExpressions(e,t),this.expressionRunner.runContext(this.getValueGetterContext(),this.getPropertiesCopy(t,"expression")))}runDependentExpressions(e,t){var s=this.expressionRunner.getVariables();if(s)for(var i=0;i<e.length;i++){var r=e[i];r===this||s.indexOf(r.name)<0||r.doCalculation(e,t)}}ensureExpression(){const e=this.getExpressionFromSurvey("expression");return e?(this.expressionRunner?this.expressionRunner.expression=e:(this.expressionRunner=this.createExpressionRunner(e),this.expressionRunner.onRunComplete=t=>{L.isTwoValueEquals(t,this.value,!1,!0,!1)||this.setValue(t),this.unlocCalculation()}),!0):!1}}B.addClass("calculatedvalue",[{name:"!name",isUnique:!0},"expression:expression","includeIntoResult:boolean"],function(){return new GR},"base");class Ad extends de{constructor(e=null){super(),this.expression=e}getType(){return"expressionitem"}runCondition(e){let t=!1;return this.runExpressionByProperty("expression",e,s=>{t=s===!0}),t}get expression(){return this.getPropertyValue("expression","")}set expression(e){this.setPropertyValue("expression",e)}get locHtml(){return this.getLocalizableString("html")}getLocale(){return this.locOwner?this.locOwner.getLocale():""}getMarkdownHtml(e,t,s){return this.locOwner?this.locOwner.getMarkdownHtml(e,t,s):void 0}getRenderer(e){return this.locOwner?this.locOwner.getRenderer(e):null}getRendererContext(e){return this.locOwner?this.locOwner.getRendererContext(e):e}getProcessedText(e){return this.locOwner?this.locOwner.getProcessedText(e):e}getSurvey(e=!1){return this.locOwner}}class JR extends Ad{constructor(e=null,t=null){super(e),this.createLocalizableString("html"),this.html=t}getType(){return"htmlconditionitem"}get html(){return this.getLocalizableStringText("html")}set html(e){this.setLocalizableStringText("html",e)}get locHtml(){return this.getLocalizableString("html")}}class KR extends Ad{constructor(e=null,t=null){super(e),this.createLocalizableString("url"),this.url=t}getType(){return"urlconditionitem"}get url(){return this.getLocalizableStringText("url")}set url(e){this.setLocalizableStringText("url",e)}get locUrl(){return this.getLocalizableString("url")}}B.addClass("expressionitem",["expression:condition"],function(){return new Ad},"base"),B.addClass("htmlconditionitem",[{name:"html:html",serializationProperty:"locHtml"}],function(){return new JR},"expressionitem"),B.addClass("urlconditionitem",[{name:"url:string",serializationProperty:"locUrl"}],function(){return new KR},"expressionitem");class ZR{constructor(){this.parser=new DOMParser}assignValue(e,t,s){Array.isArray(e[t])?e[t].push(s):e[t]!==void 0?e[t]=[e[t]].concat(s):typeof s=="object"&&Object.keys(s).length===1&&Object.keys(s)[0]===t?e[t]=s[t]:e[t]=s}xml2Json(e,t){if(e.children&&e.children.length>0)for(let s=0;s<e.children.length;s++){let i=e.children[s],r={};this.xml2Json(i,r),this.assignValue(t,i.nodeName,r)}else this.assignValue(t,e.nodeName,e.textContent)}parseXmlString(e){let t=this.parser.parseFromString(e,"text/xml"),s={};return this.xml2Json(t,s),s}}class pt extends de{static get EncodeParameters(){return D.web.encodeUrlParams}static set EncodeParameters(e){D.web.encodeUrlParams=e}static clearCache(){pt.itemsResult={},pt.sendingSameRequests={}}static addSameRequest(e){if(!e.isUsingCache)return!1;var t=e.objHash,s=pt.sendingSameRequests[t];return s?(s.push(e),e.isRunningValue=!0,!0):(pt.sendingSameRequests[e.objHash]=[],!1)}static unregisterSameRequests(e,t){if(e.isUsingCache){var s=pt.sendingSameRequests[e.objHash];if(delete pt.sendingSameRequests[e.objHash],!!s)for(var i=0;i<s.length;i++)s[i].isRunningValue=!1,s[i].getResultCallback&&s[i].getResultCallback(t)}}static get onBeforeSendRequest(){return D.web.onBeforeRequestChoices}static set onBeforeSendRequest(e){D.web.onBeforeRequestChoices=e}static getCachedItemsResult(e){var t=e.objHash,s=pt.itemsResult[t];return s?(e.getResultCallback&&e.getResultCallback(s),!0):!1}constructor(){super(),this.lastObjHash="",this.isRunningValue=!1,this.processedUrl="",this.processedPath="",this.isUsingCacheFromUrl=void 0,this.error=null,this.createItemValue=e=>new fe(e),this.registerPropertyChangedHandlers(["url"],()=>{this.owner&&this.owner.setPropertyValue("isUsingRestful",!!this.url)})}getSurvey(e=!1){return this.owner?this.owner.survey:null}run(e=null){if(!(!this.url||!this.getResultCallback)){if(this.processedText(e),!this.processedUrl){this.doEmptyResultCallback({}),this.lastObjHash=this.objHash;return}this.lastObjHash!==this.objHash&&(this.lastObjHash=this.objHash,this.error=null,!this.useChangedItemsResults()&&(pt.addSameRequest(this)||this.sendRequest()))}}get isUsingCache(){return this.isUsingCacheFromUrl===!0?!0:this.isUsingCacheFromUrl===!1?!1:D.web.cacheLoadedChoices}get isRunning(){return this.getIsRunning()}getIsRunning(){return this.isRunningValue}get isWaitingForParameters(){return this.url&&!this.processedUrl}useChangedItemsResults(){return pt.getCachedItemsResult(this)}doEmptyResultCallback(e){var t=[];this.updateResultCallback&&(t=this.updateResultCallback(t,e)),this.getResultCallback(t)}processedText(e){var t=this.url;if(t&&(t=t.replace(pt.cacheText,"").replace(pt.noCacheText,"")),e){var s=e.processTextEx({text:t,runAtDesign:!0}),i=e.processTextEx({text:this.path,runAtDesign:!0});!s.hasAllValuesOnLastRun||!i.hasAllValuesOnLastRun?(this.processedUrl="",this.processedPath=""):(this.processedUrl=s.text,this.processedPath=i.text)}else this.processedUrl=t,this.processedPath=this.path;this.onProcessedUrlCallback&&this.onProcessedUrlCallback(this.processedUrl,this.processedPath)}parseResponse(e){let t;if(e&&typeof e.indexOf=="function"&&e.indexOf("<")===0){var s=new ZR;t=s.parseXmlString(e)}else try{t=JSON.parse(e)}catch{t=(e||"").split(`
`).map(r=>r.trim(" ")).filter(r=>!!r)}return t}sendRequest(){typeof XMLHttpRequest<"u"?this.sendXmlHttpRequest():typeof fetch<"u"?this.sendFetchRequest():(this.error=new w1("The browser does not support XMLHttpRequest or fetch API","",this.owner),this.doEmptyResultCallback(""))}sendXmlHttpRequest(){var e=new XMLHttpRequest;e.open("GET",this.processedUrl),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var t=this,s=this.objHash;e.onload=function(){t.beforeLoadRequest(),e.status===200?t.onLoad(t.parseResponse(e.response),s):t.onError(e.statusText,e.responseText)};var i={url:this.processedUrl,request:e};D.web.onBeforeRequestChoices&&D.web.onBeforeRequestChoices(this,i),this.beforeSendRequest(),i.request.send()}sendFetchRequest(){const e=this,t=this.objHash,r={url:this.processedUrl,fetchOptions:{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded"}}};D.web.onBeforeRequestChoices&&D.web.onBeforeRequestChoices(this,r),this.beforeSendRequest(),fetch(r.url,r.fetchOptions).then(a=>(e.beforeLoadRequest(),a.status===200?a.text().then(o=>{e.onLoad(e.parseResponse(o),t)}):a.text().then(o=>{e.onError(a.statusText,o)}))).catch(a=>{e.onError(a.message,"")})}getType(){return"choicesByUrl"}get isEmpty(){return!this.url&&!this.path}getCustomPropertiesNames(){for(var e=this.getCustomProperties(),t=new Array,s=0;s<e.length;s++)t.push(this.getCustomPropertyName(e[s].name));return t}getCustomPropertyName(e){return e+"Name"}getCustomProperties(){for(var e=B.getProperties(this.itemValueType),t=[],s=0;s<e.length;s++)e[s].name==="value"||e[s].name==="text"||e[s].name==="visibleIf"||e[s].name==="enableIf"||t.push(e[s]);return t}getAllPropertiesNames(){const e=new Array;return B.getPropertiesByObj(this).forEach(t=>e.push(t.name)),this.getCustomPropertiesNames().forEach(t=>e.push(t)),e}setData(e){e||(e={}),this.getAllPropertiesNames().forEach(s=>{this[s]=e[s]});const t=e.attachData||e.attachOriginalItems;t!==void 0&&(this.attachData=t)}getData(){const e={};let t=!1;return this.getAllPropertiesNames().forEach(s=>{const i=this[s];!this.isValueEmpty(i)&&i!==this.getDefaultPropertyValue(s)&&(e[s]=i,t=!0)}),t?e:null}get url(){return this.getPropertyValue("url")||""}set url(e){this.setPropertyValue("url",e),this.isUsingCacheFromUrl=void 0,e&&(e.indexOf(pt.cacheText)>-1?this.isUsingCacheFromUrl=!0:e.indexOf(pt.noCacheText)>-1&&(this.isUsingCacheFromUrl=!1))}get path(){return this.getPropertyValue("path")||""}set path(e){this.setPropertyValue("path",e)}get valueName(){return this.getPropertyValue("valueName")||""}set valueName(e){this.setPropertyValue("valueName",e)}get titleName(){return this.getPropertyValue("titleName")||""}set titleName(e){this.setPropertyValue("titleName",e)}get imageLinkName(){return this.getPropertyValue("imageLinkName")||""}set imageLinkName(e){this.setPropertyValue("imageLinkName",e)}get allowEmptyResponse(){return this.getPropertyValue("allowEmptyResponse")}set allowEmptyResponse(e){this.setPropertyValue("allowEmptyResponse",e)}get attachOriginalItems(){return this.attachData}set attachOriginalItems(e){this.attachData=e}get attachData(){return this.getPropertyValue("attachData")}set attachData(e){this.setPropertyValue("attachData",e)}get itemValueType(){if(!this.owner)return"itemvalue";var e=B.findProperty(this.owner.getType(),"choices");return!e||e.type=="itemvalue[]"?"itemvalue":e.type}clear(){this.setData(void 0)}beforeSendRequest(){this.isRunningValue=!0,this.beforeSendRequestCallback&&this.beforeSendRequestCallback()}beforeLoadRequest(){this.isRunningValue=!1}onLoad(e,t=null){t||(t=this.objHash);var s=new Array,i=this.getResultAfterPath(e);if(i&&i.length)for(var r=0;r<i.length;r++){var a=i[r];if(a){var o=this.getItemValueCallback?this.getItemValueCallback(a):this.getValue(a),l=this.createItemValue(o);this.setTitle(l,a),this.setCustomProperties(l,a),this.attachData&&(l.originalItem=a,l.data=a);var u=this.getImageLink(a);u&&(l.imageLink=u),s.push(l)}}else this.allowEmptyResponse||(this.error=new MR(null,this.owner));this.updateResultCallback&&(s=this.updateResultCallback(s,e)),this.isUsingCache&&(pt.itemsResult[t]=s),this.callResultCallback(s,t),pt.unregisterSameRequests(this,s)}callResultCallback(e,t){t==this.objHash&&this.getResultCallback(e)}setCustomProperties(e,t){for(var s=this.getCustomProperties(),i=0;i<s.length;i++){var r=s[i],a=this.getValueCore(t,this.getPropertyBinding(r.name));this.isValueEmpty(a)||(e[r.name]=a)}}getPropertyBinding(e){return this[this.getCustomPropertyName(e)]?this[this.getCustomPropertyName(e)]:this[e]?this[e]:e}onError(e,t){this.error=new w1(e,t,this.owner),this.doEmptyResultCallback(t),pt.unregisterSameRequests(this,[])}getResultAfterPath(e){if(!e||!this.processedPath)return e;for(var t=this.getPathes(),s=0;s<t.length;s++)if(e=e[t[s]],!e)return null;return e}getPathes(){var e=[];return this.processedPath.indexOf(";")>-1?e=this.path.split(";"):this.processedPath.indexOf(",")>-1?e=this.processedPath.split(","):e=this.processedPath.split("."),e.length==0&&e.push(this.processedPath),e}getValue(e){if(!e)return null;if(this.valueName)return this.getValueCore(e,this.valueName);if(!(e instanceof Object))return e;var t=Object.keys(e).length;return t<1?null:e[Object.keys(e)[0]]}setTitle(e,t){var s=this.titleName?this.titleName:"title",i=this.getValueCore(t,s);i&&(typeof i=="string"?e.text=i:e.locText.setJson(i))}getImageLink(e){var t=this.imageLinkName?this.imageLinkName:"imageLink";return this.getValueCore(e,t)}getValueCore(e,t){if(!e)return null;if(t.indexOf(".")<0)return e[t];for(var s=t.split("."),i=0;i<s.length;i++)if(e=e[s[i]],!e)return null;return e}get objHash(){return this.processedUrl+";"+this.processedPath+";"+this.valueName+";"+this.titleName+";"+this.imageLinkName+";"+this.attachData}}pt.cacheText="{CACHE}",pt.noCacheText="{NOCACHE}",pt.itemsResult={},pt.sendingSameRequests={},B.addClass("choicesByUrl",["url","path","valueName","titleName",{name:"imageLinkName",visibleIf:function(n){return!!n&&!!n.owner&&n.owner.getType()=="imagepicker"}},{name:"allowEmptyResponse:boolean"},{name:"attachData:boolean",alternativeName:"attachOriginalItems",visible:!1}],function(){return new pt});class rl extends kt{createColumnValues(){return this.createItemValues("columns")}constructor(e){super(e),this.generatedVisibleRows=null,this.generatedTotalRow=null,this.columns=this.createColumnValues(),this.rows=this.createItemValues("rows")}getType(){return"matrixbase"}endLoadingFromJson(){super.endLoadingFromJson(),this.updateVisibilityBasedOnRows()}get isCompositeQuestion(){return!0}get showHeader(){return this.getPropertyValue("showHeader")}set showHeader(e){this.setPropertyValue("showHeader",e)}get columns(){return this.getPropertyValue("columns")}set columns(e){this.setPropertyValue("columns",e)}get visibleColumns(){const e=[];return this.columns.forEach(t=>{this.isColumnVisible(t)&&e.push(t)}),e}isColumnVisible(e){return e.isVisible}get rows(){return this.getPropertyValue("rows")}set rows(e){var t=this.processRowsOnSet(e);this.setPropertyValue("rows",t)}processRowsOnSet(e){return e}getVisibleRows(){return[]}get visibleRows(){return this.getVisibleRows()}get rowsVisibleIf(){return this.getPropertyValue("rowsVisibleIf","")}set rowsVisibleIf(e){this.setPropertyValue("rowsVisibleIf",e),this.isLoadingFromJsonValue||this.runCondition(this.getDataFilteredProperties())}get columnsVisibleIf(){return this.getPropertyValue("columnsVisibleIf","")}set columnsVisibleIf(e){this.setPropertyValue("columnsVisibleIf",e),this.isLoadingFromJson||this.runCondition(this.getDataFilteredProperties())}runConditionCore(e){super.runConditionCore(e),this.runItemsCondition(e)}onColumnsChanged(){}onRowsChanged(){this.updateVisibilityBasedOnRows(),this.fireCallback(this.visibleRowsChangedCallback)}updateVisibilityBasedOnRows(){this.hideIfRowsEmpty&&this.onVisibleChanged()}isVisibleCore(){var e;const t=super.isVisibleCore();return!t||!this.hideIfRowsEmpty?t:((e=this.visibleRows)===null||e===void 0?void 0:e.length)>0}shouldRunColumnExpression(){return!this.survey||!this.survey.areInvisibleElementsShowing}hasRowsAsItems(){return!0}runItemsCondition(e){let t=this.hasRowsAsItems()&&this.runConditionsForRows(e);const s=this.runConditionsForColumns(e);t=s||t,t&&(this.isClearValueOnHidden&&s&&this.clearInvisibleColumnValues(),this.clearGeneratedRows(),s&&this.onColumnsChanged(),this.onRowsChanged())}clearGeneratedRows(){this.generatedVisibleRows=null}createRowsVisibleIfRunner(){return null}runConditionsForRows(e){const t=!!this.survey&&this.survey.areInvisibleElementsShowing,s=t?null:this.createRowsVisibleIfRunner(),i=fe.runConditionsForItems(this.rows,void 0,s,e,!t);return fe.runEnabledConditionsForItems(this.rows,void 0,e),i}runConditionsForColumns(e){const t=!!this.survey&&!this.survey.areInvisibleElementsShowing,s=this.getExpressionFromSurvey("columnsVisibleIf"),i=t&&s?new Gs(s):null;return fe.runConditionsForItems(this.columns,void 0,i,e,this.shouldRunColumnExpression())}clearInvisibleColumnValues(){}clearInvisibleValuesInRows(){}needResponsiveWidth(){return!0}get columnsAutoWidth(){return!this.isMobile&&!this.columns.some(e=>!!e.width)}getTableCss(){var e;return new j().append(this.cssClasses.root).append(this.cssClasses.columnsAutoWidth,this.columnsAutoWidth).append(this.cssClasses.noHeader,!this.showHeader).append(this.cssClasses.hasFooter,!!(!((e=this.renderedTable)===null||e===void 0)&&e.showAddRowOnBottom)).append(this.cssClasses.rootAlternateRows,this.alternateRows).append(this.cssClasses.rootVerticalAlignTop,this.verticalAlign==="top").append(this.cssClasses.rootVerticalAlignMiddle,this.verticalAlign==="middle").toString()}get columnMinWidth(){return this.getPropertyValue("columnMinWidth")||""}set columnMinWidth(e){this.setPropertyValue("columnMinWidth",e)}get rowTitleWidth(){return this.getPropertyValue("rowTitleWidth")||""}set rowTitleWidth(e){this.setPropertyValue("rowTitleWidth",e)}set displayMode(e){this.setPropertyValue("displayMode",e)}get displayMode(){return this.getPropertyValue("displayMode")}getCellAriaLabel(e,t,s){let i=e.locText&&e.locText.renderedHtml?e.locText.renderedHtml:"";s&&(i=s);const r=t.locTitle&&t.locTitle.renderedHtml?t.locTitle.renderedHtml:"",a=(this.getLocalizationString("matrix_row")||"row").toLocaleLowerCase(),o=(this.getLocalizationString("matrix_column")||"column").toLocaleLowerCase();return`${a} ${i}, ${o} ${r}`}get isNewA11yStructure(){return!0}getIsMobile(){return this.displayMode=="auto"?super.getIsMobile():this.displayMode==="list"}}I([R()],rl.prototype,"verticalAlign",void 0),I([R()],rl.prototype,"alternateRows",void 0),B.addClass("matrixbase",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},"columnsVisibleIf:condition","rowsVisibleIf:condition","columnMinWidth",{name:"showHeader:boolean",default:!0},{name:"verticalAlign",choices:["top","middle"],default:"middle"},{name:"alternateRows:boolean",default:!1},{name:"displayMode",default:"auto",choices:["auto","table","list"],visible:!1}],void 0,"question");class YR{}class I1{constructor(e,t){this.name=e,this.returnDisplayValue=t,this.isExists=!1}}class T1{constructor(){this._unObservableValues=[void 0]}get hasAllValuesOnLastRunValue(){return this._unObservableValues[0]}set hasAllValuesOnLastRunValue(e){this._unObservableValues[0]=e}process(e,t,s,i){if(this.hasAllValuesOnLastRunValue=!0,!e||!this.onProcess)return e;const r=this.getItems(e);for(let o=r.length-1;o>=0;o--){const l=r[o],u=this.getName(e.substring(l.start+1,l.end));if(u){const d=new I1(u,t===!0);if(this.onProcess(d),d.isExists||(this.hasAllValuesOnLastRunValue=!1),d.isExists||i){L.isValueEmpty(d.value)&&(this.hasAllValuesOnLastRunValue=!1);var a=L.isValueEmpty(d.value)?"":d.value;s&&(a=encodeURIComponent(a)),e=e.substring(0,l.start)+a+e.substring(l.end+1)}}}return e}processValue(e,t){var s=new I1(e,t);return this.onProcess&&this.onProcess(s),s}get hasAllValuesOnLastRun(){return!!this.hasAllValuesOnLastRunValue}processText(e,t){return this.process(e,t)}processTextEx(e){const t={hasAllValuesOnLastRun:!0,text:e.text};return t.text=this.process(e.text,e.returnDisplayValue,e.doEncoding,e.replaceUndefinedValues),t.hasAllValuesOnLastRun=this.hasAllValuesOnLastRun,t}getItems(e){for(var t=[],s=e.length,i=-1,r="",a=0;a<s;a++)if(r=e[a],r=="{"&&(i=a),r=="}"){if(i>-1){var o=new YR;o.start=i,o.end=a,this.isValidItemName(e.substring(i+1,a))&&t.push(o)}i=-1}return t}isValidItemName(e){return!!e&&e.indexOf(":")<0}getName(e){if(e)return e.trim()}}class nl{constructor(e){this.obj=e,this.textPreProcessor=new T1,this.textPreProcessor.onProcess=t=>{this.getProcessedTextValue(t)}}processText(e,t){const s={text:e,returnDisplayValue:t};return this.processTextEx(s).text}processTextEx(e){var t;return!e.runAtDesign&&(!((t=this.survey)===null||t===void 0)&&t.isDesignMode)?{hasAllValuesOnLastRun:!0,text:e.text}:this.textPreProcessor.processTextEx(e)}get survey(){const e=this.obj;return e.getSurvey?e.getSurvey():null}getProcessedTextValue(e){const t=e.name.toLocaleLowerCase(),s=new Di().getValueInfo({name:t,context:this.obj.getValueGetterContext(),isText:!0,isDisplayValue:e.returnDisplayValue});s.isFound&&(e.isExists=s.isFound,e.value=s.value)}}class XR{constructor(e,t){this.name=e,this.json=t;var s=this;B.addClass(e,[],function(i){return Pn.Instance.createQuestion(i?i.name:"",s)},"question"),this.onInit()}onInit(){this.json.onInit&&this.json.onInit()}onCreated(e){this.json.onCreated&&this.json.onCreated(e)}onLoaded(e){this.json.onLoaded&&this.json.onLoaded(e)}onAfterRender(e,t){this.json.onAfterRender&&this.json.onAfterRender(e,t)}onAfterRenderContentElement(e,t,s){this.json.onAfterRenderContentElement&&this.json.onAfterRenderContentElement(e,t,s)}onUpdateQuestionCssClasses(e,t,s){this.json.onUpdateQuestionCssClasses&&this.json.onUpdateQuestionCssClasses(e,t,s)}onSetQuestionValue(e,t){this.json.onSetQuestionValue&&this.json.onSetQuestionValue(e,t),this.json.onValueSet&&this.json.onValueSet(e,t)}onPropertyChanged(e,t,s){this.json.onPropertyChanged&&this.json.onPropertyChanged(e,t,s)}onValueChanged(e,t,s){this.json.onValueChanged&&this.json.onValueChanged(e,t,s)}onValueChanging(e,t,s){return this.json.onValueChanging?this.json.onValueChanging(e,t,s):s}onGetErrorText(e){if(this.json.getErrorText)return this.json.getErrorText(e)}onItemValuePropertyChanged(e,t,s,i,r){this.json.onItemValuePropertyChanged&&this.json.onItemValuePropertyChanged(e,{obj:t,propertyName:s,name:i,newValue:r})}getDisplayValue(e,t,s){return this.json.getDisplayValue?this.json.getDisplayValue(s):s.getDisplayValue(e,t)}get defaultQuestionTitle(){return this.json.defaultQuestionTitle}setValueToQuestion(e){const t=this.json.valueToQuestion||this.json.setValue;return t?t(e):e}getValueFromQuestion(e){const t=this.json.valueFromQuestion||this.json.getValue;return t?t(e):e}get isComposite(){return!!this.json.elementsJSON||!!this.json.createElements}getDynamicProperties(){return Array.isArray(this.dynamicProperties)||(this.dynamicProperties=this.calcDynamicProperties()),this.dynamicProperties}calcDynamicProperties(){const e=this.json.inheritBaseProps;if(!e||!this.json.questionJSON)return[];const t=this.json.questionJSON.type;if(!t)return[];if(Array.isArray(e)){const i=[];return e.forEach(r=>{const a=B.findProperty(t,r);a&&i.push(a)}),i}const s=[];for(let i in this.json.questionJSON)s.push(i);return B.getDynamicPropertiesByTypes(this.name,t,s)}}class Pn{constructor(){this.customQuestionValues=[]}add(e){if(!e)return;let t=e.name;if(!t)throw"Attribute name is missed";if(t=t.toLowerCase(),this.getCustomQuestionByName(t))throw"There is already registered custom question with name '"+t+"'";if(B.findClass(t))throw"There is already class with name '"+t+"'";var s=new XR(t,e);this.onAddingJson&&this.onAddingJson(t,s.isComposite),this.customQuestionValues.push(s)}remove(e){if(!e)return!1;const t=this.getCustomQuestionIndex(e.toLowerCase());return t<0?!1:(this.removeByIndex(t),!0)}get items(){return this.customQuestionValues}getCustomQuestionByName(e){const t=this.getCustomQuestionIndex(e);return t>=0?this.customQuestionValues[t]:void 0}getCustomQuestionIndex(e){for(var t=0;t<this.customQuestionValues.length;t++)if(this.customQuestionValues[t].name===e)return t;return-1}removeByIndex(e){B.removeClass(this.customQuestionValues[e].name),this.customQuestionValues.splice(e,1)}clear(e){for(let t=this.customQuestionValues.length-1;t>=0;t--)(e||!this.customQuestionValues[t].json.internal)&&this.removeByIndex(t)}createQuestion(e,t){return t.isComposite?this.createCompositeModel(e,t):this.createCustomModel(e,t)}createCompositeModel(e,t){return this.onCreateComposite?this.onCreateComposite(e,t):new s_(e,t)}createCustomModel(e,t){return this.onCreateCustom?this.onCreateCustom(e,t):new e_(e,t)}}Pn.Instance=new Pn;class E1 extends kt{constructor(e,t){super(e),this.customQuestion=t,it.createProperties(this),Ke.CreateDisabledDesignElements=!0,this.locQuestionTitle=this.createLocalizableString("questionTitle"),this.locQuestionTitle.setJson(this.customQuestion.defaultQuestionTitle),this.createWrapper(),Ke.CreateDisabledDesignElements=!1,this.customQuestion&&this.customQuestion.onCreated(this)}getType(){return this.customQuestion?this.customQuestion.name:"custom"}locStrsChanged(){super.locStrsChanged(),this.getElement()&&this.getElement().locStrsChanged()}localeChanged(){super.locStrsChanged(),this.getElement()&&this.getElement().localeChanged()}getDefaultTitle(){return this.locQuestionTitle.isEmpty?super.getDefaultTitle():this.getProcessedText(this.locQuestionTitle.textOrHtml)}addUsedLocales(e){super.addUsedLocales(e),this.getElement()&&this.getElement().addUsedLocales(e)}needResponsiveWidth(){const e=this.getElement();return e?e.needResponsiveWidth():!1}createWrapper(){}onPropertyValueChanged(e,t,s){super.onPropertyValueChanged(e,t,s),this.customQuestion&&!this.isLoadingFromJson&&this.customQuestion.onPropertyChanged(this,e,s)}itemValuePropertyChanged(e,t,s,i){super.itemValuePropertyChanged(e,t,s,i),this.customQuestion&&!this.isLoadingFromJson&&this.customQuestion.onItemValuePropertyChanged(this,e,e.ownerPropertyName,t,i)}onFirstRenderingCore(){super.onFirstRenderingCore();const e=this.getElement();e&&e.onFirstRendering()}onHidingContent(){super.onHidingContent();const e=this.getElement();e&&e.onHidingContent()}getProgressInfo(){let e=super.getProgressInfo();return this.getElement()&&(e=this.getElement().getProgressInfo()),this.isRequired&&e.requiredQuestionCount==0&&(e.requiredQuestionCount=1,this.isEmpty()||(e.answeredQuestionCount=1)),e}initElement(e){e&&(e.setSurveyImpl(this),e.disableDesignActions=!0)}setSurveyImpl(e,t){this.isSettingValOnLoading=!0,super.setSurveyImpl(e,t),this.initElement(this.getElement()),this.isSettingValOnLoading=!1}onCustomQuestionLoaded(){!this.isLoadedCalled&&this.customQuestion&&this.survey&&(this.customQuestion.onLoaded(this),this.isLoadedCalled=!0)}onSurveyLoad(){super.onSurveyLoad(),this.isLoadedCalled=!1,this.getElement()&&this.getElement().onSurveyLoad(),this.onCustomQuestionLoaded()}setSurveyCore(e){super.setSurveyCore(e),this.isLoadedCalled===!1&&e&&this.onCustomQuestionLoaded()}afterRenderQuestionElement(e){}afterRenderCore(e){super.afterRenderCore(e),this.customQuestion&&this.customQuestion.onAfterRender(this,e)}onUpdateQuestionCssClasses(e,t){this.customQuestion&&this.customQuestion.onUpdateQuestionCssClasses(this,e,t)}setQuestionValue(e,t=!0){super.setQuestionValue(e,t),this.updateElementCss(),this.customQuestion&&this.customQuestion.onSetQuestionValue(this,e)}setNewValue(e){super.setNewValue(e),this.updateElementCss()}onCheckForErrors(e,t,s){if(super.onCheckForErrors(e,t,s),this.customQuestion){const i=this.customQuestion.onGetErrorText(this);i&&e.push(new Ps(i,this))}}getSurveyData(){return this}getTextProcessor(){return this.textProcessor}getValue(e){return this.value}setValue(e,t,s,i){if(!this.data)return;this.customQuestion&&this.customQuestion.onValueChanged(this,e,t);var r=this.convertDataName(e);let a=this.convertDataValue(e,t);this.valueToDataCallback&&(a=this.valueToDataCallback(a)),this.data.setValue(r,a,s,i),this.updateIsAnswered(),this.updateElementCss()}getQuestionByName(e){}isValueChanging(e,t){if(this.customQuestion){const s=t;if(t=this.customQuestion.onValueChanging(this,e,t),!L.isTwoValueEquals(t,s)){const i=this.getQuestionByName(e);if(i)return i.value=t,!0}}return!1}convertDataName(e){return this.getValueName()}convertDataValue(e,t){return t}getVariable(e){return this.data?this.data.getVariable(e):null}setVariable(e,t){this.data&&this.data.setVariable(e,t)}getComment(e){return this.data?this.data.getComment(this.getValueName()):""}setComment(e,t,s){this.data&&this.data.setComment(this.getValueName(),t,s)}getAllValues(){return this.data?this.data.getAllValues():{}}getFilteredProperties(){return this.data?this.data.getFilteredProperties():{}}findQuestionByName(e){return this.data?this.data.findQuestionByName(e):null}getEditingSurveyElement(){}addElement(e,t){}removeElement(e){return!1}getQuestionTitleLocation(){return"left"}getQuestionTitleWidth(){}getColumsForElement(e){return[]}updateColumns(){}getQuestionStartIndex(){return this.getStartIndex()}getChildrenLayoutType(){return"row"}elementWidthChanged(e){}get elements(){return[]}indexOf(e){return-1}ensureRowsVisibility(){}validateContainerOnly(){}onQuestionValueChanged(e){}getQuestionErrorLocation(){return this.getErrorLocation()}getContentAriaHidden(){return this.isDesignMode||super.getContentAriaHidden()}getContentDisplayValueCore(e,t,s){return s?this.customQuestion.getDisplayValue(e,t,s):super.getDisplayValueCore(e,t)}}class e_ extends E1{getTemplate(){return"custom"}getDynamicProperties(){return this.customQuestion.getDynamicProperties()||[]}getDynamicType(){return this.questionWrapper?this.questionWrapper.getType():"question"}getOriginalObj(){return this.questionWrapper}createWrapper(){this.questionWrapper=this.createQuestion(),this.createDynamicProperties(this.questionWrapper),this.getDynamicProperties().length>0&&(this.questionWrapper.onPropertyValueChangedCallback=(e,t,s,i,r)=>{this.getDynamicProperty(e)&&this.propertyValueChanged(e,t,s,r)})}getDynamicProperty(e){const t=this.getDynamicProperties();for(let s=0;s<t.length;s++)if(t[s].name===e)return t[s];return null}getElement(){return this.contentQuestion}supportAutoAdvance(){return!!this.contentQuestion&&this.contentQuestion.supportAutoAdvance()}onAnyValueChanged(e,t){super.onAnyValueChanged(e,t),this.contentQuestion&&this.contentQuestion.onAnyValueChanged(e,t)}getQuestionByName(e){return this.contentQuestion}getDefaultTitle(){return this.hasJSONTitle&&this.contentQuestion?this.getProcessedText(this.contentQuestion.title):super.getDefaultTitle()}setValue(e,t,s,i){this.isValueChanging(e,t)||super.setValue(e,t,s,i)}updateCommentFromSurvey(e){super.updateCommentFromSurvey(e);const t=this.contentQuestion;t&&t.updateCommentFromSurvey(e)}get requireUpdateCommentValue(){var e;return(e=this.contentQuestion)===null||e===void 0?void 0:e.requireUpdateCommentValue}onSetData(){super.onSetData(),this.survey&&!this.isEmpty()&&this.setValue(this.name,this.value,!1,this.allowNotifyValueChanged)}validateElementCore(e){if(!this.contentQuestion)return!0;var t=this.contentQuestion.validateElement(e);this.errors=[];for(var s=0;s<this.contentQuestion.errors.length;s++)this.errors.push(this.contentQuestion.errors[s]);return t=t&&super.validateElementCore(e),this.updateElementCss(),t}focus(e=!1){this.contentQuestion?this.contentQuestion.focus(e):super.focus(e)}afterRenderCore(e){super.afterRenderCore(e),this.contentQuestion&&this.contentQuestion.afterRender(e)}get contentQuestion(){return this.questionWrapper}createQuestion(){var e=this.customQuestion.json,t=null;if(e.questionJSON){this.hasJSONTitle=!!e.questionJSON.title;let s=e.questionJSON.type;if(!s||!B.findClass(s))throw"type attribute in questionJSON is empty or incorrect";t=B.createClass(s),t.fromJSON(e.questionJSON),t=this.checkCreatedQuestion(t)}else e.createQuestion&&(t=this.checkCreatedQuestion(e.createQuestion()));return this.initElement(t),t&&(t.isContentElement=!0,t.name||(t.name="question"),t.onUpdateCssClassesCallback=s=>{this.onUpdateQuestionCssClasses(t,s)},t.hasCssErrorCallback=()=>this.errors.length>0,t.setValueChangedDirectlyCallback=s=>{this.setValueChangedDirectly(s)}),t}checkCreatedQuestion(e){return e&&(e.isQuestion||(Array.isArray(e.questions)&&e.questions.length>0?e=e.questions[0]:e=B.createClass("text"),xs.error("Could not create component: '"+this.getType()+"'. questionJSON should be a question.")),e)}onSurveyLoad(){super.onSurveyLoad(),this.contentQuestion&&this.isEmpty()&&!this.contentQuestion.isEmpty()&&(this.value=this.getContentQuestionValue())}runConditionCore(e){super.runConditionCore(e),this.contentQuestion&&this.contentQuestion.runCondition(e)}convertDataName(e){const t=this.contentQuestion;if(!t||e===this.getValueName())return super.convertDataName(e);var s=e.replace(t.getValueName(),this.getValueName());return s.indexOf(this.getValueName())==0?s:super.convertDataName(e)}convertDataValue(e,t){return this.convertDataName(e)==super.convertDataName(e)?this.getContentQuestionValue():t}getContentQuestionValue(){if(!this.contentQuestion)return;let e=this.contentQuestion.value;return this.customQuestion&&(e=this.customQuestion.getValueFromQuestion(e)),e}setContentQuestionValue(e){this.contentQuestion&&(this.customQuestion&&(e=this.customQuestion.setValueToQuestion(e)),this.contentQuestion.value=e)}canSetValueToSurvey(){return!1}setQuestionValue(e,t=!0){super.setQuestionValue(e,t),!this.isLoadingFromJson&&this.contentQuestion&&!this.isTwoValueEquals(this.getContentQuestionValue(),e)&&this.setContentQuestionValue(this.getUnbindValue(e))}onSurveyValueChanged(e){super.onSurveyValueChanged(e),this.contentQuestion&&this.contentQuestion.onSurveyValueChanged(e)}getValueCore(){return this.contentQuestion?this.getContentQuestionValue():super.getValueCore()}setValueChangedDirectly(e){this.isSettingValueChanged||(this.isSettingValueChanged=!0,super.setValueChangedDirectly(e),this.contentQuestion&&this.contentQuestion.setValueChangedDirectly(e),this.isSettingValueChanged=!1)}createDynamicProperties(e){if(!e)return;const t=this.getDynamicProperties();Array.isArray(t)&&B.addDynamicPropertiesIntoObj(this,e,t)}initElement(e){super.initElement(e),e&&(e.parent=this,e.afterRenderQuestionCallback=(t,s)=>{this.customQuestion&&this.customQuestion.onAfterRenderContentElement(this,t,s)},e.onGetNoCallback=t=>this.no)}updateElementCss(e){this.contentQuestion&&this.questionWrapper.updateElementCss(e),super.updateElementCss(e)}setIsMobile(e){super.setIsMobile(e),this.contentQuestion&&this.contentQuestion.setIsMobile(e)}updateElementCssCore(e){this.contentQuestion&&(e=this.contentQuestion.cssClasses),super.updateElementCssCore(e)}getDisplayValueCore(e,t){return super.getContentDisplayValueCore(e,t,this.contentQuestion)}}class t_ extends il{constructor(e){super(e),this.question=e}getValue(e,t,s,i){const r=this.question;return e.length>0&&(e.length>1||!t)?(e[0].name===D.expressionVariables.composite&&e.shift(),new _d(r.contentPanel.questions).getValue(e,!1,s,i)):{isFound:!1}}}class s_ extends E1{constructor(e,t){super(e,t),this.customQuestion=t,this.settingNewValue=!1,this.textProcessing=new nl(this)}createWrapper(){this.panelWrapper=this.createPanel()}getTemplate(){return"composite"}getElement(){return this.contentPanel}getCssRoot(e){return new j().append(super.getCssRoot(e)).append(e.composite).toString()}get contentPanel(){return this.panelWrapper}validateElementCore(e){const t=super.validateElementCore(e),s=this.contentPanel;return s?s.validateElement(e)&&t:t}updateElementCss(e){super.updateElementCss(e),this.contentPanel&&this.contentPanel.updateElementCss(e)}dispose(){this.unConnectEditingObj(),super.dispose()}updateEditingObj(){var e;const t=(e=this.data)===null||e===void 0?void 0:e.getEditingSurveyElement();if(!t)return;let s=t[this.getValueName()];return s&&!s.onPropertyChanged&&(s=void 0),s!==this.editingObjValue&&(this.unConnectEditingObj(),this.editingObjValue=s,s&&(this.onEditingObjPropertyChanged=(i,r)=>{this.setNewValueIntoQuestion(r.name,this.editingObjValue[r.name])},s.onPropertyChanged.add(this.onEditingObjPropertyChanged))),this.editingObjValue}unConnectEditingObj(){this.editingObjValue&&!this.editingObjValue.isDisposed&&this.editingObjValue.onPropertyChanged.remove(this.onEditingObjPropertyChanged)}getEditingSurveyElement(){return this.editingObjValue}getTextProcessor(){return this.textProcessing}findQuestionByName(e){const t=this.getQuestionByName(e);return t||super.findQuestionByName(e)}clearValueIfInvisibleCore(e){super.clearValueIfInvisibleCore(e);const t=this.contentPanel.questions;for(var s=0;s<t.length;s++)t[s].clearValueIfInvisible(e)}onAnyValueChanged(e,t){super.onAnyValueChanged(e,t);for(var s=this.contentPanel.questions,i=0;i<s.length;i++)s[i].onAnyValueChanged(e,t)}get isContainer(){return!0}createPanel(){var e=B.createClass("panel");e.showQuestionNumbers="off",e.renderWidth="100%";var t=this.customQuestion.json;return t.elementsJSON&&e.fromJSON({elements:t.elementsJSON}),t.createElements&&t.createElements(e,this),this.initElement(e),this.setIsContentElement(e),e.readOnly=this.isReadOnly,e.onGetNoCallback=s=>this.no,e.questions.forEach(s=>{s.setParentQuestion(this),s.onUpdateCssClassesCallback=i=>{this.onUpdateQuestionCssClasses(s,i)}}),this.setAfterRenderCallbacks(e),e}onReadOnlyChanged(){this.contentPanel&&(this.contentPanel.readOnly=this.isReadOnly),super.onReadOnlyChanged()}updateValueFromSurvey(e,t=!1){this.updateEditingObj(),super.updateValueFromSurvey(e,t)}onSurveyLoad(){if(this.isSettingValOnLoading=!0,this.contentPanel&&(this.contentPanel.readOnly=this.isReadOnly,this.setIsContentElement(this.contentPanel)),super.onSurveyLoad(),this.contentPanel){const e=this.getContentPanelValue();L.isValueEmpty(e)||(this.value=e)}this.isSettingValOnLoading=!1}setIsContentElement(e){e.isContentElement=!0;for(var t=e.elements,s=0;s<t.length;s++){var i=t[s];i.isPanel?this.setIsContentElement(i):i.isContentElement=!0}}setVisibleIndex(e){if(this.isVisibleIndexNegative(e))return super.setVisibleIndex(-1);let t=super.setVisibleIndex(e);return this.isVisible&&this.contentPanel&&(t+=this.contentPanel.setVisibleIndex(e+1)),t}runConditionCore(e){super.runConditionCore(e),this.contentPanel&&this.contentPanel.runCondition(e)}onSurveyValueChanged(e){super.onSurveyValueChanged(e);const t=e||{};this.contentPanel&&this.contentPanel.questions.forEach(s=>{s.onSurveyValueChanged(t[s.getValueName()])})}getValue(e){var t=this.value;return t?t[e]:null}getQuestionByName(e){return this.contentPanel?this.contentPanel.getQuestionByName(e):void 0}setValue(e,t,s,i){if(this.settingNewValue){this.setNewValueIntoQuestion(e,t);return}if(!this.isValueChanging(e,t)){if(this.settingNewValue=!0,!this.isEditingSurveyElement&&this.contentPanel){let r=0;const a=this.contentPanel.questions.length+1;for(;r<a&&this.updateValueCoreWithPanelValue();)r++}this.setNewValueIntoQuestion(e,t),super.setValue(e,t,s,i),this.settingNewValue=!1,this.runPanelTriggers(D.expressionVariables.composite+"."+e,t),this.isEditingSurveyElement&&this.runCondition(this.getFilteredProperties())}}setComment(e,t,s){let i=this.getUnbindValue(this.value);const r=this.getCommentName(e);if(!i&&!t||t&&i&&i[r]===t)return;t?(i||(i={}),i[r]=t):delete i[r];const a=this.getQuestionByName(e);a&&a.comment!==t&&(a.comment=t),this.settingNewValue||(this.value=i)}getComment(e){const t=this.getQuestionByName(e);if(t)return t.comment;const s=this.value;return!!s&&s[this.getCommentName(e)]||""}getCommentName(e){return e+D.commentSuffix}runPanelTriggers(e,t){this.contentPanel&&this.contentPanel.questions.forEach(s=>{s.runTriggers(e,t)})}updateValueCoreWithPanelValue(){const e=this.getContentPanelValue();return this.isTwoValueEquals(this.getValueCore(),e)?!1:(this.setValueCore(e),!0)}getContentPanelValue(e){return e||(e=this.contentPanel.getValue()),this.customQuestion.setValueToQuestion(e)}getValueForContentPanel(e){return this.customQuestion.getValueFromQuestion(e)}setNewValueIntoQuestion(e,t){var s=this.getQuestionByName(e);s&&!this.isTwoValueEquals(t,s.value)&&(s.value=t)}addConditionObjectsByContext(e,t){if(this.contentPanel)for(var s=this.contentPanel.questions,i=this.name,r=this.title,a=0;a<s.length;a++)e.push({name:i+"."+s[a].name,text:r+"."+s[a].title,question:s[a]})}collectNestedQuestionsCore(e,t,s,i){this.contentPanel&&(i&&e.push(this),this.contentPanel.questions.forEach(r=>r.addNestedQuestion(e,t,s,i)))}convertDataValue(e,t){var s=this.contentPanel&&!this.isEditingSurveyElement?this.contentPanel.getValue():this.getValueForContentPanel(this.value);return s||(s={}),s.getType||(s=L.getUnbindValue(s)),this.isValueEmpty(t)&&!this.isEditingSurveyElement?delete s[e]:s[e]=t,this.getContentPanelValue(s)}setQuestionValue(e,t=!0){this.setValuesIntoQuestions(e),!this.isEditingSurveyElement&&this.contentPanel&&(e=this.getContentPanelValue()),super.setQuestionValue(e,t)}setValuesIntoQuestions(e){if(!this.contentPanel||this.settingNewValue)return;e=this.getValueForContentPanel(e);const t=this.settingNewValue;this.settingNewValue=!0;const s=this.contentPanel.questions;for(var i=0;i<s.length;i++){const r=s[i],a=r.getValueName(),o=this.getCommentName(a),l=e?e[a]:void 0,u=!!e&&e[o]||"";!this.isTwoValueEquals(r.value,l)&&(l!==void 0||!r.isEmpty())&&(r.value=l),r.comment!==u&&(r.comment=u)}this.settingNewValue=t}getValueGetterContext(){return new t_(this)}getDisplayValueCore(e,t){return super.getContentDisplayValueCore(e,t,this.contentPanel)}setAfterRenderCallbacks(e){if(!(!e||!this.customQuestion))for(var t=e.questions,s=0;s<t.length;s++)t[s].afterRenderQuestionCallback=(i,r)=>{this.customQuestion.onAfterRenderContentElement(this,i,r)}}get ariaRole(){return"group"}setIsMobile(e){super.setIsMobile(e),this.contentPanel&&this.contentPanel.questions.forEach(t=>{t.setIsMobile(e)})}}class Qe{static get DefaultChoices(){const e=bt("choices_Item");return[e+"1",e+"2",e+"3"]}static get DefaultColums(){var e=bt("matrix_column")+" ";return[e+"1",e+"2",e+"3"]}static get DefaultRows(){var e=bt("matrix_row")+" ";return[e+"1",e+"2"]}static get DefaultMutlipleTextItems(){var e=bt("multipletext_itemname");return[e+"1",e+"2"]}registerQuestion(e,t,s=!0){gi.Instance.registerElement(e,t,s)}registerCustomQuestion(e){gi.Instance.registerCustomQuestion(e)}unregisterElement(e,t=!1){gi.Instance.unregisterElement(e,t)}clear(){gi.Instance.clear()}getAllTypes(){return gi.Instance.getAllTypes()}createQuestion(e,t){return gi.Instance.createElement(e,t)}}Qe.Instance=new Qe;class gi{constructor(){this.creatorHash={},this.registerCustomQuestion=(e,t=!0)=>{const s=i=>{const r=B.createClass(e);return r&&(r.name=i),r};this.registerElement(e,s,t)}}registerElement(e,t,s=!0){this.creatorHash[e]={showInToolbox:s,creator:t}}clear(){this.creatorHash={}}unregisterElement(e,t=!1){delete this.creatorHash[e],t&&B.removeClass(e)}getAllToolboxTypes(){return this.getAllTypesCore(!0)}getAllTypes(){return this.getAllTypesCore(!1)}createElement(e,t){var s=this.creatorHash[e];if(s&&s.creator)return s.creator(t);const i=Pn.Instance.getCustomQuestionByName(e);return i?Pn.Instance.createQuestion(t,i):null}getAllTypesCore(e){var t=new Array;for(var s in this.creatorHash)(!e||this.creatorHash[s].showInToolbox)&&t.push(s);return t.sort()}}gi.Instance=new gi;class R1 extends kt{constructor(e){super(e),this.createLocalizableString("format"),this.registerPropertyChangedHandlers(["format","currency","displayStyle"],()=>{this.updateFormatedValue()})}getType(){return"expression"}get hasInput(){return!1}get format(){return this.getLocalizableStringText("format","")}set format(e){this.setLocalizableStringText("format",e)}get locFormat(){return this.getLocalizableString("format")}get expression(){return this.getPropertyValue("expression","")}set expression(e){this.setPropertyValue("expression",e)}locCalculation(){this.isExecutionLocked=!0}unlocCalculation(){this.isExecutionLocked=!1}runConditionCore(e){super.runConditionCore(e),!(this.isExecutionLocked||!this.runIfReadOnly&&this.isReadOnly)&&this.runExpressionByProperty("expression",e,t=>{this.value=this.roundValue(t)})}canCollectErrors(){return!0}hasRequiredError(){return!1}get maximumFractionDigits(){return this.getPropertyValue("maximumFractionDigits")}set maximumFractionDigits(e){e<-1||e>20||this.setPropertyValue("maximumFractionDigits",e)}get minimumFractionDigits(){return this.getPropertyValue("minimumFractionDigits")}set minimumFractionDigits(e){e<-1||e>20||this.setPropertyValue("minimumFractionDigits",e)}get runIfReadOnly(){return this.runIfReadOnlyValue===!0}set runIfReadOnly(e){this.runIfReadOnlyValue=e}get formatedValue(){return this.getPropertyValue("formatedValue","")}updateFormatedValue(){this.setPropertyValue("formatedValue",this.getDisplayValueCore(!1,this.value))}onValueChanged(){this.updateFormatedValue()}updateValueFromSurvey(e,t){super.updateValueFromSurvey(e,t),this.updateFormatedValue()}getDisplayValueCore(e,t){var s=t??this.defaultValue,i="";if(!this.isValueEmpty(s)){var r=this.getValueAsStr(s);i=this.format?this.format.format(r):r}return this.survey&&(i=this.survey.getExpressionDisplayValue(this,s,i)),i}get displayStyle(){return this.getPropertyValue("displayStyle")}set displayStyle(e){this.setPropertyValue("displayStyle",e)}get currency(){return this.getPropertyValue("currency")}set currency(e){al().indexOf(e)<0||this.setPropertyValue("currency",e)}get useGrouping(){return this.getPropertyValue("useGrouping")}set useGrouping(e){this.setPropertyValue("useGrouping",e)}get precision(){return this.getPropertyValue("precision")}set precision(e){this.setPropertyValue("precision",e)}roundValue(e){if(e!==1/0)return this.precision<0||!L.isNumber(e)?e:parseFloat(e.toFixed(this.precision))}getValueAsStr(e){if(this.displayStyle=="date"){const i=Ot("question-expression",e);if(i&&i.toLocaleDateString)return i.toLocaleDateString()}if(this.displayStyle!="none"&&L.isNumber(e)){var t=this.getLocale();t||(t="en");var s={style:this.displayStyle,currency:this.currency,useGrouping:this.useGrouping};return this.maximumFractionDigits>-1&&(s.maximumFractionDigits=this.maximumFractionDigits),this.minimumFractionDigits>-1&&(s.minimumFractionDigits=this.minimumFractionDigits),e.toLocaleString(t,s)}return e.toString()}get ariaRole(){return"presentation"}}function al(){return["AED","AFN","ALL","AMD","ANG","AOA","ARS","AUD","AWG","AZN","BAM","BBD","BDT","BGN","BHD","BIF","BMD","BND","BOB","BOV","BRL","BSD","BTN","BWP","BYN","BZD","CAD","CDF","CHE","CHF","CHW","CLF","CLP","CNY","COP","COU","CRC","CUC","CUP","CVE","CZK","DJF","DKK","DOP","DZD","EGP","ERN","ETB","EUR","FJD","FKP","GBP","GEL","GHS","GIP","GMD","GNF","GTQ","GYD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","INR","IQD","IRR","ISK","JMD","JOD","JPY","KES","KGS","KHR","KMF","KPW","KRW","KWD","KYD","KZT","LAK","LBP","LKR","LRD","LSL","LYD","MAD","MDL","MGA","MKD","MMK","MNT","MOP","MRO","MUR","MVR","MWK","MXN","MXV","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","PYG","QAR","RON","RSD","RUB","RWF","SAR","SBD","SCR","SDG","SEK","SGD","SHP","SLL","SOS","SRD","SSP","STD","SVC","SYP","SZL","THB","TJS","TMT","TND","TOP","TRY","TTD","TWD","TZS","UAH","UGX","USD","USN","UYI","UYU","UZS","VEF","VND","VUV","WST","XAF","XAG","XAU","XBA","XBB","XBC","XBD","XCD","XDR","XOF","XPD","XPF","XPT","XSU","XTS","XUA","XXX","YER","ZAR","ZMW","ZWL"]}function _1(n,e,t){let s=t?e:n;return n==-1||e==-1?s:n>e?t?n:e:s}B.addClass("expression",["expression:expression",{name:"format",serializationProperty:"locFormat"},{name:"displayStyle",default:"none",choices:["none","decimal","currency","percent","date"]},{name:"currency",choices:()=>al(),default:"USD",visibleIf:n=>n.displayStyle==="currency"},{name:"maximumFractionDigits:number",onSettingValue:(n,e)=>_1(n.minimumFractionDigits,e,!0),default:-1},{name:"minimumFractionDigits:number",onSettingValue:(n,e)=>_1(e,n.maximumFractionDigits,!1),default:-1},{name:"useGrouping:boolean",default:!0},{name:"precision:number",default:-1,category:"data"},{name:"enableIf",visible:!1,isSerializable:!1},{name:"isRequired",visible:!1,isSerializable:!1},{name:"readOnly",visible:!1,isSerializable:!1},{name:"requiredErrorText",visible:!1,isSerializable:!1},{name:"resetValueIf",visible:!1,isSerializable:!1},{name:"setValueIf",visible:!1,isSerializable:!1},{name:"setValueExpression",visible:!1,isSerializable:!1},{name:"defaultValueExpression",visible:!1,isSerializable:!1},{name:"defaultValue",visible:!1,isSerializable:!1},{name:"correctAnswer",visible:!1,isSerializable:!1},{name:"requiredIf",visible:!1,isSerializable:!1}],function(){return new R1("")},"question"),Qe.Instance.registerQuestion("expression",n=>new R1(n));class i_{constructor(e){this.column=e}getValue(e,t,s,i){if(e.length===1&&["name","item"].indexOf(e[0].name)>-1)return{isFound:!0,value:this.column.name}}getRootObj(){return this.column.colOwner}}function ol(n,e,t,s){n.storeOthersAsComment=t?t.storeOthersAsComment:!1,(!n.choices||n.choices.length==0)&&n.choicesByUrl.isEmpty&&(n.choices=t.choices),n.choicesByUrl.isEmpty||n.choicesByUrl.run(s.getTextProcessor())}function r_(n,e,t,s){ol(n,e,t,s),n.locPlaceholder&&n.locPlaceholder.isEmpty&&!t.locPlaceholder.isEmpty&&(n.placeholder=t.placeholder)}var L1={dropdown:{onCellQuestionUpdate:(n,e,t,s)=>{r_(n,e,t,s)}},checkbox:{onCellQuestionUpdate:(n,e,t,s)=>{ol(n,e,t,s),n.colCount=e.colCount>-1?e.colCount:t.columnColCount}},radiogroup:{onCellQuestionUpdate:(n,e,t,s)=>{ol(n,e,t,s),n.colCount=e.colCount>-1?e.colCount:t.columnColCount}},tagbox:{onCellQuestionUpdate:(n,e,t,s)=>{ol(n,e,t,s)}},text:{},comment:{},boolean:{onCellQuestionUpdate:(n,e,t,s)=>{n.renderAs=e.renderAs}},expression:{},rating:{},slider:{}};class ll extends de{static getColumnTypes(){var e=[];for(var t in L1)e.push(t);return e}constructor(e,t,s){super(),this.indexValue=-1,this._hasVisibleCell=!0,this.isColumnsVisibleIf=!0,this.previousChoicesId=void 0,this.colOwnerValue=s,this.createLocalizableString("totalFormat"),this.createLocalizableString("cellHint"),this.registerPropertyChangedHandlers(["showInMultipleColumns"],()=>{this.doShowInMultipleColumnsChanged()}),this.registerPropertyChangedHandlers(["visible"],()=>{this.doColumnVisibilityChanged()}),this.updateTemplateQuestion(void 0,e,t)}getOriginalObj(){return this.templateQuestion}getClassNameProperty(){return"cellType"}getSurvey(e=!1){return this.colOwner?this.colOwner.survey:null}endLoadingFromJson(){super.endLoadingFromJson(),this.templateQuestion.autoOtherMode=this.isShowInMultipleColumns,this.templateQuestion.endLoadingFromJson(),this.templateQuestion.onGetSurvey=()=>this.getSurvey()}getDynamicPropertyName(){return"cellType"}getDynamicType(){return this.cellType==="default"?"question":this.calcCellQuestionType(null)}get colOwner(){return this.colOwnerValue}set colOwner(e){this.colOwnerValue=e,e&&(this.updateTemplateQuestion(),this.setParentQuestionToTemplate(this.templateQuestion))}getValueGetterContext(){return new i_(this)}locStrsChanged(){super.locStrsChanged(),this.locTitle.strChanged()}addUsedLocales(e){super.addUsedLocales(e),this.templateQuestion.addUsedLocales(e)}get index(){return this.indexValue}setIndex(e){this.indexValue=e}getType(){return"matrixdropdowncolumn"}get cellType(){return this.getPropertyValue("cellType")}set cellType(e){e=e.toLocaleLowerCase(),this.updateTemplateQuestion(e),this.setPropertyValue("cellType",e),this.colOwner&&this.colOwner.onColumnCellTypeChanged(this)}get templateQuestion(){return this.templateQuestionValue}get value(){return this.templateQuestion.name}get isVisible(){return!0}get isColumnVisible(){return this.isDesignMode?!0:this.visible&&this.hasVisibleCell}get visible(){return this.templateQuestion.visible}set visible(e){this.templateQuestion.visible=e}get hasVisibleCell(){return this._hasVisibleCell}set hasVisibleCell(e){this._hasVisibleCell=e}getVisibleMultipleChoices(){const e=this.templateQuestion.visibleChoices;if(!Array.isArray(e))return[];if(!Array.isArray(this._visiblechoices))return e;const t=new Array;for(let s=0;s<e.length;s++){const i=e[s];this._visiblechoices.indexOf(i.value)>-1&&t.push(i)}return t}get getVisibleChoicesInCell(){if(Array.isArray(this._visiblechoices))return this._visiblechoices;const e=this.templateQuestion.visibleChoices;return Array.isArray(e)?e:[]}setVisibleChoicesInCell(e){this._visiblechoices=e}get isFilteredMultipleColumns(){if(!this.showInMultipleColumns)return!1;const e=this.templateQuestion.choices;if(!Array.isArray(e))return!1;for(let t=0;t<e.length;t++)if(e[t].visibleIf)return!0;return!1}get name(){return this.templateQuestion.name}set name(e){this.templateQuestion.name=e}get title(){return this.templateQuestion.title}set title(e){this.templateQuestion.title=e}get locTitle(){return this.templateQuestion.locTitle}get fullTitle(){return this.locTitle.textOrHtml}get defaultDisplayValue(){return this.templateQuestion.defaultDisplayValue}set defaultDisplayValue(e){this.templateQuestion.defaultDisplayValue=e}get locDefaultDisplayValue(){return this.templateQuestion.locDefaultDisplayValue}get isRequired(){return this.getPropertyValue("isRequired")}set isRequired(e){this.setPropertyValue("isRequired",e),this.templateQuestion.isRequired=e}get isRenderedRequired(){return this.getPropertyValue("isRenderedRequired",this.isRequired)}set isRenderedRequired(e){this.setPropertyValue("isRenderedRequired",e)}updateIsRenderedRequired(e){this.isRenderedRequired=e||this.isRequired}get requiredMark(){return this.isRenderedRequired&&this.getSurvey()?this.getSurvey().requiredMark:this.templateQuestion.requiredMark}get requiredErrorText(){return this.templateQuestion.requiredErrorText}set requiredErrorText(e){this.templateQuestion.requiredErrorText=e}get locRequiredErrorText(){return this.templateQuestion.locRequiredErrorText}get readOnly(){return this.templateQuestion.readOnly}set readOnly(e){this.templateQuestion.readOnly=e}get hasOther(){return this.showOtherItem}set hasOther(e){this.showOtherItem=e}get showOtherItem(){return this.templateQuestion.showOtherItem}set showOtherItem(e){this.templateQuestion.showOtherItem=e}get visibleIf(){return this.templateQuestion.visibleIf}set visibleIf(e){this.templateQuestion.visibleIf=e}get enableIf(){return this.templateQuestion.enableIf}set enableIf(e){this.templateQuestion.enableIf=e}get requiredIf(){return this.templateQuestion.requiredIf}set requiredIf(e){this.templateQuestion.requiredIf=e}get resetValueIf(){return this.templateQuestion.resetValueIf}set resetValueIf(e){this.templateQuestion.resetValueIf=e}get defaultValueExpression(){return this.templateQuestion.defaultValueExpression}set defaultValueExpression(e){this.templateQuestion.defaultValueExpression=e}get setValueIf(){return this.templateQuestion.setValueIf}set setValueIf(e){this.templateQuestion.setValueIf=e}get setValueExpression(){return this.templateQuestion.setValueExpression}set setValueExpression(e){this.templateQuestion.setValueExpression=e}get isUnique(){return this.getPropertyValue("isUnique")}set isUnique(e){this.setPropertyValue("isUnique",e)}get showInMultipleColumns(){return this.getPropertyValue("showInMultipleColumns")}set showInMultipleColumns(e){this.setPropertyValue("showInMultipleColumns",e)}get isSupportMultipleColumns(){return["checkbox","radiogroup"].indexOf(this.cellType)>-1}get isShowInMultipleColumns(){return this.showInMultipleColumns&&this.isSupportMultipleColumns}get validators(){return this.templateQuestion.validators}set validators(e){this.templateQuestion.validators=e}get totalType(){return this.getPropertyValue("totalType")}set totalType(e){this.setPropertyValue("totalType",e)}get totalExpression(){return this.getPropertyValue("totalExpression")}set totalExpression(e){this.setPropertyValue("totalExpression",e)}get hasTotal(){return this.totalType!="none"||!!this.totalExpression}get totalFormat(){return this.getLocalizableStringText("totalFormat","")}set totalFormat(e){this.setLocalizableStringText("totalFormat",e)}get locTotalFormat(){return this.getLocalizableString("totalFormat")}get cellHint(){return this.getLocalizableStringText("cellHint","")}set cellHint(e){this.setLocalizableStringText("cellHint",e)}get locCellHint(){return this.getLocalizableString("cellHint")}get renderAs(){return this.getPropertyValue("renderAs")}set renderAs(e){this.setPropertyValue("renderAs",e),this.templateQuestion&&(this.templateQuestion.renderAs=e)}get totalMaximumFractionDigits(){return this.getPropertyValue("totalMaximumFractionDigits")}set totalMaximumFractionDigits(e){e<-1||e>20||this.setPropertyValue("totalMaximumFractionDigits",e)}get totalMinimumFractionDigits(){return this.getPropertyValue("totalMinimumFractionDigits")}set totalMinimumFractionDigits(e){e<-1||e>20||this.setPropertyValue("totalMinimumFractionDigits",e)}get totalDisplayStyle(){return this.getPropertyValue("totalDisplayStyle")}set totalDisplayStyle(e){this.setPropertyValue("totalDisplayStyle",e)}get totalAlignment(){return this.getPropertyValue("totalAlignment")}set totalAlignment(e){this.setPropertyValue("totalAlignment",e)}get totalCurrency(){return this.getPropertyValue("totalCurrency")}set totalCurrency(e){al().indexOf(e)<0||this.setPropertyValue("totalCurrency",e)}get minWidth(){return this.getPropertyValue("minWidth","")}set minWidth(e){this.setPropertyValue("minWidth",e)}get width(){return this.templateQuestion.width}set width(e){this.templateQuestion.width=e}get colCount(){return this.getPropertyValue("colCount")}set colCount(e){e<-1||e>4||this.setPropertyValue("colCount",e)}getLocale(){return this.colOwner?this.colOwner.getLocale():""}getMarkdownHtml(e,t,s){return this.colOwner?this.colOwner.getMarkdownHtml(e,t,s):void 0}getRenderer(e){return this.colOwner?this.colOwner.getRenderer(e):null}getRendererContext(e){return this.colOwner?this.colOwner.getRendererContext(e):e}getProcessedText(e){return this.colOwner?this.colOwner.getProcessedText(e):e}createCellQuestion(e){var t=this.calcCellQuestionType(e),s=this.createNewQuestion(t);return this.callOnCellQuestionUpdate(s,e),s}startLoadingFromJson(e){super.startLoadingFromJson(e),e&&!e.cellType&&e.choices&&(e.cellType=this.colOwner.getCellType())}updateCellQuestion(e,t,s=null){this.setQuestionProperties(e,s)}callOnCellQuestionUpdate(e,t){var s=e.getType(),i=L1[s];i&&i.onCellQuestionUpdate&&i.onCellQuestionUpdate(e,this,this.colOwner,t)}defaultCellTypeChanged(){this.updateTemplateQuestion()}calcCellQuestionType(e){let t=this.getDefaultCellQuestionType();return e&&this.colOwner&&(t=this.colOwner.getCustomCellType(this,e,t)),t}getDefaultCellQuestionType(e){return e||(e=this.cellType),e!=="default"?e:this.colOwner?this.colOwner.getCellType():D.matrix.defaultCellType}updateTemplateQuestion(e,t,s){const i=this.getDefaultCellQuestionType(e),r=this.templateQuestion?this.templateQuestion.getType():"";i!==r&&(this.templateQuestion&&this.removeProperties(r),this.templateQuestionValue=this.createNewQuestion(i),this.templateQuestion.locOwner=this,this.addProperties(i),t&&(this.name=t),s?this.title=s:this.templateQuestion.locTitle.strChanged(),D.serialization.matrixDropdownColumnSerializeTitle&&(this.templateQuestion.locTitle.serializeCallBackText=!0),this.templateQuestion.onPropertyChanged.add((a,o)=>{this.propertyValueChanged(o.name,o.oldValue,o.newValue,o.arrayChanges,o.target)}),this.templateQuestion.onNestedPropertyChanged.add((a,o)=>{this.colOwner&&!this.isLoadingFromJson&&this.colOwner.onColumnNestedPropertyChanged(this,o.name,o.nestedName,o.newValue)}),this.templateQuestion.onItemValuePropertyChanged.add((a,o)=>{this.doItemValuePropertyChanged(o.propertyName,o.obj,o.name,o.newValue,o.oldValue)}),this.templateQuestion.isContentElement=!0,this.isLoadingFromJson||(this.templateQuestion.onGetSurvey=()=>this.getSurvey()),this.templateQuestion.locTitle.strChanged())}createNewQuestion(e){var t=B.createClass(e);return t||(t=B.createClass("text")),t.loadingOwner=this,t.isEditableTemplateElement=!0,t.autoOtherMode=this.isShowInMultipleColumns,this.setQuestionProperties(t),this.setParentQuestionToTemplate(t),t}setParentQuestionToTemplate(e){this.colOwner&&this.colOwner.isQuestion&&e.setParentQuestion(this.colOwner)}setQuestionProperties(e,t=null){if(this.templateQuestion){var s=new rt().toJsonObject(this.templateQuestion,!0);if(t&&t(s),s.type=e.getType(),this.cellType==="default"&&this.colOwner&&this.colOwner.hasChoices()&&delete s.choices,delete s.itemComponent,this.jsonObj&&s.type==="rating"&&this.isLoadingFromJson&&Object.keys(this.jsonObj).forEach(i=>{s[i]=this.jsonObj[i]}),s.choicesOrder==="random"){s.choicesOrder="none";const i=this.templateQuestion.visibleChoices;Array.isArray(i)&&(s.choices=i)}new rt().toObject(s,e),e.isContentElement=this.templateQuestion.isContentElement,this.previousChoicesId=void 0,e.loadedChoicesFromServerCallback=()=>{if(!this.isShowInMultipleColumns||this.previousChoicesId&&this.previousChoicesId!==e.id)return;this.previousChoicesId=e.id;const i=e.visibleChoices;this.templateQuestion.choices=i,this.propertyValueChanged("choices",i,i)}}}propertyValueChanged(e,t,s,i,r){if(super.propertyValueChanged(e,t,s,i,r),e==="isRequired"&&this.updateIsRenderedRequired(s),!(!this.colOwner||this.isLoadingFromJson)){if(this.isShowInMultipleColumns){if(e==="choicesOrder")return;["visibleChoices","choices"].indexOf(e)>-1&&this.colOwner.onShowInMultipleColumnsChanged(this)}B.hasOriginalProperty(this,e)&&this.colOwner.onColumnPropertyChanged(this,e,s)}}doItemValuePropertyChanged(e,t,s,i,r){B.hasOriginalProperty(t,s)&&this.colOwner!=null&&!this.isLoadingFromJson&&this.colOwner.onColumnItemValuePropertyChanged(this,e,t,s,i,r)}doShowInMultipleColumnsChanged(){this.colOwner!=null&&this.colOwner.onShowInMultipleColumnsChanged(this),this.templateQuestion&&(this.templateQuestion.autoOtherMode=this.isShowInMultipleColumns)}doColumnVisibilityChanged(){this.colOwner!=null&&!this.isDesignMode&&this.colOwner.onColumnVisibilityChanged(this)}getProperties(e){return B.getDynamicPropertiesByObj(this,e)}removeProperties(e){for(var t=this.getProperties(e),s=0;s<t.length;s++){var i=t[s];delete this[i.name],i.serializationProperty&&delete this[i.serializationProperty]}}addProperties(e){const t=this.getProperties(e);B.addDynamicPropertiesIntoObj(this,this.templateQuestion,t)}}B.addClass("matrixdropdowncolumn",[{name:"!name",isUnique:!0},{name:"title",serializationProperty:"locTitle",dependsOn:"name",onPropertyEditorUpdate:function(n,e){n&&e&&(e.placeholder=n.locTitle.getPlaceholder())}},{name:"cellHint",serializationProperty:"locCellHint",visible:!1},{name:"cellType",default:"default",choices:()=>{var n=ll.getColumnTypes();return n.splice(0,0,"default"),n}},{name:"colCount",default:-1,choices:[-1,0,1,2,3,4]},{name:"isRequired:boolean",defaultFunc:n=>{const e=n?.templateQuestion;return e&&B.findProperty(e.getType(),"isRequired").getDefaultValue(e)||!1}},"isUnique:boolean",{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText"},"readOnly:boolean",{name:"minWidth",onPropertyEditorUpdate:function(n,e){n&&e&&(e.value=n.minWidth)}},"width",{name:"visible:switch",default:!0,overridingProperty:"visibleIf"},"visibleIf:condition","enableIf:condition","requiredIf:condition","resetValueIf:condition","setValueIf:condition","setValueExpression:expression",{name:"showInMultipleColumns:boolean",dependsOn:"cellType",visibleIf:n=>n.isSupportMultipleColumns},{name:"validators:validators",baseClassName:"surveyvalidator",classNamePart:"validator"},{name:"totalType",visibleIf:n=>!n.isShowInMultipleColumns,default:"none",choices:["none","sum","count","min","max","avg"]},{name:"totalExpression:expression",visibleIf:n=>!n.isShowInMultipleColumns},{name:"totalFormat",serializationProperty:"locTotalFormat",visibleIf:n=>n.hasTotal},{name:"totalDisplayStyle",visibleIf:n=>n.hasTotal,default:"none",choices:["none","decimal","currency","percent"]},{name:"totalAlignment",visibleIf:n=>n.hasTotal,default:"auto",choices:["auto","left","center","right"]},{name:"totalCurrency",visibleIf:n=>n.hasTotal,choices:()=>al(),default:"USD"},{name:"totalMaximumFractionDigits:number",default:-1,visibleIf:n=>n.hasTotal},{name:"totalMinimumFractionDigits:number",default:-1,visibleIf:n=>n.hasTotal},{name:"renderAs",default:"default",visible:!1},{name:"defaultDisplayValue",serializationProperty:"locDefaultDisplayValue"}],function(){return new ll("")});function A1(n,e,t){return n+(e?"-error":"")+(t?"-detail":"")}class Ss{constructor(){this.minWidth="",this.width="",this.colSpans=1,this.isActionsCell=!1,this.isErrorsCell=!1,this.isDragHandlerCell=!1,this.isDetailRowCell=!1,this.classNameValue="",this.idValue=Ss.counter++}get requiredMark(){return this.column&&this.column.isRenderedRequired?this.column.requiredMark:void 0}get hasQuestion(){return!!this.question&&!this.isErrorsCell}get hasTitle(){return!!this.locTitle}get hasPanel(){return!!this.panel}get id(){let e=this.question?this.question.id:this.idValue.toString();return this.isChoice&&(e+="-"+(Number.isInteger(this.choiceIndex)?"index"+this.choiceIndex.toString():this.item.id)),A1(e,this.isErrorsCell,this.isDetailRowCell)}get item(){return this.itemValue}set item(e){this.itemValue=e,e&&(e.hideCaption=!0)}get isChoice(){return!!this.item}get isItemChoice(){return this.isChoice&&!this.isOtherChoice}get choiceValue(){return this.isChoice?this.item.value:null}get isCheckbox(){return this.isItemChoice&&this.question.isDescendantOf("checkbox")}get isRadio(){return this.isItemChoice&&this.question.isDescendantOf("radiogroup")}get isFirstChoice(){return this.choiceIndex===0}set className(e){this.classNameValue=e}get className(){const e=new j().append(this.classNameValue);return this.hasQuestion&&e.append(this.question.cssClasses.hasError,this.question.errors.length>0).append(this.question.cssClasses.answered,this.question.isAnswered),e.toString()}get cellQuestionWrapperClassName(){return this.cell.getQuestionWrapperClassName(this.matrix.cssClasses.cellQuestionWrapper)}get isVisible(){var e;return!this.hasQuestion&&!this.isErrorsCell||!(!((e=this.matrix)===null||e===void 0)&&e.isMobile)||this.question.isVisible}get showResponsiveTitle(){var e;return this.hasQuestion&&((e=this.matrix)===null||e===void 0?void 0:e.isMobile)}get responsiveTitleCss(){return new j().append(this.matrix.cssClasses.cellResponsiveTitle).toString()}get responsiveLocTitle(){return this.cell.column.locTitle}get headers(){if(this.cell&&this.cell.column){if(this.matrix.IsMultiplyColumn(this.cell.column))return this.item?this.item.locText.renderedHtml:"";let e=this.cell.column.cellHint;return e?e.trim()===""?"":this.cell.column.locCellHint.renderedHtml:this.hasQuestion&&this.question.isVisible&&this.question.title?this.question.title:this.cell.column.title}return this.hasQuestion&&this.question.isVisible?this.question.locTitle.renderedHtml:this.hasTitle&&this.locTitle.renderedHtml||""}getTitle(){return this.matrix&&this.matrix.showHeader?this.headers:""}calculateFinalClassName(e){const t=this.cell.question.cssClasses,s=new j().append(t.itemValue,!!t).append(t.asCell,!!t);return s.append(e.cell,s.isEmpty()&&!!e).append(e.choiceCell,this.isChoice).toString()}focusIn(){this.question&&this.question.focusIn()}}Ss.counter=1;class Nr extends de{constructor(e,t=!1){super(),this.cssClasses=e,this.isDetailRow=t,this.hasEndActions=!1,this.isErrorsRow=!1,this.cells=[]}get id(){var e;return A1(((e=this.row)===null||e===void 0?void 0:e.id)||this.uniqueId.toString(),this.isErrorsRow,this.isDetailRow)}get dropTargetId(){var e;return(e=this.row)===null||e===void 0?void 0:e.id}get attributes(){return this.row?{"data-sv-drop-target-matrix-row":this.row.id}:{}}get className(){var e,t;return new j().append(this.cssClasses.row).append(this.cssClasses.detailRow,this.isDetailRow).append(this.cssClasses.rowHasPanel,(e=this.row)===null||e===void 0?void 0:e.hasPanel).append(this.cssClasses.expandedRow,((t=this.row)===null||t===void 0?void 0:t.isDetailPanelShowing)&&!this.isDetailRow).append(this.cssClasses.rowHasEndActions,this.hasEndActions).append(this.cssClasses.ghostRow,this.isGhostRow).append(this.cssClasses.rowAdditional,this.isAdditionalClasses).toString()}setRootElement(e){this.rootElement=e}getRootElement(){return this.rootElement}focusCell(e){if(this.rootElement){const t=`:scope td:nth-of-type(${e+1}) input, :scope td:nth-of-type(${e+1}) button`,s=this.rootElement.querySelectorAll(t)[0];s&&s.focus()}}}I([R({defaultValue:!1})],Nr.prototype,"isGhostRow",void 0),I([R({defaultValue:!1})],Nr.prototype,"isAdditionalClasses",void 0),I([R({defaultValue:!0})],Nr.prototype,"visible",void 0);class n_ extends Nr{constructor(e){super(e),this.isErrorsRow=!0}get attributes(){return{}}get className(){return new j().append(this.cssClasses.row).append(this.cssClasses.errorRow).toString()}onAfterCreated(){const e=()=>{this.visible=this.cells.some(t=>t.question&&t.question.hasVisibleErrors)};this.cells.forEach(t=>{t.question&&t.question.registerFunctionOnPropertyValueChanged("hasVisibleErrors",e)}),e()}}class a_ extends Nr{constructor(e,t){super(e),this.customId=t,this.isErrorsRow=!1}get attributes(){return{}}get dropTargetId(){return this.customId}get className(){return new j().append(this.cssClasses.row).append(this.cssClasses.rowEmpty).toString()}}class ul extends de{getIsAnimationAllowed(){return super.getIsAnimationAllowed()&&this.matrix.animationAllowed}getRenderedRowsAnimationOptions(){const e=s=>{s.querySelectorAll(":scope > td > *").forEach(i=>{ci(i)})},t=s=>{s.querySelectorAll(":scope > td > *").forEach(i=>{Vs(i)})};return{isAnimationEnabled:()=>this.animationAllowed,getRerenderEvent:()=>this.onElementRerendered,getAnimatedElement(s){return s.getRootElement()},getLeaveOptions:()=>({cssClass:this.cssClasses.rowLeave,onBeforeRunAnimation:e,onAfterRunAnimation:t}),getEnterOptions:(s,i)=>({cssClass:this.cssClasses.rowEnter,onBeforeRunAnimation:e,onAfterRunAnimation:t}),getKey:s=>s.id}}updateRenderedRows(){this.renderedRows=this.rows}get renderedRows(){return this._renderedRows}set renderedRows(e){this.renderedRowsAnimation.sync(e)}get wrapperDropTargetId(){var e;return(e=this.renderedRows[this.renderedRows.length-1])===null||e===void 0?void 0:e.dropTargetId}constructor(e){super(),this.matrix=e,this._renderedRows=[],this.renderedRowsAnimation=new Xi(this.getRenderedRowsAnimationOptions(),t=>{this._renderedRows=t},()=>this._renderedRows),this.hasActionCellInRowsValues={},this.build()}get showTable(){return this.getPropertyValue("showTable",!0)}get showHeader(){return this.getPropertyValue("showHeader")}get showAddRow(){return this.getPropertyValue("showAddRow",!1)}get showAddRowOnTop(){return this.getPropertyValue("showAddRowOnTop",!1)}get showAddRowOnBottom(){return this.getPropertyValue("showAddRowOnBottom",!1)}get showFooter(){return this.matrix.hasFooter&&this.matrix.isColumnLayoutHorizontal}get hasFooter(){return!!this.footerRow}get hasRemoveRows(){return this.hasRemoveRowsValue}isRequireReset(){return this.isRequireResetValue||this.hasRemoveRows!=this.matrix.canRemoveRows||!this.matrix.isColumnLayoutHorizontal}requireReset(){this.isRequireResetValue=!0}get headerRow(){return this.headerRowValue}get footerRow(){return this.footerRowValue}get isRowsDragAndDrop(){return this.matrix.isRowsDragAndDrop&&this.matrix.isColumnLayoutHorizontal}get showCellErrorsTop(){return this.matrix.getErrorLocation()==="top"}get showCellErrorsBottom(){return this.matrix.getErrorLocation()==="bottom"}build(){this.hasRemoveRowsValue=this.matrix.canRemoveRows,this.matrix.visibleRows,this.cssClasses=this.matrix.cssClasses,this.buildRowsActions(),this.buildHeader(),this.buildRows(),this.buildFooter(),this.updateShowTableAndAddRow()}updateShowTableAndAddRow(){const e=this.rows.length>0||this.matrix.isDesignMode||!this.matrix.getShowColumnsIfEmpty();this.setPropertyValue("showTable",e);const t=this.matrix.isDesignMode,s=!t&&this.matrix.canAddRow&&e;let i=s,r=s;i&&(this.matrix.getAddRowLocation()==="default"?i=!this.matrix.isColumnLayoutHorizontal:i=this.matrix.getAddRowLocation()!=="bottom"),r&&this.matrix.getAddRowLocation()!=="topBottom"&&(r=!i),this.setPropertyValue("showAddRow",!t&&this.matrix.canAddRow),this.setPropertyValue("showAddRowOnTop",i),this.setPropertyValue("showAddRowOnBottom",r)}onAddedRow(e,t){if(this.getRenderedDataRowCount()>=this.matrix.visibleRows.length)return;let s=this.getRenderedRowIndexByIndex(t);this.rowsActions.splice(t,0,this.buildRowActions(e)),this.addHorizontalRow(this.rows,e,s),this.updateShowTableAndAddRow()}getRenderedRowIndexByIndex(e){let t=0,s=0;for(var i=0;i<this.rows.length;i++){if(s===e){(this.rows[i].isErrorsRow||this.rows[i].isDetailRow)&&(t++,i+1<this.rows.length&&this.rows[i+1].isDetailRow&&t++);break}t++,!this.rows[i].isErrorsRow&&!this.rows[i].isDetailRow&&s++}return s<e?this.rows.length:t}getRenderedDataRowCount(){for(var e=0,t=0;t<this.rows.length;t++)!this.rows[t].isErrorsRow&&!this.rows[t].isDetailRow&&e++;return e}onRemovedRow(e){var t=this.getRenderedRowIndex(e);if(!(t<0)){this.rowsActions.splice(t,1);var s=1;t<this.rows.length-1&&this.showCellErrorsBottom&&this.rows[t+1].isErrorsRow&&s++,t<this.rows.length-1&&(this.rows[t+1].isDetailRow||this.showCellErrorsBottom&&t+1<this.rows.length-1&&this.rows[t+2].isDetailRow)&&s++,t>0&&this.showCellErrorsTop&&this.rows[t-1].isErrorsRow&&(t--,s++),this.rows.splice(t,s),this.updateShowTableAndAddRow()}}onDetailPanelChangeVisibility(e,t){const s=this.getRenderedRowIndex(e);if(s<0)return;let i=s;this.showCellErrorsBottom&&i++;var r=i<this.rows.length-1&&this.rows[i+1].isDetailRow?i+1:-1;if(!(t&&r>-1||!t&&r<0))if(t){var a=this.createDetailPanelRow(e,this.rows[s]);this.rows.splice(i+1,0,a)}else this.rows.splice(r,1)}focusActionCell(e,t){let s=this.rows[this.rows.length-1];if(this.matrix.isColumnLayoutHorizontal){const i=this.getRenderedRowIndex(e);s=this.rows[i]}s?.focusCell(t)}getRenderedRowIndex(e){for(var t=0;t<this.rows.length;t++)if(this.rows[t].row==e)return t;return-1}buildRowsActions(){this.rowsActions=[];for(var e=this.matrix.visibleRows,t=0;t<e.length;t++)this.rowsActions.push(this.buildRowActions(e[t]))}createRenderedRow(e,t=!1){return new Nr(e,t)}createErrorRenderedRow(e){return new n_(e)}createEmptyRenderedRow(e){return new a_(e,this.matrix.id)}buildHeader(){var e=this.matrix.isColumnLayoutHorizontal&&this.matrix.showHeader,t=e||this.matrix.hasRowText&&!this.matrix.isColumnLayoutHorizontal;if(this.setPropertyValue("showHeader",t),!!t){if(this.headerRowValue=this.createRenderedRow(this.cssClasses),this.isRowsDragAndDrop&&this.headerRow.cells.push(this.createHeaderCell(null,"action",this.cssClasses.actionsCellDrag)),this.hasActionCellInRows("start")&&this.headerRow.cells.push(this.createHeaderCell(null,"action")),this.matrix.hasRowText&&this.matrix.showHeader&&this.headerRow.cells.push(this.createHeaderCell(null)),this.matrix.isColumnLayoutHorizontal)for(var s=0;s<this.matrix.columns.length;s++){var i=this.matrix.columns[s];i.isColumnVisible&&(this.matrix.IsMultiplyColumn(i)?this.createMutlipleColumnsHeader(i):this.headerRow.cells.push(this.createHeaderCell(i)))}else{for(var r=this.matrix.visibleRows,s=0;s<r.length;s++){const o=this.createTextCell(r[s].locText);this.setHeaderCellCssClasses(o),o.row=r[s],this.headerRow.cells.push(o)}if(this.matrix.hasFooter){const a=this.createTextCell(this.matrix.getFooterText());this.setHeaderCellCssClasses(a),this.headerRow.cells.push(a)}}this.hasActionCellInRows("end")&&this.headerRow.cells.push(this.createHeaderCell(null,"action"))}}buildFooter(){if(this.showFooter){if(this.footerRowValue=this.createRenderedRow(this.cssClasses),this.isRowsDragAndDrop&&this.footerRow.cells.push(this.createHeaderCell(null)),this.hasActionCellInRows("start")&&this.footerRow.cells.push(this.createHeaderCell(null,"action")),this.matrix.hasRowText){const r=this.createTextCell(this.matrix.getFooterText());r.className=new j().append(r.className).append(this.cssClasses.footerTotalCell).toString(),this.footerRow.cells.push(r)}for(var e=this.matrix.visibleTotalRow.cells,t=0;t<e.length;t++){var s=e[t];if(s.column.isColumnVisible)if(this.matrix.IsMultiplyColumn(s.column))this.createMutlipleColumnsFooter(this.footerRow,s);else{var i=this.createEditCell(s);s.column&&this.setCellWidth(s.column,i),i.className=new j().append(i.className).append(this.cssClasses.footerCell).toString(),this.footerRow.cells.push(i)}}this.hasActionCellInRows("end")&&this.footerRow.cells.push(this.createHeaderCell(null,"action"))}}buildRows(){this.blockAnimations();var e=this.matrix.isColumnLayoutHorizontal?this.buildHorizontalRows():this.buildVerticalRows();this.rows=e,this.releaseAnimations()}hasActionCellInRows(e){return this.hasActionCellInRowsValues[e]===void 0&&(this.hasActionCellInRowsValues[e]=this.hasActionsCellInLocaltion(e)),this.hasActionCellInRowsValues[e]}hasActionsCellInLocaltion(e){return e=="end"&&this.hasRemoveRows?!0:this.matrix.visibleRows.some((t,s)=>!this.isValueEmpty(this.getRowActions(s,e)))}canRemoveRow(e){return this.matrix.canRemoveRow(e)}buildHorizontalRows(){var e=this.matrix.visibleRows,t=[];if(e.length==0&&this.matrix.allowRowReorder&&this.matrix.allowRowDragIn){const i=this.createEmptyRow(),r=this.createTextCell(this.matrix.locNoRowsText);r.colSpans=this.headerRow&&this.headerRow.cells.length||1,i.cells.push(r),t.push(i)}for(var s=0;s<e.length;s++)this.addHorizontalRow(t,e[s]);return t}addHorizontalRow(e,t,s=-1){const i=this.createHorizontalRow(t),r=this.createErrorRow(i);if(i.row=t,s<0&&(s=e.length),this.matrix.isMobile){const a=[];for(let o=0;o<i.cells.length;o++)this.showCellErrorsTop&&!r.cells[o].isEmpty&&a.push(r.cells[o]),a.push(i.cells[o]),this.showCellErrorsBottom&&!r.cells[o].isEmpty&&a.push(r.cells[o]);i.cells=a,e.splice(s,0,i)}else e.splice(s,0,...this.showCellErrorsTop?[r,i]:[i,r]),s++;t.isDetailPanelShowing&&e.splice(s+1,0,this.createDetailPanelRow(t,i))}getRowDragCell(e){const t=new Ss,s=this.matrix.lockedRowCount;return t.isDragHandlerCell=s<1||e>=s,t.isEmpty=!t.isDragHandlerCell,t.className=this.getActionsCellClassName(t),t.row=this.matrix.visibleRows[e],t}getActionsCellClassName(e=null){const t=new j().append(this.cssClasses.actionsCell).append(this.cssClasses.actionsCellDrag,e?.isDragHandlerCell).append(this.cssClasses.detailRowCell,e?.isDetailRowCell).append(this.cssClasses.verticalCell,!this.matrix.isColumnLayoutHorizontal);if(e.isActionsCell){const s=e.item.value.actions;this.cssClasses.actionsCellPrefix&&s.forEach(i=>{t.append(this.cssClasses.actionsCellPrefix+"--"+i.id)})}return t.toString()}getRowActionsCell(e,t,s=!1){const i=this.getRowActions(e,t);if(!this.isValueEmpty(i)){const r=new Ss,a=this.matrix.allowAdaptiveActions?new Wo:new Vt;this.matrix.survey&&this.matrix.survey.getCss().actionBar&&(a.cssClasses=this.matrix.survey.getCss().actionBar),a.setItems(i);const o=new fe(a);return r.item=o,r.isActionsCell=!0,r.isDragHandlerCell=!1,r.isDetailRowCell=s,r.className=this.getActionsCellClassName(r),r.row=this.matrix.visibleRows[e],r}return null}getRowActions(e,t){var s=this.rowsActions[e];return Array.isArray(s)?s.filter(i=>(i.location||(i.location="start"),i.location===t)):[]}buildRowActions(e){var t=[];return this.setDefaultRowActions(e,t),this.matrix.survey&&(t=this.matrix.survey.getUpdatedMatrixRowActions(this.matrix,e,t)),t}get showRemoveButtonAsIcon(){return D.matrix.renderRemoveAsIcon&&this.matrix.survey&&this.matrix.survey.css.root==="sd-root-modern"}setDefaultRowActions(e,t){const s=this.matrix;this.hasRemoveRows&&this.canRemoveRow(e)&&(this.showRemoveButtonAsIcon?t.push(new xe({id:"remove-row",iconName:"icon-delete-24x24",iconSize:"auto",component:"sv-action-bar-item",innerCss:new j().append(this.matrix.cssClasses.button).append(this.matrix.cssClasses.buttonRemove).toString(),location:"end",showTitle:!1,title:s.removeRowText,enabled:!s.isInputReadOnly,data:{row:e,question:s},action:()=>{s.removeRowUI(e)}})):t.push(new xe({id:"remove-row",location:"end",enabled:!this.matrix.isInputReadOnly,component:"sv-matrix-remove-button",data:{row:e,question:this.matrix}}))),e.hasPanel&&(this.matrix.isMobile?t.unshift(new xe({id:"show-detail-mobile",title:new Ue(()=>e.isDetailPanelShowing?this.matrix.getLocalizationString("hideDetails"):this.matrix.getLocalizationString("showDetails")),showTitle:!0,location:"end",action:i=>{e.showHideDetailPanelClick()}})):t.push(new xe({id:"show-detail",title:new Ue(()=>e.isDetailPanelShowing?this.matrix.getLocalizationString("hideDetails"):this.matrix.getLocalizationString("showDetails")),showTitle:!1,location:"start",component:"sv-matrix-detail-button",data:{row:e,question:this.matrix}})))}createErrorRow(e){const t=this.createErrorRenderedRow(this.cssClasses);for(let s=0;s<e.cells.length;s++){const i=e.cells[s];i.hasQuestion?this.matrix.IsMultiplyColumn(i.cell.column)?i.isFirstChoice?t.cells.push(this.createErrorCell(i.cell)):t.cells.push(this.createEmptyCell(!0)):t.cells.push(this.createErrorCell(i.cell)):t.cells.push(this.createEmptyCell(!0))}return t.onAfterCreated(),t}createEmptyRow(){return this.createEmptyRenderedRow(this.cssClasses)}createHorizontalRow(e){var t=this.createRenderedRow(this.cssClasses);if(this.isRowsDragAndDrop){var s=this.matrix.visibleRows.indexOf(e);t.cells.push(this.getRowDragCell(s))}if(this.addRowActionsCell(e,t,"start"),this.matrix.hasRowText){var i=this.createTextCell(e.locText);i.row=e,t.cells.push(i),this.setCellWidth(null,i),i.className=new j().append(i.className).append(this.cssClasses.rowTextCell).append(this.cssClasses.columnTitleCell,!this.matrix.isColumnLayoutHorizontal).append(this.cssClasses.detailRowText,e.hasPanel).toString()}for(var r=0;r<e.cells.length;r++){let a=e.cells[r];if(a.column.isColumnVisible)if(this.matrix.IsMultiplyColumn(a.column))this.createMutlipleEditCells(t,a);else{a.column.isShowInMultipleColumns&&a.question.visibleChoices.map(l=>l.hideCaption=!1);var i=this.createEditCell(a);t.cells.push(i),this.setCellWidth(a.column,i)}}return this.addRowActionsCell(e,t,"end"),t}addRowActionsCell(e,t,s){var i=this.matrix.visibleRows.indexOf(e);if(this.hasActionCellInRows(s)){const a=this.getRowActionsCell(i,s,t.isDetailRow);if(a)t.cells.push(a),t.hasEndActions=!0;else{var r=new Ss;r.isEmpty=!0,r.isDetailRowCell=t.isDetailRow,t.cells.push(r)}}}createDetailPanelRow(e,t){const s=this.matrix.isDesignMode;var i=this.createRenderedRow(this.cssClasses,!0);i.row=e;var r=new Ss;this.matrix.hasRowText&&(r.colSpans=2),r.isEmpty=!0,s||i.cells.push(r);var a=null;this.hasActionCellInRows("end")&&(a=new Ss,a.isEmpty=!0);var o=new Ss;return o.panel=e.detailPanel,o.colSpans=t.cells.length-(s?0:r.colSpans)-(a?a.colSpans:0),o.className=this.cssClasses.detailPanelCell,i.cells.push(o),a&&(this.matrix.isMobile?this.addRowActionsCell(e,i,"end"):i.cells.push(a)),typeof this.matrix.onCreateDetailPanelRenderedRowCallback=="function"&&this.matrix.onCreateDetailPanelRenderedRowCallback(i),i}buildVerticalRows(){for(var e=this.matrix.columns,t=[],s=0;s<e.length;s++){var i=e[s];if(i.isColumnVisible)if(this.matrix.IsMultiplyColumn(i))this.createMutlipleVerticalRows(t,i,s);else{const r=this.createVerticalRow(i,s),a=this.createErrorRow(r);this.showCellErrorsTop?(t.push(a),t.push(r)):(t.push(r),t.push(a))}}return this.hasActionCellInRows("end")&&t.push(this.createEndVerticalActionRow()),t}createMutlipleVerticalRows(e,t,s){var i=this.getMultipleColumnChoices(t);if(i)for(var r=0;r<i.length;r++){const a=this.createVerticalRow(t,s,i[r],r),o=this.createErrorRow(a);this.showCellErrorsTop?(e.push(o),e.push(a)):(e.push(a),e.push(o))}}createVerticalRow(e,t,s=null,i=-1){var r=this.createRenderedRow(this.cssClasses);if(this.matrix.showHeader){var a=s?s.locText:e.locTitle,o=this.createTextCell(a);o.column=e,o.className=new j().append(o.className).append(this.cssClasses.rowTextCell).append(this.cssClasses.columnTitleCell).toString(),r.cells.push(o)}for(var l=this.matrix.visibleRows,u=0;u<l.length;u++){var d=s,h=i>=0?i:u,f=l[u].cells[t],C=s?f.question.visibleChoices:void 0;C&&h<C.length&&(d=C[h]);var b=this.createEditCell(f,d);b.item=d,b.choiceIndex=h,r.cells.push(b)}return this.matrix.hasTotal&&r.cells.push(this.createEditCell(this.matrix.visibleTotalRow.cells[t])),r}createEndVerticalActionRow(){var e=this.createRenderedRow(this.cssClasses);this.matrix.showHeader&&e.cells.push(this.createEmptyCell());for(var t=this.matrix.visibleRows,s=0;s<t.length;s++)e.cells.push(this.getRowActionsCell(s,"end"));return this.matrix.hasTotal&&e.cells.push(this.createEmptyCell()),e}createMutlipleEditCells(e,t,s=!1){var i=s?this.getMultipleColumnChoices(t.column):t.question.visibleChoices;if(i)for(var r=0;r<i.length;r++){var a=this.createEditCell(t,s?void 0:i[r]);s||(this.setItemCellCssClasses(a),a.choiceIndex=r),e.cells.push(a)}}setItemCellCssClasses(e){e.className=new j().append(this.cssClasses.cell).append(this.cssClasses.itemCell).append(this.cssClasses.radioCell,e.isRadio).append(this.cssClasses.checkboxCell,e.isCheckbox).toString()}createEditCell(e,t=void 0){var s=new Ss;return s.cell=e,s.row=e.row,s.column=e.column,s.question=e.question,s.matrix=this.matrix,s.item=t,s.isOtherChoice=!!t&&!!e.question&&e.question.otherItem===t,s.className=s.calculateFinalClassName(this.cssClasses),s}createErrorCell(e,t=void 0){var s=new Ss;return s.question=e.question,s.row=e.row,s.matrix=this.matrix,s.isErrorsCell=!0,s.className=new j().append(this.cssClasses.cell).append(this.cssClasses.errorsCell).append(this.cssClasses.errorsCellTop,this.showCellErrorsTop).append(this.cssClasses.errorsCellBottom,this.showCellErrorsBottom).toString(),s}createMutlipleColumnsFooter(e,t){this.createMutlipleEditCells(e,t,!0)}createMutlipleColumnsHeader(e){var t=this.getMultipleColumnChoices(e);if(t)for(var s=0;s<t.length;s++){var i=this.createTextCell(t[s].locText);this.setHeaderCell(e,i),this.setHeaderCellCssClasses(i),this.headerRow.cells.push(i)}}getMultipleColumnChoices(e){var t=e.templateQuestion.choices;return t&&Array.isArray(t)&&t.length==0?[].concat(this.matrix.choices,e.getVisibleMultipleChoices()):(t=e.getVisibleMultipleChoices(),!t||!Array.isArray(t)?null:t)}setHeaderCellCssClasses(e,t,s){e.className=new j().append(this.cssClasses.headerCell).append(this.cssClasses.columnTitleCell,this.matrix.isColumnLayoutHorizontal).append(this.cssClasses.emptyCell,!!e.isEmpty).append(this.cssClasses.cell+"--"+t,!!t).append(s,!!s).toString()}createHeaderCell(e,t=null,s){let i=e?this.createTextCell(e.locTitle):this.createEmptyCell();return i.column=e,this.setHeaderCell(e,i),t||(t=e&&e.cellType!=="default"?e.cellType:this.matrix.cellType),this.setHeaderCellCssClasses(i,t,s),i}setHeaderCell(e,t){this.setCellWidth(e,t)}setCellWidth(e,t){t.minWidth=e!=null?this.matrix.getColumnWidth(e):this.matrix.getRowTitleWidth(),t.width=e!=null?e.width:this.matrix.getRowTitleWidth()}createTextCell(e){var t=new Ss;return t.locTitle=e,this.cssClasses.cell&&(t.className=this.cssClasses.cell),t}createEmptyCell(e=!1){const t=this.createTextCell(null);return t.isEmpty=!0,t.className=new j().append(this.cssClasses.cell).append(this.cssClasses.emptyCell).append(this.cssClasses.errorsCell,e).toString(),t}}I([Ft({onPush:(n,e,t)=>{t.updateRenderedRows()},onRemove:(n,e,t)=>{t.updateRenderedRows()}})],ul.prototype,"rows",void 0),I([Ft()],ul.prototype,"_renderedRows",void 0);class D1{constructor(e,t,s){this.column=e,this.row=t,this.data=s,this.questionValue=this.createQuestion(e,t,s),this.questionValue.updateCustomWidget(),this.updateCellQuestionTitleDueToAccessebility(t)}updateCellQuestionTitleDueToAccessebility(e){this.questionValue.locTitle.onGetTextCallback=t=>{const s=e?.getSurvey();if(!s||s.isSingleVisibleInput)return this.questionValue.title;const i=e.getAccessbilityText();return i?this.column.colOwner.getCellAriaLabel(e,this.column,i):this.questionValue.title}}locStrsChanged(){this.question.locStrsChanged()}createQuestion(e,t,s){const i=s.createQuestion(this.row,this.column);return i.onFirstRendering(),i.readOnlyCallback=()=>!this.row.isRowEnabled(),i.validateValueCallback=function(){return s.validateCell(t,e.name,t.value)},it.getProperties(e.getType()).forEach(r=>{let a=r.name;e[a]!==void 0&&(i[a]=e[a])}),i}get question(){return this.questionValue}get value(){return this.question.value}set value(e){this.question.value=e}getQuestionWrapperClassName(e){return e}runCondition(e){this.question.runCondition(e)}}class o_ extends D1{constructor(e,t,s){super(e,t,s),this.column=e,this.row=t,this.data=s,this.updateCellQuestion()}createQuestion(e,t,s){var i=B.createClass("expression");return i.setSurveyImpl(t),i}locStrsChanged(){this.updateCellQuestion(),super.locStrsChanged()}updateCellQuestion(){this.question.locCalculation(),this.column.updateCellQuestion(this.question,null,function(e){delete e.defaultValue}),this.question.expression=this.getTotalExpression(),this.question.format=this.column.totalFormat,this.question.currency=this.column.totalCurrency,this.question.displayStyle=this.column.totalDisplayStyle,this.question.maximumFractionDigits=this.column.totalMaximumFractionDigits,this.question.minimumFractionDigits=this.column.totalMinimumFractionDigits,this.question.unlocCalculation(),this.question.runIfReadOnly=!0}getQuestionWrapperClassName(e){let t=super.getQuestionWrapperClassName(e);if(!t)return t;this.question.expression&&this.question.expression!="''"&&(t+=" "+e+"--expression");let s=this.column.totalAlignment;return s==="auto"&&this.column.cellType==="dropdown"&&(s="left"),t+" "+e+"--"+s}getTotalExpression(){if(this.column.totalExpression)return this.column.totalExpression;if(this.column.totalType=="none")return"''";var e=this.column.totalType+"InArray";return Ae.Instance.hasFunction(e)?e+"({matrix}, '"+this.column.name+"')":""}}class l_ extends S1{constructor(e){super(),this.row=e}getIndex(){return this.row.rowIndex-1}getQuestionData(){return this.row.data}getValue(e,t,s,i){if(e.length===0)return;const r=D.expressionVariables;if(e.length===1){const o=this.getRowValue(e[0].name);if(o!==void 0)return{isFound:!0,value:o};if(e[0].name===r.matrix){const l=this.row.data;return{isFound:!0,context:l.getValueGetterContext(),value:l.getFilteredData()}}}if(e.length>1&&e[0].name===r.totalRow){const o=this.row.data.visibleTotalRow;if(o)return e[0].name="row",o.getValueGetterContext().getValue(e,t,s,i)}const a=e[0].name===r.row;if(a||!t){a&&e.shift();let o=super.getValue(e,t,s,i);if(o&&o.isFound)return o;const l=this.row.getAllValues();return t&&(o=this.getValueFromBindedQuestions(e,l),o)?o:new ws(l).getValue(e,t,s,i)}}getRootObj(){return this.row.data}updateValueByItem(e,t){const s=this.row.getQuestionsByValueName(e,!0);s.length>0&&(t.isFound=!0,t.context=s[0].getValueGetterContext())}getRowValue(e){const t=D.expressionVariables;if(e=e.toLocaleLowerCase(),e===t.rowIndex.toLocaleLowerCase())return this.row.rowIndex;if(e===t.visibleRowIndex.toLocaleLowerCase())return this.getQuestionData().visibleRows.indexOf(this.row)+1;if([t.item,t.rowName.toLocaleLowerCase(),t.rowValue.toLocaleLowerCase()].indexOf(e)>-1)return this.row.rowName;if(e==t.rowTitle.toLocaleLowerCase())return this.row.rowTitle}}class ki{static getId(){return"srow_"+ki.idCounter++}constructor(e,t){this.data=e,this.isSettingValue=!1,this.detailPanelValue=null,this.visibleValue=!0,this.cells=[],this.visibleIndex=-1,this.isCreatingDetailPanel=!1,this.data=e,this.subscribeToChanges(t),this.textPreProcessor=new nl(this),this.showHideDetailPanelClick=()=>{if(this.getSurvey().isDesignMode)return!0;this.showHideDetailPanel()},this.idValue=ki.getId()}get id(){return this.idValue}get rowName(){return null}get rowTitle(){return this.rowName}get dataName(){return this.rowName}get text(){return this.rowName}getValueGetterContext(){return new l_(this)}isRowEnabled(){return!0}isRowHasEnabledCondition(){return!1}get isVisible(){return this.visible&&this.isItemVisible()}get visible(){return this.visibleValue}set visible(e){var t;this.visible!==e&&(this.visibleValue=e,(t=this.data)===null||t===void 0||t.onRowVisibilityChanged(this))}isItemVisible(){return!0}get value(){return this.getValueCore(!1)}set value(e){this.isSettingValue=!0,this.subscribeToChanges(e);for(var t=this.questions,s=0;s<t.length;s++){var i=t[s],r=this.getCellValue(e,i.getValueName()),a=i.comment,o=e?e[i.getValueName()+de.commentSuffix]:"";o==null&&(o=""),i.updateValueFromSurvey(r),(o||this.isTwoValueEquals(a,i.comment))&&i.updateCommentFromSurvey(o),i.onSurveyValueChanged(r)}this.isSettingValue=!1}get filteredValue(){return this.getValueCore(!0)}getValueCore(e){for(var t={},s=this.questions,i=0;i<s.length;i++){var r=s[i];r.isEmpty()||(t[r.getValueName()]=e?r.getFilteredValue():r.value),r.comment&&this.getSurvey()&&this.getSurvey().storeOthersAsComment&&(t[r.getValueName()+de.commentSuffix]=r.comment)}return t}get locText(){return null}getAccessbilityText(){return this.locText&&this.locText.renderedHtml}get hasPanel(){return this.data?this.data.hasDetailPanel(this):!1}get detailPanel(){return this.detailPanelValue}get detailPanelId(){return this.detailPanel?this.detailPanel.id:""}get isDetailPanelShowing(){return this.data?this.data.getIsDetailPanelShowing(this):!1}setIsDetailPanelShowing(e){!e&&this.detailPanel&&this.detailPanel.onHidingContent(),this.data&&this.data.setIsDetailPanelShowing(this,e),e&&this.detailPanel&&this.detailPanel.onFirstRendering(),this.onDetailPanelShowingChanged&&this.onDetailPanelShowingChanged()}showHideDetailPanel(){this.isDetailPanelShowing?this.hideDetailPanel():this.showDetailPanel()}showDetailPanel(){this.ensureDetailPanel(),this.detailPanelValue&&this.setIsDetailPanelShowing(!0)}hideDetailPanel(e=!1){this.setIsDetailPanelShowing(!1),e&&(this.detailPanelValue=null)}ensureDetailPanel(){if(!this.isCreatingDetailPanel&&!(this.detailPanelValue||!this.hasPanel||!this.data)){this.isCreatingDetailPanel=!0,this.detailPanelValue=this.data.createRowDetailPanel(this);var e=this.detailPanelValue.questions,t=this.getDataRowValue();if(!L.isValueEmpty(t))for(var s=0;s<e.length;s++){const i=e[s].getValueName(),r=this.editingObj?B.getObjPropertyValue(this.editingObj,i):t[i];L.isValueEmpty(r)||(e[s].value=r)}this.detailPanelValue.setSurveyImpl(this),this.isCreatingDetailPanel=!1}}getAllValues(){const e=this.value;if(this.data){const s=this.getDataRowValue();if(s)for(var t in s)e[t]===void 0&&(e[t]=s[t])}return e}getFilteredProperties(){return{survey:this.getSurvey(),row:this}}getDataRowValue(){return this.data?this.data.getRowValue(this.data.getRowIndex(this)):null}runCondition(e,t){if(!this.data)return;const s=L.createCopy(e);s[D.expressionVariables.row]=this,t?this.visible=new Gs(t).runContext(this.getValueGetterContext(),e):this.visible=!0;for(var i=0;i<this.cells.length;i++)this.cells[i].runCondition(s);this.detailPanel&&this.detailPanel.runCondition(s),this.isRowHasEnabledCondition()&&this.onQuestionReadOnlyChanged()}updateElementVisibility(){this.cells.forEach(e=>e.question.updateElementVisibility()),this.detailPanel&&this.detailPanel.updateElementVisibility()}getNamesWithDefaultValues(){const e=[];return this.questions.forEach(t=>{t.isValueDefault&&e.push(t.getValueName())}),e}clearValue(e,t){for(var s=this.questions,i=0;i<s.length;i++)s[i].clearValue(e,t)}onAnyValueChanged(e,t){for(var s=this.questions,i=0;i<s.length;i++)s[i].onAnyValueChanged(e,t)}getDataValueCore(e,t){var s=this.getSurvey();return s?s.getDataValueCore(e,t):e[t]}getValue(e){var t=this.getQuestionByName(e);return t?t.value:null}setValue(e,t){this.setValueCore(e,t,!1)}getVariable(e){}setVariable(e,t){}getComment(e){var t=this.getQuestionByName(e);return t?t.comment:""}setComment(e,t,s){this.setValueCore(e,t,!0)}findQuestionByName(e){if(!e)return;const t=D.expressionVariables.row+".";if(e.indexOf(t)===0)return this.getQuestionByName(e.substring(t.length));const s=this.getSurvey();return s?s.getQuestionByName(e):null}getEditingSurveyElement(){}setValueCore(e,t,s){if(this.isSettingValue||this.isCreatingDetailPanel)return;this.updateQuestionsValue(e,t,s),s||this.updateSharedQuestionsValue(e,t);var i=this.value,r=s?e+de.commentSuffix:e,a=t,o=this.getQuestionByName(e),l=this.data.onRowChanging(this,r,i);if(o&&!this.isTwoValueEquals(l,a)&&(this.isSettingValue=!0,s?o.comment=l:o.value=l,this.isSettingValue=!1,i=this.value),this.data.isValidateOnValueChanging&&!this.validateCellQuestion(o))return;const u=t==null&&!o||s&&!t&&!!o;this.data.onRowChanged(this,r,i,u);const d=D.expressionVariables.row;if(r){const h=d+"."+r;this.runTriggers(h,i),this.data.runTriggersInRow(this,h,i)}this.onAnyValueChanged(d,"")}updateQuestionsValue(e,t,s){if(this.detailPanel){var i=this.getQuestionByColumnName(e),r=this.detailPanel.getQuestionByName(e);if(!(!i||!r)){var a=this.isTwoValueEquals(t,s?i.comment:i.value),o=a?r:i;this.isSettingValue=!0,s?o.comment=t:o.value=t,this.isSettingValue=!1}}}updateSharedQuestionsValue(e,t){const s=this.getQuestionsByValueName(e);if(s.length>1)for(let i=0;i<s.length;i++)L.isTwoValueEquals(s[i].value,t)||(this.isSettingValue=!0,s[i].updateValueFromSurvey(t),this.isSettingValue=!1)}runTriggers(e,t,s){!e&&!s||this.questions.forEach(i=>i.runTriggers(e,t,s))}validateCellQuestion(e){if(!e)return!0;if(!e.validateElement(new kr({fireCallback:!0,isOnValueChanged:!this.data.isValidateOnValueChanging})))return!1;if(e.isEmpty())return!0;var t=this.getCellByColumnName(e.name);return!t||!t.column||!t.column.isUnique?!0:!this.data.checkIfValueInRowDuplicated(this,e)}get isEmpty(){var e=this.value;if(L.isValueEmpty(e))return!0;for(var t in e)if(e[t]!==void 0&&e[t]!==null)return!1;return!0}hasValueAnyQuestion(e){const t=e?this.visibleQuestions:this.questions;for(let s=0;s<t.length;s++)if(!t[s].isEmpty())return!0;return!1}getQuestionByColumn(e){var t=this.getCellByColumn(e);return t?t.question:null}getCellByColumn(e){for(var t=0;t<this.cells.length;t++)if(this.cells[t].column==e)return this.cells[t];return null}getCellByColumnName(e){for(var t=0;t<this.cells.length;t++)if(this.cells[t].column.name==e)return this.cells[t];return null}getQuestionByColumnName(e){var t=this.getCellByColumnName(e);return t?t.question:null}get questions(){for(var e=[],t=0;t<this.cells.length;t++)e.push(this.cells[t].question);for(var s=this.detailPanel?this.detailPanel.questions:[],t=0;t<s.length;t++)e.push(s[t]);return e}get visibleQuestions(){const e=[];return this.questions.forEach(t=>{t.isVisible&&e.push(t)}),e}getQuestionByName(e){var t=this.getQuestionByColumnName(e);return t||(this.detailPanel?this.detailPanel.getQuestionByName(e):null)}getQuestionsByName(e){let t=[],s=this.getQuestionByColumnName(e);return s&&t.push(s),this.detailPanel&&(s=this.detailPanel.getQuestionByName(e),s&&t.push(s)),t}getQuestionsByValueName(e,t){t&&(e=e.toLocaleLowerCase());let s=[];for(var i=0;i<this.cells.length;i++){const r=this.cells[i],a=r.question;if(!a)continue;let o=a.getValueName();t&&(o=o.toLocaleLowerCase()),o===e&&s.push(r.question)}return this.detailPanel&&(s=s.concat(this.detailPanel.getQuestionsByValueName(e,t))),s}getSharedQuestionByName(e){return this.data?this.data.getSharedQuestionByName(e,this):null}clearIncorrectValues(e){for(var t in e){var s=this.getQuestionByName(t);if(s){var i=s.value;s.clearIncorrectValues(),this.isTwoValueEquals(i,s.value)||this.setValue(t,s.value)}else!this.getSharedQuestionByName(t)&&t.indexOf(D.matrix.totalsSuffix)<0&&this.setValue(t,null)}}getLocale(){return this.data?this.data.getLocale():""}getMarkdownHtml(e,t,s){return this.data?this.data.getMarkdownHtml(e,t,s):void 0}getRenderer(e){return this.data?this.data.getRenderer(e):null}getRendererContext(e){return this.data?this.data.getRendererContext(e):e}getProcessedText(e){return this.data?this.data.getProcessedText(e):e}locStrsChanged(){for(var e=0;e<this.cells.length;e++)this.cells[e].locStrsChanged();this.detailPanel&&this.detailPanel.locStrsChanged()}updateCellQuestionOnColumnChanged(e,t,s){var i=this.getCellByColumn(e);i&&this.updateCellOnColumnChanged(i,t,s)}updateCellQuestionOnColumnItemValueChanged(e,t,s,i,r,a){var o=this.getCellByColumn(e);o&&this.updateCellOnColumnItemValueChanged(o,t,s,i,r,a)}onQuestionReadOnlyChanged(){const e=this.questions;for(var t=0;t<e.length;t++){const s=e[t];s.setPropertyValue("isReadOnly",s.isReadOnly)}if(this.detailPanel){const s=!!this.data&&this.data.isMatrixReadOnly();this.detailPanel.readOnly=s||!this.isRowEnabled()}}validate(e){let t=!0;const s=this.cells;if(!s)return t;for(let i=0;i<s.length;i++){if(!s[i])continue;const r=s[i].question;!r||!r.visible||e&&e.isOnValueChanged===!0&&r.isEmpty()||(t=r.validateElement(e)&&t)}if(this.hasPanel){this.ensureDetailPanel();const i=this.detailPanel.validateElement(e),r=e;!r.hideErroredPanel&&!i&&e.fireCallback&&(r.isSingleDetailPanel&&(r.hideErroredPanel=!0),this.showDetailPanel()),t=i&&t}return t}updateCellOnColumnChanged(e,t,s){t==="choices"&&Array.isArray(s)&&s.length===0&&this.data&&(s=this.data.choices),e.question[t]=s}updateCellOnColumnItemValueChanged(e,t,s,i,r,a){var o=e.question[t];if(Array.isArray(o)){var l=i==="value"?a:s.value,u=fe.getItemByValue(o,l);u&&(u[i]=r)}}buildCells(e){this.isSettingValue=!0;for(var t=this.data.columns,s=0;s<t.length;s++){var i=t[s],r=this.createCell(i);this.cells.push(r);var a=this.getCellValue(e,i.name);if(!L.isValueEmpty(a)){r.question.value=a;var o=i.name+de.commentSuffix;e&&!L.isValueEmpty(e[o])&&(r.question.comment=e[o])}}this.isSettingValue=!1}isTwoValueEquals(e,t){return L.isTwoValueEquals(e,t,!1,!0,!1)}getCellValue(e,t){return this.editingObj?B.getObjPropertyValue(this.editingObj,t):e?e[t]:void 0}createCell(e){return new D1(e,this,this.data)}getSurveyData(){return this}getSurvey(){return this.data?this.data.getSurvey():null}getTextProcessor(){return this.textPreProcessor}get rowIndex(){return this.getRowIndex()}getRowIndex(){return this.data?this.data.getRowIndex(this)+1:-1}get editingObj(){return this.editingObjValue}dispose(){this.editingObj&&(this.editingObj.onPropertyChanged.remove(this.onEditingObjPropertyChanged),this.editingObjValue=null)}subscribeToChanges(e){!e||!e.getType||!e.onPropertyChanged||e!==this.editingObj&&(this.editingObjValue=e,this.onEditingObjPropertyChanged=(t,s)=>{this.updateOnSetValue(s.name,s.newValue)},this.editingObj.onPropertyChanged.add(this.onEditingObjPropertyChanged))}updateOnSetValue(e,t){this.isSettingValue=!0;let s=this.getQuestionsByName(e);for(let i=0;i<s.length;i++)s[i].value=t;this.isSettingValue=!1}}ki.idCounter=1;class Dd extends ki{constructor(e){super(e,null),this.buildCells(null)}createCell(e){return new o_(e,this,this.data)}setValue(e,t){this.data&&!this.isSettingValue&&this.data.onTotalValueChanged()}runCondition(e,t){var s=0,i;do i=L.getUnbindValue(this.value),super.runCondition(e,""),s++;while(!L.isTwoValueEquals(i,this.value)&&s<3)}updateCellOnColumnChanged(e,t,s){e.updateCellQuestion()}}class O1{constructor(e,t){this.matrix=e,this.row=t}getLocale(){return this.matrix.getLocale()}getMarkdownHtml(e,t,s){return this.matrix.getMarkdownHtml(e,t,s)}getProcessedText(e){return this.matrix.processSingleInputTitle(e,this.row)}getRenderer(e){return this.matrix.getRenderer(e)}getRendererContext(e){return this.matrix.getRendererContext(e)}}class Sn extends rl{static get defaultCellType(){return D.matrix.defaultCellType}static set defaultCellType(e){D.matrix.defaultCellType=e}static addDefaultColumns(e){for(var t=Qe.DefaultColums,s=0;s<t.length;s++)e.addColumn(t[s])}createColumnValues(){return this.createNewArray("columns",e=>{e.colOwner=this,this.onAddColumn&&this.onAddColumn(e),this.survey&&this.survey.matrixColumnAdded(this,e)},e=>{e.colOwner=null,this.onRemoveColumn&&this.onRemoveColumn(e)})}constructor(e){super(e),this.isRowChanging=!1,this.lockResetRenderedTable=!1,this.createItemValues("choices"),this.createLocString({name:"placeholder",hasTranslation:!0}),this.createLocString({name:"keyDuplicationError",hasTranslation:!0}),this.createLocalizableString("singleInputTitleTemplate",new O1(this),!0,this.getSingleInputTitleTemplate()),this.detailPanelValue=this.createNewDetailPanel(),this.detailPanel.selectedElementInDesign=this,this.detailPanel.renderWidth="100%",this.detailPanel.isInteractiveDesignElement=!1,this.detailPanel.showTitle=!1,this.registerPropertyChangedHandlers(["columns","cellType"],()=>{this.updateColumnsAndRows()}),this.registerPropertyChangedHandlers(["placeholder","columnColCount","rowTitleWidth","choices"],()=>{this.clearRowsAndResetRenderedTable()}),this.registerPropertyChangedHandlers(["transposeData","addRowButtonLocation","hideColumnsIfEmpty","showHeader","minRowCount","isReadOnly","rowCount","hasFooter","detailPanelMode","displayMode"],()=>{this.resetRenderedTable()})}getType(){return"matrixdropdownbase"}dispose(){super.dispose(),this.clearGeneratedRows()}get isContainer(){return!0}get isRowsDynamic(){return!1}get isUpdateLocked(){return this.isLoadingFromJson||this.isUpdating}beginUpdate(){this.isUpdating=!0}endUpdate(){this.isUpdating=!1,this.updateColumnsAndRows()}updateColumnsAndRows(){this.updateColumnsIndexes(this.columns),this.updateColumnsCellType(),this.generatedTotalRow=null,this.clearRowsAndResetRenderedTable()}itemValuePropertyChanged(e,t,s,i){super.itemValuePropertyChanged(e,t,s,i),e.ownerPropertyName==="choices"&&this.clearRowsAndResetRenderedTable()}get transposeData(){return this.getPropertyValue("transposeData")}set transposeData(e){this.setPropertyValue("transposeData",e)}get columnLayout(){return this.transposeData?"vertical":"horizontal"}set columnLayout(e){this.transposeData=e==="vertical"}get columnsLocation(){return this.columnLayout}set columnsLocation(e){this.columnLayout=e}get detailErrorLocation(){return this.getPropertyValue("detailErrorLocation")}set detailErrorLocation(e){this.setPropertyValue("detailErrorLocation",e.toLowerCase())}get cellErrorLocation(){return this.getPropertyValue("cellErrorLocation")}set cellErrorLocation(e){this.setPropertyValue("cellErrorLocation",e.toLowerCase())}getChildErrorLocation(e){const t=e.parent?this.detailErrorLocation:this.cellErrorLocation;return t!=="default"?t:super.getChildErrorLocation(e)}get isColumnLayoutHorizontal(){return this.isMobile?!0:!this.transposeData}get useCaseSensitiveComparison(){return this.useCaseSensitiveComparisonValue!==void 0?this.useCaseSensitiveComparisonValue:D.comparator.caseSensitive}set useCaseSensitiveComparison(e){this.useCaseSensitiveComparisonValue=e}get isUniqueCaseSensitive(){return this.useCaseSensitiveComparison}set isUniqueCaseSensitive(e){this.useCaseSensitiveComparison=e}get detailPanelMode(){return this.getPropertyValue("detailPanelMode")}set detailPanelMode(e){this.setPropertyValue("detailPanelMode",e)}get detailPanel(){return this.detailPanelValue}getPanels(){const e=this.getPanelInDesignMode();return e?[e]:null}getPanelInDesignMode(){return this.detailPanelMode!=="none"?this.detailPanel:null}get detailElements(){return this.detailPanel.elements}createNewDetailPanel(){return B.createClass("panel")}get hasRowText(){return!0}getFooterText(){return null}get canAddRow(){return!1}get canRemoveRows(){return!1}canRemoveRow(e){return!0}onPointerDown(e,t){}onRowsChanged(){this.clearVisibleRows(),this.resetRenderedTable(),super.onRowsChanged(),this.updateRowsVisibleIndexes()}updateRowsVisibleIndexes(){const e=this.visibleRows;if(!Array.isArray(e))return;const t=D.expressionVariables.visibleRowIndex,s={};s[t]=0;for(let i=0;i<e.length;i++)e[i].visibleIndex=i,s[t]=i+1,e[i].runTriggers(t,i+1,s)}onStartRowAddingRemoving(){this.lockResetRenderedTable=!0,this.setValueChangedDirectly(!0)}onEndRowAdding(){if(this.lockResetRenderedTable=!1,!!this.renderedTable)if(this.renderedTable.isRequireReset())this.resetRenderedTable();else{const e=this.visibleRows.length-1;this.renderedTable.onAddedRow(this.visibleRows[e],e)}}onEndRowRemoving(e){this.lockResetRenderedTable=!1,this.renderedTable.isRequireReset()?this.resetRenderedTable():e&&this.renderedTable.onRemovedRow(e)}get renderedTableValue(){return this.getPropertyValue("renderedTable",null)}set renderedTableValue(e){this.setPropertyValue("renderedTable",e)}clearRowsAndResetRenderedTable(){this.clearGeneratedRows(),this.resetRenderedTable(),this.fireCallback(this.columnsChangedCallback)}resetRenderedTable(e){this.renderedTableValue&&(this.lockResetRenderedTable||this.isUpdateLocked?e&&this.renderedTableValue.requireReset():(this.renderedTableValue=null,this.fireCallback(this.onRenderedTableResetCallback)))}clearGeneratedRows(){if(this.clearVisibleRows(),!!this.generatedVisibleRows){for(var e=0;e<this.generatedVisibleRows.length;e++)this.generatedVisibleRows[e].dispose();super.clearGeneratedRows()}}get isRendredTableCreated(){return!!this.renderedTableValue}get renderedTable(){return!this.renderedTableValue&&!this.isDisposed&&(this.renderedTableValue=this.createRenderedTable(),this.onRenderedTableCreatedCallback&&this.onRenderedTableCreatedCallback(this.renderedTableValue)),this.renderedTableValue}createRenderedTable(){return new ul(this)}getRowByQuestion(e){if(e)return e.data}onMatrixRowCreated(e){if(this.survey)for(var t={rowValue:e.value,row:e,column:null,columnName:null,cell:null,cellQuestion:null,value:null},s=0;s<this.columns.length;s++){t.column=this.columns[s],t.columnName=t.column.name;var i=e.cells[s];t.cell=i,t.cellQuestion=i.question,t.value=i.value,this.onCellCreatedCallback&&this.onCellCreatedCallback(t),this.survey.matrixCellCreated(this,t)}}get cellType(){return this.getPropertyValue("cellType",D.matrix.defaultCellType)}set cellType(e){e=e.toLowerCase(),this.setPropertyValue("cellType",e)}isSelectCellType(){return B.isDescendantOf(this.cellType,"selectbase")}updateColumnsCellType(){for(var e=0;e<this.columns.length;e++)this.columns[e].defaultCellTypeChanged()}updateColumnsIndexes(e){for(var t=0;t<e.length;t++)e[t].setIndex(t)}get columnColCount(){return this.getPropertyValue("columnColCount")}set columnColCount(e){e<0||e>4||this.setPropertyValue("columnColCount",e)}get horizontalScroll(){return this.getPropertyValue("horizontalScroll")}set horizontalScroll(e){this.setPropertyValue("horizontalScroll",e)}get allowAdaptiveActions(){return this.getPropertyValue("allowAdaptiveActions")}set allowAdaptiveActions(e){this.setPropertyValue("allowAdaptiveActions",e),this.detailPanel&&(this.detailPanel.allowAdaptiveActions=e)}hasChoices(){return this.choices.length>0}onColumnPropertyChanged(e,t,s){if(this.updateHasFooter(),!!this.generatedVisibleRows){for(var i=0;i<this.generatedVisibleRows.length;i++)this.generatedVisibleRows[i].updateCellQuestionOnColumnChanged(e,t,s);this.generatedTotalRow&&this.generatedTotalRow.updateCellQuestionOnColumnChanged(e,t,s),this.onColumnsChanged(),t=="isRequired"&&this.resetRenderedTable()}}onColumnNestedPropertyChanged(e,t,s,i){if(this.generatedVisibleRows)for(var r=0;r<this.generatedVisibleRows.length;r++){const o=this.generatedVisibleRows[r].getQuestionByColumn(e);o&&o[t]&&(o[t][s]=i)}}onColumnItemValuePropertyChanged(e,t,s,i,r,a){if(this.generatedVisibleRows)for(var o=0;o<this.generatedVisibleRows.length;o++)this.generatedVisibleRows[o].updateCellQuestionOnColumnItemValueChanged(e,t,s,i,r,a)}onShowInMultipleColumnsChanged(e){this.resetTableAndRows()}onColumnVisibilityChanged(e){this.resetTableAndRows()}onColumnCellTypeChanged(e){this.updateDefaultRowValue(e),this.resetTableAndRows()}updateDefaultRowValue(e){let t=this.defaultRowValue;t&&e.cellType==="file"&&t[e.name]&&(delete t[e.name],Object.keys(t).length===0&&(t=void 0),this.defaultRowValue=t)}resetTableAndRows(){this.clearGeneratedRows(),this.resetRenderedTable()}getRowTitleWidth(){return""}get hasFooter(){return this.getPropertyValue("hasFooter",!1)}getAddRowLocation(){return"default"}getShowColumnsIfEmpty(){return!1}updateShowTableAndAddRow(){this.renderedTable&&this.renderedTable.updateShowTableAndAddRow()}updateHasFooter(){this.setPropertyValue("hasFooter",this.hasTotal)}get hasTotal(){for(var e=0;e<this.columns.length;e++)if(this.columns[e].hasTotal)return!0;return!1}getCellType(){return this.cellType}getCustomCellType(e,t,s){if(!this.survey)return s;var i={rowValue:t.value,row:t,column:e,columnName:e.name,cellType:s};return this.survey.matrixCellCreating(this,i),i.cellType}getConditionJson(e=null,t=null){if(!t)return super.getConditionJson(e);let s="";for(let a=t.length-1;a>=0&&t[a]!=".";a--)s=t[a]+s;let i,r=this.getColumnByName(s);return r?i=r.createCellQuestion(null):this.detailPanelMode!=="none"&&(i=this.detailPanel.getQuestionByName(s)),i?i.getConditionJson(e):null}clearIncorrectValues(){if(!Array.isArray(this.visibleRows))return;const e=this.generatedVisibleRows;for(let t=0;t<e.length;t++)e[t].clearIncorrectValues(this.getRowValue(t))}clearErrors(){super.clearErrors(),this.runFuncForCellQuestions(e=>{e.clearErrors()})}localeChanged(){super.localeChanged(),this.runFuncForCellQuestions(e=>{e.localeChanged()})}runFuncForCellQuestions(e){const t=this.generatedVisibleRows;if(t)for(let s=0;s<t.length;s++){const i=t[s];if(i.isVisible)for(let r=0;r<i.cells.length;r++)e(i.cells[r].question)}}runConditionCore(e){super.runConditionCore(e);var t=0,s;do s=L.getUnbindValue(this.totalValue),this.runCellsCondition(e),this.runTotalsCondition(e),t++;while(!L.isTwoValueEquals(s,this.totalValue)&&t<3);this.updateVisibilityBasedOnRows()}runTriggers(e,t,s){super.runTriggers(e,t,s),this.runFuncForCellQuestions(i=>{i.runTriggers(e,t,s)})}updateElementVisibility(){super.updateElementVisibility();const e=this.generatedVisibleRows;e&&e.forEach(t=>t.updateElementVisibility()),this.updateShowTableAndAddRow()}shouldRunColumnExpression(){return!1}runCellsCondition(e){if(this.isDesignMode)return;const t=this.getExpressionFromSurvey("rowsVisibleIf"),s=this.generatedVisibleRows;if(s)for(var i=0;i<s.length;i++)s[i].runCondition(e,t);this.checkColumnsVisibility(),this.checkColumnsRenderedRequired()}runConditionsForColumns(e){const t=this.getExpressionFromSurvey("columnsVisibleIf");return this.columns.forEach(s=>{if(!t)s.isColumnsVisibleIf=!0;else{const i=new Gs(t);s.isColumnsVisibleIf=i.runContext(s.getValueGetterContext(),e)===!0}}),!1}checkColumnsVisibility(){if(!this.isDesignMode){for(var e=!1,t=0;t<this.columns.length;t++){const s=this.columns[t],i=!!s.visibleIf||s.isFilteredMultipleColumns;!i&&!this.columnsVisibleIf&&s.isColumnVisible||(e=this.isColumnVisibilityChanged(s,i)||e)}e&&this.resetRenderedTable(!0)}}checkColumnsRenderedRequired(){const e=this.generatedVisibleRows;if(e)for(var t=0;t<this.columns.length;t++){const i=this.columns[t];if(!i.requiredIf||!i.isColumnVisible)continue;let r=e.length>0;for(var s=0;s<e.length;s++)if(!e[s].cells[t].question.isRequired){r=!1;break}i.updateIsRenderedRequired(r)}}isColumnVisibilityChanged(e,t){const s=e.isColumnVisible;let i=!t;const r=this.generatedVisibleRows,a=t&&r,o=a&&e.isFilteredMultipleColumns,l=o?e.getVisibleChoicesInCell:[],u=new Array;if(a)for(let d=0;d<r.length;d++){const h=r[d].cells[e.index],f=h?.question;if(f&&f.isVisible)if(i=!0,o)this.updateNewVisibleChoices(f,u);else break}return e.hasVisibleCell=i&&e.isColumnsVisibleIf,o&&(e.setVisibleChoicesInCell(u),!L.isArraysEqual(l,u,!0,!1,!1))?!0:s!==e.isColumnVisible}updateNewVisibleChoices(e,t){const s=e.visibleChoices;if(Array.isArray(s))for(let i=0;i<s.length;i++){const r=s[i];t.indexOf(r.value)<0&&t.push(r.value)}}runTotalsCondition(e){this.generatedTotalRow&&this.generatedTotalRow.runCondition(e)}IsMultiplyColumn(e){return e.isShowInMultipleColumns&&!this.isMobile}locStrsChanged(){super.locStrsChanged();for(var e=this.columns,t=0;t<e.length;t++)e[t].locStrsChanged();var s=this.generatedVisibleRows;if(s){for(var t=0;t<s.length;t++)s[t].locStrsChanged();this.generatedTotalRow&&this.generatedTotalRow.locStrsChanged()}}getColumnByName(e){for(var t=0;t<this.columns.length;t++)if(this.columns[t].name==e)return this.columns[t];return null}getColumnName(e){return this.getColumnByName(e)}getColumnWidth(e){var t;return e.minWidth?e.minWidth:this.columnMinWidth?this.columnMinWidth:((t=D.matrix.columnWidthsByType[e.cellType])===null||t===void 0?void 0:t.minWidth)||""}get choices(){return this.getPropertyValue("choices")}set choices(e){this.setPropertyValue("choices",e)}get placeholder(){return this.getLocalizableStringText("placeholder")}set placeholder(e){this.setLocalizableStringText("placeholder",e)}get locPlaceholder(){return this.getLocalizableString("placeholder")}get optionsCaption(){return this.placeholder}set optionsCaption(e){this.placeholder=e}get keyDuplicationError(){return this.getLocalizableStringText("keyDuplicationError")}set keyDuplicationError(e){this.setLocalizableStringText("keyDuplicationError",e)}get locKeyDuplicationError(){return this.getLocalizableString("keyDuplicationError")}get singleInputTitleTemplate(){return this.getLocalizableStringText("singleInputTitleTemplate")}set singleInputTitleTemplate(e){this.setLocalizableStringText("singleInputTitleTemplate",e)}get locSingleInputTitleTemplate(){return this.getLocalizableString("singleInputTitleTemplate")}getSingleQuestionLocTitleCore(){return this.locSingleInputTitleTemplate}getSingleInputTitleTemplate(){return""}processSingleInputTitle(e,t){t||(t=this.getRowByQuestion(this.singleInputQuestion));const s=t?t.getTextProcessor():this.textProcessor;return s?s.processText(e,!0):e}singleInputMoveToFirstCore(){var e;const t=(e=this.singleInputQuestion)===null||e===void 0?void 0:e.data;this.singleInputEditRow(t)}singleInputEditRow(e){if(!e)return;const t=e.visibleQuestions;Array.isArray(t)&&t.length>0&&this.setSingleInputQuestion(t[0])}get storeOthersAsComment(){return this.survey?this.survey.storeOthersAsComment:!1}addColumn(e,t){var s=new ll(e,t,this);return this.columns.push(s),s}clearVisibleRows(){this.visibleRowsArray=null}isColumnVisible(e){return e.isColumnVisible}getVisibleRows(){return this.isUpdateLocked?null:this.isGenereatingRows?[]:this.visibleRowsArray?this.visibleRowsArray:(this.generateVisibleRowsIfNeeded(),this.visibleRowsArray=this.getVisibleFromGenerated(this.generatedVisibleRows),this.updateRowsVisibleIndexes(),this.visibleRowsArray)}get allRows(){return this.isGenereatingRows?[]:(this.generateVisibleRowsIfNeeded(),this.generatedVisibleRows)}generateVisibleRowsIfNeeded(){if(!this.isUpdateLocked&&!this.generatedVisibleRows){this.isGenereatingRows=!0,this.generatedVisibleRows=this.generateRows(),this.isGenereatingRows=!1;for(var e=0;e<this.generatedVisibleRows.length;e++){const t=this.generatedVisibleRows[e];t.visibleIndex=e,this.onMatrixRowCreated(t)}this.data&&(this.runCellsCondition(this.data.getFilteredProperties()),this.isValueChangedWithoutRows&&(this.isValueChangedWithoutRows=!1,this.runTriggersOnNewRows())),this.generatedVisibleRows&&(this.updateValueOnRowsGeneration(this.generatedVisibleRows),this.updateIsAnswered())}}runTriggersOnNewRows(){const e=this.value;this.generatedVisibleRows.forEach(t=>{const s=this.getRowValueCore(t,e);if(!L.isValueEmpty(s)){const i=L.createCopyWithPrefix(s,D.expressionVariables.row+".");t.runTriggers("",void 0,i)}})}getVisibleFromGenerated(e){const t=[];return e?(e.forEach(s=>{s.isVisible&&t.push(s)}),t.length===e.length?e:t):t}updateValueOnRowsGeneration(e){for(var t=this.createNewValue(!0),s=this.createNewValue(),i=0;i<e.length;i++){var r=e[i];if(!r.editingObj){var a=this.getRowValue(i),o=r.value;this.isTwoValueEquals(a,o)||(s=this.getNewValueOnRowChanged(r,"",o,!1,s).value)}}this.isTwoValueEquals(t,s)||(this.isRowChanging=!0,this.setNewValue(s),this.isRowChanging=!1)}get totalValue(){return!this.hasTotal||!this.visibleTotalRow?{}:this.visibleTotalRow.value}getVisibleTotalRow(){return this.isUpdateLocked?null:(this.hasTotal?this.generatedTotalRow||(this.generatedTotalRow=this.generateTotalRow(),this.data&&this.runTotalsCondition({survey:this.survey})):this.generatedTotalRow=null,this.generatedTotalRow)}get visibleTotalRow(){return this.getVisibleTotalRow()}onSurveyLoad(){super.onSurveyLoad(),this.updateColumnsIndexes(this.columns),this.clearGeneratedRows(),this.generatedTotalRow=null,this.updateHasFooter()}getRowValue(e){if(e<0||!Array.isArray(this.visibleRows))return null;var t=this.generatedVisibleRows;if(e>=t.length)return null;const s=this.value,i=this.getRowValueCore(t[e],s);return this.isValueSurveyElement(s)?i:L.getUnbindValue(i)}checkIfValueInRowDuplicated(e,t){return this.generatedVisibleRows?this.isValueInColumnDuplicated(t.name,!0,e):!1}setRowValue(e,t){if(e<0)return null;var s=this.visibleRows;if(e>=s.length)return null;s[e].value=t,this.onRowChanged(s[e],"",t,!1)}generateRows(){return null}generateTotalRow(){return new Dd(this)}createNewValue(e=!1){var t=this.value?this.createValueCopy():{};return e&&this.isMatrixValueEmpty(t)?null:t}getRowValueCore(e,t,s=!1){var i=t&&t[e.rowName]?t[e.rowName]:null;return!i&&s&&(i={},t&&(t[e.rowName]=i)),i}getRowObj(e){var t=this.getRowValueCore(e,this.value);return t&&t.getType?t:null}getRowDisplayValue(e,t,s){if(!s||t.editingObj)return s;for(var i=Object.keys(s),r=0;r<i.length;r++){var a=i[r],o=t.getQuestionByName(a);if(o||(o=this.getSharedQuestionByName(a,t)),o){var l=o.getDisplayValue(e,s[a]);e&&o.title&&o.title!==a?(s[o.title]=l,delete s[a]):s[a]=l}}return s}getPlainData(e={includeEmpty:!0}){var t=super.getPlainData(e);if(t){t.isNode=!0;const s=Array.isArray(t.data)?[].concat(t.data):[];t.data=this.visibleRows.map(i=>{var r={name:i.dataName,title:i.text,value:i.value,displayValue:this.getRowDisplayValue(!1,i,i.value),getString:a=>typeof a=="object"?JSON.stringify(a):a,isNode:!0,data:i.cells.map(a=>a.question.getPlainData(e)).filter(a=>!!a)};return(e.calculations||[]).forEach(a=>{r[a.propertyName]=i[a.propertyName]}),r}),t.data=t.data.concat(s)}return t}addConditionObjectsByContext(e,t){let s=[].concat(this.columns);this.detailPanelMode!=="none"&&(s=s.concat(this.detailPanel.questions));const i=!!t&&s.indexOf(t)>-1,r=t===!0||i,a=this.getConditionObjectsRowIndeces();r&&a.push(-1);for(var o=0;o<a.length;o++){const u=a[o],d=u>-1?this.getConditionObjectRowName(u):"row";if(!d)continue;const h=u>-1?this.getConditionObjectRowText(u):"row",f=u>-1||t===!0,C=f&&u===-1?".":"",b=(f?this.getValueName():"")+C+d+".",x=(f?this.processedTitle:"")+C+h+".";for(var l=0;l<s.length;l++){const V=s[l];if(u===-1&&t===V)continue;const P={name:b+V.name,text:x+V.fullTitle,question:this};u===-1&&t===!0?P.context=this:i&&b.startsWith("row.")&&(P.context=t),e.push(P)}}}onHidingContent(){if(super.onHidingContent(),!this.generatedVisibleRows)return;const e=[];this.collectNestedQuestions(e,!0),e.forEach(t=>t.onHidingContent())}getIsReadyNestedQuestions(){if(!this.generatedVisibleRows)return[];const e=new Array;return this.collectNestedQuestonsInRows(this.generatedVisibleRows,e,!1,!0,!1),this.generatedTotalRow&&this.collectNestedQuestonsInRows([this.generatedTotalRow],e,!1,!0,!1),e}collectNestedQuestionsCore(e,t,s,i){i&&e.push(this),this.collectNestedQuestonsInRows(this.visibleRows,e,t,s,i)}collectNestedQuestonsInRows(e,t,s,i,r){Array.isArray(e)&&e.forEach(a=>{a.questions.forEach(o=>o.addNestedQuestion(t,s,i,r))})}getConditionObjectRowName(e){return""}getConditionObjectRowText(e){return this.getConditionObjectRowName(e)}getConditionObjectsRowIndeces(){return[]}getProgressInfo(){if(this.getIsRequireToGenerateRows()&&this.generateVisibleRowsIfNeeded(),this.generatedVisibleRows)return Ke.getProgressInfoByElements(this.getCellQuestions(),this.isRequired);const e=de.createProgressInfo();return this.updateProgressInfoByValues(e),e.requiredQuestionCount===0&&this.isRequired&&(e.requiredQuestionCount=1,e.requiredAnsweredQuestionCount=this.isEmpty()?0:1),e}getIsRequireToGenerateRows(){return!!this.rowsVisibleIf}updateProgressInfoByValues(e){}updateProgressInfoByRow(e,t){for(var s=0;s<this.columns.length;s++){const i=this.columns[s];if(!i.templateQuestion.hasInput)continue;const r=!L.isValueEmpty(t[i.name]);!r&&i.templateQuestion.visibleIf||(e.questionCount+=1,e.requiredQuestionCount+=i.isRequired,e.answeredQuestionCount+=r?1:0,e.requiredAnsweredQuestionCount+=r&&i.isRequired?1:0)}}getCellQuestions(){const e=[];return this.runFuncForCellQuestions(t=>{e.push(t)}),e}onBeforeValueChanged(e){}onSetQuestionValue(){if(!this.isRowChanging&&(this.onBeforeValueChanged(this.value),!(!this.generatedVisibleRows||this.generatedVisibleRows.length==0))){this.isRowChanging=!0;for(var e=this.createNewValue(),t=0;t<this.generatedVisibleRows.length;t++){var s=this.generatedVisibleRows[t];this.generatedVisibleRows[t].value=this.getRowValueCore(s,e)}this.isRowChanging=!1}}setQuestionValue(e){super.setQuestionValue(e,!1),this.onSetQuestionValue(),this.updateIsAnswered()}supportAutoAdvance(){var e=this.generatedVisibleRows;if(e||(e=this.visibleRows),!e)return!0;for(var t=0;t<e.length;t++){var s=this.generatedVisibleRows[t].cells;if(s)for(var i=0;i<s.length;i++){var r=s[i].question;if(r&&(!r.supportAutoAdvance()||!r.value))return!1}}return!0}getContainsErrors(){return super.getContainsErrors()||this.checkForAnswersOrErrors(e=>e.containsErrors,!1)}getIsAnswered(){return super.getIsAnswered()&&this.checkForAnswersOrErrors(e=>e.isAnswered,!0)}checkForAnswersOrErrors(e,t=!1){var s=this.generatedVisibleRows;if(!s)return!1;for(var i=0;i<s.length;i++){var r=s[i].cells;if(r){for(var a=0;a<r.length;a++)if(r[a]){var o=r[a].question;if(o&&o.isVisible){if(e(o)){if(!t)return!0}else if(t)return!1}}}}return!!t}validateElementCore(e){const t=this.validateRows(e),s=this.isValueDuplicated(e);return super.validateElementCore(e)&&t&&!s}getIsRunningValidators(){if(super.getIsRunningValidators())return!0;if(!this.generatedVisibleRows)return!1;for(var e=0;e<this.generatedVisibleRows.length;e++){var t=this.generatedVisibleRows[e].cells;if(t){for(var s=0;s<t.length;s++)if(t[s]){var i=t[s].question;if(i&&i.isRunningValidators)return!0}}}return!1}getAllErrors(){var e=super.getAllErrors(),t=this.generatedVisibleRows;if(t===null)return e;for(var s=0;s<t.length;s++)for(var i=t[s],r=0;r<i.cells.length;r++){var a=i.cells[r].question.getAllErrors();a&&a.length>0&&(e=e.concat(a))}return e}validateRows(e){let t=this.generatedVisibleRows;t||(t=this.visibleRows);var s=!0;e.isSingleDetailPanel=this.detailPanelMode==="underRowSingle";for(var i=0;i<t.length;i++)t[i].isVisible&&(s=t[i].validate(e)&&s);return s}isValueDuplicated(e){if(!this.generatedVisibleRows)return!1;for(var t=this.getUniqueColumnsNames(),s=!1,i=0;i<t.length;i++){const r=this.getDuplicatedRowAndShowErrors(t[i],!0);r&&r.length>0&&(e.setErrorElement(r[0].getQuestionByColumnName(t[i])),s=!0)}return s}getUniqueColumnsNames(){for(var e=new Array,t=0;t<this.columns.length;t++)this.columns[t].isUnique&&e.push(this.columns[t].name);return e}isValueInColumnDuplicated(e,t,s){const i=this.getDuplicatedRowAndShowErrors(e,t,s);return s?i.indexOf(s)>-1:i.length>0}getDuplicatedRowAndShowErrors(e,t,s){const i=this.getDuplicatedRows(e);return t&&this.showDuplicatedErrorsInRows(i,e),this.removeDuplicatedErrorsInRows(i,e),i}getDuplicatedRows(e){const t={},s=[],i=this.generatedVisibleRows;for(var r=0;r<i.length;r++){let a;const o=i[r].getQuestionByName(e);if(o)a=o.value;else{const l=this.getRowValue(r);a=l?l[e]:void 0}this.isValueEmpty(a)||(!this.useCaseSensitiveComparison&&typeof a=="string"&&(a=a.toLocaleLowerCase()),t[a]||(t[a]=[]),t[a].push(i[r]))}for(let a in t)t[a].length>1&&t[a].forEach(o=>s.push(o));return s}showDuplicatedErrorsInRows(e,t){e.forEach(s=>{let i=s.getQuestionByName(t);const r=this.detailPanel.getQuestionByName(t);!i&&r&&(s.showDetailPanel(),s.detailPanel&&(i=s.detailPanel.getQuestionByName(t))),i&&(r&&s.showDetailPanel(),this.addDuplicationError(i))})}removeDuplicatedErrorsInRows(e,t){this.generatedVisibleRows.forEach(s=>{if(e.indexOf(s)<0){const i=s.getQuestionByName(t);i&&this.removeDuplicationError(s,i)}})}getDuplicationError(e){const t=e.errors;for(let s=0;s<t.length;s++)if(t[s].getErrorType()==="keyduplicationerror")return t[s];return null}addDuplicationError(e){this.getDuplicationError(e)||e.addError(new x1(this.keyDuplicationError,this))}removeDuplicationError(e,t){t.removeError(this.getDuplicationError(t))&&t.errors.length===0&&e.editingObj&&(e.editingObj[t.getValueName()]=t.value)}getFirstQuestionToFocus(e){return this.getFirstCellQuestion(e)}getFirstInputElementId(){var e=this.getFirstCellQuestion(!1);return e?e.inputId:super.getFirstInputElementId()}getFirstErrorInputElementId(){var e=this.getFirstCellQuestion(!0);return e?e.inputId:super.getFirstErrorInputElementId()}getFirstCellQuestion(e){if(!this.generatedVisibleRows)return null;for(var t=0;t<this.generatedVisibleRows.length;t++)for(var s=this.generatedVisibleRows[t].cells,i=0;i<s.length;i++)if(!e||s[i].question.currentErrorCount>0)return s[i].question;return null}onReadOnlyChanged(){if(super.onReadOnlyChanged(),!!this.generateRows)for(var e=0;e<this.visibleRows.length;e++)this.visibleRows[e].onQuestionReadOnlyChanged()}createQuestion(e,t){return this.createQuestionCore(e,t)}createQuestionCore(e,t){var s=t.createCellQuestion(e);return s.setSurveyImpl(e),s.setParentQuestion(this),s.inMatrixMode=!0,s}deleteRowValue(e,t){return e&&(delete e[t.rowName],this.isObject(e)&&Object.keys(e).length==0?null:e)}onAnyValueChanged(e,t){if(!(this.isUpdateLocked||this.isDoingonAnyValueChanged)){if(!this.generatedVisibleRows){e===this.getValueName()&&(this.isValueChangedWithoutRows=!0);return}this.isDoingonAnyValueChanged=!0;for(var s=this.generatedVisibleRows,i=0;i<s.length;i++)s[i].onAnyValueChanged(e,t);var r=this.visibleTotalRow;r&&r.onAnyValueChanged(e,t),this.isDoingonAnyValueChanged=!1}}isObject(e){return e!==null&&typeof e=="object"}getOnCellValueChangedOptions(e,t,s){const i=r=>e.getQuestionByName(r);return{row:e,columnName:t,rowValue:s,value:s?s[t]:null,getCellQuestion:i,cellQuestion:e.getQuestionByName(t),column:this.getColumnByName(t)}}onCellValueChanged(e,t,s){if(this.survey){var i=this.getOnCellValueChangedOptions(e,t,s);this.onCellValueChangedCallback&&this.onCellValueChangedCallback(i),this.survey.matrixCellValueChanged(this,i)}}validateCell(e,t,s){if(this.survey){var i=this.getOnCellValueChangedOptions(e,t,s);return this.survey.matrixCellValidate(this,i)}}get isValidateOnValueChanging(){return this.survey?this.survey.isValidateOnValueChanging:!1}get hasInvisibleRows(){const e=this.generatedVisibleRows;if(!Array.isArray(e))return!1;for(let t=0;t<e.length;t++)if(!e[t].isVisible)return!0;return!1}getFilteredData(){return this.isEmpty()||!this.generatedVisibleRows||this.isEditingSurveyElement?this.value:this.getFilteredDataCore()}getFilteredDataCore(){return this.value}onRowChanging(e,t,s){if(!this.survey&&!this.cellValueChangingCallback)return s?s[t]:null;var i=this.getOnCellValueChangedOptions(e,t,s),r=this.getRowValueCore(e,this.createNewValue(),!0);return i.oldValue=r?r[t]:null,this.cellValueChangingCallback&&(i.value=this.cellValueChangingCallback(e,t,i.value,i.oldValue)),this.survey&&this.survey.matrixCellValueChanging(this,i),i.value}getSharedQuestionFromArray(e,t){return this.survey&&this.valueName?this.survey.getQuestionByValueNameFromArray(this.valueName,e,t):null}onRowChanged(e,t,s,i){var r=t?this.getRowObj(e):null;if(r){var a=null;s&&!i&&(a=s[t]),this.isRowChanging=!0,B.setObjPropertyValue(r,t,a),this.isRowChanging=!1,this.onCellValueChanged(e,t,r)}else{var o=this.createNewValue(!0),l=this.getNewValueOnRowChanged(e,t,s,i,this.createNewValue());if(this.isTwoValueEquals(o,l.value))return;this.isRowChanging=!0,this.setNewValue(l.value),this.isRowChanging=!1,t&&this.onCellValueChanged(e,t,l.rowValue)}this.getUniqueColumnsNames().indexOf(t)>-1&&this.isValueInColumnDuplicated(t,!!r)}getNewValueOnRowChanged(e,t,s,i,r){const a=this.getRowValueCore(e,r,!0);if(i&&delete a[t],e.questions.forEach(l=>{delete a[l.getValueName()]}),s){s=JSON.parse(JSON.stringify(s));for(var o in s)this.isValueEmpty(s[o])||(a[o]=s[o])}return this.isObject(a)&&Object.keys(a).length===0&&(r=this.deleteRowValue(r,e)),r=this.correctValueForMinMaxRows(r),{value:r,rowValue:a}}correctValueForMinMaxRows(e){return e}getRowIndex(e){return Array.isArray(this.generatedVisibleRows)?this.generatedVisibleRows.indexOf(e):-1}getElementsInDesign(e=!1){let t;return this.detailPanelMode=="none"?t=super.getElementsInDesign(e):t=e?[this.detailPanel]:this.detailElements,this.columns.concat(t)}hasDetailPanel(e){return this.detailPanelMode=="none"?!1:this.isDesignMode?!0:this.onHasDetailPanelCallback?this.onHasDetailPanelCallback(e):this.detailElements.length>0}getIsDetailPanelShowing(e){if(this.detailPanelMode=="none")return!1;if(this.isDesignMode){var t=this.visibleRows.indexOf(e)==0;return t&&(e.detailPanel||e.showDetailPanel()),t}return this.getPropertyValue("isRowShowing"+e.id,!1)}setIsDetailPanelShowing(e,t){if(t!=this.getIsDetailPanelShowing(e)&&(this.setPropertyValue("isRowShowing"+e.id,t),this.updateDetailPanelButtonCss(e),this.renderedTable&&this.renderedTable.onDetailPanelChangeVisibility(e,t),this.survey&&this.survey.matrixDetailPanelVisibleChanged(this,e.rowIndex-1,e,t),t&&this.detailPanelMode==="underRowSingle"))for(var s=this.visibleRows,i=0;i<s.length;i++)s[i].id!==e.id&&s[i].isDetailPanelShowing&&s[i].hideDetailPanel()}getDetailPanelButtonCss(e){const t=new j().append(this.getPropertyValue("detailButtonCss"+e.id));return t.append(this.cssClasses.detailButton,t.toString()==="").toString()}getDetailPanelIconCss(e){const t=new j().append(this.getPropertyValue("detailIconCss"+e.id));return t.append(this.cssClasses.detailIcon,t.toString()==="").toString()}getDetailPanelIconId(e){return this.getIsDetailPanelShowing(e)?this.cssClasses.detailIconExpandedId:this.cssClasses.detailIconId}updateDetailPanelButtonCss(e){const t=this.cssClasses,s=this.getIsDetailPanelShowing(e),i=new j().append(t.detailIcon).append(t.detailIconExpanded,s);this.setPropertyValue("detailIconCss"+e.id,i.toString());const r=new j().append(t.detailButton).append(t.detailButtonExpanded,s);this.setPropertyValue("detailButtonCss"+e.id,r.toString())}createRowDetailPanel(e){if(this.isDesignMode)return this.detailPanel;var t=this.createNewDetailPanel();t.readOnly=this.isReadOnly||!e.isRowEnabled(),t.setSurveyImpl(e);var s=this.detailPanel.toJSON();return new rt().toObject(s,t),t.renderWidth="100%",t.updateCustomWidgets(),this.onCreateDetailPanelCallback&&this.onCreateDetailPanelCallback(e,t),t.questions.forEach(i=>i.setParentQuestion(this)),t.onSurveyLoad(),t}getSharedQuestionByName(e,t){if(!this.survey||!this.valueName)return null;var s=this.getRowIndex(t);return s<0?null:this.survey.getQuestionByValueNameFromArray(this.valueName,e,s)}runTriggersInRow(e,t,s){if(!(!this.survey||!this.valueName)){var i=this.getRowIndex(e);i<0||this.survey.getQuestionsByValueName(this.valueName).forEach(r=>{const a=r.visibleRows;Array.isArray(a)&&i<a.length&&a[0]instanceof ki&&a[i].runTriggers(t,s)})}}onTotalValueChanged(){this.data&&this.visibleTotalRow&&!this.isUpdateLocked&&!this.isSett&&this.data.setValue(this.getValueName()+D.matrix.totalsSuffix,this.totalValue,!1)}getParentTextProcessor(){if(!this.parentQuestion||!this.parent)return null;const e=this.parent.data;return e&&e.getTextProcessor?e.getTextProcessor():null}isMatrixReadOnly(){return this.isReadOnly}onRowVisibilityChanged(e){this.clearVisibleRows(),this.resetRenderedTable(),this.resetSingleInput()}clearValueIfInvisibleCore(e){super.clearValueIfInvisibleCore(e),this.clearInvisibleValuesInRows()}clearInvisibleValuesInRows(){var e;if(this.isEmpty()||!this.isRowsFiltered())return;(((e=this.survey)===null||e===void 0?void 0:e.questionsByValueName(this.getValueName()))||[]).length<2&&(this.value=this.getFilteredData())}isRowsFiltered(){return this.visibleRows!==this.generatedVisibleRows}getQuestionFromArray(e,t){return t>=this.visibleRows.length?null:this.visibleRows[t].getQuestionByName(e)}isMatrixValueEmpty(e){if(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)if(this.isObject(e[t])&&Object.keys(e[t]).length>0)return!1;return!0}return Object.keys(e).length==0}}get SurveyModel(){return this.survey}getCellTemplateData(e){return this.SurveyModel.getMatrixCellTemplateData(e)}getCellWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName(e,e.row instanceof Dd?"row-footer":"cell")}getCellWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData(e,e.row instanceof Dd?"row-footer":"cell")}getColumnHeaderWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName(e,"column-header")}getColumnHeaderWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData(e,"column-header")}getRowHeaderWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName(e,"row-header")}getRowHeaderWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData(e,"row-header")}onMobileChanged(){super.onMobileChanged(),this.resetRenderedTable()}getRootCss(){return new j().append(super.getRootCss()).append(this.cssClasses.rootScroll,this.horizontalScroll).toString()}afterRenderQuestionElement(e){super.afterRenderQuestionElement(e),this.setRootElement(e?.parentElement)}beforeDestroyQuestionElement(e){super.beforeDestroyQuestionElement(e),this.setRootElement(void 0)}setRootElement(e){this.rootElement=e}getRootElement(){return this.rootElement}get dragDropMatrixAttribute(){return this.renderedTable.wrapperDropTargetId}}B.addClass("matrixdropdownbase",[{name:"columns:matrixdropdowncolumns",uniqueProperty:"name",className:"matrixdropdowncolumn",isArray:!0},{name:"columnLayout",alternativeName:"columnsLocation",choices:["horizontal","vertical"],visible:!1,isSerializable:!1},{name:"transposeData:boolean",version:"1.9.130",oldName:"columnLayout"},{name:"detailElements",baseClassName:"question",visible:!1,isLightSerializable:!1},{name:"detailPanelMode",choices:["none","underRow","underRowSingle"],default:"none"},{name:"cellErrorLocation",default:"default",choices:["default","top","bottom"]},{name:"detailErrorLocation",default:"default",choices:["default","top","bottom"],visibleIf:n=>!!n&&n.detailPanelMode!="none"},{name:"horizontalScroll:boolean",visible:!1},{name:"choices:itemvalue[]",uniqueProperty:"value",visibleIf:n=>n.isSelectCellType()},{name:"placeholder",alternativeName:"optionsCaption",serializationProperty:"locPlaceholder"},{name:"keyDuplicationError",serializationProperty:"locKeyDuplicationError"},{name:"singleInputTitleTemplate",serializationProperty:"locSingleInputTitleTemplate",visibleIf(n){var e;return((e=n.survey)===null||e===void 0?void 0:e.questionsOnPageMode)==="inputPerPage"}},{name:"cellType",default:"dropdown",choices:()=>ll.getColumnTypes()},{name:"columnColCount",default:0,choices:[0,1,2,3,4]},"columnMinWidth",{name:"allowAdaptiveActions:boolean",default:!1,visible:!1}],function(){return new Sn("")},"matrixbase");class u_ extends Zi{constructor(e){super(),this.question=e}getValue(e,t,s,i){if(!i&&this.question.isEmpty())return{isFound:e.length===0,value:void 0};if(e.length>0){const r=super.getValue(e,t,s,i);if(r&&r.isFound)return r}return new ws(this.question.value).getValue(e,t,s,i)}getRootObj(){return this.question.data}updateValueByItem(e,t){var s;const i=this.question.visibleRows;e=e.toLocaleLowerCase();for(let r=0;r<i.length;r++){const a=i[r];if((((s=a.rowName)===null||s===void 0?void 0:s.toString())||"").toLocaleLowerCase()===e){t.isFound=!0,t.context=a.getValueGetterContext();return}}}}class h_ extends ki{constructor(e,t,s,i){super(s,i),this.name=e,this.item=t,this.buildCells(i)}get rowName(){return this.name}get rowTitle(){return this.text}get text(){return this.item.text}get locText(){return this.item.locText}isItemVisible(){return this.item.isVisible}isRowEnabled(){return this.item.isEnabled}isRowHasEnabledCondition(){return!!this.item.enableIf}}class M1 extends Sn{constructor(e){super(e),this.defaultValuesInRows={},this.createLocalizableString("totalText",this,!0),this.registerPropertyChangedHandlers(["rows"],()=>{this.generatedVisibleRows&&(this.clearGeneratedRows(),this.resetRenderedTable(),this.getVisibleRows(),this.clearIncorrectValues())}),this.registerPropertyChangedHandlers(["hideIfRowsEmpty"],()=>{this.updateVisibilityBasedOnRows()})}getType(){return"matrixdropdown"}get totalText(){return this.getLocalizableStringText("totalText","")}set totalText(e){this.setLocalizableStringText("totalText",e)}get locTotalText(){return this.getLocalizableString("totalText")}getFooterText(){return this.locTotalText}getRowTitleWidth(){return this.rowTitleWidth}get hideIfRowsEmpty(){return this.getPropertyValue("hideIfRowsEmpty")}set hideIfRowsEmpty(e){this.setPropertyValue("hideIfRowsEmpty",e)}getSingleInputTitleTemplate(){return"rowNameTemplateTitle"}getValueGetterContext(){return new u_(this)}getDisplayValueCore(e,t){if(!t)return t;var s=this.visibleRows,i={};if(!s)return i;for(var r=0;r<s.length;r++){var a=s[r].rowName,o=t[a];if(o){if(e){var l=fe.getTextOrHtmlByValue(this.rows,a);l&&(a=l)}i[a]=this.getRowDisplayValue(e,s[r],o)}}return i}getConditionObjectRowName(e){return"."+this.rows[e].value}getConditionObjectRowText(e){return"."+this.rows[e].calculatedText}getConditionObjectsRowIndeces(){const e=[];for(var t=0;t<this.rows.length;t++)e.push(t);return e}isNewValueCorrect(e){return L.isValueObject(e,!0)}clearIncorrectValues(){if(!this.isEmpty()){this.getVisibleRows();const e={},t=this.value;for(let s in t){const i=this.getRowByKey(s);i&&i.isVisible&&(e[s]=t[s])}this.value=e}super.clearIncorrectValues()}getRowByKey(e){const t=this.generatedVisibleRows;if(!t)return null;for(let s=0;s<t.length;s++)if(t[s].rowName===e)return t[s];return null}clearGeneratedRows(){this.generatedVisibleRows&&(this.isDisposed||this.generatedVisibleRows.forEach(e=>{this.defaultValuesInRows[e.rowName]=e.getNamesWithDefaultValues()}),super.clearGeneratedRows())}getRowValueForCreation(e,t){const s=e[t];if(!s)return s;const i=this.defaultValuesInRows[t];return!Array.isArray(i)||i.length===0||i.forEach(r=>{delete s[r]}),s}generateRows(){var e=new Array,t=this.rows;if(!t||t.length===0)return e;var s=this.value;s||(s={});for(var i=0;i<t.length;i++){const r=t[i];this.isValueEmpty(r.value)||e.push(this.createMatrixRow(r,this.getRowValueForCreation(s,r.value)))}return e}createMatrixRow(e,t){return new h_(e.value,e,this,t)}getFilteredDataCore(){const e={};return this.generatedVisibleRows.forEach(t=>{t.isVisible&&!t.isEmpty&&(e[t.rowName]=t.filteredValue)}),e}getSearchableItemValueKeys(e){e.push("rows")}getIsRequireToGenerateRows(){if(super.getIsRequireToGenerateRows())return!0;for(let e=0;e<this.rows.length;e++)if(this.rows[e].visibleIf)return!0;return!1}updateProgressInfoByValues(e){let t=this.value;t||(t={});for(var s=0;s<this.rows.length;s++){const i=this.rows[s],r=t[i.value];this.updateProgressInfoByRow(e,r||{})}}}B.addClass("matrixdropdown",[{name:"rows:itemvalue[]",uniqueProperty:"value"},"rowsVisibleIf:condition","rowTitleWidth",{name:"totalText",serializationProperty:"locTotalText"},"hideIfRowsEmpty:boolean"],function(){return new M1("")},"matrixdropdownbase"),Qe.Instance.registerQuestion("matrixdropdown",n=>{var e=new M1(n);return e.choices=[1,2,3,4,5],e.rows=Qe.DefaultRows,Sn.addDefaultColumns(e),e}),typeof window<"u"&&window.addEventListener("touchmove",n=>{qr.PreventScrolling&&n.preventDefault()},{passive:!1});class qr{constructor(e,t=!0,s=!1){this.dd=e,this.longTap=t,this.fitToContainer=s,this.scrollIntervalId=null,this.stopLongTapIfMoveEnough=i=>{i.preventDefault(),this.currentX=i.pageX,this.currentY=i.pageY,!this.isMicroMovement&&(this.returnUserSelectBack(),this.stopLongTap())},this.stopLongTap=i=>{clearTimeout(this.timeoutID),this.timeoutID=null,document.removeEventListener("pointerup",this.stopLongTap),document.removeEventListener("pointermove",this.stopLongTapIfMoveEnough)},this.handlePointerCancel=i=>{this.clear()},this.handleEscapeButton=i=>{i.keyCode==27&&this.clear()},this.onContextMenu=i=>{i.preventDefault(),i.stopPropagation()},this.dragOver=i=>{this.moveShortcutElement(i),this.draggedElementShortcut.style.cursor="grabbing",this.dd.dragOver(i)},this.clear=()=>{cancelAnimationFrame(this.scrollIntervalId),document.removeEventListener("pointermove",this.dragOver),document.removeEventListener("pointercancel",this.handlePointerCancel),document.removeEventListener("keydown",this.handleEscapeButton),document.removeEventListener("pointerup",this.drop),this.draggedElementShortcut.removeEventListener("pointerup",this.drop),vt&&this.draggedElementShortcut.removeEventListener("contextmenu",this.onContextMenu),this.draggedElementShortcut.parentElement.removeChild(this.draggedElementShortcut),this.dd.clear(),this.draggedElementShortcut=null,this.scrollIntervalId=null,vt&&(this.savedTargetNode.style.cssText=null,this.savedTargetNode&&this.savedTargetNode.parentElement.removeChild(this.savedTargetNode),this.insertNodeToParentAtIndex(this.savedTargetNodeParent,this.savedTargetNode,this.savedTargetNodeIndex),qr.PreventScrolling=!1),this.savedTargetNode=null,this.savedTargetNodeParent=null,this.savedTargetNodeIndex=null,this.returnUserSelectBack()},this.drop=()=>{this.dd.drop(),this.clear()},this.draggedElementShortcut=null}get documentOrShadowRoot(){const e=this.rootElement.getRootNode();return e instanceof Document||e instanceof ShadowRoot?e:void 0}get rootElement(){return Ko(D.environment.root)?this.rootContainer||D.environment.root:this.rootContainer||D.environment.root.documentElement||document.body}get viewRootElement(){return Ko(this.rootElement)?this.rootElement.host:this.rootElement}get isMicroMovement(){const t=Math.abs(this.currentX-this.startX),s=Math.abs(this.currentY-this.startY);return t<5&&s<5}startLongTapProcessing(e,t,s,i,r=!1){this.startX=e.pageX,this.startY=e.pageY,document.body.style.setProperty("touch-action","none","important"),this.timeoutID=setTimeout(()=>{this.doStartDrag(e,t,s,i),r||(this.savedTargetNode=e.target,this.savedTargetNode.style.cssText=`
          position: absolute;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden;
          clip: rect(1px 1px 1px 1px);
          clip: rect(1px, 1px, 1px, 1px);
        `,this.savedTargetNodeParent=this.savedTargetNode.parentElement,this.savedTargetNodeIndex=this.getNodeIndexInParent(this.savedTargetNode),this.rootElement.appendChild(this.savedTargetNode)),this.stopLongTap()},this.longTap?500:0),document.addEventListener("pointerup",this.stopLongTap),document.addEventListener("pointermove",this.stopLongTapIfMoveEnough)}moveShortcutElement(e){let t=this.viewRootElement.getBoundingClientRect().x,s=this.viewRootElement.getBoundingClientRect().y,i=this.viewRootElement.scrollLeft,r=this.viewRootElement.scrollTop;this.doScroll(e.clientY,e.clientX);const a=this.draggedElementShortcut.offsetHeight,o=this.draggedElementShortcut.offsetWidth;let l=this.draggedElementShortcut.shortcutXOffset||o/2,u=this.draggedElementShortcut.shortcutYOffset||a/2;document.querySelectorAll("[dir='rtl']").length!==0&&(l=o/2,u=a/2);const d=document.documentElement.clientHeight,h=document.documentElement.clientWidth,f=e.pageX,C=e.pageY,b=e.clientX,x=e.clientY;t-=i,s-=r;const V=this.getShortcutBottomCoordinate(x,a,u);if(this.getShortcutRightCoordinate(b,o,l)>=h){this.draggedElementShortcut.style.left=h-o-t+"px",this.draggedElementShortcut.style.top=x-u-s+"px";return}if(b-l<=0){this.draggedElementShortcut.style.left=f-b-t+"px",this.draggedElementShortcut.style.top=x-s-u+"px";return}if(V>=d){this.draggedElementShortcut.style.left=b-l-t+"px",this.draggedElementShortcut.style.top=d-a-s+"px";return}if(x-u<=0){this.draggedElementShortcut.style.left=b-l-t+"px",this.draggedElementShortcut.style.top=C-x-s+"px";return}this.draggedElementShortcut.style.left=b-t-l+"px",this.draggedElementShortcut.style.top=x-s-u+"px"}getShortcutBottomCoordinate(e,t,s){return e+t-s}getShortcutRightCoordinate(e,t,s){return e+t-s}requestAnimationFrame(e){return requestAnimationFrame(e)}scrollByDrag(e,t,s){let r,a,o,l;e.tagName==="HTML"?(r=0,a=document.documentElement.clientHeight,o=0,l=document.documentElement.clientWidth):(r=e.getBoundingClientRect().top,a=e.getBoundingClientRect().bottom,o=e.getBoundingClientRect().left,l=e.getBoundingClientRect().right);const u=()=>{const d=t-r<=100,h=a-t<=100,f=s-o<=100,C=l-s<=100;d&&!f&&!C?e.scrollTop-=15:h&&!f&&!C?e.scrollTop+=15:C&&!d&&!h?e.scrollLeft+=15:f&&!d&&!h&&(e.scrollLeft-=15),this.scrollIntervalId=this.requestAnimationFrame(u)};this.scrollIntervalId=this.requestAnimationFrame(u)}doScroll(e,t){cancelAnimationFrame(this.scrollIntervalId);const s=this.draggedElementShortcut.style.display;this.draggedElementShortcut.style.display="none";let i=this.documentOrShadowRoot.elementFromPoint(t,e);this.draggedElementShortcut.style.display=s||"block";let r=Zo(i);this.scrollByDrag(r,e,t)}doStartDrag(e,t,s,i){vt&&(qr.PreventScrolling=!0),e.which!==3&&(this.dd.dragInit(e,t,s,i),this.rootElement.append(this.draggedElementShortcut),this.moveShortcutElement(e),document.addEventListener("pointermove",this.dragOver),document.addEventListener("pointercancel",this.handlePointerCancel),document.addEventListener("keydown",this.handleEscapeButton),document.addEventListener("pointerup",this.drop),vt?this.draggedElementShortcut.addEventListener("contextmenu",this.onContextMenu):this.draggedElementShortcut.addEventListener("pointerup",this.drop))}returnUserSelectBack(){document.body.style.setProperty("touch-action","auto"),document.body.style.setProperty("user-select","auto"),document.body.style.setProperty("-webkit-user-select","auto")}startDrag(e,t,s,i,r=!1){if(document.body.style.setProperty("user-select","none","important"),document.body.style.setProperty("-webkit-user-select","none","important"),vt){this.startLongTapProcessing(e,t,s,i,r);return}this.doStartDrag(e,t,s,i)}getNodeIndexInParent(e){return[...e.parentElement.childNodes].indexOf(e)}insertNodeToParentAtIndex(e,t,s){e.insertBefore(t,e.childNodes[s])}}qr.PreventScrolling=!1;class k1{get isBottom(){return!!this._isBottom}set isBottom(e){this._isBottom=e,this.ghostPositionChanged()}ghostPositionChanged(){this.onGhostPositionChanged.fire({},{})}get dropTargetDataAttributeName(){return`[data-sv-drop-target-${this.draggedElementType}]`}get survey(){var e;return this.surveyValue||((e=this.creator)===null||e===void 0?void 0:e.survey)}constructor(e,t,s,i){var r;this.surveyValue=e,this.creator=t,this._isBottom=null,this.onGhostPositionChanged=new Xt,this.onDragStart=new Xt,this.onDragEnd=new Xt,this.onDragClear=new Xt,this.onBeforeDrop=this.onDragStart,this.onAfterDrop=this.onDragEnd,this.draggedElement=null,this.dropTarget=null,this.prevDropTarget=null,this.allowDropHere=!1,this.banDropHere=()=>{this.allowDropHere=!1,this.doBanDropHere(),this.dropTarget=null,this.domAdapter.draggedElementShortcut.style.cursor="not-allowed",this.isBottom=null},this.doBanDropHere=()=>{},this.domAdapter=i||new qr(this,s,(r=this.survey)===null||r===void 0?void 0:r.fitToContainer)}startDrag(e,t,s,i,r=!1){this.domAdapter.rootContainer=this.getRootElement(this.survey,this.creator),this.domAdapter.startDrag(e,t,s,i,r)}getRootElement(e,t){return t?t.rootElement:e.rootElement}dragInit(e,t,s,i){this.draggedElement=t,this.parentElement=s;const r=this.getShortcutText(this.draggedElement);this.domAdapter.draggedElementShortcut=this.createDraggedElementShortcut(r,i,e),this.onStartDrag(e);const a=this.draggedElement&&this.draggedElement.parent;this.onDragStart.fire(this,{fromElement:a,draggedElement:this.draggedElement})}onStartDrag(e){}isDropTargetDoesntChanged(e){return this.dropTarget===this.prevDropTarget&&e===this.isBottom}getShortcutText(e){return e?.shortcutText}createDraggedElementShortcut(e,t,s){const i=oe.createElement("div");return i&&(i.innerText=e,i.className=this.getDraggedElementClass()),i}getDraggedElementClass(){return"sv-dragged-element-shortcut"}doDragOver(){}afterDragOver(e){}findDropTargetNodeFromPoint(e,t){const s=this.domAdapter.draggedElementShortcut.style.display;if(this.domAdapter.draggedElementShortcut.style.display="none",!oe.isAvailable())return null;let i=this.domAdapter.documentOrShadowRoot.elementsFromPoint(e,t);this.domAdapter.draggedElementShortcut.style.display=s||"block";let r=0,a=i[r];for(;a&&a.className&&typeof a.className.indexOf=="function"&&a.className.indexOf("sv-drag-target-skipped")!=-1;)r++,a=i[r];return a?this.findDropTargetNodeByDragOverNode(a):null}getDataAttributeValueByNode(e){let t="svDropTarget";return this.draggedElementType.split("-").forEach(i=>{t+=this.capitalizeFirstLetter(i)}),e.dataset[t]}getDropTargetByNode(e,t){let s=this.getDataAttributeValueByNode(e);return this.getDropTargetByDataAttributeValue(s,e,t)}capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}calculateVerticalMiddleOfHTMLElement(e){const t=e.getBoundingClientRect();return t.y+t.height/2}calculateHorizontalMiddleOfHTMLElement(e){const t=e.getBoundingClientRect();return t.x+t.width/2}calculateIsBottom(e,t){return!1}findDropTargetNodeByDragOverNode(e){return e.closest(this.dropTargetDataAttributeName)}dragOver(e){const t=this.findDropTargetNodeFromPoint(e.clientX,e.clientY);if(!t){this.banDropHere();return}this.dropTarget=this.getDropTargetByNode(t,e);const s=this.isDropTargetValid(this.dropTarget,t);if(this.doDragOver(),!s){this.banDropHere();return}let i=this.calculateIsBottom(e.clientY,t);this.allowDropHere=!0,!this.isDropTargetDoesntChanged(i)&&(this.isBottom=null,this.isBottom=i,this.draggedElement!=this.dropTarget&&this.afterDragOver(t),this.prevDropTarget=this.dropTarget)}drop(){if(this.allowDropHere){const e=this.draggedElement.parent,t=this.doDrop();this.onDragEnd.fire(this,{fromElement:e,draggedElement:t,toElement:this.dropTarget})}}clear(){const e={draggedElement:this.draggedElement};this.dropTarget=null,this.prevDropTarget=null,this.draggedElement=null,this.isBottom=null,this.parentElement=null,this.onDragClear.fire(this,e)}}class d_ extends k1{constructor(){super(...arguments),this.dropIsBanned=!1,this.matrixRowMap={},this.fromIndex=null,this.toIndex=null,this.toMatrix=null,this.expandCollapseTimer=null,this.expandCollapseHandlingRow=null,this.doBanDropHere=()=>{this.dropIsBanned||(this.removeGhost(),this.parentElement.renderedTable.rows.splice(this.initialDraggedElementIndex,0,this.draggedRenderedRow),this.dropIsBanned=!0,this.lastDropTargetParentElement=this.parentElement)},this.doDrop=()=>{if(this.parentElement==this.toMatrix)this.fromIndex<this.toIndex&&this.toIndex--,this.parentElement.moveRowByIndex(this.fromIndex,this.toIndex);else if(this.toMatrix){const e=Object.assign({},this.parentElement.value[this.fromIndex]);this.parentElement.removeRowByIndex(this.fromIndex),this.toMatrix.addRowByIndex(e,this.toIndex)}return this.parentElement}}get draggedElementType(){return"matrix-row"}patchUserSelect(){const e=oe.getBody();e&&(this.restoreUserSelectValue=e.style.userSelect,e.style.userSelect="none")}onStartDrag(){this.patchUserSelect();const e=this.parentElement.renderedTable.rows;let t=e.findIndex(i=>i.row===this.draggedElement);t>=0&&(this.draggedRenderedRow=e[t],this.initialDraggedElementIndex=t,this.draggedRenderedRow.isGhostRow=!0,this.lastDropTargetParentElement=this.parentElement);const s=[];this.survey.onMatrixRowDragOver.isEmpty?s.push(this.parentElement):this.fillMatricies(this.survey.getAllQuestions(),s),this.fillMatrixRowMap(s),this.fromIndex=this.parentElement.visibleRows.indexOf(this.draggedElement)}fillMatricies(e,t){e.filter(i=>i.isDescendantOf("matrixdynamic")&&i.allowRowReorder).forEach(i=>{t.push(i),i.detailPanelMode!=="none"&&i.visibleRows.forEach(r=>{r.isDetailPanelShowing&&this.fillMatricies(r.questions,t)})})}fillMatrixRowMap(e){e.forEach(t=>{t.visibleRows.forEach(s=>{this.matrixRowMap[s.id]={row:s,matrix:t}}),t.visibleRows.length==0&&(this.matrixRowMap[t.id]={row:t,matrix:t})})}get shortcutClass(){return new j().append(this.parentElement.cssClasses.draggedRow).toString()}createDraggedElementShortcut(e,t,s){const i=oe.createElement("div");if(!i)return;i.className=this.shortcutClass;const r=!0;if(t){const a=t.closest("[data-sv-drop-target-matrix-row]"),o=a.cloneNode(r);o.style.cssText=`
        width: ${a.offsetWidth}px;
      `,o.classList.remove("sv-matrix__drag-drop--moveup"),o.classList.remove("sv-matrix__drag-drop--movedown"),this.draggedElement.isDragDropMoveDown=!1,this.draggedElement.isDragDropMoveUp=!1,i.appendChild(o);const l=t.getBoundingClientRect();i.shortcutXOffset=s.clientX-l.x,i.shortcutYOffset=s.clientY-l.y}return i}getDropTargetByDataAttributeValue(e){const t=this.matrixRowMap[e];return t?.row||t?.matrix}canInsertIntoThisRow(e){const t=this.parentElement.lockedRowCount;return t<=0||e.rowIndex>t}isDropTargetValid(e,t){return this.canInsertIntoThisRow(e)}calculateIsBottom(e,t){if(!!t.dataset.svDropTargetMatrix)return!0;const i=t.getBoundingClientRect();return e>=i.y+i.height/2}doDragOver(){var e,t,s,i,r,a,o,l;if(!this.survey.onMatrixRowDragOver.isEmpty&&this.dropTarget&&typeof this.dropTarget.isDetailPanelShowing<"u"&&this.dropTarget.isDetailPanelShowing===!1){const u=this.dropTarget,d=u.data,h=d.renderedTable.rows.filter(b=>b.row==u)[0],f=(i=(s=(t=(e=h?.cells[1])===null||e===void 0?void 0:e.item)===null||t===void 0?void 0:t.value)===null||s===void 0?void 0:s.actions)===null||i===void 0?void 0:i.filter(b=>b.id=="show-detail")[0],C=(l=(o=(a=(r=h?.cells[h.cells.length-1])===null||r===void 0?void 0:r.item)===null||a===void 0?void 0:a.value)===null||o===void 0?void 0:o.actions)===null||l===void 0?void 0:l.filter(b=>b.id=="show-detail")[0];f?.visible||C?.visible?this.expandCollapseHandlingRow!==u.id&&(this.expandCollapseHandlingRow=u.id,this.clearExpandCollapseTimeout(),this.expandCollapseTimer=setTimeout(()=>{const b=[];u.showDetailPanel(),this.fillMatricies([d],b),this.fillMatrixRowMap(b)},500)):this.clearExpandCollapseTimeout()}}removeGhost(){const e=this.lastDropTargetParentElement.renderedTable.rows,t=e.indexOf(this.draggedRenderedRow);t>=0&&e.splice(t,1)}afterDragOver(e){if(!this.dropTarget)return;const t=this.matrixRowMap[this.dropTarget.id].matrix,s=this.matrixRowMap[this.dropTarget.id].row,i=this.isBottom&&!s.isDetailPanelShowing?1:0;let r=0;const a={allow:t==this.parentElement,row:s,fromMatrix:this.parentElement,toMatrix:t};if(this.survey.onMatrixRowDragOver.fire(this.survey,a),!a.allow)return;this.removeGhost(),this.lastDropTargetParentElement=t;const o=t.renderedTable.rows;if(t.visibleRows.length>0){const l=o.findIndex(u=>u.row==this.dropTarget);l>=0&&o.splice(l+i,0,this.draggedRenderedRow),r=t.visibleRows.indexOf(this.dropTarget)+i}else t.renderedTable.headerRow||(o[0].cells[0].colSpans=this.draggedRenderedRow.cells.length),o.splice(0,0,this.draggedRenderedRow);this.toIndex=r,this.toMatrix=t,this.dropIsBanned=!1,super.ghostPositionChanged()}clear(){this.matrixRowMap={},this.parentElement.renderedTable.rows.forEach(s=>{s.isGhostRow=!1}),this.parentElement.clearOnDrop(),this.toMatrix&&this.toMatrix.clearOnDrop(),this.fromIndex=null,this.toIndex=null;const t=oe.getBody();t&&(t.style.userSelect=this.restoreUserSelectValue||"initial"),super.clear(),this.clearExpandCollapseTimeout()}clearExpandCollapseTimeout(){clearTimeout(this.expandCollapseTimer),this.expandCollapseTimer=null,this.expandCollapseHandlingRow=null}}class Od{constructor(e,t=!0){this.dragHandler=e,this.preventOnTouch=t,this.onPointerUp=s=>{this.clearListeners()},this.tryToStartDrag=s=>{if(this.currentX=s.pageX,this.currentY=s.pageY,!this.isMicroMovement)return this.clearListeners(),this.dragHandler(this.pointerDownEvent,this.targets,this.itemModel),!0}}onPointerDown(e,t){if(this.targets={currentTarget:e.currentTarget,target:e.target},vt&&this.preventOnTouch){this.dragHandler(e,this.targets,t);return}this.pointerDownEvent=e,this.startX=e.pageX,this.startY=e.pageY,this.targets.currentTarget.getRootNode().addEventListener("pointermove",this.tryToStartDrag),this.targets.currentTarget.addEventListener("pointerup",this.onPointerUp),this.itemModel=t}get isMicroMovement(){const t=Math.abs(this.currentX-this.startX),s=Math.abs(this.currentY-this.startY);return t<10&&s<10}clearListeners(){this.pointerDownEvent&&(this.targets.currentTarget.getRootNode().removeEventListener("pointermove",this.tryToStartDrag),this.targets.currentTarget.removeEventListener("pointerup",this.onPointerUp))}}class N1{constructor(e,t,s){this.locText=e,this.btnEdit=t,this.btnRemove=s}get showRemove(){return!!this.btnRemove}}class q1{constructor(e,t){this.question=e,this.noEntry=t,this.items=[]}isEmpty(){return this.items.length==0}dispose(){this.items.forEach(e=>{var t,s;(t=e.btnEdit)===null||t===void 0||t.dispose(),(s=e.btnRemove)===null||s===void 0||s.dispose()})}}class c_ extends il{constructor(e){super(e),this.question=e}getValue(e,t,s,i){if(!i&&this.question.isEmpty())return{isFound:e.length===0,value:void 0};if(s>-1){const a=this.question.allRows;return s>=0&&s<a.length?a[s].getValueGetterContext().getValue(e,!1,s,i):{isFound:!1,value:void 0,context:this}}return super.getValue(e,t,s,i)}}class p_ extends ki{constructor(e,t,s){super(t,s),this.index=e,this.buildCells(s)}getRowIndex(){const e=super.getRowIndex();return e>0?e:this.index+1}get rowName(){return this.id}get dataName(){return"row"+(this.index+1)}get text(){return"row "+(this.visibleIndex+1)}getAccessbilityText(){return(this.visibleIndex+1).toString()}get shortcutText(){const t=this.data.visibleRows.indexOf(this)+1,s=this.cells.length>1?this.cells[1].questionValue:void 0,i=this.cells.length>0?this.cells[0].questionValue:void 0;return s&&s.value||i&&i.value||""+t}}class B1 extends Sn{constructor(e){super(e),this.rowCounter=0,this.setRowCountValueFromData=!1,this.startDragMatrixRow=(t,s)=>{this.dragDropMatrixRows.startDrag(t,this.draggedRow,this,s.target)},this.initialRowCount=this.getDefaultPropertyValue("rowCount"),this.createLocString({name:"confirmDeleteText",translationKey:"confirmDelete"}),this.createLocalizableString("addRowText").onGetTextCallback=t=>t||this.defaultAddRowText,this.createLocString({name:"removeRowText",translationKey:"removeRow"}),this.createLocString({name:"noRowsText",hasTranslation:!0}),this.createLocString({name:"editRowText",translationKey:"editText"}),this.registerPropertyChangedHandlers(["hideColumnsIfEmpty","allowAddRows"],()=>{this.updateShowTableAndAddRow()}),this.registerPropertyChangedHandlers(["allowRowReorder","isReadOnly","lockedRowCount"],()=>{this.resetRenderedTable()}),this.registerPropertyChangedHandlers(["minRowCount"],()=>{this.onMinRowCountChanged()}),this.registerPropertyChangedHandlers(["maxRowCount"],()=>{this.onMaxRowCountChanged()}),this.dragOrClickHelper=new Od(this.startDragMatrixRow)}setSurveyImpl(e,t){super.setSurveyImpl(e,t),this.dragDropMatrixRows=new d_(this.survey,null,!0)}isBanStartDrag(e){const t=e.target;return t.getAttribute("contenteditable")==="true"||t.nodeName==="INPUT"||!this.isDragHandleAreaValid(t)}isDragHandleAreaValid(e){return this.survey.matrixDragHandleArea==="icon"?e.classList.contains(this.cssClasses.dragElementDecorator):!0}onPointerDown(e,t){!t||!this.isRowsDragAndDrop||this.isDesignMode||this.isBanStartDrag(e)||t.isDetailPanelShowing||(this.draggedRow=t,this.dragOrClickHelper.onPointerDown(e))}getType(){return"matrixdynamic"}get isRowsDynamic(){return!0}get confirmDelete(){return this.getPropertyValue("confirmDelete")}set confirmDelete(e){this.setPropertyValue("confirmDelete",e)}get isValueArray(){return!0}get keyName(){return this.getPropertyValue("keyName","")}set keyName(e){this.setPropertyValue("keyName",e)}get defaultRowValue(){return this.getPropertyValue("defaultRowValue")}set defaultRowValue(e){this.setPropertyValue("defaultRowValue",e)}get copyDefaultValueFromLastEntry(){return this.getPropertyValue("copyDefaultValueFromLastEntry")}set copyDefaultValueFromLastEntry(e){this.setPropertyValue("copyDefaultValueFromLastEntry",e)}get defaultValueFromLastRow(){return this.copyDefaultValueFromLastEntry}set defaultValueFromLastRow(e){this.copyDefaultValueFromLastEntry=e}isDefaultValueEmpty(){return super.isDefaultValueEmpty()&&this.isValueEmpty(this.defaultRowValue)}valueFromData(e){return this.minRowCount<1||this.isEmpty()?super.valueFromData(e):this.correctValueForMinMaxRows(e)}correctValueForMinMaxRows(e){Array.isArray(e)||(e=[]);for(var t=e.length;t<this.minRowCount;t++)e.push({});return e}isNewValueCorrect(e){return Array.isArray(e)}setDefaultValue(){if(this.isValueEmpty(this.defaultRowValue)||!this.isValueEmpty(this.defaultValue)){super.setDefaultValue();return}if(!(!this.isEmpty()||this.rowCount==0)){for(var e=[],t=0;t<this.rowCount;t++)e.push(this.defaultRowValue);this.value=e}}moveRowByIndex(e,t){const s=this.createNewValue(),i=Math.max(e,t);if(!Array.isArray(s)&&i>=s.length)return;const r=s[e];s.splice(e,1),s.splice(t,0,r);const a=this.generatedVisibleRows;if(Array.isArray(a)&&i<a.length){const o=a[t],l=a[e];if(this.getIsDetailPanelShowing(l)!==this.getIsDetailPanelShowing(o)){const u=this.getIsDetailPanelShowing(o);this.setIsDetailPanelShowing(o,this.getIsDetailPanelShowing(l)),this.setIsDetailPanelShowing(l,u)}}this.value=s}addRowByIndex(e,t){const s=this.createNewValue();!Array.isArray(s)&&t>=s.length||(s.splice(t,0,e),this.rowCount++,this.value=s)}removeRowByIndex(e){const t=this.createNewValue();!Array.isArray(t)&&e>=t.length||(t.splice(e,1),this.rowCount--,this.value=t)}clearOnDrop(){this.isEditingSurveyElement||this.resetRenderedTable()}initDataUI(){this.generatedVisibleRows||this.getVisibleRows()}get rowCount(){return this.rowCountValue}set rowCount(e){if(e=L.getNumber(e),!(e<0||e>D.matrix.maxRowCount||e===this.rowCount)){this.setRowCountValueFromData=!1;var t=this.rowCountValue;if(this.rowCountValue=e,this.value&&this.value.length>e){var s=this.value;s.splice(e),this.value=s}if(this.isUpdateLocked){this.initialRowCount=e;return}if(this.generatedVisibleRows||t==0){this.generatedVisibleRows||(this.clearGeneratedRows(),this.generatedVisibleRows=[]),this.generatedVisibleRows.splice(e);for(var i=t;i<e;i++){var r=this.createMatrixRow(this.getValueForNewRow());this.generatedVisibleRows.push(r),this.onMatrixRowCreated(r)}this.runCondition(this.getDataFilteredProperties())}this.onRowsChanged()}}updateBindingProp(e,t){super.updateBindingProp(e,t);const s=this.generatedVisibleRows;if(e!=="rowCount"||!Array.isArray(s))return;const i=this.getUnbindValue(this.value)||[];if(i.length<s.length){let r=!1;for(let a=i.length;a<s.length;a++)r||(r=!s[a].isEmpty),i.push(s[a].value||{});r&&(this.value=i)}}updateProgressInfoByValues(e){let t=this.value;Array.isArray(t)||(t=[]);for(var s=0;s<this.rowCount;s++){const i=s<t.length?t[s]:{};this.updateProgressInfoByRow(e,i)}}getValueForNewRow(){var e=null;return this.onGetValueForNewRowCallBack&&(e=this.onGetValueForNewRowCallBack(this)),e}get allowRowReorder(){return this.getPropertyValue("allowRowReorder")}set allowRowReorder(e){this.setPropertyValue("allowRowReorder",e)}get allowRowsDragAndDrop(){return this.allowRowReorder}set allowRowsDragAndDrop(e){this.allowRowReorder=e}get allowRowDragIn(){var e,t;return!(!((t=(e=this.survey)===null||e===void 0?void 0:e.onMatrixRowDragOver)===null||t===void 0)&&t.isEmpty)}get isRowsDragAndDrop(){return this.allowRowReorder&&!this.isReadOnly}get lockedRowCount(){return this.getPropertyValue("lockedRowCount",0)}set lockedRowCount(e){this.setPropertyValue("lockedRowCount",e)}get iconDragElement(){return this.cssClasses.iconDragElement}createRenderedTable(){return new g_(this)}get rowCountValue(){return this.getPropertyValue("rowCount")}set rowCountValue(e){this.setPropertyValue("rowCount",e)}get minRowCount(){return this.getPropertyValue("minRowCount")}set minRowCount(e){e<0&&(e=0),this.setPropertyValue("minRowCount",e)}onMinRowCountChanged(){const e=this.minRowCount;e>this.maxRowCount&&(this.maxRowCount=e),this.initialRowCount<e&&(this.initialRowCount=e),this.rowCount<e&&(this.rowCount=e)}get maxRowCount(){return this.getPropertyValue("maxRowCount")}set maxRowCount(e){e<=0||(e>D.matrix.maxRowCount&&(e=D.matrix.maxRowCount),e!=this.maxRowCount&&this.setPropertyValue("maxRowCount",e))}onMaxRowCountChanged(){const e=this.maxRowCount;e<this.minRowCount&&(this.minRowCount=e),this.rowCount>e&&(this.rowCount=e)}get allowAddRows(){return this.getPropertyValue("allowAddRows")}set allowAddRows(e){this.setPropertyValue("allowAddRows",e)}get allowRemoveRows(){return this.getPropertyValue("allowRemoveRows")}set allowRemoveRows(e){this.setPropertyValue("allowRemoveRows",e),this.isUpdateLocked||this.resetRenderedTable()}get canAddRow(){return this.allowAddRows&&!this.isReadOnly&&this.rowCount<this.maxRowCount}get canRemoveRows(){var e=this.allowRemoveRows&&!this.isReadOnly&&this.rowCount>this.minRowCount;return this.canRemoveRowsCallback?this.canRemoveRowsCallback(e):e}canRemoveRow(e){if(!this.survey)return!0;const t=e.rowIndex-1;return this.lockedRowCount>0&&t<this.lockedRowCount?!1:this.survey.matrixAllowRemoveRow(this,t,e)}addRowUI(){this.addRow(!0)}getQuestionToFocusOnAddingRow(){if(this.visibleRows.length===0)return null;for(var e=this.visibleRows[this.visibleRows.length-1],t=0;t<e.cells.length;t++){var s=e.cells[t].question;if(s&&s.isVisible&&!s.isReadOnly)return s}return null}addRow(e){const t=this.rowCount,s=this.canAddRow;var i={question:this,canAddRow:s,allow:s};if(this.survey&&this.survey.matrixBeforeRowAdded(i),!!(s!==i.allow?i.allow:s!==i.canAddRow?i.canAddRow:s)&&(this.onStartRowAddingRemoving(),this.addRowCore(),this.onEndRowAdding(),this.singleInputOnAddItem(!1),this.detailPanelShowOnAdding&&this.visibleRows.length>0&&this.visibleRows[this.visibleRows.length-1].showDetailPanel(),e&&t!==this.rowCount)){const a=this.getQuestionToFocusOnAddingRow();a&&a.focus()}}get detailPanelShowOnAdding(){return this.getPropertyValue("detailPanelShowOnAdding")}set detailPanelShowOnAdding(e){this.setPropertyValue("detailPanelShowOnAdding",e)}hasRowsAsItems(){return!1}unbindValue(){this.clearGeneratedRows(),this.clearPropertyValue("value"),this.rowCountValue=0,super.unbindValue()}isValueSurveyElement(e){return this.isEditingSurveyElement||super.isValueSurveyElement(e)}addRowCore(){var e=this.rowCount;this.rowCount=this.rowCount+1;var t=this.getDefaultRowValue(!0),s=null;if(this.isValueEmpty(t)||(s=this.createNewValue(),s.length==this.rowCount&&(s[s.length-1]=t,this.value=s)),this.data){this.runCellsCondition(this.getDataFilteredProperties());const i=this.generatedVisibleRows;if(this.isValueEmpty(t)&&i.length>0){const r=i[i.length-1];this.isValueEmpty(r.value)||(s||(s=this.createNewValue()),!this.isValueSurveyElement(s)&&!this.isTwoValueEquals(s[s.length-1],r.value)&&(s[s.length-1]=r.value,this.value=s))}}if(this.survey){const i=this.visibleRows;if(e+1==this.rowCount&&i.length>0){const r=i[i.length-1];this.survey.matrixRowAdded(this,r),this.onRowsChanged()}}}getDefaultRowValue(e){for(var t=null,s=0;s<this.columns.length;s++){var i=this.columns[s].templateQuestion;i&&!this.isValueEmpty(i.getDefaultValue())&&(t=t||{},t[this.columns[s].name]=i.getDefaultValue())}if(!this.isValueEmpty(this.defaultRowValue))for(var r in this.defaultRowValue)t=t||{},t[r]=this.defaultRowValue[r];if(e&&this.copyDefaultValueFromLastEntry){var a=this.value;if(a&&Array.isArray(a)&&a.length>=this.rowCount-1){var o=a[this.rowCount-2];for(var r in o)t=t||{},t[r]=o[r]}}return t}focusAddBUtton(){const e=this.getRootElement();if(e&&this.cssClasses.buttonAdd){const t=e.querySelectorAll("."+this.cssClasses.buttonAdd)[0];t&&t.focus()}}getActionCellIndex(e){const t=this.showHeader?1:0;return this.isColumnLayoutHorizontal?e.cells.length:this.visibleRows.indexOf(e)+t}removeRowUI(e){if(e&&e.rowName){var t=this.visibleRows.indexOf(e);if(t<0)return;e=t}this.removeRow(e,void 0,()=>{const s=this.visibleRows.length,i=t>=s?s-1:t,r=i>-1?this.visibleRows[i]:void 0;setTimeout(()=>{r?this.renderedTable.focusActionCell(r,this.getActionCellIndex(r)):this.focusAddBUtton()},10)})}isRequireConfirmOnRowDelete(e){if(!this.confirmDelete||e<0||e>=this.rowCount)return!1;var t=this.createNewValue();return this.isValueEmpty(t)||!Array.isArray(t)||e>=t.length?!1:!this.isValueEmpty(t[e])}removeRow(e,t,s){if(this.canRemoveRows&&!(e<0||e>=this.rowCount)){var i=this.visibleRows&&e<this.visibleRows.length?this.visibleRows[e]:null;if(t===void 0&&(t=this.isRequireConfirmOnRowDelete(e)),t){Go({message:this.confirmDeleteText,funcOnYes:()=>{this.removeRowAsync(e,i),s&&s()},locale:this.getLocale(),rootElement:this.survey.rootElement,cssClass:this.cssClasses.confirmDialog});return}this.removeRowAsync(e,i),s&&s()}}removeRowAsync(e,t){t&&this.survey&&!this.survey.matrixRowRemoving(this,e,t)||(this.onStartRowAddingRemoving(),this.removeRowCore(e),this.singleInputOnRemoveItem(e),this.onEndRowRemoving(t))}removeRowCore(e){var t=this.visibleRows?this.visibleRows[e]:null;if(e=this.generatedVisibleRows.indexOf(t),!(e<0)){if(this.generatedVisibleRows&&e<this.generatedVisibleRows.length&&this.generatedVisibleRows.splice(e,1),this.rowCountValue--,this.value){var s=[];Array.isArray(this.value)&&e<this.value.length?s=this.createValueCopy():s=this.createNewValue(),s.splice(e,1),s=this.deleteRowValue(s,null),this.isRowChanging=!0,this.value=s,this.isRowChanging=!1}this.onRowsChanged(),this.survey&&this.survey.matrixRowRemoved(this,e,t)}}onSingleInputQuestionAdded(e){this.showHeader||(e.titleLocation="hidden")}getSingleInputQuestionsCore(e,t){const s=new Array,i=this.visibleRows;if(t)for(let r=0;r<i.length;r++){const a=i[r];(!a.hasValueAnyQuestion(!0)||!a.validate(new kr))&&this.fillSingleInputQuestionsByRow(s,a)}return this.getSingleInputQuestionsForDynamic(e,s)}fillSingleInputQuestionsInContainer(e,t){const s=this.getRowByQuestion(t);this.fillSingleInputQuestionsByRow(e,s)}fillSingleInputQuestionsByRow(e,t){t&&t.questions.forEach(s=>s.addNestedQuestion(e,!0,!1,!1))}getSingleInputAddTextCore(){if(this.canAddRow)return this.addRowText}singleInputAddItemCore(){this.addRowUI()}getSingleQuestionOnChange(e){const t=this.visibleRows;if(t.length>0){(e<0||e>=t.length)&&(e=t.length-1);const i=t[e].visibleQuestions;if(i.length>0)return i[0]}return null}createSingleInputSummary(){const e=new q1(this,this.locNoRowsText),t=new Array,s=this.canRemoveRows;return this.visibleRows.forEach(i=>{const r=new wt(new O1(this,i),!0,void 0,this.getSingleInputTitleTemplate());r.setJson(this.locSingleInputTitleTemplate.getJson());const a=new xe({locTitle:this.getLocalizableString("editRowText"),action:()=>{this.singleInputEditRow(i)}}),o=s&&this.canRemoveRow(i)?new xe({locTitle:this.locRemoveRowText,action:()=>{this.removeRowUI(i)}}):void 0;t.push(new N1(r,a,o))}),e.items=t,e}get confirmDeleteText(){return this.getLocalizableStringText("confirmDeleteText")}set confirmDeleteText(e){this.setLocalizableStringText("confirmDeleteText",e)}get locConfirmDeleteText(){return this.getLocalizableString("confirmDeleteText")}get addRowText(){return this.getLocalizableStringText("addRowText",this.defaultAddRowText)}set addRowText(e){this.setLocalizableStringText("addRowText",e)}get locAddRowText(){return this.getLocalizableString("addRowText")}get defaultAddRowText(){return this.getLocalizationString(this.isColumnLayoutHorizontal?"addRow":"addColumn")}getSingleInputTitleTemplate(){return"rowIndexTemplateTitle"}get addRowButtonLocation(){return this.getPropertyValue("addRowButtonLocation")}set addRowButtonLocation(e){this.setPropertyValue("addRowButtonLocation",e)}get addRowLocation(){return this.addRowButtonLocation}set addRowLocation(e){this.addRowButtonLocation=e}getAddRowLocation(){return this.addRowButtonLocation}get hideColumnsIfEmpty(){return this.getPropertyValue("hideColumnsIfEmpty")}set hideColumnsIfEmpty(e){this.setPropertyValue("hideColumnsIfEmpty",e)}getShowColumnsIfEmpty(){return this.hideColumnsIfEmpty}get removeRowText(){return this.getLocalizableStringText("removeRowText")}set removeRowText(e){this.setLocalizableStringText("removeRowText",e)}get locRemoveRowText(){return this.getLocalizableString("removeRowText")}get noRowsText(){return this.getLocalizableStringText("noRowsText")}set noRowsText(e){this.setLocalizableStringText("noRowsText",e)}get locNoRowsText(){return this.getLocalizableString("noRowsText")}get emptyRowsText(){return this.noRowsText}set emptyRowsText(e){this.noRowsText=e}get locEmptyRowsText(){return this.locNoRowsText}getValueGetterContext(){return new c_(this)}getDisplayValueCore(e,t){if(!t||!Array.isArray(t))return t;for(var s=this.getUnbindValue(t),i=this.visibleRows,r=0;r<i.length&&r<s.length;r++){var a=s[r];a&&(s[r]=this.getRowDisplayValue(e,i[r],a))}return s}getConditionObjectRowName(e){return"["+e.toString()+"]"}getConditionObjectsRowIndeces(){const e=[],t=Math.max(this.rowCount,1);for(var s=0;s<Math.min(D.matrix.maxRowCountInCondition,t);s++)e.push(s);return e}supportAutoAdvance(){return!1}get hasRowText(){return!1}onCheckForErrors(e,t,s){super.onCheckForErrors(e,t,s),!t&&!this.validateMinRows()&&e.push(new BR(this.minRowCount,this))}validateMinRows(){if(this.minRowCount<=0||!this.isRequired||!this.generatedVisibleRows)return!0;let e=0;return this.generatedVisibleRows.forEach(t=>{t.isEmpty||e++}),e>=this.minRowCount}getUniqueColumnsNames(){var e=super.getUniqueColumnsNames();const t=this.keyName;return t&&e.indexOf(t)<0&&e.push(t),e}generateRows(){var e=new Array;if(this.rowCount===0)return e;for(var t=this.createNewValue(),s=0;s<this.rowCount;s++)e.push(this.createMatrixRow(this.getRowValueByIndex(t,s)));return this.isValueEmpty(this.getDefaultRowValue(!1))||(this.value=t),e}createMatrixRow(e){return new p_(this.rowCounter++,this,e)}getInsertedDeletedIndex(e,t){const s=Math.min(e.length,t.length);for(let i=0;i<s;i++)if(t[i]!==e[i].editingObj)return i;return s}isEditingObjectValueChanged(){const e=this.value;if(!this.generatedVisibleRows||!this.isValueSurveyElement(e))return!1;let t=this.lastDeletedRow;this.lastDeletedRow=void 0;const s=this.generatedVisibleRows;if(!Array.isArray(e)||Math.abs(s.length-e.length)>1||s.length===e.length)return!1;const i=this.getInsertedDeletedIndex(s,e);if(s.length>e.length){this.lastDeletedRow=s[i];const r=s[i];s.splice(i,1),this.isRendredTableCreated&&this.renderedTable.onRemovedRow(r)}else{let r;t&&t.editingObj===e[i]?r=t:(t=void 0,r=this.createMatrixRow(e[i])),s.splice(i,0,r),t||this.onMatrixRowCreated(r),this.isRendredTableCreated&&this.renderedTable.onAddedRow(r,i)}return this.setPropertyValueDirectly("rowCount",e.length),!0}updateValueFromSurvey(e,t=!1){if(this.setRowCountValueFromData=!0,this.minRowCount>0&&L.isValueEmpty(e)&&!L.isValueEmpty(this.defaultRowValue)){e=[];for(let s=0;s<this.minRowCount;s++)e.push(L.createCopy(this.defaultRowValue))}super.updateValueFromSurvey(e,t),this.setRowCountValueFromData=!1}getFilteredDataCore(){const e=[];return this.generatedVisibleRows.forEach(t=>{t.isVisible&&!t.isEmpty&&e.push(t.filteredValue)}),e}onBeforeValueChanged(e){if(!(!e||!Array.isArray(e))){var t=e.length;if(t!=this.rowCount&&!(!this.setRowCountValueFromData&&t<this.initialRowCount)&&!this.isEditingObjectValueChanged()&&(this.setRowCountValueFromData=!0,this.rowCountValue=t,!!this.generatedVisibleRows)){if(t==this.generatedVisibleRows.length+1){this.onStartRowAddingRemoving();const s=this.getRowValueByIndex(e,t-1),i=this.createMatrixRow(s);this.generatedVisibleRows.push(i),this.onMatrixRowCreated(i),this.onEndRowAdding()}else this.clearGeneratedRows(),this.getVisibleRows(),this.onRowsChanged();this.setRowCountValueFromData=!1}}}createNewValue(){var e=this.createValueCopy();(!e||!Array.isArray(e))&&(e=[]),e.length>this.rowCount&&e.splice(this.rowCount);var t=this.getDefaultRowValue(!1);t=t||{};for(var s=e.length;s<this.rowCount;s++)e.push(this.getUnbindValue(t));return e}deleteRowValue(e,t){if(!Array.isArray(e))return e;for(var s=!0,i=0;i<e.length;i++)if(this.isObject(e[i])&&Object.keys(e[i]).length>0){s=!1;break}return s?null:e}getRowValueByIndex(e,t){return Array.isArray(e)&&t>=0&&t<e.length?e[t]:null}getRowValueCore(e,t,s=!1){if(!this.generatedVisibleRows)return{};var i=this.getRowValueByIndex(t,this.generatedVisibleRows.indexOf(e));return!i&&s&&(i={}),i}getAddRowButtonCss(e=!1){return new j().append(this.cssClasses.button).append(this.cssClasses.buttonAdd).append(this.cssClasses.emptyRowsButton,e).toString()}getRemoveRowButtonCss(){return new j().append(this.cssClasses.button).append(this.cssClasses.buttonRemove).toString()}getRootCss(){var e;return new j().append(super.getRootCss()).append(this.cssClasses.empty,!(!((e=this.renderedTable)===null||e===void 0)&&e.showTable)).toString()}}class g_ extends ul{setDefaultRowActions(e,t){super.setDefaultRowActions(e,t)}}B.addClass("matrixdynamic",[{name:"allowAddRows:boolean",default:!0},{name:"allowRemoveRows:boolean",default:!0},{name:"rowCount:number",default:2,minValue:0,isBindable:!0},{name:"minRowCount:number",default:0,minValue:0},{name:"maxRowCount:number",default:D.matrix.maxRowCount},{name:"keyName"},"defaultRowValue:rowvalue",{name:"copyDefaultValueFromLastEntry:boolean",alternativeName:"defaultValueFromLastRow"},{name:"confirmDelete:boolean"},{name:"confirmDeleteText",dependsOn:"confirmDelete",visibleIf:function(n){return!n||n.confirmDelete},serializationProperty:"locConfirmDeleteText"},{name:"addRowButtonLocation",alternativeName:"addRowLocation",default:"default",choices:["default","top","bottom","topBottom"]},{name:"addRowText",serializationProperty:"locAddRowText"},{name:"removeRowText",serializationProperty:"locRemoveRowText"},"hideColumnsIfEmpty:boolean",{name:"noRowsText:text",alternativeName:"emptyRowsText",serializationProperty:"locNoRowsText",dependsOn:"hideColumnsIfEmpty",visibleIf:function(n){return!n||n.hideColumnsIfEmpty}},{name:"detailPanelShowOnAdding:boolean",dependsOn:"detailPanelMode",visibleIf:function(n){return n.detailPanelMode!=="none"}},{name:"allowRowReorder:switch",alternativeName:"allowRowsDragAndDrop"}],function(){return new B1("")},"matrixdropdownbase"),Qe.Instance.registerQuestion("matrixdynamic",n=>{var e=new B1(n);return e.choices=[1,2,3,4,5],Sn.addDefaultColumns(e),e});var Br={currentType:"default",getCss:function(){var n=this.currentType?this[this.currentType]:Md;return n||(n=Md),n},getAvailableThemes:function(){return Object.keys(this).filter(n=>["currentType","getCss","getAvailableThemes"].indexOf(n)===-1)}},Md={root:"sd-root-modern",rootProgress:"sd-progress",rootMobile:"sd-root-modern--mobile",rootAnimationDisabled:"sd-root-modern--animation-disabled",rootReadOnly:"sd-root--readonly",rootCompact:"sd-root--compact",rootFitToContainer:"sd-root-modern--full-container",rootWrapper:"sd-root-modern__wrapper",rootWrapperFixed:"sd-root-modern__wrapper--fixed",rootWrapperHasImage:"sd-root-modern__wrapper--has-image",rootBackgroundImage:"sd-root_background-image",container:"sd-container-modern",header:"sd-title sd-container-modern__title",bodyContainer:"sv-components-row",body:"sd-body",bodyWithTimer:"sd-body--with-timer",clockTimerRoot:"sd-timer",clockTimerRootTop:"sd-timer--top",clockTimerRootBottom:"sd-timer--bottom",clockTimerProgress:"sd-timer__progress",clockTimerProgressAnimation:"sd-timer__progress--animation",clockTimerTextContainer:"sd-timer__text-container",clockTimerMinorText:"sd-timer__text--minor",clockTimerMajorText:"sd-timer__text--major",bodyEmpty:"sd-body sd-body--empty",bodyLoading:"sd-body--loading",footer:"sd-footer sd-body__navigation sd-clearfix",title:"sd-title",description:"sd-description",logo:"sd-logo",logoImage:"sd-logo__image",headerText:"sd-header__text",headerClose:"sd-hidden",navigationButton:"",bodyNavigationButton:"sd-btn",completedPage:"sd-completedpage",completedBeforePage:"sd-completed-before-page",timerRoot:"sd-body__timer",navigation:{complete:"sd-btn--action sd-navigation__complete-btn",prev:"sd-navigation__prev-btn",next:"sd-navigation__next-btn",start:"sd-navigation__start-btn",preview:"sd-navigation__preview-btn",edit:"sd-btn sd-btn--small"},panel:{contentEnter:"sd-element__content--enter",contentLeave:"sd-element__content--leave",enter:"sd-element-wrapper--enter",leave:"sd-element-wrapper--leave",asPage:"sd-panel--as-page",number:"sd-element__num",title:"sd-title sd-element__title sd-panel__title",titleExpandable:"sd-element__title--expandable",titleExpandableSvg:"sd-element__title-expandable-svg",titleNumInline:"sd-element__title--num-inline",titleExpanded:"sd-element__title--expanded",titleCollapsed:"sd-element__title--collapsed",titleDisabled:"sd-element__title--disabled",titleOnExpand:"sd-panel__title--expanded",titleOnError:"sd-panel__title--error",titleBar:"sd-action-title-bar",description:"sd-description sd-panel__description",container:"sd-element sd-element--complex sd-panel sd-row__panel",withFrame:"sd-element--with-frame",content:"sd-element__content sd-panel__content",icon:"sd-panel__icon",iconExpanded:"sd-panel__icon--expanded",footer:"sd-panel__footer",requiredMark:"sd-panel__required-text",header:"sd-panel__header sd-element__header sd-element__header--location-top",collapsed:"sd-element--collapsed",expanded:"sd-element--expanded",expandable:"sd-element--expandable",expandableAnimating:"sd-elemenet--expandable--animating",nested:"sd-element--nested sd-element--nested-with-borders",invisible:"sd-element--invisible",navigationButton:"",compact:"sd-element--with-frame sd-element--compact",errorsContainer:"sd-panel__errbox sd-element__erbox sd-element__erbox--above-element"},paneldynamic:{mainRoot:"sd-element  sd-question sd-question--paneldynamic sd-element--complex sd-question--complex sd-row__question",empty:"sd-question--empty",root:"sd-paneldynamic",iconRemove:"sd-hidden",navigation:"sd-paneldynamic__navigation",title:"sd-title sd-element__title sd-question__title",header:"sd-paneldynamic__header sd-element__header",headerTab:"sd-paneldynamic__header-tab",button:"sd-action sd-paneldynamic__btn",buttonRemove:"sd-action--negative sd-paneldynamic__remove-btn",buttonAdd:"sd-paneldynamic__add-btn",buttonPrev:"sd-paneldynamic__prev-btn sd-action--icon sd-action",buttonPrevDisabled:"sd-action--disabled",buttonNextDisabled:"sd-action--disabled",buttonNext:"sd-paneldynamic__next-btn sd-action--icon sd-action",progressContainer:"sd-paneldynamic__progress-container",progress:"sd-progress",progressBar:"sd-progress__bar",nested:"sd-element--nested sd-element--nested-with-borders",progressText:"sd-paneldynamic__progress-text",separator:"sd-paneldynamic__separator",panelWrapper:"sd-paneldynamic__panel-wrapper",footer:"sd-paneldynamic__footer",panelFooter:"sd-paneldynamic__panel-footer",footerButtonsContainer:"sd-paneldynamic__buttons-container",panelsContainer:"sd-paneldynamic__panels-container",panelWrapperInRow:"sd-paneldynamic__panel-wrapper--in-row",panelWrapperEnter:"sd-paneldynamic__panel-wrapper--enter",panelWrapperLeave:"sd-paneldynamic__panel-wrapper--leave",panelWrapperList:"sd-paneldynamic__panel-wrapper--list",progressBtnIcon:"icon-progressbuttonv2",noEntriesPlaceholder:"sd-paneldynamic__placeholder sd-question__placeholder",compact:"sd-element--with-frame sd-element--compact",tabsContainer:"sd-paneldynamic__tabs-container",tabsContainerWithHeader:"sd-paneldynamic__tabs-container--with-header",tabsRoot:"sd-tabs-toolbar",tabsLeft:"sd-tabs-toolbar--left",tabsRight:"sd-tabs-toolbar--right",tabsCenter:"sd-tabs-toolbar--center",tabs:{item:"sd-tab-item",itemPressed:"sd-tab-item--pressed",itemAsIcon:"sd-tab-item--icon",itemIcon:"sd-tab-item__icon",itemTitle:"sd-tab-item__title"}},progress:"sd-progress sd-body__progress",progressTop:"sd-body__progress--top",progressBottom:"sd-body__progress--bottom",progressBar:"sd-progress__bar",progressText:"sd-progress__text",progressButtonsRoot:"sd-progress-buttons",progressButtonsNumbered:"sd-progress-buttons--numbered",progressButtonsFitSurveyWidth:"sd-progress-buttons--fit-survey-width",progressButtonsContainerCenter:"sd-progress-buttons__container-center",progressButtonsContainer:"sd-progress-buttons__container",progressButtonsConnector:"sd-progress-buttons__connector",progressButtonsButton:"sd-progress-buttons__button",progressButtonsButtonBackground:"sd-progress-buttons__button-background",progressButtonsButtonContent:"sd-progress-buttons__button-content",progressButtonsHeader:"sd-progress-buttons__header",progressButtonsFooter:"sd-progress-buttons__footer",progressButtonsImageButtonLeft:"sd-progress-buttons__image-button-left",progressButtonsImageButtonRight:"sd-progress-buttons__image-button-right",progressButtonsImageButtonHidden:"sd-progress-buttons__image-button--hidden",progressButtonsListContainer:"sd-progress-buttons__list-container",progressButtonsList:"sd-progress-buttons__list",progressButtonsListElementPassed:"sd-progress-buttons__list-element--passed",progressButtonsListElementCurrent:"sd-progress-buttons__list-element--current",progressButtonsListElementNonClickable:"sd-progress-buttons__list-element--nonclickable",progressButtonsPageTitle:"sd-progress-buttons__page-title",progressButtonsPageDescription:"sd-progress-buttons__page-description",progressTextInBar:"sd-hidden",page:{root:"sd-page sd-body__page",emptyHeaderRoot:"sd-page__empty-header",title:"sd-title sd-page__title",description:"sd-description sd-page__description",number:"sd-page__num",errorsContainer:"sd-page__errbox"},pageTitle:"sd-title sd-page__title",pageDescription:"sd-description sd-page__description",row:"sd-row sd-clearfix",rowMultiple:"sd-row--multiple",rowCompact:"sd-row--compact",rowEnter:"sd-row--enter",rowDelayedEnter:"sd-row--delayed-enter",rowLeave:"sd-row--leave",rowReplace:"sd-row--replace",pageRow:"sd-page__row",question:{contentEnter:"sd-element__content--enter",contentLeave:"sd-element__content--leave",enter:"sd-element-wrapper--enter",leave:"sd-element-wrapper--leave",mobile:"sd-question--mobile",mainRoot:"sd-element sd-question sd-row__question",flowRoot:"sd-element sd-question sd-row__question sd-row__question--flow",withFrame:"sd-element--with-frame",asCell:"sd-table__cell",answered:"sd-question--answered",header:"sd-question__header sd-element__header",headerLeft:"sd-question__header--location--left",headerTop:"sd-question__header--location-top sd-element__header--location-top",headerBottom:"sd-question__header--location--bottom",content:"sd-element__content sd-question__content",contentSupportContainerQueries:"sd-question__content--support-container-queries",contentLeft:"sd-question__content--left",titleNumInline:"sd-element__title--num-inline",titleLeftRoot:"sd-question--left",titleTopRoot:"sd-question--title-top",descriptionUnderInputRoot:"sd-question--description-under-input",titleBottomRoot:"sd-question--title-bottom",titleOnAnswer:"sd-question__title--answer",titleEmpty:"sd-question__title--empty",titleOnError:"sd-question__title--error",title:"sd-title sd-element__title sd-question__title",titleExpandable:"sd-element__title--expandable",titleExpandableSvg:"sd-element__title-expandable-svg",titleExpanded:"sd-element__title--expanded",titleCollapsed:"sd-element__title--collapsed",titleDisabled:"sd-element__title--disabled",titleReadOnly:"sd-element__title--readonly",titleBar:"sd-action-title-bar",requiredMark:"sd-question__required-text",number:"sd-element__num",description:"sd-description sd-question__description",descriptionUnderInput:"sd-question__description--under-input",comment:"sd-input sd-comment",required:"sd-question--required",titleRequired:"sd-question__title--required",indent:20,footer:"sd-question__footer",commentArea:"sd-question__comment-area",formGroup:"sd-question__form-group",hasError:"sd-question--error",hasErrorTop:"sd-question--error-top",hasErrorBottom:"sd-question--error-bottom",collapsed:"sd-element--collapsed",expandable:"sd-element--expandable",expandableAnimating:"sd-elemenet--expandable--animating",expanded:"sd-element--expanded",nested:"sd-element--nested",invisible:"sd-element--invisible",composite:"sd-element--complex sd-composite",disabled:"sd-question--disabled",readOnly:"sd-question--readonly",preview:"sd-question--preview",noPointerEventsMode:"sd-question--no-pointer-events",errorsContainer:"sd-element__erbox sd-question__erbox",errorsContainerTop:"sd-element__erbox--above-element sd-question__erbox--above-question",errorsContainerBottom:"sd-question__erbox--below-question",confirmDialog:"sd-popup--confirm sv-popup--confirm",singleInputTitle:"sd-element__title--singleinput",singleInputWrapper:"sd-question__singleinput-wrapper",breadcrumbsRoot:"sd-breadcrumbs",breadcrumbsItem:"sd-breadcrumbs-item",breadcrumbsItemButton:"sd-breadcrumbs-item__button",breadcrumbsSeparator:"sd-breadcrumbs-separator",summary:"sd-summary",summaryRow:"sd-summary-row",summaryRowContent:"sd-summary-row__content",summaryRowActions:"sd-summary-row__actions",summaryRowAction:"sd-summary-row-action",summaryRowActionEdit:"sd-summary-row-action sd-summary-row-action--edit",summaryRowActionDelete:"sd-summary-row-action sd-summary-row-action--delete"},image:{mainRoot:"sd-element sd-question sd-question--image",root:"sd-image",image:"sd-image__image",adaptive:"sd-image__image--adaptive",noImage:"sd-image__no-image",noImageSvgIconId:"icon-no-image",withFrame:""},html:{mainRoot:"sd-element sd-question sd-row__question sd-question--html",root:"sd-html",withFrame:"",nested:"sd-element--nested sd-html--nested"},error:{root:"sd-error",warningMode:"sd-error--warning",infoMode:"sd-error--info",icon:"",item:"sd-error__item",locationTop:"",locationBottom:""},checkbox:{root:"sd-selectbase",rootMobile:"sd-selectbase--mobile",rootRow:"sd-selectbase--row",rootMultiColumn:"sd-selectbase--multi-column",item:"sd-item sd-checkbox sd-selectbase__item",itemEnter:"sd-item--enter",itemLeave:"sd-item--leave",itemOnError:"sd-item--error",itemSelectAll:"sd-checkbox--selectall",itemNone:"sd-checkbox--none",itemDisabled:"sd-item--disabled sd-checkbox--disabled",itemReadOnly:"sd-item--readonly sd-checkbox--readonly",itemPreview:"sd-item--preview sd-checkbox--preview",itemPreviewSvgIconId:"#icon-check-16x16",itemChecked:"sd-item--checked sd-checkbox--checked",itemHover:"sd-item--allowhover sd-checkbox--allowhover",itemInline:"sd-selectbase__item--inline",label:"sd-selectbase__label",labelChecked:"",itemControl:"sd-visuallyhidden sd-item__control sd-checkbox__control",itemDecorator:"sd-item__svg sd-checkbox__svg",itemSvgIconId:"#icon-check-16x16",controlLabel:"sd-item__control-label",materialDecorator:"sd-item__decorator sd-checkbox__decorator",otherArea:"sd-selectbase__other",column:"sd-selectbase__column"},radiogroup:{root:"sd-selectbase",rootMobile:"sd-selectbase--mobile",rootRow:"sd-selectbase--row",rootMultiColumn:"sd-selectbase--multi-column",item:"sd-item sd-radio sd-selectbase__item",itemOnError:"sd-item--error",itemInline:"sd-selectbase__item--inline",label:"sd-selectbase__label",labelChecked:"",itemEnter:"sd-item--enter",itemLeave:"sd-item--leave",itemDisabled:"sd-item--disabled sd-radio--disabled",itemReadOnly:"sd-item--readonly sd-radio--readonly",itemPreview:"sd-item--preview sd-radio--preview",itemPreviewSvgIconId:"#icon-check-16x16",itemChecked:"sd-item--checked sd-radio--checked",itemHover:"sd-item--allowhover sd-radio--allowhover",itemControl:"sd-visuallyhidden sd-item__control sd-radio__control",itemDecorator:"sd-item__svg sd-radio__svg",controlLabel:"sd-item__control-label",materialDecorator:"sd-item__decorator sd-radio__decorator",otherArea:"sd-selectbase__other",clearButton:"",column:"sd-selectbase__column"},boolean:{mainRoot:"sd-element sd-question sd-row__question sd-question--boolean",root:"sv_qcbc sv_qbln sd-scrollable-container sd-boolean-root",rootRadio:"sv_qcbc sv_qbln sd-scrollable-container sd-scrollable-container--compact",item:"sd-boolean",itemOnError:"sd-boolean--error",control:"sd-boolean__control sd-visuallyhidden",itemChecked:"sd-boolean--checked",itemExchanged:"sd-boolean--exchanged",itemIndeterminate:"sd-boolean--indeterminate",itemDisabled:"sd-boolean--disabled",itemReadOnly:"sd-boolean--readonly",itemPreview:"sd-boolean--preview",itemHover:"sd-boolean--allowhover",label:"sd-boolean__label",labelTrue:"sd-boolean__label--true",labelFalse:"sd-boolean__label--false",switch:"sd-boolean__switch",disabledLabel:"sd-checkbox__label--disabled",labelReadOnly:"sd-checkbox__label--readonly",labelPreview:"sd-checkbox__label--preview",sliderText:"sd-boolean__thumb-text",slider:"sd-boolean__thumb",sliderGhost:"sd-boolean__thumb-ghost",radioItem:"sd-item",radioItemChecked:"sd-item--checked sd-radio--checked",radioItemDisabled:"sd-item--disabled sd-radio--disabled",radioItemReadOnly:"sd-item--readonly sd-radio--readonly",radioItemPreview:"sd-item--preview sd-radio--preview",itemPreviewSvgIconId:"#icon-check-16x16",radioLabel:"sd-selectbase__label",radioControlLabel:"sd-item__control-label",radioFieldset:"sd-selectbase",itemRadioDecorator:"sd-item__svg sd-radio__svg",materialRadioDecorator:"sd-item__decorator sd-radio__decorator",itemRadioControl:"sd-visuallyhidden sd-item__control sd-radio__control",rootCheckbox:"sd-selectbase",checkboxItem:"sd-item sd-selectbase__item sd-checkbox",checkboxLabel:"sd-selectbase__label",checkboxItemOnError:"sd-item--error",checkboxItemIndeterminate:"sd-checkbox--intermediate",checkboxItemChecked:"sd-item--checked sd-checkbox--checked",checkboxItemDecorator:"sd-item__svg sd-checkbox__svg",checkboxItemDisabled:"sd-item--disabled sd-checkbox--disabled",checkboxItemReadOnly:"sd-item--readonly sd-checkbox--readonly",checkboxItemPreview:"sd-item--preview sd-checkbox--preview",controlCheckbox:"sd-visuallyhidden sd-item__control sd-checkbox__control",checkboxMaterialDecorator:"sd-item__decorator sd-checkbox__decorator",checkboxControlLabel:"sd-item__control-label",checkboxIsLabelRendered:"sd-checkbox--label-rendered",svgIconCheckedId:"#icon-check-16x16"},text:{root:"sd-input sd-text",small:"sd-row__question--small",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",constrolWithCharacterCounter:"sd-text__character-counter",characterCounterBig:"sd-text__character-counter--big",content:"sd-text__content sd-question__content",remainingCharacterCounter:"sd-remaining-character-counter",onError:"sd-input--error"},multipletext:{root:"sd-multipletext",rootMobile:"sd-multipletext--mobile",itemLabel:"sd-multipletext__item-container sd-input",itemLabelReadOnly:"sd-input--readonly",itemLabelDisabled:"sd-input--disabled",itemLabelPreview:"sd-input--preview",itemLabelOnError:"sd-multipletext__item-container--error",itemLabelAllowFocus:"sd-multipletext__item-container--allow-focus",itemLabelAnswered:"sd-multipletext__item-container--answered",itemWithCharacterCounter:"sd-multipletext-item__character-counter",item:"sd-multipletext__item",itemTitle:"sd-multipletext__item-title",content:"sd-multipletext__content sd-question__content",row:"sd-multipletext__row",cell:"sd-multipletext__cell",cellError:"sd-multipletext__cell--error",cellErrorTop:"sd-multipletext__cell--error-top",cellErrorBottom:"sd-multipletext__cell--error-bottom"},dropdown:{root:"sd-selectbase",popup:"sv-dropdown-popup",small:"sd-row__question--small",selectWrapper:"sv-dropdown_select-wrapper",onError:"sd-input--error",label:"sd-selectbase__label",itemEnter:"sd-item--enter",itemLeave:"sd-item--leave",item:"sd-item sd-radio sd-selectbase__item",itemDisabled:"sd-item--disabled sd-radio--disabled",itemChecked:"sd-item--checked sd-radio--checked",itemHover:"sd-item--allowhover sd-radio--allowhover",itemControl:"sd-visuallyhidden sd-item__control sd-radio__control",itemDecorator:"sd-item__svg sd-radio__svg",cleanButtonIconId:"icon-cancel",chevronButton:"sd-dropdown_chevron-button",chevronButtonSvg:"sd-dropdown_chevron-button-svg",chevronButtonIconId:"icon-chevron",control:"sd-input sd-dropdown",controlInputFieldComponent:"sd-dropdown__input-field-component",controlValue:"sd-dropdown__value",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",controlEmpty:"sd-dropdown--empty",controlLabel:"sd-item__control-label",filterStringInput:"sd-dropdown__filter-string-input",materialDecorator:"sd-item__decorator sd-radio__decorator",hintPrefix:"sd-dropdown__hint-prefix",hintSuffix:"sd-dropdown__hint-suffix"},imagepicker:{mainRoot:"sd-element sd-question sd-row__question",root:"sd-selectbase sd-imagepicker",rootResponsive:"sd-imagepicker--responsive",rootStatic:"sd-imagepicker--static",rootColumn:"sd-imagepicker--column",item:"sd-imagepicker__item",itemOnError:"sd-imagepicker__item--error",itemInline:"sd-imagepicker__item--inline",itemChecked:"sd-imagepicker__item--checked",itemDisabled:"sd-imagepicker__item--disabled",itemReadOnly:"sd-imagepicker__item--readonly",itemPreview:"sd-imagepicker__item--preview",itemHover:"sd-imagepicker__item--allowhover",label:"sd-imagepicker__label",itemDecorator:"sd-imagepicker__item-decorator",imageContainer:"sd-imagepicker__image-container",itemControl:"sd-imagepicker__control sd-visuallyhidden",image:"sd-imagepicker__image",itemText:"sd-imagepicker__text",itemNoImage:"sd-imagepicker__no-image",itemNoImageSvgIcon:"sd-imagepicker__no-image-svg",itemNoImageSvgIconId:"icon-no-image",column:"sd-selectbase__column sd-imagepicker__column",checkedItemDecorator:"sd-imagepicker__check-decorator",checkedItemSvgIcon:"sd-imagepicker__check-icon",checkedItemSvgIconId:"icon-check-24x24"},matrix:{mainRoot:"sd-element sd-question sd-row__question sd-element--complex sd-question--complex sd-question--table",tableWrapper:"sd-matrix sd-table-wrapper",root:"sd-table sd-matrix__table",columnsAutoWidth:"sd-table--columnsautowidth",noHeader:"sd-table--no-header",rootVerticalAlignTop:"sd-table--align-top",rootVerticalAlignMiddle:"sd-table--align-middle",rootAlternateRows:"sd-table--alternate-rows",rowError:"sd-matrix__row--error",cell:"sd-table__cell sd-matrix__cell",row:"sd-table__row",rowDisabled:"sd-table__row-disabled",rowReadOnly:"sd-table__row-readonly",headerCell:"sd-table__cell sd-table__cell--header",rowTextCell:"sd-table__cell sd-matrix__cell sd-table__cell--row-text",label:"sd-item sd-{type} sd-matrix__label",itemOnError:"sd-item--error",itemValue:"sd-visuallyhidden sd-item__control sd-{type}__control",itemChecked:"sd-item--checked sd-{type}--checked",itemDisabled:"sd-item--disabled sd-{type}--disabled",itemReadOnly:"sd-item--readonly sd-{type}--readonly",itemPreview:"sd-item--preview sd-{type}--preview",itemPreviewSvgIconId:"#icon-check-16x16",itemHover:"sd-{type}--allowhover",materialDecorator:"sd-item__decorator sd-{type}__decorator",itemDecorator:"sd-item__svg sd-{type}__svg",cellText:"sd-matrix__text",cellTextSelected:"sd-matrix__text--checked",cellTextDisabled:"sd-matrix__text--disabled",cellResponsiveTitle:"sd-matrix__responsive-title",compact:"sd-element--with-frame sd-element--compact"},matrixdropdown:{mainRoot:"sd-element sd-question sd-row__question sd-element--complex sd-question--complex sd-question--table",rootScroll:"sd-question--scroll",root:"sd-table sd-matrixdropdown",columnsAutoWidth:"sd-table--columnsautowidth",noHeader:"sd-table--no-header",hasFooter:"sd-table--has-footer",rootVerticalAlignTop:"sd-table--align-top",rootVerticalAlignMiddle:"sd-table--align-middle",tableWrapper:"sd-table-wrapper",rootAlternateRows:"sd-table--alternate-rows",cell:"sd-table__cell",cellResponsiveTitle:"sd-table__responsive-title",errorsCell:"sd-table__cell--error",errorsCellTop:"sd-table__cell--error-top",errorsCellBottom:"sd-table__cell--error-bottom",itemCell:"sd-table__cell--item",row:"sd-table__row",rowDelayedEnter:"sd-table__row--delayed-enter",rowEnter:"sd-table__row--enter",rowLeave:"sd-table__row--leave",expandedRow:"sd-table__row--expanded",rowHasPanel:"sd-table__row--has-panel",rowHasEndActions:"sd-table__row--has-end-actions",headerCell:"sd-table__cell sd-table__cell--header",rowTextCell:"sd-table__cell sd-table__cell--row-text",footerCell:"sd-table__cell sd-table__cell--footer",footerTotalCell:"sd-table__cell sd-table__cell--footer-total",columnTitleCell:"sd-table__cell--column-title",cellRequiredMark:"sd-question__required-text",detailButton:"sd-table__cell--detail-button",detailButtonExpanded:"sd-table__cell--detail-button--expanded",detailIcon:"sd-detail-panel__icon",detailIconExpanded:"sd-detail-panel__icon--expanded",detailIconId:"icon-expanddetail",detailIconExpandedId:"icon-collapsedetail",detailPanelCell:"sd-table__cell--detail-panel",detailRowCell:"sd-table__cell--detail",actionsCellPrefix:"sd-table__cell-action",actionsCell:"sd-table__cell sd-table__cell--actions",actionsCellDrag:"sd-table__cell--drag",emptyCell:"sd-table__cell--empty",verticalCell:"sd-table__cell--vertical",cellQuestionWrapper:"sd-matrix__question-wrapper sd-table__question-wrapper",compact:"sd-element--with-frame sd-element--compact"},matrixdynamic:{mainRoot:"sd-element sd-question sd-row__question sd-element--complex sd-question--complex sd-question--table",rootScroll:"sd-question--scroll",empty:"sd-question--empty",root:"sd-table sd-matrixdynamic",columnsAutoWidth:"sd-table--columnsautowidth",noHeader:"sd-table--no-header",hasFooter:"sd-table--has-footer",tableWrapper:"sd-table-wrapper",rootAlternateRows:"sd-table--alternate-rows",content:"sd-matrixdynamic__content sd-question__content",cell:"sd-table__cell",cellResponsiveTitle:"sd-table__responsive-title",row:"sd-table__row",rowEmpty:"sd-table__row--empty",rowDelayedEnter:"sd-table__row--delayed-enter",rowEnter:"sd-table__row--enter",rowLeave:"sd-table__row--leave",rowHasPanel:"sd-table__row--has-panel",rowHasEndActions:"sd-table__row--has-end-actions",expandedRow:"sd-table__row--expanded",itemCell:"sd-table__cell--item",headerCell:"sd-table__cell sd-table__cell--header",rowTextCell:"sd-table__cell sd-table__cell--row-text",footerCell:"sd-table__cell sd-table__cell--footer",columnTitleCell:"sd-table__cell--column-title",cellRequiredMark:"sd-question__required-text",button:"sd-action sd-matrixdynamic__btn",detailRow:"sd-table__row sd-table__row--detail",detailButton:"sd-table__cell--detail-button",detailButtonExpanded:"sd-table__cell--detail-button--expanded",detailIcon:"sd-detail-panel__icon",detailIconExpanded:"sd-detail-panel__icon--expanded",detailIconId:"icon-expanddetail",detailIconExpandedId:"icon-collapsedetail",detailPanelCell:"sd-table__cell--detail-panel",detailRowCell:"sd-table__cell--detail",actionsCellPrefix:"sd-table__cell-action",actionsCell:"sd-table__cell sd-table__cell--actions",actionsCellDrag:"sd-table__cell--drag",buttonAdd:"sd-matrixdynamic__add-btn",buttonRemove:"sd-action--negative sd-matrixdynamic__remove-btn",iconAdd:"sd-hidden",iconRemove:"",dragElementDecorator:"sd-drag-element__svg",iconDragElement:"#icon-drag-24x24",footer:"sd-matrixdynamic__footer",footerTotalCell:"sd-table__cell sd-table__cell--footer-total",noRowsSection:"sd-matrixdynamic__placeholder sd-question__placeholder",iconDrag:"sv-matrixdynamic__drag-icon",ghostRow:"sv-matrix-row--drag-drop-ghost-mod",draggedRow:"sv-matrixdynamic-dragged-row",emptyCell:"sd-table__cell--empty",verticalCell:"sd-table__cell--vertical",cellQuestionWrapper:"sd-matrix__question-wrapper sd-table__question-wrapper",errorsCell:"sd-table__cell--error",errorsCellTop:"sd-table__cell--error-top",errorsCellBottom:"sd-table__cell--error-bottom",compact:"sd-element--with-frame sd-element--compact"},rating:{rootDropdown:"sd-scrollable-container sd-scrollable-container--compact sd-selectbase",root:"sd-scrollable-container sd-rating",rootWrappable:"sd-rating--wrappable",rootLabelsTop:"sd-rating--labels-top",rootLabelsBottom:"sd-rating--labels-bottom",rootLabelsDiagonal:"sd-rating--labels-diagonal",item:"sd-rating__item",itemOnError:"sd-rating__item--error",itemHover:"sd-rating__item--allowhover",selected:"sd-rating__item--selected",itemStar:"sd-rating__item-star",itemStarOnError:"sd-rating__item-star--error",itemStarHover:"sd-rating__item-star--allowhover",itemStarSelected:"sd-rating__item-star--selected",itemStarDisabled:"sd-rating__item-star--disabled",itemStarReadOnly:"sd-rating__item-star--readonly",itemStarPreview:"sd-rating__item-star--preview",itemStarHighlighted:"sd-rating__item-star--highlighted",itemStarUnhighlighted:"sd-rating__item-star--unhighlighted",itemStarSmall:"sd-rating__item-star--small",itemSmiley:"sd-rating__item-smiley",itemSmileyOnError:"sd-rating__item-smiley--error",itemSmileyHover:"sd-rating__item-smiley--allowhover",itemSmileySelected:"sd-rating__item-smiley--selected",itemSmileyDisabled:"sd-rating__item-smiley--disabled",itemSmileyReadOnly:"sd-rating__item-smiley--readonly",itemSmileyPreview:"sd-rating__item-smiley--preview",itemSmileyHighlighted:"sd-rating__item-star--highlighted",itemSmileyScaleColored:"sd-rating__item-smiley--scale-colored",itemSmileyRateColored:"sd-rating__item-smiley--rate-colored",itemSmileySmall:"sd-rating__item-smiley--small",minText:"sd-rating__item-text sd-rating__min-text",itemText:"sd-rating__item-text",maxText:"sd-rating__item-text sd-rating__max-text",itemDisabled:"sd-rating__item--disabled",itemReadOnly:"sd-rating__item--readonly",itemPreview:"sd-rating__item--preview",itemFixedSize:"sd-rating__item--fixed-size",control:"sd-input sd-dropdown",itemSmall:"sd-rating--small",selectWrapper:"sv-dropdown_select-wrapper",controlValue:"sd-dropdown__value",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",controlEmpty:"sd-dropdown--empty",filterStringInput:"sd-dropdown__filter-string-input",chevronButtonIconId:"icon-chevron",popup:"sv-dropdown-popup",onError:"sd-input--error"},slider:{root:"sd-slider",rootSingleMode:"sd-slider--single",rootNegativeScaleMode:"sd-slider--negative-scale-mode",rootDesignMode:"sd-slider--design-mode",rootAnimatedThumbMode:"sd-slider--animated-thumb-mode",rootTooltipsAlwaysMode:"sd-slider--tooltips-always-mode",rootLabelsShowValueTextMode:"sd-slider--labels-show-value-text-mode",visualContainer:"sd-slider-container",visualContainerSlider:"sd-slider-container__slider",rangeTrack:"sd-slider__track sd-slider__range-track",inverseTrackLeft:"sd-slider__track sd-slider__inverse-track sd-slider__inverse-track--left",inverseTrackRight:"sd-slider__track sd-slider__inverse-track sd-slider__inverse-track--right",thumbContainer:"sd-slider__thumb-container",thumbContainerIndeterminateMode:"sd-slider__thumb-container--indeterminate",thumbContainerFocusedMode:"sd-slider__thumb-container--focused",thumb:"sd-slider__thumb",thumbDot:"sd-slider__thumb-dot",tooltip:"sd-slider__tooltip",tooltipPanel:"sd-slider__tooltip-panel",tooltipOnHoverMode:"sd-slider__tooltip--on-hover",tooltipValue:"sd-slider__tooltip-value",input:"sd-slider__input",labelsContainer:"sd-slider-labels-container",label:"sd-slider__label",labelLongMod:"sd-slider__label--long",labelTick:"sd-slider__label-tick",labelTextContainer:"sd-slider__label-text-container",labelText:"sd-slider__label-text",labelTextSecondaryMode:"sd-slider__label-text sd-slider__label-text--secondary",clearButton:""},comment:{root:"sd-input sd-comment",small:"sd-row__question--small",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",content:"sd-comment__content sd-question__content",remainingCharacterCounter:"sd-remaining-character-counter",onError:"sd-input--error"},expression:"sd-expression",file:{root:"sd-file",rootDragging:"sd-file--dragging",rootAnswered:"sd-file--answered",rootDisabled:"sd-file--disabled",rootReadOnly:"sd-file--readonly",rootPreview:"sd-file--preview",placeholderInput:"sd-visuallyhidden",previewItem:"sd-file__preview-item",fileSign:"",fileList:"sd-file__list",fileSignBottom:"sd-file__sign",dragArea:"sd-file__drag-area",dragAreaActive:"sd-file__drag-area--active",fileDecorator:"sd-file__decorator",onError:"sd-file__decorator--error",fileDecoratorDrag:"sd-file__decorator--drag",fileInput:"sd-visuallyhidden",chooseFile:"sd-file__choose-btn",chooseFileAsText:"sd-action sd-file__choose-btn--text",chooseFileAsTextDisabled:"sd-action--disabled",chooseFileAsIcon:"sd-file__choose-btn--icon",chooseFileIconId:"icon-choosefile",disabled:"sd-file__choose-btn--disabled",controlDisabled:"sd-file__choose-file-btn--disabled",removeButton:"sd-context-btn--negative",removeButtonBottom:"",removeButtonIconId:"icon-clear",removeFile:"sd-hidden",removeFileSvg:"",removeFileSvgIconId:"icon-close_16x16",wrapper:"sd-file__wrapper",defaultImage:"sd-file__default-image",defaultImageIconId:"icon-defaultfile",leftIconId:"icon-arrowleft",rightIconId:"icon-arrowright",removeFileButton:"sd-context-btn--small sd-context-btn--with-border sd-context-btn--colorful sd-context-btn--negative sd-file__remove-file-button",dragAreaPlaceholder:"sd-file__drag-area-placeholder",imageWrapper:"sd-file__image-wrapper",imageWrapperDefaultImage:"sd-file__image-wrapper--default-image",single:"sd-file--single",singleImage:"sd-file--single-image",mobile:"sd-file--mobile",videoContainer:"sd-file__video-container",contextButton:"sd-context-btn",video:"sd-file__video",actionsContainer:"sd-file__actions-container",closeCameraButton:"sd-file__close-camera-button",changeCameraButton:"sd-file__change-camera-button",takePictureButton:"sd-file__take-picture-button",loadingIndicator:"sd-file__loading-indicator",page:"sd-file__page"},signaturepad:{mainRoot:"sd-element sd-question sd-question--signature sd-row__question",root:"sd-signaturepad sjs_sp_container",small:"sd-row__question--small",controls:"sjs_sp_controls sd-signaturepad__controls",placeholder:"sjs_sp_placeholder",canvas:"sjs_sp_canvas sd-signaturepad__canvas",backgroundImage:"sjs_sp__background-image sd-signaturepad__background-image",clearButton:"sjs_sp_clear sd-context-btn sd-context-btn--negative sd-signaturepad__clear",clearButtonIconId:"icon-clear",loadingIndicator:"sd-signaturepad__loading-indicator"},saveData:{root:"sv-save-data_root",rootWithButtons:"sv-save-data_root--with-buttons",info:"sv-save-data_info",error:"sv-save-data_error",success:"sv-save-data_success",button:"sv-save-data_button",shown:"sv-save-data_root--shown"},window:{root:"sv_window",rootCollapsedMod:"sv_window--collapsed",rootFullScreenMode:"sv_window--full-screen",rootContent:"sv_window_root-content",body:"sv_window_content",header:{root:"sv_window_header",titleCollapsed:"sv_window_header_title_collapsed",buttonsContainer:"sv_window_buttons_container",button:"sv_window_button",buttonExpanded:"",buttonCollapsed:"",collapseButton:"sv_window_button sv_window_button_collapse",closeButton:"sv_window_button sv_window_button_close",fullScreenButton:"sv_window_button sv_window_button_full_screen"}},ranking:{root:"sv-ranking",rootMobileMod:"sv-ranking--mobile",rootDragMod:"sv-ranking--drag",rootDisabled:"sd-ranking--disabled",rootReadOnly:"sd-ranking--readonly",rootPreview:"sd-ranking--preview",rootDesignMode:"sv-ranking--design-mode",rootDragHandleAreaIcon:"sv-ranking--drag-handle-area-icon",rootSelectToRankMod:"sv-ranking--select-to-rank",rootSelectToRankEmptyValueMod:"sv-ranking--select-to-rank-empty-value",rootSelectToRankAlignVertical:"sv-ranking--select-to-rank-vertical",rootSelectToRankAlignHorizontal:"sv-ranking--select-to-rank-horizontal",rootSelectToRankSwapAreas:"sv-ranking--select-to-rank-swap-areas",item:"sv-ranking-item",itemContent:"sv-ranking-item__content sd-ranking-item__content",itemIndex:"sv-ranking-item__index sd-ranking-item__index",itemIndexEmptyMode:"sv-ranking-item__index--empty sd-ranking-item__index--empty",itemDisabled:"sv-ranking-item--disabled",itemReadOnly:"sv-ranking-item--readonly",itemPreview:"sv-ranking-item--preview",controlLabel:"sv-ranking-item__text",itemGhostNode:"sv-ranking-item__ghost",itemIconContainer:"sv-ranking-item__icon-container",itemIcon:"sv-ranking-item__icon",itemIconHoverMod:"sv-ranking-item__icon--hover",itemIconFocusMod:"sv-ranking-item__icon--focus",itemGhostMod:"sv-ranking-item--ghost",itemDragMod:"sv-ranking--drag",itemOnError:"sv-ranking-item--error",container:"sv-ranking__container",containerEmptyMode:"sv-ranking__container--empty",containerFromMode:"sv-ranking__container--from",containerToMode:"sv-ranking__container--to",containerPlaceholder:"sv-ranking__container-placeholder",containersDivider:"sv-ranking__containers-divider"},buttongroup:{root:"sd-button-group-scrollable-container sv-button-group",item:"sv-button-group__item",itemIcon:"sv-button-group__item-icon",itemDecorator:"sv-button-group__item-decorator",itemCaption:"sv-button-group__item-caption",itemHover:"sv-button-group__item--hover",itemSelected:"sv-button-group__item--selected",itemDisabled:"sv-button-group__item--disabled",itemControl:"sv-visuallyhidden",rootDropdown:"sd-button-group-scrollable-container sd-scrollable-container--compact sd-selectbase",selectWrapper:"sv-dropdown_select-wrapper",control:"sd-input sd-dropdown",controlEmpty:"sd-dropdown--empty",controlValue:"sd-dropdown__value",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",controlLabel:"sd-item__control-label",filterStringInput:"sd-dropdown__filter-string-input",chevronButtonIconId:"icon-chevron",popup:"sv-dropdown-popup",cleanButtonIconId:"icon-cancel",hintPrefix:"sd-dropdown__hint-prefix",hintSuffix:"sd-dropdown__hint-suffix"},list:{root:"sv-list__container sd-list",item:"sv-list__item sd-list__item",itemBody:"sv-list__item-body sd-list__item-body",itemSelected:"sv-list__item--selected sd-list__item--selected",itemFocused:"sv-list__item--focused sd-list__item--focused",itemHovered:"sv-list__item--hovered sd-list__item--hovered"},actionBar:{root:"sd-action-bar",item:"sd-action",defaultSizeMode:"",smallSizeMode:"",itemPressed:"sd-action--pressed",itemAsIcon:"sd-action--icon",itemIcon:"sd-action__icon",itemTitle:"sd-action__title"},variables:{mobileWidth:"--sd-mobile-width",themeMark:"--sv-defaultV2-mark"},tagbox:{root:"sd-selectbase",popup:"sv-dropdown-popup",small:"sd-row__question--small",selectWrapper:"sv-dropdown_select-wrapper",onError:"sd-input--error",label:"sd-selectbase__label",itemSvgIconId:"#icon-check-16x16",item:"sd-item sd-checkbox sd-selectbase__item",itemDisabled:"sd-item--disabled sd-checkbox--disabled",itemChecked:"sd-item--checked sd-checkbox--checked",itemHover:"sd-item--allowhover sd-checkbox--allowhover",itemControl:"sd-visuallyhidden sd-item__control sd-checkbox__control",itemDecorator:"sd-item__svg sd-checkbox__svg",itemEnter:"sd-item--enter",itemLeave:"sd-item--leave",cleanButtonIconId:"icon-cancel-24x24",cleanItemButton:"sd-tagbox-item_clean-button",cleanItemButtonSvg:"sd-tagbox-item_clean-button-svg",cleanItemButtonIconId:"icon-clear_16x16",chevronButtonIconId:"icon-chevron",control:"sd-input sd-tagbox sd-dropdown",controlValue:"sd-tagbox__value sd-dropdown__value",controlValueItems:"sd-tagbox__value-items",placeholderInput:"sd-tagbox__placeholder",controlEditable:"sd-input--editable",controlDisabled:"sd-input--disabled",controlReadOnly:"sd-input--readonly",controlPreview:"sd-input--preview",controlEmpty:"sd-dropdown--empty sd-tagbox--empty",controlLabel:"sd-item__control-label",filterStringInput:"sd-tagbox__filter-string-input sd-dropdown__filter-string-input",materialDecorator:"sd-item__decorator sd-checkbox__decorator",hint:"sd-tagbox__hint",hintPrefix:"sd-dropdown__hint-prefix sd-tagbox__hint-prefix",hintSuffix:"sd-dropdown__hint-suffix sd-tagbox__hint-suffix",hintSuffixWrapper:"sd-tagbox__hint-suffix-wrapper"}};const m_="default";Br[m_]=Md;var Ni={setTimeout:n=>Ni.safeTimeOut(n,1e3),clearTimeout:n=>{clearTimeout(n)},safeTimeOut:(n,e)=>e<=0?(n(),0):setTimeout(n,e),now(){return Date.now()}};class qi{constructor(){this.listenerCounter=0,this.timerId=-1,this.onTimerTick=new Xt,this.onTimer=this.onTimerTick}static get instance(){return qi.instanceValue||(qi.instanceValue=new qi),qi.instanceValue}start(e=null){e&&this.onTimerTick.add(e),this.prevTimeInMs=Ni.now(),this.timerId<0&&(this.timerId=Ni.setTimeout(()=>{this.doTimer()})),this.listenerCounter++}stop(e=null){e&&this.onTimerTick.remove(e),this.listenerCounter--,this.listenerCounter==0&&this.timerId>-1&&(Ni.clearTimeout(this.timerId),this.timerId=-1)}doTimer(){if((this.onTimerTick.isEmpty||this.listenerCounter==0)&&(this.timerId=-1),this.timerId<0)return;const e=Ni.now();let t=Math.floor((e-this.prevTimeInMs)/1e3);this.prevTimeInMs=e,t<0&&(t=1);const s=this.timerId;this.onTimerTick.fire(this,{seconds:t}),s===this.timerId&&(this.timerId=Ni.setTimeout(()=>{this.doTimer()}))}}qi.instanceValue=null;class Fr extends de{constructor(e){super(),this.timerFunc=null,this.surveyValue=e,this.onCreating()}get survey(){return this.surveyValue}onCreating(){}start(){this.survey&&(this.isRunning||this.isDesignMode||(this.survey.onCurrentPageChanged.add(()=>{this.update()}),this.timerFunc=(e,t)=>{this.doTimer(t.seconds)},this.setIsRunning(!0),this.update(),qi.instance.start(this.timerFunc)))}stop(){this.isRunning&&(this.setIsRunning(!1),qi.instance.stop(this.timerFunc))}get isRunning(){return this.getPropertyValue("isRunning",!1)}setIsRunning(e){this.setPropertyValue("isRunning",e)}update(){this.updateText(),this.updateProgress()}doTimer(e){var t=this.survey.currentPage;if(t){const s=t.getMaxTimeToFinish();s>0&&s<t.timeSpent+e&&(e=s-t.timeSpent),t.timeSpent=t.timeSpent+e}this.spent=this.spent+e,this.update(),this.onTimerTick&&this.onTimerTick(t)}updateProgress(){let{spent:e,limit:t}=this.survey.timerInfo;t?(e==0?(this.progress=0,setTimeout(()=>{this.progress=Math.floor((e+1)/t*100)/100},0)):e<=t&&(this.progress=Math.floor((e+1)/t*100)/100),this.progress>1&&(this.progress=void 0)):this.progress=void 0}updateText(){let e=this.survey.timerClock;this.clockMajorText=e.majorText,this.clockMinorText=e.minorText,this.text=this.survey.timerInfoText}get showProgress(){return this.progress!==void 0}get showTimerAsClock(){return!!this.survey.getCss().clockTimerRoot}get rootCss(){return new j().append(this.survey.getCss().clockTimerRoot).append(this.survey.getCss().clockTimerRootTop,this.survey.isTimerPanelShowingOnTop).append(this.survey.getCss().clockTimerRootBottom,this.survey.isTimerPanelShowingOnBottom).toString()}getProgressCss(){return new j().append(this.survey.getCss().clockTimerProgress).append(this.survey.getCss().clockTimerProgressAnimation,this.progress>0).toString()}get textContainerCss(){return this.survey.getCss().clockTimerTextContainer}get minorTextCss(){return this.survey.getCss().clockTimerMinorText}get majorTextCss(){return this.survey.getCss().clockTimerMajorText}}I([R()],Fr.prototype,"text",void 0),I([R()],Fr.prototype,"progress",void 0),I([R()],Fr.prototype,"clockMajorText",void 0),I([R()],Fr.prototype,"clockMinorText",void 0),I([R({defaultValue:0})],Fr.prototype,"spent",void 0);class In extends de{constructor(e){super(),this.cssClasses=e,this.timeout=D.notifications.lifetime,this.timer=void 0,this.actionsVisibility={},this.showActions=!0,this.actionBar=new Vt,this.actionBar.setCssClasses({root:Os.root,defaultSizeMode:Os.defaultSizeMode,smallSizeMode:Os.smallSizeMode},!1),this.css=this.cssClasses.root}getCssClass(e){return new j().append(this.cssClasses.root).append(this.cssClasses.rootWithButtons,this.actionBar.getVisibleActions().length>0).append(this.cssClasses.info,e!=="error"&&e!=="success").append(this.cssClasses.error,e==="error").append(this.cssClasses.success,e==="success").append(this.cssClasses.shown,this.active).toString()}updateActionsVisibility(e){this.actionBar.actions.forEach(t=>t.visible=this.showActions&&this.actionsVisibility[t.id]===e)}notify(e,t="info",s=!1){this.isDisplayed=!0,setTimeout(()=>{this.updateActionsVisibility(t),this.message=e,this.active=!0,this.css=this.getCssClass(t),this.timer&&(clearTimeout(this.timer),this.timer=void 0),s||(this.timer=setTimeout(()=>{this.timer=void 0,this.active=!1,this.css=this.getCssClass(t)},this.timeout))},1)}addAction(e,t){e.visible=!1,e.innerCss=this.cssClasses.button;const s=this.actionBar.addAction(e);this.actionsVisibility[s.id]=t}}I([R({defaultValue:!1})],In.prototype,"active",void 0),I([R({defaultValue:!1})],In.prototype,"isDisplayed",void 0),I([R()],In.prototype,"message",void 0),I([R()],In.prototype,"css",void 0);class tr{calcRow(e){return e==="top"?1:e==="middle"?2:3}calcColumn(e){return e==="left"?1:e==="center"?2:3}calcAlignItems(e){return e==="left"?"flex-start":e==="center"?"center":"flex-end"}calcAlignText(e){return e==="left"?"start":e==="center"?"center":"end"}calcJustifyContent(e){return e==="top"?"flex-start":e==="middle"?"center":"flex-end"}calcGridRow(){const e=this.calcRow(this.positionY);if(this.cover.renderedHeight)return e;const t=this.cover.getVisibleRows(),s=t.indexOf(e);if(s===-1)return 0;const i=t.length;return i===3?e:i===1?1:s+1}constructor(e,t,s){this.cover=e,this.positionX=t,this.positionY=s}get survey(){return this.cover.survey}get css(){return new j().append(tr.CLASSNAME).append(`${tr.CLASSNAME}--${this.positionX}`).append(`${tr.CLASSNAME}--${this.positionY}`).append(tr.CLASSNAME+"--empty",this.isEmpty).toString()}get style(){const e=this.calcGridRow(),t={};return t.gridRow=e,t.gridColumn=e!==0?this.calcColumn(this.positionX):0,t.width=this.width?this.width+"px":void 0,e===0&&(t.display="none"),t}get contentStyle(){const e={};return e.textAlign=this.calcAlignText(this.positionX),e.alignItems=this.calcAlignItems(this.positionX),e.justifyContent=this.calcJustifyContent(this.positionY),e.maxWidth=this.contentMaxWidth,e}get showLogo(){return this.survey.hasLogo&&this.positionX===this.cover.logoPositionX&&this.positionY===this.cover.logoPositionY}get showTitle(){return this.survey.hasTitle&&this.positionX===this.cover.titlePositionX&&this.positionY===this.cover.titlePositionY}get showDescription(){return this.survey.renderedHasDescription&&this.positionX===this.cover.descriptionPositionX&&this.positionY===this.cover.descriptionPositionY}get isEmpty(){return!this.showLogo&&!this.showTitle&&!this.showDescription}get textAreaWidth(){return this.cover.renderedTextAreaWidth}get width(){if(this.cover.width)return Math.ceil(this.cover.width/3)}get contentMaxWidth(){return this.cover.getContentMaxWidth(this)}}tr.CLASSNAME="sv-header__cell";class Ze extends de{calcBackgroundSize(e){return e==="fill"?"100% 100%":e==="tile"?"auto":e}updateHeaderClasses(){const e=!this.backgroundColor||this.backgroundColor==="transparent",t=this.backgroundColor==="var(--sjs-primary-backcolor)",s=!e&&!t;this.headerClasses=new j().append("sv-header").append("sv-header--height-auto",!this.renderedHeight).append("sv-header__without-background",e&&!this.backgroundImage).append("sv-header__background-color--none",e&&!this.titleColor&&!this.descriptionColor).append("sv-header__background-color--accent",t&&!this.titleColor&&!this.descriptionColor).append("sv-header__background-color--custom",s&&!this.titleColor&&!this.descriptionColor).append("sv-header__overlap",this.overlapEnabled).toString()}updateContentClasses(){const e=!!this.survey&&this.survey.calculateWidthMode(),t=this.inheritWidthFrom==="survey"&&!!e&&e==="static";if(this.maxWidth=t?this.survey.width:void 0,this.maxWidth){const s=this.maxWidth.toString();s.indexOf("px")===-1&&s.indexOf("%")===-1&&(this.maxWidth=parseFloat(s)+"px")}this.contentClasses=new j().append("sv-header__content").append("sv-header__content--static",t).append("sv-header__content--responsive",this.inheritWidthFrom==="container"||!!e&&e==="responsive").toString()}updateBackgroundImageClasses(){this.backgroundImageClasses=new j().append("sv-header__background-image").append("sv-header__background-image--contain",this.backgroundImageFit==="contain").append("sv-header__background-image--tile",this.backgroundImageFit==="tile").toString()}fromTheme(e){super.fromJSON(e.header||{}),e.cssVariables&&(this.backgroundColor=e.cssVariables["--sjs-header-backcolor"],this.titleColor=e.cssVariables["--sjs-font-headertitle-color"],this.descriptionColor=e.cssVariables["--sjs-font-headerdescription-color"]),this.init()}init(){this.renderBackgroundImage=Vd(this.backgroundImage),this.updateHeaderClasses(),this.updateContentClasses(),this.updateBackgroundImageClasses()}constructor(){super(),this.cells=[],["top","middle","bottom"].forEach(e=>["left","center","right"].forEach(t=>this.cells.push(new tr(this,t,e)))),this.init()}getType(){return"cover"}get renderedHeight(){if(this.survey&&!this.survey.isMobile||!this.survey)return this.height?this.height+"px":void 0;if(this.survey&&this.survey.isMobile)return this.mobileHeight?this.mobileHeight+"px":void 0}get renderedTextAreaWidth(){return this.textAreaWidth?this.textAreaWidth+"px":void 0}get isEmpty(){return!this.survey.hasLogo&&!this.survey.hasTitle&&!this.survey.renderedHasDescription}get survey(){return this._survey}set survey(e){this._survey!==e&&(this._survey=e,e&&(this.updateContentClasses(),this._survey.onPropertyChanged.add((t,s)=>{(s.name=="widthMode"||s.name=="width")&&this.updateContentClasses()})))}get backgroundImageStyle(){return this.backgroundImage?{opacity:this.backgroundImageOpacity,backgroundImage:this.renderBackgroundImage,backgroundSize:this.calcBackgroundSize(this.backgroundImageFit)}:null}propertyValueChanged(e,t,s,i,r){super.propertyValueChanged(e,t,s),(e==="height"||e==="backgroundColor"||e==="backgroundImage"||e==="overlapEnabled")&&this.updateHeaderClasses(),e==="inheritWidthFrom"&&this.updateContentClasses(),e==="backgroundImageFit"&&this.updateBackgroundImageClasses()}getVisibleRows(){const e=[];for(let t=0;t<3;t++){const s=t*3;(!this.cells[s].isEmpty||!this.cells[s+1].isEmpty||!this.cells[s+2].isEmpty)&&e.push(t+1)}return e.length!==0?e:[1,2,3]}getContentMaxWidth(e){if(e.isEmpty||e.showLogo)return;const t=this.cells.indexOf(e),s=Math.floor(t/3),i=t%3;if(i==1){if(!this.cells[s*3].isEmpty||!this.cells[s*3+2].isEmpty)return"100%"}else if(i==0){let r=0,a=i+1;for(;a<3&&this.cells[s*3+a].isEmpty;)this.cells[s*3+a].isEmpty&&r++,a++;return 100*(r+1)+"%"}else if(i==2){let r=0,a=i-1;for(;a>0&&this.cells[s*3+a].isEmpty;)this.cells[s*3+a].isEmpty&&r++,a--;return 100*(r+1)+"%"}}processResponsiveness(){if(this.survey&&this.survey.rootElement&&!this.survey.isMobile){const e=this.survey.rootElement.querySelectorAll(".sv-header__content")[0];if(!e)return;let t=e.getBoundingClientRect().width;const s=oe.getComputedStyle(e),i=parseFloat(s.paddingLeft)||0,r=parseFloat(s.paddingRight)||0,a=parseFloat(s.columnGap)||0;this.width=t-i-r-2*a}}get hasBackground(){return!!this.backgroundImage||this.backgroundColor!=="transparent"}}I([R()],Ze.prototype,"height",void 0),I([R()],Ze.prototype,"mobileHeight",void 0),I([R()],Ze.prototype,"inheritWidthFrom",void 0),I([R()],Ze.prototype,"textAreaWidth",void 0),I([R()],Ze.prototype,"textGlowEnabled",void 0),I([R()],Ze.prototype,"overlapEnabled",void 0),I([R({defaultValue:"transparent"})],Ze.prototype,"backgroundColor",void 0),I([R()],Ze.prototype,"titleColor",void 0),I([R()],Ze.prototype,"descriptionColor",void 0),I([R({onSet:(n,e)=>{e.renderBackgroundImage=Vd(n)}})],Ze.prototype,"backgroundImage",void 0),I([R()],Ze.prototype,"renderBackgroundImage",void 0),I([R()],Ze.prototype,"backgroundImageFit",void 0),I([R()],Ze.prototype,"backgroundImageOpacity",void 0),I([R()],Ze.prototype,"logoPositionX",void 0),I([R()],Ze.prototype,"logoPositionY",void 0),I([R()],Ze.prototype,"titlePositionX",void 0),I([R()],Ze.prototype,"titlePositionY",void 0),I([R()],Ze.prototype,"descriptionPositionX",void 0),I([R()],Ze.prototype,"descriptionPositionY",void 0),I([R()],Ze.prototype,"logoStyle",void 0),I([R()],Ze.prototype,"titleStyle",void 0),I([R()],Ze.prototype,"descriptionStyle",void 0),I([R()],Ze.prototype,"headerClasses",void 0),I([R()],Ze.prototype,"contentClasses",void 0),I([R()],Ze.prototype,"width",void 0),I([R()],Ze.prototype,"maxWidth",void 0),I([R()],Ze.prototype,"backgroundImageClasses",void 0),B.addClass("cover",[{name:"height:number",minValue:0,default:0},{name:"mobileHeight:number",minValue:0,default:0},{name:"inheritWidthFrom",default:"survey"},{name:"textAreaWidth:number",minValue:0,default:0},{name:"textGlowEnabled:boolean"},{name:"overlapEnabled:boolean"},{name:"backgroundImage:file"},{name:"backgroundImageOpacity:number",minValue:0,maxValue:1,default:1},{name:"backgroundImageFit",default:"cover",choices:["cover","fill","contain"]},{name:"logoPositionX",default:"left"},{name:"logoPositionY",default:"top"},{name:"titlePositionX",default:"left"},{name:"titlePositionY",default:"bottom"},{name:"descriptionPositionX",default:"left"},{name:"descriptionPositionY",default:"bottom"}],function(){return new Ze});class f_{constructor(e){this.type=e,this.timestamp=new Date}}class F1 extends de{constructor(){super(),this.taskList=[],this.onAllTasksCompleted=this.addEvent()}runTask(e,t){const s=new f_(e);return this.taskList.push(s),this.hasActiveTasks=!0,t(()=>this.taskFinished(s)),s}waitAndExecute(e){if(!this.hasActiveTasks){e();return}this.onAllTasksCompleted.add(()=>{e()})}taskFinished(e){const t=this.taskList.indexOf(e);t>-1&&this.taskList.splice(t,1),this.hasActiveTasks&&this.taskList.length==0&&(this.hasActiveTasks=!1,this.onAllTasksCompleted.fire(this,{}))}}I([R({defaultValue:!1})],F1.prototype,"hasActiveTasks",void 0);class Tn extends de{constructor(e,t){super(),this.effectiveWidth=e,this.questionTitleWidth=t}getType(){return"panellayoutcolumn"}isEmpty(){return!this.width&&!this.questionTitleWidth}}I([R()],Tn.prototype,"width",void 0),I([R({onSet:(n,e,t)=>{n!==t&&(e.width=n)}})],Tn.prototype,"effectiveWidth",void 0),I([R()],Tn.prototype,"questionTitleWidth",void 0),B.addClass("panellayoutcolumn",[{name:"effectiveWidth:number",isSerializable:!1,minValue:0},{name:"width:number",visible:!1},"questionTitleWidth"],n=>new Tn);class y_ extends de{get allowRendering(){return!this.panel||!this.panel.survey||!this.panel.survey.isLazyRenderingSuspended}startLazyRendering(e,t=Zo){if(!oe.isAvailable())return;this._scrollableParent=t(e),this._scrollableParent===oe.getDocumentElement()&&(this._scrollableParent=he.getWindow());const s=this._scrollableParent.scrollHeight>this._scrollableParent.clientHeight;this.isNeedRender=!s,s&&(this._updateVisibility=()=>{if(this.allowRendering){var i=mR(e,50);!this.isNeedRender&&i&&(this.isNeedRender=!0,this.stopLazyRendering())}},this.lazyRenderingTimeout=setTimeout(()=>{this._scrollableParent&&this._scrollableParent.addEventListener&&this._scrollableParent.addEventListener("scroll",this._updateVisibility),this.ensureVisibility()},10))}ensureVisibility(){this._updateVisibility&&this._updateVisibility()}stopLazyRendering(){this._scrollableParent&&this._updateVisibility&&this._scrollableParent.removeEventListener&&this._scrollableParent.removeEventListener("scroll",this._updateVisibility),clearTimeout(this.lazyRenderingTimeout),this._scrollableParent=void 0,this._updateVisibility=void 0}constructor(e){super(),this.panel=e,this._scrollableParent=void 0,this._updateVisibility=void 0,this.visibleElementsAnimation=new Xi(this.getVisibleElementsAnimationOptions(),t=>{this.setWidth(t),this.setPropertyValue("visibleElements",t)},()=>this.visibleElements),this.visible=e.areInvisibleElementsShowing,this.createNewArray("elements"),this.createNewArray("visibleElements")}setIsLazyRendering(e){this.isLazyRenderingValue=e,this.isNeedRender=!e}isLazyRendering(){return this.isLazyRenderingValue===!0}get id(){return"pr_"+this.uniqueId}equalsCore(e){return this==e}get elements(){return this.getPropertyValue("elements")}getIsAnimationAllowed(){var e;return super.getIsAnimationAllowed()&&this.visible&&((e=this.panel)===null||e===void 0?void 0:e.animationAllowed)}getVisibleElementsAnimationOptions(){const e=t=>{ci(t),Vn(t,{width:Td(t)+"px"})};return{getRerenderEvent:()=>this.onElementRerendered,isAnimationEnabled:()=>this.animationAllowed,allowSyncRemovalAddition:!1,getAnimatedElement:t=>t.getWrapperElement(),getLeaveOptions:t=>{const s=t;return{cssClass:(t.isPanel?s.cssClasses.panel:s.cssClasses).leave,onBeforeRunAnimation:e,onAfterRunAnimation:Vs}},getEnterOptions:t=>{const s=t;return{cssClass:(t.isPanel?s.cssClasses.panel:s.cssClasses).enter,onBeforeRunAnimation:e,onAfterRunAnimation:Vs}}}}set visibleElements(e){if(e.length)this.visible=!0;else{this.visible=!1,this.visibleElementsAnimation.cancel();return}this.visibleElementsAnimation.sync(e)}get visibleElements(){return this.getPropertyValue("visibleElements")}get visible(){return this.getPropertyValue("visible",!0)}set visible(e){this.setPropertyValue("visible",e),this.onVisibleChangedCallback&&this.onVisibleChangedCallback()}get isNeedRender(){return this.getPropertyValue("isneedrender",!0)}set isNeedRender(e){this.setPropertyValue("isneedrender",e)}updateVisible(){for(var e=[],t=0;t<this.elements.length;t++)this.elements[t].isVisible&&e.push(this.elements[t]),(this.elements[t].isPanel||this.elements[t].getType()==="paneldynamic")&&(this.setIsLazyRendering(!1),this.stopLazyRendering());this.visibleElements=e}addElement(e){this.elements.push(e),this.updateVisible()}get index(){return this.panel.rows.indexOf(this)}setWidth(e){var t=e.length;if(t==0)return;const s=e.length===1;for(var i=[],r=0;r<this.elements.length;r++){var a=this.elements[r];if(a.isVisible){a.isSingleInRow=s;var o=this.getElementWidth(a);o&&(a.renderWidth=this.getRenderedWidthFromWidth(o),i.push(a)),a.rightIndent=0}else a.renderWidth=""}for(var r=0;r<this.elements.length;r++){var a=this.elements[r];!a.isVisible||i.indexOf(a)>-1||(i.length==0?a.renderWidth=`${Number.parseFloat((100/t).toFixed(6))}%`:a.renderWidth=this.getRenderedCalcWidth(a,i,t))}}getRenderedCalcWidth(e,t,s){for(var i="100%",r=0;r<t.length;r++)i+=" - "+t[r].renderWidth;var a=s-t.length;return a>1&&(i="("+i+")/"+a.toString()),"calc("+i+")"}getElementWidth(e){var t=e.width;return!t||typeof t!="string"?"":t.trim()}getRenderedWidthFromWidth(e){return L.isNumber(e)?e+"px":e}dispose(){super.dispose(),this.stopLazyRendering()}getRowCss(){return new j().append(this.panel.cssClasses.row).append(this.panel.cssClasses.rowCompact,this.panel.isCompact).append(this.panel.cssClasses.pageRow,this.panel.isPage||this.panel.showPanelAsPage).append(this.panel.cssClasses.rowMultiple,this.visibleElements.length>1).toString()}setRootElement(e){this.rootElement=e}getRootElement(){return this.rootElement}}class sr extends Ke{get gridLayoutColumns(){let e=this.getPropertyValue("gridLayoutColumns");return this._columns||(this.generateColumns([].concat(e)),e=this._columns,this.gridLayoutColumns=e),e}set gridLayoutColumns(e){this.setPropertyValue("gridLayoutColumns",e)}onAddRow(e){this.onRowVisibleChanged(),e.onVisibleChangedCallback=()=>this.onRowVisibleChanged()}getRowsAnimationOptions(){return{getRerenderEvent:()=>this.onElementRerendered,isAnimationEnabled:()=>this.animationAllowed,getAnimatedElement:e=>e.getRootElement(),getLeaveOptions:(e,t)=>({cssClass:this.cssClasses.rowLeave,onBeforeRunAnimation:ci,onAfterRunAnimation:Vs}),getEnterOptions:(e,t)=>{const s=this.cssClasses;return{cssClass:new j().append(s.rowEnter).append(s.rowDelayedEnter,t.isDeletingRunning).toString(),onBeforeRunAnimation:ci,onAfterRunAnimation:Vs}}}}get visibleRows(){return this.getPropertyValue("visibleRows")}set visibleRows(e){this.rowsAnimation.sync(e)}onRemoveRow(e){e.visibleElementsAnimation.cancel(),this.visibleRows=this.rows.filter(t=>t.visible),e.onVisibleChangedCallback=void 0}onRowVisibleChanged(){this.visibleRows=this.rows.filter(e=>e.visible)}constructor(e=""){super(e),this.isQuestionsReady=!1,this.questionsValue=new Array,this._columns=void 0,this._columnsReady=!1,this.rowsAnimation=new Xi(this.getRowsAnimationOptions(),t=>{this.setPropertyValue("visibleRows",t)},()=>this.visibleRows),this.isRandomizing=!1,this.onColumnPropertyValueChangedCallback=(t,s,i,r,a)=>{this._columnsReady&&(this.updateColumnWidth(this.gridLayoutColumns),this.updateRootStyle())},this.locCountRowUpdates=0,this.createNewArray("rows",(t,s)=>{this.onAddRow(t)},t=>{this.onRemoveRow(t)}),this.createNewArray("visibleRows"),this.createNewArray("gridLayoutColumns",t=>{t.onPropertyValueChangedCallback=this.onColumnPropertyValueChangedCallback}),this.elementsValue=this.createNewArray("elements",this.onAddElement.bind(this),this.onRemoveElement.bind(this)),this.setPropertyValueDirectly("id","sp_"+this.uniqueId),this.addExpressionProperty("visibleIf",(t,s)=>{this.visible=s===!0},t=>!this.areInvisibleElementsShowing),this.addExpressionProperty("enableIf",(t,s)=>{this.readOnly=s===!1}),this.addExpressionProperty("requiredIf",(t,s)=>{this.isRequired=s===!0}),this.createLocalizableString("requiredErrorText"),this.createLocalizableString("navigationTitle",this,!0).onGetTextCallback=t=>t||this.title||this.name,this.registerPropertyChangedHandlers(["questionTitleLocation"],()=>{this.onVisibleChanged.bind(this),this.updateElementCss(!0)}),this.registerPropertyChangedHandlers(["questionStartIndex","showQuestionNumbers"],()=>{this.updateVisibleIndexes()}),this.registerPropertyChangedHandlers(["title"],()=>{this.resetHasTextInTitle()})}getType(){return"panelbase"}setSurveyImpl(e,t){this.blockAnimations(),super.setSurveyImpl(e,t),this.isDesignMode&&this.onVisibleChanged();for(var s=0;s<this.elements.length;s++)this.elements[s].setSurveyImpl(e,t);this.releaseAnimations()}endLoadingFromJson(){super.endLoadingFromJson(),this.markQuestionListDirty(),this.onRowsChanged()}get hasTextInTitle(){return this.getPropertyValue("hasTextInTitle",void 0,()=>!!this.title)}resetHasTextInTitle(){this.resetPropertyValue("hasTextInTitle")}get hasTitle(){return this.canShowTitle(this.survey)&&(this.hasTextInTitle||this.locTitle.textOrHtml.length>0)||this.isDesignMode&&!this.isPanel&&this.showTitle&&D.designMode.showEmptyTitles}delete(e=!0){this.deletePanel(),this.removeFromParent(),e&&this.dispose()}deletePanel(){const e=this.elements;for(let t=0;t<e.length;t++){const s=e[t];s.isPanel&&s.deletePanel(),this.onRemoveElementNotifySurvey(s)}}removeFromParent(){}canShowTitle(e){return!0}getDefaultTitleTagName(){return D.titleTags.panel}get _showDescription(){return!this.hasTitle&&this.isDesignMode?!1:this.survey&&this.survey.showPageTitles&&this.hasDescription||this.showDescription&&this.isDesignMode&&D.designMode.showEmptyDescriptions}localeChanged(){super.localeChanged();for(var e=0;e<this.elements.length;e++)this.elements[e].localeChanged()}locStrsChanged(){super.locStrsChanged();for(var e=0;e<this.elements.length;e++)this.elements[e].locStrsChanged()}getMarkdownHtml(e,t,s){return t==="navigationTitle"&&this.locNavigationTitle.isEmpty?this.locTitle.renderedHtml||this.name:super.getMarkdownHtml(e,t,s)}get locNavigationTitle(){return this.getLocalizableString("navigationTitle")}get renderedNavigationTitle(){return this.locNavigationTitle.renderedHtml}get requiredMark(){return this.survey&&this.isRequired?this.survey.requiredMark:""}get requiredText(){return this.requiredMark}get titlePattern(){return this.survey?this.survey.questionTitlePattern:"numTitleRequire"}get isRequireTextOnStart(){return this.isRequired&&this.titlePattern=="requireNumTitle"}get isRequireTextBeforeTitle(){return this.isRequired&&this.titlePattern=="numRequireTitle"}get isRequireTextAfterTitle(){return this.isRequired&&this.titlePattern=="numTitleRequire"}get requiredErrorText(){return this.getLocalizableStringText("requiredErrorText")}set requiredErrorText(e){this.setLocalizableStringText("requiredErrorText",e)}get locRequiredErrorText(){return this.getLocalizableString("requiredErrorText")}get questionOrder(){return this.getPropertyValue("questionOrder")}set questionOrder(e){this.setPropertyValue("questionOrder",e)}get questionsOrder(){return this.questionOrder}set questionsOrder(e){this.questionOrder=e}get questionStartIndex(){return this.getPropertyValue("questionStartIndex","")}set questionStartIndex(e){this.setPropertyValue("questionStartIndex",e)}addNoFromChild(e){return e}canRandomize(e){return e&&this.questionOrder!=="initial"||this.questionOrder==="random"}randomizeElements(e){if(!this.canRandomize(e)||this.isRandomizing)return!1;this.isRandomizing=!0;for(var t=[],s=this.elements,i=0;i<s.length;i++)t.push(s[i]);const r=L.randomizeArray(t);return this.setArrayPropertyDirectly("elements",r,!1),this.updateRows(),this.updateVisibleIndexes(),this.isRandomizing=!1,!0}get areQuestionsRandomized(){var e=this.questionOrder=="default"&&this.survey?this.survey.questionOrder:this.questionOrder;return e=="random"}get parent(){return this.getPropertyValue("parent",null)}set parent(e){this.setPropertyValue("parent",e)}get depth(){return this.parent==null?0:this.parent.depth+1}get visibleIf(){return this.getPropertyValue("visibleIf","")}set visibleIf(e){this.setPropertyValue("visibleIf",e)}calcCssClasses(e){var t={panel:{},error:{},row:"",rowEnter:"",rowLeave:"",rowDelayedEnter:"",rowMultiple:"",pageRow:"",rowCompact:""};return this.copyCssClasses(t.panel,e.panel),this.copyCssClasses(t.error,e.error),e.pageRow&&(t.pageRow=e.pageRow),e.rowCompact&&(t.rowCompact=e.rowCompact),e.row&&(t.row=e.row),e.rowEnter&&(t.rowEnter=e.rowEnter),e.rowLeave&&(t.rowLeave=e.rowLeave),e.rowDelayedEnter&&(t.rowDelayedEnter=e.rowDelayedEnter),e.rowMultiple&&(t.rowMultiple=e.rowMultiple),this.survey&&this.survey.updatePanelCssClasses(this,t),t}get id(){return this.getPropertyValue("id")}set id(e){this.setPropertyValue("id",e)}get isPanel(){return!1}getPanels(){return[this]}getLayoutType(){return"row"}isLayoutTypeSupported(e){return e!=="flow"}get questions(){return this.isQuestionsReady||(this.questionsValue=this.getQuestionsCore(!1),this.isQuestionsReady=!0),this.questionsValue}get visibleQuestions(){return this.getQuestionsCore(!0)}getQuestionsCore(e){const t=new Array;for(let i=0;i<this.elements.length;i++){const r=this.elements[i];if(!(e&&!r.isVisible))if(r.isPanel){var s=r.getQuestionsCore(e);for(let a=0;a<s.length;a++)t.push(s[a])}else t.push(r)}return t}getQuestions(e){const t=this.questions;if(!e)return t;const s=[];return t.forEach(i=>{s.push(i),i.getNestedQuestions().forEach(r=>s.push(r))}),s}getQuestionByName(e){for(var t=this.questions,s=0;s<t.length;s++)if(t[s].name==e)return t[s];return null}getElementByName(e){if(e==this.name)return this;for(var t=this.elements,s=0;s<t.length;s++){var i=t[s];if(i.name==e)return i;const r=i.getPanels();if(Array.isArray(r))for(let a=0;a<r.length;a++){const o=r[a].getElementByName(e);if(o)return o}}return null}getQuestionByValueName(e,t=!1){const s=this.getQuestionsByValueName(e,t);return s.length>0?s[0]:null}getQuestionsByValueName(e,t=!1){const s=[];t&&(e=e.toLowerCase());for(var i=this.questions,r=0;r<i.length;r++){let a=i[r].getValueName();t&&(a=a.toLowerCase()),a==e&&s.push(i[r])}return s}getValue(){var e={};return this.collectValues(e,0),L.getUnbindValue(e)}hasValueAnyQuestion(e){const t=e?this.visibleQuestions:this.questions;for(let s=0;s<t.length;s++)if(!t[s].isEmpty())return!0;return!1}collectValues(e,t){let s=this.elements;t===0&&(s=this.questions);for(var i=0;i<s.length;i++){const o=s[i];if(o.isPanel||o.isPage){const l={};o.collectValues(l,t-1)&&(e[o.name]=l)}else{const l=o;if(!l.isEmpty()){var r=l.getValueName();if(e[r]=l.getStructuredValue(t-1),this.data){var a=this.data.getComment(r);a&&(e[r+de.commentSuffix]=a)}}}}return!0}getDisplayValue(e){for(var t={},s=this.questions,i=0;i<s.length;i++){var r=s[i];if(!r.isEmpty()){var a=e?r.title:r.getValueName();t[a]=r.getDisplayValue(e)}}return t}getComments(){var e={};if(!this.data)return e;for(var t=this.questions,s=0;s<t.length;s++){var i=t[s],r=this.data.getComment(i.getValueName());r&&(e[i.getValueName()]=r)}return e}clearIncorrectValues(){for(var e=0;e<this.elements.length;e++)this.elements[e].clearIncorrectValues()}clearErrors(){for(var e=0;e<this.elements.length;e++)this.elements[e].clearErrors();this.errors=[]}markQuestionListDirty(){this.isQuestionsReady=!1,this.parent&&this.parent.markQuestionListDirty()}get elements(){return de.collectDependency(this,"elements"),this.elementsValue}getElementsInDesign(e=!1){return this.elements}containsElement(e){for(var t=0;t<this.elements.length;t++){var s=this.elements[t];if(s==e)return!0;var i=s.getPanels();if(Array.isArray(i)){for(let r=0;r<i.length;r++)if(i[r].containsElement(e))return!0}}return!1}get isRequired(){return this.getPropertyValue("isRequired")}set isRequired(e){this.setPropertyValue("isRequired",e)}get requiredIf(){return this.getPropertyValue("requiredIf","")}set requiredIf(e){this.setPropertyValue("requiredIf",e)}searchText(e,t){super.searchText(e,t);for(var s=0;s<this.elements.length;s++)this.elements[s].searchText(e,t)}hasErrors(e=!0,t=!1){return!this.validate(e,t)}validate(e=!0,t=!1,s){const i=new kr({fireCallback:e,focusOnFirstError:t,callbackResult:s});return this.validateCore(i),i.finish(),i.runningResult}validateContainerOnly(){this.validateInPanels(new kr({fireCallback:!0,isOnValueChanged:!1})),this.parent&&this.parent.validateContainerOnly()}onQuestionValueChanged(e){const t=this.questions.indexOf(e);if(t<0)return;const s=5,i=this.questions.length-1,r=t-s>0?t-s:0,a=t+s<i?t+s:i;for(let o=r;o<=a;o++){if(o===t)continue;const l=this.questions[o];l.errors.length>0&&l.validate(!1)&&l.validate(!0)}}validateInPanels(e){var t=[];this.validateRequired(e,t),this.survey&&(this.survey.validatePanel(this,t,e.fireCallback),e.setErrorElement(this,t)),e.fireCallback&&(this.errors=t)}getErrorCustomText(e,t){return this.survey?this.survey.getSurveyErrorCustomText(this,e,t):e}validateRequired(e,t){if(!this.isRequired)return;var s=[];if(this.addQuestionsToList(s,!0),s.length==0)return;for(var i=0;i<s.length;i++)if(!s[i].isEmpty())return;const r=new LR(this.requiredErrorText,this);t.push(r),e.setErrorElement(s[0],[r])}validateElement(e){const t=e.errorCount;return this.validateCore(e),e.errorCount<=t}validateCore(e){var t;let s=(t=this.survey)===null||t===void 0?void 0:t.currentSingleQuestion;s&&this.questions.indexOf(s)<0&&(s=void 0);const i=s?[s]:this.elements;let r=null;for(var a=0;a<i.length;a++)if(r=i[a],!!r.isVisible)if(r.isPanel)r.validateCore(e);else{var o=r;o.validateElement(e)}s||(this.validateInPanels(e),this.updateContainsErrors())}getContainsErrors(){var e=super.getContainsErrors();if(e)return e;for(var t=this.elements,s=0;s<t.length;s++)if(t[s].containsErrors)return!0;return!1}updateElementVisibility(){for(let e=0;e<this.elements.length;e++)this.elements[e].updateElementVisibility();super.updateElementVisibility()}getFirstQuestionToFocus(e=!1,t=!1){if(!e&&!t&&this.isCollapsed)return null;for(var s=this.elements,i=0;i<s.length;i++){var r=s[i];if(!(!r.isVisible||!t&&r.isCollapsed))if(r.isPanel){var a=r.getFirstQuestionToFocus(e,t);if(a)return a}else{const o=r.getFirstQuestionToFocus(e);if(o)return o}}return null}getFirstVisibleQuestion(){const e=this.questions;for(let t=0;t<e.length;t++)if(e[t].isVisible)return e[t];return null}getFirstVisibleElement(){const e=this.elements;for(let t=0;t<e.length;t++)if(e[t].isVisible)return e[t];return null}focusFirstQuestion(){const e=this.getFirstQuestionToFocus();e&&e.focus()}focusFirstErrorQuestion(){var e=this.getFirstQuestionToFocus(!0);e&&e.focus()}addQuestionsToList(e,t=!1,s=!1){this.addElementsToList(e,t,s,!1)}addPanelsIntoList(e,t=!1,s=!1){this.addElementsToList(e,t,s,!0)}addElementsToList(e,t,s,i){t&&!this.visible||this.addElementsToListCore(e,this.elements,t,s,i)}addElementsToListCore(e,t,s,i,r){for(var a=0;a<t.length;a++){var o=t[a];s&&!o.visible||((r&&o.isPanel||!r&&!o.isPanel)&&e.push(o),o.isPanel?o.addElementsToListCore(e,o.elements,s,i,r):i&&this.addElementsToListCore(e,o.getElementsInDesign(!1),s,i,r))}}calcMaxRowColSpan(){let e=0;return this.rows.forEach(t=>{let s=0,i=!1;t.elements.forEach(r=>{r.width&&(i=!0),s+=r.colSpan||1}),!i&&s>e&&(e=s)}),e}updateColumnWidth(e){let t=0,s=0;if(e.forEach(i=>{i.width?(t+=i.width,i.setPropertyValue("effectiveWidth",i.width)):s++}),s){const i=ER((100-t)/s);for(let r=0;r<e.length;r++)e[r].width||e[r].setPropertyValue("effectiveWidth",i)}}updateColumns(){this._columns=void 0,this.updateRootStyle()}updateRootStyle(){var e;super.updateRootStyle(),(e=this.elements)===null||e===void 0||e.forEach(t=>t.updateRootStyle())}updateCustomWidgets(){for(var e=0;e<this.elements.length;e++)this.elements[e].updateCustomWidgets()}get questionTitleLocation(){return this.getPropertyValue("questionTitleLocation")}set questionTitleLocation(e){this.setPropertyValue("questionTitleLocation",e.toLowerCase())}getQuestionTitleLocation(){return this.onGetQuestionTitleLocation?this.onGetQuestionTitleLocation():this.questionTitleLocation!="default"?this.questionTitleLocation:this.parent?this.parent.getQuestionTitleLocation():this.survey?this.survey.questionTitleLocation:"top"}availableQuestionTitleWidth(){return this.getQuestionTitleLocation()==="left"||this.hasElementWithTitleLocationLeft()}hasElementWithTitleLocationLeft(){return this.elements.some(t=>{if(t instanceof sr)return t.hasElementWithTitleLocationLeft();if(t instanceof kt)return t.getTitleLocation()==="left"})}getQuestionTitleWidth(){return(this.onGetQuestionTitleWidth?this.onGetQuestionTitleWidth():this.questionTitleWidth)||this.parent&&this.parent.getQuestionTitleWidth()}get columns(){return this._columns||(this.generateColumns(this.gridLayoutColumns),this.gridLayoutColumns=this._columns),this._columns||[]}generateColumns(e){var t;const s=(t=this.survey)===null||t===void 0?void 0:t.gridLayoutEnabled;let i=[].concat(e);if(s){let r=this.calcMaxRowColSpan();if(r<=e.length)i=e.slice(0,r);else for(let a=e.length;a<r;a++){const o=new Tn;i.push(o)}}this._columns=i;try{this._columnsReady=!1,this.updateColumnWidth(i)}finally{this._columnsReady=!0}}createGridLayoutColumns(){return this.generateColumns([]),this._columns}updateGridColumns(){this.updateColumns(),this.elements.forEach(e=>{e.isPanel&&e.updateGridColumns()})}getColumsForElement(e){const t=this.findRowByElement(e);if(!t||!this.survey||!this.survey.gridLayoutEnabled)return[];let s=t.elements.length-1;for(;s>=0&&t.elements[s].getPropertyValueWithoutDefault("colSpan");)s--;const i=t.elements.indexOf(e);let r=0;for(let l=0;l<i;l++)r+=t.elements[l].colSpan;let a=e.getPropertyValueWithoutDefault("colSpan");if(!a&&i===s){let l=0;for(let u=0;u<t.elements.length;u++)u!==s&&(l+=t.elements[u].colSpan);a=this.columns.length-l}const o=this.columns.slice(r,r+(a||1));return e.setPropertyValueDirectly("effectiveColSpan",o.length),o}isQuestionIndexRecursive(){return!!this.survey&&this.survey.showQuestionNumbers==="recursive"}getQuestionStartIndex(){const e=this.getStartIndex();return this.isQuestionIndexRecursive()?this.getStartIndexSubs(e,!0):e}getStartIndexSubs(e,t){if(!e||!this.isComplexIndex(e))return e;const s=e[e.length-1]==="."?".":"";s&&(e=e.substring(0,e.length-1));const i=e.lastIndexOf(".");return e+=s,t?e.substring(i+1):e.substring(0,i+1)}getQuestionStartIndexVsVisibleIndex(e,t){const s=this.getStartIndexSubs(e,!1),i=this.getStartIndexSubs(e,!0);return L.getNumberByIndex(t,s)+i}isComplexIndex(e){const t=e.indexOf(".");return t>-1&&t<e.length-1}getChildrenLayoutType(){return"row"}getProgressInfo(){return Ke.getProgressInfoByElements(this.elements,this.isRequired)}get root(){for(var e=this;e.parent;)e=e.parent;return e}childVisibilityChanged(){if(!this.isRunningConditions){var e=this.getIsPageVisible(null),t=this.getPropertyValue("isVisible",!0);e!==t&&this.onVisibleChanged()}}canRenderFirstRows(){return this.isPage}isLazyRenderInRow(e){return!this.survey||!this.survey.isLazyRendering?!1:e>=this.survey.lazyRenderFirstBatchSize||!this.canRenderFirstRows()}createRowAndSetLazy(e){const t=this.createRow();return t.setIsLazyRendering(this.isLazyRenderInRow(e)),t}createRow(){return new y_(this)}onSurveyLoad(){this.blockAnimations(),super.onSurveyLoad();for(var e=0;e<this.elements.length;e++)this.elements[e].onSurveyLoad();this.onElementVisibilityChanged(this),this.releaseAnimations()}onFirstRenderingCore(){super.onFirstRenderingCore(),this.onRowsChanged(),this.elements.forEach(e=>e.onFirstRendering())}updateRows(){this.isLoadingFromJson||(this.getElementsForRows().forEach(e=>{e.isPanel&&e.updateRows()}),this.onRowsChanged())}get rows(){return this.getPropertyValue("rows")}ensureRowsVisibility(){this.rows.forEach(e=>{e.ensureVisibility()})}onRowsChanged(){this.isLoadingFromJson||!this.wasRendered||(this.blockAnimations(),this.setArrayPropertyDirectly("rows",this.buildRows()),this.updateColumns(),this.releaseAnimations())}blockRowsUpdates(){this.locCountRowUpdates++}releaseRowsUpdates(){this.locCountRowUpdates--}updateRowsBeforeElementRemoved(e){if(!this.wasRendered&&this.rows.length===0)return;const t=this.findRowByElement(e),s=this.rows.indexOf(t),i=t.elements.indexOf(e);t.elements.splice(i,1),t.elements.length==0?this.rows.splice(s,1):!t.elements[0].startWithNewLine&&this.rows[s-1]?(t.elements.forEach(r=>this.rows[s-1].addElement(r)),this.rows.splice(s,1)):t.updateVisible()}updateRowsOnElementAdded(e){if(!this.wasRendered&&this.rows.length===0&&this.elements.length>1)return;const t=this.elements.indexOf(e),s=this.elements[t+1],i=u=>{const d=this.createRowAndSetLazy(u);return this.isDesignMode&&d.setIsLazyRendering(!1),this.rows.splice(u,0,d),d},r=(u,d,h,...f)=>{const C=u.elements.splice(d,h,...f);return u.updateVisible(),C};if(!s){t==0||e.startWithNewLine?r(i(this.rows.length),0,0,e):this.rows[this.rows.length-1].addElement(e);return}const a=this.findRowByElement(s);if(!a)return;const o=this.rows.indexOf(a),l=a.elements.indexOf(s);l==0?s.startWithNewLine?e.startWithNewLine||o<1?i(o).addElement(e):this.rows[o-1].addElement(e):r(a,0,0,e):e.startWithNewLine?r(i(o+1),0,0,...[e].concat(r(a,l,a.elements.length))):r(a,l,0,e)}canFireAddRemoveNotifications(e){return!!this.survey&&e.prevSurvey!==this.survey}onAddElement(e,t){const s=this.survey,i=this.canFireAddRemoveNotifications(e);this.surveyImpl&&e.setSurveyImpl(this.surveyImpl),e.parent=this,this.markQuestionListDirty(),this.canBuildRows()&&this.updateRowsOnElementAdded(e),i&&(e.isPanel?s.panelAdded(e,t,this,this.root):s.questionAdded(e,t,this,this.root)),this.addElementCallback&&this.addElementCallback(e),e.registerPropertyChangedHandlers(["visible","isVisible"],()=>{this.onElementVisibilityChanged(e)},this.id),e.registerPropertyChangedHandlers(["startWithNewLine"],()=>{this.onElementStartWithNewLineChanged(e)},this.id),this.onElementVisibilityChanged(this)}onRemoveElement(e){e.parent=null,this.unregisterElementPropertiesChanged(e),this.markQuestionListDirty(),this.updateRowsOnElementRemoved(e),!this.isRandomizing&&(this.onRemoveElementNotifySurvey(e),this.removeElementCallback&&this.removeElementCallback(e),this.onElementVisibilityChanged(this))}unregisterElementPropertiesChanged(e){e.unregisterPropertyChangedHandlers(["visible","isVisible","startWithNewLine"],this.id)}onRemoveElementNotifySurvey(e){this.canFireAddRemoveNotifications(e)&&(e.isPanel?this.survey.panelRemoved(e):this.survey.questionRemoved(e))}onElementVisibilityChanged(e){this.isLoadingFromJson||this.isRandomizing||(this.updateRowsVisibility(e),this.childVisibilityChanged(),this.parent&&this.parent.onElementVisibilityChanged(this))}onElementStartWithNewLineChanged(e){this.locCountRowUpdates>0||(this.blockAnimations(),this.updateRowsBeforeElementRemoved(e),this.updateRowsOnElementAdded(e),this.releaseAnimations())}updateRowsVisibility(e){for(var t=this.rows,s=0;s<t.length;s++){var i=t[s];if(i.elements.indexOf(e)>-1){i.updateVisible(),i.visible&&!i.isNeedRender&&(i.isNeedRender=!0);break}}}canBuildRows(){return!this.isLoadingFromJson&&this.getChildrenLayoutType()=="row"}buildRows(){if(!this.canBuildRows())return[];const e=new Array,t=this.getElementsForRows();for(let s=0;s<t.length;s++){const i=t[s],r=s==0||i.startWithNewLine,a=r?this.createRowAndSetLazy(e.length):e[e.length-1];r&&e.push(a),a.addElement(i)}return e.forEach(s=>s.updateVisible()),e}getElementsForRows(){return this.elements}getDragDropInfo(){const e=this.getPage(this.parent);return e?e.getDragDropInfo():void 0}updateRowsOnElementRemoved(e){this.canBuildRows()&&(this.updateRowsRemoveElementFromRow(e,this.findRowByElement(e)),this.updateColumns())}updateRowsRemoveElementFromRow(e,t){if(!(!t||!t.panel)){var s=t.elements.indexOf(e);s<0||(t.elements.splice(s,1),t.elements.length>0?(this.blockRowsUpdates(),t.elements[0].startWithNewLine=!0,this.releaseRowsUpdates(),t.updateVisible()):t.index>=0&&t.panel.rows.splice(t.index,1))}}getAllRows(){const e=[];return this.rows.forEach(t=>{const s=[];t.elements.forEach(i=>{i.isPanel?s.push(...i.getAllRows()):i.getType()=="paneldynamic"&&(this.isDesignMode?s.push(...i.template.getAllRows()):i.panels.forEach(r=>s.push(...r.getAllRows())))}),e.push(t),e.push(...s)}),e}findRowAndIndexByElement(e,t){if(!e)return{row:void 0,index:this.rows.length-1};t=t||this.rows;for(var s=0;s<t.length;s++)if(t[s].elements.indexOf(e)>-1)return{row:t[s],index:s};return{row:null,index:-1}}forceRenderRow(e){e&&!e.isNeedRender&&(e.isNeedRender=!0,e.stopLazyRendering())}forceRenderElement(e,t=()=>{},s=0){const i=this.getAllRows(),{row:r,index:a}=this.findRowAndIndexByElement(e,i);if(a>=0&&a<i.length){const o=[];o.push(r);for(let l=a-1;l>=a-s&&l>=0;l--)o.push(i[l]);this.forceRenderRows(o,t)}}forceRenderRows(e,t=()=>{}){const s=(i=>()=>{i--,i<=0&&t()})(e.length);e.forEach(i=>new hR(i.visibleElements,s)),e.forEach(i=>this.forceRenderRow(i))}findRowByElement(e){return this.findRowAndIndexByElement(e).row}elementWidthChanged(e){if(!this.isLoadingFromJson){var t=this.findRowByElement(e);t&&t.updateVisible()}}get ariaTitleId(){return this.id+"_ariaTitle"}get ariaLabelledBy(){return this.hasTitle?this.ariaTitleId:null}get ariaLabel(){return this.hasTitle?null:this.title||this.name||null}get ariaRole(){return"group"}get processedTitle(){return this.getRenderedTitle(this.locTitle.textOrHtml)}getRenderedTitle(e){return this.textProcessor!=null?this.textProcessor.processText(e,!0):e}get visible(){return this.getPropertyValue("visible")}set visible(e){e!==this.visible&&(this.setPropertyValue("visible",e),this.setPropertyValue("isVisible",this.isVisible),this.isLoadingFromJson||this.onVisibleChanged())}onHidingContent(){this.questions.forEach(e=>e.onHidingContent())}onVisibleChanged(){if(!this.isRandomizing&&(this.setPropertyValue("isVisible",this.isVisible),this.canUpdateValueOnVisibleChanged())){const t=this.questions,s=this.isVisible;for(var e=0;e<t.length;e++){const i=t[e];s?i.updateValueWithDefaults():(i.clearValueIfInvisible("onHiddenContainer"),i.onHidingContent())}}}notifyStateChanged(e){super.notifyStateChanged(e),this.isCollapsed&&this.questions.forEach(t=>t.onHidingContent())}get isVisible(){return this.areInvisibleElementsShowing||this.getIsPageVisible(null)}getIsContentVisible(e){if(this.areInvisibleElementsShowing)return!0;for(var t=0;t<this.elements.length;t++)if(this.elements[t]!=e&&this.elements[t].isVisible)return!0;return!1}getIsPageVisible(e){const t=this.getIsContentVisible(e);return this.visible&&t}setVisibleIndex(e){if(!this.isVisible||e<0)return this.resetVisibleIndexes(),0;this.lastVisibleIndex=e;var t=e;e+=this.beforeSetVisibleIndex(e);var s=this.getPanelStartIndex(e),i=s;const r=this.elements;for(var a=0;a<r.length;a++)i+=r[a].setVisibleIndex(i);return this.isContinueNumbering()&&(e+=i-s),e-t}updateVisibleIndexes(){this.lastVisibleIndex!==void 0&&(this.resetVisibleIndexes(),this.setVisibleIndex(this.lastVisibleIndex))}resetVisibleIndexes(){const e=this.elements;for(var t=0;t<e.length;t++)e[t].setVisibleIndex(-1)}beforeSetVisibleIndex(e){return 0}getPanelStartIndex(e){return e}isContinueNumbering(){return!0}get isReadOnly(){var e=!!this.parent&&this.parent.isReadOnly,t=!!this.survey&&this.survey.isDisplayMode;return this.readOnly||e||t}onReadOnlyChanged(){for(var e=0;e<this.elements.length;e++){var t=this.elements[e];t.setPropertyValue("isReadOnly",t.isReadOnly)}super.onReadOnlyChanged()}updateElementCss(e){super.updateElementCss(e);for(let t=0;t<this.elements.length;t++)this.elements[t].updateElementCss(e)}get enableIf(){return this.getPropertyValue("enableIf","")}set enableIf(e){this.setPropertyValue("enableIf",e)}addElement(e,t=-1){return this.canAddElement(e)?(t<0||t>=this.elements.length?this.elements.push(e):this.elements.splice(t,0,e),this.wasRendered&&e.onFirstRendering(),this.updateColumns(),!0):!1}insertElement(e,t,s="bottom"){if(!t){this.addElement(e);return}this.blockRowsUpdates();let i=this.elements.indexOf(t);const r=this.findRowByElement(t);s=="left"||s=="right"?s=="right"?(e.startWithNewLine=!1,i++):r.elements.indexOf(t)==0?(t.startWithNewLine=!1,e.startWithNewLine=!0):e.startWithNewLine=!1:(e.startWithNewLine=!0,s=="top"?i=this.elements.indexOf(r.elements[0]):i=this.elements.indexOf(r.elements[r.elements.length-1])+1),this.releaseRowsUpdates(),this.addElement(e,i)}insertElementAfter(e,t){const s=this.elements.indexOf(t);s>=0&&this.addElement(e,s+1)}insertElementBefore(e,t){const s=this.elements.indexOf(t);s>=0&&this.addElement(e,s)}canAddElement(e){return!!e&&e.isLayoutTypeSupported(this.getChildrenLayoutType())}addQuestion(e,t=-1){return this.addElement(e,t)}addPanel(e,t=-1){return this.addElement(e,t)}addNewQuestion(e,t=null,s=-1){var i=Qe.Instance.createQuestion(e,t);return this.addQuestion(i,s)?i:null}addNewPanel(e=null){var t=this.createNewPanel(e);return this.addPanel(t)?t:null}indexOf(e){return this.elements.indexOf(e)}createNewPanel(e){var t=B.createClass("panel");return t.name=e,t}removeElement(e){var t=this.elements.indexOf(e);if(t<0){for(var s=0;s<this.elements.length;s++)if(this.elements[s].removeElement(e))return!0;return!1}return this.elements.splice(t,1),this.updateColumns(),!0}removeQuestion(e){this.removeElement(e)}runCondition(e){if(this.isDesignMode||this.isLoadingFromJson)return;var t=this.elements.slice();const s=this.getIsPageVisible();this.isRunningConditions=!0;for(var i=0;i<t.length;i++)t[i].runCondition(e);this.runConditionCore(e);const r=this.getIsPageVisible();this.isRunningConditions=!1,s!==r&&this.childVisibilityChanged()}onAnyValueChanged(e,t){for(var s=this.elements,i=0;i<s.length;i++)s[i].onAnyValueChanged(e,t)}checkBindings(e,t){for(var s=this.elements,i=0;i<s.length;i++)s[i].checkBindings(e,t)}needResponsiveWidth(){let e=!1;return this.elements.forEach(t=>{t.needResponsiveWidth()&&(e=!0)}),this.rows.forEach(t=>{t.elements.length>1&&(e=!0)}),e}get hasDescriptionUnderTitle(){return this.hasDescription}get cssHeader(){return this.cssClasses.panel.header}get cssDescription(){return this.cssClasses.panel.description}get questionErrorLocation(){return this.getPropertyValue("questionErrorLocation")}set questionErrorLocation(e){this.setPropertyValue("questionErrorLocation",e)}getQuestionErrorLocation(){return this.questionErrorLocation!=="default"?this.questionErrorLocation:this.parent?this.parent.getQuestionErrorLocation():this.survey?this.survey.questionErrorLocation:"top"}getTitleOwner(){return this}get no(){return""}get cssTitleNumber(){return this.cssClasses.panel.number}get cssRequiredMark(){return this.cssClasses.panel.requiredMark}get cssError(){return this.getCssError(this.cssClasses)}getCssError(e){return new j().append(e.error.root).toString()}getSerializableColumnsValue(){let e=-1;for(let t=this.gridLayoutColumns.length-1;t>=0;t--)if(!this.gridLayoutColumns[t].isEmpty()){e=t;break}return this.gridLayoutColumns.slice(0,e+1)}afterRender(e){this.afterRenderCore(e)}dispose(){if(super.dispose(),this.rows){for(let e=0;e<this.rows.length;e++)this.rows[e].dispose();this.rows.splice(0,this.rows.length)}this.disposeElements(),this.elements.splice(0,this.elements.length)}disposeElements(){for(let e=0;e<this.elements.length;e++)this.elements[e].dispose()}}I([R({defaultValue:!0})],sr.prototype,"showTitle",void 0),I([R({defaultValue:!0})],sr.prototype,"showDescription",void 0),I([R()],sr.prototype,"questionTitleWidth",void 0);class Qr extends sr{constructor(e=""){super(e),this.forcusFirstQuestionOnExpand=!0,this.createNewArray("footerActions"),this.registerPropertyChangedHandlers(["width"],()=>{this.parent&&this.parent.elementWidthChanged(this)}),this.registerPropertyChangedHandlers(["indent","innerIndent","rightIndent"],()=>{this.resetIndents()}),this.registerPropertyChangedHandlers(["colSpan"],()=>{var t;(t=this.parent)===null||t===void 0||t.updateColumns()})}getType(){return"panel"}get contentId(){return this.id+"_content"}getSurvey(e=!1){return e&&this.isPanel?this.parent?this.parent.getSurvey(e):null:super.getSurvey(e)}get isPanel(){return!0}get page(){return this.getPage(this.parent)}set page(e){this.setPage(this.parent,e)}removeFromParent(){this.parent&&this.removeSelfFromList(this.parent.elements)}moveTo(e,t=null){return this.moveToBase(this.parent,e,t)}getPanelInDesignMode(){return this}get visibleIndex(){return this.getPropertyValue("visibleIndex",-1)}get showNumber(){return this.getPropertyValue("showNumber")}set showNumber(e){this.setPropertyValue("showNumber",e),this.notifySurveyOnVisibilityChanged()}addNoFromChild(e){let t=this.getRecursiveNo();return t?(t[t.length-1]!=="."&&this.canAddDot(e)&&(t+="."),t+e):super.addNoFromChild(e)}getRecursiveNo(){return this.recursiveNoCallback?this.recursiveNoCallback():this.isQuestionIndexRecursive()?this.calcNo():""}canAddDot(e){return!!e&&new RegExp("^[\\p{L}\\d]","u").test(e[0])}get showQuestionNumbers(){return this.getPropertyValue("showQuestionNumbers")}set showQuestionNumbers(e){this.setPropertyValue("showQuestionNumbers",e),this.notifySurveyOnVisibilityChanged()}getPageVisibleIndex(){var e;return((e=this.page)===null||e===void 0?void 0:e.visibleIndex)||-1}getQuestionStartIndex(){const e=this.questionStartIndex;return e&&this.isQuestionIndexOnPanel&&this.isComplexIndex(e)?this.getQuestionStartIndexVsVisibleIndex(e,this.visibleIndex):e||super.getQuestionStartIndex()}get no(){return this.getPropertyValue("no",void 0,()=>this.calcNo())}calcNo(){let e=this.hasTitle?L.getNumberByIndex(this.visibleIndex,this.getStartIndex()):"";return this.onGetNoCallback&&(e=this.onGetNoCallback(e)),this.parent&&(e=this.parent.addNoFromChild(e)),this.survey&&(e=this.survey.getUpdatedPanelNo(this,e)),e||""}notifyStateChanged(e){this.isLoadingFromJson||this.locTitle.strChanged(),super.notifyStateChanged(e)}createLocTitleProperty(){const e=super.createLocTitleProperty();return e.onGetTextCallback=t=>(!t&&this.state!=="default"&&(t=this.name),t),e}beforeSetVisibleIndex(e){if(this.isPage||!this.parent)return super.beforeSetVisibleIndex(e);let t=-1;return(this.showNumber||this.isQuestionIndexRecursive())&&(this.isDesignMode||!this.locTitle.isEmpty||this.hasParentInQuestionIndex())&&(t=e),this.setPropertyValue("visibleIndex",t),this.resetPropertyValue("no"),t<0?0:1}getPanelStartIndex(e){return this.showQuestionNumbers==="off"?-1:this.isQuestionIndexOnPanel?0:e}get isQuestionIndexOnPanel(){return this.showQuestionNumbers==="onpanel"||this.isQuestionIndexRecursive()}isQuestionIndexRecursive(){const e=this.showQuestionNumbers;return e!=="default"?e==="recursive":super.isQuestionIndexRecursive()}hasParentInQuestionIndex(){if(!this.isQuestionIndexOnPanel)return!1;const e=this.questionStartIndex,t=e.indexOf(".");return t>-1&&t<e.length-1}isContinueNumbering(){return this.showQuestionNumbers!=="off"&&!this.isQuestionIndexOnPanel}notifySurveyOnVisibilityChanged(){this.survey!=null&&!this.isLoadingFromJson&&this.survey.panelVisibilityChanged(this,this.isVisible)}getRenderedTitle(e){if(this.isPanel&&!e){if(this.isCollapsed||this.isExpanded)return this.name;if(this.isDesignMode)return"["+this.name+"]"}return super.getRenderedTitle(e)}get innerIndent(){return this.getPropertyValue("innerIndent")}set innerIndent(e){this.setPropertyValue("innerIndent",e)}get startWithNewLine(){return this.getPropertyValue("startWithNewLine")}set startWithNewLine(e){this.setPropertyValue("startWithNewLine",e)}get allowAdaptiveActions(){return this.getPropertyValue("allowAdaptiveActions")}set allowAdaptiveActions(e){this.setPropertyValue("allowAdaptiveActions",e)}get innerPaddingLeft(){const e=()=>this.getIndentSize(this.innerIndent);return this.getPropertyValue("innerPaddingLeft",void 0,e)}set innerPaddingLeft(e){this.setPropertyValue("innerPaddingLeft",e)}calcPaddingLeft(){return this.getIndentSize(this.indent)}calcPaddingRight(){return this.getIndentSize(this.rightIndent)}resetIndents(){this.resetPropertyValue("innerPaddingLeft"),super.resetIndents()}getIndentSize(e){if(this.survey){if(e<1)return"";var t=this.survey.css;return!t||!t.question||!t.question.indent?"":e*t.question.indent+"px"}}clearOnDeletingContainer(){this.elements.forEach(e=>{(e instanceof kt||e instanceof Qr)&&e.clearOnDeletingContainer()})}get footerActions(){return this.getPropertyValue("footerActions")}getFooterToolbar(){var e,t;if(!this.footerToolbarValue){var s=this.footerActions;this.hasEditButton&&s.push({id:"cancel-preview",locTitle:this.survey.locEditText,innerCss:this.survey.cssNavigationEdit,component:"sv-nav-btn",action:()=>{this.cancelPreview()}}),this.onGetFooterActionsCallback?s=this.onGetFooterActionsCallback():s=(e=this.survey)===null||e===void 0?void 0:e.getUpdatedPanelFooterActions(this,s),this.footerToolbarValue=this.createActionContainer(this.allowAdaptiveActions);let i=this.onGetFooterToolbarCssCallback?this.onGetFooterToolbarCssCallback():"";i||(i=(t=this.cssClasses.panel)===null||t===void 0?void 0:t.footer),i&&(this.footerToolbarValue.containerCss=i),this.footerToolbarValue.setItems(s),this.footerToolbarValue.flushUpdates()}return this.footerToolbarValue}get hasEditButton(){return!1}cancelPreview(){this.hasEditButton&&this.survey.cancelPreviewByPage(this)}get cssTitle(){return this.getCssPanelTitle()}getCssPanelTitle(){return this.getCssTitle(this.cssClasses.panel)}getCssTitleExpandableSvg(){return this.state==="default"?null:this.cssClasses.panel.titleExpandableSvg}get showErrorsAbovePanel(){return!this.showPanelAsPage}getCssError(e){if(this.isPage)return super.getCssError(e);const t=new j().append(super.getCssError(e)).append(e.panel.errorsContainer);return t.append("panel-error-root",t.isEmpty()).toString()}onVisibleChanged(){super.onVisibleChanged(),this.notifySurveyOnVisibilityChanged()}needResponsiveWidth(){return this.startWithNewLine?super.needResponsiveWidth():!0}focusIn(){this.survey&&this.survey.whenPanelFocusIn(this)}getHasFrameV2(){return super.getHasFrameV2()&&!this.showPanelAsPage}getIsNested(){return super.getIsNested()&&this.parent!==void 0}get showPanelAsPage(){return!1}expand(e=!0){this.forcusFirstQuestionOnExpand=e,super.expand()}onElementExpanded(e){if(this.forcusFirstQuestionOnExpand&&this.survey!=null&&!this.isLoadingFromJson){const t=this.getFirstQuestionToFocus(!1);t&&setTimeout(()=>{!this.isDisposed&&this.survey&&this.survey.scrollElementToTop(t,t,null,t.inputId,!1,{behavior:"smooth"})},e?0:15)}}getCssRoot(e){return new j().append(super.getCssRoot(e)).append(e.container).append(e.asPage,this.showPanelAsPage).append(e.invisible,!this.isDesignMode&&this.areInvisibleElementsShowing&&!this.visible).toString()}getContainerCss(){return this.getCssRoot(this.cssClasses.panel)}afterRenderCore(e){var t;super.afterRenderCore(e),this.isPanel&&((t=this.survey)===null||t===void 0||t.afterRenderPanel(this,e))}}B.addClass("panelbase",["name",{name:"elements",alternativeName:"questions",baseClassName:"question",visible:!1,isLightSerializable:!1},{name:"visible:switch",default:!0,overridingProperty:"visibleIf"},{name:"readOnly:boolean",overridingProperty:"enableIf"},"visibleIf:condition","enableIf:condition","requiredIf:condition",{name:"questionTitleWidth",visibleIf:function(n){return!!n&&n.availableQuestionTitleWidth()}},{name:"questionTitleLocation",default:"default",choices:["default","top","bottom","left","hidden"]},{name:"gridLayoutColumns:panellayoutcolumns",className:"panellayoutcolumn",isArray:!0,onSerializeValue:n=>n.getSerializableColumnsValue(),visibleIf:function(n){return!!n&&!!n.survey&&n.survey.gridLayoutEnabled}},{name:"title:text",serializationProperty:"locTitle"},{name:"description:text",serializationProperty:"locDescription"},{name:"questionOrder",alternativeName:"questionsOrder",default:"default",choices:["default","initial","random"]},{name:"questionErrorLocation",default:"default",choices:["default","top","bottom"]}],function(){return new sr}),B.addClass("panel",[{name:"state",default:"default",choices:["default","collapsed","expanded"]},{name:"isRequired:switch",overridingProperty:"requiredIf"},{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText"},{name:"startWithNewLine:boolean",default:!0},{name:"width"},{name:"minWidth",defaultFunc:()=>"auto"},{name:"maxWidth",defaultFunc:()=>D.maxWidth},{name:"colSpan:number",visible:!1,onSerializeValue:n=>n.getPropertyValue("colSpan")},{name:"effectiveColSpan:number",minValue:1,isSerializable:!1,visibleIf:function(n){return!!n.survey&&n.survey.gridLayoutEnabled}},{name:"innerIndent:number",default:0,choices:[0,1,2,3]},{name:"indent:number",default:0,choices:[0,1,2,3],visible:!1},{name:"page",isSerializable:!1,visibleIf:function(n){var e=n?n.survey:null;return!e||!e.pages||e.pages.length>1},choices:function(n){var e=n?n.survey:null;return e?e.pages.map(t=>({value:t.name,text:t.title})):[]}},{name:"showNumber:boolean"},{name:"showQuestionNumbers",default:"default",choices:["default","onpanel","recursive","off"]},{name:"questionStartIndex",visibleIf:n=>n.isPanel},{name:"allowAdaptiveActions:boolean",default:!0,visible:!1}],function(){return new Qr},"panelbase"),gi.Instance.registerElement("panel",n=>new Qr(n));class kd extends Qr{constructor(e=""){super(e),this.timeSpent=0,this._isReadyForClean=!0,this.createLocalizableString("navigationDescription",this,!0)}getType(){return"page"}toString(){return this.name}get isPage(){return!this.isPanel}get isPanel(){return!!this.parent}get showPanelAsPage(){return!0}get hasEditButton(){return this.isPanel&&this.survey&&this.survey.state==="preview"&&!!this.parent&&!this.parent.isPanel}getElementsForRows(){var e;if(!this.isStartPage){const t=(e=this.survey)===null||e===void 0?void 0:e.currentSingleElement;if(t)return t.page===this?[t]:[]}return super.getElementsForRows()}disposeElements(){this.isPageContainer||super.disposeElements()}onRemoveElement(e){this.isPageContainer?(e.parent=null,this.unregisterElementPropertiesChanged(e)):super.onRemoveElement(e)}getTemplate(){return this.isPanel?"panel":super.getTemplate()}getPanelInDesignMode(){return null}get no(){if(!this.canShowPageNumber()||!this.survey)return"";let e=this.isStartPage?"":this.num+". ";return this.survey.getUpdatedPageNo(this,e)}addNoFromChild(e){return e}get cssTitleNumber(){return this.isPanel?this.cssClasses.panel.number:this.cssClasses.page.number}getCssTitleExpandableSvg(){return null}get cssRequiredMark(){return""}canShowPageNumber(){return this.survey&&this.survey.showPageNumbers}canShowTitle(e){return!e||e.showPageTitles}setTitleValue(e){super.setTitleValue(e),this.navigationLocStrChanged()}getDefaultTitleTagName(){return D.titleTags.page}get navigationTitle(){return this.getLocalizableStringText("navigationTitle")}set navigationTitle(e){this.setLocalizableStringText("navigationTitle",e)}get navigationDescription(){return this.getLocalizableStringText("navigationDescription")}set navigationDescription(e){this.setLocalizableStringText("navigationDescription",e)}get locNavigationDescription(){return this.getLocalizableString("navigationDescription")}navigationLocStrChanged(){this.locNavigationTitle.isEmpty&&this.locTitle.strChanged(),this.locNavigationTitle.strChanged(),this.locNavigationDescription.strChanged()}getMarkdownHtml(e,t,s){const i=super.getMarkdownHtml(e,t,s);return t==="navigationTitle"&&this.canShowPageNumber()&&i?this.num+". "+i:i}get passed(){return this.getPropertyValue("passed",!1)}set passed(e){this.setPropertyValue("passed",e)}removeFromParent(){this.survey&&this.removeSelfFromList(this.survey.pages)}get visibleIndex(){return this.getPropertyValue("visibleIndex",-1)}set visibleIndex(e){this.setPropertyValue("visibleIndex",e)}canRenderFirstRows(){return!this.isDesignMode||this.visibleIndex==0}isQuestionIndexRecursive(){return super.isQuestionIndexRecursive()&&this.isComplexIndex(this.getStartIndex())}getPanelStartIndex(e){return this.isQuestionIndexRecursive()?0:e}getPageVisibleIndex(){return this.visibleIndex}getQuestionStartIndex(){const e=this.getStartIndex();return this.isQuestionIndexRecursive()?this.getQuestionStartIndexVsVisibleIndex(e,this.num-1):e}get isStartPage(){return this.survey&&this.survey.isPageStarted(this)}get isStarted(){return this.isStartPage}calcCssClasses(e){if(this.isPanel)return super.calcCssClasses(e);const t={page:{},error:{},pageTitle:"",pageDescription:"",row:"",rowMultiple:"",pageRow:"",rowCompact:"",rowEnter:"",rowLeave:"",rowDelayedEnter:"",rowReplace:""};return this.copyCssClasses(t.page,e.page),this.copyCssClasses(t.error,e.error),e.pageTitle&&(t.pageTitle=e.pageTitle),e.pageDescription&&(t.pageDescription=e.pageDescription),e.row&&(t.row=e.row),e.pageRow&&(t.pageRow=e.pageRow),e.rowMultiple&&(t.rowMultiple=e.rowMultiple),e.rowCompact&&(t.rowCompact=e.rowCompact),e.rowEnter&&(t.rowEnter=e.rowEnter),e.rowDelayedEnter&&(t.rowDelayedEnter=e.rowDelayedEnter),e.rowLeave&&(t.rowLeave=e.rowLeave),e.rowReplace&&(t.rowReplace=e.rowReplace),this.survey&&this.survey.updatePageCssClasses(this,t),t}getCssPanelTitle(){return this.isPanel?super.getCssPanelTitle():this.cssClasses.page?new j().append(this.cssClasses.page.title).toString():""}get cssRoot(){return this.isPanel||!this.cssClasses.page||!this.survey?"":new j().append(this.cssClasses.page.root).append(this.cssClasses.page.emptyHeaderRoot,!this.survey.renderedHasHeader&&!(this.survey.isShowProgressBarOnTop&&!this.survey.isStaring)).toString()}getCssError(e){return this.isPanel?super.getCssError(e):new j().append(super.getCssError(e)).append(e.page.errorsContainer).toString()}get navigationButtonsVisibility(){const e=this.showNavigationButtons;return e==null?"inherit":e?"show":"hide"}set navigationButtonsVisibility(e){this.showNavigationButtons=e}get showNavigationButtons(){return this.getPropertyValue("showNavigationButtons",void 0)}set showNavigationButtons(e){this.setShowNavigationButtonsProperty(e)}setShowNavigationButtonsProperty(e){typeof e=="string"&&(e=e.toLowerCase()),e===!0||e===!1?this.setPropertyValue("showNavigationButtons",e):e==="show"?this.setPropertyValue("showNavigationButtons",!0):e==="hide"?this.setPropertyValue("showNavigationButtons",!1):this.setPropertyValue("showNavigationButtons",void 0)}get isActive(){return!!this.survey&&this.survey.currentPage===this}get wasShown(){return this.wasRendered}get hasShown(){return this.wasRendered}setWasShown(e){e||this.resetWasRendered()}onFirstRenderingCore(){var e;if(super.onFirstRenderingCore(),!this.isDesignMode){for(var t=this.elements,s=0;s<t.length;s++)t[s].isPanel&&t[s].randomizeElements(this.areQuestionsRandomized);if(this.randomizeElements(this.areQuestionsRandomized)){const i=(e=this.survey)===null||e===void 0?void 0:e.currentSingleElement;i?.page===this&&(this.survey.currentSingleElement=this.getFirstVisibleElement())}}}scrollToTop(){this.survey&&this.survey.scrollElementToTop(this,null,this,this.id,!1,{block:"start"})}getAllPanels(e=!1,t=!1){var s=new Array;return this.addPanelsIntoList(s,e,t),s}getPanels(e=!1,t=!1){return this.getAllPanels(e,t)}get timeLimit(){return this.getPropertyValue("timeLimit",0)}set timeLimit(e){this.setPropertyValue("timeLimit",e)}get maxTimeToFinish(){return this.timeLimit}set maxTimeToFinish(e){this.timeLimit=e}getMaxTimeToFinish(){if(this.timeLimit!==0)return this.timeLimit;const e=this.survey?this.survey.timeLimitPerPage:0;return e>0?e:0}onNumChanged(e){}onVisibleChanged(){this.isRandomizing||(super.onVisibleChanged(),this.survey!=null&&this.survey.pageVisibilityChanged(this,this.isVisible))}ensureRowsVisibility(){super.ensureRowsVisibility(),this.getPanels().forEach(e=>e.ensureRowsVisibility())}get isReadyForClean(){return this._isReadyForClean}set isReadyForClean(e){const t=this._isReadyForClean;this._isReadyForClean=e,this._isReadyForClean!==t&&this.isReadyForCleanChangedCallback&&this.isReadyForCleanChangedCallback()}enableOnElementRerenderedEvent(){super.enableOnElementRerenderedEvent(),this.isReadyForClean=!1}disableOnElementRerenderedEvent(){super.disableOnElementRerenderedEvent(),this.isReadyForClean=!0}}I([R({defaultValue:-1,onSet:(n,e)=>e.onNumChanged(n)})],kd.prototype,"num",void 0),B.addClass("page",[{name:"showNavigationButtons:boolean",defaultFunc:()=>{},onSetValue:function(n,e){n&&n.setShowNavigationButtonsProperty(e)},alternativeName:"navigationButtonsVisibility"},{name:"timeLimit:number",alternativeName:"maxTimeToFinish",default:0,minValue:0,visibleIf:n=>!!n.survey&&n.survey.showTimer},{name:"navigationTitle",serializationProperty:"locNavigationTitle"},{name:"navigationDescription",visibleIf:function(n){return!!n.survey&&n.survey.progressBarType==="buttons"},serializationProperty:"locNavigationDescription"},{name:"title:text",serializationProperty:"locTitle"},{name:"description:text",serializationProperty:"locDescription"},{name:"state",visible:!1},{name:"isRequired",visible:!1},{name:"startWithNewLine",visible:!1},{name:"width",visible:!1},{name:"minWidth",visible:!1},{name:"maxWidth",visible:!1},{name:"colSpan",visible:!1,isSerializable:!1},{name:"effectiveColSpan:number",visible:!1,isSerializable:!1},{name:"innerIndent",visible:!1},{name:"indent",visible:!1},{name:"page",visible:!1,isSerializable:!1},{name:"showNumber",visible:!1},{name:"showQuestionNumbers",visible:!1},{name:"allowAdaptiveActions",visible:!1},{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText",visible:!1}],function(){return new kd},"panel");class v_ extends de{constructor(e){super(),this.survey=e,this.onResize=this.addEvent()}isListElementClickable(e){return!this.survey.onServerValidateQuestions||this.survey.onServerValidateQuestions.isEmpty||this.survey.checkErrorsMode==="onComplete"?!0:e<=this.survey.currentPageNo+1}getRootCss(e="center"){let t=this.survey.css.progressButtonsContainerCenter;return this.survey.css.progressButtonsRoot&&(t+=" "+this.survey.css.progressButtonsRoot+" "+this.survey.css.progressButtonsRoot+"--"+(["footer","contentBottom"].indexOf(e)!==-1?"bottom":"top"),t+=" "+this.survey.css.progressButtonsRoot+"--"+(this.showItemTitles?"with-titles":"no-titles")),this.showItemNumbers&&this.survey.css.progressButtonsNumbered&&(t+=" "+this.survey.css.progressButtonsNumbered),this.isFitToSurveyWidth&&(t+=" "+this.survey.css.progressButtonsFitSurveyWidth),t}getListElementCss(e){if(!(e>=this.survey.visiblePages.length))return new j().append(this.survey.css.progressButtonsListElementPassed,this.survey.visiblePages[e].passed).append(this.survey.css.progressButtonsListElementCurrent,this.survey.currentPageNo===e).append(this.survey.css.progressButtonsListElementNonClickable,!this.isListElementClickable(e)).toString()}getScrollButtonCss(e,t){return new j().append(this.survey.css.progressButtonsImageButtonLeft,t).append(this.survey.css.progressButtonsImageButtonRight,!t).append(this.survey.css.progressButtonsImageButtonHidden,!e).toString()}clickListElement(e){e instanceof kd||(e=this.survey.visiblePages[e]),this.survey.tryNavigateToPage(e)}isListContainerHasScroller(e){const t=e.querySelector("."+this.survey.css.progressButtonsListContainer);return t?t.scrollWidth>t.offsetWidth:!1}isCanShowItemTitles(e){const t=e.querySelector("ul");if(!t||t.children.length<2)return!0;if(t.clientWidth>t.parentElement.clientWidth)return!1;const s=t.children[0].clientWidth;for(let i=0;i<t.children.length;i++)if(Math.abs(t.children[i].clientWidth-s)>5)return!1;return!0}clearConnectorsWidth(e){const t=e.querySelectorAll(".sd-progress-buttons__connector");for(let s=0;s<t.length;s++)t[s].style.width=""}adjustConnectors(e){const t=e.querySelector("ul");if(!t)return;const s=e.querySelectorAll(".sd-progress-buttons__connector"),i=this.showItemNumbers?36:20,r=(t.clientWidth-i)/(t.children.length-1)-i;for(let a=0;a<s.length;a++)s[a].style.width=r+"px"}get isFitToSurveyWidth(){return Br.currentType!=="default"?!1:this.survey.progressBarInheritWidthFrom==="survey"&&this.survey.widthMode=="static"}get progressWidth(){return this.isFitToSurveyWidth?this.survey.renderedWidth:""}get showItemNumbers(){return Br.currentType!=="default"?!1:this.survey.progressBarShowPageNumbers}get showItemTitles(){return Br.currentType!=="default"?!0:this.survey.progressBarShowPageTitles}getItemNumber(e){let t="";return this.showItemNumbers&&(t+=this.survey.visiblePages.indexOf(e)+1),t}get headerText(){return this.survey.currentPage?this.survey.currentPage.renderedNavigationTitle:""}get footerText(){return this.progressText}get progressText(){return this.getPropertyValue("progressText",void 0,()=>this.survey.getProgressText())}get progressBarAriaLabel(){return bt("progressbar",this.survey.getLocale())}resetProgressText(){this.resetPropertyValue("progressText")}processResponsiveness(e){this.onResize.fire(this,{width:e})}}class C_{constructor(e,t,s){this.model=e,this.element=t,this.viewModel=s,this.criticalProperties=["progressBarType","progressBarShowPageTitles"],this.canShowItemTitles=!0,this.processResponsiveness=(i,r)=>{if(this.viewModel.onUpdateScroller(i.isListContainerHasScroller(this.element)),this.model.clearConnectorsWidth(this.element),!i.showItemTitles){this.model.adjustConnectors(this.element);return}if(i.survey.isMobile){this.prevWidth=r.width,this.canShowItemTitles=!1,this.model.adjustConnectors(this.element),this.viewModel.onResize(this.canShowItemTitles);return}this.timer!==void 0&&clearTimeout(this.timer),this.timer=setTimeout(()=>{(this.prevWidth===void 0||this.prevWidth<r.width&&!this.canShowItemTitles||this.prevWidth>r.width&&this.canShowItemTitles)&&(this.prevWidth=r.width,this.canShowItemTitles=i.isCanShowItemTitles(this.element),this.viewModel.onResize(this.canShowItemTitles),this.timer=void 0)},10)},this.model.survey.registerFunctionOnPropertiesValueChanged(this.criticalProperties,()=>this.forceUpdate(),"ProgressButtonsResponsivityManager"+this.viewModel.container),this.model.onResize.add(this.processResponsiveness),this.forceUpdate()}forceUpdate(){this.viewModel.onUpdateSettings(),this.processResponsiveness(this.model,{})}dispose(){clearTimeout(this.timer),this.model.onResize.remove(this.processResponsiveness),this.model.survey.unRegisterFunctionOnPropertiesValueChanged(this.criticalProperties,"ProgressButtonsResponsivityManager"+this.viewModel.container),this.element=void 0,this.model=void 0}}function b_(n,e){return n.isDesignMode||e.focusFirstQuestion(),!0}function Q1(n){if(n.parentQuestion)return Q1(n.parentQuestion);let e=n.parent;for(;e&&e.getType()!=="page"&&e.parent;)e=e.parent;return e&&e.getType()==="page"?e:null}function w_(n,e){var t=H1(n,e);const s={items:t,searchEnabled:!1,locOwner:n,listRole:"menu",listItemRole:"menuitemradio",listAriaLabel:bt("toc",n.getLocale())};var i=new lt(s);i.allowSelection=!1;const r=(o,l)=>{i.selectedItem=!!o&&i.actions.filter(u=>u.id===o.name)[0]||l};r(n.currentPage,t[0]),n.onCurrentPageChanged.add((o,l)=>{r(n.currentPage)}),n.onFocusInQuestion.add((o,l)=>{r(Q1(l.question))});const a=()=>{i.setItems(H1(n,e))};return n.registerFunctionOnPropertyValueChanged("pages",a,"toc"),n.onEndLoadingFromJson.add(a),i}function H1(n,e){var s=(n.pages||[]).map(i=>new xe({id:i.name,locTitle:i.locNavigationTitle,action:()=>{if(oe.activeElementBlur(),e&&e(),i.isPage)return n.tryNavigateToPage(i);if(i.isPanel)return b_(n,i)},visible:new Ue(()=>i.isVisible&&!i.isStartPage)}));return s}function x_(n,e=!1){let t=us.RootStyle;return e?t+" "+us.RootStyle+"--mobile":(t+=" "+us.RootStyle+"--"+(n.tocLocation||"").toLowerCase(),us.StickyPosition&&(t+=" "+us.RootStyle+"--sticky"),t)}class us{constructor(e){this.survey=e,this.icon="icon-navmenu_24x24",this.togglePopup=()=>{this.popupModel.toggleVisibility()},this.listModel=w_(e,()=>{this.popupModel.isVisible=!1}),this.popupModel=new Mt("sv-list",{model:this.listModel}),this.popupModel.overlayDisplayMode="tablet-dropdown-overlay",this.popupModel.displayMode=new Ue(()=>this.isMobile?"overlay":"popup"),us.StickyPosition&&(e.onAfterRenderSurvey.add((t,s)=>this.initStickyTOCSubscriptions(s.htmlElement)),this.initStickyTOCSubscriptions(e.rootElement))}initStickyTOCSubscriptions(e){us.StickyPosition&&e&&(e.addEventListener("scroll",t=>{this.updateStickyTOCSize(e)}),this.updateStickyTOCSize(e))}updateStickyTOCSize(e){if(!e)return;const t=e.querySelector("."+us.RootStyle);if(t&&(t.style.height="",!this.isMobile&&us.StickyPosition&&e)){const s=e.getBoundingClientRect().height,i=this.survey.findLayoutElement("advanced-header"),r=i&&i.data;let a=!r||r.hasBackground;const o=this.survey.headerView==="advanced"?".sv-header":".sv_custom_header+div div."+(this.survey.css.title||"sd-title"),l=e.querySelector(o),u=l&&a?l.getBoundingClientRect().height:0,d=e.querySelector(".sv-scroll__scroller")||e,h=d.scrollTop>u?0:u-d.scrollTop;t.style.height=s-h-1+"px"}}get isMobile(){return this.survey.isMobile}get containerCss(){return x_(this.survey,this.isMobile)}dispose(){const[e]=this.survey.unRegisterFunctionOnPropertyValueChanged("pages","toc");this.survey.onEndLoadingFromJson.remove(e),this.survey.onPageAdded.remove(e),this.popupModel.dispose(),this.listModel.dispose()}}us.RootStyle="sv_progress-toc",us.StickyPosition=!0;class V_ extends Zi{constructor(e,t,s){super(),this.survey=e,this.valuesHash=t,this.variablesHash=s}getValue(e,t,s,i){if(e.length===1){const a=e[0].name;let o=this.getBuiltInVariableValue(a);if(a==="locale"&&(o=this.survey.locale||os.defaultLocale),o!==void 0)return{value:o,isFound:!0}}let r=new ws(this.variablesHash).getValue(e,t,s,i);return r&&r.isFound||(r=super.getValue(e,t,s,i),r&&r.isFound)?r:new ws(this.valuesHash).getValue(e,t,s,i)}updateValueByItem(e,t){const s=D.expressionVariables.unwrapPostfix,i=e.endsWith(s);i&&(e=e.substring(0,e.length-s.length));const r=this.survey.getQuestionByValueName(e,!0);r&&(t.isFound=!0,t.context=r.getValueGetterContext(i))}isSearchNameRevert(){return!0}getBuiltInVariableValue(e){const t=this.survey;if(e=e.toLocaleLowerCase(),e==="pageno"){var s=t.currentPage;return s!=null?t.visiblePages.indexOf(s)+1:0}if(e==="pagecount")return t.visiblePageCount;if(e==="correctedanswers"||e==="correctanswers"||e==="correctedanswercount")return t.getCorrectedAnswerCount();if(e==="incorrectedanswers"||e==="incorrectanswers"||e==="incorrectedanswercount")return t.getInCorrectedAnswerCount();if(e==="questioncount")return t.getQuizQuestionCount()}}class Ie extends $o{get platformName(){return Ie.platform}get commentSuffix(){return D.commentSuffix}set commentSuffix(e){D.commentSuffix=e}get commentPrefix(){return this.commentSuffix}set commentPrefix(e){this.commentSuffix=e}constructor(e=null,t=null){super(),this.valuesHash={},this.variablesHash={},this.onEndLoadingFromJson=this.addEvent(),this.onTriggerExecuted=this.addEvent(),this.onCompleting=this.addEvent(),this.onComplete=this.addEvent(),this.onShowingPreview=this.addEvent(),this.onNavigateToUrl=this.addEvent(),this.onStarted=this.addEvent(),this.onPartialSend=this.addEvent(),this.onCurrentPageChanging=this.addEvent(),this.onCurrentPageChanged=this.addEvent(),this.onValueChanging=this.addEvent(),this.onValueChanged=this.addEvent(),this.onVariableChanged=this.addEvent(),this.onQuestionVisibleChanged=this.addEvent(),this.onVisibleChanged=this.onQuestionVisibleChanged,this.onPageVisibleChanged=this.addEvent(),this.onPanelVisibleChanged=this.addEvent(),this.onQuestionCreated=this.addEvent(),this.onQuestionAdded=this.addEvent(),this.onQuestionRemoved=this.addEvent(),this.onPanelAdded=this.addEvent(),this.onPanelRemoved=this.addEvent(),this.onPageAdded=this.addEvent(),this.onValidateQuestion=this.addEvent(),this.onSettingQuestionErrors=this.addEvent(),this.onServerValidateQuestions=this.addEvent(),this.onValidatePanel=this.addEvent(),this.onErrorCustomText=this.addEvent(),this.onValidatePage=this.addEvent(),this.onValidatedErrorsOnCurrentPage=this.onValidatePage,this.onProcessHtml=this.addEvent(),this.onGetQuestionDisplayValue=this.addEvent(),this.onGetQuestionTitle=this.addEvent(),this.onGetTitleTagName=this.addEvent(),this.onGetQuestionNumber=this.addEvent(),this.onGetQuestionNo=this.onGetQuestionNumber,this.onGetPanelNumber=this.addEvent(),this.onGetPageNumber=this.addEvent(),this.onGetProgressText=this.addEvent(),this.onProgressText=this.onGetProgressText,this.onTextMarkdown=this.addEvent(),this.onTextRenderAs=this.addEvent(),this.onSendResult=this.addEvent(),this.onGetResult=this.addEvent(),this.onOpenFileChooser=this.addEvent(),this.onUploadFiles=this.addEvent(),this.onDownloadFile=this.addEvent(),this.onClearFiles=this.addEvent(),this.onChoicesLoaded=this.addEvent(),this.onLoadChoicesFromServer=this.onChoicesLoaded,this.onLoadedSurveyFromService=this.addEvent(),this.onProcessDynamicText=this.addEvent(),this.onProcessTextValue=this.onProcessDynamicText,this.onUpdateQuestionCssClasses=this.addEvent(),this.onUpdatePanelCssClasses=this.addEvent(),this.onUpdatePageCssClasses=this.addEvent(),this.onUpdateChoiceItemCss=this.addEvent(),this.onAfterRenderSurvey=this.addEvent(),this.onAfterRenderHeader=this.addEvent(),this.onAfterRenderPage=this.addEvent(),this.onAfterRenderQuestion=this.addEvent(),this.onAfterRenderQuestionInput=this.addEvent(),this.onAfterRenderPanel=this.addEvent(),this.onFocusInQuestion=this.addEvent(),this.onFocusInPanel=this.addEvent(),this.onShowingChoiceItem=this.addEvent(),this.onChoicesLazyLoad=this.addEvent(),this.onChoicesSearch=this.addEvent(),this.onGetChoiceDisplayValue=this.addEvent(),this.onMatrixRowAdded=this.addEvent(),this.onMatrixRowAdding=this.addEvent(),this.onMatrixBeforeRowAdded=this.onMatrixRowAdding,this.onMatrixRowRemoving=this.addEvent(),this.onMatrixRowRemoved=this.addEvent(),this.onMatrixRenderRemoveButton=this.addEvent(),this.onMatrixAllowRemoveRow=this.onMatrixRenderRemoveButton,this.onMatrixDetailPanelVisibleChanged=this.addEvent(),this.onMatrixCellCreating=this.addEvent(),this.onMatrixCellCreated=this.addEvent(),this.onAfterRenderMatrixCell=this.addEvent(),this.onMatrixAfterCellRender=this.onAfterRenderMatrixCell,this.onMatrixCellValueChanged=this.addEvent(),this.onMatrixCellValueChanging=this.addEvent(),this.onMatrixCellValidate=this.addEvent(),this.onMatrixColumnAdded=this.addEvent(),this.onMultipleTextItemAdded=this.addEvent(),this.onDynamicPanelAdded=this.addEvent(),this.onDynamicPanelRemoved=this.addEvent(),this.onDynamicPanelRemoving=this.addEvent(),this.onTimerTick=this.addEvent(),this.onTimer=this.onTimerTick,this.onTimerPanelInfoText=this.addEvent(),this.onDynamicPanelValueChanged=this.addEvent(),this.onDynamicPanelItemValueChanged=this.onDynamicPanelValueChanged,this.onDynamicPanelValueChanging=this.addEvent(),this.onGetDynamicPanelTabTitle=this.addEvent(),this.onDynamicPanelCurrentIndexChanged=this.addEvent(),this.onCheckAnswerCorrect=this.addEvent(),this.onIsAnswerCorrect=this.onCheckAnswerCorrect,this.onDragDropAllow=this.addEvent(),this.onMatrixRowDragOver=this.addEvent(),this.onExpressionRunning=this.addEvent(),this.onScrollToTop=this.addEvent(),this.onScrollingElementToTop=this.onScrollToTop,this.onLocaleChangedEvent=this.addEvent(),this.onGetQuestionTitleActions=this.addEvent(),this.onGetPanelTitleActions=this.addEvent(),this.onGetPageTitleActions=this.addEvent(),this.onGetPanelFooterActions=this.addEvent(),this.onGetMatrixRowActions=this.addEvent(),this.onElementContentVisibilityChanged=this.addEvent(),this.onGetExpressionDisplayValue=this.addEvent(),this.onCheckSingleInputPerPageMode=this.addEvent(),this.onGetLoopQuestions=this.addEvent(),this.onPopupVisibleChanged=this.addEvent(),this.onOpenDropdownMenu=this.addEvent(),this.onElementWrapperComponentName=this.addEvent(),this.onElementWrapperComponentData=this.addEvent(),this.onCreateCustomChoiceItem=this.addEvent(),this.jsonErrors=null,this.cssValue=null,this.showHeaderOnCompletePage="auto",this._isLazyRenderingSuspended=!1,this.hideRequiredErrors=!1,this.cssVariables={},this._isMobile=!1,this._isCompact=!1,this.setValueOnExpressionCounter=0,this._isDesignMode=!1,this.validationAllowSwitchPages=!1,this.validationAllowComplete=!1,this.isNavigationButtonPressed=!1,this.mouseDownPage=null,this.isSmoothScrollEnabled=!1,this.onResize=new Xt,this.isCurrentPageRendering=!0,this.isCurrentPageRendered=void 0,this.skeletonHeight=void 0,this.isTriggerIsRunning=!1,this.triggerKeys=null,this.isValueChangedOnRunningCondition=!1,this.conditionRunnerCounter=0,this.conditionUpdateVisibleIndexes=!1,this.conditionNotifyElementsOnAnyValueOrVariableChanged=!1,this.isEndLoadingFromJson=null,this.nofifyQuesitonHash={},this.questionHashes={names:{},namesInsensitive:{},valueNames:{},valueNamesInsensitive:{}},this.setValueFromTriggerCounter=0,this.isMovingPage=!1,this.needRenderIcons=!0,this.skippedPages=[],this.skeletonComponentName="sv-skeleton",this.taskManager=new F1,this.questionErrorComponent="sv-question-error",this.onBeforeRunConstructor(),this.createHtmlLocString("completedHtml","completingSurvey"),this.createHtmlLocString("completedBeforeHtml","completingSurveyBefore","completed-before"),this.createHtmlLocString("loadingHtml","loadingSurvey","loading"),this.createLocalizableString("emptySurveyText",this,!0,"emptySurvey"),this.createLocalizableString("logo"),this.createLocString({name:"startSurveyText",hasTranslation:!0}),this.createLocString({name:"pagePrevText",hasTranslation:!0}),this.createLocString({name:"pageNextText",hasTranslation:!0}),this.createLocString({name:"completeText",hasTranslation:!0}),this.createLocString({name:"previewText",hasTranslation:!0}),this.createLocString({name:"editText",hasTranslation:!0}),this.createLocalizableString("questionTitleTemplate",this,!0),this.timerModelValue=new Fr(this),this.timerModelValue.onTimerTick=s=>{this.doTimer(s)},this.createNewArray("pages",s=>{s.isReadyForCleanChangedCallback&&s.isReadyForCleanChangedCallback(),this.doOnPageAdded(s)},s=>{s.isReadyForClean?this.doOnPageRemoved(s):s.isReadyForCleanChangedCallback=()=>{this.doOnPageRemoved(s),s.isReadyForCleanChangedCallback=void 0}}),this.createNewArray("triggers",s=>{s.setOwner(this)}),this.createNewArray("calculatedValues",s=>{s.setOwner(this)}),this.createNewArray("completedHtmlOnCondition",s=>{s.locOwner=this}),this.createNewArray("navigateToUrlOnCondition",s=>{s.locOwner=this}),this.registerPropertyChangedHandlers(["locale"],()=>{this.onSurveyLocaleChanged()}),this.registerPropertyChangedHandlers(["firstPageIsStartPage"],()=>{this.onFirstPageIsStartedChanged()}),this.registerPropertyChangedHandlers(["readOnly"],()=>{this.onReadOnlyChanged()}),this.registerPropertyChangedHandlers(["progressBarType"],()=>{this.updateProgressText()}),this.registerPropertyChangedHandlers(["questionStartIndex","requiredMark","questionTitlePattern"],()=>{this.resetVisibleIndexes()}),this.registerPropertyChangedHandlers(["isLoading","isCompleted","isCompletedBefore","readOnly","isStartedState","currentPage","isShowingPreview"],()=>{this.updateState()}),this.registerPropertyChangedHandlers(["state","currentPage","showPreviewBeforeComplete"],()=>{this.onStateAndCurrentPageChanged()}),this.registerPropertyChangedHandlers(["logo","logoPosition"],()=>{this.resetHasLogo()}),this.registerPropertyChangedHandlers(["backgroundImage"],()=>{this.resetPropertyValue("renderBackgroundImage")}),this.registerPropertyChangedHandlers(["backgroundImage","backgroundOpacity","backgroundImageFit","fitToContainer","backgroundImageAttachment"],()=>{this.resetPropertyValue("backgroundImageStyle")}),this.registerPropertyChangedHandlers(["showPrevButton","showCompleteButton"],()=>{this.updateButtonsVisibility()}),this.onGetQuestionNumber.onCallbacksChanged=()=>{this.resetVisibleIndexes()},this.onGetPanelNumber.onCallbacksChanged=()=>{this.resetVisibleIndexes()},this.onGetProgressText.onCallbacksChanged=()=>{this.updateProgressText()},this.onTextMarkdown.onCallbacksChanged=()=>{this.locStrsChanged()},this.onProcessHtml.onCallbacksChanged=()=>{this.locStrsChanged()},this.onGetQuestionTitle.onCallbacksChanged=()=>{this.locStrsChanged()},this.onUpdatePageCssClasses.onCallbacksChanged=()=>{this.currentPage&&this.currentPage.updateElementCss()},this.onUpdatePanelCssClasses.onCallbacksChanged=()=>{this.currentPage&&this.currentPage.updateElementCss()},this.onUpdateQuestionCssClasses.onCallbacksChanged=()=>{this.currentPage&&this.currentPage.updateElementCss()},this.onShowingChoiceItem.onCallbacksChanged=()=>{this.rebuildQuestionChoices()},this.locTitle.onStringChanged.add(()=>this.resetPropertyValue("titleIsEmpty")),this.onBeforeCreating(),e&&((typeof e=="string"||e instanceof String)&&(e=JSON.parse(e)),e&&e.clientId&&(this.clientId=e.clientId),this.fromJSON(e),this.surveyId&&this.loadSurveyFromService(this.surveyId,this.clientId)),this.onCreating(),t&&this.render(t),this.updateCss(),this.setCalculatedWidthModeUpdater(),this.notifier=new In(this.css.saveData),this.notifier.addAction(this.createTryAgainAction(),"error"),this.onPopupVisibleChanged.add((s,i)=>{i.visible?this.onScrollCallback=()=>{i.popup.hide()}:this.onScrollCallback=void 0}),this.layoutElements.push({id:"timerpanel",template:"survey-timerpanel",component:"sv-timerpanel",data:this.timerModel}),this.layoutElements.push({id:"progress-buttons",component:"sv-progress-buttons",getData:()=>this.progressBar,processResponsiveness:s=>this.progressBar.processResponsiveness&&this.progressBar.processResponsiveness(s)}),this.layoutElements.push({id:"progress-questions",component:"sv-progress-questions",data:this}),this.layoutElements.push({id:"progress-pages",component:"sv-progress-pages",data:this}),this.layoutElements.push({id:"progress-correctquestions",component:"sv-progress-correctquestions",data:this}),this.layoutElements.push({id:"progress-requiredquestions",component:"sv-progress-requiredquestions",data:this}),this.addLayoutElement({id:"toc-navigation",component:"sv-navigation-toc",getData:()=>this.tocModel,processResponsiveness:s=>this.tocModel.updateStickyTOCSize(this.rootElement)}),this.layoutElements.push({id:"buttons-navigation",component:"sv-action-bar",getData:()=>this.navigationBar}),this.layoutElements.push({id:"buttons-navigation-top",component:"sv-action-bar",getData:()=>this.navigationBar})}get tocModel(){return this.tocModelValue||(this.tocModelValue=new us(this)),this.tocModelValue}get sjsVersion(){return this.getPropertyValue("sjsVersion")}set sjsVersion(e){this.setPropertyValue("sjsVersion",e)}processClosedPopup(e,t){throw new Error("Method not implemented.")}createTryAgainAction(){return{id:"save-again",title:this.getLocalizationString("saveAgainButton"),action:()=>{this.isCompleted?this.saveDataOnComplete():this.doComplete()}}}createHtmlLocString(e,t,s){const i=this.createLocalizableString(e,this,!1,t);s&&(i.onGetTextCallback=r=>this.processHtml(r,s))}getType(){return"survey"}onPropertyValueChanged(e,t,s){e==="questionsOnPageMode"&&this.onQuestionsOnPageModeChanged(t)}get pages(){return this.getPropertyValue("pages")}render(e=null){this.renderCallback&&this.renderCallback()}updateSurvey(e,t){for(var s in e)if(!(s=="model"||s=="children"))if(s.indexOf("on")==0&&this[s]&&this[s].add){let i=e[s],r=function(a,o){i(a,o)};this[s].add(r)}else this[s]=e[s];e&&e.data&&this.onValueChanged.add((i,r)=>{e.data[r.name]=r.value})}getCss(){return this.css}updateCompletedPageCss(){this.containerCss=this.css.container,this.completedCss=new j().append(this.css.body).append(this.css.completedPage).toString(),this.completedBeforeCss=new j().append(this.css.body).append(this.css.completedBeforePage).toString(),this.loadingBodyCss=new j().append(this.css.body).append(this.css.bodyLoading).toString()}updateCss(){this.rootCss=this.getRootCss(),this.updateNavigationCss(),this.updateCompletedPageCss(),this.updateWrapperFormCss()}get css(){return this.cssValue||(this.cssValue={},this.copyCssClasses(this.cssValue,Br.getCss())),this.cssValue}set css(e){this.setCss(e)}setCss(e,t=!0){t?this.mergeValues(e,this.css):this.cssValue=e,this.updateElementCss(!1)}get cssTitle(){return this.css.title}get bodyCss(){return new j().append(this.css.body).append(this.css.bodyWithTimer,this.showTimer&&this.state==="running").append(this.css.body+"--"+this.calculatedWidthMode).toString()}get bodyContainerCss(){return this.css.bodyContainer}get cssNavigationComplete(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.complete)}get cssNavigationPreview(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.preview)}get cssNavigationEdit(){return this.getNavigationCss(this.css.navigationButton,this.css.navigation.edit)}get cssNavigationPrev(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.prev)}get cssNavigationStart(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.start)}get cssNavigationNext(){return this.getNavigationCss(this.cssSurveyNavigationButton,this.css.navigation.next)}get cssSurveyNavigationButton(){return new j().append(this.css.navigationButton).append(this.css.bodyNavigationButton).toString()}insertAdvancedHeader(e){e.survey=this,this.layoutElements.push({id:"advanced-header",container:"header",component:"sv-header",index:-100,data:e,processResponsiveness:t=>e.processResponsiveness()})}get lazyRenderEnabled(){return this.lazyRenderEnabledValue===!0}set lazyRenderEnabled(e){if(this.lazyRenderEnabled===e)return;this.lazyRenderEnabledValue=e;const t=this.currentPage;t&&t.updateRows()}get lazyRendering(){return this.lazyRenderEnabled}set lazyRendering(e){this.lazyRenderEnabled=e}get isLazyRendering(){return this.lazyRenderEnabled||D.lazyRender.enabled}get lazyRenderFirstBatchSize(){return this.lazyRenderFirstBatchSizeValue||D.lazyRender.firstBatchSize}set lazyRenderFirstBatchSize(e){this.lazyRenderFirstBatchSizeValue=e}get isLazyRenderingSuspended(){return this._isLazyRenderingSuspended}suspendLazyRendering(){this.isLazyRendering&&(this._isLazyRenderingSuspended=!0)}releaseLazyRendering(){this.isLazyRendering&&(this._isLazyRenderingSuspended=!1)}updateLazyRenderingRowsOnRemovingElements(){var e,t;if(this.isLazyRendering){var s=this.currentPage;if(s){const i=(t=this.rootElement||((e=this.creator)===null||e===void 0?void 0:e.rootElement))===null||t===void 0?void 0:t.querySelector(`#${s.id}`);xd(i)}}}get triggers(){return this.getPropertyValue("triggers")}set triggers(e){this.setPropertyValue("triggers",e)}get calculatedValues(){return this.getPropertyValue("calculatedValues")}set calculatedValues(e){this.setPropertyValue("calculatedValues",e)}get surveyId(){return this.getPropertyValue("surveyId","")}set surveyId(e){this.setPropertyValue("surveyId",e)}get surveyPostId(){return this.getPropertyValue("surveyPostId","")}set surveyPostId(e){this.setPropertyValue("surveyPostId",e)}get clientId(){return this.getPropertyValue("clientId","")}set clientId(e){this.setPropertyValue("clientId",e)}get cookieName(){return this.getPropertyValue("cookieName","")}set cookieName(e){this.setPropertyValue("cookieName",e)}get partialSendEnabled(){return this.getPropertyValue("partialSendEnabled")}set partialSendEnabled(e){this.setPropertyValue("partialSendEnabled",e)}get sendResultOnPageNext(){return this.partialSendEnabled}set sendResultOnPageNext(e){this.partialSendEnabled=e}get surveyShowDataSaving(){return this.getPropertyValue("surveyShowDataSaving")}set surveyShowDataSaving(e){this.setPropertyValue("surveyShowDataSaving",e)}get autoFocusFirstQuestion(){return this.getPropertyValue("autoFocusFirstQuestion")}set autoFocusFirstQuestion(e){this.setPropertyValue("autoFocusFirstQuestion",e)}get focusFirstQuestionAutomatic(){return this.autoFocusFirstQuestion}set focusFirstQuestionAutomatic(e){this.autoFocusFirstQuestion=e}get autoFocusFirstError(){return this.getPropertyValue("autoFocusFirstError")}set autoFocusFirstError(e){this.setPropertyValue("autoFocusFirstError",e)}get focusOnFirstError(){return this.autoFocusFirstError}set focusOnFirstError(e){this.autoFocusFirstError=e}get showNavigationButtons(){return this.getPropertyValue("showNavigationButtons")}set showNavigationButtons(e){e==="both"&&(e="topBottom");const t=["top","bottom","topBottom"].indexOf(e)>-1,s=e===!0||t;this.setPropertyValue("showNavigationButtons",s),t&&(this.navigationButtonsLocation=e)}get navigationButtonsLocation(){return this.getPropertyValue("navigationButtonsLocation")}set navigationButtonsLocation(e){this.setPropertyValue("navigationButtonsLocation",e)}get showPrevButton(){return this.getPropertyValue("showPrevButton")}set showPrevButton(e){this.setPropertyValue("showPrevButton",e)}get showCompleteButton(){return this.getPropertyValue("showCompleteButton",!0)}set showCompleteButton(e){this.setPropertyValue("showCompleteButton",e)}get showTOC(){return this.getPropertyValue("showTOC")}set showTOC(e){this.setPropertyValue("showTOC",e)}get tocLocation(){return this.getPropertyValue("tocLocation")}set tocLocation(e){this.setPropertyValue("tocLocation",e)}get showTitle(){return this.getPropertyValue("showTitle")}set showTitle(e){this.setPropertyValue("showTitle",e)}get showPageTitles(){return this.getPropertyValue("showPageTitles")}set showPageTitles(e){this.setPropertyValue("showPageTitles",e)}get showCompletePage(){return this.getPropertyValue("showCompletePage")}set showCompletePage(e){this.setPropertyValue("showCompletePage",e)}get showCompletedPage(){return this.showCompletePage}set showCompletedPage(e){this.showCompletePage=e}get navigateToUrl(){return this.getPropertyValue("navigateToUrl")}set navigateToUrl(e){this.setPropertyValue("navigateToUrl",e)}get navigateToUrlOnCondition(){return this.getPropertyValue("navigateToUrlOnCondition")}set navigateToUrlOnCondition(e){this.setPropertyValue("navigateToUrlOnCondition",e)}getNavigateToUrl(){var e=this.getExpressionItemOnRunCondition(this.navigateToUrlOnCondition),t=e?e.url:this.navigateToUrl;return t&&(t=this.processText(t,!1)),t}navigateTo(){var e=this.getNavigateToUrl(),t={url:e,allow:!0};this.onNavigateToUrl.fire(this,t),!(!t.url||!t.allow)&&fR(t.url)}get requiredMark(){return this.getPropertyValue("requiredMark")}set requiredMark(e){this.setPropertyValue("requiredMark",e)}get requiredText(){return this.requiredMark}set requiredText(e){this.requiredMark=e}beforeSettingQuestionErrors(e,t){this.makeRequiredErrorsInvisible(t),this.onSettingQuestionErrors.fire(this,{question:e,errors:t})}makeRequiredErrorsInvisible(e){if(this.hideRequiredErrors)for(var t=0;t<e.length;t++){var s=e[t].getErrorType();(s=="required"||s=="requireoneanswer")&&(e[t].visible=!1)}}get questionStartIndex(){return this.getPropertyValue("questionStartIndex")||""}set questionStartIndex(e){this.setPropertyValue("questionStartIndex",e)}getQuestionStartIndex(e){if(e>=0&&e<this.visiblePages.length)for(let t=e;t>=0;t--){const s=this.visiblePages[t];if(s.questionStartIndex)return s.questionStartIndex}return this.questionStartIndex}get storeOthersAsComment(){return this.getPropertyValue("storeOthersAsComment")}set storeOthersAsComment(e){this.setPropertyValue("storeOthersAsComment",e)}get maxTextLength(){return this.getPropertyValue("maxTextLength")}set maxTextLength(e){this.setPropertyValue("maxTextLength",e)}get maxCommentLength(){return this.getPropertyValue("maxCommentLength")}set maxCommentLength(e){this.setPropertyValue("maxCommentLength",e)}get maxOthersLength(){return this.maxCommentLength}set maxOthersLength(e){this.maxCommentLength=e}get autoAdvanceEnabled(){return this.getPropertyValue("autoAdvanceEnabled")}set autoAdvanceEnabled(e){this.setPropertyValue("autoAdvanceEnabled",e)}get goNextPageAutomatic(){return this.autoAdvanceEnabled}set goNextPageAutomatic(e){this.autoAdvanceEnabled=e}get autoAdvanceAllowComplete(){return this.getPropertyValue("autoAdvanceAllowComplete")}set autoAdvanceAllowComplete(e){this.setPropertyValue("autoAdvanceAllowComplete",e)}get allowCompleteSurveyAutomatic(){return this.autoAdvanceAllowComplete}set allowCompleteSurveyAutomatic(e){this.autoAdvanceAllowComplete=e}get checkErrorsMode(){return this.getPropertyValue("checkErrorsMode")}set checkErrorsMode(e){this.setPropertyValue("checkErrorsMode",e)}get validateVisitedEmptyFields(){return this.getPropertyValue("validateVisitedEmptyFields")}set validateVisitedEmptyFields(e){this.setPropertyValue("validateVisitedEmptyFields",e)}getValidateVisitedEmptyFields(){return this.validateVisitedEmptyFields&&this.isValidateOnValueChange}get autoGrowComment(){return this.getPropertyValue("autoGrowComment")}set autoGrowComment(e){this.setPropertyValue("autoGrowComment",e)}get allowResizeComment(){return this.getPropertyValue("allowResizeComment")}set allowResizeComment(e){this.setPropertyValue("allowResizeComment",e)}get commentAreaRows(){return this.getPropertyValue("commentAreaRows")}set commentAreaRows(e){this.setPropertyValue("commentAreaRows",e)}get textUpdateMode(){return this.getPropertyValue("textUpdateMode")}set textUpdateMode(e){this.setPropertyValue("textUpdateMode",e)}get clearInvisibleValues(){return this.getPropertyValue("clearInvisibleValues")}set clearInvisibleValues(e){e===!0&&(e="onComplete"),e===!1&&(e="none"),this.setPropertyValue("clearInvisibleValues",e)}clearIncorrectValues(e=!1){for(var t=0;t<this.pages.length;t++)this.pages[t].clearIncorrectValues();if(e){var s=this.data,i=!1;for(var r in s)if(!this.getQuestionByValueName(r)&&!(this.iscorrectValueWithPostPrefix(r,D.commentSuffix)||this.iscorrectValueWithPostPrefix(r,D.matrix.totalsSuffix))){var a=this.getCalculatedValueByName(r);a&&a.includeIntoResult||(i=!0,delete s[r])}i&&(this.data=s)}}iscorrectValueWithPostPrefix(e,t){return e.indexOf(t)!==e.length-t.length?!1:!!this.getQuestionByValueName(e.substring(0,e.indexOf(t)))}get keepIncorrectValues(){return this.getPropertyValue("keepIncorrectValues")}set keepIncorrectValues(e){this.setPropertyValue("keepIncorrectValues",e)}get locale(){return this.getPropertyValueWithoutDefault("locale")||os.currentLocale}set locale(e){e===os.defaultLocale&&!os.currentLocale&&(e=""),this.setPropertyValue("locale",e)}onSurveyLocaleChanged(){this.notifyElementsOnAnyValueOrVariableChanged("locale"),this.localeChanged(),this.onLocaleChangedEvent.fire(this,this.locale)}get localeDir(){return os.localeDirections[this.locale]}getUsedLocales(){var e=new Array;this.addUsedLocales(e);var t=e.indexOf("default");if(t>-1){var s=os.defaultLocale,i=e.indexOf(s);i>-1&&e.splice(i,1),t=e.indexOf("default"),e[t]=s}return e}localeChanged(){for(var e=0;e<this.pages.length;e++)this.pages[e].localeChanged()}getLocale(){return this.locale}locStrsChanged(){var e;if(!this.isClearingUnsedValues&&(super.locStrsChanged(),!!this.currentPage)){if(this.isDesignMode)this.pages.forEach(i=>i.locStrsChanged());else{var t=this.activePage;t&&t.locStrsChanged();const i=this.visiblePages;for(var s=0;s<i.length;s++)i[s].navigationLocStrChanged()}this.isStartPageActive||this.updateProgressText(),(e=this.navigationBarValue)===null||e===void 0||e.locStrsChanged()}}getMarkdownHtml(e,t,s){return this.getSurveyMarkdownHtml(this,e,t,s)}getRenderer(e){return this.getRendererForString(this,e)}getRendererContext(e){return this.getRendererContextForString(this,e)}getRendererForString(e,t,s){let i=this.getBuiltInRendererForString(e,t,s);i=this.elementWrapperComponentNameCore(i,e,"string",t);const r={element:e,name:t,renderAs:i};return this.onTextRenderAs.fire(this,r),r.renderAs}getRendererContextForString(e,t,s){return this.elementWrapperDataCore(t,e,"string")}getExpressionDisplayValue(e,t,s){const i={question:e,value:t,displayValue:s};return this.onGetExpressionDisplayValue.fire(this,i),i.displayValue}getBuiltInRendererForString(e,t,s){if(this.isDesignMode)return wt.editableRenderer}getProcessedText(e){return this.processText(e,!0)}getLocString(e){return this.getLocalizationString(e)}getErrorCustomText(e,t){return this.getSurveyErrorCustomText(this,e,t)}getSurveyErrorCustomText(e,t,s){const i={text:t,name:s.getErrorType(),obj:e,error:s};return this.onErrorCustomText.fire(this,i),i.text}getQuestionDisplayValue(e,t){const s={question:e,displayValue:t};return this.onGetQuestionDisplayValue.fire(this,s),s.displayValue}get emptySurveyText(){return this.getLocalizableStringText("emptySurveyText")}set emptySurveyText(e){this.setLocalizableStringText("emptySurveyText",e)}get logo(){return this.getLocalizableStringText("logo")}set logo(e){this.setLocalizableStringText("logo",e)}get locLogo(){return this.getLocalizableString("logo")}get logoWidth(){return this.getPropertyValue("logoWidth")}set logoWidth(e){this.setPropertyValue("logoWidth",e)}get renderedLogoWidth(){return this.logoWidth?er(this.logoWidth):void 0}get renderedStyleLogoWidth(){return this.logoWidth?Yo(this.logoWidth):void 0}get logoHeight(){return this.getPropertyValue("logoHeight")}set logoHeight(e){this.setPropertyValue("logoHeight",e)}get renderedLogoHeight(){return this.logoHeight?er(this.logoHeight):void 0}get renderedStyleLogoHeight(){return this.logoHeight?Yo(this.logoHeight):void 0}get logoPosition(){return this.getPropertyValue("logoPosition")}set logoPosition(e){this.setPropertyValue("logoPosition",e)}get hasLogo(){return this.getPropertyValue("hasLogo",void 0,()=>!!this.logo&&this.logoPosition!=="none")}resetHasLogo(){this.resetPropertyValue("hasLogo")}get isLogoBefore(){return this.isDesignMode?!1:this.renderedHasLogo&&(this.logoPosition==="left"||this.logoPosition==="top")}get isLogoAfter(){return this.isDesignMode?this.renderedHasLogo:this.renderedHasLogo&&(this.logoPosition==="right"||this.logoPosition==="bottom")}get logoClassNames(){const e={left:"sv-logo--left",right:"sv-logo--right",top:"sv-logo--top",bottom:"sv-logo--bottom"};return new j().append(this.css.logo).append(e[this.logoPosition]).toString()}get titleIsEmpty(){return this.getPropertyValue("titleIsEmpty",void 0,()=>this.locTitle.isEmpty)}get renderedHasTitle(){return this.isDesignMode?this.isPropertyVisible("title"):!this.titleIsEmpty&&this.showTitle}get renderedHasDescription(){return this.isDesignMode?this.isPropertyVisible("description"):!!this.hasDescription&&this.showTitle}get hasTitle(){return this.renderedHasTitle}get renderedHasLogo(){return this.isDesignMode?this.isPropertyVisible("logo"):this.hasLogo}get renderedHasHeader(){return this.renderedHasTitle||this.renderedHasLogo}get logoFit(){return this.getPropertyValue("logoFit")}set logoFit(e){this.setPropertyValue("logoFit",e)}get themeVariables(){return Object.assign({},this.cssVariables)}setIsMobile(e=!0){this._isMobile!==e&&(this._isMobile=e,this.updateCss(),this.getAllQuestions().forEach(t=>t.setIsMobile(e)))}get isMobile(){return this._isMobile&&!this.isDesignMode}set isCompact(e){e!==this._isCompact&&(this._isCompact=e,this.updateElementCss(),this.triggerResponsiveness(!0))}get isCompact(){return this._isCompact}isLogoImageChoosen(){return this.locLogo.renderedHtml}get titleMaxWidth(){return""}get renderBackgroundImage(){return this.getPropertyValue("renderBackgroundImage",void 0,()=>Vd(this.backgroundImage))}get backgroundOpacity(){return this.getPropertyValue("backgroundOpacity")}set backgroundOpacity(e){this.setPropertyValue("backgroundOpacity",e)}get backgroundImageStyle(){return this.getPropertyValue("backgroundImageStyle",void 0,()=>this.calcBackgroundImageStyle())}calcBackgroundImageStyle(){return{opacity:this.backgroundOpacity,backgroundImage:this.renderBackgroundImage,backgroundSize:this.backgroundImageFit,backgroundAttachment:this.fitToContainer?void 0:this.backgroundImageAttachment}}updateWrapperFormCss(){this.wrapperFormCss=new j().append(this.css.rootWrapper).append(this.css.rootWrapperHasImage,!!this.backgroundImage).append(this.css.rootWrapperFixed,!this.formScrollDisabled).toString()}get completedHtml(){return this.getLocalizableStringText("completedHtml")}set completedHtml(e){this.setLocalizableStringText("completedHtml",e)}get locCompletedHtml(){return this.getLocalizableString("completedHtml")}get completedHtmlOnCondition(){return this.getPropertyValue("completedHtmlOnCondition")}set completedHtmlOnCondition(e){this.setPropertyValue("completedHtmlOnCondition",e)}runExpression(e,t){if(!e)return null;var s=this.getFilteredProperties();const i=this.createExpressionRunner(e);let r;return i.onRunComplete=a=>{r=a,t&&t(a)},i.runContext(this.getValueGetterContext(),s)||r}beforeExpressionRunning(e,t,s){const i={element:e,propertyName:t,expression:s,allow:!0};return this.onExpressionRunning.fire(this,i),i.allow?i.expression:""}get isSettingValueOnExpression(){return this.setValueOnExpressionCounter>0}startSetValueOnExpression(){this.setValueOnExpressionCounter++}finishSetValueOnExpression(){this.setValueOnExpressionCounter--}runCondition(e){if(!e)return!1;const t=this.getFilteredProperties();return new Gs(e).runContext(this.getValueGetterContext(),t)}runTriggers(){this.checkTriggers(this.getFilteredValues(),!1)}get renderedCompletedHtml(){var e=this.getExpressionItemOnRunCondition(this.completedHtmlOnCondition);return e?e.html:this.completedHtml}getExpressionItemOnRunCondition(e){if(e.length==0)return null;for(var t=this.getFilteredProperties(),s=0;s<e.length;s++)if(e[s].runCondition(t))return e[s];return null}get completedBeforeHtml(){return this.getLocalizableStringText("completedBeforeHtml")}set completedBeforeHtml(e){this.setLocalizableStringText("completedBeforeHtml",e)}get locCompletedBeforeHtml(){return this.getLocalizableString("completedBeforeHtml")}get loadingHtml(){return this.getLocalizableStringText("loadingHtml")}set loadingHtml(e){this.setLocalizableStringText("loadingHtml",e)}get locLoadingHtml(){return this.getLocalizableString("loadingHtml")}getNavigationCss(e,t){return new j().append(e).append(t).toString()}get navigationBar(){return this.navigationBarValue||(this.navigationBarValue=this.createNavigationBar(),this.navigationBarValue.locOwner=this,this.updateNavigationCss()),this.navigationBarValue}createNavigationBar(){if(this.createNavigationBarCallback)return this.createNavigationBarCallback();const e=new Vt;return e.setItems(this.createNavigationActions()),e}addNavigationItem(e){e.component||(e.component="sv-nav-btn"),e.innerCss||(e.innerCss=this.cssSurveyNavigationButton);const t=e.action;return e.action=()=>{this.waitAndExecute(()=>t())},this.navigationBar.addAction(e)}removeNavigationItem(e){var t;(t=this.navigationBarValue)===null||t===void 0||t.removeActionById(e)}createNavigationActions(){const e="sv-nav-btn",t=new xe({id:"sv-nav-start",visible:new Ue(()=>this.isStartPageActive),visibleIndex:10,locTitle:this.locStartSurveyText,action:()=>this.start(),component:e}),s=new xe({id:"sv-nav-prev",visible:new Ue(()=>this.isShowPrevButton),visibleIndex:20,data:{mouseDown:()=>this.navigationMouseDown()},locTitle:this.locPagePrevText,action:()=>this.performPrevious(),component:e}),i=new xe({id:"sv-nav-next",visible:new Ue(()=>this.isShowNextButton),visibleIndex:30,data:{mouseDown:()=>this.nextPageMouseDown()},locTitle:this.locPageNextText,action:()=>this.nextPageUIClick(),component:e}),r=new xe({id:"sv-nav-preview",visible:new Ue(()=>this.isPreviewButtonVisible),visibleIndex:40,data:{mouseDown:()=>this.navigationMouseDown()},locTitle:this.locPreviewText,action:()=>this.showPreview(),component:e}),a=new xe({id:"sv-nav-complete",visible:new Ue(()=>this.isCompleteButtonVisible),visibleIndex:50,data:{mouseDown:()=>this.navigationMouseDown()},locTitle:this.locCompleteText,action:()=>this.taskManager.waitAndExecute(()=>this.tryComplete()),component:e});return this._updateNavigationItemCssCallback=()=>{t.innerCss=this.cssNavigationStart,s.innerCss=this.cssNavigationPrev,i.innerCss=this.cssNavigationNext,r.innerCss=this.cssNavigationPreview,a.innerCss=this.cssNavigationComplete},[t,s,i,r,a]}updateNavigationCss(){const e=this.navigationBarValue;e&&(e.cssClasses=this.css.actionBar,e.containerCss=this.css.footer,this._updateNavigationItemCssCallback&&this._updateNavigationItemCssCallback())}get startSurveyText(){return this.getLocalizableStringText("startSurveyText")}set startSurveyText(e){this.setLocalizableStringText("startSurveyText",e)}get locStartSurveyText(){return this.getLocalizableString("startSurveyText")}get pagePrevText(){return this.getLocalizableStringText("pagePrevText")}set pagePrevText(e){this.setLocalizableStringText("pagePrevText",e)}get locPagePrevText(){return this.getLocalizableString("pagePrevText")}get pageNextText(){return this.getLocalizableStringText("pageNextText")}set pageNextText(e){this.setLocalizableStringText("pageNextText",e)}get locPageNextText(){return this.getLocalizableString("pageNextText")}get completeText(){return this.getLocalizableStringText("completeText")}set completeText(e){this.setLocalizableStringText("completeText",e)}get locCompleteText(){return this.getLocalizableString("completeText")}get previewText(){return this.getLocalizableStringText("previewText")}set previewText(e){this.setLocalizableStringText("previewText",e)}get locPreviewText(){return this.getLocalizableString("previewText")}get editText(){return this.getLocalizableStringText("editText")}set editText(e){this.setLocalizableStringText("editText",e)}get locEditText(){return this.getLocalizableString("editText")}getElementTitleTagName(e,t){if(this.onGetTitleTagName.isEmpty)return t;const s={element:e,tagName:t};return this.onGetTitleTagName.fire(this,s),s.tagName}get questionTitlePattern(){return this.getPropertyValue("questionTitlePattern","numTitleRequire")}set questionTitlePattern(e){e!=="numRequireTitle"&&e!=="requireNumTitle"&&e!="numTitle"&&(e="numTitleRequire"),this.setPropertyValue("questionTitlePattern",e)}getQuestionTitlePatternOptions(){const e=new Array,t=this.getLocalizationString("questionTitlePatternText"),s=this.questionStartIndex?this.questionStartIndex:"1.";return e.push({value:"numTitleRequire",text:s+" "+t+" "+this.requiredMark}),e.push({value:"numRequireTitle",text:s+" "+this.requiredMark+" "+t}),e.push({value:"numTitle",text:s+" "+t}),e}get questionTitleTemplate(){return this.getLocalizableStringText("questionTitleTemplate")}set questionTitleTemplate(e){this.setLocalizableStringText("questionTitleTemplate",e),this.questionTitlePattern=this.getNewTitlePattern(e),this.questionStartIndex=this.getNewQuestionTitleElement(e,"no",this.questionStartIndex,"1"),this.requiredMark=this.getNewQuestionTitleElement(e,"require",this.requiredMark,"*")}getNewTitlePattern(e){if(e){for(var t=[];e.indexOf("{")>-1;){e=e.substring(e.indexOf("{")+1);var s=e.indexOf("}");if(s<0)break;t.push(e.substring(0,s)),e=e.substring(s+1)}if(t.length>1){if(t[0]=="require")return"requireNumTitle";if(t[1]=="require"&&t.length==3)return"numRequireTitle";if(t.indexOf("require")<0)return"numTitle"}if(t.length==1&&t[0]=="title")return"numTitle"}return"numTitleRequire"}getNewQuestionTitleElement(e,t,s,i){if(t="{"+t+"}",!e||e.indexOf(t)<0)return s;for(var r=e.indexOf(t),a="",o="",l=r-1;l>=0&&e[l]!="}";l--);for(l<r-1&&(a=e.substring(l+1,r)),r+=t.length,l=r;l<e.length&&e[l]!="{";l++);for(l>r&&(o=e.substring(r,l)),l=0;l<a.length&&a.charCodeAt(l)<33;)l++;for(a=a.substring(l),l=o.length-1;l>=0&&o.charCodeAt(l)<33;)l--;if(o=o.substring(0,l+1),!a&&!o)return s;var u=s||i;return a+u+o}get locQuestionTitleTemplate(){return this.getLocalizableString("questionTitleTemplate")}getUpdatedQuestionTitle(e,t){if(this.onGetQuestionTitle.isEmpty)return t;const s={question:e,title:t};return this.onGetQuestionTitle.fire(this,s),s.title}getUpdatedQuestionNo(e,t){if(this.onGetQuestionNumber.isEmpty)return t;const s={question:e,number:t,no:t};return this.onGetQuestionNumber.fire(this,s),s.no===t?s.number:s.no}getUpdatedPanelNo(e,t){if(this.onGetPanelNumber.isEmpty)return t;const s={panel:e,number:t};return this.onGetPanelNumber.fire(this,s),s.number}getUpdatedPageNo(e,t){if(this.onGetPageNumber.isEmpty)return t;const s={page:e,number:t};return this.onGetPageNumber.fire(this,s),s.number}get showPageNumbers(){return this.getPropertyValue("showPageNumbers")}set showPageNumbers(e){e!==this.showPageNumbers&&(this.setPropertyValue("showPageNumbers",e),this.updateVisibleIndexes())}get showQuestionNumbers(){return this.getPropertyValue("showQuestionNumbers")}set showQuestionNumbers(e){e===!0&&(e="on"),e===!1&&(e="off"),e=e.toLowerCase(),e=e==="onpage"?"onPage":e,e!==this.showQuestionNumbers&&(this.setPropertyValue("showQuestionNumbers",e),this.updateVisibleIndexes())}get progressBar(){return this.progressBarValue||(this.progressBarValue=new v_(this)),this.progressBarValue}get showProgressBar(){return this.getPropertyValue("showProgressBar")}set showProgressBar(e){this.setShowProgressBar(e)}setShowProgressBar(e){e==="off"&&(e=!1),e===!0||e===!1?this.setPropertyValue("showProgressBar",e):(this.setPropertyValue("showProgressBar",!0),this.progressBarLocation=e)}get progressBarLocation(){return this.getPropertyValue("progressBarLocation")}set progressBarLocation(e){this.setPropertyValue("progressBarLocation",e.toLowerCase())}get progressBarType(){return this.getPropertyValue("progressBarType")}set progressBarType(e){e==="correctquestion"&&(e="correctQuestion"),e==="requiredquestion"&&(e="requiredQuestion"),this.setPropertyValue("progressBarType",e)}get progressBarComponentName(){let e=this.progressBarType;return!D.legacyProgressBarView&&Br.currentType==="default"&&mi(e,"pages")&&(e="buttons"),"progress-"+e}get isShowProgressBarOnTop(){return!this.canShowProgressBar()||!this.showProgressBar?!1:["auto","aboveheader","belowheader","topbottom","top","both"].indexOf(this.progressBarLocation)!==-1}get isShowProgressBarOnBottom(){return!this.canShowProgressBar()||!this.showProgressBar?!1:this.progressBarLocation==="bottom"||this.progressBarLocation==="both"||this.progressBarLocation==="topbottom"}getProgressTypeComponent(){return"sv-progress-"+this.progressBarType.toLowerCase()}getProgressCssClasses(e=""){return new j().append(this.css.progress).append(this.css.progressTop,this.isShowProgressBarOnTop&&(!e||e=="header")).append(this.css.progressBottom,this.isShowProgressBarOnBottom&&(!e||e=="footer")).toString()}canShowProgressBar(){return!this.isShowingPreview||!this.showPreviewBeforeComplete||this.previewMode!="allQuestions"}get processedTitle(){return this.locTitle.renderedHtml}get questionTitleLocation(){return this.getPropertyValue("questionTitleLocation")}set questionTitleLocation(e){this.setPropertyValue("questionTitleLocation",e.toLowerCase()),this.isLoadingFromJson||this.updateElementCss(!0)}updateElementCss(e){this.startPage&&this.startPage.updateElementCss(e);for(var t=this.visiblePages,s=0;s<t.length;s++)t[s].updateElementCss(e);this.updateCss()}get questionErrorLocation(){return this.getPropertyValue("questionErrorLocation")}set questionErrorLocation(e){this.setPropertyValue("questionErrorLocation",e.toLowerCase())}get questionDescriptionLocation(){return this.getPropertyValue("questionDescriptionLocation")}set questionDescriptionLocation(e){this.setPropertyValue("questionDescriptionLocation",e)}get mode(){return this.readOnly?"display":"edit"}set mode(e){e=e.toLowerCase(),e!=this.mode&&(e!="edit"&&e!="display"||(this.readOnly=e=="display"))}get readOnly(){return this.getPropertyValue("readOnly")}set readOnly(e){this.setPropertyValue("readOnly",e)}onReadOnlyChanged(){for(var e=0;e<this.pages.length;e++){var t=this.pages[e];t.setPropertyValue("isReadOnly",t.isReadOnly)}this.updateButtonsVisibility(),this.updateCss()}get data(){for(var e={},t=this.getValuesKeys(),s=0;s<t.length;s++){var i=t[s],r=this.getDataValueCore(this.valuesHash,i);r!==void 0&&(e[i]=r)}return this.setCalculatedValuesIntoResult(e),e}set data(e){this.valuesHash={},this.setDataCore(e,!e)}mergeData(e){if(!e)return;const t=this.data;this.mergeValues(e,t),this.setDataCore(t)}setDataCore(e,t=!1){if(t&&(this.valuesHash={}),e)for(var s in e){const i=typeof s=="string"?s.trim():s;this.setDataValueCore(this.valuesHash,i,e[s])}this.isSettingDataValue=!0,this.updateAllQuestionsValue(t),this.notifyAllQuestionsOnValueChanged(),this.notifyElementsOnAnyValueOrVariableChanged(""),this.isSettingDataValue=!1,this.runConditions(),this.updateAllQuestionsValue(t)}isSettingData(){return this.isSettingDataValue===!0}get isSurvey(){return!0}getData(e){const t=e||{includePages:!1,includePanels:!1};return!t.includePages&&!t.includePanels?this.data:this.getStructuredData(!!t.includePages,t.includePanels?100:t.includePages?1:0)}getStructuredData(e=!0,t=-1){if(t===0)return this.data;const s={};return this.pages.forEach(i=>{if(e){const r={};i.collectValues(r,t-1)&&(s[i.name]=r)}else i.collectValues(s,t)}),s}setStructuredData(e,t=!1){if(!e)return;const s={};for(let i in e)if(this.getQuestionByValueName(i))s[i]=e[i];else{let a=this.getPageByName(i);a||(a=this.getPanelByName(i)),a&&this.collectDataFromPanel(a,s,e[i])}t?this.mergeData(s):this.data=s}collectDataFromPanel(e,t,s){for(let i in s){let r=e.getElementByName(i);r&&(r.isPanel?this.collectDataFromPanel(r,t,s[i]):t[i]=s[i])}}get editingObj(){return this.editingObjValue}set editingObj(e){if(this.editingObj!=e&&(this.unConnectEditingObj(),this.editingObjValue=e,!this.isDisposed)){if(!e)for(var t=this.getAllQuestions(),s=0;s<t.length;s++)t[s].unbindValue();this.editingObj&&(this.setDataCore({}),this.onEditingObjPropertyChanged=(i,r)=>{B.hasOriginalProperty(this.editingObj,r.name)&&(r.name==="locale"&&this.setDataCore({}),this.updateOnSetValue(r.name,this.editingObj[r.name],r.oldValue))},this.editingObj.onPropertyChanged.add(this.onEditingObjPropertyChanged))}}unConnectEditingObj(){this.editingObj&&!this.editingObj.isDisposed&&this.editingObj.onPropertyChanged.remove(this.onEditingObjPropertyChanged)}get isEditingSurveyElement(){return!!this.editingObj}setCalculatedValuesIntoResult(e){for(var t=0;t<this.calculatedValues.length;t++){var s=this.calculatedValues[t];s.includeIntoResult&&s.name&&this.getVariable(s.name)!==void 0&&(e[s.name]=this.getVariable(s.name))}}getAllValues(){return this.data}getPlainData(e){e||(e={includeEmpty:!0,includeQuestionTypes:!1,includeValues:!1});const t=[],s=[];if(this.getAllQuestions().forEach(o=>{var l=o.getPlainData(e);l&&(t.push(l),s.push(o.valueName||o.name))}),e.includeValues){const o=this.getValuesKeys();for(var i=0;i<o.length;i++){var r=o[i];if(s.indexOf(r)==-1){var a=this.getDataValueCore(this.valuesHash,r);a&&t.push({name:r,title:r,value:a,displayValue:a,isNode:!1,getString:l=>typeof l=="object"?JSON.stringify(l):l})}}}return t}getFilteredValues(){const e={};for(var t in this.variablesHash)e[t]=this.variablesHash[t];if(this.addCalculatedValuesIntoFilteredValues(e),!this.isDesignMode){const i=this.getValuesKeys();for(var s=0;s<i.length;s++){var t=i[s];e[t]=this.getDataValueCore(this.valuesHash,t)}this.getAllQuestions().forEach(r=>{r.hasFilteredValue&&(e[r.getFilteredName()]=r.getFilteredValue(!0))})}return e}addCalculatedValuesIntoFilteredValues(e){for(var t=this.calculatedValues,s=0;s<t.length;s++)e[t[s].name]=t[s].value}getFilteredProperties(){return{survey:this}}getValuesKeys(){if(!this.editingObj)return Object.keys(this.valuesHash);for(var e=B.getPropertiesByObj(this.editingObj),t=[],s=0;s<e.length;s++)t.push(e[s].name);return t}getDataValueCore(e,t){return this.editingObj?B.getObjPropertyValue(this.editingObj,t):this.getDataFromValueHash(e,t)}setDataValueCore(e,t,s){this.editingObj?B.setObjPropertyValue(this.editingObj,t,s):this.setDataToValueHash(e,t,s)}deleteDataValueCore(e,t){this.editingObj?this.editingObj[t]=null:this.deleteDataFromValueHash(e,t)}getDataFromValueHash(e,t){return this.valueHashGetDataCallback?this.valueHashGetDataCallback(e,t):e[t]}setDataToValueHash(e,t,s){this.valueHashSetDataCallback?this.valueHashSetDataCallback(e,t,s):e[t]=s}deleteDataFromValueHash(e,t){this.valueHashDeleteDataCallback?this.valueHashDeleteDataCallback(e,t):delete e[t]}get comments(){for(var e={},t=this.getValuesKeys(),s=0;s<t.length;s++){var i=t[s];i.indexOf(this.commentSuffix)>0&&(e[i]=this.getDataValueCore(this.valuesHash,i))}return e}get visiblePages(){if(this.isDesignMode)return this.pages;if(this.pageContainerValue&&(this.isShowingPreview||this.isSinglePage))return[this.pageContainerValue];for(var e=new Array,t=0;t<this.pages.length;t++)this.isPageInVisibleList(this.pages[t])&&e.push(this.pages[t]);return e}isPageInVisibleList(e){return this.isDesignMode||e.isVisible&&!e.isStartPage}get isEmpty(){return this.pages.length==0}get PageCount(){return this.pageCount}get pageCount(){return this.pages.length}get visiblePageCount(){return this.visiblePages.length}get startPage(){var e=this.firstPageIsStartPage&&this.pages.length>1?this.pages[0]:null;return e&&e.onFirstRendering(),e}get startedPage(){return this.startPage}get currentPage(){return this.getPropertyValue("currentPage",null)}set currentPage(e){if(this.isLoadingFromJson)return;var t=this.getPageByObject(e);if(e&&!t||!t&&this.isCurrentPageAvailable)return;var s=this.visiblePages;if(t!=null&&s.indexOf(t)<0||t==this.currentPage)return;const i=this.currentSingleElement;if(!this.isShowingPreview&&i&&t!==i.page){this.currentSingleElement=t.getFirstVisibleElement();return}var r=this.currentPage;!this.isShowingPreview&&!i&&!this.currentPageChanging(t,r)||(this.setPropertyValue("currentPage",t),t&&(t.onFirstRendering(),t.updateCustomWidgets()),this.locStrsChanged(),this.isShowingPreview||this.currentPageChanged(t,r))}get currentElementName(){var e;return((e=this.currentElement)===null||e===void 0?void 0:e.name)||""}set currentElementName(e){e&&(this.currentElement=this.getElementByName(e))}get currentElement(){return this.currentSingleElement||this.currentPage}set currentElement(e){if(e)if(e.isPage)this.currentPage=e;else{const t=e.page;t&&!this.isSingleVisibleQuestion?this.currentPage=t:this.currentSingleElement=e}}getElementByName(e){return e?this.getPageByName(e)||this.getPanelByName(e)||this.getQuestionByName(e):null}tryNavigateToPage(e){if(!this.performValidationOnPageChanging(e))return!1;const s=this.visiblePages.indexOf(e)<this.currentPageNo||!this.doServerValidation(!1,!1,e);return s&&(this.currentPage=e),s}performValidationOnPageChanging(e){if(this.isDesignMode)return!1;if(this.canGoTroughValidation())return!0;const t=this.visiblePages.indexOf(e);if(t<0||t>=this.visiblePageCount||t===this.currentPageNo)return!1;if(t<this.currentPageNo||this.checkErrorsMode==="onComplete"||this.validationAllowSwitchPages)return!0;if(!this.validateCurrentPage())return!1;for(let s=this.currentPageNo+1;s<t;s++){const i=this.visiblePages[s];if(!i.validate(!0,!0))return!1;i.passed=!0}return!0}updateCurrentPage(){this.isCurrentPageAvailable||(this.currentPage=this.firstVisiblePage)}get isCurrentPageAvailable(){const e=this.currentPage;return!!e&&this.isPageInVisibleList(e)&&this.isPageExistsInSurvey(e)}isPageExistsInSurvey(e){return this.pages.indexOf(e)>-1?!0:!!this.onContainsPageCallback&&this.onContainsPageCallback(e)}get activePage(){return this.getPropertyValue("activePage")}get isStartPageActive(){return this.state==="starting"}get isShowStartingPage(){return this.isStartPageActive}get matrixDragHandleArea(){return this.getPropertyValue("matrixDragHandleArea","entireItem")}set matrixDragHandleArea(e){this.setPropertyValue("matrixDragHandleArea",e)}get isShowingPage(){return this.state=="running"||this.state=="preview"||this.isStartPageActive}updateActivePage(){const e=this.isStartPageActive?this.startPage:this.currentPage;e!==this.activePage&&this.setPropertyValue("activePage",e)}onStateAndCurrentPageChanged(){this.updateActivePage(),this.updateButtonsVisibility()}getPageByObject(e){if(!e)return null;if(e.getType&&e.getType()=="page")return e;if(typeof e=="string"||e instanceof String)return this.getPageByName(String(e));if(!isNaN(e)){var t=Number(e),s=this.visiblePages;return e<0||e>=s.length?null:s[t]}return e}get currentPageNo(){return this.visiblePages.indexOf(this.currentPage)}set currentPageNo(e){var t=this.visiblePages;e<0||e>=t.length||(this.currentPage=t[e])}get questionOrder(){return this.getPropertyValue("questionOrder")}set questionOrder(e){this.setPropertyValue("questionOrder",e)}get questionsOrder(){return this.questionOrder}set questionsOrder(e){this.questionOrder=e}focusFirstQuestion(){if(!this.focusingQuestionInfo){var e=this.activePage;e&&(e.scrollToTop(),e.focusFirstQuestion())}}scrollToTopOnPageChange(e=!0){var t=this.activePage;t&&(e&&t.scrollToTop(),this.isCurrentPageRendering&&this.autoFocusFirstQuestion&&!this.focusingQuestionInfo&&(t.focusFirstQuestion(),this.isCurrentPageRendering=!1))}get state(){return this.getPropertyValue("state","empty")}updateState(){this.setPropertyValue("state",this.calcState())}calcState(){return this.isLoading?"loading":this.isCompleted?"completed":this.isCompletedBefore?"completedbefore":!this.isDesignMode&&this.isEditMode&&this.isStartedState&&this.startPage?"starting":this.isShowingPreview?this.currentPage?"preview":"empty":this.currentPage?"running":"empty"}get isCompleted(){return this.getPropertyValue("isCompleted",!1)}set isCompleted(e){this.setPropertyValue("isCompleted",e)}get isShowingPreview(){return this.getPropertyValue("isShowingPreview",!1)}set isShowingPreview(e){this.isShowingPreview!=e&&(this.setPropertyValue("isShowingPreview",e),this.onShowingPreviewChanged())}get isStartedState(){return this.getPropertyValue("isStartedState",!1)}set isStartedState(e){this.setPropertyValue("isStartedState",e)}get isCompletedBefore(){return this.getPropertyValue("isCompletedBefore",!1)}set isCompletedBefore(e){this.setPropertyValue("isCompletedBefore",e)}get isLoading(){return this.getPropertyValue("isLoading",!1)}set isLoading(e){this.setPropertyValue("isLoading",e)}beginLoading(){this.isLoading=!0}endLoading(){this.isLoading=!1}get completedState(){return this.getPropertyValue("completedState","")}get completedStateText(){return this.getPropertyValue("completedStateText","")}setCompletedState(e,t){this.setPropertyValue("completedState",e),t||(e=="saving"&&(t=this.getLocalizationString("savingData")),e=="error"&&(t=this.getLocalizationString("savingDataError")),e=="success"&&(t=this.getLocalizationString("savingDataSuccess"))),this.setPropertyValue("completedStateText",t),this.state==="completed"&&this.showCompletePage&&this.completedState&&this.notify(this.completedStateText,this.completedState,e==="error")}notify(e,t,s=!1){this.notifier.showActions=s,this.notifier.notify(e,t,s)}clear(e=!0,t=!0){this.isCompleted=!1,this.isCompletedBefore=!1,this.isLoading=!1,this.completedByTriggers=void 0,this.skippedPages=[],e&&this.setDataCore(null,!0),this.timerModel.spent=0;for(var s=0;s<this.pages.length;s++)this.pages[s].timeSpent=0,this.pages[s].setWasShown(!1),this.pages[s].passed=!1;if(this.onFirstPageIsStartedChanged(),t&&(this.currentPage=this.firstVisiblePage,this.currentSingleElement)){const i=this.getSingleElements();this.currentSingleElement=i.length>0?i[0]:void 0}e&&this.updateValuesWithDefaults()}mergeValues(e,t){xn(e,t)}updateValuesWithDefaults(){if(!(this.isDesignMode||this.isLoading))for(var e=0;e<this.pages.length;e++)for(var t=this.pages[e].questions,s=0;s<t.length;s++)t[s].updateValueWithDefaults()}updateCustomWidgets(e){e&&e.updateCustomWidgets()}currentPageChanging(e,t,s,i){const r=this.createPageChangeEventOptions(e,t,s,i);return this.currentPageChangingFromOptions(r)}currentPageChangingFromOptions(e){e.allow=!0,e.allowChanging=!0,this.onCurrentPageChanging.fire(this,e);const t=e.allowChanging&&e.allow;return t&&e.newCurrentPage!==e.oldCurrentPage&&(this.isCurrentPageRendering=!0),t}currentPageChanged(e,t){if(this.notifyQuestionsOnHidingContent(t),t&&!t.isDisposed&&!t.passed&&t.validate(!1)&&(t.passed=!0),this.isCurrentPageRendered===!0&&(this.isCurrentPageRendered=!1),!this.currentSingleElement){const s=this.createPageChangeEventOptions(e,t);this.onCurrentPageChanged.fire(this,s)}}notifyQuestionsOnHidingContent(e){e&&!e.isDisposed&&e.questions.forEach(t=>t.onHidingContent())}createPageChangeEventOptions(e,t,s,i){const r=e&&t?e.visibleIndex-t.visibleIndex:0;let a=r;return a===0&&i&&s&&(a=e.elements.indexOf(s)-e.elements.indexOf(i)),{oldCurrentQuestion:i,newCurrentQuestion:s,oldCurrentPage:t,newCurrentPage:e,isNextPage:r===1,isPrevPage:r===-1,isGoingForward:a>0,isGoingBackward:a<0,isAfterPreview:this.changeCurrentPageFromPreview===!0}}getProgress(){if(this.currentPage==null)return 0;if(this.progressBarType!=="pages"){var e=this.getProgressInfo();return this.progressBarType==="requiredQuestions"?e.requiredQuestionCount>=1?Math.ceil(e.requiredAnsweredQuestionCount*100/e.requiredQuestionCount):100:e.questionCount>=1?Math.ceil(e.answeredQuestionCount*100/e.questionCount):100}const t=this.visiblePages;var s=t.indexOf(this.currentPage);return Math.ceil(s*100/t.length)}get isNavigationButtonsShowing(){if(this.isDesignMode)return"none";var e=this.activePage;return!e||e.showNavigationButtons===!1?"none":e.showNavigationButtons===!0?this.showNavigationButtons?this.navigationButtonsLocation:"bottom":this.showNavigationButtons?this.navigationButtonsLocation:"none"}get isNavigationButtonsShowingOnTop(){return this.getIsNavigationButtonsShowingOn("top")}get isNavigationButtonsShowingOnBottom(){return this.getIsNavigationButtonsShowingOn("bottom")}getIsNavigationButtonsShowingOn(e){var t=this.isNavigationButtonsShowing;return t=="both"||t=="topBottom"||t==e}get isEditMode(){return!this.readOnly}get isDisplayMode(){return this.readOnly&&!this.isDesignMode||this.state=="preview"}get isUpdateValueTextOnTyping(){return this.textUpdateMode=="onTyping"}get isDesignMode(){return this._isDesignMode}setDesignMode(e){!!this._isDesignMode!=!!e&&(this._isDesignMode=!!e,this.onQuestionsOnPageModeChanged("standard"))}get showInvisibleElements(){return this.getPropertyValue("showInvisibleElements",!1)}set showInvisibleElements(e){var t=this.visiblePages;this.setPropertyValue("showInvisibleElements",e),!this.isLoadingFromJson&&(this.runConditions(),this.updateAllElementsVisibility(t))}updateAllElementsVisibility(e){for(var t=0;t<this.pages.length;t++){var s=this.pages[t];s.updateElementVisibility(),e.indexOf(s)>-1!=s.isVisible&&this.onPageVisibleChanged.fire(this,{page:s,visible:s.isVisible})}}get areInvisibleElementsShowing(){return this.isDesignMode||this.showInvisibleElements}get areEmptyElementsHidden(){return this.isShowingPreview&&this.showPreviewBeforeComplete&&this.previewMode=="answeredQuestions"&&this.isAnyQuestionAnswered}get isAnyQuestionAnswered(){const e=this.getAllQuestions(!0);for(let t=0;t<e.length;t++)if(!e[t].isEmpty())return!0;return!1}get hasCookie(){if(!this.cookieName)return!1;var e=oe.getCookie();return e&&e.indexOf(this.cookieName+"=true")>-1}setCookie(){this.cookieName&&oe.setCookie(this.cookieName+"=true; expires=Fri, 31 Dec 9999 0:0:0 GMT")}deleteCookie(){this.cookieName&&oe.setCookie(this.cookieName+"=;")}get ignoreValidation(){return!this.validationEnabled}set ignoreValidation(e){this.validationEnabled=!e}nextPage(){return this.currentSingleElement?this.performNext():this.isLastPage?!1:this.doCurrentPageComplete(!1)}performNext(){const e=this.currentSingleElement;if(!e)return this.nextPage();if(this.resetNavigationButton(),this.isSingleVisibleInput){if(!e.validateSingleInput())return!1;if(e.nextSingleInput())return this.updateButtonsVisibility(),!0}return this.validationEnabled?this.validateElements([e],!0,!1,s=>{s||this.performNextAfterValidation(e)})===!0:(this.performNextAfterValidation(e),!0)}performNextAfterValidation(e){this.sendPartialResult();const t=this.getSingleElements(),s=t.indexOf(e);if(s<0||s===t.length-1)return!1;let i={};e.isQuestion?i[e.name]=e.value:e.isPanel&&(i=e.getValue()),this.checkTriggers(i,!0,!1,!0,e.name),e===this.currentSingleElement&&(this.currentSingleElement=t[s+1])}performPrevious(){return this.prevPage()}validateOnNavigate(e,t){const s=this.canGoTroughValidation()||e&&this.validationAllowComplete||!e&&(this.validationAllowSwitchPages||this.isValidateOnComplete)||t&&this.isValidateOnComplete,i=()=>{t?this.showPreviewCore():this.doCurrentPageCompleteCore(e)};if(s)return i(),!0;const r=a=>{a||i()};return this.isValidateOnComplete?this.isLastPage?this.validate(!0,this.autoFocusFirstError,r,!0)!==!0:(i(),!0):this.validateCurrentPage(r)!==!1}canGoTroughValidation(){return!this.isEditMode||!this.validationEnabled}get isCurrentPageHasErrors(){return this.validateActivePage()===!1}get isCurrentPageValid(){return this.validateActivePage()}hasCurrentPageErrors(e){return this.hasPageErrors(void 0,e)}validateCurrentPage(e){return this.validatePage(void 0,e)}hasPageErrors(e,t){const s=this.validatePage(e,t);return s===void 0?s:!s}validatePage(e,t){return e||(e=this.activePage),e?this.validatePageCore(e,!0,t):!0}hasErrors(e=!0,t=!1,s){const i=this.validate(e,t,s);return i===void 0?i:!i}validate(e=!0,t=!1,s,i){return this.validateElements(this.visiblePages,e,t,s,i)}validateElements(e,t=!0,s=!1,i,r){i&&(t=!0);const a=i?l=>{i(!l)}:void 0,o=new kr({fireCallback:t,focusOnFirstError:s,callbackResult:a,changeCurrentPage:!!r});for(const l of e)l.validateElement(o);return o.finish(),o.runningResult}ensureUniqueNames(e=null){if(e==null)for(var t=0;t<this.pages.length;t++)this.ensureUniqueName(this.pages[t]);else this.ensureUniqueName(e)}ensureUniqueName(e){if(e.isPage&&this.ensureUniquePageName(e),e.isPanel&&this.ensureUniquePanelName(e),e.isPage||e.isPanel)for(var t=e.elements,s=0;s<t.length;s++)this.ensureUniqueNames(t[s]);else this.ensureUniqueQuestionName(e)}ensureUniquePageName(e){return this.ensureUniqueElementName(e,t=>this.getPageByName(t))}ensureUniquePanelName(e){return this.ensureUniqueElementName(e,t=>this.getPanelByName(t))}ensureUniqueQuestionName(e){return this.ensureUniqueElementName(e,t=>this.getQuestionByName(t))}ensureUniqueElementName(e,t){var s=t(e.name);if(!(!s||s==e)){for(var i=this.getNewName(e.name);t(i);)var i=this.getNewName(e.name);e.name=i}}getNewName(e){for(var t=e.length;t>0&&e[t-1]>="0"&&e[t-1]<="9";)t--;var s=e.substring(0,t),i=0;return t<e.length&&(i=parseInt(e.substring(t))),i++,s+i}validateActivePage(e){return this.validatePageCore(this.activePage,e)}validatePageCore(e,t,s){if(t===void 0&&(t=this.focusOnFirstError),!e)return!0;let i;s&&(i=a=>{s(!a)});const r=e.validate(!0,t,i);return this.fireValidatedErrorsOnPage(e),r}fireValidatedErrorsOnPage(e){if(this.onValidatePage.isEmpty||!e)return;const t=this.getNestedQuestionsByQuestionArray(e.questions,!0);for(var s=new Array,i=new Array,r=0;r<t.length;r++){var a=t[r];if(a.errors.length>0){s.push(a);for(var o=0;o<a.errors.length;o++)i.push(a.errors[o])}}this.onValidatePage.fire(this,{questions:s,errors:i,page:e})}prevPage(){if(this.isFirstPage||this.state==="starting")return!1;this.resetNavigationButton();const e=this.currentSingleElement;if(this.doSkipOnPrevPage(e))return!0;if(e)return this.prevPageSingleElement(e);const t=this.visiblePages,s=t.indexOf(this.currentPage);return this.currentPage=t[s-1],!0}doSkipOnPrevPage(e){const t=e||this.currentPage,s=this.skippedPages.find(r=>r.to===t);let i;if(s){this.skippedPages.splice(this.skippedPages.indexOf(s),1);const r=s.from;!r.isDisposed&&r.isVisible&&(i=r)}return i&&(e?this.currentSingleElement=i:this.currentPage=i),!!i}prevPageSingleElement(e){if(this.isSingleVisibleInput&&e.prevSingleInput())return this.updateButtonsVisibility(),!0;const t=this.getSingleElements(),s=t.indexOf(e);return s===0?!1:(this.currentSingleElement=t[s-1],!0)}tryComplete(){return this.isValidateOnComplete&&this.cancelPreview(),this.doCurrentPageComplete(!0),this.isCompleted}completeLastPage(){return this.tryComplete()}navigationMouseDown(){return this.isNavigationButtonPressed=!0,!0}resetNavigationButton(){this.isNavigationButtonPressed=!1}nextPageUIClick(){return this.mouseDownPage&&this.mouseDownPage!==this.activePage?!1:(this.mouseDownPage=null,this.performNext())}nextPageMouseDown(){return this.mouseDownPage=this.activePage,this.navigationMouseDown()}showPreview(){return this.resetNavigationButton(),!this.isValidateOnComplete&&this.doServerValidation(!0,!0)||!this.validateOnNavigate(!0,!0)?!1:this.isShowingPreview}showPreviewCore(){var e={allowShowPreview:!0,allow:!0};this.onShowingPreview.fire(this,e),this.isShowingPreview=e.allowShowPreview&&e.allow}cancelPreview(e=null){var t;if(!this.isShowingPreview)return;this.gotoPageFromPreview=e,this.isShowingPreview=!1;const s=(t=this.currentSingleElement)===null||t===void 0?void 0:t.page;s&&(s.updateRows(),this.currentPage=s)}cancelPreviewByPage(e){this.cancelPreview(e)}doCurrentPageComplete(e){return this.isValidatingOnServer?!1:(this.resetNavigationButton(),this.validateOnNavigate(e)===!0)}doCurrentPageCompleteCore(e){if(this.doServerValidation(e))return!1;if(e){this.currentPage.passed=!0;const t=this.doComplete(this.canBeCompletedByTrigger,this.completedTrigger);return t&&this.cancelPreview(),t}return this.doNextPage(),!0}get isSinglePage(){return this.questionsOnPageMode=="singlePage"}set isSinglePage(e){this.questionsOnPageMode=e?"singlePage":"standard"}get isSingleVisibleQuestion(){return!this.isDesignMode&&(this.isSingleVisibleQuestionVal(this.questionsOnPageMode)||this.isSingleVisibleInput)}get isSingleVisibleInput(){return!this.isDesignMode&&this.questionsOnPageMode=="inputPerPage"}isSingleVisibleQuestionVal(e){return e==="questionPerPage"||e==="questionOnPage"}get questionsOnPageMode(){return this.getPropertyValue("questionsOnPageMode")}set questionsOnPageMode(e){this.setPropertyValue("questionsOnPageMode",e)}get firstPageIsStartPage(){return this.getPropertyValue("firstPageIsStartPage")}set firstPageIsStartPage(e){this.setPropertyValue("firstPageIsStartPage",e)}get firstPageIsStarted(){return this.firstPageIsStartPage}set firstPageIsStarted(e){this.firstPageIsStartPage=e}isPageStarted(e){return this.firstPageIsStartPage&&this.pages.length>1&&this.pages[0]===e}get showPreviewBeforeComplete(){return this.getPropertyValue("showPreviewBeforeComplete")}set showPreviewBeforeComplete(e){this.setShowPreviewBeforeComplete(e)}setShowPreviewBeforeComplete(e){e===void 0||e==="noPreview"||e===!1?this.setPropertyValue("showPreviewBeforeComplete",!1):(this.setPropertyValue("showPreviewBeforeComplete",!0),e==="showAllQuestions"&&(this.previewMode="allQuestions"),e==="showAnsweredQuestions"&&(this.previewMode="answeredQuestions"))}get previewMode(){return this.getPropertyValue("previewMode")}set previewMode(e){this.setPropertyValue("previewMode",e)}onFirstPageIsStartedChanged(){this.isStartedState=this.firstPageIsStartPage&&this.pages.length>1,this.pageVisibilityChanged(this.pages[0],!this.isStartedState)}onShowingPreviewChanged(){this.updatePagesContainer()}createRootPage(e,t){const s=B.createClass("page");return s.name=e,s.isPageContainer=!0,t.forEach(i=>{i.isStartPage||s.addElement(i)}),s}disposeContainerPage(){let e=this.pageContainerValue;[].concat(e.elements).forEach(s=>e.removeElement(s)),e.dispose(),this.pageContainerValue=void 0}updatePagesContainer(){if(this.isDesignMode)return;this.getAllQuestions().forEach(i=>i.updateElementVisibility()),this.setPropertyValue("currentPage",void 0);const e="single-page",t="preview-page";let s;if(this.isSinglePage){const i=this.pageContainerValue;i&&i.name===t?(s=i.elements[0],this.disposeContainerPage()):s=this.createRootPage(e,this.pages)}if(this.isShowingPreview&&(s=this.createRootPage(t,s?[s]:this.pages)),s&&(s.setSurveyImpl(this),this.pageContainerValue=s,this.currentPage=s,this.currentSingleElementValue&&this.visiblePages.forEach(i=>i.updateRows())),!this.isSinglePage&&!this.isShowingPreview){this.disposeContainerPage();let i=this.gotoPageFromPreview;this.gotoPageFromPreview=null,L.isValueEmpty(i)&&this.visiblePageCount>0&&(i=this.visiblePages[this.visiblePageCount-1]),i&&(this.changeCurrentPageFromPreview=!0,this.currentPage=i,this.changeCurrentPageFromPreview=!1)}!this.currentPage&&this.visiblePageCount>0&&(this.currentPage=this.visiblePages[0]),this.isShowingPreview&&this.pages.forEach(i=>{i.onFirstRendering()}),this.pages.forEach(i=>{i.wasRendered&&i.updateElementCss(!0)}),this.updateButtonsVisibility()}getSingleElements(e){const t=new Array,s=this.pages,i=this.isSingleVisibleInput;for(var r=0;r<s.length;r++){const a=s[r];if(!a.isStartPage&&a.isVisible){const o=[];i?a.addQuestionsToList(o,!0):a.elements.forEach(l=>o.push(l)),o.forEach(l=>{(l===e||l.isVisible)&&t.push(l)})}}return t}get currentSingleElement(){return this.isShowingPreview?void 0:this.currentSingleElementValue}set currentSingleElement(e){if(e&&e.isQuestion&&this.isSingleVisibleQuestionVal(this.questionsOnPageMode))for(;e.parent&&e.parent.isPanel;)e=e.parent;const t=this.currentSingleElement;if(e!==t&&!this.isCompleted){const s=e?.isQuestion?e:void 0,i=t?.isQuestion?t:void 0,r=e?.page,a=r&&t?this.createPageChangeEventOptions(r,t.page,s,i):void 0;if(a&&!this.currentPageChangingFromOptions(a))return;this.currentSingleElementValue=e,e?(this.isSingleVisibleInput&&e.isQuestion&&e.onSetAsSingleInput(),r.updateRows(),r!==this.currentPage?this.currentPage=r:s&&this.autoFocusFirstQuestion&&s.focus(),this.updateButtonsVisibility(),a&&this.onCurrentPageChanged.fire(this,a)):this.visiblePages.forEach(o=>o.updateRows())}}get currentSingleQuestion(){const e=this.currentSingleElement;return e&&e.isQuestion?e:void 0}set currentSingleQuestion(e){this.currentSingleElement=e}supportsNestedSingleInput(e){const t={question:e,enabled:!0};return this.onCheckSingleInputPerPageMode.fire(this,t),t.enabled}updateNestedSingleQuestions(e,t){const s={question:e,nestedQuestions:t};this.onGetLoopQuestions.fire(this,s)}changeCurrentSingleElementOnVisibilityChanged(){const e=this.currentSingleElement;if(!e||e.isVisible)return;const t=this.getSingleElements(e),s=t.indexOf(e),i=s>0?t[s-1]:s<t.length-1?t[s+1]:void 0;this.currentSingleElement=i}onQuestionsOnPageModeChanged(e){if(!(this.isShowingPreview||this.isDesignMode)&&(this.skippedPages=[],this.currentSingleElement=void 0,e==="singlePage"&&this.updatePagesContainer(),e==="inputPerPage"&&this.getAllQuestions().forEach(t=>t.resetSingleInput()),this.isSinglePage&&this.updatePagesContainer(),this.setupSingleInputNavigationActions(),this.isSingleVisibleQuestion)){const t=this.getSingleElements();t.length>0&&(this.currentSingleElement=t[0])}}setupSingleInputNavigationActions(){const e="sv-singleinput-add";if(this.isSingleVisibleInput){const t=()=>{this.currentSingleQuestion.singleInputAddItem(!0),this.resetNavigationButton()};this.addNavigationItem({id:e,visible:!1,action:()=>t()})}else this.removeNavigationItem(e)}getPageStartIndex(){return this.firstPageIsStartPage&&this.pages.length>0?1:0}get isFirstPage(){return this.getPropertyValue("isFirstPage")}get isLastPage(){return this.getPropertyValue("isLastPage")}updateNavigationElements(){this.updateButtonsVisibility()}updateButtonsVisibility(){this.updateIsFirstLastPageState(),this.setPropertyValue("isShowPrevButton",this.calcIsShowPrevButton()),this.setPropertyValue("isShowNextButton",this.calcIsShowNextButton()),this.setPropertyValue("isCompleteButtonVisible",this.calcIsCompleteButtonVisible()),this.setPropertyValue("isPreviewButtonVisible",this.calcIsPreviewButtonVisible()),this.setPropertyValue("isCancelPreviewButtonVisible",this.calcIsCancelPreviewButtonVisible()),this.updateSingleInputActions()}updateSingleInputActions(){if(!this.isSingleVisibleInput)return;const e=this.currentSingleQuestion;if(!e)return;function t(s){s&&(s.title=e.getSingleInputAddText(),s.visible=!!s.title)}t(this.navigationBar.getActionById("sv-singleinput-add"))}get isShowPrevButton(){return this.getPropertyValue("isShowPrevButton")}get isShowNextButton(){return this.getPropertyValue("isShowNextButton")}get isCompleteButtonVisible(){return this.getPropertyValue("isCompleteButtonVisible")}get isPreviewButtonVisible(){return this.getPropertyValue("isPreviewButtonVisible")}get isCancelPreviewButtonVisible(){return this.getPropertyValue("isCancelPreviewButtonVisible")}get isFirstElement(){return this.getPropertyValue("isFirstElement")}get isLastElement(){return this.getPropertyValue("isLastElement")}updateIsFirstLastPageState(){const e=this.currentPage;let t,s;const i=this.currentSingleElement;if(i){let r=!0,a=!0;if(this.isSingleVisibleInput){const u=i.getSingleInputElementPos();u!==0&&(r=u===-1,a=u===1)}const o=this.getSingleElements(),l=o.indexOf(i);l>=0&&(t=r&&l===0,s=a&&l===o.length-1)}this.setPropertyValue("isFirstPage",!!e&&e===this.firstVisiblePage&&(!i||t===!0)),this.setPropertyValue("isLastPage",!!e&&e===this.lastVisiblePage&&(!i||s===!0)),this.setPropertyValue("isFirstElement",t),this.setPropertyValue("isLastElement",s)}get isLastPageOrElement(){return this.isLastElement!==void 0?this.isLastElement:this.isLastPage}get isFirstPageOrElement(){return this.isFirstElement!==void 0?this.isFirstElement:this.isFirstPage}calcIsShowPrevButton(){if(this.isFirstPageOrElement||!this.showPrevButton||this.state!=="running")return!1;if(this.isFirstElement!==void 0)return!0;const e=this.visiblePages[this.currentPageNo-1];return e&&e.getMaxTimeToFinish()<=0}calcIsShowNextButton(){return this.state==="running"&&!this.isLastPageOrElement&&!this.canBeCompletedByTrigger}calcIsCompleteButtonVisible(){const e=this.state;return this.isEditMode&&(this.state==="running"&&(this.isLastPageOrElement&&!this.showPreviewBeforeComplete||this.canBeCompletedByTrigger)||e==="preview")&&this.showCompleteButton}calcIsPreviewButtonVisible(){return this.isEditMode&&this.showPreviewBeforeComplete&&this.state=="running"&&this.isLastPageOrElement}calcIsCancelPreviewButtonVisible(){return this.isEditMode&&this.showPreviewBeforeComplete&&this.state=="preview"}get firstVisiblePage(){if(this.visiblePageCount===1)return this.visiblePages[0];const e=this.pages;for(let t=0;t<e.length;t++)if(this.isPageInVisibleList(e[t]))return e[t];return null}get lastVisiblePage(){if(this.visiblePageCount===1)return this.visiblePages[0];const e=this.pages;for(let t=e.length-1;t>=0;t--)if(this.isPageInVisibleList(e[t]))return e[t];return null}doComplete(e=!1,t){if(!this.isCompleted)return this.checkOnCompletingEvent(e,t)?(this.checkOnPageTriggers(!0),this.stopTimer(),this.notifyQuestionsOnHidingContent(this.currentPage),this.isCompleted=!0,this.clearUnusedValues(),this.saveDataOnComplete(e,t),this.setCookie(),!0):(this.isCompleted=!1,!1)}saveDataOnComplete(e=!1,t){let s=this.hasCookie;const i=d=>{l=!0,this.setCompletedState("saving",d)},r=d=>{this.setCompletedState("error",d)},a=d=>{this.setCompletedState("success",d),this.navigateTo()},o=d=>{this.setCompletedState("","")};var l=!1,u={isCompleteOnTrigger:e,completeTrigger:t,showSaveInProgress:i,showSaveError:r,showSaveSuccess:a,clearSaveMessages:o,showDataSaving:i,showDataSavingError:r,showDataSavingSuccess:a,showDataSavingClear:o};this.onComplete.fire(this,u),!s&&this.surveyPostId&&this.sendResult(),l||this.navigateTo()}checkOnCompletingEvent(e,t){var s={allowComplete:!0,allow:!0,isCompleteOnTrigger:e,completeTrigger:t};return this.onCompleting.fire(this,s),s.allowComplete&&s.allow}start(){return!this.firstPageIsStartPage||(this.isCurrentPageRendering=!0,!this.validatePageCore(this.startPage,!0))?!1:(this.isStartedState=!1,this.notifyQuestionsOnHidingContent(this.pages[0]),this.startTimerFromUI(),this.onStarted.fire(this,{}),this.updateVisibleIndexes(),this.currentPageNo=0,this.currentPage&&this.currentPage.locStrsChanged(),!0)}get isValidatingOnServer(){return this.getPropertyValue("isValidatingOnServer",!1)}setIsValidatingOnServer(e){e!=this.isValidatingOnServer&&(this.setPropertyValue("isValidatingOnServer",e),this.onIsValidatingOnServerChanged())}createServerValidationOptions(e,t,s){var i=this;const r={data:{},errors:{},survey:this,complete:function(){i.completeServerValidation(r,t,s)}};if(e&&this.isValidateOnComplete)r.data=this.data;else for(var a=this.activePage.questions,o=0;o<a.length;o++){var l=a[o];if(l.visible){var u=this.getValue(l.getValueName());this.isValueEmpty(u)||(r.data[l.getValueName()]=u)}}return r}onIsValidatingOnServerChanged(){}doServerValidation(e,t=!1,s){if(!this.onServerValidateQuestions||this.onServerValidateQuestions.isEmpty||!e&&this.isValidateOnComplete)return!1;this.setIsValidatingOnServer(!0);const i=typeof this.onServerValidateQuestions=="function";return this.serverValidationEventCount=i?1:this.onServerValidateQuestions.length,i?this.onServerValidateQuestions(this,this.createServerValidationOptions(e,t,s)):this.onServerValidateQuestions.fireByCreatingOptions(this,()=>this.createServerValidationOptions(e,t,s)),!0}completeServerValidation(e,t,s){if(this.serverValidationEventCount>1&&(this.serverValidationEventCount--,e&&e.errors&&Object.keys(e.errors).length===0)||(this.serverValidationEventCount=0,this.setIsValidatingOnServer(!1),!e&&!e.survey))return;var i=e.survey;let r=!0;if(e.errors){var a=this.autoFocusFirstError;for(var o in e.errors){var l=i.getQuestionByName(o);l&&l.errors&&(r=!1,l.addError(new Ps(e.errors[o],this)),a&&(a=!1,l.page&&(this.currentPage=l.page),l.focus(!0)))}this.fireValidatedErrorsOnPage(this.currentPage)}r&&(t?this.showPreviewCore():s?this.currentPage=s:i.isLastPage?i.doComplete():i.doNextPage())}doNextPage(){var e=this.currentPage;if(this.checkOnPageTriggers(!1),this.sendPartialResult(),this.isCompleted)this.doComplete(!0);else if(e===this.currentPage){var t=this.visiblePages,s=t.indexOf(this.currentPage);this.currentPage=t[s+1]}}setCompleted(e){this.doComplete(!0,e)}sendPartialResult(){this.partialSendEnabled&&!this.isCompleted&&this.sendResult(this.surveyPostId,this.clientId,!0)}canBeCompleted(e,t){var s;if(!D.triggers.changeNavigationButtonsOnComplete)return;const i=this.canBeCompletedByTrigger;this.completedByTriggers||(this.completedByTriggers={}),t?this.completedByTriggers[e.id]={trigger:e,pageId:(s=this.currentPage)===null||s===void 0?void 0:s.id}:delete this.completedByTriggers[e.id],i!==this.canBeCompletedByTrigger&&this.updateButtonsVisibility()}get canBeCompletedByTrigger(){var e;if(!this.completedByTriggers)return!1;const t=Object.keys(this.completedByTriggers);if(t.length===0)return!1;const s=(e=this.currentPage)===null||e===void 0?void 0:e.id;if(!s)return!0;for(let i=0;i<t.length;i++)if(s===this.completedByTriggers[t[i]].pageId)return!0;return!1}get completedTrigger(){if(!this.canBeCompletedByTrigger)return;const e=Object.keys(this.completedByTriggers)[0];return this.completedByTriggers[e].trigger}get processedCompletedHtml(){var e=this.renderedCompletedHtml;return e?this.processHtml(e,"completed"):""}get processedCompletedBeforeHtml(){return this.locCompletedBeforeHtml.textOrHtml}get processedLoadingHtml(){return this.locLoadingHtml.textOrHtml}getProgressInfo(){var e=this.isDesignMode?this.pages:this.visiblePages;return Ke.getProgressInfoByElements(e,!1)}get progressBarAriaLabel(){return bt("progressbar",this.getLocale())}get progressText(){return this.progressBar.progressText}get progressValue(){return this.getPropertyValue("progressValue",void 0,()=>this.getProgress())}updateProgressText(e=!1){this.isShowingPreview||e&&this.progressBarType=="pages"&&this.onGetProgressText.isEmpty||(this.progressBarValue&&this.progressBarValue.resetProgressText(),this.resetPropertyValue("progressValue"))}getProgressText(){if(!this.isDesignMode&&this.currentPage==null)return"";const e={questionCount:0,answeredQuestionCount:0,requiredQuestionCount:0,requiredAnsweredQuestionCount:0,text:""};var t=this.progressBarType.toLowerCase();if(t==="questions"||t==="requiredquestions"||t==="correctquestions"||!this.onGetProgressText.isEmpty){var s=this.getProgressInfo();e.questionCount=s.questionCount,e.answeredQuestionCount=s.answeredQuestionCount,e.requiredQuestionCount=s.requiredQuestionCount,e.requiredAnsweredQuestionCount=s.requiredAnsweredQuestionCount}return e.text=this.getProgressTextCore(e),this.onGetProgressText.fire(this,e),e.text}getProgressTextCore(e){var t=this.progressBarType.toLowerCase();if(t==="questions")return this.getLocalizationFormatString("questionsProgressText",e.answeredQuestionCount,e.questionCount);if(t==="requiredquestions")return this.getLocalizationFormatString("questionsProgressText",e.requiredAnsweredQuestionCount,e.requiredQuestionCount);if(t==="correctquestions"){var s=this.getCorrectedAnswerCount();return this.getLocalizationFormatString("questionsProgressText",s,e.questionCount)}var i=this.isDesignMode?this.pages:this.visiblePages,r=i.indexOf(this.currentPage)+1;return this.getLocalizationFormatString("progressText",r,i.length)}getRootCss(){return new j().append(this.css.root).append(this.css.rootProgress+"--"+this.progressBarType).append(this.css.rootMobile,this.isMobile).append(this.css.rootAnimationDisabled,!D.animationEnabled).append(this.css.rootReadOnly,this.readOnly&&!this.isDesignMode).append(this.css.rootCompact,this.isCompact).append(this.css.rootFitToContainer,this.fitToContainer).toString()}afterRenderSurvey(e){if(!he.isAvailable())return;this.destroyResizeObserver(),Array.isArray(e)&&(e=Ke.GetFirstNonTextElement(e));let t=e;const s=this.css.variables;if(s){const i=Number.parseFloat(oe.getComputedStyle(t).getPropertyValue(s.mobileWidth));if(i){let r=!1;this.resizeObserver=new ResizeObserver(a=>{he.requestAnimationFrame(()=>{r||!Ed(t)?r=!1:r=this.processResponsiveness(t.offsetWidth,i,t.offsetHeight)})}),this.resizeObserver.observe(t)}}this.onAfterRenderSurvey.fire(this,{survey:this,htmlElement:e}),this.rootElement=e,this.scrollerElement=e.getElementsByClassName("sv-scroll__scroller")[0],this.addScrollEventListener()}beforeDestroySurveyElement(){this.destroyResizeObserver(),this.removeScrollEventListener(),this.rootElement=void 0,this.scrollerElement=void 0}processResponsiveness(e,t,s){const i=e<t,r=this.isMobile!==i;this.setIsMobile(i),this.layoutElements.forEach(o=>o.processResponsiveness&&o.processResponsiveness(e));const a={height:s,width:e};return this.onResize.fire(this,a),r}triggerResponsiveness(e){this.getAllQuestions().forEach(t=>{t.triggerResponsiveness(e)})}destroyResizeObserver(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=void 0)}updateQuestionCssClasses(e,t){this.onUpdateQuestionCssClasses.fire(this,{question:e,cssClasses:t})}updatePanelCssClasses(e,t){this.onUpdatePanelCssClasses.fire(this,{panel:e,cssClasses:t})}updatePageCssClasses(e,t){this.onUpdatePageCssClasses.fire(this,{page:e,cssClasses:t})}updateChoiceItemCss(e,t){t.question=e,this.onUpdateChoiceItemCss.fire(this,t)}afterRenderPage(e){if(!this.isDesignMode&&!this.focusingQuestionInfo){const t=this.isCurrentPageRendered===!1;setTimeout(()=>this.scrollToTopOnPageChange(t),1)}this.focusQuestionInfo(),this.isCurrentPageRendered=!0,!this.onAfterRenderPage.isEmpty&&this.onAfterRenderPage.fire(this,{page:this.activePage,htmlElement:e})}afterRenderHeader(e){this.onAfterRenderHeader.isEmpty||this.onAfterRenderHeader.fire(this,{htmlElement:e})}afterRenderQuestion(e,t){this.onAfterRenderQuestion.fire(this,{question:e,htmlElement:t})}afterRenderQuestionInput(e,t){if(this.onAfterRenderQuestionInput.isEmpty)return;let s=e.inputId;const{root:i}=D.environment;if(s&&(!t||t.id!==s)&&typeof i<"u"){let r=i.getElementById(s);r&&(t=r)}this.onAfterRenderQuestionInput.fire(this,{question:e,htmlElement:t})}afterRenderPanel(e,t){this.onAfterRenderPanel.fire(this,{panel:e,htmlElement:t})}whenQuestionFocusIn(e){this.onFocusInQuestion.fire(this,{question:e})}whenPanelFocusIn(e){this.onFocusInPanel.fire(this,{panel:e})}rebuildQuestionChoices(){this.getAllQuestions().forEach(e=>e.surveyChoiceItemVisibilityChange())}canChangeChoiceItemsVisibility(){return!this.onShowingChoiceItem.isEmpty}getChoiceItemVisibility(e,t,s){const i={question:e,item:t,visible:s};return this.onShowingChoiceItem.fire(this,i),i.visible}loadQuestionChoices(e){this.onChoicesLazyLoad.fire(this,e)}getChoiceDisplayValue(e){this.onGetChoiceDisplayValue.isEmpty?e.setItems(null):this.onGetChoiceDisplayValue.fire(this,e)}matrixBeforeRowAdded(e){this.onMatrixRowAdding.fire(this,e)}matrixRowAdded(e,t){this.onMatrixRowAdded.fire(this,{question:e,row:t})}matrixColumnAdded(e,t){this.onMatrixColumnAdded.fire(this,{question:e,column:t})}multipleTextItemAdded(e,t){this.onMultipleTextItemAdded.fire(this,{question:e,item:t})}getQuestionByValueNameFromArray(e,t,s){var i=this.getQuestionsByValueName(e);if(i){for(var r=0;r<i.length;r++){var a=i[r].getQuestionFromArray(t,s);if(a)return a}return null}}matrixRowRemoved(e,t,s){this.onMatrixRowRemoved.fire(this,{question:e,rowIndex:t,row:s})}matrixRowRemoving(e,t,s){var i={question:e,rowIndex:t,row:s,allow:!0};return this.onMatrixRowRemoving.fire(this,i),i.allow}matrixAllowRemoveRow(e,t,s){const i={question:e,rowIndex:t,row:s,allow:!0};return this.onMatrixRenderRemoveButton.fire(this,i),i.allow}matrixDetailPanelVisibleChanged(e,t,s,i){const r={question:e,rowIndex:t,row:s,visible:i,detailPanel:s.detailPanel};this.onMatrixDetailPanelVisibleChanged.fire(this,r)}matrixCellCreating(e,t){t.question=e,this.onMatrixCellCreating.fire(this,t)}matrixCellCreated(e,t){t.question=e,this.onMatrixCellCreated.fire(this,t)}matrixAfterCellRender(e){var t;const s=this.onAfterRenderMatrixCell;s.isEmpty||(e.question=(t=e.cellQuestion)===null||t===void 0?void 0:t.parentQuestion,s.fire(this,e))}matrixCellValueChanged(e,t){t.question=e,this.onMatrixCellValueChanged.fire(this,t)}matrixCellValueChanging(e,t){t.question=e,this.onMatrixCellValueChanging.fire(this,t)}get isValidateOnValueChanging(){return this.checkErrorsMode==="onValueChanging"}get isValidateOnValueChanged(){return this.checkErrorsMode==="onValueChanged"}get isValidateOnValueChange(){return this.isValidateOnValueChanged||this.isValidateOnValueChanging}get isValidateOnComplete(){return this.checkErrorsMode==="onComplete"||this.validationAllowSwitchPages&&!this.validationAllowComplete}matrixCellValidate(e,t){return t.question=e,this.onMatrixCellValidate.fire(this,t),t.error?new Ps(t.error,this):null}dynamicPanelAdded(e,t,s,i){!this.isLoadingFromJson&&i&&this.updateVisibleIndexes(e.page),this.onDynamicPanelAdded.fire(this,{question:e,panel:s,panelIndex:t})}dynamicPanelRemoved(e,t,s,i){for(var r=s?s.questions:[],a=0;a<r.length;a++)r[a].clearOnDeletingContainer();i&&this.updateVisibleIndexes(e.page),this.onDynamicPanelRemoved.fire(this,{question:e,panelIndex:t,panel:s})}dynamicPanelRemoving(e,t,s){const i={question:e,panelIndex:t,panel:s,allow:!0};return this.onDynamicPanelRemoving.fire(this,i),i.allow}dynamicPanelGetTabTitle(e,t){t.question=e,this.onGetDynamicPanelTabTitle.fire(this,t)}dynamicPanelCurrentIndexChanged(e,t){t.question=e,this.onDynamicPanelCurrentIndexChanged.fire(this,t)}dragAndDropAllow(e){return this.onDragDropAllow.fire(this,e),e.allow}elementContentVisibilityChanged(e){this.currentPage&&this.currentPage.ensureRowsVisibility(),this.onElementContentVisibilityChanged.fire(this,{element:e})}getUpdatedPanelFooterActions(e,t,s){const i={question:s,panel:e,actions:t};return this.onGetPanelFooterActions.fire(this,i),i.actions}getUpdatedElementTitleActions(e,t){return e.isPage?this.getUpdatedPageTitleActions(e,t):e.isPanel?this.getUpdatedPanelTitleActions(e,t):this.getUpdatedQuestionTitleActions(e,t)}getTitleActionsResult(e,t){return e!=t.actions?t.actions:e!=t.titleActions?t.titleActions:e}getUpdatedQuestionTitleActions(e,t){const s={question:e,actions:t,titleActions:t};return this.onGetQuestionTitleActions.fire(this,s),this.getTitleActionsResult(t,s)}getUpdatedPanelTitleActions(e,t){const s={panel:e,actions:t,titleActions:t};return this.onGetPanelTitleActions.fire(this,s),this.getTitleActionsResult(t,s)}getUpdatedPageTitleActions(e,t){var s={page:e,actions:t,titleActions:t};return this.onGetPageTitleActions.fire(this,s),this.getTitleActionsResult(t,s)}getUpdatedMatrixRowActions(e,t,s){const i={question:e,actions:s,row:t};return this.onGetMatrixRowActions.fire(this,i),i.actions}scrollElementToTop(e,t,s,i,r,a,o,l){const u={element:e,question:t,page:s,elementId:i,cancel:!1,allow:!0};if(this.onScrollToTop.fire(this,u),!u.cancel&&u.allow){const d=this.getPageByElement(e),{rootElement:h}=D.environment,f=this.rootElement||o||h;if(this.isLazyRendering&&d){let C=1;this.skeletonHeight&&f&&typeof f.getBoundingClientRect=="function"&&(C=f.getBoundingClientRect().height/this.skeletonHeight-1),d.forceRenderElement(e,()=>{const b=f?.querySelector(`#${u.elementId}`);this.suspendLazyRendering(),Ke.ScrollElementToTop(b,r,a,()=>{this.releaseLazyRendering();const x=f.querySelector(`#${d.id}`);xd(x),l&&l()})},C)}else if(e.isPage&&!this.isSinglePage&&!this.isDesignMode&&this.rootElement){const C=f.querySelector(ls(this.css.rootWrapper));Ke.ScrollElementToViewCore(C,!1,r,a,l)}else{const C=f?.querySelector(`#${u.elementId}`);this.suspendLazyRendering(),Ke.ScrollElementToTop(C,r,a,()=>{this.releaseLazyRendering(),xd(C),l&&l()})}}}chooseFiles(e,t,s){this.onOpenFileChooser.isEmpty?SR(e,t):this.onOpenFileChooser.fire(this,{input:e,element:s&&s.element||this.survey,elementType:s&&s.elementType,item:s&&s.item,propertyName:s&&s.propertyName,callback:t,context:s})}uploadFiles(e,t,s,i,r){this.onUploadFiles.isEmpty?i("error",this.getLocString("noUploadFilesHandler")):this.taskManager.runTask("file",a=>{this.onUploadFiles.fire(this,{question:e,name:t,sourceType:r,files:s||[],callback:(o,l)=>{i(o,l),a()}})}),this.surveyPostId&&this.uploadFilesCore(t,s,i)}downloadFile(e,t,s,i){this.onDownloadFile.isEmpty&&i&&i("skipped",s.content||s),this.onDownloadFile.fire(this,{question:e,name:t,content:s.content||s,fileValue:s,callback:i})}clearFiles(e,t,s,i,r){this.onClearFiles.isEmpty&&r&&r("success",s),this.onClearFiles.fire(this,{question:e,name:t,value:s,fileName:i,callback:r})}updateChoicesFromServer(e,t,s){var i={question:e,choices:t,serverResult:s};return this.onChoicesLoaded.fire(this,i),i.choices}loadedChoicesFromServer(e){this.locStrsChanged()}uploadFilesCore(e,t,s){this.reportWarningOnUsingService()}getPage(e){return this.pages[e]}addPage(e,t=-1){e!=null&&(t<0||t>=this.pages.length?this.pages.push(e):this.pages.splice(t,0,e))}addNewPage(e=null,t=-1){var s=this.createNewPage(e);return this.addPage(s,t),s}removePage(e){var t=this.pages.indexOf(e);t<0||(this.pages.splice(t,1),this.currentPage==e&&(this.currentPage=this.pages.length>0?this.pages[0]:null))}getQuestionByName(e,t=!1){const s=this.getQuestionsFromHash(this.questionHashes.names,this.questionHashes.namesInsensitive,e,t);return s?s[0]:null}findQuestionByName(e){return this.getQuestionByName(e)}getEditingSurveyElement(){return this.editingObjValue}getQuestionByValueName(e,t=!1){var s=this.getQuestionsByValueName(e,t);return s?s[0]:null}getQuestionsByValueName(e,t=!1){return this.getQuestionsFromHash(this.questionHashes.valueNames,this.questionHashes.valueNamesInsensitive,e,t)}getCalculatedValueByName(e){for(var t=0;t<this.calculatedValues.length;t++)if(e==this.calculatedValues[t].name)return this.calculatedValues[t];return null}getQuestionsFromHash(e,t,s,i){if(!s)return null;let r=e[s];return r||i&&(s=s.toLowerCase(),r=t[s],r)?r:null}getQuestionsByNames(e,t=!1){var s=[];if(!e)return s;for(var i=0;i<e.length;i++)if(e[i]){var r=this.getQuestionByName(e[i],t);r&&s.push(r)}return s}getPageByElement(e){for(var t=0;t<this.pages.length;t++){var s=this.pages[t];if(s.containsElement(e))return s}return null}getPageByQuestion(e){return this.getPageByElement(e)}getPageByName(e){for(var t=0;t<this.pages.length;t++)if(this.pages[t].name==e)return this.pages[t];return null}getPagesByNames(e){var t=[];if(!e)return t;for(var s=0;s<e.length;s++)if(e[s]){var i=this.getPageByName(e[s]);i&&t.push(i)}return t}getAllQuestions(e=!1,t=!1,s=!1){s&&(t=!1,(e?this.visiblePages:this.pages).forEach(o=>o.onFirstRendering()));for(var i=[],r=0;r<this.pages.length;r++)this.pages[r].addQuestionsToList(i,e,t);return s?this.getNestedQuestionsByQuestionArray(i,e):i}getNestedQuestionsByQuestionArray(e,t){const s=[];return e.forEach(i=>{i.getNestedQuestions(t,!0,!0).forEach(r=>s.push(r))}),s}getQuizQuestions(){for(var e=new Array,t=this.getPageStartIndex(),s=t;s<this.pages.length;s++)if(this.pages[s].isVisible)for(var i=this.pages[s].questions,r=0;r<i.length;r++){var a=i[r];a.quizQuestionCount>0&&e.push(a)}return e}getPanelByName(e,t=!1){var s=this.getAllPanels();t&&(e=e.toLowerCase());for(var i=0;i<s.length;i++){var r=s[i].name;if(t&&(r=r.toLowerCase()),r==e)return s[i]}return null}getAllPanels(e=!1,t=!1){for(var s=new Array,i=0;i<this.pages.length;i++)this.pages[i].addPanelsIntoList(s,e,t);return s}createNewPage(e){const t=B.createClass("page");return t.name=e,t}getValueChangeReason(){return this.isSettingValueOnExpression?"expression":this.isSettingValueFromTrigger?"trigger":void 0}questionOnValueChanging(e,t,s){if(this.editingObj){const r=B.findProperty(this.editingObj.getType(),e);r&&(t=r.settingValue(this.editingObj,t))}if(this.onValueChanging.isEmpty)return t;var i={name:e,question:this.getQuestionByValueName(s||e),value:this.getUnbindValue(t),oldValue:this.getValue(e),reason:this.getValueChangeReason()};return this.onValueChanging.fire(this,i),i.value}getLocNotification(e,t,s){return e||L.isTwoValueEquals(t,s,!1,!0,!1)}updateQuestionValue(e,t){if(!this.isLoadingFromJson){var s=this.getQuestionsByValueName(e);if(s)for(var i=0;i<s.length;i++){var r=s[i].value;(r===t&&Array.isArray(r)&&this.editingObj||!this.isTwoValueEquals(r,t))&&s[i].updateValueFromSurvey(t,!1)}}}validateQuestionOnValueChanged(e){!this.isNavigationButtonPressed&&(this.isValidateOnValueChanged||e.getAllErrors().length>0)&&this.validateQuestionOnValueChangedCore(e)}validateQuestionOnValueChangedCore(e){var t=e.getAllErrors().length;let s=e.validate(!0,!1,!this.isValidateOnValueChanging);return e.page&&this.isValidateOnValueChange&&(t>0||e.getAllErrors().length>0)&&this.fireValidatedErrorsOnPage(e.page),s}validateOnValueChanging(e,t){if(this.isLoadingFromJson)return!1;const s=this.getQuestionsByValueName(e);if(!s)return!1;let i=!0;for(let r=0;r<s.length;r++){const a=s[r];this.isTwoValueEquals(a.valueForSurvey,t)||(a.value=t),i=this.validateQuestionOnValueChangedCore(a)&&i&&a.errors.length==0}return i}fireOnValueChanged(e,t,s){this.onValueChanged.fire(this,{name:e,question:s,value:t,reason:this.getValueChangeReason()})}notifyQuestionOnValueChanged(e,t,s){if(!this.isLoadingFromJson){var i=this.getQuestionsByValueName(e);if(i)for(var r=0;r<i.length;r++){var a=i[r];this.validateQuestionOnValueChanged(a),a.onSurveyValueChanged(t)}this.updateProgressText(!0),this.fireOnValueChanged(e,t,s?this.getQuestionByName(s):void 0),!this.isDisposed&&(this.checkElementsBindings(e,t),this.notifyElementsOnAnyValueOrVariableChanged(e,s))}}checkElementsBindings(e,t){this.isRunningElementsBindings=!0;for(var s=0;s<this.pages.length;s++)this.pages[s].checkBindings(e,t);this.isRunningElementsBindings=!1,this.updateVisibleIndexAfterBindings&&(this.updateVisibleIndexes(),this.updateVisibleIndexAfterBindings=!1)}notifyElementsOnAnyValueOrVariableChanged(e,t){if(this.isEndLoadingFromJson!=="processing"){if(this.isRunningConditions){this.conditionNotifyElementsOnAnyValueOrVariableChanged=!0;return}for(var s=0;s<this.pages.length;s++)this.pages[s].onAnyValueChanged(e,t);this.isEndLoadingFromJson||this.locStrsChanged()}}updateAllQuestionsValue(e){for(var t=this.getAllQuestions(),s=0;s<t.length;s++){var i=t[s],r=i.getValueName();i.updateValueFromSurvey(this.getValue(r),e),i.requireUpdateCommentValue&&i.updateCommentFromSurvey(this.getComment(r))}}notifyAllQuestionsOnValueChanged(){for(var e=this.getAllQuestions(),t=0;t<e.length;t++)e[t].onSurveyValueChanged(this.getValue(e[t].getValueName()))}checkOnPageTriggers(e){for(var t=this.getCurrentPageQuestions(!0),s={},i=0;i<t.length;i++){var r=t[i],a=r.getValueName();s[a]=this.getValue(a)}this.addCalculatedValuesIntoFilteredValues(s),this.checkTriggers(s,!0,e)}getCurrentPageQuestions(e=!1){var t=[],s=this.currentPage;if(!s)return t;for(var i=0;i<s.questions.length;i++){var r=s.questions[i];!e&&!r.visible||!r.name||t.push(r)}return t}checkTriggers(e,t,s=!1,i=!1,r){if(this.isCompleted||this.triggers.length==0||this.isDisplayMode)return;if(this.isTriggerIsRunning){for(var a in e)this.triggerKeys[a]=e[a];return}let o=!1;if(!s&&r&&this.hasRequiredValidQuestionTrigger){const d=this.getQuestionByValueName(r);o=d&&!d.validate(!1)}this.isTriggerIsRunning=!0,this.triggerKeys=e;var l=this.getFilteredProperties();let u=this.canBeCompletedByTrigger;for(let d=0;d<this.triggers.length;d++){const h=this.triggers[d];if(o&&h.requireValidQuestion)continue;const f={isOnNextPage:t,isOnComplete:s,isOnNavigation:i,keys:this.triggerKeys,properties:l};h.checkExpression(f)}u!==this.canBeCompletedByTrigger&&this.updateButtonsVisibility(),this.isTriggerIsRunning=!1}checkTriggersAndRunConditions(e,t,s){var i={};i[e]={newValue:t,oldValue:s},this.runConditionOnValueChanged(e,t),this.checkTriggers(i,!1,!1,!1,e)}get hasRequiredValidQuestionTrigger(){for(let e=0;e<this.triggers.length;e++)if(this.triggers[e].requireValidQuestion)return!0;return!1}doElementsOnLoad(){for(var e=0;e<this.pages.length;e++)this.pages[e].onSurveyLoad()}get isRunningConditions(){return this.isRunningConditionsValue}runExpressions(){this.runConditions()}runConditions(){if(!(this.isCompleted||this.isEndLoadingFromJson==="processing"||this.isRunningConditions)){this.isRunningConditionsValue=!0;var e=this.getFilteredProperties();this.runConditionsCore(e),this.isRunningConditionsValue=!1,this.isValueChangedOnRunningCondition&&this.conditionRunnerCounter<D.maxConditionRunCountOnValueChanged?(this.isValueChangedOnRunningCondition=!1,this.conditionRunnerCounter++,this.runConditions()):(this.isValueChangedOnRunningCondition=!1,this.conditionRunnerCounter=0,this.conditionUpdateVisibleIndexes&&(this.conditionUpdateVisibleIndexes=!1,this.updateVisibleIndexes()),this.conditionNotifyElementsOnAnyValueOrVariableChanged&&(this.conditionNotifyElementsOnAnyValueOrVariableChanged=!1,this.notifyElementsOnAnyValueOrVariableChanged("")))}}runConditionOnValueChanged(e,t){this.questionTriggersKeys||(this.questionTriggersKeys={}),this.questionTriggersKeys[e]=t,this.isRunningConditions?this.isValueChangedOnRunningCondition=!0:(this.runConditions(),this.runQuestionsTriggers(e,t),this.questionTriggersKeys=void 0)}runConditionsCore(e){for(var t=this.pages,s=0;s<this.calculatedValues.length;s++)this.calculatedValues[s].resetCalculation();for(var s=0;s<this.calculatedValues.length;s++)this.calculatedValues[s].doCalculation(this.calculatedValues,e);super.runConditionCore(e);for(let i=0;i<t.length;i++)t[i].runCondition(e)}runQuestionsTriggers(e,t){if(this.isDisplayMode||this.isDesignMode)return;this.getAllQuestions().forEach(i=>{i.runTriggers(e,t,this.questionTriggersKeys)})}sendResult(e=null,t=null,s=!1){this.isEditMode&&(s&&this.onPartialSend&&this.onPartialSend.fire(this,null),!e&&this.surveyPostId&&(e=this.surveyPostId),e&&(t&&(this.clientId=t),!(s&&!this.clientId)&&this.reportWarningOnUsingService()))}getResult(e,t){this.reportWarningOnUsingService()}loadSurveyFromService(e=null,t=null){e&&(this.surveyId=e),t&&(this.clientId=t),this.reportWarningOnUsingService()}reportWarningOnUsingService(){xs.warn("Self-hosted Form Library no longer supports integration with SurveyJS Demo Service. Learn more: https://surveyjs.io/stay-updated/release-notes/v2.0.0#form-library-removes-apis-for-integration-with-surveyjs-demo-service")}loadSurveyFromServiceJson(e){e&&(this.fromJSON(e),this.notifyAllQuestionsOnValueChanged(),this.onLoadSurveyFromService(),this.onLoadedSurveyFromService.fire(this,{}))}onLoadingSurveyFromService(){}onLoadSurveyFromService(){}resetVisibleIndexes(){for(var e=this.getAllQuestions(!0),t=0;t<e.length;t++)e[t].setVisibleIndex(-1);this.updateVisibleIndexes()}updateVisibleIndexes(e){if(!(this.isLoadingFromJson||this.isEndLoadingFromJson)){if(this.isRunningConditions&&this.onQuestionVisibleChanged.isEmpty&&this.onPageVisibleChanged.isEmpty){this.conditionUpdateVisibleIndexes=!0;return}if(this.isRunningElementsBindings){this.updateVisibleIndexAfterBindings=!0;return}this.updatePageVisibleIndexes(),this.updatePageElementsVisibleIndexes(e),this.updateProgressText(!0)}}updatePageElementsVisibleIndexes(e){if(this.showQuestionNumbers=="onPage")for(var t=e?[e]:this.visiblePages,s=0;s<t.length;s++)t[s].setVisibleIndex(0);else{let i=this.getStartVisibleIndex();const r=this.pages;for(let a=0;a<r.length;a++)i+=r[a].setVisibleIndex(i)}}getStartVisibleIndex(){const e=this.showQuestionNumbers;return e==="on"||e==="recursive"?0:-1}updatePageVisibleIndexes(){this.updateButtonsVisibility();let e=0,t=1;this.pages.forEach(i=>{});for(var s=0;s<this.pages.length;s++){const i=this.pages[s],r=i.isVisible&&(s>0||!i.isStartPage);i.questionStartIndex&&(t=1),i.visibleIndex=r?e++:-1,i.num=r?t++:-1}}fromJSON(e,t){if(!e)return;this.resetHasLogo(),this.resetPropertyValue("titleIsEmpty"),this.questionHashesClear(),this.jsonErrors=null,this.sjsVersion=void 0;const s=new rt;s.toObject(e,this,t),s.errors.length>0&&(this.jsonErrors=s.errors),this.onStateAndCurrentPageChanged(),this.endLoading(),this.updateState(),this.sjsVersion&&D.version&&L.compareVerions(this.sjsVersion,D.version)>0&&xs.warn("The version of the survey JSON schema (v"+this.sjsVersion+") is newer than your current Form Library version ("+D.version+"). Please update the Form Library to make sure that all survey features work as expected.")}startLoadingFromJson(e){super.startLoadingFromJson(e),e&&e.locale&&(this.locale=e.locale)}setJsonObject(e){this.fromJSON(e)}endLoadingFromJson(){this.isEndLoadingFromJson="processing",this.onFirstPageIsStartedChanged(),super.endLoadingFromJson(),this.hasCookie&&(this.isCompletedBefore=!0),this.doElementsOnLoad(),this.onQuestionsOnPageModeChanged("standard"),this.isEndLoadingFromJson="conditions",this.runConditions(),this.notifyElementsOnAnyValueOrVariableChanged(""),this.isEndLoadingFromJson=null,this.updateVisibleIndexes(),this.updateCurrentPage(),this.setCalculatedWidthModeUpdater(),this.onEndLoadingFromJson.fire(this,{})}onBeforeRunConstructor(){}onBeforeCreating(){}onCreating(){}getProcessedTextValue(e){if(this.getProcessedTextValueCore(e),!this.onProcessDynamicText.isEmpty){var t=this.isValueEmpty(e.value);this.onProcessDynamicText.fire(this,e),e.isExists=e.isExists||t&&!this.isValueEmpty(e.value)}}getProcessedTextValueCore(e){const t=e.name.toLocaleLowerCase();if(["no","require","title"].indexOf(t)!==-1)return;const s=new Di().getValueInfo({name:t,context:this.getValueGetterContext(),isText:!0,isDisplayValue:e.returnDisplayValue});s.isFound&&(e.isExists=!0,e.value=s.value)}clearUnusedValues(){this.isClearingUnsedValues=!0;for(var e=this.getAllQuestions(),t=0;t<e.length;t++)e[t].clearUnusedValues();this.clearInvisibleQuestionValues(),this.isClearingUnsedValues=!1}hasVisibleQuestionByValueName(e){const t=e;var s=this.getQuestionsByValueName(t.getValueName());if(!Array.isArray(s)||s.length<2)return!1;for(var i=0;i<s.length;i++){const r=s[i];if(r!==t&&r.isVisible&&r.isParentVisible&&!r.parentQuestion&&r.parentQuestion===t.parentQuestion)return!0}return!1}questionsByValueName(e){var t=this.getQuestionsByValueName(e);return t||[]}clearInvisibleQuestionValues(){const e=this.clearInvisibleValues==="none"?"none":"onComplete",t=this.getAllQuestions();for(var s=0;s<t.length;s++)t[s].clearValueIfInvisible(e)}getVariable(e){if(!e)return null;e=e.toLowerCase();var t=this.variablesHash[e];return this.isValueEmpty(t)&&(e.indexOf(".")>-1||e.indexOf("[")>-1)?new Di().getValue(e,new ws(this.variablesHash)):t}setVariable(e,t){if(!e)return;const s=this.getVariable(e);this.valuesHash&&delete this.valuesHash[e],e=e.toLowerCase(),this.variablesHash[e]=t,this.notifyElementsOnAnyValueOrVariableChanged(e),L.isTwoValueEquals(s,t)||(this.checkTriggersAndRunConditions(e,t,s),this.onVariableChanged.fire(this,{name:e,value:t}))}getVariableNames(){var e=[];for(var t in this.variablesHash)e.push(t);return e}getUnbindValue(e){return this.editingObj?e:L.getUnbindValue(e)}getValue(e){if(!e||e.length==0)return null;var t=this.getDataValueCore(this.valuesHash,e);return this.getUnbindValue(t)}setValue(e,t,s=!1,i=!0,r){var a=t;if(i&&(a=this.questionOnValueChanging(e,t)),!(this.isValidateOnValueChanging&&!this.validateOnValueChanging(e,a))&&!(!this.editingObj&&this.isValueEqual(e,a)&&this.isTwoValueEquals(a,t))){var o=this.getValue(e);this.isValueEmpyOnSetValue(e,a)?this.deleteDataValueCore(this.valuesHash,e):(a=this.getUnbindValue(a),this.setDataValueCore(this.valuesHash,e,a)),s=this.getLocNotification(s,a,o),this.updateOnSetValue(e,a,o,s,i,r)}}questionValueChanging(e,t){const s=e,i=s.parentQuestion;if(!i)return t;if(i.isDescendantOf("paneldynamic")&&!this.onDynamicPanelValueChanging.isEmpty){const r=i.getValueChangingOptions(s);if(r)return r.value=t,this.onDynamicPanelValueChanging.fire(this,r),r.value}return t}questionValueChanged(e,t){const s=e,i=s.parentQuestion;if(i&&i.isDescendantOf("paneldynamic")&&!this.onDynamicPanelValueChanged.isEmpty){const r=i.getValueChangingOptions(s);r&&(r.value=s.value,r.oldValue=t,this.onDynamicPanelValueChanged.fire(this,r))}}isValueEmpyOnSetValue(e,t){return this.isValueEmpty(t,!1)?!this.editingObj||t===null||t===void 0?!0:this.editingObj.getDefaultPropertyValue(e)===t:!1}updateOnSetValue(e,t,s,i=!1,r=!0,a){this.updateQuestionValue(e,t),!(i===!0||this.isDisposed||this.isRunningElementsBindings)&&(a=a||e,this.nofifyQuesitonHash[e]=!0,this.checkTriggersAndRunConditions(e,t,s),this.nofifyQuesitonHash[e]&&(r&&this.notifyQuestionOnValueChanged(e,t,a),i!=="text"&&this.tryGoNextPageAutomatic(e),delete this.nofifyQuesitonHash[e]))}isValueEqual(e,t){(t===""||t===void 0)&&(t=null);var s=this.getValue(e);return(s===""||s===void 0)&&(s=null),t===null||s===null?t===s:this.isTwoValueEquals(t,s)}doOnPageAdded(e){if(e.setSurveyImpl(this),e.name||(e.name=this.generateNewName(this.pages,"page")),this.questionHashesPanelAdded(e),this.updateVisibleIndexes(),!this.runningPages&&(this.isLoadingFromJson||(this.updateProgressText(),this.updateCurrentPage()),this.canFireAddPage())){var t={page:e};this.onPageAdded.fire(this,t)}}canFireAddPage(){return!this.isMovingPage}doOnPageRemoved(e){e.setSurveyImpl(null),!this.runningPages&&(e===this.currentPage&&this.updateCurrentPage(),this.updateVisibleIndexes(),this.updateProgressText(),this.updateLazyRenderingRowsOnRemovingElements())}generateNewName(e,t){for(var s={},i=0;i<e.length;i++)s[e[i].name]=!0;for(var r=1;s[t+r];)r++;return t+r}tryGoNextPageAutomatic(e){if(this.isEndLoadingFromJson||!this.autoAdvanceEnabled||!this.currentPage)return;const t=this.getQuestionByValueName(e);if(!t||t&&(!t.visible||!t.supportAutoAdvance())||!t.validate(!1)&&!t.supportGoNextPageError())return;if(this.currentSingleElement){const o=this.currentSingleElement,l=()=>{o===this.currentSingleElement&&(this.isLastElement?this.autoAdvanceAllowComplete&&this.tryCompleteOrShowPreview():this.performNext())};Ni.safeTimeOut(l,D.autoAdvanceDelay)}var s=this.getCurrentPageQuestions();if(s.indexOf(t)<0)return;for(var i=0;i<s.length;i++)if(s[i].hasInput&&s[i].isEmpty())return;if(this.isLastPage&&(this.autoAdvanceEnabled!==!0||!this.autoAdvanceAllowComplete)||!this.validateActivePage(!1))return;const r=this.currentPage,a=()=>{r===this.currentPage&&(this.isLastPage?this.tryCompleteOrShowPreview():this.nextPage())};Ni.safeTimeOut(a,D.autoAdvanceDelay)}tryCompleteOrShowPreview(){this.showPreviewBeforeComplete?this.showPreview():this.tryComplete()}getComment(e){return this.getValue(e+this.commentSuffix)||""}setComment(e,t,s=!1){if(t||(t=""),this.isTwoValueEquals(t,this.getComment(e)))return;const i=e+this.commentSuffix;t=this.questionOnValueChanging(i,t,e),s=this.getLocNotification(s,t,this.getComment(e)),this.isValueEmpty(t)?this.deleteDataValueCore(this.valuesHash,i):this.setDataValueCore(this.valuesHash,i,t);var r=this.getQuestionsByValueName(e);if(r)for(var a=0;a<r.length;a++)r[a].updateCommentFromSurvey(t),this.validateQuestionOnValueChanged(r[a]);s||this.checkTriggersAndRunConditions(e,this.getValue(e),void 0),s!=="text"&&this.tryGoNextPageAutomatic(e);var o=this.getQuestionByValueName(e);o&&(this.fireOnValueChanged(i,t,o),o.comment=t,o.comment!=t&&(o.comment=t))}clearValue(e){this.setValue(e,null),this.setComment(e,null)}get clearDisabledChoices(){return this.getPropertyValue("clearDisabledChoices",!1)}set clearDisabledChoices(e){this.setPropertyValue("clearDisabledChoices",e)}get clearValueOnDisableItems(){return this.clearDisabledChoices}set clearValueOnDisableItems(e){this.clearDisabledChoices=e}getQuestionClearIfInvisible(e){return this.isShowingPreview||this.runningPages?"none":e!=="default"?e:this.clearInvisibleValues}questionVisibilityChanged(e,t,s){s&&this.updateVisibleIndexes(e.page),t||this.changeCurrentSingleElementOnVisibilityChanged(),this.onQuestionVisibleChanged.fire(this,{question:e,name:e.name,visible:t})}pageVisibilityChanged(e,t){if(this.isLoadingFromJson)return;(t&&!this.currentPage||e===this.currentPage)&&this.updateCurrentPage(),this.updateVisibleIndexes(),t||this.changeCurrentSingleElementOnVisibilityChanged();const s=this.currentSingleElement,i=this.currentPage;s&&i&&s.page!==i&&(this.currentSingleElement=i.getFirstVisibleElement()),this.onPageVisibleChanged.fire(this,{page:e,visible:t})}panelVisibilityChanged(e,t){e.page&&(this.updateVisibleIndexes(e.page),t||this.changeCurrentSingleElementOnVisibilityChanged()),this.onPanelVisibleChanged.fire(this,{panel:e,visible:t})}questionCreated(e){this.onQuestionCreated.fire(this,{question:e})}questionAdded(e,t,s,i){e.name||(e.name=this.generateNewName(this.getAllQuestions(!1,!0),"question")),e.page&&this.questionHashesAdded(e),this.isLoadingFromJson||(this.currentPage||this.updateCurrentPage(),this.updateVisibleIndexes(e.page),this.setCalculatedWidthModeUpdater()),this.canFireAddElement()&&this.onQuestionAdded.fire(this,{question:e,name:e.name,index:t,parent:s,page:i,parentPanel:s,rootPanel:i})}canFireAddElement(){return!this.isMovingQuestion}questionRemoved(e){this.questionHashesRemoved(e,e.name,e.getValueName()),this.updateVisibleIndexes(e.page),this.onQuestionRemoved.fire(this,{question:e,name:e.name}),this.updateLazyRenderingRowsOnRemovingElements()}questionRenamed(e,t,s){this.questionHashesRemoved(e,t,s),this.questionHashesAdded(e)}questionHashesClear(){this.questionHashes.names={},this.questionHashes.namesInsensitive={},this.questionHashes.valueNames={},this.questionHashes.valueNamesInsensitive={}}questionHashesPanelAdded(e){if(!this.isLoadingFromJson)for(var t=e.questions,s=0;s<t.length;s++)this.questionHashesAdded(t[s])}questionHashesAdded(e){this.questionHashAddedCore(this.questionHashes.names,e,e.name),this.questionHashAddedCore(this.questionHashes.namesInsensitive,e,e.name.toLowerCase()),this.questionHashAddedCore(this.questionHashes.valueNames,e,e.getValueName()),this.questionHashAddedCore(this.questionHashes.valueNamesInsensitive,e,e.getValueName().toLowerCase())}questionHashesRemoved(e,t,s){t&&(this.questionHashRemovedCore(this.questionHashes.names,e,t),this.questionHashRemovedCore(this.questionHashes.namesInsensitive,e,t.toLowerCase())),s&&(this.questionHashRemovedCore(this.questionHashes.valueNames,e,s),this.questionHashRemovedCore(this.questionHashes.valueNamesInsensitive,e,s.toLowerCase()))}questionHashAddedCore(e,t,s){var i=e[s];if(i){var i=e[s];i.indexOf(t)<0&&i.push(t)}else e[s]=[t]}questionHashRemovedCore(e,t,s){var i=e[s];if(i){var r=i.indexOf(t);r>-1&&i.splice(r,1),i.length==0&&delete e[s]}}panelAdded(e,t,s,i){e.name||(e.name=this.generateNewName(this.getAllPanels(!1,!0),"panel")),this.questionHashesPanelAdded(e),this.updateVisibleIndexes(e.page),this.canFireAddElement()&&this.onPanelAdded.fire(this,{panel:e,name:e.name,index:t,parent:s,page:i,parentPanel:s,rootPanel:i})}panelRemoved(e){this.updateVisibleIndexes(e.page),this.onPanelRemoved.fire(this,{panel:e,name:e.name}),this.updateLazyRenderingRowsOnRemovingElements()}validateQuestion(e,t,s){if(!this.onValidateQuestion.isEmpty){var i={name:e.name,question:e,value:e.value,errors:t,error:null};this.onValidateQuestion.fire(this,i),i.error&&t.push(new Ps(i.error,this))}s&&this.beforeSettingQuestionErrors(e,t)}validatePanel(e,t,s){if(e.isPanel&&!this.onValidatePanel.isEmpty){const i={name:e.name,panel:e,error:null,errors:t};this.onValidatePanel.fire(this,i),i.error&&t.push(new Ps(i.error,this))}s&&this.makeRequiredErrorsInvisible(t)}processHtml(e,t){t||(t="");var s={html:e,reason:t};return this.onProcessHtml.fire(this,s),this.processText(s.html,!0)}getValueGetterContext(){return new V_(this,this.valuesHash,this.variablesHash)}processText(e,t){return this.processTextEx({text:e,returnDisplayValue:t,doEncoding:!1}).text}processTextEx(e){const t=e.doEncoding===void 0?D.web.encodeUrlParams:e.doEncoding;let s=e.text;(e.runAtDesign||!this.isDesignMode)&&(s=this.textPreProcessor.process(s,e.returnDisplayValue===!0,t,e.replaceUndefinedValues));const i={text:s,hasAllValuesOnLastRun:!0};return i.hasAllValuesOnLastRun=this.textPreProcessor.hasAllValuesOnLastRun,i}get textPreProcessor(){return this.textPreProcessorValue||(this.textPreProcessorValue=new T1,this.textPreProcessorValue.onProcess=e=>{this.getProcessedTextValue(e)}),this.textPreProcessorValue}getSurveyMarkdownHtml(e,t,s,i){const r={element:e,text:t,name:s,item:i,html:null};return this.onTextMarkdown.fire(this,r),r.html}getCorrectedAnswerCount(){return this.getCorrectAnswerCount()}getCorrectAnswerCount(){return this.getCorrectedAnswerCountCore(!0)}getQuizQuestionCount(){for(var e=this.getQuizQuestions(),t=0,s=0;s<e.length;s++)t+=e[s].quizQuestionCount;return t}getInCorrectedAnswerCount(){return this.getIncorrectAnswerCount()}getInCorrectAnswerCount(){return this.getIncorrectAnswerCount()}getIncorrectAnswerCount(){return this.getCorrectedAnswerCountCore(!1)}onCorrectQuestionAnswer(e,t){this.onIsAnswerCorrect.isEmpty||(t.question=e,this.onIsAnswerCorrect.fire(this,t))}getCorrectedAnswerCountCore(e){var t=this.getQuizQuestions(),s=0;for(let i=0;i<t.length;i++){const r=t[i],a=r.correctAnswerCount;e?s+=a:s+=r.quizQuestionCount-a}return s}getCorrectedAnswers(){return this.getCorrectedAnswerCount()}getInCorrectedAnswers(){return this.getInCorrectedAnswerCount()}get showTimerPanel(){return this.showTimer?this.timerLocation:"none"}set showTimerPanel(e){this.showTimer=e!=="none",this.showTimer&&(this.timerLocation=e)}get showTimer(){return this.getPropertyValue("showTimer")}set showTimer(e){this.setPropertyValue("showTimer",e)}get timerLocation(){return this.getPropertyValue("timerLocation")}set timerLocation(e){this.setPropertyValue("timerLocation",e)}get isTimerPanelShowingOnTop(){return this.showTimer&&this.timerLocation==="top"}get isTimerPanelShowingOnBottom(){return this.showTimer&&this.timerLocation==="bottom"}get timerInfoMode(){return this.getTimerInfoVal(this.getPropertyValue("timerInfoMode"))}set timerInfoMode(e){this.setPropertyValue("timerInfoMode",e)}getTimerInfoVal(e){return e==="all"?"combined":e}get showTimerPanelMode(){const e=this.timerInfoMode;return e==="combined"?"all":e}set showTimerPanelMode(e){this.timerInfoMode=this.getTimerInfoVal(e)}updateGridColumns(){this.pages.forEach(e=>e.updateGridColumns())}get widthMode(){return this.getPropertyValue("widthMode")}set widthMode(e){this.setPropertyValue("widthMode",e)}setCalculatedWidthModeUpdater(){this.isLoadingFromJson||(this.calculatedWidthModeUpdater&&this.calculatedWidthModeUpdater.dispose(),this.calculatedWidthModeUpdater=new Ue(()=>this.calculateWidthMode()),this.calculatedWidthMode=this.calculatedWidthModeUpdater)}calculateWidthMode(){if(this.widthMode=="auto"){let e=!1;return this.isSingleVisibleInput||this.pages.forEach(t=>{t.needResponsiveWidth()&&(e=!0)}),e?"responsive":"static"}return this.widthMode}get width(){return this.getPropertyValue("width")}set width(e){this.setPropertyValue("width",e)}get renderedWidth(){const e=this.getPropertyValue("calculatedWidthMode")=="static";let t=this.getPropertyValue("width");if(this.isScaled&&this.responsiveStartWidth>1){let s=this.responsiveStartWidth;try{t=t||this.staticStartWidth,s=isNaN(t)?parseFloat(t.toString().replace("px","")):t}catch{}return(e?s:this.responsiveStartWidth)*this.widthScale/100+"px"}return t&&!isNaN(t)&&(t=t+"px"),e&&t||void 0}setStaticStartWidth(e){this.staticStartWidth=e}setResponsiveStartWidth(e){this.responsiveStartWidth=e}get isScaled(){return Math.abs(this.widthScale-100)>.001}get timerInfo(){return this.getTimerInfo()}get timerClock(){let e,t;if(this.currentPage){let{spent:s,limit:i,minorSpent:r,minorLimit:a}=this.getTimerInfo();i>0?e=this.getDisplayClockTime(i-s):e=this.getDisplayClockTime(s),r!==void 0&&(a>0?t=this.getDisplayClockTime(a-r):t=this.getDisplayClockTime(r))}return{majorText:e,minorText:t}}get timerInfoText(){const e={text:this.getTimerInfoText()};this.onTimerPanelInfoText.fire(this,e);var t=new wt(this,!0);return t.text=e.text,t.textOrHtml}getTimerInfo(){let e=this.currentPage;if(!e)return{spent:0,limit:0};let t=e.timeSpent,s=this.timeSpent,i=e.getMaxTimeToFinish(),r=this.timeLimit;return this.timerInfoMode=="page"?{spent:t,limit:i}:this.timerInfoMode=="survey"?{spent:s,limit:r}:i>0&&r>0?{spent:t,limit:i,minorSpent:s,minorLimit:r}:i>0?{spent:t,limit:i,minorSpent:s}:r>0?{spent:s,limit:r,minorSpent:t}:{spent:t,minorSpent:s}}getTimerInfoText(){var e=this.currentPage;if(!e)return"";var t=this.getDisplayTime(e.timeSpent),s=this.getDisplayTime(this.timeSpent),i=e.getMaxTimeToFinish(),r=this.getDisplayTime(i),a=this.getDisplayTime(this.timeLimit);if(this.timerInfoMode=="page")return this.getTimerInfoPageText(e,t,r);if(this.timerInfoMode=="survey")return this.getTimerInfoSurveyText(s,a);if(this.timerInfoMode=="combined"){if(i<=0&&this.timeLimit<=0)return this.getLocalizationFormatString("timerSpentAll",t,s);if(i>0&&this.timeLimit>0)return this.getLocalizationFormatString("timerLimitAll",t,r,s,a);let o=this.getTimerInfoPageText(e,t,r),l=this.getTimerInfoSurveyText(s,a);return o+" "+l}return""}getTimerInfoPageText(e,t,s){return e&&e.getMaxTimeToFinish()>0?this.getLocalizationFormatString("timerLimitPage",t,s):this.getLocalizationFormatString("timerSpentPage",t,s)}getTimerInfoSurveyText(e,t){const s=this.timeLimit>0?"timerLimitSurvey":"timerSpentSurvey";return this.getLocalizationFormatString(s,e,t)}getDisplayClockTime(e){e<0&&(e=0);const t=Math.floor(e/60),s=e%60;let i=s.toString();return s<10&&(i="0"+i),`${t}:${i}`}getDisplayTime(e){const t=Math.floor(e/60),s=e%60;let i="";return t>0&&(i+=t+" "+this.getLocalizationString("timerMin")),i&&s==0?i:(i&&(i+=" "),i+s+" "+this.getLocalizationString("timerSec"))}get timerModel(){return this.timerModelValue}startTimer(){this.isEditMode&&this.timerModel.start()}startTimerFromUI(){this.showTimer&&this.state==="running"&&this.startTimer()}stopTimer(){this.timerModel.stop()}get timeSpent(){return this.timerModel.spent}set timeSpent(e){this.timerModel.spent=e}get timeLimit(){return this.getPropertyValue("timeLimit",0)}set timeLimit(e){this.setPropertyValue("timeLimit",e)}get maxTimeToFinish(){return this.timeLimit}set maxTimeToFinish(e){this.timeLimit=e}get timeLimitPerPage(){return this.getPropertyValue("timeLimitPerPage",0)}set timeLimitPerPage(e){this.setPropertyValue("timeLimitPerPage",e)}get maxTimeToFinishPage(){return this.timeLimitPerPage}set maxTimeToFinishPage(e){this.timeLimitPerPage=e}doTimer(e){if(this.onTimerTick.fire(this,{}),this.timeLimit>0&&this.timeLimit<=this.timeSpent&&(this.timeSpent=this.timeLimit,this.tryComplete()),e){var t=e.getMaxTimeToFinish();t>0&&t==e.timeSpent&&(this.isLastPage?this.tryComplete():this.nextPage())}}get inSurvey(){return!0}getSurveyData(){return this}getSurvey(){return this}getTextProcessor(){return this}getObjects(e,t){var s=[];return Array.prototype.push.apply(s,this.getPagesByNames(e)),Array.prototype.push.apply(s,this.getQuestionsByNames(t)),s}setTriggerValue(e,t,s){if(e)if(s)this.setVariable(e,t);else{this.startSetValueFromTrigger();const i=new Di().getValueInfo({name:e,context:this.getValueGetterContext(),createObjects:!0});i.isFound&&i.question?i.question.value=t:e.indexOf(".")<0&&this.setValue(e,t),this.finishSetValueFromTrigger()}}copyTriggerValue(e,t,s){if(!e||!t)return;const i=new Di().getValueInfo({name:t,context:this.getValueGetterContext(),createObjects:!0,isText:s,isDisplayValue:s});i.isFound&&this.setTriggerValue(e,L.getUnbindValue(i.value),!1)}triggerExecuted(e){this.onTriggerExecuted.fire(this,{trigger:e})}get isSettingValueFromTrigger(){return this.setValueFromTriggerCounter>0}startSetValueFromTrigger(){this.setValueFromTriggerCounter++}finishSetValueFromTrigger(){this.setValueFromTriggerCounter--}startMovingQuestion(){this.isMovingQuestion=!0}stopMovingQuestion(){this.isMovingQuestion=!1}get isQuestionDragging(){return this.isMovingQuestion}startMovingPage(){this.isMovingPage=!0}stopMovingPage(){this.isMovingPage=!1}focusQuestion(e){return this.focusQuestionByInstance(this.getQuestionByName(e,!0))}focusQuestionByInstance(e,t=!1){var s;if(!e||!e.isVisible||!e.page||((s=this.focusingQuestionInfo)===null||s===void 0?void 0:s.question)===e)return!1;this.focusingQuestionInfo={question:e,onError:t};const r=this.currentSingleElement;this.skippedPages.push({from:r||this.currentPage,to:r?e:e.page});const a=this.activePage!==e.page&&!e.page.isStartPage;return a&&(this.currentPage=e.page),this.isSingleVisibleQuestion&&!this.isDesignMode&&(this.currentSingleElement=e),a||this.focusQuestionInfo(),!0}focusQuestionInfo(){var e;const t=(e=this.focusingQuestionInfo)===null||e===void 0?void 0:e.question;t&&!t.isDisposed&&t.focus(this.focusingQuestionInfo.onError),this.focusingQuestionInfo=void 0}questionEditFinishCallback(e,t){const s=this.enterKeyAction||D.enterKeyAction;if(s=="loseFocus"&&t.target.blur(),s=="moveToNextEditor"){const i=this.currentPage.questions,r=i.indexOf(e);r>-1&&r<i.length-1?i[r+1].focus():t.target.blur()}}elementWrapperComponentNameCore(e,t,s,i,r){if(this.onElementWrapperComponentName.isEmpty)return e;const a={componentName:e,element:t,wrapperName:s,reason:i,item:r};return this.onElementWrapperComponentName.fire(this,a),a.componentName}elementWrapperDataCore(e,t,s,i,r){if(this.onElementWrapperComponentData.isEmpty)return e;const a={data:e,element:t,wrapperName:s,reason:i,item:r};return this.onElementWrapperComponentData.fire(this,a),a.data}getElementWrapperComponentName(e,t){const s=t==="logo-image"?"sv-logo-image":Ie.TemplateRendererComponentName;return this.elementWrapperComponentNameCore(s,e,"component",t)}getQuestionContentWrapperComponentName(e){return this.elementWrapperComponentNameCore(Ie.TemplateRendererComponentName,e,"content-component")}getRowWrapperComponentName(e){return this.elementWrapperComponentNameCore(Ie.TemplateRendererComponentName,e,"row")}getItemValueWrapperComponentName(e,t){return this.elementWrapperComponentNameCore(Ie.TemplateRendererComponentName,t,"itemvalue",void 0,e)}getElementWrapperComponentData(e,t){return this.elementWrapperDataCore(e,e,"component",t)}getRowWrapperComponentData(e){return this.elementWrapperDataCore(e,e,"row")}getItemValueWrapperComponentData(e,t){return this.elementWrapperDataCore(e,t,"itemvalue",void 0,e)}getMatrixCellTemplateData(e){const t=e.question;return this.elementWrapperDataCore(t,t,"cell")}searchText(e){e&&(e=e.toLowerCase());for(var t=[],s=0;s<this.pages.length;s++)this.pages[s].searchText(e,t);return t}getSkeletonComponentName(e){return this.skeletonComponentName}addLayoutElement(e){const t=this.removeLayoutElement(e.id);return this.layoutElements.push(e),t}findLayoutElement(e){return this.layoutElements.filter(s=>s.id===e)[0]}removeLayoutElement(e){const t=this.findLayoutElement(e);if(t){const s=this.layoutElements.indexOf(t);this.layoutElements.splice(s,1)}return t}getContainerContent(e){const t=new Array;for(let s of this.layoutElements)if(this.mode!=="display"&&mi(s.id,"timerpanel"))e==="header"&&this.isTimerPanelShowingOnTop&&!this.isStartPageActive&&t.push(s),e==="footer"&&this.isTimerPanelShowingOnBottom&&!this.isStartPageActive&&t.push(s);else if(this.state==="running"&&mi(s.id,this.progressBarComponentName)){if(this.questionsOnPageMode!="singlePage"||this.progressBarType=="questions"){const i=this.findLayoutElement("advanced-header"),r=i&&i.data;let a=!r||r.hasBackground;mi(this.progressBarLocation,"aboveHeader")&&(a=!1),mi(this.progressBarLocation,"belowHeader")&&(a=!0),this.showTOC&&!(r&&r.hasBackground)&&this.isShowProgressBarOnTop&&!this.isStartPageActive?e==="center"&&(a?delete s.index:s.index=-150,t.push(s)):(e==="header"&&!a&&(s.index=-150,this.isShowProgressBarOnTop&&!this.isStartPageActive&&t.push(s)),e==="center"&&a&&(s.index&&delete s.index,this.isShowProgressBarOnTop&&!this.isStartPageActive&&t.push(s))),e==="footer"&&this.isShowProgressBarOnBottom&&!this.isStartPageActive&&t.push(s)}}else if(mi(s.id,"buttons-navigation-top"))e==="contentTop"&&this.isNavigationButtonsShowingOnTop&&t.push(s);else if(mi(s.id,"buttons-navigation"))e==="contentBottom"&&this.isNavigationButtonsShowingOnBottom&&t.push(s);else if(this.state==="running"&&mi(s.id,"toc-navigation")&&this.showTOC)e==="left"&&["left","both"].indexOf(this.tocLocation)!==-1&&t.push(s),e==="right"&&["right","both"].indexOf(this.tocLocation)!==-1&&t.push(s);else if(mi(s.id,"advanced-header")){if(this.state==="running"||this.state==="starting"||this.showHeaderOnCompletePage===!0&&this.state==="completed"){const i=s&&s.data;this.showTOC&&!(i&&i.hasBackground)?e==="contentTop"&&t.push(s):s.container===e&&t.push(s)}}else(Array.isArray(s.container)&&s.container.indexOf(e)!==-1||s.container===e)&&t.push(s);return t.sort((s,i)=>(s.index||0)-(i.index||0)),t.forEach(s=>{s.getData&&(s.data=s.getData())}),t}processPopupVisiblityChanged(e,t,s){this.onPopupVisibleChanged.fire(this,{question:e,popup:t,visible:s})}processOpenDropdownMenu(e,t){const s=Object.assign({question:e},t);this.onOpenDropdownMenu.fire(this,s),t.menuType=s.menuType}getCssTitleExpandableSvg(){return null}createCustomChoiceItem(e){this.onCreateCustomChoiceItem.fire(this,e)}applyTheme(e){if(e){if(Object.keys(e).forEach(t=>{t!=="header"&&(t==="isPanelless"?this.isCompact=e[t]:this[t]=e[t])}),"header"in e&&!e.headerView&&(this.headerView="advanced"),this.headerView!=="basic"){this.removeLayoutElement("advanced-header");const t=new Ze;t.fromTheme(e),this.insertAdvancedHeader(t)}this.themeChanged(e)}}themeChanged(e){this.getAllQuestions().forEach(t=>t.themeChanged(e))}waitAndExecute(e){this.taskManager.waitAndExecute(e)}dispose(){if(this.unConnectEditingObj(),this.removeScrollEventListener(),this.destroyResizeObserver(),this.rootElement=void 0,this.layoutElements){for(var e=0;e<this.layoutElements.length;e++)this.layoutElements[e].data&&this.layoutElements[e].data!==this&&this.layoutElements[e].data.dispose&&this.layoutElements[e].data.dispose();this.layoutElements.splice(0,this.layoutElements.length)}if(super.dispose(),this.editingObj=null,!!this.pages){this.currentPage=null;for(var e=0;e<this.pages.length;e++)this.pages[e].setSurveyImpl(void 0),this.pages[e].dispose();this.pages.splice(0,this.pages.length),this.disposeCallback&&this.disposeCallback()}}_isElementShouldBeSticky(e){var t;if(!e)return!1;const s=(t=this.scrollerElement)===null||t===void 0?void 0:t.querySelector(e);return s?!!this.scrollerElement&&this.scrollerElement.scrollTop>0&&s.getBoundingClientRect().y<=this.scrollerElement.getBoundingClientRect().y:!1}get rootScrollDisabled(){return!(this.fitToContainer&&this.formScrollDisabled)}get formScrollDisabled(){return!this.backgroundImage||this.backgroundImageAttachment!=="fixed"}onScroll(){this.rootElement&&(this._isElementShouldBeSticky(".sv-components-container-center")?this.rootElement.classList&&this.rootElement.classList.add("sv-root--sticky-top"):this.rootElement.classList&&this.rootElement.classList.remove("sv-root--sticky-top"),this.tocModel&&this.tocModel.updateStickyTOCSize(this.rootElement)),this.onScrollCallback&&this.onScrollCallback()}addScrollEventListener(){this.scrollHandler=()=>{this.onScroll()},this.rootElement.addEventListener("scroll",this.scrollHandler),this.rootElement.getElementsByTagName("form")[0]&&this.rootElement.getElementsByTagName("form")[0].addEventListener("scroll",this.scrollHandler),this.scrollerElement&&this.scrollerElement.addEventListener("scroll",this.scrollHandler)}removeScrollEventListener(){this.rootElement&&this.scrollHandler&&(this.rootElement.removeEventListener("scroll",this.scrollHandler),this.rootElement.getElementsByTagName("form")[0]&&this.rootElement.getElementsByTagName("form")[0].removeEventListener("scroll",this.scrollHandler),this.scrollerElement&&this.scrollerElement.removeEventListener("scroll",this.scrollHandler))}}Ie.TemplateRendererComponentName="sv-template-renderer",Ie.platform="unknown",I([R()],Ie.prototype,"completedCss",void 0),I([R()],Ie.prototype,"completedBeforeCss",void 0),I([R()],Ie.prototype,"loadingBodyCss",void 0),I([R()],Ie.prototype,"containerCss",void 0),I([R({onSet:(n,e)=>{e.updateCss()}})],Ie.prototype,"fitToContainer",void 0),I([R({onSet:(n,e)=>{if(n==="basic")e.removeLayoutElement("advanced-header");else if(!e.findLayoutElement("advanced-header")){const s=new Ze;e.insertAdvancedHeader(s)}}})],Ie.prototype,"headerView",void 0),I([R()],Ie.prototype,"showBrandInfo",void 0),I([R()],Ie.prototype,"enterKeyAction",void 0),I([R()],Ie.prototype,"lazyRenderFirstBatchSizeValue",void 0),I([R({defaultValue:{}})],Ie.prototype,"cssVariables",void 0),I([R()],Ie.prototype,"_isMobile",void 0),I([R()],Ie.prototype,"_isCompact",void 0),I([R({onSet:(n,e)=>{e.updateCss()}})],Ie.prototype,"backgroundImage",void 0),I([R()],Ie.prototype,"backgroundImageFit",void 0),I([R({onSet:(n,e)=>{e.updateCss()}})],Ie.prototype,"backgroundImageAttachment",void 0),I([R()],Ie.prototype,"wrapperFormCss",void 0),I([R({getDefaultValue:n=>n.progressBarType==="buttons"})],Ie.prototype,"progressBarShowPageTitles",void 0),I([R()],Ie.prototype,"progressBarShowPageNumbers",void 0),I([R()],Ie.prototype,"progressBarInheritWidthFrom",void 0),I([R({defaultValue:!0})],Ie.prototype,"validationEnabled",void 0),I([R()],Ie.prototype,"rootCss",void 0),I([R({onSet:(n,e)=>{e.updateGridColumns()}})],Ie.prototype,"gridLayoutEnabled",void 0),I([R()],Ie.prototype,"calculatedWidthMode",void 0),I([R({defaultValue:100,onSet(n,e,t){e.pages.forEach(s=>s.updateRootStyle())}})],Ie.prototype,"widthScale",void 0),I([R()],Ie.prototype,"staticStartWidth",void 0),I([R()],Ie.prototype,"responsiveStartWidth",void 0),I([Ft()],Ie.prototype,"layoutElements",void 0);function mi(n,e){return!n||!e?!1:n.toUpperCase()===e.toUpperCase()}B.addClass("survey",[{name:"locale",choices:()=>os.getLocales(!0),onGetValue:n=>n.locale==os.defaultLocale?null:n.locale},{name:"title",serializationProperty:"locTitle",dependsOn:"locale"},{name:"description:text",serializationProperty:"locDescription",dependsOn:"locale"},{name:"logo:file",serializationProperty:"locLogo"},{name:"logoWidth",default:"auto",minValue:0},{name:"logoHeight",default:"40px",minValue:0},{name:"logoFit",default:"contain",choices:["none","contain","cover","fill"]},{name:"logoPosition",default:"left",choices:["none","left","right","top","bottom"]},{name:"autoFocusFirstQuestion:boolean",alternativeName:"focusFirstQuestionAutomatic"},{name:"autoFocusFirstError:boolean",default:!0,alternativeName:"focusOnFirstError"},{name:"completedHtml:html",serializationProperty:"locCompletedHtml"},{name:"completedBeforeHtml:html",serializationProperty:"locCompletedBeforeHtml"},{name:"completedHtmlOnCondition:htmlconditions",className:"htmlconditionitem",isArray:!0},{name:"loadingHtml:html",serializationProperty:"locLoadingHtml"},{name:"pages:surveypages",className:"page",isArray:!0,onSerializeValue:n=>n.originalPages||n.pages},{name:"elements",alternativeName:"questions",baseClassName:"question",visible:!1,isLightSerializable:!1,onGetValue:function(n){return null},onSetValue:function(n,e,t){n.pages.splice(0,n.pages.length);var s=n.addNewPage("");t.toObject({questions:e},s,t?.options)}},{name:"triggers:triggers",baseClassName:"surveytrigger",classNamePart:"trigger"},{name:"calculatedValues:calculatedvalues",className:"calculatedvalue",isArray:!0},{name:"sjsVersion",visible:!1},{name:"surveyId",visible:!1},{name:"surveyPostId",visible:!1},{name:"surveyShowDataSaving:boolean",visible:!1},"cookieName",{name:"partialSendEnabled:boolean",alternativeName:"sendResultOnPageNext"},{name:"showNavigationButtons:boolean",default:!0},{name:"navigationButtonsLocation",default:"bottom",choices:["top","bottom","topBottom"]},{name:"showPrevButton:boolean",default:!0,visibleIf:n=>n.showNavigationButtons!=="none"},{name:"showTitle:boolean",default:!0},{name:"showPageTitles:boolean",default:!0},{name:"showCompletePage:boolean",default:!0,alternativeName:"showCompletedPage"},"navigateToUrl",{name:"navigateToUrlOnCondition:urlconditions",className:"urlconditionitem",isArray:!0},{name:"questionOrder",alternativeName:"questionsOrder",default:"initial",choices:["initial","random"]},{name:"matrixDragHandleArea",visible:!1,default:"entireItem",choices:["entireItem","icon"]},"showPageNumbers:boolean",{name:"showQuestionNumbers",default:"off",choices:["on","onPage","recursive","off"]},{name:"questionTitleLocation",default:"top",choices:["top","bottom","left"]},{name:"questionDescriptionLocation",default:"underTitle",choices:["underInput","underTitle"]},{name:"questionErrorLocation",default:"top",choices:["top","bottom"]},{name:"showProgressBar:boolean",default:!1,onSetValue:(n,e,t)=>{n&&n.setShowProgressBar(e)}},{name:"progressBarLocation",default:"auto",choices:["auto","aboveheader","belowheader","bottom","topbottom"],visibleIf:n=>n.showProgressBar},{name:"progressBarType",default:"pages",choices:["pages","questions","requiredQuestions","correctQuestions"],visibleIf:n=>n.showProgressBar},{name:"progressBarShowPageTitles:switch",category:"navigation",visibleIf:n=>n.showProgressBar&&n.progressBarType==="pages"},{name:"progressBarShowPageNumbers:switch",default:!1,category:"navigation",visibleIf:n=>n.showProgressBar&&n.progressBarType==="pages"},{name:"progressBarInheritWidthFrom",default:"container",choices:["container","survey"],category:"navigation",visibleIf:n=>n.showProgressBar&&n.progressBarType==="pages"},{name:"showTOC:switch",default:!1},{name:"tocLocation",default:"left",choices:["left","right"],dependsOn:["showTOC"],visibleIf:n=>!!n&&n.showTOC},{name:"readOnly:boolean"},{name:"mode",visible:!1,isSerializable:!1},{name:"storeOthersAsComment:boolean",default:!0},{name:"maxTextLength:number",default:0,minValue:0},{name:"maxCommentLength:number",default:0,minValue:0,alternativeName:"maxOthersLength"},{name:"autoAdvanceEnabled:boolean",alternativeName:"goNextPageAutomatic",onSetValue:function(n,e){e!=="autogonext"&&(e=L.isTwoValueEquals(e,!0)),e==="autogonext"&&(e=!0),n.setPropertyValue("autoAdvanceEnabled",e)}},{name:"autoAdvanceAllowComplete:boolean",default:!0,alternativeName:"allowCompleteSurveyAutomatic",visibleIf:n=>n.autoAdvanceEnabled===!0},{name:"clearInvisibleValues",default:"onComplete",choices:["none","onComplete","onHidden","onHiddenContainer"]},{name:"checkErrorsMode",default:"onNextPage",choices:["onNextPage","onValueChanged","onComplete"]},{name:"validateVisitedEmptyFields:boolean",dependsOn:"checkErrorsMode",visibleIf:n=>n.checkErrorsMode==="onValueChanged"},{name:"textUpdateMode",default:"onBlur",choices:["onBlur","onTyping"]},{name:"autoGrowComment:boolean",default:!1},{name:"allowResizeComment:boolean",default:!0},{name:"commentAreaRows:number",minValue:1},{name:"startSurveyText",serializationProperty:"locStartSurveyText",visibleIf:n=>n.firstPageIsStartPage},{name:"pagePrevText",serializationProperty:"locPagePrevText",visibleIf:n=>n.showNavigationButtons!=="none"&&n.showPrevButton},{name:"pageNextText",serializationProperty:"locPageNextText",visibleIf:n=>n.showNavigationButtons!=="none"},{name:"completeText",serializationProperty:"locCompleteText",visibleIf:n=>n.showNavigationButtons!=="none"},{name:"previewText",serializationProperty:"locPreviewText",visibleIf:n=>n.showPreviewBeforeComplete},{name:"editText",serializationProperty:"locEditText",visibleIf:n=>n.showPreviewBeforeComplete},{name:"requiredMark",default:"*",alternativeName:"requiredText"},{name:"questionStartIndex",dependsOn:["showQuestionNumbers"],visibleIf:n=>!n||n.showQuestionNumbers!=="off"},{name:"questionTitlePattern",default:"numTitleRequire",dependsOn:["questionStartIndex","requiredMark"],choices:n=>n?n.getQuestionTitlePatternOptions():[]},{name:"questionTitleTemplate",visible:!1,isSerializable:!1,serializationProperty:"locQuestionTitleTemplate"},{name:"firstPageIsStartPage:boolean",default:!1,alternativeName:"firstPageIsStarted"},{name:"isSinglePage:boolean",default:!1,visible:!1,isSerializable:!1},{name:"questionsOnPageMode",default:"standard",choices:["standard","singlePage","questionPerPage","inputPerPage"]},{name:"showPreviewBeforeComplete:boolean",default:!1,onSetValue:(n,e,t)=>{n&&n.setShowPreviewBeforeComplete(e)}},{name:"previewMode",default:"allQuestions",choices:["allQuestions","answeredQuestions"],visibleIf:n=>n.showPreviewBeforeComplete},{name:"showTimer:boolean"},{name:"timeLimit:number",alternativeName:"maxTimeToFinish",default:0,minValue:0,enableIf:n=>n.showTimer},{name:"timeLimitPerPage:number",alternativeName:"maxTimeToFinishPage",default:0,minValue:0,enableIf:n=>n.showTimer},{name:"timerLocation",default:"top",choices:["top","bottom"],enableIf:n=>n.showTimer},{name:"timerInfoMode",alternativeName:"showTimerPanelMode",default:"combined",choices:["page","survey","combined"],enableIf:n=>n.showTimer},{name:"showTimerPanel",visible:!1,isSerializable:!1},{name:"widthMode",default:"auto",choices:["auto","static","responsive"]},{name:"gridLayoutEnabled:boolean",default:!1},{name:"width",visibleIf:n=>n.widthMode==="static"},{name:"fitToContainer:boolean",default:!0,visible:!1},{name:"headerView",default:"basic",choices:["basic","advanced"],visible:!1},{name:"backgroundImage:file",visible:!1},{name:"backgroundImageFit",default:"cover",choices:["auto","contain","cover"],visible:!1},{name:"backgroundImageAttachment",default:"scroll",choices:["scroll","fixed"],visible:!1},{name:"backgroundOpacity:number",minValue:0,maxValue:1,default:1,visible:!1},{name:"showBrandInfo:boolean",default:!1,visible:!1}]);class hl extends fe{getBaseType(){return"choiceitem"}get choiceOwner(){return this.locOwner}get showCommentArea(){return this.getPropertyValue("showCommentArea")}get supportElements(){var e;return((e=this.choiceOwner)===null||e===void 0?void 0:e.supportElementsInChoice())===!0}set showCommentArea(e){e&&!this.supportComment&&(e=!1),this.setPropertyValue("showCommentArea",e)}get isCommentRequired(){return this.getPropertyValue("isCommentRequired")}set isCommentRequired(e){this.setPropertyValue("isCommentRequired",e)}get isCommentShowing(){return this.getPropertyValue("isCommentShowing",!1)}get locCommentPlaceholder(){return this.locCommentPlaceholderValue||this.createCommentPlaceholder(),this.locCommentPlaceholderValue}createCommentPlaceholder(){const e=new wt(this,!0,"commentPlaceholder");e.onChanged=()=>{this.setPropertyValue("commentPlaceholder",this.locCommentPlaceholderValue.text)},this.locCommentPlaceholderValue=e}get commentPlaceholder(){return this.locCommentPlaceholder.text}set commentPlaceholder(e){this.locCommentPlaceholder.text=e}setIsCommentShowing(e){this.setPropertyValue("isCommentShowing",e)}get supportComment(){const e=this.locOwner;return!e||!e.supportMultipleComment?!1:e.supportMultipleComment(this)}canAddPpropertyToJSON(e){return e.name==="commentPlaceholder"?!!this.locCommentPlaceholderValue:super.canAddPpropertyToJSON(e)}onLocOwnerChanged(){this.showCommentArea&&!this.supportComment&&(this.showCommentArea=!1),this.setPanelSurvey(this.panelValue)}get onExpandPanelAtDesign(){return this.onExpandPanelAtDesignValue||(this.onExpandPanelAtDesignValue=new Xt),this.onExpandPanelAtDesignValue}get isPanelShowing(){return!this.panelValue||!this.choiceOwner?!1:this.hasElements&&this.choiceOwner.isItemSelected(this)===!0}get hasElements(){const e=this.panelValue;return!!e&&e.elements.length>0}get panel(){return this.panelValue||(this.panelValue=this.createPanel()),this.panelValue}get isPanelCreated(){return!!this.panelValue}get elements(){return this.panel.elements}panelFirstRendering(){this.hasElements&&this.isPanelShowing&&this.panel.onFirstRendering()}createPanel(){const e=B.createClass("panel");return e.renderWidth="100%",e.isInteractiveDesignElement=!1,e.showTitle=!1,e.isInternalNested=!0,e.choiceItem=this,this.setPanelSurvey(e),e}setPanelSurvey(e){var t;if(e&&!e.survey){e.selectedElementInDesign=this.choiceOwner;const s=(t=this.choiceOwner)===null||t===void 0?void 0:t.getSurvey();s&&(e.name="choicePanel"+e.uniqueId,e.parent=this.choiceOwner.parent,e.setSurveyImpl(s))}}dispose(){var e;super.dispose(),(e=this.panelValue)===null||e===void 0||e.dispose(),this.panelValue=void 0}}class Nd extends kt{get waitingChoicesByURL(){return!this.isChoicesLoaded&&this.hasChoicesUrl}get selectedItemValues(){return this.getPropertyValue("selectedItemValues")}set selectedItemValues(e){this.setPropertyValue("selectedItemValues",e)}constructor(e){super(e),this.isRunningChoices=!1,this.isFirstLoadChoicesFromUrl=!0,this.isUpdatingChoicesDependedQuestions=!1,this._renderedChoices=[],this.renderedChoicesAnimation=new Xi(this.getRenderedChoicesAnimationOptions(),s=>{this._renderedChoices=s,this.renderedChoicesChangedCallback&&this.renderedChoicesChangedCallback()},()=>this._renderedChoices),this.headItemsCount=0,this.footItemsCount=0,this.otherItemValue=this.createItemValue("other"),this.otherItem.showCommentArea=!0,this.otherItem.isCommentRequired=!0,this.noneItemValue=this.createNoneItem(D.noneItemValue,"noneText","noneItemText"),this.refuseItemValue=this.createNoneItem(D.refuseItemValue,"refuseText","refuseItemText"),this.dontKnowItemValue=this.createNoneItem(D.dontKnowItemValue,"dontKnowText","dontKnowItemText"),this.createItemValues("choices"),this.registerPropertyChangedHandlers(["choices"],()=>{this.filterItems()||this.onVisibleChoicesChanged()}),this.createItemValues("customChoices"),this.registerPropertyChangedHandlers(["customChoices"],()=>{this.onVisibleChoicesChanged()}),this.registerPropertyChangedHandlers(["choicesFromQuestion","choicesFromQuestionMode","choiceValuesFromQuestion","choiceTextsFromQuestion","showNoneItem","showRefuseItem","showDontKnowItem","isUsingRestful","isMessagePanelVisible"],()=>{this.onVisibleChoicesChanged()}),this.registerPropertyChangedHandlers(["hideIfChoicesEmpty"],()=>{this.onVisibleChanged()}),this.registerPropertyChangedHandlers(["selecteditemValues"],s=>{this.onSelectedItemValuesChangedHandler(s)}),this.createNewArray("visibleChoices",()=>this.updateRenderedChoices(),()=>this.updateRenderedChoices()),this.setNewRestfulProperty();const t=this.createLocalizableString("otherText",this.otherItemValue,!0,"otherItemText");this.createLocalizableString("otherErrorText",this,!0,"otherRequiredError"),this.createLocString({name:"otherPlaceholder",hasTranslation:!0}),this.otherItemValue.setLocText(t),this.choicesByUrl.createItemValue=s=>this.createItemValue(s),this.choicesByUrl.beforeSendRequestCallback=()=>{this.onBeforeSendRequest()},this.choicesByUrl.getResultCallback=s=>{this.onLoadChoicesFromUrl(s)},this.choicesByUrl.updateResultCallback=(s,i)=>this.survey?this.survey.updateChoicesFromServer(this,s,i):s}getType(){return"selectbase"}dispose(){super.dispose();const e=this.getQuestionWithChoices();e&&e.removeDependedQuestion(this);const t=this.commentAreaModelValues;t&&Object.keys(t).forEach(s=>{t[s].dispose()}),this.doForPanels(void 0,s=>s.dispose())}supportElementsInChoice(){return!1}getPanels(){if(!this.supportElementsInChoice())return super.getPanels();const e=new Array;return this.choices.forEach(t=>{t.isPanelCreated&&e.push(t.panel)}),e}getVisiblePanels(e){if(!this.supportElementsInChoice())return null;const t=new Array;return this.choices.forEach(s=>{s.isPanelCreated&&s.isPanelShowing===e&&t.push(s.panel)}),t}doForPanels(e,t){const s=e!==void 0?this.getVisiblePanels(e):this.getPanels();Array.isArray(s)&&s.forEach(t)}collectNestedQuestionsCore(e,t,s,i){e.push(this),s&&this.supportElementsInChoice()&&this.choices.forEach(r=>{r.hasElements&&(!t||r.isPanelShowing)&&r.panel.questions.forEach(a=>a.addNestedQuestion(e,t,s,i))})}getElementsInDesign(e=!1){if(!this.supportElementsInChoice())return[];const t=new Array;return this.choices.forEach(s=>{s.hasElements&&(e?t.push(s.panel):t.push(...s.elements))}),t}get otherTextAreaModel(){return this.getCommentTextAreaModel(this.otherItem)}getCommentTextAreaModel(e){const t=e?.value;if(t===void 0)return null;this.commentAreaModelValues||(this.commentAreaModelValues={});const s=this.commentAreaModelValues;return s[t]||(s[t]=new Rd(this.getOtherTextAreaOptions(e))),s[t]}getOtherTextAreaOptions(e){return{question:this,id:()=>this.getItemCommentId(e),propertyNames:[this.getCommentPropertyValue(e)],className:()=>this.cssClasses.comment,placeholder:()=>this.getCommentPlaceholder(e),isDisabledAttr:()=>this.isInputReadOnly||!1,rows:()=>this.commentAreaRows,maxLength:()=>this.getOthersMaxLength(),autoGrow:()=>this.survey&&this.survey.autoGrowComment,ariaRequired:()=>this.ariaRequired||this.a11y_input_ariaRequired,ariaLabel:()=>this.ariaLabel||this.a11y_input_ariaLabel,getTextValue:()=>this.getCommentValueCore(e),onTextAreaChange:s=>{this.onOtherValueChange(e,s)},onTextAreaInput:s=>{this.onOtherValueInput(e,s)}}}getCommentPlaceholder(e){if(e.commentPlaceholder)return e.commentPlaceholder;if(this.isOtherItemByValue(e))return this.otherPlaceholder;const t=this.commentPlaceholder;return new nl(e).processText(t,!0)}resetDependedQuestion(){this.choicesFromQuestion=""}get otherId(){return this.getItemCommentId(this.otherItem)}getItemCommentId(e){return this.id+"_"+e.uniqueId}getCommentElementsId(){return[this.commentId,this.otherId]}getItemValueType(){return"choiceitem"}createItemValue(e,t){const s=B.createClass(this.getItemValueType(),{value:e});return s.locOwner=this,t&&(s.text=t),s}validateElementCore(e){e.isOnValueChanged!==!0&&this.clearIncorrectValues();let t=!0;return this.doForPanels(!0,s=>{t&&(t=s.validateElement(e))}),super.validateElementCore(e)&&t}get isUsingCarryForward(){return!!this.carryForwardQuestionType}get carryForwardQuestionType(){return this.getPropertyValue("carryForwardQuestionType")}setCarryForwardQuestionType(e,t){const s=e?"select":t?"array":void 0;this.setPropertyValue("carryForwardQuestionType",s)}get isUsingRestful(){return this.getPropertyValueWithoutDefault("isUsingRestful")||!1}updateIsUsingRestful(){this.setPropertyValueDirectly("isUsingRestful",this.hasChoicesUrl)}supportGoNextPageError(){return!this.isOtherSelected||!!this.otherValue}isLayoutTypeSupported(e){return!0}localeChanged(){super.localeChanged(),this.choicesOrder!=="none"&&(this.updateVisibleChoices(),this.onVisibleChoicesChanged())}locStrsChanged(){super.locStrsChanged(),this.choicesFromUrl&&(fe.locStrsChanged(this.choicesFromUrl),fe.locStrsChanged(this.visibleChoices)),this.isUsingCarryForward&&fe.locStrsChanged(this.visibleChoices)}updatePrevOtherErrorValue(e){const t=this.otherValue;e!==t&&(this.prevOtherErrorValue=t)}get otherValue(){return this.getStoreOthersAsComment()?this.getQuestionComment():this.otherValueCore}trimCommentValue(e){if(!(e===""||e&&e.toString().trim()===""))return e}set otherValue(e){e=this.trimCommentValue(e),!this.isSettingComment&&this.otherValue!==e&&(this.onUpdateCommentOnAutoOtherMode(e),this.updatePrevOtherErrorValue(e),this.isSettingComment=!0,this.getStoreOthersAsComment()?this.setNewComment(e):(this.otherValueCore=e,this.isOtherSelected&&!this.isRenderedValueSetting&&(this.value=this.getValueOnSettingOther(e))),this.isSettingComment=!1,this.updateChoicesDependedQuestions())}get otherValueCore(){return this.getPropertyValue("otherValue")}set otherValueCore(e){this.setPropertyValue("otherValue",e)}get otherItem(){return this.otherItemValue}get isOtherSelected(){return this.showOtherItem&&this.getHasOther(this.renderedValue)}get isNoneSelected(){return this.showNoneItem&&this.getIsItemValue(this.renderedValue,this.noneItem)}supportMultipleComment(e){return!0}isCommentShowing(e){return e&&e.showCommentArea&&this.isItemSelected(e)}getCommentValue(e){return this.isCommentShowing(e)&&this.getCommentValueCore(e)||""}setCommentValue(e,t){this.isCommentShowing(e)&&this.setCommentValueCore(e,t)}get commentPropertyValue(){return"comment"}getCommentValueCore(e){return this.isOtherItemByValue(e)?this.otherValue:this.getPropertyValue(this.getCommentPropertyValue(e),this.getCommentValueByItem(e))||""}getCommentValueByItem(e){const t=this.value;return typeof t=="object"&&t[this.commentPropertyValue]||""}setCommentValueCore(e,t){this.isOtherItemByValue(e)?this.otherValue=t:(this.setCommentPropertyValue(e,t),this.isItemSelectedCore(e)&&(t?this.value={value:e.value,comment:t}:this.value=e.value))}setCommentPropertyValue(e,t){this.setPropertyValue(this.getCommentPropertyValue(e),t)}isOtherItemByValue(e){return e.value===this.otherItem.value}getCommentPropertyValue(e){return this.isOtherItemByValue(e)?this.getStoreOthersAsComment()?"comment":"otherValue":"other_"+e.uniqueId}get showNoneItem(){return this.getPropertyValue("showNoneItem")}set showNoneItem(e){this.setPropertyValue("showNoneItem",e)}get hasNone(){return this.showNoneItem}set hasNone(e){this.showNoneItem=e}get noneItem(){return this.noneItemValue}get noneText(){return this.getLocalizableStringText("noneText")}set noneText(e){this.setLocalizableStringText("noneText",e)}get locNoneText(){return this.getLocalizableString("noneText")}get showRefuseItem(){return this.getPropertyValue("showRefuseItem")}set showRefuseItem(e){this.setPropertyValue("showRefuseItem",e)}get refuseItem(){return this.refuseItemValue}get refuseText(){return this.getLocalizableStringText("refuseText")}set refuseText(e){this.setLocalizableStringText("refuseText",e)}get locRefuseText(){return this.getLocalizableString("refuseText")}get showDontKnowItem(){return this.getPropertyValue("showDontKnowItem")}set showDontKnowItem(e){this.setPropertyValue("showDontKnowItem",e)}get dontKnowItem(){return this.dontKnowItemValue}get dontKnowText(){return this.getLocalizableStringText("dontKnowText")}set dontKnowText(e){this.setLocalizableStringText("dontKnowText",e)}get locDontKnowText(){return this.getLocalizableString("dontKnowText")}createNoneItem(e,t,s){const i=this.createItemValue(e);i.isExclusive=!0;const r=this.createLocalizableString(t,i,!0,s);return i.setLocText(r),i}get choicesVisibleIf(){return this.getPropertyValue("choicesVisibleIf","")}set choicesVisibleIf(e){this.setPropertyValue("choicesVisibleIf",e),this.filterItems()}get choicesEnableIf(){return this.getPropertyValue("choicesEnableIf","")}set choicesEnableIf(e){this.setPropertyValue("choicesEnableIf",e),this.filterItems()}surveyChoiceItemVisibilityChange(){this.filterItems()}addUsedLocales(e){super.addUsedLocales(e),this.doForPanels(void 0,t=>{t.addUsedLocales(e)})}runConditionCore(e){super.runConditionCore(e),this.runItemsEnableCondition(e),this.runItemsCondition(e),this.choices.forEach(t=>{t.runConditionCore(e)}),this.doForPanels(void 0,t=>{t.runCondition(e)})}isTextValue(){return!0}setDefaultIntoValue(e){!this.isValueEmpty(e)&&this.showOtherItem&&this.hasUnknownValue(e,!0)?this.setDefaultUnknownValue(e):super.setDefaultIntoValue(e)}setDefaultUnknownValue(e){this.renderedValue=this.setOtherValueIntoValue(e),this.otherValue=e}valueToData(e){return L.isValueEmpty(e)?e:Array.isArray(e)?e.length>0?e[0]:void 0:e}filterItems(){if(this.isLoadingFromJson||!this.data||this.areInvisibleElementsShowing)return!1;var e=this.getDataFilteredProperties();return this.runItemsEnableCondition(e),this.runItemsCondition(e)}runItemsCondition(e){const t=this.runConditionsForItems(e);return this.filteredChoicesValue&&this.filteredChoicesValue.length===this.activeChoices.length&&(this.filteredChoicesValue=void 0),t&&(this.onVisibleChoicesChanged(),this.clearIncorrectValues()),t}runItemsEnableCondition(e){const t=this.getChoicesCondition("choicesEnableIf");fe.runEnabledConditionsForItems(this.activeChoices,t,e,(i,r)=>r&&this.onEnableItemCallBack(i))&&this.clearDisabledValues(),this.onAfterRunItemsEnableCondition()}onAfterRunItemsEnableCondition(){}onEnableItemCallBack(e){return!0}onSelectedItemValuesChangedHandler(e){var t;(t=this.survey)===null||t===void 0||t.loadedChoicesFromServer(this)}getItemIfChoicesNotContainThisValue(e,t){return this.waitingChoicesByURL?this.createItemValue(e,t):null}getSingleSelectedItem(){const e=this.selectedItemValues;if(this.isEmpty())return null;const t=this.getItemByValue(this.value);return this.onGetSingleSelectedItem(t),!t&&(!e||this.value!=e.id)&&this.updateSelectedItemValues(),t||e||(this.isOtherSelected?this.otherItem:this.getItemIfChoicesNotContainThisValue(this.value))}onGetSingleSelectedItem(e){}getMultipleSelectedItems(){return[]}getChoicesCondition(e){const t=this.getExpressionFromSurvey(e);return t?new Gs(t):null}canSurveyChangeItemVisibility(){return!!this.survey&&this.survey.canChangeChoiceItemsVisibility()}changeItemVisibility(){return this.canSurveyChangeItemVisibility()?(e,t)=>this.survey.getChoiceItemVisibility(this,e,t):null}runConditionsForItems(e){this.filteredChoicesValue=[];const t=this.changeItemVisibility(),s=this.areInvisibleElementsShowing?null:this.getChoicesCondition("choicesVisibleIf");return fe.runConditionsForItems(this.activeChoices,this.getFilteredChoices(),s,e,!this.survey||!this.survey.areInvisibleElementsShowing,(i,r)=>t?t(i,r):r)}getHasOther(e){return this.getIsItemValue(e,this.otherItem)}getIsItemValue(e,t){return e===t.value}get validatedValue(){return this.renderedValueToDataCore(this.value)}createRestful(){return new pt}setNewRestfulProperty(){this.setPropertyValue("choicesByUrl",this.createRestful()),this.choicesByUrl.owner=this,this.choicesByUrl.loadingOwner=this}get autoOtherMode(){return this.getPropertyValue("autoOtherMode")}set autoOtherMode(e){this.setPropertyValue("autoOtherMode",e)}getQuestionComment(){return this.showCommentArea?super.getQuestionComment():this.otherValueCore?this.otherValueCore:this.showCommentArea||this.getStoreOthersAsComment()?super.getQuestionComment():this.otherValueCore}selectOtherValueFromComment(e){e&&(this.prevIsOtherSelected=!0),this.value=e?this.otherItem.value:void 0}onUpdateCommentOnAutoOtherMode(e){if(!this.autoOtherMode)return;const t=this.isOtherSelected;(!t&&e||t&&!e)&&this.selectOtherValueFromComment(!!e)}getValueOnSettingOther(e){const t=this.rendredValueToData(this.renderedValue);if(this.showCommentArea||this.getStoreOthersAsComment())return t;const s=this.getItemByValue(e);if(!s||s===this.otherItem)return t;if(this.otherValueCore="",!Array.isArray(t))return e;const i=t.indexOf(this.otherItem.value);return i>-1&&t.splice(i,1),t.indexOf(e)<0&&t.push(e),t}clearValue(e,t){super.clearValue(e,t),this.selectedItemValues=void 0}get renderedValue(){return this.getPropertyValue("renderedValue",null)}set renderedValue(e){this.setRenderedValue(e,!0)}setRenderedValue(e,t){this.setPropertyValue("renderedValue",e),t&&!this.isReadOnlyAttr&&(e=this.rendredValueToData(e),this.isTwoValueEquals(e,this.value)||(this.value=e)),this.onRenderedValueChagned(t)}onRenderedValueChagned(e){this.choices.forEach(t=>this.updateItemIsCommentShowing(t,e)),this.showOtherItem&&this.updateItemIsCommentShowing(this.otherItem,e)}updateItemIsCommentShowing(e,t){if(e.showCommentArea){const s=this.isCommentShowing(e);e.setIsCommentShowing(s),!s&&t&&this.setCommentValueCore(e,void 0)}}selectItem(e){if(this.isReadOnlyAttr||!e)return;const t=this.getSingleSelectedItem();this.renderedValue=e.value,t&&t!==this.getSingleSelectedItem()&&this.onItemDeselected(t),this.onItemSelected(e)}onItemSelected(e){e.showCommentArea&&this.focusOtherComment(e)}onItemDeselected(e){e.showCommentArea&&this.setCommentValueCore(e,void 0)}setQuestionValue(e,t=!0,s=!0){this.isLoadingFromJson||this.isTwoValueEquals(this.value,e)||(this.setRenderedValue(this.rendredValueFromData(e),!1),super.setQuestionValue(e,t),this.updateChoicesDependedQuestions(),this.updateChoicesPanels(),!(this.showCommentArea||!s)&&!this.isOtherSelected&&this.otherValue&&(this.makeCommentEmpty=!0,this.otherValueCore="",this.setPropertyValue("comment","")))}setValueCore(e){super.setValueCore(e),this.makeCommentEmpty&&(this.setCommentIntoData(""),this.makeCommentEmpty=!1)}setNewValue(e){e=this.valueFromData(e),(!this.choicesByUrl.isRunning&&!this.choicesByUrl.isWaitingForParameters||!this.isValueEmpty(e))&&(this.cachedValueForUrlRequests=e),super.setNewValue(e)}valueFromData(e){let t=this.getItemByValue(e,this.activeChoices);return t?this.getChoiceValue(t,e,!1):super.valueFromData(e)}updateChoicesPanels(){!this.supportElementsInChoice()||!this.wasRendered||(this.choices.forEach(e=>{e.isDescendantOf("choiceitem")&&e.panelFirstRendering()}),this.isClearValueOnHidden&&this.clearValuesInVisiblePanels("onHiddenContainer"))}getChoiceValue(e,t,s){const i=typeof t=="object",r=i?t[this.commentPropertyValue]:"",a=!L.isValueEmpty(r);if(i&&e.showCommentArea&&(s||a)){const o={value:e.value};return a&&(o[this.commentPropertyValue]=r),o}return e.value}getItemByValue(e,t){const s=t||this.visibleChoices;return e&&typeof e=="object"&&!L.isValueEmpty(e.value)&&(e=e.value),fe.getItemByValue(s,e)}rendredValueFromData(e){if(e&&typeof e=="object"&&!L.isValueEmpty(e.value)){const t=this.getItemByValue(e.value);t&&(this.setCommentPropertyValue(t,e[this.commentPropertyValue]),e=e.value)}return this.getStoreOthersAsComment()||!this.showOtherItem?e:this.renderedValueFromDataCore(e)}getValueFromValueWithComment(e){return e&&typeof e=="object"&&!L.isValueEmpty(e.value)?e.value:e}rendredValueToData(e){return this.getStoreOthersAsComment()?e:this.renderedValueToDataCore(e)}renderedValueFromDataCore(e){return this.hasUnknownValue(e,!0,!1)?(this.otherValue=e,this.otherItem.value):this.valueFromData(e)}renderedValueToDataCore(e){return e==this.otherItem.value&&this.needConvertRenderedOtherToDataValue()&&(e=this.otherValue),e}needConvertRenderedOtherToDataValue(){let e=this.otherValue;return!e||(e=e.trim(),!e)?!1:this.hasUnknownValue(e,!0,!1)}getIsQuestionReady(){return super.getIsQuestionReady()&&!this.waitingChoicesByURL&&!this.waitingGetChoiceDisplayValueResponse}updateSelectedItemValues(){if(this.waitingGetChoiceDisplayValueResponse||!this.survey||this.isEmpty())return;const e=this.value,t=Array.isArray(e)?e:[e];t.some(i=>!this.getItemByValue(i,this.choices))&&(this.choicesLazyLoadEnabled||this.hasChoicesUrl)&&(this.waitingGetChoiceDisplayValueResponse=!0,this.updateIsReady(),this.survey.getChoiceDisplayValue({question:this,values:t,setItems:(i,...r)=>{if(this.waitingGetChoiceDisplayValueResponse=!1,!i||!i.length){this.updateIsReady();return}const a=i.map((o,l)=>this.createItemValue(t[l],o));this.setCustomValuesIntoItems(a,r),Array.isArray(e)?this.selectedItemValues=a:this.selectedItemValues=a[0],this.updateIsReady(),this.onSelectedItemValuesUpdated()}}))}onSelectedItemValuesUpdated(){}setCustomValuesIntoItems(e,t){!Array.isArray(t)||t.length===0||t.forEach(s=>{const i=s.values,r=s.propertyName;if(Array.isArray(i))for(let a=0;a<e.length&&a<i.length;a++)e[a][r]=i[a]})}hasUnknownValue(e,t=!1,s=!0,i=!1){if(!Array.isArray(e))return this.hasUnknownValueItem(e,t,s,i);for(let r=0;r<e.length;r++)if(this.hasUnknownValueItem(e[r],t,s,i))return!0;return!1}hasUnknownValueItem(e,t=!1,s=!0,i=!1){if(!i&&this.isValueEmpty(e)||t&&e==this.otherItem.value||this.showNoneItem&&e==this.noneItem.value||this.showRefuseItem&&e==this.refuseItem.value||this.showDontKnowItem&&e==this.dontKnowItem.value)return!1;var r=s?this.getFilteredChoices():this.activeChoices;return this.getItemByValue(e,r)==null}isValueDisabled(e){var t=this.getItemByValue(e,this.getFilteredChoices());return!!t&&!t.isEnabled}endLoadingFromJson(){super.endLoadingFromJson(),this.updateVisibleChoices()}get customChoices(){return this.getPropertyValue("customChoices")}set customChoices(e){this.setPropertyValue("customChoices",e)}get choicesByUrl(){return this.getPropertyValue("choicesByUrl")}set choicesByUrl(e){e&&(this.setNewRestfulProperty(),this.choicesByUrl.fromJSON(e.toJSON()))}get choices(){return this.getPropertyValue("choices")}set choices(e){this.setPropertyValue("choices",e)}get choicesFromQuestion(){return this.getPropertyValue("choicesFromQuestion")}set choicesFromQuestion(e){var t=this.getQuestionWithChoices();this.isLockVisibleChoices=!!t&&t.name===e,t&&t.name!==e&&(t.removeDependedQuestion(this),this.isInDesignMode&&!this.isLoadingFromJson&&e&&this.setPropertyValue("choicesFromQuestion",void 0)),this.setPropertyValue("choicesFromQuestion",e),this.isLockVisibleChoices=!1}get choicesFromQuestionMode(){return this.getPropertyValue("choicesFromQuestionMode")}set choicesFromQuestionMode(e){this.setPropertyValue("choicesFromQuestionMode",e)}get choiceValuesFromQuestion(){return this.getPropertyValue("choiceValuesFromQuestion")}set choiceValuesFromQuestion(e){this.setPropertyValue("choiceValuesFromQuestion",e)}get choiceTextsFromQuestion(){return this.getPropertyValue("choiceTextsFromQuestion")}set choiceTextsFromQuestion(e){this.setPropertyValue("choiceTextsFromQuestion",e)}get hideIfChoicesEmpty(){return this.getPropertyValue("hideIfChoicesEmpty")}set hideIfChoicesEmpty(e){this.setPropertyValue("hideIfChoicesEmpty",e)}get keepIncorrectValues(){return this.getPropertyValue("keepIncorrectValues",!1)}set keepIncorrectValues(e){this.setPropertyValue("keepIncorrectValues",e)}get storeOthersAsComment(){return this.getPropertyValue("storeOthersAsComment")}set storeOthersAsComment(e){this.setPropertyValue("storeOthersAsComment",e)}get choicesOrder(){return this.getPropertyValue("choicesOrder")}set choicesOrder(e){e=e.toLowerCase(),e!=this.choicesOrder&&(this.setPropertyValue("choicesOrder",e),this.onVisibleChoicesChanged())}get otherText(){return this.getLocalizableStringText("otherText")}set otherText(e){this.setLocalizableStringText("otherText",e),this.onVisibleChoicesChanged()}get locOtherText(){return this.getLocalizableString("otherText")}get separateSpecialChoices(){return this.getPropertyValue("separateSpecialChoices")}set separateSpecialChoices(e){this.setPropertyValue("separateSpecialChoices",e)}get otherPlaceholder(){return this.getLocalizableStringText("otherPlaceholder")}set otherPlaceholder(e){this.setLocalizableStringText("otherPlaceholder",e)}get locOtherPlaceholder(){return this.getLocalizableString("otherPlaceholder")}get otherPlaceHolder(){return this.otherPlaceholder}set otherPlaceHolder(e){this.otherPlaceholder=e}get otherErrorText(){return this.getLocalizableStringText("otherErrorText")}set otherErrorText(e){this.setLocalizableStringText("otherErrorText",e)}get locOtherErrorText(){return this.getLocalizableString("otherErrorText")}get visibleChoices(){return this.getPropertyValue("visibleChoices")}get enabledChoices(){for(var e=[],t=this.visibleChoices,s=0;s<t.length;s++)t[s].isEnabled&&e.push(t[s]);return e}updateVisibleChoices(){if(this.isLoadingFromJson||this.isDisposed)return;var e=this.calcVisibleChoices(),t=new Array;(e||[]).forEach(i=>t.push(i));const s=this.visibleChoices;(!this.isTwoValueEquals(s,t)||this.choicesLazyLoadEnabled)&&(this.setArrayPropertyDirectly("visibleChoices",t),this.updateRenderedChoices())}calcVisibleChoices(){let e=new Array;return this.customChoices.forEach(t=>e.push(t)),this.getFilteredChoices().forEach(t=>e.push(t)),e=this.sortArrayByChoicesOrder(e),this.addToVisibleChoices(e,this.isAddDefaultItems),e}setCanShowOptionItemCallback(e){this.canShowOptionItemCallback=e,e&&this.onVisibleChoicesChanged()}get newItem(){return this.newItemValue}addToVisibleChoices(e,t){this.headItemsCount=0,this.footItemsCount=0,this.isEmptyActiveChoicesInDesign||this.addNewItemToVisibleChoices(e,t);const s=new Array;this.addNonChoicesItems(s,t),s.sort((i,r)=>i.index===r.index?0:i.index<r.index?-1:1);for(let i=0;i<s.length;i++){const r=s[i];r.index<0?(e.splice(i,0,r.item),this.headItemsCount++):(e.push(r.item),this.footItemsCount++)}}addNewItemToVisibleChoices(e,t){t&&(this.newItemValue||(this.newItemValue=this.createItemValue("newitem"),this.newItemValue.isGhost=!0,this.newItemValue.registerFunctionOnPropertyValueChanged("isVisible",()=>{this.updateVisibleChoices()})),this.newItemValue.isVisible&&!this.isUsingCarryForward&&this.canShowOptionItem(this.newItemValue,t,!1)&&(this.footItemsCount=1,e.push(this.newItemValue)))}addNonChoicesItems(e,t){this.supportNone()&&this.addNonChoiceItem(e,this.noneItem,t,this.showNoneItem,D.specialChoicesOrder.noneItem),this.supportRefuse()&&this.addNonChoiceItem(e,this.refuseItem,t,this.showRefuseItem,D.specialChoicesOrder.refuseItem),this.supportDontKnow()&&this.addNonChoiceItem(e,this.dontKnowItem,t,this.showDontKnowItem,D.specialChoicesOrder.dontKnowItem),this.supportOther()&&this.addNonChoiceItem(e,this.otherItem,t,this.showOtherItem,D.specialChoicesOrder.otherItem)}addNonChoiceItem(e,t,s,i,r){this.canShowOptionItem(t,s,i)&&r.forEach(a=>e.push({index:a,item:t}))}canShowOptionItem(e,t,s){let i=t&&(this.canShowOptionItemCallback?this.canShowOptionItemCallback(e):!0)||s;return this.canSurveyChangeItemVisibility()?this.changeItemVisibility()(e,i):i}isItemInList(e){return e===this.otherItem?this.showOtherItem:e===this.noneItem?this.showNoneItem:e===this.refuseItem?this.showRefuseItem:e===this.dontKnowItem?this.showDontKnowItem:e!==this.newItemValue}get isAddDefaultItems(){return D.showDefaultItemsInCreator&&this.isInDesignMode&&!this.customWidget}getPlainData(e={includeEmpty:!0,includeQuestionTypes:!1}){var t=super.getPlainData(e);if(t){var s=Array.isArray(this.value)?this.value:[this.value];t.isNode=!0,t.data=(t.data||[]).concat(s.map((i,r)=>{var a=this.getItemByValue(i),o={name:r,title:this.getLocalizationString("choices_Choice"),value:i,displayValue:this.getChoicesDisplayValue(this.visibleChoices,i),getString:l=>typeof l=="object"?JSON.stringify(l):l,isNode:!1};return a&&(e.calculations||[]).forEach(l=>{o[l.propertyName]=a[l.propertyName]}),this.isOtherSelected&&this.otherItemValue===a&&(o.isOther=!0,o.displayValue=this.otherValue),o}))}return t}getDisplayValueCore(e,t){return t=this.getValueFromValueWithComment(t),this.useDisplayValuesInDynamicTexts?this.getChoicesDisplayValue(this.visibleChoices,t):t}getDisplayValueEmpty(){return fe.getTextOrHtmlByValue(this.visibleChoices,void 0)}getChoicesDisplayValue(e,t){if(t==this.otherItemValue.value)return this.otherValue?this.otherValue:this.locOtherText.textOrHtml;const s=this.getSingleSelectedItem();if(s&&this.isTwoValueEquals(s.value,t))return s.locText.textOrHtml;var i=fe.getTextOrHtmlByValue(e,t);return i==""&&t?t:i}getDisplayArrayValue(e,t,s){var i=this.visibleChoices,r=[];const a=[];for(var o=0;o<t.length;o++)a.push(s?s(o):t[o]);if(L.isTwoValueEquals(this.value,a)&&this.getMultipleSelectedItems().forEach((l,u)=>r.push(this.getItemDisplayValue(l,a[u]))),r.length===0)for(var o=0;o<a.length;o++){let u=this.getChoicesDisplayValue(i,a[o]);u&&r.push(u)}return r.join(D.choicesSeparator)}getItemDisplayValue(e,t){if(e===this.otherItem){if(this.showOtherItem&&this.showCommentArea&&t)return t;if(this.comment)return this.comment}return e.locText.textOrHtml}getFilteredChoices(){return this.filteredChoicesValue?this.filteredChoicesValue:this.activeChoices}get activeChoices(){const e=this.getCarryForwardQuestion();return this.carryForwardQuestionType==="select"?(e.addDependedQuestion(this),this.getChoicesFromSelectQuestion(e)):this.carryForwardQuestionType==="array"?(e.addDependedQuestion(this),this.getChoicesFromArrayQuestion(e)):this.isEmptyActiveChoicesInDesign?[]:this.choicesFromUrl?this.choicesFromUrl:this.getChoices()}get isMessagePanelVisible(){return this.getPropertyValue("isMessagePanelVisible",!1)}set isMessagePanelVisible(e){this.setPropertyValue("isMessagePanelVisible",e)}get isEmptyActiveChoicesInDesign(){return this.isInDesignMode&&(this.hasChoicesUrl||this.isMessagePanelVisible)}getCarryForwardQuestion(e){const t=this.findCarryForwardQuestion(e),s=this.getQuestionWithChoicesCore(t),i=s?null:this.getQuestionWithArrayValue(t);return this.setCarryForwardQuestionType(!!s,!!i),s||i?t:null}getIsReadyDependsOn(){const e=super.getIsReadyDependsOn();return this.carryForwardQuestion&&e.push(this.carryForwardQuestion),e}getQuestionWithChoices(){return this.getQuestionWithChoicesCore(this.findCarryForwardQuestion())}findCarryForwardQuestion(e){var t;return e||(e=this.data||((t=this.parentQuestion)===null||t===void 0?void 0:t.data)),this.carryForwardQuestion=null,this.choicesFromQuestion&&e&&(this.carryForwardQuestion=e.findQuestionByName(this.choicesFromQuestion)),this.carryForwardQuestion}getQuestionWithChoicesCore(e){return e&&e.visibleChoices&&B.isDescendantOf(e.getType(),"selectbase")&&e!==this?e:null}getQuestionWithArrayValue(e){return e&&e.isValueArray?e:null}getChoicesFromArrayQuestion(e){if(this.isInDesignMode)return[];const t=e.value;if(!Array.isArray(t))return[];const s=[];for(var i=0;i<t.length;i++){const r=t[i];if(!L.isValueObject(r))continue;const a=this.getValueKeyName(r);if(a&&!this.isValueEmpty(r[a])){const o=this.choiceTextsFromQuestion?r[this.choiceTextsFromQuestion]:void 0;s.push(this.createItemValue(r[a],o))}}return s}getValueKeyName(e){if(this.choiceValuesFromQuestion)return this.choiceValuesFromQuestion;const t=Object.keys(e);return t.length>0?t[0]:void 0}getChoicesFromSelectQuestion(e){if(this.isInDesignMode)return[];const t=[];var s=this.choicesFromQuestionMode=="selected"?!0:this.choicesFromQuestionMode=="unselected"?!1:void 0;const i=e.visibleChoices;for(var r=0;r<i.length;r++)if(!e.isBuiltInChoice(i[r])){if(s===void 0){t.push(this.copyChoiceItem(i[r]));continue}var a=e.isItemSelected(i[r]);(a&&s||!a&&!s)&&t.push(this.copyChoiceItem(i[r]))}return this.choicesFromQuestionMode==="selected"&&!this.showOtherItem&&e.isOtherSelected&&e.otherValue&&t.push(this.createItemValue(e.otherItem.value,e.otherValue)),t}copyChoiceItem(e){const t=this.createItemValue(e.value);return t.setData(e),t}get hasActiveChoices(){var e=this.visibleChoices;(!e||e.length==0)&&(this.onVisibleChoicesChanged(),e=this.visibleChoices);for(var t=0;t<e.length;t++)if(!this.isBuiltInChoice(e[t]))return!0;return!1}isBuiltInChoice(e){return[this.otherItem,this.noneItem,this.refuseItem,this.dontKnowItem,this.newItemValue].indexOf(e)>-1}isNoneItem(e){return e.isExclusive===!0}getChoices(){return this.choices}get showOtherItem(){return this.getPropertyValue("showOtherItem",!1)}set showOtherItem(e){!this.supportOther()||this.showOtherItem==e||(this.setPropertyValue("showOtherItem",e),this.onVisibleChoicesChanged())}get hasOther(){return this.showOtherItem}set hasOther(e){this.showOtherItem=e}get requireUpdateCommentValue(){return this.showCommentArea||this.showOtherItem}supportOther(){return this.isSupportProperty("showOtherItem")}supportNone(){return this.isSupportProperty("showNoneItem")}supportRefuse(){return this.isSupportProperty("showRefuseItem")}supportDontKnow(){return this.isSupportProperty("showDontKnowItem")}isSupportProperty(e){return!this.isDesignMode||this.getPropertyByName(e).visible}onCheckForErrors(e,t,s){if(super.onCheckForErrors(e,t,s),this.hasEmptyComments()&&(!t||this.prevOtherErrorValue)){const i=new kR(this.otherErrorText,this);i.onUpdateErrorTextCallback=r=>{r.text=this.otherErrorText},e.push(i)}}hasEmptyComments(){const e=this.visibleChoices;for(let t=0;t<e.length;t++){const s=e[t];if(s.isCommentRequired&&this.isCommentShowing(s)&&!this.getCommentValue(e[t]))return!0}return!1}setSurveyImpl(e,t){this.isRunningChoices=!0,super.setSurveyImpl(e,t),this.isRunningChoices=!1,this.runChoicesByUrl(),this.isAddDefaultItems&&this.updateVisibleChoices()}setSurveyCore(e){super.setSurveyCore(e),e&&this.choicesFromQuestion&&this.onVisibleChoicesChanged()}getStoreOthersAsComment(){return this.showCommentArea?!1:this.checkHasChoicesComments()?!0:this.storeOthersAsComment===!0||this.storeOthersAsComment=="default"&&(this.survey!=null?this.survey.storeOthersAsComment:!0)||this.hasChoicesUrl&&!this.choicesFromUrl}checkHasChoicesComments(){const e=this.choices;for(let t=0;t<e.length;t++)if(e[t].showCommentArea)return!0;return!1}onSurveyLoad(){this.runChoicesByUrl(),this.onVisibleChoicesChanged(),this.doForPanels(void 0,e=>{e.onSurveyLoad()}),super.onSurveyLoad()}onFirstRenderingCore(){super.onFirstRenderingCore(),this.doForPanels(!0,e=>{e.onFirstRendering()})}onAnyValueChanged(e,t){super.onAnyValueChanged(e,t),e!=this.getValueName()&&this.runChoicesByUrl();const s=this.choicesFromQuestion;e&&s&&(e===s||t===s)&&(this.onVisibleChoicesChanged(),this.clearIncorrectValues())}updateValueFromSurvey(e,t){var s="";this.showOtherItem&&this.activeChoices.length>0&&!this.isRunningChoices&&!this.choicesByUrl.isRunning&&this.getStoreOthersAsComment()&&(this.hasUnknownValue(e)&&!this.getHasOther(e)?(s=this.getCommentFromValue(e),e=this.setOtherValueIntoValue(e)):this.data&&(s=this.data.getComment(this.getValueName()))),super.updateValueFromSurvey(e,t),(this.isRunningChoices||this.choicesByUrl.isRunning)&&!this.isEmpty()&&(this.cachedValueForUrlRequests=this.value),s&&this.setNewComment(s),this.updateValueForPanels(t,!1)}updateCommentFromSurvey(e){super.updateCommentFromSurvey(e),this.updateValueForPanels(!1,!0)}updateValueForPanels(e,t){this.data&&this.doForPanels(!0,s=>{s.questions.forEach(i=>{const r=i.getValueName();t?i.updateCommentFromSurvey(this.data.getComment(r)):i.updateValueFromSurvey(this.data.getValue(r),e)})})}getCommentFromValue(e){return e}setOtherValueIntoValue(e){return this.otherItem.value}onOtherValueInput(e,t){this.isInputTextUpdate&&t.target&&this.setCommentValueCore(e,t.target.value)}onOtherValueChange(e,t){var s;this.setCommentValueCore(e,(((s=t.target)===null||s===void 0?void 0:s.value)||"").trim());const i=this.getCommentValueCore(e);i!==t.target.value&&(t.target.value=i||"")}runChoicesByUrl(){if(this.updateIsUsingRestful(),!(!this.choicesByUrl||this.isLoadingFromJson||this.isRunningChoices||this.isInDesignMode)){var e=this.surveyImpl?this.surveyImpl.getTextProcessor():this.textProcessor;e||(e=this.survey),e&&(this.updateIsReady(),this.isRunningChoices=!0,this.choicesByUrl.run(e),this.isRunningChoices=!1)}}onBeforeSendRequest(){D.web.disableQuestionWhileLoadingChoices===!0&&!this.isReadOnly&&(this.enableOnLoadingChoices=!0,this.readOnly=!0)}onLoadChoicesFromUrl(e){this.enableOnLoadingChoices&&(this.readOnly=!1);const t=[];this.isReadOnly||this.choicesByUrl&&this.choicesByUrl.error&&t.push(this.choicesByUrl.error);var s=null,i=!0;this.isFirstLoadChoicesFromUrl&&!this.cachedValueForUrlRequests&&this.defaultValue&&(this.cachedValueForUrlRequests=this.defaultValue,i=!1),this.isValueEmpty(this.cachedValueForUrlRequests)&&(this.cachedValueForUrlRequests=this.value);var r=this.createCachedValueForUrlRequests(this.cachedValueForUrlRequests,i);if(e&&(e.length>0||this.choicesByUrl.allowEmptyResponse)&&(s=new Array,fe.setData(s,e)),s)for(var a=0;a<s.length;a++)s[a].locOwner=this;this.setChoicesFromUrl(s,t,r)}canAvoidSettChoicesFromUrl(e){return this.isFirstLoadChoicesFromUrl||(!e||Array.isArray(e)&&e.length===0)&&!this.isEmpty()?!1:L.isTwoValueEquals(this.choicesFromUrl,e)}setChoicesFromUrl(e,t,s){if(!this.canAvoidSettChoicesFromUrl(e)){if(this.isFirstLoadChoicesFromUrl=!1,this.choicesFromUrl=e,this.filterItems(),this.onVisibleChoicesChanged(),e){var i=this.updateCachedValueForUrlRequests(s,e);if(i&&!this.isReadOnly){var r=!this.isTwoValueEquals(this.value,i.value);try{this.isValueEmpty(i.value)||(this.allowNotifyValueChanged=!1,this.setQuestionValue(void 0,!0,!1)),this.allowNotifyValueChanged=r,r?this.value=i.value:this.setQuestionValue(i.value)}finally{this.allowNotifyValueChanged=!0}}}!this.isReadOnly&&!e&&!this.isFirstLoadChoicesFromUrl&&(this.value=null),this.errors=t,this.choicesLoaded()}}createCachedValueForUrlRequests(e,t){if(this.isValueEmpty(e))return null;if(Array.isArray(e)){for(var s=[],i=0;i<e.length;i++)s.push(this.createCachedValueForUrlRequests(e[i],!0));return s}var r=t?!this.hasUnknownValue(e):!0;return{value:e,isExists:r}}updateCachedValueForUrlRequests(e,t){if(this.isValueEmpty(e))return null;if(Array.isArray(e)){for(var s=[],i=0;i<e.length;i++){var r=this.updateCachedValueForUrlRequests(e[i],t);if(r&&!this.isValueEmpty(r.value)){var a=r.value,l=this.getItemByValue(r.value,t);l&&(a=l.value),s.push(a)}}return{value:s}}var o=e.isExists&&this.hasUnknownValue(e.value)?null:e.value,l=this.getItemByValue(o,t);return l&&(o=l.value),{value:o}}updateChoicesDependedQuestions(){this.isLoadingFromJson||this.isUpdatingChoicesDependedQuestions||!this.allowNotifyValueChanged||this.choicesByUrl.isRunning||(this.isUpdatingChoicesDependedQuestions=!0,this.updateDependedQuestions(),this.isUpdatingChoicesDependedQuestions=!1)}updateDependedQuestion(){this.onVisibleChoicesChanged(),this.clearIncorrectValues()}onSurveyValueChanged(e){super.onSurveyValueChanged(e),this.updateChoicesDependedQuestions()}onVisibleChoicesChanged(){this.isLoadingFromJson||this.isLockVisibleChoices||(this.updateVisibleChoices(),this.renderedValue===this.otherItem.value&&this.setRenderedValue(this.rendredValueFromData(this.value),!1),this.onVisibleChanged(),this.visibleChoicesChangedCallback&&this.visibleChoicesChangedCallback(),this.updateChoicesDependedQuestions())}isVisibleCore(){const e=super.isVisibleCore();if(!this.hideIfChoicesEmpty||!e)return e;var t=this.isUsingCarryForward?this.visibleChoices:this.getFilteredChoices();return!t||t.length>0}sortArrayByChoicesOrder(e){const t=e.slice();if(this.isInDesignMode)return t;const s=this.choicesOrder.toLowerCase();return s=="asc"?this.sortArray(t,1):s=="desc"?this.sortArray(t,-1):s=="random"?this.randomizeArray(t):t}sortArray(e,t){return e.sort(function(s,i){return L.compareStrings(s.calculatedText,i.calculatedText)*t})}randomizeArray(e){return L.randomizeArray(e)}get hasChoicesUrl(){return this.choicesByUrl&&!!this.choicesByUrl.url}clearIncorrectValues(){!this.canClearIncorrectValues()||!this.hasValueToClearIncorrectValues()||(this.clearIncorrectValuesCallback?this.clearIncorrectValuesCallback():this.clearIncorrectValuesCore())}canClearIncorrectValues(){return!(this.canAddCustomChoices()||this.carryForwardQuestion&&!this.carryForwardQuestion.isReady||this.survey&&this.survey.questionsByValueName(this.getValueName()).length>1||this.hasChoicesUrl&&(!this.choicesFromUrl||this.choicesFromUrl.length==0))}canAddCustomChoices(){return!1}hasValueToClearIncorrectValues(){return this.survey&&this.survey.keepIncorrectValues?!1:!this.keepIncorrectValues&&!this.isEmpty()}clearValueIfInvisibleCore(e){super.clearValueIfInvisibleCore(e),this.clearIncorrectValues(),this.clearValuesInVisiblePanels(e)}clearValuesInVisiblePanels(e){this.doForPanels(!1,t=>{t.questions.forEach(s=>{s.clearValue()}),t.questions.forEach(s=>{s.clearValueIfInvisible(e)})})}isItemSelected(e){return e===this.otherItem?this.isOtherSelected:this.isItemSelectedCore(e)}isItemSelectedCore(e){return e.value===this.renderedValue}clearDisabledValues(){!this.survey||!this.survey.clearDisabledChoices||this.clearDisabledValuesCore()}clearIncorrectValuesCore(){var e=this.value;this.canClearValueAnUnknown(e)&&this.clearValue(!0)}canClearValueAnUnknown(e){return!this.getStoreOthersAsComment()&&this.isOtherSelected?!1:this.hasUnknownValue(e,!0,!0,!0)}clearDisabledValuesCore(){this.isValueDisabled(this.value)&&this.clearValue(!0)}clearUnusedValues(){super.clearUnusedValues(),this.isOtherValueUnused()&&(this.otherValue="")}isOtherValueUnused(){return!this.isOtherSelected}getColumnClass(){return new j().append(this.cssClasses.column).append("sv-q-column-"+this.colCount,this.hasColumns).toString()}getItemIndex(e){return this.visibleChoices.indexOf(e)}getItemClass(e){const t={item:e};var s=this.getItemClassCore(e,t);return t.css=s,this.survey&&this.survey.updateChoiceItemCss(this,t),t.css}getCurrentColCount(){return this.colCount}getItemClassCore(e,t){const s=new j().append(this.cssClasses.item).append(this.cssClasses.itemInline,!this.hasColumns&&this.colCount===0).append("sv-q-col-"+this.getCurrentColCount(),!this.hasColumns&&this.colCount!==0).append(this.cssClasses.itemOnError,this.hasCssError()),i=this.getIsDisableAndReadOnlyStyles(!e.isEnabled),r=i[0],a=i[1],o=this.isItemSelected(e),l=!a&&!o&&!(this.survey&&this.survey.isDesignMode),u=e===this.noneItem;return t.isDisabled=a||r,t.isChecked=o,t.isNone=u,s.append(this.cssClasses.itemDisabled,a).append(this.cssClasses.itemReadOnly,r).append(this.cssClasses.itemPreview,this.isPreviewStyle).append(this.cssClasses.itemChecked,o).append(this.cssClasses.itemHover,l).append(this.cssClasses.itemNone,u).toString()}getLabelClass(e){return new j().append(this.cssClasses.label).append(this.cssClasses.labelChecked,this.isItemSelected(e)).toString()}getControlLabelClass(e){return new j().append(this.cssClasses.controlLabel).append(this.cssClasses.controlLabelChecked,this.isItemSelected(e)).toString()||void 0}updateRenderedChoices(){this.renderedChoices=this.onGetRenderedChoicesCallback?this.onGetRenderedChoicesCallback(this.visibleChoices):this.visibleChoices}getRenderedChoicesAnimationOptions(){return{isAnimationEnabled:()=>this.animationAllowed,getRerenderEvent:()=>this.onElementRerendered,getKey:e=>e!=this.newItemValue?e.value:this.newItemValue,getLeaveOptions:e=>{let t=this.cssClasses.itemLeave;if(this.hasColumns){const s=this.bodyItems.indexOf(e);s!==-1&&s!==this.bodyItems.length-1&&(t="")}return{cssClass:t,onBeforeRunAnimation:ci,onAfterRunAnimation:Vs}},getAnimatedElement:e=>e.getRootElement(),getEnterOptions:e=>{let t=this.cssClasses.itemEnter;if(this.hasColumns){const s=this.bodyItems.indexOf(e);s!==-1&&s!==this.bodyItems.length-1&&(t="")}return{cssClass:t,onBeforeRunAnimation:s=>{if(this.getCurrentColCount()==0&&this.bodyItems.indexOf(e)>=0){const i=s.parentElement.firstElementChild.offsetLeft;s.offsetLeft>i&&Vn(s,{moveAnimationDuration:"0s",fadeAnimationDelay:"0s"},"--")}ci(s)},onAfterRunAnimation:Vs}}}}get renderedChoices(){return this._renderedChoices}set renderedChoices(e){this.renderedChoicesAnimation.sync(e)}get headItems(){const e=this.separateSpecialChoices||this.isInDesignMode?this.headItemsCount:0,t=[];for(let s=0;s<e;s++)this.renderedChoices[s]&&t.push(this.renderedChoices[s]);return t}get footItems(){const e=this.separateSpecialChoices||this.isInDesignMode?this.footItemsCount:0,t=[],s=this.renderedChoices;for(let i=0;i<e;i++)this.renderedChoices[s.length-e+i]&&t.push(this.renderedChoices[s.length-e+i]);return t}get dataChoices(){return this.renderedChoices.filter(e=>!this.isBuiltInChoice(e))}get bodyItems(){return this.hasHeadItems||this.hasFootItems?this.dataChoices:this.renderedChoices}get hasHeadItems(){return this.headItems.length>0}get hasFootItems(){return this.footItems.length>0}get itemFlowDirection(){return D.itemFlowDirection}get columns(){if(!this.hasColumns||this.renderedChoices.length===0)return[];const e=this.getCurrentColCount();let t=!this.separateSpecialChoices&&!this.isInDesignMode?this.renderedChoices:this.dataChoices;return this.itemFlowDirection==="column"?this.getColumnsWithColumnItemFlow(t,e):this.getColumnsWithRowItemFlow(t,e)}getColumnsWithColumnItemFlow(e,t){const s=[];let i=Math.floor(e.length/t);e.length%t&&(i+=1);let r=e.length,a=t,o=0;for(let l=0;l<t;l++){const u=[];for(let d=0;d<i;d++){r<=a&&(i=1);const h=e[d+o];h&&(u.push(h),r--)}s.push(u),a--,o+=u.length}return s}getColumnsWithRowItemFlow(e,t){const s=[];for(let i=0;i<t;i++){const r=[];for(let a=i;a<e.length;a+=t)r.push(e[a]);s.push(r)}return s}getItemsColumnKey(e){return(e||[]).map(t=>t.uniqueId).join("-")}get hasColumns(){return!this.isMobile&&this.getCurrentColCount()>1}get rowLayout(){return this.getCurrentColCount()==0&&!(this.hasFootItems||this.hasHeadItems)}get blockedRow(){return this.getCurrentColCount()==0&&(this.hasFootItems||this.hasHeadItems)}choicesLoaded(){this.isChoicesLoaded=!0,this.updateIsReady(),this.survey&&this.survey.loadedChoicesFromServer(this),this.loadedChoicesFromServerCallback&&this.loadedChoicesFromServerCallback()}getItemValueWrapperComponentName(e){const t=this.survey;return t?t.getItemValueWrapperComponentName(e,this):Ie.TemplateRendererComponentName}getItemValueWrapperComponentData(e){const t=this.survey;return t?t.getItemValueWrapperComponentData(e,this):e}ariaItemChecked(e){return this.renderedValue===e.value?"true":"false"}isOtherItem(e){return this.showOtherItem&&e.value==this.otherItem.value}get itemSvgIcon(){return this.isPreviewStyle&&this.cssClasses.itemPreviewSvgIconId?this.cssClasses.itemPreviewSvgIconId:this.cssClasses.itemSvgIconId}getSelectBaseRootCss(){return new j().append(this.getQuestionRootCss()).append(this.cssClasses.rootRow,this.rowLayout).toString()}allowMobileInDesignMode(){return!0}getAriaItemLabel(e){return e.locText.renderedHtml}getItemId(e){return this.inputId+"_"+this.getItemIndex(e)}get questionName(){return this.name+"_"+this.id}getItemEnabled(e){return!this.isDisabledAttr&&e.isEnabled}focusOtherComment(e){var t;this.autoOtherMode||Ke.FocusElement(this.getItemCommentId(e),!1,(t=this.survey)===null||t===void 0?void 0:t.rootElement)}getDefaultItemComponent(){return""}get itemComponent(){return this.getPropertyValue("itemComponent",this.getDefaultItemComponent())}set itemComponent(e){this.setPropertyValue("itemComponent",e)}}I([Ft()],Nd.prototype,"_renderedChoices",void 0);class dl extends Nd{constructor(e){super(e)}get colCount(){return this.getPropertyValue("colCount",this.isFlowLayout?0:void 0)}set colCount(e){e<0||e>5||this.isFlowLayout||(this.setPropertyValue("colCount",e),this.fireCallback(this.colCountChangedCallback))}onParentChanged(){super.onParentChanged(),this.isFlowLayout&&this.setPropertyValue("colCount",null)}onParentQuestionChanged(){this.onVisibleChoicesChanged()}getSearchableItemValueKeys(e){e.push("choices")}}function qd(n,e){var t;if(!n)return!1;if(n.templateQuestion){const s=(t=n.colOwner)===null||t===void 0?void 0:t.data;if(n=n.templateQuestion,!n.getCarryForwardQuestion(s))return!1}return n.carryForwardQuestionType===e}B.addClass("choiceitem",[{name:"showCommentArea:boolean",locationInTable:"detail",visibleIf:n=>n.supportComment},{name:"isCommentRequired:boolean",locationInTable:"detail",visibleIf:n=>n.showCommentArea},{name:"commentPlaceholder",locationInTable:"detail",serializationProperty:"locCommentPlaceholder",visibleIf:n=>n.showCommentArea},{name:"elements",baseClassName:"question",visible:!1,isLightSerializable:!1,isSerializableFunc:n=>n.hasElements}],n=>new hl(n),"itemvalue"),B.addClass("selectbase",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},"choicesFromQuestion:question_carryforward",{name:"choices:choiceitem[]",uniqueProperty:"value",baseValue:function(){return bt("choices_Item")},dependsOn:"choicesFromQuestion",visibleIf:n=>!n.choicesFromQuestion},{name:"choicesFromQuestionMode",default:"all",choices:["all","selected","unselected"],dependsOn:"choicesFromQuestion",visibleIf:n=>qd(n,"select")},{name:"choiceValuesFromQuestion",dependsOn:"choicesFromQuestion",visibleIf:n=>qd(n,"array")},{name:"choiceTextsFromQuestion",dependsOn:"choicesFromQuestion",visibleIf:n=>qd(n,"array")},{name:"choicesOrder",default:"none",choices:["none","asc","desc","random"],dependsOn:"choicesFromQuestion",visibleIf:n=>!n.choicesFromQuestion},{name:"choicesByUrl:restfull",className:"choicesByUrl",onGetValue:function(n){return n.choicesByUrl.getData()},onSetValue:function(n,e){n.choicesByUrl.setData(e)}},"hideIfChoicesEmpty:boolean","choicesVisibleIf:condition",{name:"choicesEnableIf:condition",dependsOn:"choicesFromQuestion",visibleIf:n=>!n.choicesFromQuestion},{name:"defaultValue:value",visibleIf:n=>!n.choicesFromQuestion,dependsOn:"choicesFromQuestion"},{name:"correctAnswer:value",visibleIf:n=>!n.choicesFromQuestion,dependsOn:"choicesFromQuestion"},{name:"separateSpecialChoices:boolean",visible:!1},{name:"showOtherItem:boolean",alternativeName:"hasOther"},{name:"showNoneItem:boolean",alternativeName:"hasNone"},{name:"showRefuseItem:boolean",visible:!1,version:"1.9.128"},{name:"showDontKnowItem:boolean",visible:!1,version:"1.9.128"},{name:"otherPlaceholder",alternativeName:"otherPlaceHolder",serializationProperty:"locOtherPlaceholder",dependsOn:"showOtherItem",visibleIf:function(n){return n.showOtherItem}},{name:"noneText",serializationProperty:"locNoneText",dependsOn:"showNoneItem",visibleIf:function(n){return n.showNoneItem}},{name:"refuseText",serializationProperty:"locRefuseText",dependsOn:"showRefuseItem",visibleIf:function(n){return n.showRefuseItem}},{name:"dontKnowText",serializationProperty:"locDontKnowText",dependsOn:"showDontKnowItem",visibleIf:function(n){return n.showDontKnowItem}},{name:"otherText",serializationProperty:"locOtherText",dependsOn:"showOtherItem",visibleIf:function(n){return n.showOtherItem}},{name:"otherErrorText",serializationProperty:"locOtherErrorText",dependsOn:"showOtherItem",visibleIf:function(n){return n.showOtherItem}},{name:"storeOthersAsComment",default:"default",choices:["default",!0,!1],visible:!1}],null,"question"),B.addClass("checkboxbase",[{name:"colCount:number",default:1,choices:[0,1,2,3,4,5],layout:"row"}],null,"selectbase");class Wt extends de{get focusFirstInputSelector(){return this.getFocusFirstInputSelector()}getFocusFirstInputSelector(){return vt?this.isValueEmpty(this.question.value)?this.itemSelector:this.selectedItemSelector:!this.listModel.showFilter&&this.question.value?this.selectedItemSelector:""}resetItemsSettings(){this.itemsSettings.skip=0,this.itemsSettings.take=Math.max(this.minPageSize,this.question.choicesLazyLoadPageSize),this.itemsSettings.totalCount=0,this.itemsSettings.items=[]}setItems(e,t){this.itemsSettings.items=[].concat(this.itemsSettings.items,e),this.itemsSettings.totalCount=t,this.listModel.isAllDataLoaded=this.choicesLazyLoadEnabled&&this.itemsSettings.items.length==this.itemsSettings.totalCount,this.question.choices=this.itemsSettings.items}_loadQuestionChoices(e){const t=this.filterString;this.setIsChoicesLoading(!0),this.question.survey.loadQuestionChoices({question:this.question,filter:this.filterString,skip:this.itemsSettings.skip,take:this.itemsSettings.take,setItems:(s,i)=>{this.setItems(s||[],i||0),this.popupRecalculatePosition(this.itemsSettings.skip===this.itemsSettings.take),e&&e(),this.processCustomValue(t),this.setIsChoicesLoading(!1)}}),this.itemsSettings.skip+=this.itemsSettings.take}setIsChoicesLoading(e){this.question.setIsChoicesLoading&&this.question.setIsChoicesLoading(e)}processCustomValue(e){if(!this.allowCustomChoices)return;const t=e||this.filterString;this.listModel.getVisibleActions().filter(i=>L.isTwoValueEquals(i.text,t,!1,!1))[0]?this.customValue=void 0:(this.customValue=t,this.updateItems(),this.listModel.focusFirstVisibleItem())}updateQuestionChoices(e){const t=this.itemsSettings.skip+1<this.itemsSettings.totalCount;(!this.itemsSettings.skip||t)&&(this.resetTimer(),this.filterString&&D.dropdownSearchDelay>0?this.timer=setTimeout(()=>{this._loadQuestionChoices(e)},D.dropdownSearchDelay):this._loadQuestionChoices(e))}resetTimer(){this.timer&&(clearTimeout(this.timer),this.timer=void 0)}updatePopupFocusFirstInputSelector(){this._popupModel.focusFirstInputSelector=this.focusFirstInputSelector}getDropdownMenuOptions(){const e=he.getInnerWidth(),t=he.getInnerHeight(),s=iR(e,t);let i="dropdown",r="desktop";return vt&&(i="popup",r=s?"tablet":"mobile"),{menuType:i,deviceType:r,hasTouchScreen:vt,screenHeight:t,screenWidth:e}}checkFocusRemainsWithinComponent(e){if(!this.question.cssClasses.root||!e?.target)return!1;const t=e.target.closest(ls(this.question.cssClasses.root));return t&&t.contains(e.relatedTarget)}createButtons(){this.editorButtons=new Vt,this.editorButtons.containerCss="sd-dropdown-action-bar",this.chevronButton=new xe({id:"chevron",css:"sd-editor-chevron-button",iconName:this.question.cssClasses.chevronButtonIconId||"icon-chevron",iconSize:"auto",showTitle:!1,locTitle:this.locSelectCaption,disableTabStop:!0,enabled:new Ue(()=>!this.question.isInputReadOnly),visible:new Ue(()=>!this.question.isPreviewStyle),action:e=>{this.onClick()}}),this.clearButton=new xe({id:"clear",css:"sd-editor-clean-button",iconName:this.question.cssClasses.cleanButtonIconId||"icon-cancel-24x24",iconSize:"auto",showTitle:!1,locTitle:this.locClearCaption,disableTabStop:!0,enabled:new Ue(()=>!this.question.isInputReadOnly),visible:new Ue(()=>{const e=this.question.isEmpty(),t=this.question.isReadOnly;return this.question.allowClear&&!e&&!t}),action:e=>{this.onClear()}}),this.editorButtons.setItems([this.clearButton,this.chevronButton]),this.editorButtons.actions.forEach(e=>e.cssClasses={item:"sd-editor-button-item",itemIcon:"sv-editor-button-item__icon",itemPressed:"sd-editor-button-item--pressed"})}createPopup(){const e={verticalPosition:"bottom",horizontalPosition:"center",showPointer:!1};this._popupModel=new Mt("sv-list",{model:this.listModel},e),this._popupModel.displayMode=vt?"overlay":"popup",this._popupModel.positionMode="fixed",this._popupModel.isFocusedContainer=!1,this._popupModel.isFocusedContent=vt,this._popupModel.setWidthByTarget=!vt,this._popupModel.locale=this.question.getLocale(),this.updatePopupFocusFirstInputSelector(),this.listModel.registerPropertyChangedHandlers(["showFilter"],()=>{this.updatePopupFocusFirstInputSelector()}),this._popupModel.onVisibilityChanged.add((t,s)=>{this.popupVisibilityChanged(s.isVisible),this.chevronButton.pressed=s.isVisible})}popupVisibilityChanged(e){if(e&&(this.listModel.renderElements=!0),e&&this.choicesLazyLoadEnabled&&(this.listModel.actions=[],this.resetItemsSettings(),this.updateQuestionChoices()),e){this.updatePopupFocusFirstInputSelector();const t=this.getDropdownMenuOptions();this.question.processOpenDropdownMenu(t),this._popupModel.updateDisplayMode(t.menuType)&&this.listModel.setSearchEnabled(this.inputAvailable&&t.menuType!=="dropdown"),this.question.onOpenedCallBack&&this.question.onOpenedCallBack()}e||this.onHidePopup(),this.ariaExpanded=e?"true":"false",this.question.processPopupVisiblilityChanged(this.popupModel,e)}setFilterStringToListModel(e){if(this.listModel.filterString=e,this.listModel.resetFocusedItem(),this.question.selectedItem&&this.question.selectedItem.text.indexOf(e)>=0){this.listModel.focusedItem=this.getAvailableItems().filter(t=>t.id==this.question.selectedItem.value)[0],this.listModel.filterString&&this.listModel.actions.map(t=>t.selectedValue=!1);return}(!this.listModel.focusedItem||!this.listModel.isItemVisible(this.listModel.focusedItem))&&this.listModel.focusFirstVisibleItem()}setTextWrapEnabled(e){this.listModel.textWrapEnabled=e}popupRecalculatePosition(e){setTimeout(()=>{this.popupModel.recalculatePosition(e)},1)}onHidePopup(){this.question.suggestedItem=null,this.choicesLazyLoadEnabled&&this.resetItemsSettings(),this.customValue=void 0,this.resetCustomItemValue()}getAvailableItems(){return this.allowCustomChoices?[].concat(this.question.visibleChoices,[this.customItemValue]):this.question.visibleChoices}setOnTextSearchCallbackForListModel(e){e.setOnTextSearchCallback((t,s)=>{if(t.id===this.customItemValue.id)return t.visible;if(this.filteredItems)return this.filteredItems.indexOf(t)>=0;let i=t.text.toLocaleLowerCase();i=D.comparator.normalizeTextCallback(i,"filter");const r=i.indexOf(s.toLocaleLowerCase());return this.question.searchMode=="startsWith"?r==0:r>-1})}createListModel(){const e=this.getAvailableItems();let t=this.onSelectionChanged;t||(t=r=>{this.setQuestionValue(r),this.popupModel.hide()});const s={items:e,onSelectionChanged:t,allowSelection:!1,locOwner:this.question,elementId:this.listElementId},i=new lt(s);return this.setOnTextSearchCallbackForListModel(i),i.renderElements=!1,i.forceShowFilter=this.question.choicesLazyLoadEnabled,i.areSameItemsCallback=(r,a)=>r===a,i}setQuestionValue(e){let t=e;this.allowCustomChoices&&e.id===this.customItemValue.id&&(t=this.createCustomItem()),t&&(this.resetFilterString(),this.question.selectItem(t),this.searchEnabled&&this.applyInputString(t))}createCustomItem(){const e=new fe(this.customValue),t={item:e,question:this.question,allow:!0};return this.question.survey.createCustomChoiceItem(t),t.allow?(this.question.customChoices.push(e),this.customValue=void 0,this.updateItems(),e):(this.clear(),null)}updateAfterListModelCreated(e){e.isItemSelected=t=>!!t.selected,e.isAllDataLoaded=!this.choicesLazyLoadEnabled,e.disableSearch=this.choicesLazyLoadEnabled,e.actions.forEach(t=>t.disableTabStop=!0),e.setOnFilterStringChangedCallback(this.listModelFilterStringChanged),e.setLoadingIndicatorVisibilityObserver(t=>{t&&this.updateQuestionChoices()})}getPopupCssClasses(){return"sv-single-select-list"}updateCssClasses(e,t){this.popupModel.cssClass=new j().append(e).append(this.getPopupCssClasses()).toString(),this.listModel.cssClasses=t}resetFilterString(){this.filterString&&(this.filterString=void 0,this.listModel.filterString=""),this.inputString=null,this.hintString=""}clear(){this.customValue=void 0,this.resetFilterString()}onSetFilterString(){if(this.filteredItems=void 0,!this.filterString&&!this.popupModel.isVisible)return;const e={question:this.question,choices:this.getAvailableItems(),filter:this.filterString,filteredChoices:void 0};this.question.survey.onChoicesSearch.fire(this.question.survey,e),this.filteredItems=e.filteredChoices,this.filterString&&!this.popupModel.isVisible&&this.popupModel.show();const t=()=>{this.setFilterStringToListModel(this.filterString),this.filterString&&this.applyHintString(),this.popupRecalculatePosition(!0)};this.choicesLazyLoadEnabled?(this.resetItemsSettings(),this.updateQuestionChoices(t)):t()}get isAllDataLoaded(){return!!this.itemsSettings.totalCount&&this.itemsSettings.items.length==this.itemsSettings.totalCount}loadQuestionChoices(e){this.isAllDataLoaded||this._loadQuestionChoices(e)}get canShowSelectedItem(){return!this.focused||this._markdownMode||!this.searchEnabled}get needRenderInput(){return!this.question.isInputReadOnly||!!this.placeholderRendered}updateCustomItemValue(){this.customValue?(this.customItemValue.text=this.getLocalizationFormatString("createCustomItem",this.customValue),this.customItemValue.visible=!0):this.resetCustomItemValue()}resetCustomItemValue(){this.customItemValue.text="",this.customItemValue.visible=!1}get customItemValue(){return this._customItemValue||(this._customItemValue=new fe("newCustomItem",this.getLocalizationFormatString("createCustomItem",this.customValue)),this._customItemValue.css="sv-list-item--custom-value"),this._customItemValue}applyInputString(e){e?.locText.hasHtml||this.question.inputFieldComponentName?(this._markdownMode=!0,this.inputString=this.cleanHtml(e?.locText.getHtmlValue()),this.hintString=""):(this.inputString=e?.title,this.hintString=e?.title)}cleanHtml(e){return this.htmlCleanerElement?(this.htmlCleanerElement.innerHTML=e,this.htmlCleanerElement.textContent):""}fixInputCase(){const e=this.hintStringMiddle;e&&this.inputString!=e&&(this.inputString=e)}applyHintString(){const e=this.listModel.focusedItem||this.question.selectedItem;e?.locText.hasHtml||this.question.inputFieldComponentName?(this._markdownMode=!0,this.hintString=""):e===this.customItemValue?this.hintString="":this.hintString=e?.title}get inputStringRendered(){return this.inputString||""}set inputStringRendered(e){var t;this.inputString=e,this.filterString=e,this.choicesLazyLoadEnabled||this.processCustomValue(),(!e||!this.searchEnabled||((t=this.listModel.focusedItem)===null||t===void 0?void 0:t.id)===this.customItemValue.id)&&(this.hintString="")}get placeholderRendered(){return this.hintString||this.question.readOnly||!this.question.isEmpty()?"":this.inputPlaceholder}get listElementId(){return this.question.inputId+"_list"}get hintStringLC(){var e;return((e=this.hintString)===null||e===void 0?void 0:e.toLowerCase())||""}get inputStringLC(){var e;return((e=this.inputString)===null||e===void 0?void 0:e.toLowerCase())||""}get showHintPrefix(){return!!this.inputString&&this.hintStringLC.indexOf(this.inputStringLC)>0}get hintStringPrefix(){return this.inputString?this.hintString.substring(0,this.hintStringLC.indexOf(this.inputStringLC)):null}get showHintString(){return!!this.searchEnabled&&!!(this.hintStringLC||this.inputStringLC)||!this.searchEnabled&&this.hintStringLC&&this.question.isEmpty()}get hintStringSuffix(){return this.hintStringLC.indexOf(this.inputStringLC)>=0?this.hintString.substring(this.hintStringLC.indexOf(this.inputStringLC)+this.inputStringLC.length):""}get hintStringMiddle(){const e=this.hintStringLC.indexOf(this.inputStringLC);return e==-1?null:this.hintString.substring(e,e+this.inputStringLC.length)}constructor(e,t){super(),this.question=e,this.onSelectionChanged=t,this.minPageSize=25,this.loadingItemHeight=40,this.timer=void 0,this._markdownMode=!1,this.filteredItems=void 0,this.selectedItemSelector=".sv-list__item--selected",this.itemSelector=".sv-list__item",this.itemsSettings={skip:0,take:0,totalCount:0,items:[]},this.listModelFilterStringChanged=i=>{this.filterString!==i&&(this.filterString=i,this.choicesLazyLoadEnabled||this.processCustomValue())},this.questionPropertyChangedHandler=(i,r)=>{this.onPropertyChangedHandler(i,r)},this.ariaExpanded="false",this.createLocalizableString("clearCaption",this.question,!1,!0),this.createLocalizableString("selectCaption",this.question,!1,!0),this.htmlCleanerElement=oe.createElement("div"),e.onPropertyChanged.add(this.questionPropertyChangedHandler),this.showInputFieldComponent=this.question.showInputFieldComponent,this.listModel=this.createListModel(),this.setChoicesLazyLoadEnabled(this.question.choicesLazyLoadEnabled),this.setInputPlaceholder(this.question.placeholder),this.updateAfterListModelCreated(this.listModel),this.setSearchEnabled(this.question.searchEnabled),this.setAllowCustomChoices(this.question.allowCustomChoices),this.setTextWrapEnabled(this.question.textWrapEnabled),this.createPopup(),this.createButtons(),this.resetItemsSettings();const s=e.cssClasses;this.updateCssClasses(s.popup,s.list)}get popupModel(){return this._popupModel}get clearCaption(){return this.getLocalizableStringText("clearCaption")}set clearCaption(e){this.setLocalizableStringText("clearCaption",e)}get locClearCaption(){return this.getLocalizableString("clearCaption")}get selectCaption(){return this.getLocalizableStringText("selectCaption")}set selectCaption(e){this.setLocalizableStringText("selectCaption",e)}get locSelectCaption(){return this.getLocalizableString("selectCaption")}get inputAvailable(){return this.searchEnabled||this.allowCustomChoices}get noTabIndex(){return this.question.isInputReadOnly||this.inputAvailable}get filterReadOnly(){return!this.filterStringEnabled||!this.focused}get filterStringEnabled(){return!this.question.isInputReadOnly&&this.inputAvailable}get inputMode(){return vt?"none":"text"}get popupEnabled(){return!this.question.isInputReadOnly}get ariaQuestionRole(){return this.filterStringEnabled?void 0:"combobox"}get ariaQuestionRequired(){return this.ariaQuestionRole?this.question.a11y_input_ariaRequired:void 0}get ariaQuestionInvalid(){return this.ariaQuestionRole?this.question.a11y_input_ariaInvalid:void 0}get ariaQuestionErrorMessage(){return this.ariaQuestionRole?this.question.a11y_input_ariaErrormessage:void 0}get ariaQuestionLabel(){return this.ariaQuestionRole?this.question.a11y_input_ariaLabel:void 0}get ariaQuestionLabelledby(){return this.ariaQuestionRole?this.question.a11y_input_ariaLabelledBy:void 0}get ariaQuestionDescribedby(){return this.ariaQuestionRole?this.question.a11y_input_ariaDescribedBy:void 0}get ariaQuestionControls(){return this.ariaQuestionRole&&this.popupEnabled?this.listElementId:void 0}get ariaQuestionExpanded(){return this.ariaQuestionRole?this.popupEnabled?this.ariaExpanded:"false":void 0}get ariaQuestionActivedescendant(){return this.ariaQuestionRole?this.ariaActivedescendant:void 0}get ariaInputRole(){return this.filterStringEnabled?"combobox":void 0}get ariaInputRequired(){return this.ariaInputRole?this.question.a11y_input_ariaRequired:void 0}get ariaInputInvalid(){return this.ariaInputRole?this.question.a11y_input_ariaInvalid:void 0}get ariaInputErrorMessage(){return this.ariaInputRole?this.question.a11y_input_ariaErrormessage:void 0}get ariaInputLabel(){return this.ariaInputRole?this.question.a11y_input_ariaLabel:void 0}get ariaInputLabelledby(){return this.ariaInputRole?this.question.a11y_input_ariaLabelledBy:void 0}get ariaInputDescribedby(){return this.ariaInputRole?this.question.a11y_input_ariaDescribedBy:void 0}get ariaInputControls(){return this.ariaInputRole&&this.popupEnabled?this.listElementId:void 0}get ariaInputExpanded(){return this.ariaInputRole?this.popupEnabled?this.ariaExpanded:"false":void 0}get ariaInputActivedescendant(){return this.ariaInputRole?this.ariaActivedescendant:void 0}setSearchEnabled(e){this.listModel.setSearchEnabled(vt&&(e||this.question.allowCustomChoices)),this.searchEnabled=e}setAllowCustomChoices(e){this.allowCustomChoices=e,e&&(this.searchEnabled=e)}setChoicesLazyLoadEnabled(e){this.choicesLazyLoadEnabled=e,this.listModel.disableSearch=e,this.listModel.isAllDataLoaded=!e}setInputPlaceholder(e){this.inputPlaceholder=e}updateItems(){this.listModel.setItems(this.getAvailableItems())}onClick(e){this.question.readOnly||this.question.isDesignMode||this.question.isPreviewStyle||this.question.isReadOnlyAttr||(this._popupModel.toggleVisibility(),this.focusItemOnClickAndPopup(),this.question.focusInputElement(!1))}chevronPointerDown(e){this._popupModel.isVisible&&e.preventDefault()}onPropertyChangedHandler(e,t){t.name=="value"&&(this.showInputFieldComponent=this.question.showInputFieldComponent),t.name=="textWrapEnabled"&&this.setTextWrapEnabled(t.newValue)}focusItemOnClickAndPopup(){this._popupModel.isVisible&&this.question.value&&this.changeSelectionWithKeyboard(!1)}onClear(e){this.question.clearValueFromUI(),this._popupModel.hide(),e&&(e.preventDefault(),e.stopPropagation())}getSelectedAction(){return this.question.selectedItem||null}changeSelectionWithKeyboard(e){var t;let s=this.listModel.focusedItem;!s&&this.question.selectedItem?fe.getItemByValue(this.question.visibleChoices,this.question.value)&&(this.listModel.focusedItem=this.question.selectedItem):e?this.listModel.focusPrevVisibleItem():this.listModel.focusNextVisibleItem(),this.beforeScrollToFocusedItem(s),this.scrollToFocusedItem(),this.afterScrollToFocusedItem(),this.ariaActivedescendant=(t=this.listModel.focusedItem)===null||t===void 0?void 0:t.elementId}beforeScrollToFocusedItem(e){this.question.value&&e&&(e.selectedValue=!1,this.listModel.focusedItem.selectedValue=!this.listModel.filterString,this.question.suggestedItem=this.listModel.focusedItem)}afterScrollToFocusedItem(){var e;this.question.value&&!this.listModel.filterString&&this.searchEnabled?this.applyInputString(this.listModel.focusedItem||this.question.selectedItem):this.applyHintString(),this.fixInputCase(),this.ariaActivedescendant=(e=this.listModel.focusedItem)===null||e===void 0?void 0:e.elementId}keyHandler(e){let t=!1;const s=e.which||e.keyCode;if(this.popupModel.isVisible&&e.keyCode===38)this.changeSelectionWithKeyboard(!0),t=!0;else if(e.keyCode===40)this.popupModel.show(),this.changeSelectionWithKeyboard(!1),t=!0;else if(!this.popupModel.isVisible&&e.keyCode===32)this.popupModel.show(),this.changeSelectionWithKeyboard(!1),t=!0;else if(!this.popupModel.isVisible&&e.keyCode===13)this.question.survey.questionEditFinishCallback(this.question,e),t=!0;else if(this.popupModel.isVisible&&(e.keyCode===13||e.keyCode===32&&(!this.searchEnabled||!this.inputString)))e.keyCode===13&&this.searchEnabled&&!this.inputString&&this.question instanceof hs&&!this._markdownMode&&this.question.value?(this._popupModel.hide(),this.onClear(e)):(this.listModel.selectFocusedItem(),this.onFocus(e)),t=!0;else if(s===46||s===8)this.inputAvailable||this.onClear(e);else if(e.keyCode===27)this._popupModel.hide(),this.hintString="",this.onEscape();else{if((e.keyCode===38||e.keyCode===40||e.keyCode===32&&!this.searchEnabled)&&(t=!0),e.keyCode===32&&this.searchEnabled)return;Id(e,{processEsc:!1,disableTabStop:this.question.isInputReadOnly})}t&&(e.preventDefault(),e.stopPropagation())}onEscape(){this.searchEnabled&&this.applyInputString(this.question.selectedItem)}onScroll(e){const t=e.target;t.scrollHeight-(t.scrollTop+t.offsetHeight)<=this.loadingItemHeight&&this.updateQuestionChoices()}onBlur(e){this.checkFocusRemainsWithinComponent(e)||(this.focused=!1,!(this.popupModel.isVisible&&this.popupModel.displayMode=="overlay")&&(y1(e),this._popupModel.hide(),this.resetFilterString(),e.stopPropagation()))}onFocus(e){this.focused=!0,this.setInputStringFromSelectedItem(this.question.selectedItem)}setInputStringFromSelectedItem(e){this.focused&&this.searchEnabled&&e&&this.applyInputString(e)}dispose(){super.dispose(),this.question&&this.question.onPropertyChanged.remove(this.questionPropertyChangedHandler),this.questionPropertyChangedHandler=void 0,this.listModel&&this.listModel.dispose(),this.popupModel&&this.popupModel.dispose(),this.htmlCleanerElement=void 0}scrollToFocusedItem(){this.listModel.scrollToFocusedItem()}}I([R({defaultValue:!1})],Wt.prototype,"focused",void 0),I([R({defaultValue:!1})],Wt.prototype,"allowCustomChoices",void 0),I([R({onSet:(n,e)=>{e.updateCustomItemValue()}})],Wt.prototype,"customValue",void 0),I([R({defaultValue:!0})],Wt.prototype,"searchEnabled",void 0),I([R()],Wt.prototype,"choicesLazyLoadEnabled",void 0),I([R({defaultValue:"",onSet:(n,e)=>{e.onSetFilterString()}})],Wt.prototype,"filterString",void 0),I([R({defaultValue:"",onSet:(n,e)=>{e.question.inputHasValue=!!n}})],Wt.prototype,"inputString",void 0),I([R({})],Wt.prototype,"showInputFieldComponent",void 0),I([R()],Wt.prototype,"ariaActivedescendant",void 0),I([R()],Wt.prototype,"ariaExpanded",void 0),I([R()],Wt.prototype,"inputPlaceholder",void 0),I([R({defaultValue:""})],Wt.prototype,"hintString",void 0);class hs extends Nd{constructor(e){super(e),this.lastSelectedItemValue=null,this.minMaxChoices=[],this.onOpened=this.addEvent(),this.createLocString({name:"placeholder",hasTranslation:!0}),this.createLocalizableString("readOnlyText",this,!0),this.registerPropertyChangedHandlers(["choicesMin","choicesMax","choicesStep"],()=>{this.onVisibleChoicesChanged()}),this.registerPropertyChangedHandlers(["value","renderAs","showOtherItem","otherText","placeholder","choices","visibleChoices"],()=>{this.getSingleSelectedItem(),this.updateReadOnlyText()}),this.updateReadOnlyText()}locStrsChanged(){super.locStrsChanged(),this.updateReadOnlyText(),this.updateInputPlaceholder(this.placeholder)}updateReadOnlyText(){this.readOnlyText=this.calculateReadOnlyText()}onSelectedItemValuesUpdated(){super.onSelectedItemValuesUpdated(),this.updateReadOnlyText()}updateInputPlaceholder(e){this.dropdownListModelValue&&this.dropdownListModel.setInputPlaceholder(e)}get showOptionsCaption(){return this.allowClear}set showOptionsCaption(e){this.allowClear=e}get showClearButton(){return this.allowClear&&!this.isEmpty()}get optionsCaption(){return this.placeholder}set optionsCaption(e){this.placeholder=e}get placeholder(){return this.getLocalizableStringText("placeholder")}set placeholder(e){this.setLocalizableStringText("placeholder",e),this.updateInputPlaceholder(e)}get locPlaceholder(){return this.getLocalizableString("placeholder")}getType(){return"dropdown"}get isNewA11yStructure(){return!0}get a11yQuestionAriaRole(){return this.searchEnabled?null:"combobox"}get a11yInputAriaRole(){return this.searchEnabled?"combobox":null}get selectedItem(){return this.getSingleSelectedItem()}isOtherValueUnused(){var e;return!(!((e=this.selectedItem)===null||e===void 0)&&e.showCommentArea)}onGetSingleSelectedItem(e){e&&(this.lastSelectedItemValue=e)}get isShowingChoiceComment(){var e;return(e=this.selectedItem)===null||e===void 0?void 0:e.showCommentArea}supportAutoAdvance(){return!this.isShowingChoiceComment}getChoices(){var e=super.getChoices();if(this.choicesMax<=this.choicesMin)return e;for(var t=[],s=0;s<e.length;s++)t.push(e[s]);if(this.minMaxChoices.length===0||this.minMaxChoices.length!==(this.choicesMax-this.choicesMin)/this.choicesStep+1){this.minMaxChoices=[];for(var s=this.choicesMin;s<=this.choicesMax;s+=this.choicesStep)this.minMaxChoices.push(this.createItemValue(s))}return t=t.concat(this.minMaxChoices),t}get choicesMin(){return this.getPropertyValue("choicesMin")}set choicesMin(e){this.setPropertyValue("choicesMin",e)}get choicesMax(){return this.getPropertyValue("choicesMax")}set choicesMax(e){this.setPropertyValue("choicesMax",e)}get choicesStep(){return this.getPropertyValue("choicesStep")}set choicesStep(e){e<1&&(e=1),this.setPropertyValue("choicesStep",e)}get autocomplete(){return this.getPropertyValue("autocomplete")}set autocomplete(e){this.setPropertyValue("autocomplete",e)}get readOnlyText(){return this.getLocalizableStringText("readOnlyText")}set readOnlyText(e){this.setLocalizableStringText("readOnlyText",e)}get locReadOnlyText(){return this.getLocalizableString("readOnlyText")}calculateReadOnlyText(){if(!this.useDropdownList){if(this.isOtherSelected)return this.otherText;if(this.isNoneSelected)return this.noneText;if(this.selectedItem)return this.selectedItemText}return this.selectedItem?this.selectedItemText:this.placeholder}getControlClass(){return new j().append(this.cssClasses.control).append(this.cssClasses.controlEmpty,this.isEmpty()).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle).append(this.cssClasses.controlInputFieldComponent,!!this.inputFieldComponentName).toString()}updateCssClasses(e,t){super.updateCssClasses(e,t),this.useDropdownList&&Xo(e,t)}calcCssClasses(e){const t=super.calcCssClasses(e);return this.dropdownListModelValue&&this.dropdownListModel.updateCssClasses(t.popup,t.list),t}get selectedItemLocText(){const e=this.suggestedItem||this.selectedItem;return e?.locText}get inputFieldComponentName(){return this.inputFieldComponent||this.itemComponent}get showSelectedItemLocText(){return!this.inputHasValue&&!this.inputFieldComponentName&&!!this.selectedItemLocText&&this.dropdownListModel.canShowSelectedItem}get showInputFieldComponent(){return!this.inputHasValue&&!!this.inputFieldComponentName&&!this.isEmpty()}get selectedItemText(){const e=this.selectedItem;return e?e.text:""}get useDropdownList(){return this.renderAs!=="select"}get dropdownListModel(){return!this.isDisposed&&this.useDropdownList&&!this.dropdownListModelValue&&(this.dropdownListModelValue=new Wt(this)),this.dropdownListModelValue}set dropdownListModel(e){this.dropdownListModelValue=e}get popupModel(){return this.dropdownListModel.popupModel}onOpenedCallBack(){this.onOpened.fire(this,{question:this,choices:this.choices})}onSelectedItemValuesChangedHandler(e){var t;(t=this.dropdownListModelValue)===null||t===void 0||t.setInputStringFromSelectedItem(e),super.onSelectedItemValuesChangedHandler(e)}hasUnknownValue(e,t,s,i){return this.choicesLazyLoadEnabled?!1:super.hasUnknownValue(e,t,s,i)}needConvertRenderedOtherToDataValue(){var e;const t=(e=this.otherValue)===null||e===void 0?void 0:e.trim();return t?super.hasUnknownValue(t,!0,!1):!1}getItemIfChoicesNotContainThisValue(e,t){return this.choicesLazyLoadEnabled?this.createItemValue(e,t):super.getItemIfChoicesNotContainThisValue(e,t)}onVisibleChoicesChanged(){super.onVisibleChoicesChanged(),this.dropdownListModelValue&&this.dropdownListModel.updateItems()}canAddCustomChoices(){return this.allowCustomChoices}getIsQuestionReady(){return super.getIsQuestionReady()&&!this.isChoicesLoading}ensureQuestionIsReady(){super.ensureQuestionIsReady(),this.dropdownListModel&&this.choicesLazyLoadEnabled&&this.dropdownListModel.loadQuestionChoices()}onLoadChoicesFromUrl(e){this.updateCustomChoices(this.value,e),super.onLoadChoicesFromUrl(e)}valueFromData(e){const t=super.valueFromData(e);return this.survey&&this.survey.isSettingData()&&this.updateCustomChoices(t,this.visibleChoices),t}updateCustomChoices(e,t){e!=null&&this.allowCustomChoices&&!this.choicesLazyLoadEnabled&&(this.customChoices.splice(0,this.customChoices.length),t.filter(i=>L.isTwoValueEquals(i.id,e,!1,!1))[0]||this.customChoices.splice(0,this.customChoices.length,new fe(e)))}setIsChoicesLoading(e){this.isChoicesLoading=e,this.updateIsReady()}getFirstInputElementId(){return this.getInputIdCore(this.searchEnabled||this.allowCustomChoices)}getInputId(){return this.getInputIdCore(!0)}getInputIdCore(e){const t=e&&this.useDropdownList?"_0":"";return this.inputId+t}clearValue(e,t){var s;super.clearValue(e,t),this.lastSelectedItemValue=null,(s=this.dropdownListModelValue)===null||s===void 0||s.clear()}afterRenderCore(e){super.afterRenderCore(e),this.dropdownListModelValue&&this.dropdownListModelValue.clear()}onClick(e){this.onOpenedCallBack&&this.onOpenedCallBack()}onKeyUp(e){(e.which||e.keyCode)===46&&(this.clearValueFromUI(),e.preventDefault(),e.stopPropagation())}supportEmptyValidation(){return!0}onBlurCore(e){this.dropdownListModel.onBlur(e),super.onBlurCore(e)}onFocusCore(e){this.dropdownListModel.onFocus(e),super.onFocusCore(e)}dispose(){super.dispose(),this.dropdownListModelValue&&(this.dropdownListModelValue.dispose(),this.dropdownListModelValue=void 0)}}I([R()],hs.prototype,"allowClear",void 0),I([R({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setSearchEnabled(n)}})],hs.prototype,"searchEnabled",void 0),I([R()],hs.prototype,"searchMode",void 0),I([R({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setAllowCustomChoices(n)}})],hs.prototype,"allowCustomChoices",void 0),I([R()],hs.prototype,"textWrapEnabled",void 0),I([R({defaultValue:!1})],hs.prototype,"inputHasValue",void 0),I([R({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setChoicesLazyLoadEnabled(n)}})],hs.prototype,"choicesLazyLoadEnabled",void 0),I([R()],hs.prototype,"choicesLazyLoadPageSize",void 0),I([R()],hs.prototype,"suggestedItem",void 0),B.addClass("dropdown",[{name:"placeholder",alternativeName:"optionsCaption",serializationProperty:"locPlaceholder"},{name:"allowClear:boolean",alternativeName:"showOptionsCaption",default:!0},{name:"choicesMin:number",default:0},{name:"choicesMax:number",default:0},{name:"choicesStep:number",default:1,minValue:1},{name:"autocomplete",alternativeName:"autoComplete",choices:D.questions.dataList},{name:"textWrapEnabled:boolean",default:!0},{name:"renderAs",default:"default",visible:!1},{name:"searchEnabled:boolean",default:!0,visible:!1},{name:"allowCustomChoices:boolean",default:!1,visibleIf:n=>!n.choicesFromQuestion,dependsOn:"choicesFromQuestion"},{name:"searchMode",default:"contains",choices:["contains","startsWith"]},{name:"choicesLazyLoadEnabled:boolean",default:!1,visible:!1},{name:"choicesLazyLoadPageSize:number",default:25,visible:!1},{name:"inputFieldComponent",visible:!1},{name:"itemComponent",visible:!1,default:""}],function(){return new hs("")},"selectbase"),Qe.Instance.registerQuestion("dropdown",n=>{var e=new hs(n);return e.choices=Qe.DefaultChoices,e});class P_{constructor(e){this.row=e}getValue(e,t,s,i){if(e.length===0)return{isFound:!0,value:this.row.value,context:this}}getTextValue(e,t,s){return s?this.row.getDisplayValue(t):t}}class z1 extends fe{getBaseType(){return"matrixcolumn"}get isExclusive(){return this.getPropertyValue("isExclusive",!1)}set isExclusive(e){this.setPropertyValue("isExclusive",e)}}class S_ extends de{constructor(e,t,s,i){super(),this.item=e,this.fullName=t,this.data=s,this.setValueDirectly(i),this.registerPropertyChangedHandlers(["value"],()=>{this.data.onMatrixRowChanged(this)}),this.data.hasErrorInRow(this)&&(this.hasError=!0)}cellClick(e){this.data.cellClick(this,e)}isChecked(e){return this.data.isCellChecked(this,e)}get name(){return this.item.value}get text(){return this.item.text}get locText(){return this.item.locText}get isVisible(){return this.item.isVisible}get value(){return this.getPropertyValue("value")}set value(e){this.isReadOnly||this.setValueDirectly(this.data.getCorrectedRowValue(e))}setValueDirectly(e){this.setPropertyValue("value",e)}getDisplayValue(e){return this.data.getDisplayRowValue(e)}get isReadOnly(){return!this.item.enabled||this.data.isInputReadOnly}get isReadOnlyAttr(){return this.data.isReadOnlyAttr}get isDisabledAttr(){return!this.item.enabled||this.data.isDisabledAttr}get rowTextClasses(){return new j().append(this.data.cssClasses.rowTextCell).toString()}get hasError(){return this.getPropertyValue("hasError",!1)}set hasError(e){this.setPropertyValue("hasError",e)}get rowClasses(){const e=this.data.cssClasses;return new j().append(e.row).append(e.rowError,this.hasError).append(e.rowReadOnly,this.isReadOnly).append(e.rowDisabled,this.data.isDisabledStyle).toString()}getValueGetterContext(){return new P_(this)}}class I_ extends de{constructor(e){super(),this.cellsOwner=e,this.values={},this.locs={}}getType(){return"cells"}get isEmpty(){return Object.keys(this.values).length==0}valuesChanged(){!this.locNotification&&this.onValuesChanged&&this.onValuesChanged()}getDefaultCellLocText(e){return this.getCellLocCore(this.defaultRowValue,e)}getCellDisplayLocText(e,t){return this.getCellLocCore(e,t)}getCellLocCore(e,t){if(e=this.getCellRowColumnValue(e,this.rows),t=this.getCellRowColumnValue(t,this.columns),L.isValueEmpty(e)||L.isValueEmpty(t))return null;this.locs[e]||(this.locs[e]={});let s=this.locs[e][t];return s||(s=this.createString(),s.setJson(this.getCellLocData(e,t)),s.onGetTextCallback=i=>{if(!i){const r=fe.getItemByValue(this.columns,t);if(r)return r.locText.getJson()||r.value}return i},s.onStrChanged=(i,r)=>{this.updateValues(e,t,r)},this.locs[e][t]=s),s}get defaultRowValue(){return D.matrix.defaultRowName}getCellLocData(e,t){let s=this.getCellLocDataFromValue(e,t);return s||this.getCellLocDataFromValue(this.defaultRowValue,t)}getCellLocDataFromValue(e,t){return!this.values[e]||!this.values[e][t]?null:this.values[e][t]}getCellText(e,t){var s=this.getCellLocCore(e,t);return s?s.calculatedText:null}setCellText(e,t,s){const i=this.getCellLocCore(e,t);i&&(i.text=s)}updateValues(e,t,s){s?(this.values[e]||(this.values[e]={}),this.values[e][t]=s,this.valuesChanged()):this.values[e]&&this.values[e][t]&&(delete this.values[e][t],Object.keys(this.values[e]).length==0&&delete this.values[e],this.valuesChanged())}getDefaultCellText(e){var t=this.getCellLocCore(this.defaultRowValue,e);return t?t.calculatedText:null}setDefaultCellText(e,t){this.setCellText(this.defaultRowValue,e,t)}getCellDisplayText(e,t){var s=this.getCellDisplayLocText(e,t);return s?s.calculatedText:null}get rows(){return this.cellsOwner?this.cellsOwner.getRows():[]}get columns(){return this.cellsOwner?this.cellsOwner.getColumns():[]}getCellRowColumnValue(e,t){if(e==null)return null;if(typeof e=="number"){if(e<0||e>=t.length)return null;e=t[e].value}return e.value?e.value:e}getJson(){if(this.isEmpty)return null;const e=this.values[this.defaultRowValue],t={};for(let s in this.values){const i={},r=this.values[s];for(let a in r)if(s===this.defaultRowValue||!e||e[a]!==r[a]){const o=this.getCellLocCore(s,a);i[a]=o?o.getJson():r[a]}t[s]=i}return t}setJson(e,t){if(this.values={},e){for(var s in e)if(s!="pos"){var i=e[s];this.values[s]={};for(var r in i)r!="pos"&&(this.values[s][r]=i[r])}}this.locNotification=!0,this.runFuncOnLocs((a,o,l)=>l.setJson(this.getCellLocData(a,o))),this.locNotification=!1,this.valuesChanged()}locStrsChanged(){this.runFuncOnLocs((e,t,s)=>s.strChanged())}runFuncOnLocs(e){for(let t in this.locs){const s=this.locs[t];for(let i in s)e(t,i,s[i])}}createString(){return new wt(this.cellsOwner,!0)}}class T_ extends Zi{constructor(e){super(),this.question=e}getValue(e,t,s,i){if(e.length>0){const r=super.getValue(e,t,s,i);if(r&&r.isFound)return r}return new ws(this.question.value).getValue(e,t,s,i)}getRootObj(){return this.question.data}updateValueByItem(e,t){var s;const i=this.question.getMatrixRows();e=e.toLocaleLowerCase();for(let r=0;r<i.length;r++){const a=i[r];if((((s=a.name)===null||s===void 0?void 0:s.toString())||"").toLocaleLowerCase()===e){t.isFound=!0,t.context=a.getValueGetterContext();return}}}}class j1 extends rl{constructor(e){super(e),this.isRowChanging=!1,this.emptyLocalizableString=new wt(this),this.cellsValue=new I_(this),this.cellsValue.onValuesChanged=()=>{this.updateHasCellText(),this.propertyValueChanged("cells",this.cells,this.cells)},this.registerPropertyChangedHandlers(["columns"],()=>{this.onColumnsChanged()}),this.registerPropertyChangedHandlers(["rows"],()=>{this.runCondition(this.getDataFilteredProperties()),this.onRowsChanged()}),this.registerPropertyChangedHandlers(["hideIfRowsEmpty"],()=>{this.updateVisibilityBasedOnRows()}),this.registerPropertyChangedHandlers(["cellType"],()=>{this.value=this.convertToCorrectValue(this.value)})}getType(){return"matrix"}get cellType(){return this.getPropertyValue("cellType")}set cellType(e){e!=="checkbox"&&(e="radio"),this.setPropertyValue("cellType",e)}get isMultiSelect(){return this.cellType==="checkbox"}get cellComponent(){return this.getPropertyValue("cellComponent")}set itemComponent(e){this.setPropertyValue("cellComponent",e)}get hasSingleInput(){return!1}get eachRowRequired(){return this.getPropertyValue("eachRowRequired")}set eachRowRequired(e){this.setPropertyValue("eachRowRequired",e)}get isAllRowRequired(){return this.eachRowRequired}set isAllRowRequired(e){this.eachRowRequired=e}get eachRowUnique(){return this.getPropertyValue("eachRowUnique")}set eachRowUnique(e){this.setPropertyValue("eachRowUnique",e)}get hasRows(){return this.rows.length>0}get rowOrder(){return this.getPropertyValue("rowOrder")}set rowOrder(e){e=e.toLowerCase(),e!=this.rowOrder&&(this.setPropertyValue("rowOrder",e),this.onRowsChanged())}get rowsOrder(){return this.rowOrder}set rowsOrder(e){this.rowOrder=e}get hideIfRowsEmpty(){return this.getPropertyValue("hideIfRowsEmpty")}set hideIfRowsEmpty(e){this.setPropertyValue("hideIfRowsEmpty",e)}getRows(){return this.rows}getColumns(){return this.visibleColumns}addColumn(e,t){var s=new z1(e,t);return this.columns.push(s),s}get checkType(){return this.isMultiSelect?"checkbox":"radio"}formatCss(e){return(e||"").replace("{type}",this.checkType)}getItemClass(e,t){const s=e.isChecked(t),i=this.isReadOnly,r=!s&&!i,a=this.hasCellText,o=this.cssClasses;return new j().append(o.cell,a).append(a?o.cellText:this.formatCss(o.label)).append(o.itemOnError,!a&&(this.eachRowRequired||this.eachRowUnique?e.hasError:this.hasCssError())).append(a?o.cellTextSelected:this.formatCss(o.itemChecked),s).append(a?o.cellTextDisabled:this.formatCss(o.itemDisabled),this.isDisabledStyle).append(a?o.cellTextReadOnly:this.formatCss(o.itemReadOnly),this.isReadOnlyStyle).append(a?o.cellTextPreview:this.formatCss(o.itemPreview),this.isPreviewStyle).append(this.formatCss(o.itemHover),r&&!a).toString()}get itemSvgIcon(){return this.isPreviewStyle&&this.cssClasses.itemPreviewSvgIconId?this.cssClasses.itemPreviewSvgIconId:this.cssClasses.itemSvgIconId}getItemSvgIcon(e,t){return this.isMultiSelect&&e.isChecked(t)?this.cssClasses.itemPreviewSvgIconId:this.itemSvgIcon}get cssItemValue(){return this.formatCss(this.cssClasses.itemValue)}get cssMaterialDecorator(){return this.formatCss(this.cssClasses.materialDecorator)}get cssItemDecorator(){return this.formatCss(this.cssClasses.itemDecorator)}locStrsChanged(){super.locStrsChanged(),this.cells.locStrsChanged()}getQuizQuestionCount(){for(var e=0,t=0;t<this.rows.length;t++)this.isValueEmpty(this.correctAnswer[this.rows[t].value])||e++;return e}convertToCorrectValue(e){if(e==null||typeof e!="object")return e;const t=Object.keys(e);for(let s=0;s<t.length;s++){const i=t[s],r=e[i];Array.isArray(r)&&!this.isMultiSelect&&(r.length>0?e[i]=r[0]:delete e[i]),!Array.isArray(r)&&this.isMultiSelect&&(e[i]=[r])}return e}getCorrectAnswerCount(){for(var e=0,t=this.value,s=0;s<this.rows.length;s++){var i=this.rows[s].value;!this.isValueEmpty(t[i])&&this.isTwoValueEquals(this.correctAnswer[i],t[i])&&e++}return e}runConditionCore(e){fe.runEnabledConditionsForItems(this.rows,void 0,e),super.runConditionCore(e)}createRowsVisibleIfRunner(){const e=this.getExpressionFromSurvey("rowsVisibleIf");return e?new Gs(e):null}onRowsChanged(){this.clearGeneratedRows(),super.onRowsChanged()}getMatrixRows(){if(this.generatedVisibleRows)return this.generatedVisibleRows;const e=new Array;let t=this.value;t||(t={});const s=this.rows;for(let i=0;i<s.length;i++){const r=s[i];if(this.isValueEmpty(r.value))continue;const a=this.id+"_"+r.value.toString().replace(/\s/g,"_");e.push(this.createMatrixRow(r,a,t[r.value]))}return this.generatedVisibleRows=e,e}getVisibleRows(){const e=[];return this.getMatrixRows().forEach(t=>{t.isVisible&&e.push(t)}),e}getRowByName(e){const t=this.visibleRows;for(let s=0;s<t.length;s++)if(t[s].name===e)return t[s];return null}getSingleInputQuestionsCore(e,t){if(this.nestedQuestionsValue)return this.nestedQuestionsValue;const s=[],i=this.isMultiSelect?"checkbox":"radiogroup";return this.visibleRows.forEach(r=>{const a=B.createClass(i);a.name=r.name,a.locTitle.sharedData=r.locText,a.choices=this.visibleColumns,a.value=r.value,a.isRequired=this.eachRowRequired,a.setSurveyImpl(this),a.setParentQuestion(this),s.push(a)}),this.nestedQuestionsValue=s,s}resetSingleInput(){super.resetSingleInput(),this.nestedQuestionsValue&&(this.nestedQuestionsValue.forEach(e=>e.dispose()),this.nestedQuestionsValue=null)}getSurveyData(){return this}getTextProcessor(){var e;return(e=this.surveyImpl)===null||e===void 0?void 0:e.getTextProcessor()}getValue(e){const t=this.getRowByName(e);return t?t.value:void 0}setValue(e,t,s,i,r){this.getRowByName(e).value=t}getVariable(e){var t;return(t=this.data)===null||t===void 0?void 0:t.getVariable(e)}setVariable(e,t){var s;(s=this.data)===null||s===void 0||s.setVariable(e,t)}getComment(e){var t;return(t=this.data)===null||t===void 0?void 0:t.getComment(e)}setComment(e,t,s){var i;(i=this.data)===null||i===void 0||i.setComment(e,t,s)}getAllValues(){var e;return(e=this.data)===null||e===void 0?void 0:e.getAllValues()}getFilteredProperties(){var e;return(e=this.data)===null||e===void 0?void 0:e.getFilteredProperties()}findQuestionByName(e){var t;return(t=this.data)===null||t===void 0?void 0:t.findQuestionByName(e)}getEditingSurveyElement(){var e;return(e=this.data)===null||e===void 0?void 0:e.getEditingSurveyElement()}sortVisibleRows(e){if(this.survey&&this.survey.isDesignMode)return e;var t=this.rowOrder.toLowerCase();return t==="random"?L.randomizeArray(e):e}endLoadingFromJson(){super.endLoadingFromJson(),this.rows=this.sortVisibleRows(this.rows),this.onRowsChanged(),this.onColumnsChanged()}isNewValueCorrect(e){return L.isValueObject(e,!0)}processRowsOnSet(e){return this.sortVisibleRows(e)}get visibleRows(){return this.getVisibleRows()}get cells(){return this.cellsValue}set cells(e){this.cells.setJson(e&&e.getJson?e.getJson():null)}get hasCellText(){return this.getPropertyValue("hasCellText",!1)}updateHasCellText(){this.setPropertyValue("hasCellText",!this.cells.isEmpty)}setCellText(e,t,s){this.cells.setCellText(e,t,s)}getCellText(e,t){return this.cells.getCellText(e,t)}setDefaultCellText(e,t){this.cells.setDefaultCellText(e,t)}getDefaultCellText(e){return this.cells.getDefaultCellText(e)}getCellDisplayText(e,t){return this.cells.getCellDisplayText(e,t)}getCellDisplayLocText(e,t){var s=this.cells.getCellDisplayLocText(e,t);return s||this.emptyLocalizableString}supportAutoAdvance(){return this.isMouseDown===!0&&this.hasValuesInAllRows()}onCheckForErrors(e,t,s){if(super.onCheckForErrors(e,t,s),!t||this.hasCssError()){const i={noValue:!1,isNotUnique:!1};this.checkErrorsAllRows(s,i),i.noValue&&e.push(new NR(null,this)),i.isNotUnique&&e.push(new qR(null,this))}}hasValuesInAllRows(){const e={noValue:!1,isNotUnique:!1};return this.checkErrorsAllRows(!1,e,!0),!e.noValue}checkErrorsAllRows(e,t,s){const i=this.eachRowRequired||s,r=this.eachRowUnique;if(t.noValue=!1,t.isNotUnique=!1,e&&(this.errorsInRow=void 0),!i&&!r)return;const a=this.visibleRows;if(!a)return;const o={};for(var l=0;l<a.length;l++){const u=a[l].value;let d=this.isValueEmpty(u);const h=r&&!d&&o[u]===!0;d=d&&i,e&&(d||h)&&this.addErrorIntoRow(a[l]),d||(o[u]=!0),t.noValue=t.noValue||d,t.isNotUnique=t.isNotUnique||h}e&&a.forEach(u=>{u.hasError=this.hasErrorInRow(u)})}addErrorIntoRow(e){this.errorsInRow||(this.errorsInRow={}),this.errorsInRow[e.name]=!0,e.hasError=!0}refreshRowsErrors(){this.errorsInRow&&this.checkErrorsAllRows(!0,{noValue:!1,isNotUnique:!1})}getIsAnswered(){return super.getIsAnswered()&&this.hasValuesInAllRows()}createMatrixRow(e,t,s){var i=new S_(e,t,this,s);return this.onMatrixRowCreated(i),i}onMatrixRowCreated(e){}setQuestionValue(e,t=!0){if(super.setQuestionValue(e,this.isRowChanging||t),!(!this.generatedVisibleRows||this.generatedVisibleRows.length==0)){this.isRowChanging=!0;var s=this.value;if(s||(s={}),this.rows.length==0)this.generatedVisibleRows[0].setValueDirectly(s);else for(var i=0;i<this.generatedVisibleRows.length;i++){var r=this.generatedVisibleRows[i],a=s[r.name];this.isValueEmpty(a)&&(a=null),this.generatedVisibleRows[i].setValueDirectly(a)}this.refreshRowsErrors(),this.updateIsAnswered(),this.isRowChanging=!1}}getValueGetterContext(){return new T_(this)}getDisplayValueCore(e,t){var s={};for(var i in t){var r=e?fe.getTextOrHtmlByValue(this.rows,i):i;r||(r=i);var a=fe.getTextOrHtmlByValue(this.columns,t[i]);a||(a=t[i]),s[r]=a}return s}getPlainData(e={includeEmpty:!0}){var t=super.getPlainData(e);if(t){var s=this.createValueCopy();t.isNode=!0,t.data=Object.keys(s||{}).map(i=>{var r=this.rows.filter(l=>l.value===i)[0],a={name:i,title:r?r.text:"row",value:s[i],displayValue:fe.getTextOrHtmlByValue(this.visibleColumns,s[i]),getString:l=>typeof l=="object"?JSON.stringify(l):l,isNode:!1},o=fe.getItemByValue(this.visibleColumns,s[i]);return o&&(e.calculations||[]).forEach(l=>{a[l.propertyName]=o[l.propertyName]}),a})}return t}addConditionObjectsByContext(e,t){for(var s=0;s<this.rows.length;s++){var i=this.rows[s];i.value&&e.push({name:this.getValueName()+"."+i.value,text:this.processedTitle+"."+i.calculatedText,question:this})}}getConditionJson(e=null,t=null){if(!t)return super.getConditionJson(e);var s=new hs(t);s.choices=this.columns;var i=new rt().toJsonObject(s);return i.type=s.getType(),i}clearIncorrectValues(){this.clearInvisibleValuesInRowsAndColumns(!0,!0,!0),super.clearIncorrectValues()}clearValueIfInvisibleCore(e){super.clearValueIfInvisibleCore(e),this.clearInvisibleValuesInRowsAndColumns(!0,!0,!1)}clearInvisibleColumnValues(){this.clearInvisibleValuesInRowsAndColumns(!1,!0,!1)}clearInvisibleValuesInRows(){this.clearInvisibleValuesInRowsAndColumns(!0,!1,!1)}clearInvisibleValuesInRowsAndColumns(e,t,s){if(this.isEmpty())return;let i=this.getUnbindValue(this.value);const r={},a=this.rows;for(let o=0;o<a.length;o++){const l=a[o].value;i[l]&&(e&&!a[o].isVisible?delete i[l]:(t&&this.clearIncorrectValuesInRow(l,i),i[l]!=null&&(r[l]=i[l])))}s&&(i=r),!this.isTwoValueEquals(i,this.value)&&(this.value=i)}clearIncorrectValuesInRow(e,t){const s=t[e];if(s===void 0){delete t[e];return}if(this.isMultiSelect&&Array.isArray(s)){for(let i=s.length-1;i>=0;i--)this.getVisibleColumnByValue(s[i])||s.splice(i,1);s.length===0&&delete t[e]}else this.getVisibleColumnByValue(s)||delete t[e]}getVisibleColumnByValue(e){const t=fe.getItemByValue(this.columns,e);return t&&t.isVisible?t:null}getFirstInputElementId(){var e=this.generatedVisibleRows;return e||(e=this.visibleRows),e.length>0&&this.visibleColumns.length>0?this.inputId+"_"+e[0].name+"_0":super.getFirstInputElementId()}onMatrixRowChanged(e){if(!this.isRowChanging){if(this.isRowChanging=!0,!this.hasRows)this.setNewValue(e.value);else{const t=this.value||{};this.isValueEmpty(e.value)?delete t[e.name]:t[e.name]=e.value,this.setNewValue(t)}this.isRowChanging=!1}}getCorrectedRowValue(e){const t=this.getColumnByValue(e);return t?t.value:e}getDisplayRowValue(e){const t=this.getColumnByValue(e);return t?t.text:e!=null?e.toString():""}cellClick(e,t){this.isReadOnly||this.isDisabledAttr||(e.value=this.getValueOnCellClick(e,t))}getValueOnCellClick(e,t){if(this.isMultiSelect){if(t.isExclusive)return this.isCellChecked(e,t)?void 0:[t.value];let s=Array.isArray(e.value)?[].concat(e.value):[];if(this.isCellChecked(e,t)){const i=this.getRowValueIndex(e,t);i>-1&&s.splice(i,1),s.length===0&&(s=void 0)}else Array.isArray(s)||(s=[]),this.columns.forEach(i=>{if(i.isExclusive){const r=s.indexOf(i.value);r>-1&&s.splice(r,1)}}),s.push(t.value);return s}return t.value}isCellChecked(e,t){return this.isMultiSelect?this.getRowValueIndex(e,t)>-1:L.isTwoValueEquals(e.value,t.value)}getRowValueIndex(e,t){const s=e.value;if(!Array.isArray(s))return-1;for(let i=0;i<s.length;i++)if(this.isTwoValueEquals(s[i],t.value))return i;return-1}getColumnByValue(e){const t=this.columns;for(var s=0;s<t.length;s++)if(e===t[s].value)return t[s];for(var s=0;s<t.length;s++)if(this.isTwoValueEquals(e,t[s].value))return t[s];return null}hasErrorInRow(e){return!!this.errorsInRow&&!!this.errorsInRow[e.name]}getSearchableItemValueKeys(e){e.push("columns"),e.push("rows")}get SurveyModel(){return this.survey}getColumnHeaderWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName({column:e},"column-header")}getColumnHeaderWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData({column:e},"column-header")}getRowHeaderWrapperComponentName(e){return this.SurveyModel.getElementWrapperComponentName({row:e},"row-header")}getRowHeaderWrapperComponentData(e){return this.SurveyModel.getElementWrapperComponentData({row:e},"row-header")}}B.addClass("matrixcolumn",[{name:"isExclusive:boolean",visibleIf:n=>{var e;return((e=n.locOwner)===null||e===void 0?void 0:e.cellType)==="checkbox"},locationInTable:"detail"}],n=>new z1(n),"itemvalue"),B.addClass("matrix",["rowTitleWidth",{name:"columns:matrixcolumn[]",uniqueProperty:"value",baseValue:function(){return bt("matrix_column")}},{name:"rows:itemvalue[]",uniqueProperty:"value",baseValue:function(){return bt("matrix_row")}},{name:"cells:cells",serializationProperty:"cells"},{name:"rowOrder",alternativeName:"rowsOrder",default:"initial",choices:["initial","random"]},{name:"eachRowRequired:boolean",alternativeName:"isAllRowRequired"},{name:"eachRowUnique:boolean",category:"validation"},"hideIfRowsEmpty:boolean",{name:"cellComponent",visible:!1,default:"survey-matrix-cell"},{name:"cellType",default:"radio",choices:["radio","checkbox"]}],function(){return new j1("")},"matrixbase"),Qe.Instance.registerQuestion("matrix",n=>{var e=new j1(n);return e.rows=Qe.DefaultRows,e.columns=Qe.DefaultColums,e});class U1 extends de{updateRemainingCharacterCounter(e,t){this.remainingCharacterCounter=L.getRemainingCharacterCounterText(e,t)}}I([R()],U1.prototype,"remainingCharacterCounter",void 0);class cl extends kt{constructor(e){super(e),this.characterCounter=new U1}isTextValue(){return!0}get maxLength(){return this.getPropertyValue("maxLength")}set maxLength(e){this.setPropertyValue("maxLength",e),this.updateRemainingCharacterCounter(this.value)}getMaxLength(){return L.getMaxLength(this.maxLength,this.survey?this.survey.maxTextLength:-1)}updateRemainingCharacterCounter(e){this.characterCounter.updateRemainingCharacterCounter(e,this.getMaxLength())}get placeHolder(){return this.placeholder}set placeHolder(e){this.placeholder=e}get locPlaceHolder(){return this.locPlaceholder}getType(){return"textbase"}isEmpty(){return super.isEmpty()||this.value===""}get textUpdateMode(){return this.getPropertyValue("textUpdateMode")}set textUpdateMode(e){this.setPropertyValue("textUpdateMode",e)}getIsInputTextUpdate(){return this.textUpdateMode=="default"?super.getIsInputTextUpdate():this.textUpdateMode=="onTyping"}get renderedPlaceholder(){const e=()=>this.hasPlaceholder()?this.placeHolder:void 0;return this.getPropertyValue("renderedPlaceholder",void 0,e)}onReadOnlyChanged(){super.onReadOnlyChanged(),this.resetRenderedPlaceholder()}localeChanged(){super.localeChanged(),this.resetRenderedPlaceholder()}supportEmptyValidation(){return!0}resetRenderedPlaceholder(){this.resetPropertyValue("renderedPlaceholder")}hasPlaceholder(){return!this.isReadOnly}setNewValue(e){super.setNewValue(e),this.updateRemainingCharacterCounter(e)}setQuestionValue(e,t=!0){super.setQuestionValue(e,t),this.updateRemainingCharacterCounter(e)}convertToCorrectValue(e){return Array.isArray(e)?e.join(this.getValueSeparator()):e}getValueSeparator(){return", "}getControlCssClassBuilder(){return new j().append(this.cssClasses.root).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle)}getControlClass(){return this.getControlCssClassBuilder().toString()}get isNewA11yStructure(){return!0}}I([R({localizable:!0,onSet:(n,e)=>e.resetRenderedPlaceholder()})],cl.prototype,"placeholder",void 0),B.addClass("textbase",[],function(){return new cl("")},"question");class E_{setInputValue(e){this.inputElement.maxLength>=0&&this.inputElement.maxLength<e.length&&(e=e.slice(0,this.inputElement.maxLength)),this.inputElement.value=e}constructor(e,t,s){this.inputMaskInstance=e,this.inputElement=t,this.prevUnmaskedValue=void 0,this.inputMaskInstancePropertyChangedHandler=(r,a)=>{if(a.name!=="saveMaskedValue"){const o=this.inputMaskInstance.getMaskedValue(this.prevUnmaskedValue);this.setInputValue(o)}},this.clickHandler=r=>{this.inputElement.value==this.inputMaskInstance.getMaskedValue("")&&this.inputElement.setSelectionRange(0,0)},this.beforeInputHandler=r=>{const a=this.createArgs(r),o=this.inputMaskInstance.processInput(a);this.setInputValue(o.value),this.inputElement.setSelectionRange(o.caretPosition,o.caretPosition),o.cancelPreventDefault||r.preventDefault()},this.changeHandler=r=>{const a=this.inputMaskInstance.processInput({prevValue:"",insertedChars:r.target.value,selectionStart:0,selectionEnd:0});this.setInputValue(a.value)};let i=s;i==null&&(i=""),this.setInputValue(e.saveMaskedValue?i:e.getMaskedValue(i)),this.prevUnmaskedValue=i,e.onPropertyChanged.add(this.inputMaskInstancePropertyChangedHandler),this.addInputEventListener()}createArgs(e){const t={insertedChars:e.data,selectionStart:e.target.selectionStart,selectionEnd:e.target.selectionEnd,prevValue:e.target.value,inputDirection:"forward"};return e.inputType==="deleteContentBackward"&&(t.inputDirection="backward",t.selectionStart===t.selectionEnd&&(t.selectionStart=Math.max(t.selectionStart-1,0))),e.inputType==="deleteContentForward"&&t.selectionStart===t.selectionEnd&&(t.selectionEnd+=1),t}addInputEventListener(){this.inputElement&&(this.inputElement.addEventListener("beforeinput",this.beforeInputHandler),this.inputElement.addEventListener("click",this.clickHandler),this.inputElement.addEventListener("focus",this.clickHandler),this.inputElement.addEventListener("change",this.changeHandler))}removeInputEventListener(){this.inputElement&&(this.inputElement.removeEventListener("beforeinput",this.beforeInputHandler),this.inputElement.removeEventListener("click",this.clickHandler),this.inputElement.removeEventListener("focus",this.clickHandler),this.inputElement.removeEventListener("change",this.changeHandler))}dispose(){this.removeInputEventListener(),this.inputElement=void 0,this.inputMaskInstance.onPropertyChanged.remove(this.inputMaskInstancePropertyChangedHandler)}}var Bd=/[0-9]/;function W1(){const e=(B.getChildrenClasses("masksettings")||[]).map(t=>{let s=t.name;return t.name.indexOf("mask")!==-1&&(s=s.slice(0,s.indexOf("mask"))),s});return e.unshift("none"),e}class Hr extends cl{createMaskAdapter(){this.input&&!this.maskTypeIsEmpty&&(this.maskInputAdapter=new E_(this.maskInstance,this.input,this.value))}deleteMaskAdapter(){this.maskInputAdapter&&(this.maskInputAdapter.dispose(),this.maskInputAdapter=void 0)}updateMaskAdapter(){this.deleteMaskAdapter(),this.createMaskAdapter()}onSetMaskType(e){this.setNewMaskSettingsProperty(),this.updateMaskAdapter()}get maskTypeIsEmpty(){switch(this.inputType){case"tel":case"text":return this.maskType==="none";default:return!0}}get maskSettings(){return this.getPropertyValue("maskSettings")}set maskSettings(e){if(!e)return;const t=this.maskSettings;t&&t.dispose(),this.setNewMaskSettingsProperty(),this.maskSettings.fromJSON(e.toJSON()),this.updateMaskAdapter()}setNewMaskSettingsProperty(){this.setPropertyValue("maskSettings",this.createMaskSettings())}createMaskSettings(){let e=!this.maskType||this.maskType==="none"?"masksettings":this.maskType+"mask";B.findClass(e)||(e="masksettings");const t=B.createClass(e);return t.onPropertyChanged.add((s,i)=>{this.onNestedPropertyChanged.fire(this,{name:"maskSettings",newValue:i.newValue,nestedName:i.name}),this.updateInputValue()}),t.owner=this,t}constructor(e){super(e),this._isWaitingForEnter=!1,this.onCompositionUpdate=t=>{this.isInputTextUpdate&&setTimeout(()=>{this.updateValueOnEvent(t)},1),this.updateRemainingCharacterCounter(t.target.value)},this.onKeyUp=t=>{this.updateDateValidationMessage(t),this.isInputTextUpdate?(!this._isWaitingForEnter||t.keyCode===13)&&(this.updateValueOnEvent(t),this._isWaitingForEnter=!1):t.keyCode===13&&this.updateValueOnEvent(t),this.updateRemainingCharacterCounter(t.target.value)},this.readOnlyBlocker=t=>{if(this.isReadOnlyAttr&&["color","range"].indexOf(this.inputType)>-1)return t.preventDefault(),!0},this.onKeyDown=t=>{this.readOnlyBlocker(t)||(this.onKeyDownPreprocess&&this.onKeyDownPreprocess(t),this.isInputTextUpdate&&(this._isWaitingForEnter=t.keyCode===229),this.onTextKeyDownHandler(t))},this.onChange=t=>{this.updateDateValidationMessage(t),t.target===D.environment.root.activeElement?this.isInputTextUpdate&&this.updateValueOnEvent(t):this.updateValueOnEvent(t),this.updateRemainingCharacterCounter(t.target.value)},this.createLocalizableString("minErrorText",this,!0,"minError"),this.createLocalizableString("maxErrorText",this,!0,"maxError"),this.setNewMaskSettingsProperty(),this.locDataListValue=new dR(this),this.locDataListValue.onValueChanged=(t,s)=>{this.propertyValueChanged("dataList",t,s)},this.registerPropertyChangedHandlers(["min","max","inputType","minValueExpression","maxValueExpression"],()=>{this.setRenderedMinMax()}),this.registerPropertyChangedHandlers(["inputType","inputSize"],()=>{this.resetInputSize(),this.resetRenderedPlaceholder()})}isTextValue(){return this.isDateInputType||["text","number","password"].indexOf(this.inputType)>-1}getType(){return"text"}onSurveyLoad(){super.onSurveyLoad(),this.setRenderedMinMax()}get inputType(){return this.getPropertyValue("inputType")}set inputType(e){e=e.toLowerCase(),(e==="datetime_local"||e==="datetime")&&(e="datetime-local"),this.setPropertyValue("inputType",e.toLowerCase()),this.isLoadingFromJson||(this.min=void 0,this.max=void 0,this.step=void 0),this.updateMaskAdapter()}getMaxLength(){return this.isTextInput?super.getMaxLength():null}getSupportedValidators(){const e={},t=["text","email","tel","password","url"];e.text=t,e.regex=t,e.email=["email"],e.numeric=["number","range"];const s=super.getSupportedValidators();for(let i=s.length-1;i>=0;i--){const r=s[i];e[r]&&e[r].indexOf(this.inputType)<0&&s.splice(i,1)}return s}runConditionCore(e){super.runConditionCore(e),(this.minValueExpression||this.maxValueExpression)&&this.setRenderedMinMax(e)}getDisplayValueCore(e,t){return!this.maskTypeIsEmpty&&!L.isValueEmpty(t)?this.maskInstance.getMaskedValue(t):super.getDisplayValueCore(e,t)}isLayoutTypeSupported(e){return!0}get inputSize(){return this.getPropertyValue("inputSize")}set inputSize(e){this.setPropertyValue("inputSize",e)}get size(){return this.inputSize}set size(e){this.inputSize=e}get isTextInput(){return["text","search","tel","url","email","password"].indexOf(this.inputType)>-1}get renderedInputSize(){return this.getPropertyValue("renderedInputSize",void 0,()=>{const e=this.calInputSize();return e>0?e:void 0})}get inputWidth(){return this.getPropertyValue("inputWidth",void 0,()=>this.calInputSize()>0?"auto":"")}calInputSize(){if(!this.isTextInput)return 0;let e=this.inputSize>0?this.inputSize:0;return e<1&&this.parent&&this.parent.inputSize&&(e=this.parent.inputSize),e}resetInputSize(){this.resetPropertyValue("renderedInputSize"),this.resetPropertyValue("inputWidth")}get autocomplete(){return this.getPropertyValue("autocomplete")}set autocomplete(e){this.setPropertyValue("autocomplete",e)}get min(){return this.getPropertyValue("min")}set min(e){if(this.isValueExpression(e)){this.minValueExpression=e.substring(1);return}this.setPropertyValue("min",e)}get max(){return this.getPropertyValue("max")}set max(e){if(this.isValueExpression(e)){this.maxValueExpression=e.substring(1);return}this.setPropertyValue("max",e)}get minValueExpression(){return this.getPropertyValue("minValueExpression","")}set minValueExpression(e){this.setPropertyValue("minValueExpression",e)}get maxValueExpression(){return this.getPropertyValue("maxValueExpression","")}set maxValueExpression(e){this.setPropertyValue("maxValueExpression",e)}get renderedMin(){return this.getPropertyValue("renderedMin")}get renderedMax(){return this.getPropertyValue("renderedMax")}get minErrorText(){return this.getLocalizableStringText("minErrorText")}set minErrorText(e){this.setLocalizableStringText("minErrorText",e)}get locMinErrorText(){return this.getLocalizableString("minErrorText")}get maxErrorText(){return this.getLocalizableStringText("maxErrorText")}set maxErrorText(e){this.setLocalizableStringText("maxErrorText",e)}get locMaxErrorText(){return this.getLocalizableString("maxErrorText")}get isMinMaxType(){return Ks(this)}get maskInstance(){return this.maskSettings}get inputValue(){return!this._inputValue&&!this.maskTypeIsEmpty?this.maskInstance.getMaskedValue(""):this._inputValue}set inputValue(e){let t=e;this._inputValue=e,this.maskTypeIsEmpty||(t=this.maskInstance.getUnmaskedValue(e),this._inputValue=this.maskInstance.getMaskedValue(t),t&&this.maskSettings.saveMaskedValue&&(t=this._inputValue)),L.isTwoValueEquals(this.value,t,!1,!0)||(this.value=t)}getFilteredValue(){return this.getExpressionValue(this.value)}getExpressionValue(e){return!this.maskTypeIsEmpty&&this.maskSettings.saveMaskedValue?this.maskInstance.getUnmaskedValue(e):e}convertToCorrectValue(e){return e!=null&&typeof e!="string"&&!this.maskTypeIsEmpty&&this.maskSettings.saveMaskedValue?this.maskInstance.getMaskedValue(e):super.convertToCorrectValue(e)}onChangeQuestionValue(e){super.onChangeQuestionValue(e),this.updateInputValue()}updateInputValue(){const e=this.value;this.maskTypeIsEmpty?this._inputValue=e:this.maskSettings.saveMaskedValue?this._inputValue=e??this.maskInstance.getMaskedValue(""):this._inputValue=this.maskInstance.getMaskedValue(e)}hasToConvertToUTC(e){return D.storeUtcDates&&this.isDateTimeLocaleType()&&!!e}createDate(e){return Ot("question-text",e)}valueForSurveyCore(e){return this.hasToConvertToUTC(e)&&(e=this.createDate(e).toISOString()),super.valueForSurveyCore(e)}valueFromDataCore(e){if(this.hasToConvertToUTC(e)){const t=this.createDate(e);let i=this.createDate(t.getTime()-t.getTimezoneOffset()*60*1e3).toISOString();e=i.substring(0,i.length-2)}return super.valueFromDataCore(e)}onCheckForErrors(e,t,s){super.onCheckForErrors(e,t,s);const i=this.getIsInputTextUpdate();if(!(t&&i)){if(!this.isOnValueChanged){if(this.isValueLessMin){const r=new Ps(this.getMinMaxErrorText(this.minErrorText,this.getCalculatedMinMax(this.renderedMin)),this);r.onUpdateErrorTextCallback=a=>{a.text=this.getMinMaxErrorText(this.minErrorText,this.getCalculatedMinMax(this.renderedMin))},e.push(r)}if(this.isValueGreaterMax){const r=new Ps(this.getMinMaxErrorText(this.maxErrorText,this.getCalculatedMinMax(this.renderedMax)),this);r.onUpdateErrorTextCallback=a=>{a.text=this.getMinMaxErrorText(this.maxErrorText,this.getCalculatedMinMax(this.renderedMax))},e.push(r)}this.isStepNumberIncorrect&&e.push(new Ps(this.getStepErrorText(),this)),e.length===0&&this.dateValidationMessage&&e.push(new Ps(this.dateValidationMessage,this))}if(this.inputType==="email"&&!this.validators.some(r=>r.getType()==="emailvalidator")){const r=this.getValidatorTitle(),a=new P1;a.errorOwner=this;const o=a.validate(this.value,r);o&&o.error&&e.push(o.error)}}}canSetValueToSurvey(){if(!this.isMinMaxType)return!0;const e=!this.isValueLessMin&&!this.isValueGreaterMax;return(!e||this.errors.length>0)&&this.survey&&(this.survey.isValidateOnValueChanging||this.survey.isValidateOnValueChanged)&&this.validate(),e}convertFuncValuetoQuestionValue(e){let t=this.maskTypeIsEmpty?this.inputType:this.maskSettings.getTypeForExpressions();return L.convertValToQuestionVal(e,t)}getMinMaxErrorText(e,t){if(L.isValueEmpty(t))return e;let s=t.toString();return this.inputType==="date"&&t.toDateString&&(s=t.toDateString()),e.replace("{0}",s)}getStepErrorText(){return this.getLocalizationString("stepError").replace("{0}",this.renderedStep)}get isValueLessMin(){return!this.isValueEmpty(this.renderedMin)&&!this.isEmpty()&&this.getCalculatedMinMax(this.value)<this.getCalculatedMinMax(this.renderedMin)}get isValueGreaterMax(){return!this.isValueEmpty(this.renderedMax)&&!this.isEmpty()&&this.getCalculatedMinMax(this.value)>this.getCalculatedMinMax(this.renderedMax)}get isStepNumberIncorrect(){if(this.inputType!=="number"||this.isEmpty()||!L.isNumber(this.renderedStep)||!L.isNumber(this.value))return!1;let e=L.getNumber(this.value),t=L.getNumber(this.renderedStep),s=1;for(;Math.round(t*s)/s!==t&&s<1e6;)s*=10;return e=e*s,t=t*s,t>0&&e%t!==0}get isDateInputType(){return this.inputType==="date"||this.isDateTimeLocaleType()}isDateTimeLocaleType(){return this.inputType==="datetime-local"}getCalculatedMinMax(e){return this.isValueEmpty(e)?e:this.isDateInputType?this.createDate(e):e}setRenderedMinMax(e=null){const t=(r,a)=>{this.setPropertyValue(r,this.convertFuncValuetoQuestionValue(a))},s=r=>{!r&&this.isDateInputType&&D.minDate&&(r=D.minDate),t("renderedMin",r)},i=r=>{!r&&this.isDateInputType&&(r=D.maxDate),t("renderedMax",r)};this.runExpressionByProperty("minValueExpression",e,r=>{s(r)})||s(this.min),this.runExpressionByProperty("maxValueExpression",e,r=>{i(r)})||i(this.max)}get step(){return this.getPropertyValue("step")}set step(e){this.setPropertyValue("step",e)}get renderedStep(){return this.isValueEmpty(this.step)?this.inputType!=="number"?void 0:"any":this.step}getIsInputTextUpdate(){return this.maskTypeIsEmpty?super.getIsInputTextUpdate():!1}supportAutoAdvance(){return!this.getIsInputTextUpdate()&&!this.isDateInputType}supportGoNextPageError(){return!this.isDateInputType}get dataList(){return this.locDataList.value}set dataList(e){this.locDataList.value=e}get locDataList(){return this.locDataListValue}get dataListId(){return this.locDataList.hasValue()?this.id+"_datalist":void 0}setNewValue(e){e=this.correctValueType(e),e&&(this.dateValidationMessage=void 0),super.setNewValue(e)}correctValueType(e){if(!e)return e;if(this.inputType==="number"||this.inputType==="range")return L.isNumber(e)?L.getNumber(e):"";if(this.inputType==="month"){const t=this.createDate(e),s=t.toISOString().indexOf(e)==0&&e.indexOf("T")==-1,i=s?t.getUTCMonth():t.getMonth(),r=s?t.getUTCFullYear():t.getFullYear(),a=i+1;return r+"-"+(a<10?"0":"")+a}return e}hasPlaceholder(){return!this.isReadOnly&&this.inputType!=="range"}getControlCssClassBuilder(){const e=this.getMaxLength();return super.getControlCssClassBuilder().append(this.cssClasses.constrolWithCharacterCounter,!!e).append(this.cssClasses.characterCounterBig,e>99)}isReadOnlyRenderDiv(){return this.isReadOnly&&D.readOnly.textRenderMode==="div"}get inputStyle(){var e={};return e.width=this.inputWidth,this.updateTextAlign(e),e}updateTextAlign(e){this.inputTextAlignment!=="auto"?e.textAlign=this.inputTextAlignment:!this.maskTypeIsEmpty&&this.maskSettings.getTextAlignment()!=="auto"&&(e.textAlign=this.maskSettings.getTextAlignment())}updateValueOnEvent(e){const t=e.target.value;this.isTwoValueEquals(this.value,t)||(this.inputValue=t)}updateDateValidationMessage(e){this.dateValidationMessage=this.isDateInputType&&e.target?e.target.validationMessage:void 0}onBlurCore(e){this.updateDateValidationMessage(e),this.updateValueOnEvent(e),this.updateRemainingCharacterCounter(e.target.value),super.onBlurCore(e)}onFocusCore(e){this.updateRemainingCharacterCounter(e.target.value),super.onFocusCore(e)}afterRenderQuestionElement(e){e&&(this.input=e instanceof HTMLInputElement?e:e.querySelector("input"),this.createMaskAdapter()),super.afterRenderQuestionElement(e)}beforeDestroyQuestionElement(e){this.deleteMaskAdapter(),this.input=void 0}}I([R({onSet:(n,e)=>{e.onSetMaskType(n)}})],Hr.prototype,"maskType",void 0),I([R()],Hr.prototype,"inputTextAlignment",void 0),I([R()],Hr.prototype,"_inputValue",void 0);const R_=["number","range","date","datetime-local","month","time","week"];function Ks(n){const e=n?n.inputType:"";return e?R_.indexOf(e)>-1:!1}function $1(n,e){const t=n.split(e);return t.length!==2||!L.isNumber(t[0])||!L.isNumber(t[1])?-1:parseFloat(t[0])*60+parseFloat(t[1])}function __(n,e,t){const s=$1(n,t),i=$1(e,t);return s<0||i<0?!1:s>i}function G1(n,e,t,s){let i=s?t:e;if(!Ks(n)||L.isValueEmpty(e)||L.isValueEmpty(t))return i;if(n.inputType.indexOf("date")===0||n.inputType==="month"){const r=n.inputType==="month",a="question-text-minmax",o=Ot(a,r?e+"-01":e),l=Ot(a,r?t+"-01":t);if(!o||!l)return i;if(o>l)return s?e:t}if(n.inputType==="week"||n.inputType==="time"){const r=n.inputType==="week"?"-W":":";return __(e,t,r)?s?e:t:i}if(n.inputType==="number"){if(!L.isNumber(e)||!L.isNumber(t))return i;if(L.getNumber(e)>L.getNumber(t))return s?e:t}return typeof e=="string"||typeof t=="string"?i:e>t?s?e:t:i}function J1(n,e){n&&n.inputType&&(e.inputType=n.inputType!=="range"?n.inputType:"number",e.textUpdateMode="onBlur")}B.addClass("text",[{name:"inputType",default:"text",choices:D.questions.inputTypes},{name:"inputSize:number",alternativeName:"size",minValue:0,dependsOn:"inputType",visibleIf:function(n){return n?n.isTextInput:!1}},{name:"textUpdateMode",default:"default",choices:["default","onBlur","onTyping"],dependsOn:"inputType",visibleIf:function(n){return n?n.isTextInput:!1}},{name:"autocomplete",alternativeName:"autoComplete",choices:D.questions.dataList},{name:"min",dependsOn:"inputType",visibleIf:function(n){return Ks(n)},onPropertyEditorUpdate:function(n,e){J1(n,e)},onSettingValue:(n,e)=>G1(n,e,n.max,!1)},{name:"max",dependsOn:"inputType",nextToProperty:"*min",visibleIf:function(n){return Ks(n)},onSettingValue:(n,e)=>G1(n,n.min,e,!0),onPropertyEditorUpdate:function(n,e){J1(n,e)}},{name:"minValueExpression:expression",category:"logic",dependsOn:"inputType",visibleIf:function(n){return Ks(n)}},{name:"maxValueExpression:expression",category:"logic",dependsOn:"inputType",visibleIf:function(n){return Ks(n)}},{name:"minErrorText",serializationProperty:"locMinErrorText",dependsOn:"inputType",visibleIf:function(n){return Ks(n)}},{name:"maxErrorText",serializationProperty:"locMaxErrorText",dependsOn:"inputType",visibleIf:function(n){return Ks(n)}},{name:"inputTextAlignment",default:"auto",choices:["left","right","auto"]},{name:"maskType",default:"none",visibleIndex:0,dependsOn:"inputType",visibleIf:n=>n.inputType==="text"||n.inputType==="tel",choices:n=>W1()},{name:"maskSettings:masksettings",className:"masksettings",visibleIndex:1,dependsOn:["inputType","maskType"],visibleIf:n=>n.inputType==="text"||n.inputType==="tel",onGetValue:function(n){return n.maskSettings.getData()},onSetValue:function(n,e){n.maskSettings.setData(e)}},{name:"step:number",dependsOn:"inputType",visibleIf:function(n){return n?n.inputType==="number"||n.inputType==="range":!1}},{name:"maxLength:number",default:-1,dependsOn:"inputType",visibleIf:function(n){return n?n.isTextInput:!1}},{name:"placeholder",alternativeName:"placeHolder",serializationProperty:"locPlaceholder",dependsOn:"inputType",visibleIf:function(n){return n?n.isTextInput:!1}},{name:"dataList:string[]",serializationProperty:"locDataList",dependsOn:"inputType",visibleIf:function(n){return n?n.inputType==="text":!1}}],function(){return new Hr("")},"textbase"),Qe.Instance.registerQuestion("text",n=>new Hr(n));class L_ extends Zi{constructor(e){super(),this.question=e}getRootObj(){return this.question.data}updateValueByItem(e,t){const s=this.question.items;for(let i=0;i<s.length;i++){const r=s[i].question;if(r.getValueName()===e){t.isFound=!0,t.context=r.getValueGetterContext();return}}}}class A_ extends Hr{get a11y_input_ariaLabel(){return this.locTitle.renderedHtml}get a11y_input_ariaLabelledBy(){return null}get a11y_input_ariaDescribedBy(){return null}}class K1 extends de{constructor(e=null,t=null){super(),this.focusIn=()=>{this.editor.focusIn()},this.editorValue=this.createEditor(e),this.maskSettings=this.editorValue.maskSettings,this.editor.questionTitleTemplateCallback=function(){return""},this.editor.titleLocation="left",t&&(this.title=t),this.editor.onPropertyChanged.add((s,i)=>{i.name!=="maskSettings"&&this.onPropertyChanged.fire(this,i)})}getType(){return"multipletextitem"}get id(){return this.editor.id}getOriginalObj(){return this.editor}get name(){return this.editor.name}set name(e){this.editor.name=e}get question(){return this.data}get editor(){return this.editorValue}createEditor(e){return new A_(e)}addUsedLocales(e){super.addUsedLocales(e),this.editor.addUsedLocales(e)}localeChanged(){super.localeChanged(),this.editor.localeChanged()}locStrsChanged(){super.locStrsChanged(),this.editor.locStrsChanged()}setData(e){this.data=e,e&&(this.editor.defaultValue=e.getItemDefaultValue(this.name),this.editor.setSurveyImpl(this),this.editor.parent=e,this.editor.setParentQuestion(e))}get isRequired(){return this.editor.isRequired}set isRequired(e){this.editor.isRequired=e}get inputType(){return this.editor.inputType}set inputType(e){this.editor.inputType=e}get title(){return this.editor.title}set title(e){this.editor.title=e}get locTitle(){return this.editor.locTitle}get fullTitle(){return this.editor.fullTitle}get maxLength(){return this.editor.maxLength}set maxLength(e){this.editor.maxLength=e}getMaxLength(){var e=this.getSurvey();return L.getMaxLength(this.maxLength,e?e.maxTextLength:-1)}get placeholder(){return this.editor.placeholder}set placeholder(e){this.editor.placeholder=e}get locPlaceholder(){return this.editor.locPlaceholder}get placeHolder(){return this.placeholder}set placeHolder(e){this.placeholder=e}get locPlaceHolder(){return this.locPlaceholder}get requiredErrorText(){return this.editor.requiredErrorText}set requiredErrorText(e){this.editor.requiredErrorText=e}get locRequiredErrorText(){return this.editor.locRequiredErrorText}get inputSize(){return this.editor.inputSize}set inputSize(e){this.editor.inputSize=e}get size(){return this.inputSize}set size(e){this.inputSize=e}get defaultValueExpression(){return this.editor.defaultValueExpression}set defaultValueExpression(e){this.editor.defaultValueExpression=e}get minValueExpression(){return this.editor.minValueExpression}set minValueExpression(e){this.editor.minValueExpression=e}get maxValueExpression(){return this.editor.maxValueExpression}set maxValueExpression(e){this.editor.maxValueExpression=e}get validators(){return this.editor.validators}set validators(e){this.editor.validators=e}getValidators(){return this.validators}get maskType(){return this.editor.maskType}set maskType(e){this.editor.maskType=e,this.maskSettings=this.editor.maskSettings}get maskSettings(){return this.getPropertyValue("maskSettings")}set maskSettings(e){this.setPropertyValue("maskSettings",e),this.editor.maskSettings!==e&&(this.editor.maskSettings=e)}get inputTextAlignment(){return this.editor.inputTextAlignment}set inputTextAlignment(e){this.editor.inputTextAlignment=e}get value(){return this.data?this.data.getMultipleTextValue(this.name):null}set value(e){this.data!=null&&this.data.setMultipleTextValue(this.name,e)}isEmpty(){return this.editor.isEmpty()}onValueChanged(e){this.valueChangedCallback&&this.valueChangedCallback(e)}getSurveyData(){return this}getSurvey(){return this.data?this.data.getSurvey():null}getTextProcessor(){return this.data?this.data.getTextProcessor():null}getValue(e){return this.data?this.data.getMultipleTextValue(e):null}setValue(e,t){this.data&&this.data.setMultipleTextValue(e,t)}getVariable(e){}setVariable(e,t){}getComment(e){return null}setComment(e,t){}getAllValues(){return this.data?this.data.getAllValues():this.value}getFilteredProperties(){return{survey:this.getSurvey()}}findQuestionByName(e){const t=this.getSurvey();return t?t.getQuestionByName(e):null}getEditingSurveyElement(){}getValidatorTitle(){return this.title}get validatedValue(){return this.value}set validatedValue(e){this.value=e}getDataFilteredProperties(){return this.getFilteredProperties()}}class pl extends kt{static addDefaultItems(e){for(var t=Qe.DefaultMutlipleTextItems,s=0;s<t.length;s++)e.addItem(t[s])}constructor(e){super(e),this.isMultipleItemValueChanging=!1,this.createNewArray("items",t=>{t.setData(this),this.survey&&this.survey.multipleTextItemAdded(this,t)}),this.registerPropertyChangedHandlers(["items","colCount","itemErrorLocation"],()=>{this.calcVisibleRows()}),this.registerPropertyChangedHandlers(["inputSize"],()=>{this.resetItemsSize()})}getType(){return"multipletext"}setSurveyImpl(e,t){super.setSurveyImpl(e,t);for(var s=0;s<this.items.length;s++)this.items[s].setData(this)}get isAllowTitleLeft(){return!1}get isContainer(){return!0}onSurveyLoad(){this.editorsOnSurveyLoad(),super.onSurveyLoad(),L.isValueEmpty(this.rows)||this.calcVisibleRows()}setQuestionValue(e,t=!0){super.setQuestionValue(e,t),this.performForEveryEditor(s=>{s.editor.updateValueFromSurvey(s.value)}),this.updateIsAnswered()}onSurveyValueChanged(e){super.onSurveyValueChanged(e),this.performForEveryEditor(t=>{t.editor.onSurveyValueChanged(t.value)})}resetItemsSize(){this.performForEveryEditor(e=>{e.editor.resetInputSize()})}editorsOnSurveyLoad(){this.performForEveryEditor(e=>{e.editor.onSurveyLoad()})}performForEveryEditor(e){for(var t=0;t<this.items.length;t++){var s=this.items[t];s.editor&&e(s)}}get items(){return this.getPropertyValue("items")}set items(e){this.setPropertyValue("items",e)}addItem(e,t=null){var s=this.createTextItem(e,t);return this.items.push(s),s}getItemByName(e){for(var t=0;t<this.items.length;t++)if(this.items[t].name==e)return this.items[t];return null}getElementsInDesign(e=!1){let t;return t=super.getElementsInDesign(e),t.concat(this.items)}addConditionObjectsByContext(e,t){for(var s=0;s<this.items.length;s++){var i=this.items[s];e.push({name:this.getValueName()+"."+i.name,text:this.processedTitle+"."+i.fullTitle,question:this})}}collectNestedQuestionsCore(e,t,s,i){i&&e.push(this),this.items.forEach(r=>r.editor.addNestedQuestion(e,t,s,i))}getConditionJson(e=null,t=null){if(!t)return super.getConditionJson(e);var s=this.getItemByName(t);if(!s)return null;var i=new rt().toJsonObject(s);return i.type="text",i}locStrsChanged(){super.locStrsChanged();for(var e=0;e<this.items.length;e++)this.items[e].locStrsChanged()}localeChanged(){super.localeChanged();for(var e=0;e<this.items.length;e++)this.items[e].localeChanged()}get itemErrorLocation(){return this.getPropertyValue("itemErrorLocation")}set itemErrorLocation(e){this.setPropertyValue("itemErrorLocation",e)}getQuestionErrorLocation(){return this.itemErrorLocation!=="default"?this.itemErrorLocation:this.getErrorLocation()}get showItemErrorOnTop(){return this.getQuestionErrorLocation()=="top"}get showItemErrorOnBottom(){return this.getQuestionErrorLocation()=="bottom"}getChildErrorLocation(e){return this.getQuestionErrorLocation()}isNewValueCorrect(e){return L.isValueObject(e,!0)}supportAutoAdvance(){for(var e=0;e<this.items.length;e++)if(this.items[e].isEmpty())return!1;return!0}get colCount(){return this.getPropertyValue("colCount")}set colCount(e){e<1||e>5||this.setPropertyValue("colCount",e)}get inputSize(){return this.getPropertyValue("inputSize")}set inputSize(e){this.setPropertyValue("inputSize",e)}get itemSize(){return this.inputSize}set itemSize(e){this.inputSize=e}get itemTitleWidth(){return this.getPropertyValue("itemTitleWidth")||""}set itemTitleWidth(e){this.setPropertyValue("itemTitleWidth",e)}onRowCreated(e){return e}calcVisibleRows(){const e=this.colCount,t=this.items;let s=0,i,r,a=[];for(var o=0;o<t.length;o++)s==0&&(i=this.onRowCreated(new gl),r=this.onRowCreated(new D_),this.showItemErrorOnTop?(a.push(r),a.push(i)):(a.push(i),a.push(r))),i.cells.push(new Z1(t[o],this)),r.cells.push(new O_(t[o],this)),s++,(s>=e||o==t.length-1)&&(s=0,r.onAfterCreated());this.rows=a}getRows(){return L.isValueEmpty(this.rows)&&this.calcVisibleRows(),this.rows}onValueChanged(){super.onValueChanged(),this.onItemValueChanged()}createTextItem(e,t){return new K1(e,t)}onItemValueChanged(){if(!this.isMultipleItemValueChanging)for(var e=0;e<this.items.length;e++){var t=null;this.value&&this.items[e].name in this.value&&(t=this.value[this.items[e].name]),this.items[e].onValueChanged(t)}}runConditionCore(e){super.runConditionCore(e),this.items.forEach(t=>t.editor.runCondition(e))}getIsRunningValidators(){if(super.getIsRunningValidators())return!0;for(var e=0;e<this.items.length;e++)if(this.items[e].editor.isRunningValidators)return!0;return!1}validateElementCore(e){let t=!0;for(var s=0;s<this.items.length;s++)e.isOnValueChanged&&this.items[s].editor.isEmpty()||(t=this.items[s].editor.validateElement(e)&&t);return super.validateElementCore(e)&&t}getAllErrors(){for(var e=super.getAllErrors(),t=0;t<this.items.length;t++){var s=this.items[t].editor.getAllErrors();s&&s.length>0&&(e=e.concat(s))}return e}clearErrors(){super.clearErrors();for(var e=0;e<this.items.length;e++)this.items[e].editor.clearErrors()}getContainsErrors(){var e=super.getContainsErrors();if(e)return e;for(var t=this.items,s=0;s<t.length;s++)if(t[s].editor.containsErrors)return!0;return!1}getIsAnswered(){if(!super.getIsAnswered())return!1;for(var e=0;e<this.items.length;e++){var t=this.items[e].editor;if(t.isVisible&&!t.isAnswered)return!1}return!0}getProgressInfo(){for(var e=[],t=0;t<this.items.length;t++)e.push(this.items[t].editor);return Ke.getProgressInfoByElements(e,this.isRequired)}getValueGetterContext(){return new L_(this)}getDisplayValueCore(e,t){if(!t)return t;for(var s={},i=0;i<this.items.length;i++){var r=this.items[i],a=t[r.name];if(!L.isValueEmpty(a)){var o=r.name;e&&r.title&&(o=r.title),s[o]=r.editor.getDisplayValue(e,a)}}return s}allowMobileInDesignMode(){return!0}getMultipleTextValue(e){return this.value?this.value[e]:null}setMultipleTextValue(e,t){this.isMultipleItemValueChanging=!0,this.isValueEmpty(t)&&(t=void 0);var s=this.value;s||(s={}),s[e]=t,this.setNewValue(s),this.isMultipleItemValueChanging=!1}getItemDefaultValue(e){return this.defaultValue?this.defaultValue[e]:null}getTextProcessor(){return this.textProcessor}getAllValues(){return this.data?this.data.getAllValues():null}addElement(e,t){}removeElement(e){return!1}getQuestionTitleLocation(){return"left"}getQuestionTitleWidth(){}getColumsForElement(e){return[]}updateColumns(){}getQuestionStartIndex(){return this.getStartIndex()}getChildrenLayoutType(){return"row"}elementWidthChanged(e){}get elements(){return[]}indexOf(e){return-1}ensureRowsVisibility(){}validateContainerOnly(){}onQuestionValueChanged(e){}getItemLabelCss(e){return new j().append(this.cssClasses.itemLabel).append(this.cssClasses.itemLabelDisabled,this.isDisabledStyle).append(this.cssClasses.itemLabelReadOnly,this.isReadOnlyStyle).append(this.cssClasses.itemLabelPreview,this.isPreviewStyle).append(this.cssClasses.itemLabelAnswered,e.editor.isAnswered).append(this.cssClasses.itemLabelAllowFocus,!this.isDesignMode).append(this.cssClasses.itemLabelOnError,e.editor.errors.length>0).append(this.cssClasses.itemWithCharacterCounter,!!e.getMaxLength()).toString()}getItemCss(){return new j().append(this.cssClasses.item).toString()}getItemTitleCss(){return new j().append(this.cssClasses.itemTitle).toString()}get ariaRole(){return"group"}get ariaRequired(){return null}get ariaInvalid(){return null}}I([Ft()],pl.prototype,"rows",void 0);class gl extends de{constructor(){super(...arguments),this.isVisible=!0,this.cells=[]}}I([R()],gl.prototype,"isVisible",void 0),I([Ft()],gl.prototype,"cells",void 0);class D_ extends gl{onAfterCreated(){const e=()=>{this.isVisible=this.cells.some(t=>{var s,i;return((s=t.item)===null||s===void 0?void 0:s.editor)&&((i=t.item)===null||i===void 0?void 0:i.editor.hasVisibleErrors)})};this.cells.forEach(t=>{var s,i;!((s=t.item)===null||s===void 0)&&s.editor&&((i=t.item)===null||i===void 0||i.editor.registerFunctionOnPropertyValueChanged("hasVisibleErrors",e))}),e()}}class Z1{constructor(e,t){this.item=e,this.question=t,this.isErrorsCell=!1}getClassName(){return new j().append(this.question.cssClasses.cell).toString()}get className(){return this.getClassName()}}class O_ extends Z1{constructor(){super(...arguments),this.isErrorsCell=!0}getClassName(){return new j().append(super.getClassName()).append(this.question.cssClasses.cellError).append(this.question.cssClasses.cellErrorTop,this.question.showItemErrorOnTop).append(this.question.cssClasses.cellErrorBottom,this.question.showItemErrorOnBottom).toString()}}B.addClass("multipletextitem",[{name:"!name",isUnique:!0},"isRequired:boolean",{name:"placeholder",alternativeName:"placeHolder",serializationProperty:"locPlaceholder"},{name:"inputType",default:"text",choices:D.questions.inputTypes},{name:"maskType",default:"none",visibleIndex:0,dependsOn:"inputType",visibleIf:n=>n.inputType==="text",choices:n=>W1()},{name:"maskSettings:masksettings",className:"masksettings",visibleIndex:1,dependsOn:"inputType",visibleIf:n=>n.inputType==="text",onGetValue:function(n){return n.maskSettings.getData()},onSetValue:function(n,e){n.maskSettings.setData(e)}},{name:"inputTextAlignment",default:"auto",choices:["left","right","auto"]},{name:"title",serializationProperty:"locTitle"},{name:"maxLength:number",default:-1},{name:"inputSize:number",alternativeName:"size",minValue:0},{name:"requiredErrorText:text",serializationProperty:"locRequiredErrorText"},{name:"defaultValueExpression:expression",visible:!1},{name:"minValueExpression:expression",category:"logic",dependsOn:"inputType",visibleIf:function(n){return Ks(n)}},{name:"maxValueExpression:expression",category:"logic",dependsOn:"inputType",visibleIf:function(n){return Ks(n)}},{name:"validators:validators",baseClassName:"surveyvalidator",classNamePart:"validator"}],function(){return new K1("")}),B.addClass("multipletext",[{name:"!items:textitems",className:"multipletextitem",isArray:!0},{name:"inputSize:number",minValue:0,visible:!1,alternativeName:"itemSize"},{name:"colCount:number",default:1,choices:[1,2,3,4,5]},{name:"itemErrorLocation",default:"default",choices:["default","top","bottom"],visible:!1},{name:"itemTitleWidth",category:"layout"}],function(){return new pl("")},"question"),Qe.Instance.registerQuestion("multipletext",n=>{var e=new pl(n);return pl.addDefaultItems(e),e});class En extends Qr{constructor(e=""){super(e),this.createLocString({name:"content",supportsMarkdown:!0}),this.registerPropertyChangedHandlers(["content"],()=>{this.onContentChanged()})}getType(){return"flowpanel"}getChildrenLayoutType(){return"flow"}onSurveyLoad(){super.onSurveyLoad(),this.onContentChanged()}get content(){return this.getLocalizableStringText("content")}set content(e){this.setLocalizableStringText("content",e)}get locContent(){return this.getLocalizableString("content")}get html(){return this.getPropertyValue("html","")}set html(e){this.setPropertyValue("html",e)}onContentChanged(){var e="";this.onCustomHtmlProducing?e=this.onCustomHtmlProducing():e=this.produceHtml(),this.html=e,this.contentChangedCallback&&this.contentChangedCallback()}produceHtml(){for(var e=[],t=/{(.*?(element:)[^$].*?)}/g,s=this.content,i=0,r=null;(r=t.exec(s))!==null;){r.index>i&&(e.push(s.substring(i,r.index)),i=r.index);var a=this.getQuestionFromText(r[0]);a?e.push(this.getHtmlForQuestion(a)):e.push(s.substring(i,r.index+r[0].length)),i=r.index+r[0].length}return i<s.length&&e.push(s.substring(i,s.length)),e.join("").replace(new RegExp("<br>","g"),"<br/>")}getQuestionFromText(e){return e=e.substring(1,e.length-1),e=e.replace(En.contentElementNamePrefix,"").trim(),this.getQuestionByName(e)}getHtmlForQuestion(e){return this.onGetHtmlForQuestion?this.onGetHtmlForQuestion(e):""}getQuestionHtmlId(e){return this.name+"_"+e.id}onAddElement(e,t){super.onAddElement(e,t),this.addElementToContent(e),e.renderWidth=""}onRemoveElement(e){var t=this.getElementContentText(e);this.content=this.content.replace(t,""),super.onRemoveElement(e)}dragDropMoveElement(e,t,s){}addElementToContent(e){if(!this.isLoadingFromJson){var t=this.getElementContentText(e);this.insertTextAtCursor(t)||(this.content=this.content+t)}}insertTextAtCursor(e,t=null){if(!this.isDesignMode||!he.isAvailable())return!1;let s=he.getSelection();if(s.getRangeAt&&s.rangeCount){let a=s.getRangeAt(0);a.deleteContents();const o=new Text(e);a.insertNode(o);var i=this;if(i.getContent){var r=i.getContent(t);this.content=r}return!0}return!1}getElementContentText(e){return"{"+En.contentElementNamePrefix+e.name+"}"}}En.contentElementNamePrefix="element:",B.addClass("flowpanel",[{name:"content:html",serializationProperty:"locContent"}],function(){return new En},"panel");class Fd extends kt{constructor(e){super(e)}getType(){return"nonvalue"}get hasInput(){return!1}get hasTitle(){return!1}getTitleLocation(){return""}get hasComment(){return!1}validateElementCore(e){return!0}getAllErrors(){return[]}supportAutoAdvance(){return!1}addConditionObjectsByContext(e,t){}getConditionJson(e=null,t=null){return null}get ariaRole(){return null}get ariaRequired(){return null}}B.addClass("nonvalue",[{name:"title",visible:!1},{name:"description",visible:!1},{name:"valueName",visible:!1},{name:"enableIf",visible:!1},{name:"defaultValue",visible:!1},{name:"correctAnswer",visible:!1},{name:"clearIfInvisible",visible:!1},{name:"isRequired",visible:!1,isSerializable:!1},{name:"requiredErrorText",visible:!1},{name:"readOnly",visible:!1},{name:"requiredIf",visible:!1},{name:"validators",visible:!1},{name:"titleLocation",visible:!1},{name:"showTitle",visible:!1,isSerializable:!1},{name:"showCommentArea",visible:!1},{name:"useDisplayValuesInDynamicTexts",alternativeName:"useDisplayValuesInTitle",visible:!1}],function(){return new Fd("")},"question");class M_ extends kt{constructor(e){super(e)}getType(){return"empty"}}B.addClass("empty",[],function(){return new M_("")},"question");class k_ extends hl{get isExclusive(){return this.getPropertyValue("isExclusive")}set isExclusive(e){this.setPropertyValue("isExclusive",e)}getBaseType(){return"checkboxitem"}onPropertyValueChanged(e,t,s){super.onPropertyValueChanged(e,t,s),e==="showCommentArea"&&this.locOwner&&this.locOwner.onItemHasCommentChanged()}}class ml extends dl{constructor(e){super(e),this.invisibleOldValues={},this.isChangingValueOnClearIncorrect=!1,this.selectAllItemValue=this.createSelectAllItem(),this.registerPropertyChangedHandlers(["showSelectAllItem","selectAllText"],()=>{this.onVisibleChoicesChanged()}),this.registerPropertyChangedHandlers(["choices"],()=>{this.onItemHasCommentChanged()})}supportElementsInChoice(){return!0}getDefaultItemComponent(){return"survey-checkbox-item"}getType(){return"checkbox"}getItemValueType(){return"checkboxitem"}createSelectAllItem(){const e=this.createItemValue("");return e.value="",e.id="selectall",this.selectAllItemText=this.createLocalizableString("selectAllText",e,!0,"selectAllItemText"),e.locOwner=this,e.setLocText(this.selectAllItemText),e}onCreating(){super.onCreating(),this.createNewArray("renderedValue"),this.createNewArray("value")}getFirstInputElementId(){return this.inputId+"_0"}get valuePropertyName(){return this.getPropertyValue("valuePropertyName")}set valuePropertyName(e){this.setPropertyValue("valuePropertyName",e)}getValuePropertyName(){return this.valuePropertyName||(this.isTheOnlyComment?"":"value")}getQuestionFromArray(e,t){if(e&&e===this.getValuePropertyName()){const s=this.value;if(Array.isArray(s)&&t<s.length)return this}return null}getDependedQuestionsByValueName(e){return e&&this.getValuePropertyName()?[]:super.getDependedQuestionsByValueName(e)}get selectAllItem(){return this.selectAllItemValue}get selectAllText(){return this.getLocalizableStringText("selectAllText")}set selectAllText(e){this.setLocalizableStringText("selectAllText",e)}get locSelectAllText(){return this.getLocalizableString("selectAllText")}get showSelectAllItem(){return this.getPropertyValue("showSelectAllItem")}set showSelectAllItem(e){this.setPropertyValue("showSelectAllItem",e)}get hasSelectAll(){return this.showSelectAllItem}set hasSelectAll(e){this.showSelectAllItem=e}get isAllSelected(){return this.allElementsSelected()}set isAllSelected(e){e?this.selectAll():this.clearValueFromUI()}toggleSelectAll(){this.isAllSelected=!this.isAllSelected}allElementsSelected(){if(this.isNoneItemsSelected())return!1;const e=this.getVisibleEnableItems();if(e.length===0)return!1;const t=this.value;if(!t||!Array.isArray(t)||t.length===0||t.length<e.length)return!1;const s=[];for(let i=0;i<t.length;i++)s.push(this.getRealValue(t[i]));for(let i=0;i<e.length;i++)if(s.indexOf(e[i].value)<0)return!1;return!0}isNoneItemsSelected(){const e=this.getNoneItems();for(let t=0;t<e.length;t++)if(this.isItemSelected(e[t]))return!0;return!1}getNoneItems(){const e=new Array;return this.visibleChoices.forEach(t=>{this.isNoneItem(t)&&e.push(t)}),e}selectAll(){const e=[],t=this.getVisibleEnableItems();for(let s=0;s<t.length;s++)e.push(t[s].value);this.renderedValue=e}clickItemHandler(e,t){this.selectItem(e,t)}selectItem(e,t){if(!(this.isReadOnlyAttr||!e))if(e===this.selectAllItem)t===!0||t===!1?this.isAllSelected=t:this.toggleSelectAll();else{if(this.isNoneItem(e))this.renderedValue=t?[e.value]:[];else{const s=[].concat(this.renderedValue||[]),i=s.indexOf(e.value);t?i<0&&s.push(e.value):i>-1&&s.splice(i,1),this.renderedValue=s}t&&this.onItemSelected(e)}}isItemSelectedCore(e){if(e===this.selectAllItem)return this.isAllSelected;var t=this.renderedValue;if(!t||!Array.isArray(t))return!1;for(var s=0;s<t.length;s++)if(this.isTwoValueEquals(t[s],e.value))return!0;return!1}hasUnknownValueItem(e,t=!1,s=!0,i=!1){return super.hasUnknownValueItem(this.getRealValue(e),t,s,i)}setCommentValueCore(e,t){if(t=this.trimCommentValue(t),this.isOtherItemByValue(e))super.setCommentValueCore(e,t);else{this.setCommentPropertyValue(e,t);const s=this.getItemValIndexByItemValue(e.value);if(s>-1){const i=this.createValueCopy(),r=i[s];t?r[this.commentPropertyValue]=t:delete r[this.commentPropertyValue],this.value=i}}}getCommentValueByItem(e){const t=this.getItemValIndexByItemValue(e.value);return t>-1?this.value[t][this.commentPropertyValue]:void 0}getItemValIndexByItemValue(e){const t=this.value;if(!Array.isArray(t))return-1;for(let s=0;s<t.length;s++){const i=this.getRealValue(t[s]);if(L.isTwoValueEquals(i,e))return s}return-1}get isTheOnlyComment(){return this.getPropertyValue("isTheOnlyComment",void 0,()=>this.calcIsTheOnlyComment())}calcIsTheOnlyComment(){for(let e=0;e<this.choices.length;e++){const t=this.choices[e];if(t.showCommentArea&&t.value!==this.otherItem.value)return!1}return!0}onItemHasCommentChanged(){this.resetPropertyValue("isTheOnlyComment")}getRealValue(e){if(!e||typeof e!="object")return e;const t=this.getValuePropertyName();return t?e[t]:e}getValueFromReal(e){const t=this.getValuePropertyName();if(t){const s={};return s[t]=e,s}return e}get isValueArray(){return!0}get maxSelectedChoices(){return this.getPropertyValue("maxSelectedChoices")}set maxSelectedChoices(e){e<0&&(e=0),this.setPropertyValue("maxSelectedChoices",e),this.filterItems()}get minSelectedChoices(){return this.getPropertyValue("minSelectedChoices")}set minSelectedChoices(e){e<0&&(e=0),this.setPropertyValue("minSelectedChoices",e)}get selectedChoices(){const e=this.renderedValue,t=this.visibleChoices,s=this.selectedItemValues;if(this.isEmpty())return[];const i=this.defaultSelectedItemValues?[].concat(this.defaultSelectedItemValues,t):t,r=e.map(o=>fe.getItemByValue(i,o)).filter(o=>!!o);return!r.length&&!s&&this.updateSelectedItemValues(),this.validateItemValues(r)}get selectedItems(){return this.selectedChoices}get hasFilteredValue(){return!!this.getValuePropertyName()}getFilteredName(){let e=super.getFilteredName();return this.hasFilteredValue&&(e+=D.expressionVariables.unwrapPostfix),e}getFilteredValue(e){return e&&this.hasFilteredValue?this.renderedValue:super.getFilteredValue(e)}getMultipleSelectedItems(){return this.selectedChoices}validateItemValues(e){if(e.length)return e;const t=this.selectedItemValues;return t&&t.length?(this.defaultSelectedItemValues=[].concat(t),t):this.renderedValue.map(i=>this.createItemValue(i))}getAnswerCorrectIgnoreOrder(){return!0}onCheckForErrors(e,t,s){if(super.onCheckForErrors(e,t,s),!t&&this.checkMinSelectedChoicesUnreached()){const i=new Ps(this.getLocalizationFormatString("minSelectError",this.minSelectedChoices),this);e.push(i)}}onVisibleChoicesChanged(){super.onVisibleChoicesChanged(),this.updateSelectAllItemProps()}onEnableItemCallBack(e){return this.shouldCheckMaxSelectedChoices()?this.isItemSelected(e):!0}onAfterRunItemsEnableCondition(){this.updateSelectAllItemProps();const e=this.maxSelectedChoices<1||this.isOtherSelected||!this.shouldCheckMaxSelectedChoices();this.otherItem.setIsEnabled(e)}updateSelectAllItemProps(){this.showSelectAllItem&&this.selectAllItem.setIsEnabled(this.getSelectAllEnabled())}getSelectAllEnabled(){if(!this.showSelectAllItem)return!0;let e=this.getVisibleEnableItems().length;const t=this.maxSelectedChoices;return t>0&&t<e?!1:e>0}getVisibleEnableItems(){const e=new Array,t=this.visibleChoices;for(let s=0;s<t.length;s++){const i=t[s];i.isEnabled&&!this.isBuiltInChoice(i)&&!i.isExclusive&&e.push(i)}return e}shouldCheckMaxSelectedChoices(){if(this.maxSelectedChoices<1)return!1;var e=this.value,t=Array.isArray(e)?e.length:0;return t>=this.maxSelectedChoices}checkMinSelectedChoicesUnreached(){if(this.minSelectedChoices<1)return!1;var e=this.value,t=Array.isArray(e)?e.length:0;return t===1&&this.isNoneItemsSelected()?!1:t<this.minSelectedChoices}getItemClassCore(e,t){return this.value,t.isSelectAllItem=e===this.selectAllItem,new j().append(super.getItemClassCore(e,t)).append(this.cssClasses.itemSelectAll,t.isSelectAllItem).toString()}updateValueFromSurvey(e,t){super.updateValueFromSurvey(e,t),this.invisibleOldValues={}}onSurveyLoad(){this.onItemHasCommentChanged(),super.onSurveyLoad()}setDefaultUnknownValue(e){if(!Array.isArray(e)){super.setDefaultUnknownValue(e);return}if(this.hasActiveChoices){const s=[];let i="";for(var t=0;t<e.length;t++){const a=this.getRealValue(e[t]);this.hasUnknownValue(a)?i||(i=a,s.push(this.otherItem.value)):s.push(a)}this.renderedValue=s,this.otherValue=i}else{for(var t=0;t<e.length;t++){const s=this.getRealValue(e[t]);this.addIntoInvisibleOldValues(s)}this.value=e}}addIntoInvisibleOldValues(e){this.invisibleOldValues[e]=e}hasValueToClearIncorrectValues(){return super.hasValueToClearIncorrectValues()||!L.isValueEmpty(this.invisibleOldValues)}setNewValue(e){this.isChangingValueOnClearIncorrect||(this.invisibleOldValues={}),e=this.valueFromData(e);var t=this.value;e||(e=[]),t||(t=[]),!this.isTwoValueEquals(t,e)&&(this.removeNoneItemsValues(t,e),super.setNewValue(e))}getCommentFromValue(e){var t=this.getFirstUnknownIndex(e);return t<0?"":e[t]}getStoreOthersAsComment(){return this.getValuePropertyName()?!1:super.getStoreOthersAsComment()}setOtherValueIntoValue(e){var t=this.getFirstUnknownIndex(e);if(t<0)return e;let s=this.otherItem.value;const i=this.getValuePropertyName();if(i){const r={};r[i]=s,s=r}return e.splice(t,1,s),e}getFirstUnknownIndex(e){if(!Array.isArray(e))return-1;for(var t=0;t<e.length;t++)if(this.hasUnknownValueItem(e[t],!1,!1))return t;return-1}removeNoneItemsValues(e,t){if(e.length===1&&t.length===1&&this.getRealValue(e[0])===this.getRealValue(t[0]))return;const s=this.getNoneItems().map(i=>i.value);if(s.length>0){const i=this.noneIndexInArray(e,s),r=this.noneIndexInArray(t,s);if(i.index>-1)if(i.val===r.val)t.length>0&&t.splice(r.index,1);else{const a=this.noneIndexInArray(t,[i.val]);a.index>-1&&a.index<t.length-1&&t.splice(a.index,1)}else r.index>-1&&t.length>1&&t.splice(0,t.length,this.getValueFromReal(r.val))}}noneIndexInArray(e,t){if(!Array.isArray(e))return{index:-1,val:void 0};for(var s=e.length-1;s>=0;s--){const i=t.indexOf(this.getRealValue(e[s]));if(i>-1)return{index:s,val:t[i]}}return{index:-1,val:void 0}}supportSelectAll(){return this.isSupportProperty("showSelectAllItem")}addNonChoicesItems(e,t){super.addNonChoicesItems(e,t),this.supportSelectAll()&&this.addNonChoiceItem(e,this.selectAllItem,t,this.showSelectAllItem,D.specialChoicesOrder.selectAllItem)}isBuiltInChoice(e){return e===this.selectAllItem||super.isBuiltInChoice(e)}isItemInList(e){return e==this.selectAllItem?this.showSelectAllItem:super.isItemInList(e)}getDisplayValueEmpty(){return fe.getTextOrHtmlByValue(this.visibleChoices.filter(e=>e!=this.selectAllItemValue),void 0)}getDisplayValueCore(e,t){if(!Array.isArray(t))return super.getDisplayValueCore(e,t);const s=this.getValuePropertyName(),i=r=>{let a=t[r];return s&&a[s]&&(a=a[s]),a};return this.getDisplayArrayValue(e,t,i)}clearIncorrectValuesCore(){this.clearIncorrectAndDisabledValues(!1)}clearDisabledValuesCore(){this.clearIncorrectAndDisabledValues(!0)}clearIncorrectAndDisabledValues(e){var t=this.value,s=!1,i=this.restoreValuesFromInvisible();if(!(!t&&i.length==0)){if(!Array.isArray(t)||t.length==0){if(this.isChangingValueOnClearIncorrect=!0,e||(this.showCommentArea?this.value=null:this.clearValue(!0)),this.isChangingValueOnClearIncorrect=!1,i.length==0)return;t=[]}for(var r=[],a=0;a<t.length;a++){const l=this.getRealValue(t[a]);var o=this.canClearValueAnUnknown(l);!e&&!o||e&&!this.isValueDisabled(l)?r.push(t[a]):(s=!0,o&&this.addIntoInvisibleOldValues(t[a]))}for(var a=0;a<i.length;a++)r.push(i[a]),s=!0;s&&(this.isChangingValueOnClearIncorrect=!0,r.length==0?this.clearValue(!0):this.value=r,this.isChangingValueOnClearIncorrect=!1)}}restoreValuesFromInvisible(){for(var e=[],t=this.visibleChoices,s=0;s<t.length;s++){const r=t[s];if(r!==this.selectAllItem){var i=t[s].value;L.isTwoValueEquals(i,this.invisibleOldValues[i])&&(this.isItemSelected(r)||e.push(i),delete this.invisibleOldValues[i])}}return e}getConditionJson(e=null,t=null){const s=super.getConditionJson(e,t);return(e=="contains"||e=="notcontains")&&(s.type="radiogroup"),s.maxSelectedChoices=0,s.minSelectedChoices=0,s}isAnswerCorrect(){return L.isArrayContainsEqual(this.value,this.correctAnswer)}setDefaultValueWithOthers(){this.value=this.renderedValueFromDataCore(this.defaultValue)}getIsItemValue(e,t){return!e||!Array.isArray(e)?!1:e.indexOf(t.value)>=0}valueFromData(e){if(!e)return e;if(!Array.isArray(e))return[super.valueFromData(e)];let t=[];for(let s=0;s<e.length;s++){const i=this.getItemByValue(e[s],this.visibleChoices);i?t.push(this.getChoiceValue(i,e[s],!0)):t.push(e[s])}return t}rendredValueFromData(e){return e=this.convertValueFromObject(e),super.rendredValueFromData(e)}convertValueFromObject(e){if(!this.getValuePropertyName()||!Array.isArray(e))return e;const s=[];for(let i=0;i<e.length;i++)s.push(this.getRealValue(e[i]));return s}renderedValueFromDataCore(e){if((!e||!Array.isArray(e))&&(e=[]),!this.hasActiveChoices)return e;for(var t=0;t<e.length;t++){if(e[t]==this.otherItem.value)return e;if(this.hasUnknownValueItem(e[t],!0,!1)){this.otherValue=e[t];var s=e.slice();return s[t]=this.otherItem.value,s}}return e}renderedValueToDataCore(e){if(!e||!e.length)return e;const t=[],s=this.createValueCopy();for(var i=0;i<e.length;i++){let r=-1,a=e[i];a===this.otherItem.value&&this.needConvertRenderedOtherToDataValue()?(r=this.getFirstUnknownIndex(s),a=this.otherValue,r>-1&&(s[r]=this.getValueFromReal(this.otherValue))):r=this.getItemValIndexByItemValue(a),r>-1?t.push(s[r]):t.push(this.getValueFromReal(a))}return t}valueToData(e){if(L.isValueEmpty(e)||(Array.isArray(e)||(e=[e]),!this.getValuePropertyName()))return e;const s=[];for(let i=0;i<e.length;i++){const r=e[i];s.push(typeof r=="object"?r:this.getValueFromReal(r))}return s}selectOtherValueFromComment(e){var t=[];const s=this.renderedValue;if(Array.isArray(s))for(var i=0;i<s.length;i++)s[i]!==this.otherItem.value&&t.push(s[i]);e&&t.push(this.otherItem.value),this.value=t}get checkBoxSvgPath(){return"M5,13l2-2l3,3l7-7l2,2l-9,9L5,13z"}get isNewA11yStructure(){return!0}get a11y_input_ariaRole(){return"group"}get a11y_input_ariaRequired(){return null}}B.addClass("checkboxitem",[{name:"isExclusive:boolean",locationInTable:"detail"}],n=>new k_(n),"choiceitem"),B.addClass("checkbox",[{name:"showSelectAllItem:boolean",alternativeName:"hasSelectAll"},{name:"separateSpecialChoices",visible:!0},{name:"maxSelectedChoices:number",default:0,onSettingValue:(n,e)=>{if(e<=0)return 0;const t=n.minSelectedChoices;return t>0&&e<t?t:e}},{name:"minSelectedChoices:number",default:0,onSettingValue:(n,e)=>{if(e<=0)return 0;const t=n.maxSelectedChoices;return t>0&&e>t?t:e}},{name:"selectAllText",serializationProperty:"locSelectAllText",dependsOn:"showSelectAllItem",visibleIf:function(n){return n.showSelectAllItem}},{name:"valuePropertyName",category:"data"},{name:"itemComponent",visible:!1,default:"survey-checkbox-item"}],function(){return new ml("")},"checkboxbase"),B.getProperty("checkbox","choices").type="checkboxitem[]",Qe.Instance.registerQuestion("checkbox",n=>{var e=new ml(n);return e.choices=Qe.DefaultChoices,e});class Y1 extends lt{updateItemState(){this.actions.forEach(e=>{const t=this.isItemSelected(e);e.visible=this.hideSelectedItems?!t:!0})}constructor(e){super(e),this.onItemClick=t=>{this.isItemDisabled(t)||(this.isExpanded=!1,this.isItemSelected(t)?(this.selectedItems.splice(this.selectedItems.indexOf(t),1)[0],this.onSelectionChanged&&this.onSelectionChanged(t,"removed")):(this.selectedItems.push(t),this.onSelectionChanged&&this.onSelectionChanged(t,"added")))},this.isItemDisabled=t=>t.enabled!==void 0&&!t.enabled,this.isItemSelected=t=>!!this.allowSelection&&this.selectedItems.filter(s=>this.areSameItems(s,t)).length>0,this.setSelectedItems(e.selectedItems||[])}updateState(){this.updateItemState(),this.raiseUpdate({needUpdateIsEmpty:!0})}setSelectedItems(e){this.selectedItems=e,this.updateState()}selectFocusedItem(){super.selectFocusedItem(),this.hideSelectedItems&&this.focusNextVisibleItem()}}I([R()],Y1.prototype,"hideSelectedItems",void 0);class Rn extends Wt{get needRenderInput(){return!this.question.isInputReadOnly||!!this.filterStringPlaceholder}locStrsChanged(){super.locStrsChanged(),this.syncFilterStringPlaceholder()}updateListState(){this.listModel.updateState(),this.updateCustomItemValue(),this.syncFilterStringPlaceholder()}syncFilterStringPlaceholder(){this.getSelectedActions().length||this.question.selectedItems.length||this.listModel.focusedItem?this.filterStringPlaceholder=void 0:this.filterStringPlaceholder=this.question.placeholder}getSelectedActions(){return this.listModel.actions.filter(e=>e.selected)}getFocusFirstInputSelector(){return this.listModel.hideSelectedItems&&vt&&!this.isValueEmpty(this.question.value)?this.itemSelector:super.getFocusFirstInputSelector()}getPopupCssClasses(){return"sv-multi-select-list"}createListModel(){const e=this.getAvailableItems();let t=this.onSelectionChanged;t||(t=(r,a)=>{this.resetFilterString(),r.id==="selectall"?this.selectAllItems():a==="added"&&r.value===D.noneItemValue?this.selectNoneItem():a==="added"?this.selectItem(r.value):a==="removed"&&this.deselectItem(r.value),this.popupRecalculatePosition(!1),this.closeOnSelect&&(this.popupModel.isVisible=!1)});const s={items:e,onSelectionChanged:t,allowSelection:!1,locOwner:this.question,elementId:this.listElementId},i=new Y1(s);return this.setOnTextSearchCallbackForListModel(i),i.forceShowFilter=this.question.choicesLazyLoadEnabled,i}get shouldResetAfterCancel(){return vt&&!this.closeOnSelect}createPopup(){super.createPopup(),this.popupModel.onFooterActionsCreated.add((e,t)=>{t.actions.push({id:"sv-dropdown-done-button",title:this.doneButtonCaption,innerCss:"sv-popup__button--done",needSpace:!0,action:()=>{this.popupModel.isVisible=!1},enabled:new Ue(()=>!this.isTwoValueEquals(this.question.renderedValue,this.previousValue))})}),this.popupModel.onVisibilityChanged.add((e,t)=>{this.shouldResetAfterCancel&&t.isVisible&&(this.previousValue=[].concat(this.question.renderedValue||[]))}),this.popupModel.onCancel=()=>{this.shouldResetAfterCancel&&(this.question.renderedValue=this.previousValue,this.updateListState())}}selectAllItems(){this.question.toggleSelectAll(),this.question.isAllSelected&&this.question.hideSelectedItems&&this.popupModel.hide(),this.updateListState()}selectNoneItem(){this.question.renderedValue=[D.noneItemValue],this.updateListState()}selectItem(e){let t;if(this.allowCustomChoices&&e===this.customItemValue.id){const s=this.createCustomItem();s&&(t=s.id)}else t=e;if(t!=null){let s=[].concat(this.question.renderedValue||[]);s.push(t),this.question.renderedValue=s,this.updateListState()}}deselectItem(e){let t=[].concat(this.question.renderedValue||[]);t.splice(t.indexOf(e),1),this.question.renderedValue=t,this.applyHintString(),this.updateListState()}clear(){super.clear(),this.syncFilterStringPlaceholder()}onClear(e){super.onClear(e),this.updateListState()}setHideSelectedItems(e){this.listModel.hideSelectedItems=e,this.updateListState()}removeLastSelectedItem(){this.deselectItem(this.question.renderedValue[this.question.renderedValue.length-1]),this.popupRecalculatePosition(!1)}constructor(e,t){super(e,t),this.setHideSelectedItems(e.hideSelectedItems),this.syncFilterStringPlaceholder(),this.closeOnSelect=e.closeOnSelect}inputKeyHandler(e){e.keyCode===8&&!this.filterString&&(this.removeLastSelectedItem(),e.preventDefault(),e.stopPropagation())}setInputStringFromSelectedItem(e){this.question.searchEnabled&&(this.inputString=null)}focusItemOnClickAndPopup(){}onEscape(){}beforeScrollToFocusedItem(e){}afterScrollToFocusedItem(){var e;!((e=this.listModel.focusedItem)===null||e===void 0)&&e.selected?this.hintString="":this.applyHintString(),this.syncFilterStringPlaceholder()}onPropertyChangedHandler(e,t){super.onPropertyChangedHandler(e,t),(t.name==="value"||t.name==="renderedValue"||t.name==="placeholder")&&this.syncFilterStringPlaceholder()}}I([R({defaultValue:""})],Rn.prototype,"filterStringPlaceholder",void 0),I([R({defaultValue:!0})],Rn.prototype,"closeOnSelect",void 0),I([R()],Rn.prototype,"previousValue",void 0),I([R({localizable:{defaultStr:"tagboxDoneButtonCaption"}})],Rn.prototype,"doneButtonCaption",void 0);class Ms extends ml{constructor(e){super(e),this.itemDisplayNameMap={},this.onOpened=this.addEvent(),this.createLocString({name:"placeholder",hasTranslation:!0}),this.createLocalizableString("readOnlyText",this,!0),this.deselectAllItemText=this.createLocalizableString("deselectAllText",this.selectAllItem,!0,"deselectAllItemText"),this.registerPropertyChangedHandlers(["value","renderAs","showOtherItem","otherText","placeholder","choices","visibleChoices"],()=>{this.updateReadOnlyText()}),this.updateReadOnlyText()}supportElementsInChoice(){return!1}locStrsChanged(){var e;super.locStrsChanged(),this.updateReadOnlyText(),(e=this.dropdownListModelValue)===null||e===void 0||e.locStrsChanged()}updateReadOnlyText(){this.readOnlyText=this.displayValue||this.placeholder}onSelectedItemValuesUpdated(){super.onSelectedItemValuesUpdated(),this.updateReadOnlyText()}getDefaultItemComponent(){return""}get dropdownListModel(){return!this.isDisposed&&!this.dropdownListModelValue&&(this.dropdownListModelValue=new Rn(this)),this.dropdownListModelValue}set dropdownListModel(e){this.dropdownListModelValue=e}get placeholder(){return this.getLocalizableStringText("placeholder")}set placeholder(e){this.setLocalizableStringText("placeholder",e),this.dropdownListModelValue&&this.dropdownListModel.setInputPlaceholder(e)}get locPlaceholder(){return this.getLocalizableString("placeholder")}get readOnlyText(){return this.getLocalizableStringText("readOnlyText")}set readOnlyText(e){this.setLocalizableStringText("readOnlyText",e)}get locReadOnlyText(){return this.getLocalizableString("readOnlyText")}getType(){return"tagbox"}supportMultipleComment(e){return e===this.otherItem}get a11yInputAriaRole(){return"combobox"}get popupModel(){return this.dropdownListModel.popupModel}getControlClass(){return new j().append(this.cssClasses.control).append(this.cssClasses.controlEmpty,this.isEmpty()).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlEditable,!this.isDisabledStyle&&!this.isReadOnlyStyle&&!this.isPreviewStyle).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle).toString()}updateCssClasses(e,t){super.updateCssClasses(e,t),Xo(e,t)}calcCssClasses(e){const t=super.calcCssClasses(e);return this.dropdownListModelValue&&this.dropdownListModel.updateCssClasses(t.popup,t.list),t}onOpenedCallBack(){this.onOpened.fire(this,{question:this,choices:this.choices})}hasUnknownValue(e,t=!1,s=!0,i=!1){return this.choicesLazyLoadEnabled?!1:super.hasUnknownValue(e,t,s,i)}needConvertRenderedOtherToDataValue(){var e;const t=(e=this.otherValue)===null||e===void 0?void 0:e.trim();return t?super.hasUnknownValue(t,!0,!1):!1}onVisibleChoicesChanged(){super.onVisibleChoicesChanged(),this.dropdownListModelValue&&this.dropdownListModel.updateItems()}getItemIfChoicesNotContainThisValue(e,t){return this.choicesLazyLoadEnabled?this.createItemValue(e,t):super.getItemIfChoicesNotContainThisValue(e,t)}validateItemValues(e){this.updateItemDisplayNameMap();const t=this.renderedValue;if(e.length&&e.length===t.length)return e;const s=this.selectedItemValues;if(!e.length&&s&&s.length)return this.defaultSelectedItemValues=[].concat(s),s;const i=e.map(r=>r.value);return t.filter(r=>i.indexOf(r)===-1).forEach(r=>{const a=this.getItemIfChoicesNotContainThisValue(r,this.itemDisplayNameMap[r]);a&&e.push(a)}),e.sort((r,a)=>t.indexOf(r.value)-t.indexOf(a.value)),e}updateItemDisplayNameMap(){const e=t=>{this.itemDisplayNameMap[t.value]=t.text};(this.defaultSelectedItemValues||[]).forEach(e),(this.selectedItemValues||[]).forEach(e),this.visibleChoices.forEach(e)}getIsQuestionReady(){return super.getIsQuestionReady()&&!this.isChoicesLoading}ensureQuestionIsReady(){super.ensureQuestionIsReady(),this.dropdownListModel&&this.choicesLazyLoadEnabled&&this.dropdownListModel.loadQuestionChoices()}onLoadChoicesFromUrl(e){this.updateCustomChoices(this.value,e),super.onLoadChoicesFromUrl(e)}valueFromData(e,t){const s=super.valueFromData(e);return this.survey&&this.survey.isSettingData()&&this.updateCustomChoices(s,this.visibleChoices),s}updateCustomChoices(e,t){if(e!=null&&e.length>0&&this.allowCustomChoices&&!this.choicesLazyLoadEnabled){this.customChoices.splice(0,this.customChoices.length);const s=[];e.forEach(i=>{t.filter(a=>L.isTwoValueEquals(a.id,i,!1,!1))[0]||s.push(new fe(i))}),s.length>0&&this.customChoices.splice(0,this.customChoices.length,...s)}}setIsChoicesLoading(e){this.isChoicesLoading=e,this.updateIsReady()}canAddCustomChoices(){return this.allowCustomChoices}getFirstInputElementId(){return this.inputId+(this.searchEnabled||this.allowCustomChoices?"_0":"")}getInputId(){return this.inputId+"_0"}supportEmptyValidation(){return!0}onBlurCore(e){this.dropdownListModel.onBlur(e),super.onBlurCore(e)}onFocusCore(e){this.dropdownListModel.onFocus(e),super.onFocusCore(e)}allElementsSelected(){const e=super.allElementsSelected();return this.updateSelectAllItemText(e),e}updateSelectAllItemText(e){this.selectAllItem.setLocText(e?this.deselectAllItemText:this.selectAllItemText)}dispose(){super.dispose(),this.dropdownListModelValue&&(this.dropdownListModelValue.dispose(),this.dropdownListModelValue=void 0)}clearValue(e,t){var s;super.clearValue(e,t),(s=this.dropdownListModelValue)===null||s===void 0||s.clear()}get showClearButton(){return this.allowClear&&!this.isEmpty()}}I([R()],Ms.prototype,"searchMode",void 0),I([R({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setAllowCustomChoices(n)}})],Ms.prototype,"allowCustomChoices",void 0),I([R()],Ms.prototype,"allowClear",void 0),I([R({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setSearchEnabled(n)}})],Ms.prototype,"searchEnabled",void 0),I([R({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setHideSelectedItems(n)}})],Ms.prototype,"hideSelectedItems",void 0),I([R({onSet:(n,e)=>{e.dropdownListModelValue&&e.dropdownListModel.setChoicesLazyLoadEnabled(n)}})],Ms.prototype,"choicesLazyLoadEnabled",void 0),I([R()],Ms.prototype,"choicesLazyLoadPageSize",void 0),I([R({getDefaultValue:()=>D.tagboxCloseOnSelect})],Ms.prototype,"closeOnSelect",void 0),I([R()],Ms.prototype,"textWrapEnabled",void 0),B.addClass("tagbox",[{name:"placeholder",serializationProperty:"locPlaceholder"},{name:"allowClear:boolean",default:!0},{name:"searchEnabled:boolean",default:!0},{name:"allowCustomChoices:boolean",default:!1,visibleIf:n=>!n.choicesFromQuestion,dependsOn:"choicesFromQuestion"},{name:"textWrapEnabled:boolean",default:!0},{name:"choicesLazyLoadEnabled:boolean",default:!1,visible:!1},{name:"choicesLazyLoadPageSize:number",default:25,visible:!1},{name:"hideSelectedItems:boolean",default:!1},{name:"closeOnSelect:boolean"},{name:"itemComponent",visible:!1,default:""},{name:"searchMode",default:"contains",choices:["contains","startsWith"]}],function(){return new Ms("")},"checkbox"),Qe.Instance.registerQuestion("tagbox",n=>{const e=new Ms(n);return e.choices=Qe.DefaultChoices,e});class N_ extends k1{constructor(){super(...arguments),this.doDragOver=()=>{if(this.parentElement.getType()==="imagepicker")return;const e=this.domAdapter.draggedElementShortcut.querySelector(".svc-item-value-controls__button");e.style.cursor="grabbing"},this.doBanDropHere=()=>{if(this.parentElement.getType()==="imagepicker")return;const e=this.domAdapter.draggedElementShortcut.querySelector(".svc-item-value-controls__button");e.style.cursor="not-allowed"}}get draggedElementType(){return"item-value"}createDraggedElementShortcut(e,t,s){if(this.parentElement.getType()==="imagepicker")return this.createImagePickerShortcut(this.draggedElement,e,t,s);const i=oe.createElement("div");if(!i)return;i.className="sv-drag-drop-choices-shortcut";const a=t.closest("[data-sv-drop-target-item-value]").cloneNode(!0);a.classList.add("sv-drag-drop-choices-shortcut__content");const o=a.querySelector(".svc-item-value-controls__drag-icon");o.style.visibility="visible";const l=a.querySelector(".svc-item-value-controls__remove");l.style.backgroundColor="transparent",a.classList.remove("svc-item-value--moveup"),a.classList.remove("svc-item-value--movedown"),this.draggedElement.isDragDropMoveDown=!1,this.draggedElement.isDragDropMoveUp=!1,i.appendChild(a);const u=t.getBoundingClientRect();return i.shortcutXOffset=s.clientX-u.x,i.shortcutYOffset=s.clientY-u.y,this.isBottom=null,typeof this.onShortcutCreated=="function"&&this.onShortcutCreated(i),i}createImagePickerShortcut(e,t,s,i){const r=oe.createElement("div");if(!r)return;r.classList.add("sv-drag-drop-image-picker-shortcut");const a=s.closest("[data-sv-drop-target-item-value]");this.imagepickerControlsNode=a.querySelector(".svc-image-item-value-controls");const o=a.querySelector(".sd-imagepicker__image-container");let l=a.querySelector(e.imageLink?"img":".sd-imagepicker__no-image").cloneNode(!0);return this.imagepickerControlsNode&&(this.imagepickerControlsNode.style.display="none"),o.style.width=l.width+"px",o.style.height=l.height+"px",l.style.objectFit="cover",l.style.borderRadius="4px",r.appendChild(l),r}getDropTargetByDataAttributeValue(e){let t;return t=this.parentElement.choices.filter(s=>""+s.value==e)[0],t}getChoices(){const e=this.parentElement;return e.getType()==="ranking"?e.selectToRankEnabled?e.unRankingChoices:e.rankingChoices:e.visibleChoices}isDropTargetValid(e,t){const s=this.getChoices();if(this.parentElement.getType()!=="imagepicker"){const i=s.indexOf(this.dropTarget),r=s.indexOf(this.draggedElement);if(r>i&&this.dropTarget.isDragDropMoveUp)return this.dropTarget.isDragDropMoveUp=!1,!1;if(r<i&&this.dropTarget.isDragDropMoveDown)return this.dropTarget.isDragDropMoveDown=!1,!1}return s.indexOf(e)!==-1}isDropTargetDoesntChanged(e){return this.dropTarget===this.prevDropTarget&&e===this.isBottom}calculateIsBottom(e,t){const s=t.getBoundingClientRect();return e>=s.y+s.height/2}afterDragOver(e){const t=this.getChoices(),s=t.indexOf(this.dropTarget),i=t.indexOf(this.draggedElement);if(i<s&&this.isBottom===!0)t.splice(i,1),t.splice(s,0,this.draggedElement);else if(i>s&&this.isBottom===!1)t.splice(s,1),t.splice(i,0,this.dropTarget);else return;this.parentElement.getType()!=="imagepicker"&&(i!==s&&(e.classList.remove("svc-item-value--moveup"),e.classList.remove("svc-item-value--movedown"),this.dropTarget.isDragDropMoveDown=!1,this.dropTarget.isDragDropMoveUp=!1),i>s&&(this.dropTarget.isDragDropMoveDown=!0),i<s&&(this.dropTarget.isDragDropMoveUp=!0),super.ghostPositionChanged())}doDrop(){const e=this.parentElement.choices,t=this.getChoices().filter(r=>e.indexOf(r)!==-1),s=e.indexOf(this.draggedElement);let i=t.indexOf(this.draggedElement);return e.splice(s,1),e.splice(i,0,this.draggedElement),this.parentElement}clear(){this.parentElement&&this.updateVisibleChoices(this.parentElement),this.imagepickerControlsNode&&(this.imagepickerControlsNode.style.display="flex",this.imagepickerControlsNode=null),super.clear()}updateVisibleChoices(e){e.getType()==="ranking"?e.updateRankingChoices():e.updateVisibleChoices()}}class X1 extends N_{constructor(){super(...arguments),this.isDragOverRootNode=!1,this.doDragOver=()=>{const e=this.domAdapter.draggedElementShortcut.querySelector(".sv-ranking-item");e.style.cursor="grabbing"},this.reorderRankedItem=(e,t,s)=>{if(t==s)return;const i=e.rankingChoices,r=i[t];e.isValueSetByUser=!0,i.splice(t,1),i.splice(s,0,r),this.updateDraggedElementShortcut(s+1)},this.doBanDropHere=()=>{if(this.isDragOverRootNode){this.allowDropHere=!0;return}const e=this.domAdapter.draggedElementShortcut.querySelector(".sv-ranking-item");e.style.cursor="not-allowed",vt&&this.parentElement.updateRankingChoices(!0)}}get draggedElementType(){return"ranking-item"}createDraggedElementShortcut(e,t,s){const i=oe.createElement("div");if(!i)return;i.className=this.shortcutClass+" sv-ranking-shortcut";const a=t.cloneNode(!0);i.appendChild(a);const o=t.getBoundingClientRect();i.style.left=o.x,i.style.top=o.y,this.domAdapter.rootElement.append(i);const l=i.offsetHeight;let u=s.clientY;return u>o.y+l&&(u=o.y+l-10),i.shortcutXOffset=s.clientX-o.x,i.shortcutYOffset=u-o.y,this.parentElement&&this.parentElement.useFullItemSizeForShortcut&&(i.style.width=t.offsetWidth+"px",i.style.height=t.offsetHeight+"px"),i}get shortcutClass(){return new j().append(this.parentElement.cssClasses.root).append(this.parentElement.cssClasses.rootMobileMod,bd).toString()}getDropTargetByDataAttributeValue(e){return this.parentElement.rankingChoices[e]}findDropTargetNodeByDragOverNode(e){return this.isDragOverRootNode=this.getIsDragOverRootNode(e),super.findDropTargetNodeByDragOverNode(e)}getIsDragOverRootNode(e){return typeof e.className=="string"&&e.className.indexOf("sv-ranking")!==-1}isDropTargetValid(e,t){return this.parentElement.rankingChoices.indexOf(e)!==-1}calculateIsBottom(e,t){return this.dropTarget instanceof fe&&this.draggedElement!==this.dropTarget?super.calculateIsBottom(e,t):!1}getIndices(e,t,s){let i=t.indexOf(this.draggedElement),r=s.indexOf(this.dropTarget);return i<0&&this.draggedElement&&(this.draggedElement=fe.getItemByValue(t,this.draggedElement.value)||this.draggedElement,i=t.indexOf(this.draggedElement)),r===-1?r=e.value.length:t==s?(!this.isBottom&&i<r&&r--,this.isBottom&&i>r&&r++):t!=s&&this.isBottom&&r++,{fromIndex:i,toIndex:r}}afterDragOver(e){const{fromIndex:t,toIndex:s}=this.getIndices(this.parentElement,this.parentElement.rankingChoices,this.parentElement.rankingChoices);this.reorderRankedItem(this.parentElement,t,s)}updateDraggedElementShortcut(e){var t;if(!((t=this.domAdapter)===null||t===void 0)&&t.draggedElementShortcut){const s=e!==null?e+"":"",i=this.domAdapter.draggedElementShortcut.querySelector(".sv-ranking-item__index");i.innerText=s}}ghostPositionChanged(){this.parentElement.currentDropTarget=this.draggedElement,super.ghostPositionChanged()}doDrop(){return this.parentElement.setValue(),this.parentElement}clear(){this.parentElement&&(this.parentElement.dropTargetNodeMove=null,this.parentElement.updateRankingChoices(!0)),super.clear()}}class q_ extends X1{constructor(){super(...arguments),this.selectToRank=(e,t,s)=>{const i=[].concat(e.rankingChoices),a=e.unRankingChoices[t];i.splice(s,0,a),this.updateChoices(e,i)},this.unselectFromRank=(e,t,s)=>{const i=[].concat(e.rankingChoices);i.splice(t,1),this.updateChoices(e,i)}}findDropTargetNodeByDragOverNode(e){if(e.dataset.ranking==="from-container"||e.dataset.ranking==="to-container")return e;let t=e.closest("[data-ranking='to-container']"),s=e.closest("[data-ranking='from-container']");return this.parentElement.unRankingChoices.length===0&&s?s:this.parentElement.rankingChoices.length===0&&t?t:super.findDropTargetNodeByDragOverNode(e)}getDropTargetByDataAttributeValue(e){return this.parentElement.rankingChoices[e]||this.parentElement.unRankingChoices[e]}getDropTargetByNode(e,t){return e.dataset.ranking==="to-container"?"to-container":e.dataset.ranking==="from-container"||e.closest("[data-ranking='from-container']")?"from-container":super.getDropTargetByNode(e,t)}isDropTargetValid(e,t){return e==="to-container"||e==="from-container"?!0:super.isDropTargetValid(e,t)}afterDragOver(e){const t=this.parentElement,s=t.rankingChoices,i=t.unRankingChoices;if(this.isDraggedElementUnranked&&this.isDropTargetRanked){this.doRankBetween(e,i,s,this.selectToRank);return}if(this.isDraggedElementRanked&&this.isDropTargetRanked){this.doRankBetween(e,s,s,this.reorderRankedItem);return}if(this.isDraggedElementRanked&&!this.isDropTargetRanked){this.doRankBetween(e,s,i,this.unselectFromRank);return}}doRankBetween(e,t,s,i){const r=this.parentElement;let{fromIndex:a,toIndex:o}=this.getIndices(r,t,s);i(r,a,o,e)}get isDraggedElementRanked(){return this.parentElement.rankingChoices.indexOf(this.draggedElement)!==-1}get isDropTargetRanked(){return this.dropTarget==="to-container"?!0:this.parentElement.rankingChoices.indexOf(this.dropTarget)!==-1}get isDraggedElementUnranked(){return!this.isDraggedElementRanked}updateChoices(e,t){e.isValueSetByUser=!0,e.rankingChoices=t,e.updateUnRankingChoices(t)}}class Zs extends ml{constructor(e){super(e),this.domNode=null,this.onVisibleChoicesChanged=()=>{if(super.onVisibleChoicesChanged(),this.carryForwardStartUnranked&&!this.isValueSetByUser&&!this.selectToRankEnabled&&!this.defaultValue&&(this.value=[]),this.visibleChoices.length===1&&!this.selectToRankEnabled){this.value=[],this.value.push(this.visibleChoices[0].value),this.updateRankingChoices();return}if(this.isEmpty()){this.updateRankingChoices();return}if(this.selectToRankEnabled){this.updateRankingChoices();return}this.visibleChoices.length>this.value.length&&this.addToValueByVisibleChoices(),this.visibleChoices.length<this.value.length&&this.removeFromValueByVisibleChoices(),this.updateRankingChoices()},this.localeChanged=()=>{super.localeChanged(),this.updateRankingChoicesSync()},this._rankingChoicesAnimation=new Xi(this.getChoicesAnimationOptions(!0),t=>{this._renderedRankingChoices=t},()=>this.renderedRankingChoices),this._unRankingChoicesAnimation=new Xi(this.getChoicesAnimationOptions(!1),t=>{this._renderedUnRankingChoices=t},()=>this.renderedUnRankingChoices),this.rankingChoices=[],this.unRankingChoices=[],this._renderedRankingChoices=[],this._renderedUnRankingChoices=[],this.handlePointerDown=(t,s,i)=>{const r=t.target;this.isDragStartNodeValid(r)&&this.isAllowStartDrag(r,s)&&(this.draggedChoiceValue=s.value,this.draggedTargetNode=i,this.dragOrClickHelper.onPointerDown(t))},this.startDrag=t=>{const s=fe.getItemByValue(this.visibleChoices,this.draggedChoiceValue);this.dragDropRankingChoices.startDrag(t,s,this,this.draggedTargetNode)},this.handlePointerUp=(t,s,i)=>{if(!this.selectToRankEnabled)return;const r=t.target;this.isAllowStartDrag(r,s)&&this.handleKeydownSelectToRank(t,s," ",!1)},this.handleKeydown=(t,s)=>{if(!this.isReadOnlyAttr&&!this.isDesignMode){const i=t.key,r=this.rankingChoices.indexOf(s);if(this.selectToRankEnabled){this.handleKeydownSelectToRank(t,s);return}if(i==="ArrowUp"&&r||i==="ArrowDown"&&r!==this.rankingChoices.length-1){const a=i=="ArrowUp"?r-1:r+1;this.dragDropRankingChoices.reorderRankedItem(this,r,a),this.setValueAfterKeydown(a,"",!0,t)}}},this.focusItem=(t,s)=>{if(this.domNode)if(this.selectToRankEnabled&&s){const i="[data-ranking='"+s+"']";this.domNode.querySelectorAll(i+" ."+this.cssClasses.item)[t].focus()}else this.domNode.querySelectorAll("."+this.cssClasses.item)[t].focus()},this.isValueSetByUser=!1,this.setValue=()=>{const t=[];this.rankingChoices.forEach(s=>{t.push(s.value)}),this.value=t,this.isValueSetByUser=!0},this.registerFunctionOnPropertyValueChanged("selectToRankEnabled",()=>{this.clearValue(!0),this.setDragDropRankingChoices(),this.updateRankingChoicesSync()}),this.dragOrClickHelper=new Od(this.startDrag)}getType(){return"ranking"}supportElementsInChoice(){return!1}getItemTabIndex(e){if(!(this.isDesignMode||e.disabled))return 0}supportContainerQueries(){return this.selectToRankEnabled}get rootClass(){return new j().append(this.cssClasses.root).append(this.cssClasses.rootMobileMod,this.isMobileMode()).append(this.cssClasses.rootDisabled,this.isDisabledStyle).append(this.cssClasses.rootReadOnly,this.isReadOnlyStyle).append(this.cssClasses.rootPreview,this.isPreviewStyle).append(this.cssClasses.rootDesignMode,!!this.isDesignMode).append(this.cssClasses.itemOnError,this.hasCssError()).append(this.cssClasses.rootDragHandleAreaIcon,D.rankingDragHandleArea==="icon").append(this.cssClasses.rootSelectToRankMod,this.selectToRankEnabled).append(this.cssClasses.rootSelectToRankEmptyValueMod,this.isEmpty()).append(this.cssClasses.rootSelectToRankAlignHorizontal,this.selectToRankEnabled&&this.renderedSelectToRankAreasLayout==="horizontal").append(this.cssClasses.rootSelectToRankAlignVertical,this.selectToRankEnabled&&this.renderedSelectToRankAreasLayout==="vertical").append(this.cssClasses.rootSelectToRankSwapAreas,this.selectToRankEnabled&&this.renderedSelectToRankAreasLayout==="horizontal"&&this.selectToRankSwapAreas).toString()}isItemSelectedCore(e){return this.selectToRankEnabled?super.isItemSelectedCore(e):!0}getItemClassCore(e,t){return new j().append(super.getItemClassCore(e,t)).append(this.cssClasses.itemGhostMod,this.currentDropTarget===e).toString()}getContainerClasses(e){let t=!1;const s=e==="to",i=e==="from";return s?t=this.renderedRankingChoices.length===0:i&&(t=this.renderedUnRankingChoices.length===0),new j().append(this.cssClasses.container).append(this.cssClasses.containerToMode,s).append(this.cssClasses.containerFromMode,i).append(this.cssClasses.containerEmptyMode,t).toString()}isItemCurrentDropTarget(e){return this.dragDropRankingChoices.dropTarget===e}get ghostPositionCssClass(){return this.ghostPosition==="top"?this.cssClasses.dragDropGhostPositionTop:this.ghostPosition==="bottom"?this.cssClasses.dragDropGhostPositionBottom:""}getItemIndexClasses(e){let t;return this.selectToRankEnabled?t=this.unRankingChoices.indexOf(e)!==-1:t=this.isEmpty(),new j().append(this.cssClasses.itemIndex).append(this.cssClasses.itemIndexEmptyMode,t).toString()}getNumberByIndex(e){return this.isEmpty()?"":e+1+""}updateRankingChoicesSync(){this.blockAnimations(),this.updateRankingChoices(),this.releaseAnimations()}setSurveyImpl(e,t){super.setSurveyImpl(e,t),this.setDragDropRankingChoices(),this.updateRankingChoicesSync()}isAnswerCorrect(){return L.isArraysEqual(this.value,this.correctAnswer,!1)}get requireStrictCompare(){return!0}onSurveyValueChanged(e){super.onSurveyValueChanged(e),!this.isLoadingFromJson&&this.updateRankingChoices()}onSurveyLoad(){this.blockAnimations(),super.onSurveyLoad(),this.updateRankingChoices(),this.releaseAnimations()}updateValueFromSurvey(e,t){super.updateValueFromSurvey(e,t),e&&(this.isValueSetByUser=!0)}addToValueByVisibleChoices(){const e=this.value.slice();this.visibleChoices.forEach(t=>{e.indexOf(t.value)===-1&&e.push(t.value)}),this.value=e}removeFromValueByVisibleChoices(){const e=this.value.slice(),t=this.visibleChoices;for(let s=this.value.length-1;s>=0;s--)fe.getItemByValue(t,this.value[s])||e.splice(s,1);this.value=e}getChoicesAnimationOptions(e){return{getKey(t){return t.value},getRerenderEvent:()=>this.onElementRerendered,isAnimationEnabled:()=>this.animationAllowed&&!this.isDesignMode&&this.isVisible&&!!this.domNode,getReorderOptions:(t,s)=>{let i="";return t!==this.currentDropTarget&&(i=s?"sv-dragdrop-movedown":"sv-dragdrop-moveup"),{cssClass:i}},getLeaveOptions:t=>{const s=e?this.renderedRankingChoices:this.renderedUnRankingChoices;return this.renderedSelectToRankAreasLayout=="vertical"&&s.length==1&&s.indexOf(t)>=0?{cssClass:"sv-ranking-item--animate-item-removing-empty"}:{cssClass:"sv-ranking-item--animate-item-removing",onBeforeRunAnimation:i=>{i.style.setProperty("--animation-height",i.offsetHeight+"px")}}},getEnterOptions:t=>{const s=e?this.renderedRankingChoices:this.renderedUnRankingChoices;return this.renderedSelectToRankAreasLayout=="vertical"&&s.length==1&&s.indexOf(t)>=0?{cssClass:"sv-ranking-item--animate-item-adding-empty"}:{cssClass:"sv-ranking-item--animate-item-adding",onBeforeRunAnimation:i=>{i.style.setProperty("--animation-height",i.offsetHeight+"px")}}},getAnimatedElement:t=>{var s;const i=this.cssClasses;let r="";this.selectToRankEnabled&&(!e&&i.containerFromMode?r=ls(i.containerFromMode):e&&i.containerToMode&&(r=ls(i.containerToMode)));const a=e?this.renderedRankingChoices.indexOf(t):this.renderedUnRankingChoices.indexOf(t);return(s=this.domNode)===null||s===void 0?void 0:s.querySelector(`${r} [data-sv-drop-target-ranking-item='${a}']`)},allowSyncRemovalAddition:!0}}get rankingChoicesAnimation(){return this._rankingChoicesAnimation}get unRankingChoicesAnimation(){return this._unRankingChoicesAnimation}get renderedRankingChoices(){return this._renderedRankingChoices}set renderedRankingChoices(e){this.rankingChoicesAnimation.sync(e)}get renderedUnRankingChoices(){return this._renderedUnRankingChoices}set renderedUnRankingChoices(e){this.unRankingChoicesAnimation.sync(e)}updateRenderedRankingChoices(){this.renderedRankingChoices=this.rankingChoices}updateRenderedUnRankingChoices(){this.renderedUnRankingChoices=this.unRankingChoices}updateRankingChoices(e=!1){if(this.selectToRankEnabled){this.updateRankingChoicesSelectToRankMode(e);return}const t=[];if(e&&(this.rankingChoices=[]),this.isEmpty()){this.rankingChoices=this.visibleChoices;return}this.value.forEach(s=>{this.visibleChoices.forEach(i=>{i.value===s&&t.push(i)})}),this.rankingChoices=t}updateUnRankingChoices(e){const t=[];this.visibleChoices.forEach(s=>{t.push(s)}),e.forEach(s=>{t.forEach((i,r)=>{i.value===s.value&&t.splice(r,1)})}),this.unRankingChoices=t}updateRankingChoicesSelectToRankMode(e){const t=[];this.isEmpty()||this.value.forEach(s=>{this.visibleChoices.forEach(i=>{i.value===s&&t.push(i)})}),this.updateUnRankingChoices(t),this.rankingChoices=t}endLoadingFromJson(){super.endLoadingFromJson(),this.setDragDropRankingChoices()}setDragDropRankingChoices(){this.dragDropRankingChoices=this.createDragDropRankingChoices()}createDragDropRankingChoices(){return this.selectToRankEnabled?new q_(this.survey,null,this.longTap):new X1(this.survey,null,this.longTap)}isDragStartNodeValid(e){return D.rankingDragHandleArea==="icon"?e.classList.contains(this.cssClasses.itemIconHoverMod):!0}isAllowStartDrag(e,t){return!this.isReadOnly&&!this.isDesignMode&&this.canStartDragDueMaxSelectedChoices(e)&&this.canStartDragDueItemEnabled(t)}canStartDragDueMaxSelectedChoices(e){return this.selectToRankEnabled&&e.closest("[data-ranking='from-container']")?this.checkMaxSelectedChoicesUnreached():!0}canStartDragDueItemEnabled(e){return e.enabled}checkMaxSelectedChoicesUnreached(){if(this.maxSelectedChoices<1)return!0;var e=this.value,t=Array.isArray(e)?e.length:0;return t<this.maxSelectedChoices}afterRenderQuestionElement(e){this.domNode=e,super.afterRenderQuestionElement(e)}beforeDestroyQuestionElement(e){this.domNode=void 0,super.beforeDestroyQuestionElement(e)}supportSelectAll(){return!1}supportOther(){return!1}supportNone(){return!1}supportRefuse(){return!1}supportDontKnow(){return!1}handleKeydownSelectToRank(e,t,s,i=!0){if(this.isDesignMode)return;let r=e.key;if(s&&(r=s),r!==" "&&r!=="ArrowUp"&&r!=="ArrowDown")return;const a=this.dragDropRankingChoices,o=this.rankingChoices,l=o.indexOf(t)!==-1,d=(l?o:this.unRankingChoices).indexOf(t);if(d<0)return;let h;if(r===" "&&!l){if(!this.checkMaxSelectedChoicesUnreached()||!this.canStartDragDueItemEnabled(t))return;h=this.value.length,a.selectToRank(this,d,h),this.setValueAfterKeydown(h,"to-container",i,e);return}if(!l)return;if(r===" "){a.unselectFromRank(this,d),h=this.unRankingChoices.indexOf(t),this.setValueAfterKeydown(h,"from-container",i,e);return}const f=r==="ArrowUp"?-1:r==="ArrowDown"?1:0;f!==0&&(h=d+f,!(h<0||h>=o.length)&&(a.reorderRankedItem(this,d,h),this.setValueAfterKeydown(h,"to-container",i,e)))}setValueAfterKeydown(e,t,s=!0,i){this.setValue(),s&&setTimeout(()=>{this.focusItem(e,t)},1),i&&i.preventDefault()}getIconHoverCss(){return new j().append(this.cssClasses.itemIcon).append(this.cssClasses.itemIconHoverMod).toString()}getIconFocusCss(){return new j().append(this.cssClasses.itemIcon).append(this.cssClasses.itemIconFocusMod).toString()}get longTap(){return this.getPropertyValue("longTap")}set longTap(e){this.setPropertyValue("longTap",e)}getDefaultItemComponent(){return"sv-ranking-item"}get selectToRankEnabled(){return this.getPropertyValue("selectToRankEnabled",!1)}set selectToRankEnabled(e){this.setPropertyValue("selectToRankEnabled",e)}get selectToRankSwapAreas(){return this.getPropertyValue("selectToRankSwapAreas",!1)}set selectToRankSwapAreas(e){this.setPropertyValue("selectToRankSwapAreas",e)}get selectToRankAreasLayout(){return this.getPropertyValue("selectToRankAreasLayout")}set selectToRankAreasLayout(e){this.setPropertyValue("selectToRankAreasLayout",e)}get renderedSelectToRankAreasLayout(){return this.isMobileMode()?"vertical":this.selectToRankAreasLayout}isMobileMode(){return bd}get useFullItemSizeForShortcut(){return this.getPropertyValue("useFullItemSizeForShortcut")}set useFullItemSizeForShortcut(e){this.setPropertyValue("useFullItemSizeForShortcut",e)}get dragDropSvgIcon(){return this.cssClasses.dragDropSvgIconId||"#icon-drag-24x24"}get arrowsSvgIcon(){return this.cssClasses.arrowsSvgIconId||"#icon-reorder-24x24"}get dashSvgIcon(){return this.cssClasses.dashSvgIconId||"#icon-rankingundefined-16x16"}get isNewA11yStructure(){return!1}}I([Ft({onSet:(n,e)=>e.updateRenderedRankingChoices(),onRemove:(n,e,t)=>t.updateRenderedRankingChoices(),onPush:(n,e,t)=>t.updateRenderedRankingChoices()})],Zs.prototype,"rankingChoices",void 0),I([Ft({onSet:(n,e)=>e.updateRenderedUnRankingChoices(),onRemove:(n,e,t)=>t.updateRenderedUnRankingChoices(),onPush:(n,e,t)=>t.updateRenderedUnRankingChoices()})],Zs.prototype,"unRankingChoices",void 0),I([Ft()],Zs.prototype,"_renderedRankingChoices",void 0),I([Ft()],Zs.prototype,"_renderedUnRankingChoices",void 0),I([R({defaultValue:null})],Zs.prototype,"currentDropTarget",void 0),I([R({defaultValue:!0})],Zs.prototype,"carryForwardStartUnranked",void 0),I([R({localizable:{defaultStr:"selectToRankEmptyRankedAreaText"}})],Zs.prototype,"selectToRankEmptyRankedAreaText",void 0),I([R({localizable:{defaultStr:"selectToRankEmptyUnrankedAreaText"}})],Zs.prototype,"selectToRankEmptyUnrankedAreaText",void 0),B.addClass("ranking",[{name:"showOtherItem",visible:!1,isSerializable:!1},{name:"otherText",visible:!1,isSerializable:!1},{name:"otherErrorText",visible:!1,isSerializable:!1},{name:"storeOthersAsComment",visible:!1,isSerializable:!1},{name:"showNoneItem",visible:!1,isSerializable:!1},{name:"showRefuseItem",visible:!1,isSerializable:!1},{name:"showDontKnowItem",visible:!1,isSerializable:!1},{name:"noneText",visible:!1,isSerializable:!1},{name:"showSelectAllItem",visible:!1,isSerializable:!1},{name:"selectAllText",visible:!1,isSerializable:!1},{name:"colCount:number",visible:!1,isSerializable:!1},{name:"separateSpecialChoices",visible:!1,isSerializable:!1},{name:"longTap",default:!0,visible:!1,isSerializable:!1},{name:"selectToRankEnabled:switch",default:!1,visible:!0,isSerializable:!0},{name:"selectToRankSwapAreas:switch",default:!1,visible:!1,isSerializable:!0,dependsOn:"selectToRankEnabled"},{name:"selectToRankAreasLayout",default:"horizontal",choices:["horizontal","vertical"],dependsOn:"selectToRankEnabled",visibleIf:n=>!!n.selectToRankEnabled,visible:!0,isSerializable:!0},{name:"selectToRankEmptyRankedAreaText:text",serializationProperty:"locSelectToRankEmptyRankedAreaText",category:"general",dependsOn:"selectToRankEnabled",visibleIf:n=>!!n.selectToRankEnabled},{name:"selectToRankEmptyUnrankedAreaText:text",serializationProperty:"locSelectToRankEmptyUnrankedAreaText",category:"general",dependsOn:"selectToRankEnabled",visibleIf:n=>!!n.selectToRankEnabled},{name:"maxSelectedChoices:number",visible:!0,default:0,dependsOn:"selectToRankEnabled",visibleIf:n=>!!n.selectToRankEnabled,isSerializable:!0},{name:"minSelectedChoices:number",visible:!0,default:0,dependsOn:"selectToRankEnabled",visibleIf:n=>!!n.selectToRankEnabled,isSerializable:!0},{name:"itemComponent",visible:!1,default:"sv-ranking-item"}],function(){return new Zs("")},"checkbox"),Qe.Instance.registerQuestion("ranking",n=>{const e=new Zs(n);return e.choices=Qe.DefaultChoices,e});class eb extends cl{constructor(e){super(e)}get textAreaModel(){return this.textAreaModelValue||(this.textAreaModelValue=new Rd(this.getTextAreaOptions())),this.textAreaModelValue}getTextAreaOptions(){const e=this,t=i=>{L.isTwoValueEquals(e.value,i,!1,!0,!1)||(e.value=i)};return{question:this,id:()=>this.inputId,propertyNames:["value"],className:()=>this.className,placeholder:()=>this.renderedPlaceholder,isDisabledAttr:()=>this.isDisabledAttr,isReadOnlyAttr:()=>this.isReadOnlyAttr,autoGrow:()=>this.renderedAutoGrow,maxLength:()=>this.getMaxLength(),rows:()=>this.rows,cols:()=>this.cols,ariaRequired:()=>this.a11y_input_ariaRequired,ariaLabel:()=>this.a11y_input_ariaLabel,ariaLabelledBy:()=>this.a11y_input_ariaLabelledBy,ariaDescribedBy:()=>this.a11y_input_ariaDescribedBy,ariaInvalid:()=>this.a11y_input_ariaInvalid,ariaErrormessage:()=>this.a11y_input_ariaErrormessage,getTextValue:()=>this.value,onTextAreaChange:i=>{t(i.target.value)},onTextAreaInput:i=>{this.onInput(i)},onTextAreaKeyDown:i=>{this.onKeyDown(i)},onTextAreaFocus:i=>{this.onFocus(i)},onTextAreaBlur:i=>{this.onBlur(i)}}}get rows(){return this.getPropertyValue("rows")}set rows(e){this.setPropertyValue("rows",e)}get cols(){return this.getPropertyValue("cols")}set cols(e){this.setPropertyValue("cols",e)}get acceptCarriageReturn(){return this.getPropertyValue("acceptCarriageReturn")}set acceptCarriageReturn(e){this.setPropertyValue("acceptCarriageReturn",e)}get autoGrow(){return this.getPropertyValue("autoGrow")}set autoGrow(e){this.setPropertyValue("autoGrow",e)}get renderedAutoGrow(){const e=this.autoGrow;return e===void 0&&this.survey?this.survey.autoGrowComment:!!e}get allowResize(){return this.getPropertyValue("allowResize")}set allowResize(e){this.setPropertyValue("allowResize",e)}get renderedAllowResize(){const e=this.allowResize;return e===void 0&&this.survey?this.survey.allowResizeComment:!!e}get resizeStyle(){return this.renderedAllowResize?"both":"none"}getType(){return"comment"}afterRenderQuestionElement(e){this.element=e?.querySelector(`#${this.inputId}`)||e,super.afterRenderQuestionElement(e)}beforeDestroyQuestionElement(e){super.beforeDestroyQuestionElement(e),this.element=void 0}onInput(e){this.isInputTextUpdate&&(this.value=e.target.value),this.updateRemainingCharacterCounter(e.target.value)}onBlurCore(e){super.onBlurCore(e)}onKeyDown(e){this.onKeyDownPreprocess&&this.onKeyDownPreprocess(e),!this.acceptCarriageReturn&&(e.key==="Enter"||e.keyCode===13)&&(e.preventDefault(),e.stopPropagation())}setNewValue(e){!this.acceptCarriageReturn&&e&&(e=e.replace(new RegExp(`(\r
|
|\r)`,"gm"),"")),super.setNewValue(e)}getValueSeparator(){return`
`}notifyStateChanged(e){super.notifyStateChanged(e),this.isCollapsed||this.textAreaModel.updateElement()}get className(){return(this.cssClasses?this.getControlClass():"panel-comment-root")||void 0}}B.addClass("comment",[{name:"maxLength:number",default:-1},{name:"cols:number",default:50,visible:!1,isSerializable:!1},{name:"rows:number",default:4},{name:"placeholder",alternativeName:"placeHolder",serializationProperty:"locPlaceholder"},{name:"textUpdateMode",default:"default",choices:["default","onBlur","onTyping"]},{name:"autoGrow:boolean",defaultFunc:()=>{}},{name:"allowResize:boolean",defaultFunc:()=>{}},{name:"acceptCarriageReturn:boolean",default:!0,visible:!1}],function(){return new eb("")},"textbase"),Qe.Instance.registerQuestion("comment",n=>new eb(n));const _n="environment",Bi="user";class He{constructor(){this.canFlipValue=void 0}static clear(){He.cameraList=void 0,He.cameraIndex=-1}static setCameraList(e){const t=function(s){const i=s.label.toLocaleLowerCase();return i.indexOf(Bi)>-1?Bi:i.indexOf(_n)>-1?_n:i.indexOf("front")>-1?Bi:i.indexOf("back")>-1?_n:""};He.clear(),Array.isArray(e)&&e.length>0&&(He.cameraIndex=-1,e.sort((s,i)=>{if(s===i)return 0;if(s.label!==i.label){const o=t(s),l=t(i);if(o!==l){if(o===Bi)return-1;if(l===Bi)return 1;if(o===_n)return-1;if(l===_n)return 1}}const r=e.indexOf(s),a=e.indexOf(i);return r<a?-1:1})),He.cameraList=e}hasCamera(e){if(He.cameraList!==void 0){this.hasCameraCallback(e);return}if(He.mediaDevicesCallback){const t=s=>{this.setVideoInputs(s),this.hasCameraCallback(e)};He.mediaDevicesCallback(t);return}typeof navigator<"u"&&navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then(t=>{this.setVideoInputs(t),this.hasCameraCallback(e),this.updateCanFlipValue()}).catch(t=>{He.cameraList=null,this.hasCameraCallback(e)}):(He.cameraList=null,this.hasCameraCallback(e))}getMediaConstraints(e){const t=He.cameraList;if(!Array.isArray(t)||t.length<1)return;He.cameraIndex<0&&(He.cameraIndex=0);const s=t[He.cameraIndex],i={};return s&&s.deviceId?i.deviceId={exact:s.deviceId}:i.facingMode=He.cameraFacingMode,e&&(e?.height&&(i.height={ideal:e.height}),e?.width&&(i.width={ideal:e.width})),{video:i,audio:!1}}startVideo(e,t,s,i){if(!e){t(void 0);return}e.style.width="100%",e.style.height="auto",e.style.height="100%",e.style.objectFit="contain";const r=this.getMediaConstraints({width:s,height:i});navigator.mediaDevices.getUserMedia(r).then(a=>{var o;e.srcObject=a,!(!((o=He.cameraList[He.cameraIndex])===null||o===void 0)&&o.deviceId)&&a.getTracks()[0].getCapabilities().facingMode&&(He.canSwitchFacingMode=!0,this.updateCanFlipValue()),e.play(),t(a)}).catch(a=>{t(void 0)})}getImageSize(e){return{width:e.videoWidth,height:e.videoHeight}}snap(e,t){if(!e||!oe.isAvailable())return!1;const i=oe.getDocument().createElement("canvas"),r=this.getImageSize(e);i.height=r.height,i.width=r.width;let a=i.getContext("2d");return a.clearRect(0,0,i.width,i.height),a.drawImage(e,0,0,i.width,i.height),i.toBlob(t,"image/png"),!0}updateCanFlipValue(){const e=He.cameraList;this.canFlipValue=Array.isArray(e)&&e.length>1||He.canSwitchFacingMode,this.onCanFlipChangedCallback&&this.onCanFlipChangedCallback(this.canFlipValue)}canFlip(e){return this.canFlipValue===void 0&&this.updateCanFlipValue(),e&&(this.onCanFlipChangedCallback=e),this.canFlipValue}flip(){this.canFlip()&&(He.canSwitchFacingMode?He.cameraFacingMode=He.cameraFacingMode===Bi?"environment":Bi:He.cameraIndex>=He.cameraList.length-1?He.cameraIndex=0:He.cameraIndex++)}hasCameraCallback(e){e(Array.isArray(He.cameraList))}setVideoInputs(e){const t=[];e.forEach(s=>{s.kind==="videoinput"&&t.push(s)}),He.setCameraList(t.length>0?t:null)}}He.cameraIndex=-1,He.cameraFacingMode=Bi,He.canSwitchFacingMode=!1;function B_(n,e,t){const s=atob(n.split(",")[1]),i=new Uint8Array(s.split("").map(r=>r.charCodeAt(0))).buffer;return new File([i],e,{type:t})}class fl extends kt{constructor(){super(...arguments),this.isUploading=!1,this.onUploadStateChanged=this.addEvent(),this.onStateChanged=this.addEvent()}stateChanged(e){this.currentState!=e&&(e==="loading"&&(this.isUploading=!0),e==="loaded"&&(this.isUploading=!1),e==="error"&&(this.isUploading=!1),this.currentState=e,this.onStateChanged.fire(this,{state:e}),this.onUploadStateChanged.fire(this,{state:e}))}get showLoadingIndicator(){return this.isUploading}get storeDataAsText(){return this.getPropertyValue("storeDataAsText")}set storeDataAsText(e){this.setPropertyValue("storeDataAsText",e)}get waitForUpload(){return this.getPropertyValue("waitForUpload")}set waitForUpload(e){this.setPropertyValue("waitForUpload",e)}clearValue(e,t){this.clearOnDeletingContainer(),super.clearValue(e,t)}clearOnDeletingContainer(){this.survey&&this.survey.clearFiles(this,this.name,this.value,null,()=>{})}onCheckForErrors(e,t,s){super.onCheckForErrors(e,t,s),this.isUploading&&this.waitForUpload&&e.push(new tl(this.getLocalizationString("uploadingFile"),this))}uploadFiles(e,t){this.survey&&(this.errors=[],this.stateChanged("loading"),this.survey.uploadFiles(this,this.name,e,(s,i)=>{Array.isArray(s)&&(this.setValueFromResult(s),Array.isArray(i)&&(i.forEach(r=>this.errors.push(new tl(r,this))),this.stateChanged("error"))),s==="success"&&Array.isArray(i)&&this.setValueFromResult(i),s==="error"&&(typeof i=="string"&&this.errors.push(new tl(i,this)),Array.isArray(i)&&i.length>0&&i.forEach(r=>this.errors.push(new tl(r,this))),this.stateChanged("error")),this.stateChanged("loaded")},t))}loadPreview(e){}onChangeQuestionValue(e){super.onChangeQuestionValue(e),this.stateChanged(this.isEmpty()?"empty":"loaded")}getIsQuestionReady(){return super.getIsQuestionReady()&&!this.isFileLoading}get isFileLoading(){return this.isFileLoadingValue}set isFileLoading(e){this.isFileLoadingValue=e,this.updateIsReady()}}I([R()],fl.prototype,"isUploading",void 0),I([R({defaultValue:"empty"})],fl.prototype,"currentState",void 0);class zr extends de{static getId(){return"sv_sfp_"+zr.pageCounter++}constructor(e,t){super(),this.question=e,this.index=t,this.id=zr.getId()}get css(){return this.question.cssClasses.page}}zr.pageCounter=0,I([Ft({})],zr.prototype,"items",void 0);class ut extends fl{get fileNavigatorVisible(){const e=this.showLoadingIndicator,t=this.isPlayingVideo,s=this.containsMultiplyFiles,i=this.pageSize<this.previewValue.length;return!e&&!t&&s&&i}get pagesCount(){return Math.ceil(this.previewValue.length/this.pageSize)}get actionsContainerVisible(){const e=this.showLoadingIndicator,t=this.isPlayingVideo;return!e&&!t}constructor(e){super(e),this.isDragging=!1,this.fileNavigator=new Vt,this.canFlipCameraValue=void 0,this.prevPreviewLength=0,this.isClearingFiles=!1,this._renderedPages=[],this.pagesAnimation=new m1(this.getPagesAnimationOptions(),t=>{this._renderedPages=t},()=>this.renderedPages),this.calcAvailableItemsCount=(t,s,i)=>{let r=Math.floor(t/(s+i));return(r+1)*(s+i)-i<=t&&r++,r},this.dragCounter=0,this.onDragEnter=t=>{this.canDragDrop()&&(t.preventDefault(),this.isDragging=!0,this.dragCounter++)},this.onDragOver=t=>{if(!this.canDragDrop())return t.returnValue=!1,!1;t.dataTransfer.dropEffect="copy",t.preventDefault()},this.onDrop=t=>{if(this.canDragDrop()){this.isDragging=!1,this.dragCounter=0,t.preventDefault();let s=t.dataTransfer;this.onChange(s)}},this.onDragLeave=t=>{this.canDragDrop()&&(this.dragCounter--,this.dragCounter===0&&(this.isDragging=!1))},this.doChange=t=>{var s=t.target||t.srcElement;this.onChange(s)},this.doClean=()=>{if(this.needConfirmRemoveFile){Go({message:this.confirmRemoveAllMessage,funcOnYes:()=>{this.clearFilesCore()},locale:this.getLocale(),rootElement:this.survey.rootElement,cssClass:this.cssClasses.confirmDialog});return}this.clearFilesCore()},this.doDownloadFileFromContainer=t=>{t.stopPropagation();const s=t.currentTarget;if(s&&s.getElementsByTagName){const i=s.getElementsByTagName("a")[0];i?.click()}},this.doDownloadFile=(t,s)=>{t.stopPropagation(),Jo()&&(t.preventDefault(),pR(s.content,s.name))},this.createLocString({name:"takePhotoCaption",hasTranslation:!0}),this.createLocString({name:"clearCaption",hasTranslation:!0}),this.actionsContainer=new Vt,this.actionsContainer.locOwner=this,this.fileIndexAction=new xe({id:"fileIndex",title:this.getFileIndexCaption(),enabled:!1}),this.prevFileAction=new xe({id:"prevPage",iconSize:16,action:()=>{this.navigationDirection="left",this.indexToShow=this.previewValue.length&&(this.indexToShow-1+this.pagesCount)%this.pagesCount||0,this.fileIndexAction.title=this.getFileIndexCaption()}}),this.nextFileAction=new xe({id:"nextPage",iconSize:16,action:()=>{this.navigationDirection="right",this.indexToShow=this.previewValue.length&&(this.indexToShow+1)%this.pagesCount||0,this.fileIndexAction.title=this.getFileIndexCaption()}}),this.takePictureAction=new xe({iconName:"icon-takepicture",id:"sv-file-take-picture",iconSize:"auto",innerCss:new Ue(()=>new j().append(this.cssClasses.contextButton).append(this.cssClasses.takePictureButton).toString()),locTitle:this.locTakePhotoCaption,showTitle:!1,action:()=>{this.snapPicture()}}),this.closeCameraAction=new xe({iconName:"icon-closecamera",id:"sv-file-close-camera",iconSize:"auto",innerCss:new Ue(()=>new j().append(this.cssClasses.contextButton).append(this.cssClasses.closeCameraButton).toString()),action:()=>{this.stopVideo()}}),this.changeCameraAction=new xe({iconName:"icon-changecamera",id:"sv-file-change-camera",iconSize:"auto",innerCss:new Ue(()=>new j().append(this.cssClasses.contextButton).append(this.cssClasses.changeCameraButton).toString()),visible:new Ue(()=>this.canFlipCamera()),action:()=>{this.flipCamera()}}),this.chooseFileAction=new xe({iconName:"icon-choosefile",id:"sv-file-choose-file",iconSize:"auto",data:{question:this},enabledIf:()=>!this.isInputReadOnly,component:"sv-file-choose-btn"}),this.startCameraAction=new xe({iconName:"icon-takepicture_24x24",id:"sv-file-start-camera",iconSize:"auto",locTitle:this.locTakePhotoCaption,showTitle:new Ue(()=>!this.isAnswered),enabledIf:()=>!this.isInputReadOnly,action:()=>{this.startVideo()}}),this.cleanAction=new xe({iconName:"icon-clear",id:"sv-file-clean",iconSize:"auto",locTitle:this.locClearButtonCaption,showTitle:!1,enabledIf:()=>!this.isInputReadOnly,innerCss:new Ue(()=>this.cssClasses.removeButton),action:()=>{this.doClean()}}),[this.closeCameraAction,this.changeCameraAction,this.takePictureAction].forEach(t=>{t.cssClasses={}}),this.registerFunctionOnPropertiesValueChanged(["sourceType","currentMode","isAnswered"],()=>{this.updateActionsVisibility()}),this.actionsContainer.actions=[this.chooseFileAction,this.startCameraAction,this.cleanAction],this.fileNavigator.actions=[this.prevFileAction,this.fileIndexAction,this.nextFileAction]}get videoId(){return this.id+"_video"}get hasVideoUI(){return this.currentMode!=="file"}get hasFileUI(){return this.currentMode!=="camera"}startVideo(){this.currentMode==="file"||this.isDesignMode||this.isPlayingVideo||(this.setIsPlayingVideo(!0),setTimeout(()=>{this.startVideoInCamera()},0))}get videoHtmlElement(){var e;return(e=this.rootElement)===null||e===void 0?void 0:e.querySelector(`#${this.videoId}`)}startVideoInCamera(){this.camera.startVideo(this.videoHtmlElement,e=>{this.videoStream=e,e||this.stopVideo()},er(this.imageWidth),er(this.imageHeight))}stopVideo(){this.setIsPlayingVideo(!1),this.closeVideoStream()}snapPicture(){if(!this.isPlayingVideo)return;const e=t=>{if(t){const s=new File([t],"snap_picture.png",{type:"image/png"});this.loadFiles([s],"camera")}};this.camera.snap(this.videoHtmlElement,e),this.stopVideo()}canFlipCamera(){return this.canFlipCameraValue===void 0&&(this.canFlipCameraValue=this.camera.canFlip(e=>{this.canFlipCameraValue=e})),this.canFlipCameraValue}flipCamera(){this.canFlipCamera()&&(this.closeVideoStream(),this.camera.flip(),this.startVideoInCamera())}closeVideoStream(){this.videoStream&&(this.videoStream.getTracks().forEach(e=>{e.stop()}),this.videoStream=void 0)}onHidingContent(){super.onHidingContent(),this.stopVideo()}updateElementCssCore(e){super.updateElementCssCore(e),this.prevFileAction.iconName=this.cssClasses.leftIconId,this.nextFileAction.iconName=this.cssClasses.rightIconId,this.updateCurrentMode()}getFileIndexCaption(){return this.getLocalizationFormatString("indexText",this.indexToShow+1,this.pagesCount)}updateFileNavigator(){this.updatePages(),this.navigationDirection=void 0,this.indexToShow=this.previewValue.length&&(this.indexToShow+this.pagesCount)%this.pagesCount||0,this.fileIndexAction.title=this.getFileIndexCaption()}updateRenderedPages(){this.pages&&this.pages[this.indexToShow]&&(this.renderedPages=[this.pages[this.indexToShow]])}updatePages(){this.blockAnimations();let e;this.pages=[],this.renderedPages=[],this.previewValue.forEach((t,s)=>{s%this.pageSize==0&&(e=new zr(this,this.pages.length),this.pages.push(e)),e.items.push(t)}),this.releaseAnimations(),this.updateRenderedPages()}previewValueChanged(){this.navigationDirection=void 0,this.previewValue.length!==this.prevPreviewLength&&(this.previewValue.length>0?this.prevPreviewLength>this.previewValue.length?this.indexToShow>=this.pagesCount&&this.indexToShow>0&&(this.indexToShow=this.pagesCount-1,this.navigationDirection="left-delete"):this.indexToShow=Math.floor(this.prevPreviewLength/this.pageSize):this.indexToShow=0),this.updatePages(),this.fileIndexAction.title=this.getFileIndexCaption(),this.containsMultiplyFiles=this.previewValue.length>1,this.previewValue.length>0&&!this.calculatedGapBetweenItems&&!this.calculatedItemWidth&&setTimeout(()=>{this.processResponsiveness(0,this._width)},1),this.prevPreviewLength=this.previewValue.length}getType(){return"file"}onChangeQuestionValue(e){super.onChangeQuestionValue(e),this.isLoadingFromJson||this.loadPreview(e)}get showPreview(){return this.getPropertyValue("showPreview")}set showPreview(e){this.setPropertyValue("showPreview",e)}get allowMultiple(){return this.getPropertyValue("allowMultiple")}set allowMultiple(e){this.setPropertyValue("allowMultiple",e)}get imageHeight(){return this.getPropertyValue("imageHeight")}set imageHeight(e){this.setPropertyValue("imageHeight",e)}get imageWidth(){return this.getPropertyValue("imageWidth")}set imageWidth(e){this.setPropertyValue("imageWidth",e)}get acceptedTypes(){return this.getPropertyValue("acceptedTypes")}set acceptedTypes(e){this.setPropertyValue("acceptedTypes",e)}get allowImagesPreview(){return this.getPropertyValue("allowImagesPreview")}set allowImagesPreview(e){this.setPropertyValue("allowImagesPreview",e)}get maxSize(){return this.getPropertyValue("maxSize")}set maxSize(e){this.setPropertyValue("maxSize",e)}get maxFiles(){return this.getPropertyValue("maxFiles")}set maxFiles(e){this.setPropertyValue("maxFiles",e)}chooseFile(e){if(!this.rootElement)return;const t=this.rootElement.querySelector(`#${this.inputId}`);t&&(e.preventDefault(),e.stopImmediatePropagation(),t&&(this.survey?this.survey.chooseFiles(t,s=>this.loadFiles(s,"file"),{element:this,elementType:this.getType(),propertyName:this.name}):t.click()))}get needConfirmRemoveFile(){return this.getPropertyValue("needConfirmRemoveFile")}set needConfirmRemoveFile(e){this.setPropertyValue("needConfirmRemoveFile",e)}getConfirmRemoveMessage(e){return this.confirmRemoveMessage.format(e)}get takePhotoCaption(){return this.getLocalizableStringText("takePhotoCaption")}set takePhotoCaption(e){this.setLocalizableStringText("takePhotoCaption",e)}get locTakePhotoCaption(){return this.getLocalizableString("takePhotoCaption")}get clearButtonCaption(){return this.getLocalizableStringText("clearCaption")}set clearButtonCaption(e){this.setLocalizableStringText("clearCaption",e)}get locClearButtonCaption(){return this.getLocalizableString("clearCaption")}get locRenderedPlaceholder(){return this.locRenderedPlaceholderValue===void 0&&(this.locRenderedPlaceholderValue=new Ue(()=>{const e=this.isReadOnly,t=!this.isDesignMode&&this.hasFileUI||this.isDesignMode&&this.sourceType!="camera",s=!this.isDesignMode&&this.hasVideoUI||this.isDesignMode&&this.sourceType!="file";let i;return e?i=this.locNoFileChosenCaption:t&&s?i=this.locFileOrPhotoPlaceholder:t?i=this.locFilePlaceholder:i=this.locPhotoPlaceholder,i})),this.locRenderedPlaceholderValue}get currentMode(){return this.getPropertyValue("currentMode",this.sourceType)}get isPlayingVideo(){return this.getPropertyValue("isPlayingVideo",!1)}setIsPlayingVideo(e){this.setPropertyValue("isPlayingVideo",e)}updateCurrentMode(){!this.isDesignMode&&this.survey&&(this.sourceType!=="file"?this.camera.hasCamera(e=>{this.setPropertyValue("currentMode",e?this.sourceType:"file")}):this.setPropertyValue("currentMode",this.sourceType))}updateActionsVisibility(){const e=this.isDesignMode;this.chooseFileAction.visible=!e&&this.hasFileUI||e&&this.sourceType!=="camera",this.startCameraAction.visible=!e&&this.hasVideoUI||e&&this.sourceType!=="file",this.cleanAction.visible=!!this.isAnswered}get inputTitle(){return this.isUploading?this.loadingFileTitle:this.isEmpty()?this.chooseFileTitle:" "}get chooseButtonText(){return this.isEmpty()||this.allowMultiple?this.chooseButtonCaption:this.replaceButtonCaption}clear(e){this.survey&&(this.containsMultiplyFiles=!1,this.isClearingFiles=!0,this.survey.clearFiles(this,this.name,this.value,null,(t,s)=>{t==="success"&&(this.value=void 0,this.errors=[],e&&e(),this.indexToShow=0,this.fileIndexAction.title=this.getFileIndexCaption(),this.isClearingFiles=!1)}))}get renderCapture(){return this.allowCameraAccess?"user":void 0}get multipleRendered(){return this.allowMultiple?"multiple":void 0}get showFileDecorator(){const e=this.isPlayingVideo,t=this.showLoadingIndicator;return!e&&!t}get showDragAreaPlaceholder(){return!this.isAnswered}get showLoadingIndicator(){return this.isUploading||this.isClearingFiles}get allowShowPreview(){const e=this.showLoadingIndicator,t=this.isPlayingVideo;return!e&&!t}get showPreviewContainer(){return this.previewValue&&this.previewValue.length>0}defaultImage(e){return!this.canPreviewImage(e)&&!!this.cssClasses.defaultImage}removeFile(e){this.removeFileByContent(this.value.filter(t=>t.name===e)[0])}removeFileByContent(e){this.survey&&(this.isClearingFiles=!0,this.survey.clearFiles(this,this.name,this.value,e.name,(t,s)=>{if(t==="success"){var i=this.value;Array.isArray(i)?this.value=i.filter(r=>!L.isTwoValueEquals(r,e,!0,!1,!1)):this.value=void 0,this.isClearingFiles=!1}}))}setValueFromResult(e){this.value=(this.value||[]).concat(e.map(t=>({name:t.file.name,type:t.file.type,content:t.content})))}loadFiles(e,t){if(this.survey&&(this.errors=[],!!this.allFilesOk(e))){var s=()=>{this.stateChanged("loading");var i=[];this.storeDataAsText?e.forEach(r=>{let a=new FileReader;a.onload=o=>{i=i.concat([{name:r.name,type:r.type,content:a.result}]),i.length===e.length&&(this.value=(this.value||[]).concat(i))},a.readAsDataURL(r)}):this.uploadFiles(e,t)};this.allowMultiple?s():this.clear(s)}}get camera(){return this.cameraValue||(this.cameraValue=new He),this.cameraValue}canPreviewImage(e){return this.allowImagesPreview&&!!e&&this.isFileImage(e)}loadPreview(e){if(!(this.showPreview&&this.prevLoadedPreviewValue===e)&&(this.previewValue.splice(0,this.previewValue.length),!(!this.showPreview||!e))){this.prevLoadedPreviewValue=e;var t=Array.isArray(e)?e:e?[e]:[];this.storeDataAsText?(t.forEach(s=>{var i=s.content||s;this.previewValue.push({name:s.name,type:s.type,content:i})}),this.previewValueChanged()):(this._previewLoader&&this._previewLoader.dispose(),this.isFileLoading=!0,this._previewLoader=new tb(this,(s,i)=>{s!=="error"&&(i.forEach(r=>{this.previewValue.push(r)}),this.previewValueChanged()),this.isFileLoading=!1,this._previewLoader.dispose(),this._previewLoader=void 0}),this._previewLoader.load(t))}}allFilesOk(e){var t=this.errors?this.errors.length:0;e=e||[];const s=Array.isArray(this.value)?this.value.length:0;return this.maxFiles>0&&this.maxFiles<e.length+s&&this.errors.push(new OR(this.maxFiles,this)),e.forEach(i=>{this.maxSize>0&&i.size>this.maxSize&&this.errors.push(new DR(this.maxSize,this))}),t===this.errors.length}isFileImage(e){if(!e||!e.content||!e.content.substring)return!1;const t="data:image";var s=e.content&&e.content.substring(0,t.length);s=s&&s.toLowerCase();var i=s===t||!!e.type&&e.type.toLowerCase().indexOf("image/")===0;return i}getPlainData(e={includeEmpty:!0}){var t=super.getPlainData(e);if(t&&!this.isEmpty()){t.isNode=!1;var s=Array.isArray(this.value)?this.value:[this.value];t.data=s.map((i,r)=>({name:r,title:"File",value:i.content&&i.content||i,displayValue:i.name&&i.name||i,getString:a=>typeof a=="object"?JSON.stringify(a):a,isNode:!1}))}return t}getImageWrapperCss(e){return new j().append(this.cssClasses.imageWrapper).append(this.cssClasses.imageWrapperDefaultImage,this.defaultImage(e)).toString()}getActionsContainerCss(e){return new j().append(e.actionsContainer).append(e.actionsContainerAnswered,this.isAnswered).toString()}getRemoveButtonCss(){return new j().append(this.cssClasses.removeFileButton).append(this.cssClasses.contextButton).toString()}getChooseFileCss(){const e=this.isAnswered;return new j().append(this.cssClasses.chooseFile).append(this.cssClasses.controlDisabled,this.isReadOnly).append(this.cssClasses.chooseFileAsText,!e).append(this.cssClasses.chooseFileAsTextDisabled,!e&&this.isInputReadOnly).append(this.cssClasses.contextButton,e).append(this.cssClasses.chooseFileAsIcon,e).toString()}getReadOnlyFileCss(){return new j().append("form-control").append(this.cssClasses.placeholderInput).toString()}get fileRootCss(){return new j().append(this.cssClasses.root).append(this.cssClasses.rootDisabled,this.isDisabledStyle).append(this.cssClasses.rootReadOnly,this.isReadOnlyStyle).append(this.cssClasses.rootPreview,this.isPreviewStyle).append(this.cssClasses.rootDragging,this.isDragging).append(this.cssClasses.rootAnswered,this.isAnswered).append(this.cssClasses.single,!this.allowMultiple).append(this.cssClasses.singleImage,!this.allowMultiple&&this.isAnswered&&this.canPreviewImage(this.value[0])).append(this.cssClasses.mobile,this.isMobile).toString()}getFileDecoratorCss(){return new j().append(this.cssClasses.fileDecorator).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.fileDecoratorDrag,this.isDragging).toString()}onChange(e){if(!he.isFileReaderAvailable()||!e||!e.files||e.files.length<1)return;let t=[],s=this.allowMultiple?e.files.length:1;for(let i=0;i<s;i++)t.push(e.files[i]);e.value="",this.loadFiles(t)}calcCssClasses(e){const t=super.calcCssClasses(e);return this.actionsContainer.cssClasses=e.actionBar,this.actionsContainer.cssClasses.itemWithTitle=this.actionsContainer.cssClasses.item,this.actionsContainer.cssClasses.item="",this.actionsContainer.cssClasses.itemAsIcon=t.contextButton,this.actionsContainer.containerCss=t.actionsContainer,t}onSurveyLoad(){super.onSurveyLoad(),this.updateCurrentMode(),this.updateActionsVisibility(),this.loadPreview(this.value)}needResponsiveness(){return this.supportResponsiveness()}supportResponsiveness(){return!0}getObservedElementSelector(){return ls(this.cssClasses.dragArea)}getFileListSelector(){return ls(this.cssClasses.fileList)}get renderedPages(){return this._renderedPages}set renderedPages(e){this.pagesAnimation.sync(e)}getPagesAnimationOptions(){return{getEnterOptions:e=>{const t=this.cssClasses.page;return{cssClass:t?new j().append(`${t}--enter-from-left`,this.navigationDirection=="left"||this.navigationDirection=="left-delete").append(`${t}--enter-from-right`,this.navigationDirection=="right").toString():""}},getLeaveOptions:e=>{const t=this.cssClasses.page;return{cssClass:t?new j().append(`${t}--leave-to-left`,this.navigationDirection=="right").append(`${t}--leave-to-right`,this.navigationDirection=="left").toString():""}},getAnimatedElement:e=>{var t;return(t=this.rootElement)===null||t===void 0?void 0:t.querySelector(`#${e.id}`)},isAnimationEnabled:()=>this.animationAllowed&&!!this.rootElement,getRerenderEvent:()=>this.onElementRerendered}}triggerResponsiveness(e){e&&(this.calculatedGapBetweenItems=void 0,this.calculatedItemWidth=void 0),super.triggerResponsiveness()}processResponsiveness(e,t){if(this._width=t,this.rootElement&&(!this.calculatedGapBetweenItems||!this.calculatedItemWidth)&&this.allowMultiple){const i=this.getFileListSelector()?this.rootElement.querySelector(this.getFileListSelector()):void 0;if(i){const r=i.querySelector(ls(this.cssClasses.page));if(r){const a=r.querySelector(ls(this.cssClasses.previewItem));this.calculatedGapBetweenItems=Math.ceil(Number.parseFloat(oe.getComputedStyle(r).gap)),a&&(this.calculatedItemWidth=Math.ceil(Number.parseFloat(oe.getComputedStyle(a).width)))}}}return this.calculatedGapBetweenItems&&this.calculatedItemWidth?(this.pageSize=Math.max(this.calcAvailableItemsCount(t,this.calculatedItemWidth,this.calculatedGapBetweenItems),1),!0):!1}canDragDrop(){return!this.isInputReadOnly&&this.currentMode!=="camera"&&!this.isPlayingVideo}afterRenderQuestionElement(e){super.afterRenderQuestionElement(e),this.rootElement=e}beforeDestroyQuestionElement(e){super.beforeDestroyQuestionElement(e),this.stopVideo(),this.rootElement=void 0}clearFilesCore(){if(this.rootElement){const e=this.rootElement.querySelectorAll("input")[0];e&&(e.value="")}this.clear()}doRemoveFile(e,t){if(t.stopPropagation(),this.needConfirmRemoveFile){Go({message:this.getConfirmRemoveMessage(e.name),funcOnYes:()=>{this.removeFileCore(e)},locale:this.getLocale(),rootElement:this.survey.rootElement,cssClass:this.cssClasses.confirmDialog});return}this.removeFileCore(e)}removeFileCore(e){const t=this.previewValue.indexOf(e);this.removeFileByContent(t===-1?e:this.value[t])}dispose(){this.cameraValue=void 0,this.closeVideoStream(),super.dispose()}}I([R()],ut.prototype,"isDragging",void 0),I([Ft({})],ut.prototype,"previewValue",void 0),I([Ft({})],ut.prototype,"pages",void 0),I([R({defaultValue:0,onSet:(n,e)=>{e.updateRenderedPages()}})],ut.prototype,"indexToShow",void 0),I([R({defaultValue:1,onSet:(n,e)=>{e.updateFileNavigator()}})],ut.prototype,"pageSize",void 0),I([R({defaultValue:!1})],ut.prototype,"containsMultiplyFiles",void 0),I([R()],ut.prototype,"allowCameraAccess",void 0),I([R({onSet:(n,e)=>{e.isLoadingFromJson||e.updateCurrentMode()}})],ut.prototype,"sourceType",void 0),I([R()],ut.prototype,"canFlipCameraValue",void 0),I([R({localizable:{defaultStr:"confirmRemoveFile"}})],ut.prototype,"confirmRemoveMessage",void 0),I([R({localizable:{defaultStr:"confirmRemoveAllFiles"}})],ut.prototype,"confirmRemoveAllMessage",void 0),I([R({localizable:{defaultStr:"noFileChosen"}})],ut.prototype,"noFileChosenCaption",void 0),I([R({localizable:{defaultStr:"chooseFileCaption"}})],ut.prototype,"chooseButtonCaption",void 0),I([R({localizable:{defaultStr:"replaceFileCaption"}})],ut.prototype,"replaceButtonCaption",void 0),I([R({localizable:{defaultStr:"removeFileCaption"}})],ut.prototype,"removeFileCaption",void 0),I([R({localizable:{defaultStr:"loadingFile"}})],ut.prototype,"loadingFileTitle",void 0),I([R({localizable:{defaultStr:"chooseFile"}})],ut.prototype,"chooseFileTitle",void 0),I([R({localizable:{defaultStr:"fileOrPhotoPlaceholder"}})],ut.prototype,"fileOrPhotoPlaceholder",void 0),I([R({localizable:{defaultStr:"photoPlaceholder"}})],ut.prototype,"photoPlaceholder",void 0),I([R({localizable:{defaultStr:"filePlaceholder"}})],ut.prototype,"filePlaceholder",void 0),I([R()],ut.prototype,"locRenderedPlaceholderValue",void 0),I([R()],ut.prototype,"isClearingFiles",void 0),I([Ft()],ut.prototype,"_renderedPages",void 0),B.addClass("file",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},{name:"showPreview:boolean",default:!0,visible:!1},"allowMultiple:boolean",{name:"allowImagesPreview:boolean",default:!0,dependsOn:"showPreview",visibleIf:n=>!!n.showPreview},"imageHeight","imageWidth","acceptedTypes",{name:"storeDataAsText:boolean",default:!0},{name:"waitForUpload:boolean",default:!1},{name:"maxSize:number",default:0},{name:"maxFiles:number",default:1e3,visibleIf:n=>n.allowMultiple},{name:"defaultValue",visible:!1},{name:"correctAnswer",visible:!1},{name:"validators",visible:!1},{name:"needConfirmRemoveFile:boolean"},{name:"sourceType",choices:["file","camera","file-camera"],default:"file",category:"general",visible:!0},{name:"fileOrPhotoPlaceholder:text",serializationProperty:"locFileOrPhotoPlaceholder",category:"general"},{name:"photoPlaceholder:text",serializationProperty:"locPhotoPlaceholder",category:"general"},{name:"filePlaceholder:text",serializationProperty:"locFilePlaceholder",category:"general"},{name:"allowCameraAccess:switch",category:"general",visible:!1}],function(){return new ut("")},"question"),Qe.Instance.registerQuestion("file",n=>new ut(n));class tb{constructor(e,t){this.fileQuestion=e,this.callback=t,this.loaded=[]}load(e){let t=0;this.loaded=new Array(e.length),e.forEach((s,i)=>{this.fileQuestion.survey&&this.fileQuestion.survey.downloadFile(this.fileQuestion,this.fileQuestion.name,s,(r,a)=>{!this.fileQuestion||!this.callback||(r!=="error"?(this.loaded[i]={content:a,name:s.name,type:s.type},t++,t===e.length&&this.callback(r,this.loaded)):this.callback("error",this.loaded))})})}dispose(){this.fileQuestion=void 0,this.callback=void 0}}class sb extends Fd{constructor(e){super(e),this.createLocalizableString("html").onGetTextCallback=t=>this.survey&&!this.ignoreHtmlProgressing?this.processHtml(t):t}getType(){return"html"}get isCompositeQuestion(){return!0}getProcessedText(e){return this.ignoreHtmlProgressing?e:super.getProcessedText(e)}get html(){return this.getLocalizableStringText("html","")}set html(e){this.setLocalizableStringText("html",e)}get locHtml(){return this.getLocalizableString("html")}get processedHtml(){return this.processHtml(this.html)}processHtml(e){return this.survey?this.survey.processHtml(e,"html-question"):this.html}get isNewA11yStructure(){return!0}get renderCssRoot(){return new j().append(this.cssClasses.root).append(this.cssClasses.nested,this.getIsNested()).toString()||void 0}}B.addClass("html",[{name:"html:html",serializationProperty:"locHtml"},{name:"showNumber",visible:!1},{name:"state",visible:!1},{name:"titleLocation",visible:!1},{name:"descriptionLocation",visible:!1},{name:"errorLocation",visible:!1},{name:"indent",visible:!1},{name:"width",visible:!1}],function(){return new sb("")},"nonvalue"),Qe.Instance.registerQuestion("html",n=>new sb(n));class ib extends dl{constructor(e){super(e)}getDefaultItemComponent(){return"survey-radiogroup-item"}getType(){return"radiogroup"}supportElementsInChoice(){return!0}getFirstInputElementId(){return this.inputId+"_0"}get selectedItem(){return this.getSingleSelectedItem()}get allowClear(){return this.getPropertyValue("allowClear")}set allowClear(e){this.setPropertyValue("allowClear",e)}get showClearButton(){return this.allowClear}set showClearButton(e){this.allowClear=e}get canShowClearButton(){return this.allowClear&&!this.isReadOnly}get clearButtonCaption(){return this.getLocalizationString("clearCaption")}supportAutoAdvance(){var e;return this.isMouseDown===!0&&!(!((e=this.selectedItem)===null||e===void 0)&&e.showCommentArea)}getConditionJson(e=null,t=null){const s=super.getConditionJson(e,t);return delete s.allowClear,delete s.showClearButton,s}setNewComment(e){this.isMouseDown=!0,super.setNewComment(e),this.isMouseDown=!1}clickItemHandler(e){this.selectItem(e)}isOtherValueUnused(){var e;return!(!((e=this.selectedItem)===null||e===void 0)&&e.showCommentArea)}getDefaultTitleActions(){const e=[];if(!this.isDesignMode){const t=new xe({locTitleName:"clearCaption",id:`sv-clr-btn-${this.id}`,action:()=>{this.clearValueFromUI()},innerCss:this.cssClasses.clearButton,visible:new Ue(()=>this.canShowClearButton)});e.push(t)}return e}get isNewA11yStructure(){return!0}get a11y_input_ariaRole(){return"radiogroup"}}B.addClass("radiogroup",[{name:"allowClear:boolean",alternativeName:"showClearButton"},{name:"separateSpecialChoices",visible:!0},{name:"itemComponent",visible:!1,default:"survey-radiogroup-item"}],function(){return new ib("")},"checkboxbase"),Qe.Instance.registerQuestion("radiogroup",n=>{var e=new ib(n);return e.choices=Qe.DefaultChoices,e});function rb(n){if(typeof getComputedStyle=="function"){const e=getComputedStyle(oe.getDocumentElement());return e.getPropertyValue&&e.getPropertyValue(n)}return""}function jr(n,e,t){let s=!!n&&n[e];if(s||(s=rb(t)),!s)return null;const i=oe.createElement("canvas");if(!i)return null;var r=i.getContext("2d");r.fillStyle=s,r.fillStyle=="#000000"&&(r.fillStyle=rb(t));const a=r.fillStyle;if(a.startsWith("rgba"))return a.substring(5,a.length-1).split(",").map(l=>+l.trim());var o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return o?[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16),1]:null}class Ur extends de{onStringChangedCallback(){this.text=this.itemValue.text}get value(){return this.itemValue.getPropertyValue("value")}get locText(){return this.locString||this.itemValue.locText}constructor(e,t=null){super(),this.itemValue=e,this.locString=t,this.locText.onStringChanged.add(this.onStringChangedCallback.bind(this)),this.onStringChangedCallback()}}I([R({defaultValue:""})],Ur.prototype,"highlight",void 0),I([R({defaultValue:""})],Ur.prototype,"text",void 0),I([R()],Ur.prototype,"style",void 0);class F_ extends fe{constructor(e,t,s){super(e,t),this.description=s}}class nt extends kt{constructor(e){super(e),this.iCounter=0,this.createItemValues("rateValues"),this.createLocString({name:"ratingOptionsCaption",hasTranslation:!0}),this.registerFunctionOnPropertiesValueChanged(["rateMin","rateMax","minRateDescription","maxRateDescription","rateStep","displayRateDescriptionsAsExtremeItems"],()=>this.resetRenderedItems()),this.registerFunctionOnPropertiesValueChanged(["rateType"],()=>{this.setIconsToRateValues(),this.resetRenderedItems(),this.updateRateCount()}),this.registerFunctionOnPropertiesValueChanged(["rateValues"],()=>{this.setIconsToRateValues(),this.resetRenderedItems()}),this.registerSychProperties(["rateValues"],()=>{this.autoGenerate=this.rateValues.length==0,this.setIconsToRateValues(),this.resetRenderedItems()}),this.registerFunctionOnPropertiesValueChanged(["rateColorMode","scaleColorMode"],()=>{this.updateColors(this.survey.themeVariables)}),this.registerFunctionOnPropertiesValueChanged(["displayMode"],()=>{this.updateRenderAsBasedOnDisplayMode(!0)}),this.registerSychProperties(["autoGenerate"],()=>{!this.autoGenerate&&this.rateValues.length===0&&this.setPropertyValue("rateValues",this.visibleRateValues),this.autoGenerate&&(this.rateValues.splice(0,this.rateValues.length),this.updateRateMax()),this.resetRenderedItems()}),this.createLocalizableString("minRateDescription",this,!0).onStringChanged.add((t,s)=>{this.setPropertyValue("hasMinRateDescription",!t.isEmpty)}),this.createLocalizableString("maxRateDescription",this,!0).onStringChanged.add((t,s)=>{this.setPropertyValue("hasMaxRateDescription",!t.isEmpty)}),this.createLocalizableString("readOnlyText",this,!0),this.registerPropertyChangedHandlers(["value","renderAs","placeholder","choices","visibleChoices"],()=>{this.updateReadOnlyText()}),this.updateReadOnlyText(),this.initPropertyDependencies()}setIconsToRateValues(){this.rateType=="smileys"&&this.rateValues.map(e=>e.icon=this.getItemSmiley(e))}locStrsChanged(){var e;super.locStrsChanged(),this.updateReadOnlyText(),(e=this.dropdownListModelValue)===null||e===void 0||e.locStrsChanged()}updateReadOnlyText(){this.readOnlyText=this.displayValue||this.placeholder}endLoadingFromJson(){super.endLoadingFromJson(),this.jsonObj.rateMin!==void 0&&this.jsonObj.rateCount!==void 0&&this.jsonObj.rateMax===void 0&&this.updateRateMax(),this.jsonObj.rateMax!==void 0&&this.jsonObj.rateCount!==void 0&&this.jsonObj.rateMin===void 0&&this.updateRateMin(),this.jsonObj.autoGenerate===void 0&&this.jsonObj.rateValues!==void 0&&(this.autoGenerate=!this.jsonObj.rateValues.length),this.updateRateCount(),this.setIconsToRateValues()}useRateValues(){return!!this.rateValues.length&&!this.autoGenerate}updateRateMax(){this.rateMax=this.rateMin+this.rateStep*(this.rateCount-1)}updateRateMin(){this.rateMin=this.rateMax-this.rateStep*(this.rateCount-1)}updateRateCount(){let e=0;this.useRateValues()?e=this.rateValues.length:e=Math.trunc((this.rateMax-this.rateMin)/(this.rateStep||1))+1,e>10&&this.rateType=="smileys"&&(e=10),this.rateCount=e,this.rateValues.length>e&&this.rateValues.splice(e,this.rateValues.length-e)}initPropertyDependencies(){this.registerSychProperties(["rateCount"],()=>{if(!this.useRateValues())this.rateMax=this.rateMin+this.rateStep*(this.rateCount-1);else if(this.rateCount<this.rateValues.length){if(this.rateCount>=10&&this.rateType=="smileys")return;this.rateValues.splice(this.rateCount,this.rateValues.length-this.rateCount)}else for(let e=this.rateValues.length;e<this.rateCount;e++)this.rateValues.push(new fe(bt("choices_Item")+(e+1)))}),this.registerSychProperties(["rateMin","rateMax","rateStep","rateValues"],()=>{this.updateRateCount()})}get showSelectedItemLocText(){return!this.readOnly&&!this.inputHasValue&&!!this.selectedItemLocText}get selectedItemLocText(){var e;return!this.readOnly&&((e=this.visibleRateValues.filter(t=>t.value==this.value)[0])===null||e===void 0?void 0:e.locText)}get rateValues(){return this.getPropertyValue("rateValues")}set rateValues(e){this.setPropertyValue("rateValues",e)}selectItem(e){!this.isReadOnly&&e&&(this.value=e.value)}get rateMin(){return this.getPropertyValue("rateMin")}set rateMin(e){this.setPropertyValue("rateMin",e)}get rateMax(){return this.getPropertyValue("rateMax")}set rateMax(e){this.setPropertyValue("rateMax",e)}get rateStep(){return this.getPropertyValue("rateStep")}set rateStep(e){this.setPropertyValue("rateStep",e)}updateColors(e){this.colorMode!=="monochrome"&&oe.isAvailable()&&(nt.colorsCalculated||(nt.badColor=jr(e,"--sjs-special-red","--sd-rating-bad-color"),nt.normalColor=jr(e,"--sjs-special-yellow","--sd-rating-normal-color"),nt.goodColor=jr(e,"--sjs-special-green","--sd-rating-good-color"),nt.badColorLight=jr(e,"--sjs-special-red-light","--sd-rating-bad-color-light"),nt.normalColorLight=jr(e,"--sjs-special-yellow-light","--sd-rating-normal-color-light"),nt.goodColorLight=jr(e,"--sjs-special-green-light","--sd-rating-good-color-light"),this.colorsCalculated=!0,this.resetRenderedItems()))}getDisplayValueCore(e,t){if(!this.useRateValues)return super.getDisplayValueCore(e,t);var s=fe.getTextOrHtmlByValue(this.visibleRateValues,t);return s||t}get visibleRateValues(){return this.renderedRateItems.map(e=>e.itemValue)}supportEmptyValidation(){return this.renderAs==="dropdown"}itemValuePropertyChanged(e,t,s,i){!this.useRateValues()&&i!==void 0&&(this.autoGenerate=!1),super.itemValuePropertyChanged(e,t,s,i)}runConditionCore(e){super.runConditionCore(e),this.runRateItesmCondition(e)}runRateItesmCondition(e){var t;if(!this.useRateValues())return;let s=!1;if(!((t=this.survey)===null||t===void 0)&&t.areInvisibleElementsShowing?this.rateValues.forEach(i=>{s=s||!i.isVisible,i.setIsVisible(i,!0)}):s=fe.runConditionsForItems(this.rateValues,void 0,void 0,e,!0),s&&(this.resetRenderedItems(),!this.isEmpty()&&!this.isReadOnly)){const i=fe.getItemByValue(this.rateValues,this.value);i&&!i.isVisible&&this.clearValue()}}getRateValuesCore(){if(!this.useRateValues())return this.createRateValues();const e=new Array;return this.rateValues.forEach(t=>{t.isVisible&&e.push(t)}),e}calculateRateValues(){let e=this.getRateValuesCore();return this.rateType=="smileys"&&e.length>10&&(e=e.slice(0,10)),e}calculateRenderedRateItems(){const e=this.calculateRateValues();return e.map((t,s)=>{let i=null;return this.displayRateDescriptionsAsExtremeItems&&(s==0&&(i=new Ur(t,this.minRateDescription&&this.locMinRateDescription||t.locText)),s==e.length-1&&(i=new Ur(t,this.maxRateDescription&&this.locMaxRateDescription||t.locText))),i||(i=new Ur(t)),i})}calculateVisibleChoices(){return this.calculateRateValues().map((t,s)=>this.getRatingItemValue(t,s))}resetRenderedItems(){if(this.autoGenerate){const e=this.getRateValuesCore();this.rateMax=e[e.length-1].value}Array.isArray(this.getPropertyValueWithoutDefault("renderedRateItems"))&&this.setArrayPropertyDirectly("renderedRateItems",this.calculateRenderedRateItems()),Array.isArray(this.getPropertyValueWithoutDefault("visibleChoices"))&&this.setArrayPropertyDirectly("visibleChoices",this.calculateVisibleChoices)}get renderedRateItems(){return this.getPropertyValue("renderedRateItems",void 0,()=>this.calculateRenderedRateItems())}get visibleChoices(){return this.getPropertyValue("visibleChoices",void 0,()=>this.calculateVisibleChoices())}createRateValues(){for(var e=[],t=this.rateMin,s=this.rateStep;t<=this.rateMax&&e.length<D.ratingMaximumRateValueCount;){let i=new fe(t);i.locOwner=this,i.ownerPropertyName="rateValues",e.push(i),t=this.correctValue(t+s,s)}return e}getRatingItemValue(e,t){if(!e)return null;const s=e.value;let i;t===0&&(i=this.minRateDescription&&this.locMinRateDescription),t===this.rateCount-1&&(i=this.maxRateDescription&&this.locMaxRateDescription);let r=new F_(s,e.text,i);return r.locOwner=e.locOwner,r.ownerPropertyName=e.ownerPropertyName,r}correctValue(e,t){if(!e||Math.round(e)==e)return e;for(var s=0;Math.round(t)!=t;)t*=10,s++;return parseFloat(e.toFixed(s))}getType(){return"rating"}getFirstInputElementId(){return this.inputId+"_0"}getInputId(e){return this.inputId+"_"+e}get questionName(){return this.name+"_"+this.id}supportAutoAdvance(){return this.isMouseDown===!0||this.renderAs==="dropdown"}supportOther(){return!1}getPlainDataCalculatedValue(e){const t=super.getPlainDataCalculatedValue(e);if(t!==void 0||!this.useRateValues||this.isEmpty())return t;const s=fe.getItemByValue(this.visibleRateValues,this.value);return s?s[e]:void 0}get minRateDescription(){return this.getLocalizableStringText("minRateDescription")}set minRateDescription(e){this.setLocalizableStringText("minRateDescription",e)}get locMinRateDescription(){return this.getLocalizableString("minRateDescription")}get maxRateDescription(){return this.getLocalizableStringText("maxRateDescription")}set maxRateDescription(e){this.setLocalizableStringText("maxRateDescription",e)}get locMaxRateDescription(){return this.getLocalizableString("maxRateDescription")}get hasMinRateDescription(){return this.getPropertyValue("hasMinRateDescription",void 0,()=>!!this.minRateDescription)}get hasMaxRateDescription(){return this.getPropertyValue("hasMaxRateDescription",void 0,()=>!!this.maxRateDescription)}get hasMinLabel(){return!this.displayRateDescriptionsAsExtremeItems&&!!this.hasMinRateDescription}get hasMaxLabel(){return!this.displayRateDescriptionsAsExtremeItems&&!!this.hasMaxRateDescription}updateRenderAsBasedOnDisplayMode(e){this.isDesignMode?(e||this.renderAs==="dropdown")&&(this.renderAs="default"):(e||this.displayMode!=="auto")&&(this.renderAs=this.displayMode==="dropdown"?"dropdown":"default")}onSurveyLoad(){super.onSurveyLoad(),this.renderAs==="dropdown"&&this.displayMode==="auto"?this.displayMode=this.renderAs:this.updateRenderAsBasedOnDisplayMode()}get rateDisplayMode(){return this.rateType}set rateDisplayMode(e){this.rateType=e}get isStar(){return this.rateType=="stars"}get isSmiley(){return this.rateType=="smileys"}getDefaultItemComponent(){return this.renderAs=="dropdown"?"sv-rating-dropdown-item":this.isStar?"sv-rating-item-star":this.isSmiley?"sv-rating-item-smiley":"sv-rating-item"}get itemComponent(){return this.getPropertyValue("itemComponent",this.getDefaultItemComponent())}set itemComponent(e){this.setPropertyValue("itemComponent",e)}valueToData(e){if(this.useRateValues()){var t=fe.getItemByValue(this.rateValues,e);return t?t.value:e}return isNaN(e)?e:parseFloat(e)}setValueFromClick(e){if(!this.isReadOnlyAttr){this.value===(typeof this.value=="string"?e:parseFloat(e))?this.clearValue(!0):this.value=e;for(let t=0;t<this.renderedRateItems.length;t++)this.renderedRateItems[t].highlight="none"}}onItemMouseIn(e){if(vt||this.isReadOnly||!e.itemValue.isEnabled||this.isDesignMode)return;let t=!0,s=this.value!=null;if(this.rateType!=="stars"){e.highlight="highlighted";return}for(let i=0;i<this.renderedRateItems.length;i++)this.renderedRateItems[i].highlight=t&&!s&&"highlighted"||!t&&s&&"unhighlighted"||"none",this.renderedRateItems[i]==e&&(t=!1),this.renderedRateItems[i].itemValue.value==this.value&&(s=!1)}onItemMouseOut(e){vt||this.renderedRateItems.forEach(t=>t.highlight="none")}get itemSmallMode(){return!this.isSingleInputActive&&this.inMatrixMode&&D.matrix.rateSize=="small"}get ratingRootCss(){const e=this.hasMaxLabel||this.hasMinLabel;return new j().append(this.cssClasses.root).append(this.cssClasses.rootWrappable,this.displayMode=="buttons"||!!this.survey&&this.survey.isDesignMode||this.displayMode=="auto"&&!this.supportResponsiveness()).append(this.cssClasses.rootLabelsTop,e&&this.rateDescriptionLocation=="top").append(this.cssClasses.rootLabelsBottom,e&&this.rateDescriptionLocation=="bottom").append(this.cssClasses.rootLabelsDiagonal,e&&this.rateDescriptionLocation=="topBottom").append(this.cssClasses.itemSmall,this.itemSmallMode&&this.rateType!="labels").toString()}get itemStarIcon(){return this.itemSmallMode?"icon-rating-star-small":"icon-rating-star"}get itemStarIconAlt(){return this.itemStarIcon+"-2"}getItemSmiley(e){const t=["terrible","very-poor","poor","not-good","average","normal","good","very-good","excellent","perfect"],s=["very-good","not-good","normal","good","average","excellent","poor","perfect","very-poor","terrible"],i=this.useRateValues()?this.rateValues.length:this.rateMax-this.rateMin+1,r=s.slice(0,i),a=t.filter(o=>r.indexOf(o)!=-1);return this.useRateValues()?a[this.rateValues.indexOf(e)]:a[e.value-this.rateMin]}getItemSmileyIconName(e){return"icon-"+this.getItemSmiley(e)}getItemClassByText(e,t){return this.getItemClass(e)}getRenderedItemColor(e,t){let s=t?nt.badColorLight:nt.badColor,i=t?nt.goodColorLight:nt.goodColor;const r=(this.rateCount-1)/2,a=t?nt.normalColorLight:nt.normalColor;if(e<r?i=a:(s=a,e-=r),!s||!i)return null;const o=[0,0,0,0];for(let l=0;l<4;l++)o[l]=s[l]+(i[l]-s[l])*e/r,l<3&&(o[l]=Math.trunc(o[l]));return"rgba("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")"}getItemStyle(e,t="none"){if(this.scaleColorMode==="monochrome"&&this.rateColorMode=="default"||this.isPreviewStyle||this.isReadOnlyStyle)return{};const s=this.visibleRateValues.indexOf(e),i=this.getRenderedItemColor(s,!1),r=t=="highlighted"&&this.scaleColorMode==="colored"&&this.getRenderedItemColor(s,!0);return r?{"--sd-rating-item-color":i,"--sd-rating-item-color-light":r}:{"--sd-rating-item-color":i}}getItemClass(e,t="none"){let s=this.value==e.value;this.isStar&&(this.useRateValues()?s=this.rateValues.indexOf(this.rateValues.filter(ie=>ie.value==this.value)[0])>=this.rateValues.indexOf(e):s=this.value>=e.value);const r=!(this.isReadOnly||!e.isEnabled)&&this.value!=e.value&&!(this.survey&&this.survey.isDesignMode),a=this.renderedRateItems.filter(ie=>ie.itemValue==e)[0],o=this.isStar&&a?.highlight=="highlighted",l=this.isStar&&a?.highlight=="unhighlighted";let u=this.cssClasses.item,d=this.cssClasses.selected,h=this.cssClasses.itemDisabled,f=this.cssClasses.itemReadOnly,C=this.cssClasses.itemPreview,b=this.cssClasses.itemHover,x=this.cssClasses.itemOnError,V=null,P=null,M=null,X=null,N=null;this.isStar&&(u=this.cssClasses.itemStar,d=this.cssClasses.itemStarSelected,h=this.cssClasses.itemStarDisabled,f=this.cssClasses.itemStarReadOnly,C=this.cssClasses.itemStarPreview,b=this.cssClasses.itemStarHover,x=this.cssClasses.itemStarOnError,V=this.cssClasses.itemStarHighlighted,P=this.cssClasses.itemStarUnhighlighted,N=this.cssClasses.itemStarSmall),this.isSmiley&&(u=this.cssClasses.itemSmiley,d=this.cssClasses.itemSmileySelected,h=this.cssClasses.itemSmileyDisabled,f=this.cssClasses.itemSmileyReadOnly,C=this.cssClasses.itemSmileyPreview,b=this.cssClasses.itemSmileyHover,x=this.cssClasses.itemSmileyOnError,V=this.cssClasses.itemSmileyHighlighted,M=this.cssClasses.itemSmileyScaleColored,X=this.cssClasses.itemSmileyRateColored,N=this.cssClasses.itemSmileySmall);const W=!this.isStar&&!this.isSmiley&&(!this.displayRateDescriptionsAsExtremeItems||this.useRateValues()&&e!=this.rateValues[0]&&e!=this.rateValues[this.rateValues.length-1]||!this.useRateValues()&&e.value!=this.rateMin&&e.value!=this.rateMax)&&e.locText.calculatedText.length<=2&&Number.isInteger(Number(e.locText.calculatedText)),J={item:e,css:""};return J.css=new j().append(u).append(d,s).append(h,this.isDisabledStyle).append(f,this.isReadOnlyStyle).append(C,this.isPreviewStyle).append(b,r).append(V,o).append(M,this.scaleColorMode=="colored").append(X,this.rateColorMode=="scale"&&s).append(P,l).append(x,this.hasCssError()).append(N,this.itemSmallMode).append(this.cssClasses.itemFixedSize,W).toString(),this.survey&&this.survey.updateChoiceItemCss(this,J),J.css}getControlClass(){return this.isEmpty(),new j().append(this.cssClasses.control).append(this.cssClasses.controlEmpty,this.isEmpty()).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle).toString()}get placeholder(){return this.getLocalizableStringText("ratingOptionsCaption")}set placeholder(e){this.setLocalizableStringText("ratingOptionsCaption",e)}get locPlaceholder(){return this.getLocalizableString("ratingOptionsCaption")}get allowClear(){return!0}get searchEnabled(){return!1}get renderedValue(){return this.value}set renderedValue(e){this.value=e}isItemSelected(e){return e.value==this.value}get readOnlyText(){return this.getLocalizableStringText("readOnlyText")}set readOnlyText(e){this.setLocalizableStringText("readOnlyText",e)}get locReadOnlyText(){return this.getLocalizableString("readOnlyText")}needResponsiveWidth(){this.getPropertyValue("rateValues");const e=this.getPropertyValue("rateStep"),t=this.getPropertyValue("rateMax"),s=this.getPropertyValue("rateMin");return this.displayMode!="dropdown"&&!!(this.hasMinRateDescription||this.hasMaxRateDescription||e&&(t-s)/e>9)}supportResponsiveness(){return!this.inMatrixMode}onBeforeSetCompactRenderer(){!this.isDisposed&&!this.dropdownListModelValue&&(this.dropdownListModelValue=new Wt(this))}getCompactRenderAs(){return this.displayMode=="buttons"?"default":"dropdown"}getDesktopRenderAs(){return this.displayMode=="dropdown"?"dropdown":"default"}set dropdownListModel(e){this.dropdownListModelValue=e,this.updateElementCss()}get dropdownListModel(){return this.renderAs==="dropdown"&&this.onBeforeSetCompactRenderer(),this.dropdownListModelValue}onBlurCore(e){var t;(t=this.dropdownListModel)===null||t===void 0||t.onBlur(e),super.onBlurCore(e)}updateCssClasses(e,t){super.updateCssClasses(e,t),Xo(e,t)}calcCssClasses(e){const t=super.calcCssClasses(e);return this.dropdownListModelValue&&this.dropdownListModelValue.updateCssClasses(t.popup,t.list),t}themeChanged(e){this.colorsCalculated=!1,this.updateColors(e.cssVariables)}setSurveyImpl(e,t){super.setSurveyImpl(e,t),this.survey&&(this.updateColors(this.survey.themeVariables),this.updateRenderAsBasedOnDisplayMode())}dispose(){super.dispose(),this.dropdownListModelValue&&(this.dropdownListModelValue.dispose(),this.dropdownListModelValue=void 0)}get a11yInputAriaRole(){return this.renderAs==="dropdown"?"combobox":null}get isNewA11yStructure(){return!0}get a11y_input_ariaRole(){return"radiogroup"}}nt.colorsCalculated=!1,I([R({defaultValue:!1})],nt.prototype,"inputHasValue",void 0),I([R()],nt.prototype,"autoGenerate",void 0),I([R()],nt.prototype,"rateCount",void 0),I([R()],nt.prototype,"displayRateDescriptionsAsExtremeItems",void 0),I([R()],nt.prototype,"displayMode",void 0),I([R()],nt.prototype,"rateDescriptionLocation",void 0),I([R()],nt.prototype,"rateType",void 0),I([R()],nt.prototype,"scaleColorMode",void 0),I([R()],nt.prototype,"rateColorMode",void 0),B.addClass("rating",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},{name:"rateType",alternativeName:"rateDisplayMode",default:"labels",category:"rateValues",choices:["labels","stars","smileys"],visibleIndex:1},{name:"scaleColorMode",category:"rateValues",default:"monochrome",choices:["monochrome","colored"],visibleIf:function(n){return n.rateType=="smileys"},visibleIndex:2},{name:"rateColorMode",category:"rateValues",default:"scale",choices:["default","scale"],visibleIf:function(n){return n.rateType=="smileys"&&n.scaleColorMode=="monochrome"},visibleIndex:3},{name:"autoGenerate",category:"rateValues",default:!0,choices:[!0,!1],visibleIndex:5},{name:"rateCount:number",default:5,category:"rateValues",visibleIndex:4,onSettingValue:(n,e)=>e<2?2:e>D.ratingMaximumRateValueCount&&e>n.rateValues.length?D.ratingMaximumRateValueCount:e>10&&n.rateType=="smileys"?10:e},{name:"rateValues:itemvalue[]",baseValue:function(){return bt("choices_Item")},category:"rateValues",visibleIf:function(n){return!n.autoGenerate},visibleIndex:6},{name:"rateMin:number",default:1,onSettingValue:(n,e)=>e>n.rateMax-n.rateStep?n.rateMax-n.rateStep:e,visibleIf:function(n){return!!n.autoGenerate},visibleIndex:7},{name:"rateMax:number",default:5,onSettingValue:(n,e)=>e<n.rateMin+n.rateStep?n.rateMin+n.rateStep:e,visibleIf:function(n){return!!n.autoGenerate},visibleIndex:8},{name:"rateStep:number",default:1,minValue:.1,onSettingValue:(n,e)=>(e<=0&&(e=1),e>n.rateMax-n.rateMin&&(e=n.rateMax-n.rateMin),e),visibleIf:function(n){return!!n.autoGenerate},visibleIndex:9},{name:"minRateDescription",alternativeName:"mininumRateDescription",serializationProperty:"locMinRateDescription",visibleIndex:18},{name:"maxRateDescription",alternativeName:"maximumRateDescription",serializationProperty:"locMaxRateDescription",visibleIndex:19},{name:"displayRateDescriptionsAsExtremeItems:boolean",default:!1,visibleIndex:21,visibleIf:function(n){return n.rateType=="labels"}},{name:"rateDescriptionLocation",default:"leftRight",choices:["leftRight","top","bottom","topBottom"],visibleIndex:20},{name:"displayMode",default:"auto",choices:["auto","buttons","dropdown"],visibleIndex:0},{name:"itemComponent",visible:!1,defaultFunc:n=>n?(n.getOriginalObj&&(n=n.getOriginalObj()),n.getDefaultItemComponent()):"sv-rating-item"}],function(){return new nt("")},"question"),Qe.Instance.registerQuestion("rating",n=>new nt(n));class nb extends fe{getBaseType(){return"sliderlabel"}onGetText(e){return e||!this.locOwner?super.onGetText(e):this.locOwner.getTextByItem(this)}getCorrectValue(e){return typeof e=="number"?e:L.isNumber(e)?parseFloat(e.toString()):this.value||0}get showValue(){return this.getPropertyValue("showValue",!1)}set showValue(e){this.setPropertyValue("showValue",e)}}class It extends kt{get step(){return this.getPropertyValue("step")}set step(e){this.setPropertyValue("step",e)}get labelCount(){return this.customLabels.length>0?this.customLabels.length:this.tickSize?Math.round(100/this.tickSize)+2:this.getPropertyValue("labelCount")}set labelCount(e){this.setPropertyValue("labelCount",e)}get customLabels(){return this.getPropertyValue("customLabels")}set customLabels(e){this.setPropertyValue("customLabels",e)}get allowSwap(){return this.minRangeLength?!1:this.getPropertyValue("allowSwap",!0)}set allowSwap(e){this.setPropertyValue("allowSwap",e)}constructor(e){super(e),this.getThumbContainerCss=t=>new j().append(this.cssClasses.thumbContainer).append(this.cssClasses.thumbContainerIndeterminateMode,!!this.isIndeterminate).append(this.cssClasses.thumbContainerFocusedMode,t===this.focusedThumb).toString(),this.getLabelCss=t=>new j().append(this.cssClasses.label).append(this.cssClasses.labelLongMod,t.renderedHtml.length>10).toString(),this.isIndeterminate=!1,this.getTrackPercentLeft=()=>{const{renderedValue:t,sliderType:s,renderedMin:i}=this;let r;return s==="single"?t[0]>0?r=this.getPercent(Math.max(0,i)):r=this.getPercent(t[0]):r=this.getPercent(Math.min(...t)),r},this.getTrackPercentRight=()=>{const{renderedValue:t,sliderType:s,renderedMax:i}=this;let r;return s==="single"?t[0]>0?r=this.getPercent(t[0]):r=this.getPercent(Math.min(0,i)):r=this.getPercent(Math.max(...t)),100-r},this.getPercent=t=>{const{renderedMax:s,renderedMin:i}=this,r=s-i;return Math.abs(t-i)/r*100},this.ensureMaxRangeBorders=(t,s)=>{const{renderedMaxRangeLength:i,renderedValue:r}=this,a=r.slice(),o=a[s];let l=!1;a[s]=t;for(let u=0;u<a.length-1;u++)if(Math.abs(a[u]-a[u+1])>i){l=!0;break}return l?o:t},this.ensureMinRangeBorders=(t,s)=>{const{renderedMinRangeLength:i,renderedValue:r,allowSwap:a,renderedMin:o,renderedMax:l}=this,u=r.slice(),d=u[s];let h=!1;u[s]=t;for(let f=0;f<u.length-1;f++)if(Math.abs(u[f]-u[f+1])<i){h=!0;break}if(!a){const f=s>0?u[s-1]:o,C=s<u.length-1?u[s+1]:l;(t<=f||t>=C)&&(h=!0)}return h?d:t},this.getClosestToStepValue=t=>{const{step:s,renderedMin:i,renderedMax:r}=this,a=i+Math.trunc((r-i)/s)*s;let o=i+Math.round((t-i)/s)*s;return o=Math.min(a,o),o},this.handleRangeOnChange=t=>{if(!this.isRangeMoving||!this.isAllowToChange())return;const{renderedMax:s,renderedMin:i,renderedValue:r,ensureMaxRangeBorders:a,ensureMinRangeBorders:o}=this,l=t.target,u=this.oldInputValue-+l.value;this.oldInputValue=+l.value;let d=!1;for(let h=0;h<r.length;h++){let f=r[h]-u;f=a(f,h),f=o(f,h),f<=s&&f>=i?r.splice(h,1,f):d=!0}if(d){d=!1;return}},this.prepareInputRangeForMoving=(t,s)=>{const{renderedMax:i,renderedMin:r}=this;this.isRangeMoving=!0,this.animatedThumb=!1;const a=t.target;a.style.setProperty("--sjs-range-slider-range-input-thumb-width","20px"),a.style.setProperty("--sjs-range-slider-range-input-thumb-left","initial"),a.style.setProperty("--sjs-range-slider-range-input-thumb-position","static");const l=(t.clientX-s.getBoundingClientRect().x)/s.getBoundingClientRect().width*100/100*(i-r)+r;a.value=""+l,this.oldInputValue=l},this.handleRangePointerDown=(t,s)=>{const{dragOrClickHelper:i,allowDragRange:r,step:a,prepareInputRangeForMoving:o}=this,l=t.target;a&&(l.step="0.01"),r&&(i.dragHandler=()=>{o.call(this,t,s)},i.onPointerDown(t))},this.handleRangePointerUp=(t,s)=>{const{step:i,renderedValue:r,getClosestToStepValue:a}=this,o=t.target;if(this.isRangeMoving){if(this.refreshInputRange(),this.isRangeMoving=!1,i){o.step=""+i;for(let l=0;l<r.length;l++)r[l]=a(r[l]);this.setSliderValue(r)}return}o.style.setProperty("--sjs-range-slider-range-input-thumb-width","0px"),o.style.setProperty("--sjs-range-slider-range-input-thumb-left","initial"),o.style.setProperty("--sjs-range-slider-range-input-thumb-position","static"),this.setValueByClickOnPath(t,s)},this.refreshInputRange=t=>{const{allowDragRange:s,renderedValue:i,getPercent:r}=this;if(!s)return;const a=t||oe.getDocument().getElementById(this.id+"-sjs-slider-input-range-input");if(!a)return;const o=r(i[i.length-1]),l=r(i[0]);let u=o-l;a.style.setProperty("--sjs-range-slider-range-input-thumb-width",`calc(${u}% - 20px - 20px)`),a.style.setProperty("--sjs-range-slider-range-input-thumb-left",`calc(${l}% + 20px)`),a.style.setProperty("--sjs-range-slider-range-input-thumb-position","absolute")},this.setSliderValue=t=>{if(this.isAllowToChange()){let s;this.sliderType==="single"?s=Array.isArray(t)?t[0]:t:this.sliderType==="range"&&(s=t),this.value=s,this.resetPropertyValue("renderedValue")}},this.setValueByClickOnPath=(t,s)=>{const{renderedMax:i,renderedMin:r}=this;let a=oe.getComputedStyle(oe.getBody()).direction=="rtl",o=(t.clientX-s.getBoundingClientRect().x)/s.getBoundingClientRect().width*100;a&&(o=100-o);let l=o/100*(i-r)+r;this.setValueByClick(l,t.target)},this.setValueByClick=(t,s)=>{const{step:i,getClosestToStepValue:r,ensureMaxRangeBorders:a,ensureMinRangeBorders:o,renderedValue:l,refreshInputRange:u,setSliderValue:d}=this;this.animatedThumb=!0;const h=l.slice();let f=0;for(let C=0;C<h.length;C++){const b=Math.abs(h[f]-t);Math.abs(h[C]-t)<b&&(f=C)}if(h.length>1&&(t=a(t,f),t=o(t,f)),h[f]=t,i){const C=l.slice();for(let b=0;b<h.length;b++){const x=C[b]/i,V=h[b]/i;Math.round(V)===x&&(V>x?h[b]=h[b]+i:V<x&&(h[b]=h[b]-i)),h[b]=r(h[b])}}d(h),u()},this.handleOnChange=(t,s)=>{if(!this.isAllowToChange()||this.oldValue===null)return;const{allowSwap:i,ensureMaxRangeBorders:r,ensureMinRangeBorders:a,renderedValue:o}=this;let u=+t.target.value;o.length>1&&(u=r(u,s),i||(u=a(u,s))),o.splice(s,1,u)},this.handlePointerDown=t=>{const{step:s,renderedValue:i}=this;if(s)for(let r=0;r<i.length;r++){const a=oe.getDocument().getElementById(this.id+`-sjs-slider-input-${r}`);a.step=.01}this.oldValue=this.renderedValue,this.animatedThumb=!1},this.handlePointerUp=t=>{t.stopPropagation();const{step:s,focusedThumb:i,renderedValue:r,allowSwap:a,renderedMinRangeLength:o,getClosestToStepValue:l,refreshInputRange:u,setSliderValue:d}=this,h=r[i];if(t.target,r.sort((f,C)=>f-C),this.focusedThumb=r.indexOf(h),s)for(let f=0;f<r.length;f++){r[f]=l(r[f]);const C=oe.getDocument().getElementById(this.id+`-sjs-slider-input-${f}`);C.step=s}if(a){for(let f=0;f<r.length-1;f++)if(Math.abs(r[f]-r[f+1])<o){this.setPropertyValue("renderedValue",this.oldValue);break}}d(r),u(),this.oldValue=null},this.handleKeyDown=t=>{this.oldValue=this.renderedValue,this.animatedThumb=!0},this.handleKeyUp=t=>{this.oldValue=null,this.setSliderValue(this.renderedValue)},this.handleOnFocus=t=>{this.focusedThumb=t},this.handleOnBlur=()=>{this.focusedThumb=null},this.handleLabelPointerUp=(t,s)=>{const i=t.target;isNaN(s)||this.setValueByClick(s,i)},this.getTooltipValue=t=>{const{step:s,getClosestToStepValue:i,renderedValue:r,tooltipFormat:a,formatNumber:o}=this;let l=r[t];return l=s?i(l):l,l=o(l),a.replace("{0}",""+l)},this.getLabelText=t=>{const{step:s,renderedMax:i,renderedMin:r,renderedLabelCount:a,formatNumber:o}=this,l=i-r,u=s%1!=0,d=a-1;let h=d===0?0:t*l/d;return u?""+o(h+r):""+Math.round(h+r)},this.getLabelPosition=t=>{const{max:s,min:i,renderedLabelCount:r,customLabels:a}=this,o=r-1;if(o===0)return 0;const l=s-i;return i+t*l/o},this.isRangeMoving=!1,this.oldInputValue=null,this.oldValue=null,this.calcRenderedValue=()=>{const{renderedMax:t,renderedMin:s,renderedMaxRangeLength:i,getClosestToStepValue:r,sliderType:a}=this;let o;if(a==="single")return o=this.ensureValueRespectMinMax(this.value),typeof o>"u"||o===null||o.length===0?(this.isIndeterminate=!0,this.isNegativeScale?[Math.min(t,0)]:[s]):Array.isArray(o)?[o[0]]:[o];if(o=Array.isArray(this.value)?this.value.slice():[],o.length===0){const l=t-s;if(this.isIndeterminate=!0,Math.abs(l)>i){const u=(l-i)/2;return[r(s+u),r(t-u)]}return[s,t]}return o.map(l=>this.ensureValueRespectMinMax(l))},this.createItemValues("customLabels"),this.dragOrClickHelper=new Od(null,!1),this.initPropertyDependencies()}get generatedLabels(){return this.getPropertyValue("generatedLabels",void 0,()=>this.calcGeneratedLabels())}get renderedValue(){return this.getPropertyValue("renderedValue",void 0,()=>this.calcRenderedValue())}set renderedValue(e){this.setPropertyValue("renderedValue",e)}getType(){return"slider"}get rootCss(){return new j().append(this.cssClasses.root).append(this.cssClasses.rootSingleMode,this.sliderType==="single").append(this.cssClasses.rootNegativeScaleMode,!!this.isNegativeScale).append(this.cssClasses.rootDesignMode,!!this.isDesignMode).append(this.cssClasses.rootAnimatedThumbMode,!!this.animatedThumb).append(this.cssClasses.rootTooltipsAlwaysMode,this.tooltipVisibility==="always").append(this.cssClasses.rootLabelsShowValueTextMode,this.isLabelsShowValueText).toString()}get tooltipCss(){return new j().append(this.cssClasses.tooltip).append(this.cssClasses.tooltipOnHoverMode,this.tooltipVisibility==="auto").toString()}get renderedLabelCount(){return this.labelCount<0?6:this.labelCount}get renderedMax(){return this.max}get renderedMin(){return this.min}get renderedMaxRangeLength(){var e;return(e=this.maxRangeLength)!==null&&e!==void 0?e:this.renderedMax-this.renderedMin}get renderedMinRangeLength(){var e;return(e=this.minRangeLength)!==null&&e!==void 0?e:this.step}get renderedLabels(){const e=this.generatedLabels,t=this.customLabels;return this.autoGenerate?e:t}get isNegativeScale(){return this.renderedMin<0}getTextByItem(e){const t=e.value.toString();return this.labelFormat.replace("{0}",""+t)}endLoadingFromJson(){super.endLoadingFromJson(),this.jsonObj.customLabels!==void 0&&(this.autoGenerate=!1),!this.isDesignMode&&this.sliderType==="range"&&this.createNewArray("value")}updateValueFromSurvey(e,t){e=this.ensureValueRespectMinMax(e),super.updateValueFromSurvey(e,t),this.isIndeterminate&&(this.isIndeterminate=!1),this.resetPropertyValue("renderedValue")}runConditionCore(e){super.runConditionCore(e),this.runExpressionByProperty("maxValueExpression",e,t=>{this.max=t??this.renderedMax}),this.runExpressionByProperty("minValueExpression",e,t=>{this.min=t??this.renderedMin})}initPropertyDependencies(){this.registerFunctionOnPropertiesValueChanged(["min","max","step","autoGenerate","labelFormat","labelCount"],()=>{this.resetPropertyValue("generatedLabels"),this.locStrsChanged()}),this.registerSychProperties(["autoGenerate"],()=>{!this.autoGenerate&&this.customLabels.length===0&&this.setPropertyValue("customLabels",this.calcGeneratedLabels()),this.autoGenerate&&this.customLabels.splice(0,this.customLabels.length)}),this.registerFunctionOnPropertiesValueChanged(["min","max","step","maxRangeLength","minRangeLength","sliderType"],()=>{this.resetPropertyValue("renderedValue")})}setNewValue(e){e=this.ensureValueRespectMinMax(e),super.setNewValue(e),this.isIndeterminate&&(this.isIndeterminate=!1),this.resetPropertyValue("renderedValue")}setDefaultValue(){super.setDefaultValue();const e=this.defaultValue;this.sliderType==="single"&&Array.isArray(e)&&this.setSliderValue(e),this.resetPropertyValue("renderedValue")}getDefaultTitleActions(){const e=[];if(!this.isDesignMode){const t=new xe({locTitleName:"clearCaption",id:`sv-clr-btn-${this.id}`,action:()=>{this.clearValueFromUI()},innerCss:this.cssClasses.clearButton,visible:new Ue(()=>this.allowClear&&!this.isReadOnly)});e.push(t)}return e}getItemValueType(){return"sliderlabel"}createLabelItem(e){const t=new nb(e);return t.locOwner=this,t}calcGeneratedLabels(){const e=[];for(let t=0;t<this.renderedLabelCount;t++)e.push(this.createLabelItem(this.getLabelPosition(t)));return e}formatNumber(e){return parseFloat(e.toFixed(4))}ensureValueRespectMinMax(e){return Array.isArray(e)?e.forEach((t,s,i)=>{t<this.min&&(e[s]=this.min),t>this.max&&(e[s]=this.max),s===0?(typeof t>"u"||t===null)&&(e[s]=this.min):s===i.length-1&&(typeof t>"u"||t===null)&&(e[s]=this.max)}):(e<this.min&&(e=this.min),e>this.max&&(e=this.max)),e}isAllowToChange(){return!this.isReadOnly&&!this.isDisabledAttr&&!this.isPreviewStyle&&!this.isDisabledStyle}get isLabelsShowValueText(){return!!this.customLabels.find(e=>e.showValue)}itemValuePropertyChanged(e,t,s,i){if(this.autoGenerate===!0){const r=this.generatedLabels.indexOf(e);this.autoGenerate=!1,this.setPropertyValue("customLabels",this.calcGeneratedLabels()),e=this.customLabels[r]}t==="text"&&(Number.isFinite(+i)?e.value=+i:e.text=i),super.itemValuePropertyChanged(e,t,s,i)}}I([R({defaultValue:"single"})],It.prototype,"sliderType",void 0),I([R({defaultValue:100})],It.prototype,"max",void 0),I([R({defaultValue:0})],It.prototype,"min",void 0),I([R({defaultValue:null})],It.prototype,"maxValueExpression",void 0),I([R({defaultValue:null})],It.prototype,"minValueExpression",void 0),I([R({defaultValue:null})],It.prototype,"maxRangeLength",void 0),I([R({defaultValue:null})],It.prototype,"minRangeLength",void 0),I([R({defaultValue:"{0}"})],It.prototype,"tooltipFormat",void 0),I([R({defaultValue:"{0}"})],It.prototype,"labelFormat",void 0),I([R({defaultValue:"auto"})],It.prototype,"tooltipVisibility",void 0),I([R({defaultValue:!0})],It.prototype,"showLabels",void 0),I([R({defaultValue:!0})],It.prototype,"autoGenerate",void 0),I([R({defaultValue:!0})],It.prototype,"allowDragRange",void 0),I([R({defaultValue:null})],It.prototype,"tickSize",void 0),I([R({defaultValue:!1})],It.prototype,"allowClear",void 0),I([R({defaultValue:null})],It.prototype,"focusedThumb",void 0),I([R({defaultValue:null})],It.prototype,"animatedThumb",void 0);function ab(n,e,t,s){let i=t?e:n;return n>=e?t?n+s:e-s:i}B.addClass("sliderlabel",[{name:"!value:number"},{name:"visibleIf",visible:!1},{name:"enableIf",visible:!1},{name:"showValue:boolean",locationInTable:"detail",default:!1}],n=>new nb(n),"itemvalue"),B.addClass("slider",[{name:"sliderType",default:"single",choices:["single","range"]},{name:"autoGenerate",default:!0,isSerializable:!1,choices:[!0,!1]},{name:"min:number",default:0,onSettingValue:(n,e)=>ab(e,n.max,!1,n.step)},{name:"max:number",default:100,onSettingValue:(n,e)=>ab(n.min,e,!0,n.step)},{name:"step:number",default:1},{name:"minValueExpression",type:"expression"},{name:"maxValueExpression",type:"expression"},{name:"minRangeLength:number",visibleIf:function(n){return n.sliderType==="range"}},{name:"maxRangeLength:number",visibleIf:function(n){return n.sliderType==="range"}},{name:"customLabels:sliderlabel[]",visibleIf:function(n){return!n.autoGenerate}},{name:"showLabels:boolean",default:!0},{name:"tooltipVisibility:string",default:"auto",choices:["auto","always","never"]},{name:"labelFormat:string",default:"{0}"},{name:"tooltipFormat:string",default:"{0}"},{name:"allowDragRange:boolean",default:!0,visible:!1,visibleIf:function(n){return n.sliderType==="range"}},{name:"allowSwap:boolean",default:!0,visibleIf:function(n){return n.sliderType==="range"}},{name:"labelCount:number",default:-1,visibleIf:function(n){return n.autoGenerate}},{name:"allowClear:boolean",default:!1}],function(){return new It("")},"question"),Qe.Instance.registerQuestion("slider",n=>new It(n));class ir extends kt{constructor(e){super(e),this.createLocalizableString("labelFalse",this,!0,"booleanUncheckedLabel"),this.createLocalizableString("labelTrue",this,!0,"booleanCheckedLabel")}getType(){return"boolean"}isLayoutTypeSupported(e){return!0}supportAutoAdvance(){return this.renderAs!=="checkbox"}get isIndeterminate(){return this.isEmpty()}get booleanValue(){return this.isEmpty()?null:this.value==this.getValueTrue()}set booleanValue(e){this.isReadOnly||this.isDesignMode||this.setBooleanValue(e)}setBooleanValue(e){this.isValueEmpty(e)?this.value=void 0:this.value=e==!0?this.getValueTrue():this.getValueFalse()}get defaultValue(){return this.getPropertyValue("defaultValue")}set defaultValue(e){e===!0&&(e="true"),e===!1&&(e="false"),this.setPropertyValue("defaultValue",e),this.updateValueWithDefaults()}getDefaultValue(){const e=this.defaultValue;if(!(e==="indeterminate"||e===void 0||e===null))return e=="true"?this.getValueTrue():this.getValueFalse()}get locTitle(){const e=this.getLocalizableString("title");return(this.isLabelRendered&&!this.showTitle||this.isValueEmpty(e.text))&&!this.isValueEmpty(this.locLabel.text)?this.locLabel:e}get labelRenderedAriaID(){return this.isLabelRendered?this.ariaTitleId:null}beforeDestroyQuestionElement(e){super.beforeDestroyQuestionElement(e),this.leftAnswerElement=void 0}get isLabelRendered(){return this.titleLocation==="hidden"||this.useTitleAsLabel}get canRenderLabelDescription(){return this.isLabelRendered&&this.hasDescription&&(this.hasDescriptionUnderTitle||this.hasDescriptionUnderInput)}get labelTrue(){return this.getLocalizableStringText("labelTrue")}set labelTrue(e){this.setLocalizableStringText("labelTrue",e)}get locLabelTrue(){return this.getLocalizableString("labelTrue")}get isDeterminated(){return this.booleanValue!==null&&this.booleanValue!==void 0}get locLabelLeft(){return this.swapOrder?this.getLocalizableString("labelTrue"):this.getLocalizableString("labelFalse")}get locLabelRight(){return this.swapOrder?this.getLocalizableString("labelFalse"):this.getLocalizableString("labelTrue")}get labelFalse(){return this.getLocalizableStringText("labelFalse")}set labelFalse(e){this.setLocalizableStringText("labelFalse",e)}get locLabelFalse(){return this.getLocalizableString("labelFalse")}getValueTrue(){return this.valueTrue!==void 0?this.valueTrue:!0}getValueFalse(){return this.valueFalse!==void 0?this.valueFalse:!1}setDefaultValue(){this.isDefaultValueSet("true",this.valueTrue)&&this.setBooleanValue(!0),this.isDefaultValueSet("false",this.valueFalse)&&this.setBooleanValue(!1);const e=this.defaultValue;(e==="indeterminate"||e===null||e===void 0)&&this.setBooleanValue(void 0)}isDefaultValueSet(e,t){return this.defaultValue==e||t!==void 0&&this.defaultValue===t}getDisplayValueCore(e,t){return t==this.getValueTrue()?this.locLabelTrue.textOrHtml:this.locLabelFalse.textOrHtml}getItemCssValue(e){return new j().append(e.item).append(e.itemOnError,this.hasCssError()).append(e.itemDisabled,this.isDisabledStyle).append(e.itemReadOnly,this.isReadOnlyStyle).append(e.itemPreview,this.isPreviewStyle).append(e.itemHover,!this.isDesignMode).append(e.itemChecked,!!this.booleanValue).append(e.itemExchanged,!!this.swapOrder).append(e.itemIndeterminate,!this.isDeterminated).append(e.itemIsLabelRendered,!!this.isLabelRendered).toString()}getItemCss(){return this.getItemCssValue(this.cssClasses)}getCheckboxItemCss(){return this.getItemCssValue({item:this.cssClasses.checkboxItem,itemOnError:this.cssClasses.checkboxItemOnError,itemDisabled:this.cssClasses.checkboxItemDisabled,itemDisable:this.cssClasses.checkboxItemDisabled,itemReadOnly:this.cssClasses.checkboxItemReadOnly,itemPreview:this.cssClasses.checkboxItemPreview,itemChecked:this.cssClasses.checkboxItemChecked,itemIndeterminate:this.cssClasses.checkboxItemIndeterminate,itemIsLabelRendered:this.cssClasses.checkboxIsLabelRendered})}getLabelCss(e){return new j().append(this.cssClasses.label).append(this.cssClasses.disabledLabel,this.booleanValue===!e||this.isDisabledStyle).append(this.cssClasses.labelReadOnly,this.isReadOnlyStyle).append(this.cssClasses.labelPreview,this.isPreviewStyle).append(this.cssClasses.labelTrue,!this.isIndeterminate&&e===!this.swapOrder).append(this.cssClasses.labelFalse,!this.isIndeterminate&&e===this.swapOrder).toString()}updateValueFromSurvey(e,t=!1){super.updateValueFromSurvey(e,t)}onValueChanged(){super.onValueChanged()}get svgIcon(){return this.booleanValue&&this.cssClasses.svgIconCheckedId?this.cssClasses.svgIconCheckedId:!this.isDeterminated&&this.cssClasses.svgIconIndId?this.cssClasses.svgIconIndId:!this.booleanValue&&this.cssClasses.svgIconUncheckedId?this.cssClasses.svgIconUncheckedId:this.cssClasses.svgIconId}get itemSvgIcon(){return this.isPreviewStyle&&this.cssClasses.itemPreviewSvgIconId?this.cssClasses.itemPreviewSvgIconId:this.cssClasses.itemSvgIconId}get allowClick(){return this.isIndeterminate&&!this.isInputReadOnly}getCheckedLabel(){if(this.booleanValue===!0)return this.locLabelTrue;if(this.booleanValue===!1)return this.locLabelFalse}setQuestionValue(e,t=!0){e==="true"&&this.valueTrue!=="true"&&(e=!0),e==="false"&&this.valueFalse!=="false"&&(e=!1),(e==="indeterminate"||e===null)&&(e=void 0),super.setQuestionValue(e,t)}onLabelClick(e,t){return this.allowClick&&(C1(e),this.booleanValue=t),!0}calculateBooleanValueByEvent(e,t){let s=!1;oe.isAvailable()&&(s=oe.getComputedStyle(e.target).direction=="rtl"),this.booleanValue=s?!t:t}onSwitchClickModel(e){if(this.allowClick){C1(e);var t=e.offsetX/e.target.offsetWidth>.5;this.calculateBooleanValueByEvent(e,t);return}return!0}onKeyDownCore(e){return(e.key==="ArrowLeft"||e.key==="ArrowRight")&&(e.stopPropagation(),this.calculateBooleanValueByEvent(e,e.key==="ArrowRight")),!0}getRadioItemClass(e,t){let s;return e.radioItem&&(s=e.radioItem),e.radioItemChecked&&t===this.value&&(s=(s?s+" ":"")+e.radioItemChecked),this.isDisabledStyle&&(s+=" "+e.radioItemDisabled),this.isReadOnlyStyle&&(s+=" "+e.radioItemReadOnly),this.isPreviewStyle&&(s+=" "+e.radioItemPreview),s}supportResponsiveness(){return!0}getCompactRenderAs(){return"radio"}createActionContainer(e){return super.createActionContainer(this.renderAs!=="checkbox")}getIsTitleRenderedAsString(){return!1}get isNewA11yStructure(){return!0}get a11y_input_ariaRole(){return"switch"}}I([R({localizable:!0})],ir.prototype,"label",void 0),I([R({defaultValue:!1,onSet:(n,e)=>{n&&e.setPropertyValue("titleLocation","hidden")}})],ir.prototype,"useTitleAsLabel",void 0),I([R({defaultValue:!1})],ir.prototype,"swapOrder",void 0),I([R()],ir.prototype,"valueTrue",void 0),I([R()],ir.prototype,"valueFalse",void 0),B.addClass("boolean",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},{name:"label:text",serializationProperty:"locLabel",isSerializable:!1,visible:!1},{name:"labelTrue",serializationProperty:"locLabelTrue"},{name:"labelFalse",serializationProperty:"locLabelFalse"},"valueTrue","valueFalse",{name:"swapOrder:boolean",category:"general"},{name:"renderAs",default:"default",visible:!1},{name:"useTitleAsLabel",default:!1,visible:!1}],function(){return new ir("")},"question"),Qe.Instance.registerQuestion("boolean",n=>new ir(n));class Qd extends hl{constructor(e,t,s){super(e,t,s),this.typeName=s,this.createLocalizableString("imageLink")}getBaseType(){return"imageitemvalue"}get imageLink(){return this.getLocalizableStringText("imageLink")}set imageLink(e){this.setLocalizableStringText("imageLink",e),this.imageNotLoaded=!1,this.videoNotLoaded=!1}get locImageLink(){return this.getLocalizableString("imageLink")}getLocale(){return this.locOwner?this.locOwner.getLocale():""}getMarkdownHtml(e,t,s){return this.locOwner?this.locOwner.getMarkdownHtml(e,t,s):void 0}getRenderer(e){return this.locOwner?this.locOwner.getRenderer(e):null}getRendererContext(e){return this.locOwner?this.locOwner.getRendererContext(e):e}getProcessedText(e){return this.locOwner?this.locOwner.getProcessedText(e):e}onErrorHandler(){this.contentNotLoaded=!0}set contentNotLoaded(e){this.locOwner instanceof ds&&this.locOwner.contentMode=="video"?this.videoNotLoaded=e:this.imageNotLoaded=e}get contentNotLoaded(){return this.locOwner instanceof ds&&this.locOwner.contentMode=="video"?this.videoNotLoaded:this.imageNotLoaded}}I([R({defaultValue:!1})],Qd.prototype,"videoNotLoaded",void 0),I([R({defaultValue:!1})],Qd.prototype,"imageNotLoaded",void 0);class ds extends dl{constructor(e){super(e),this.isResponsiveValue=!1,this.onContentLoaded=(t,s)=>{t.contentNotLoaded=!1;const i=s.target;this.contentMode=="video"?t.aspectRatio=i.videoWidth/i.videoHeight:t.aspectRatio=i.naturalWidth/i.naturalHeight,this._width&&this.processResponsiveness(0,this._width)},this.gridColCount=void 0,this.colCount=0,this.registerPropertyChangedHandlers(["minImageWidth","maxImageWidth","minImageHeight","maxImageHeight","visibleChoices","colCount","isResponsiveValue"],()=>{this._width&&this.processResponsiveness(0,this._width)}),this.registerPropertyChangedHandlers(["imageWidth","imageHeight"],()=>{this.calcIsResponsive()}),this.calcIsResponsive()}getType(){return"imagepicker"}supportAutoAdvance(){return!this.multiSelect}get hasSingleInput(){return!1}getItemValueType(){return"imageitemvalue"}get isCompositeQuestion(){return!0}get itemFlowDirection(){return"row"}supportOther(){return!1}supportNone(){return!1}supportRefuse(){return!1}supportDontKnow(){return!1}isAnswerCorrect(){return this.multiSelect?L.isArrayContainsEqual(this.value,this.correctAnswer):super.isAnswerCorrect()}get multiSelect(){return this.getPropertyValue("multiSelect")}set multiSelect(e){this.setPropertyValue("multiSelect",e)}isItemSelected(e){var t=this.value;const s=e;if(this.isValueEmpty(t)||!s.imageLink||s.contentNotLoaded)return!1;if(!this.multiSelect)return this.isTwoValueEquals(t,e.value);if(!Array.isArray(t))return!1;for(var i=0;i<t.length;i++)if(this.isTwoValueEquals(t[i],e.value))return!0;return!1}getItemEnabled(e){const t=e;return!t.imageLink||t.contentNotLoaded?!1:super.getItemEnabled(e)}clearIncorrectValues(){if(this.multiSelect){var e=this.value;if(!e)return;if(!Array.isArray(e)||e.length==0){this.clearValue(!0);return}for(var t=[],s=0;s<e.length;s++)this.hasUnknownValue(e[s],!0)||t.push(e[s]);if(t.length==e.length)return;t.length==0?this.clearValue(!0):this.value=t}else super.clearIncorrectValues()}getDisplayValueCore(e,t){return!this.multiSelect&&!Array.isArray(t)?super.getDisplayValueCore(e,t):this.getDisplayArrayValue(e,t)}get showLabel(){return this.getPropertyValue("showLabel")}set showLabel(e){this.setPropertyValue("showLabel",e)}endLoadingFromJson(){super.endLoadingFromJson(),!this.isDesignMode&&this.multiSelect&&(this.createNewArray("renderedValue"),this.createNewArray("value")),this.calcIsResponsive()}getValueCore(){var e=super.getValueCore();return e!==void 0?e:this.multiSelect?[]:e}convertValToArrayForMultSelect(e){return!this.multiSelect||this.isValueEmpty(e)||Array.isArray(e)?e:[e]}renderedValueFromDataCore(e){return this.convertValToArrayForMultSelect(e)}renderedValueToDataCore(e){return this.convertValToArrayForMultSelect(e)}get imageHeight(){return this.getPropertyValue("imageHeight")}set imageHeight(e){this.setPropertyValue("imageHeight",e)}get imageScale(){return this.survey?this.survey.widthScale/100:1}get renderedImageHeight(){const e=this.isResponsive?Math.floor(this.responsiveImageHeight):this.imageHeight*this.imageScale;return e||150*this.imageScale}get imageWidth(){return this.getPropertyValue("imageWidth")}set imageWidth(e){this.setPropertyValue("imageWidth",e)}get renderedImageWidth(){const e=this.isResponsive?Math.floor(this.responsiveImageWidth):this.imageWidth*this.imageScale;return e||200*this.imageScale}get imageFit(){return this.getPropertyValue("imageFit")}set imageFit(e){this.setPropertyValue("imageFit",e)}get contentMode(){return this.getPropertyValue("contentMode")}set contentMode(e){this.setPropertyValue("contentMode",e),e==="video"&&(this.showLabel=!0)}valueToData(e){return e}get inputType(){return this.multiSelect?"checkbox":"radio"}isBuiltInChoice(e){return!1}addToVisibleChoices(e,t){this.addNewItemToVisibleChoices(e,t)}getSelectBaseRootCss(){const e=this.isResponsive;return new j().append(super.getSelectBaseRootCss()).append(this.cssClasses.rootResponsive,e).append(this.cssClasses.rootStatic,!e).append(this.cssClasses.rootColumn,this.getCurrentColCount()==1).toString()}get isResponsive(){return this.isResponsiveValue}get exactSizesAreEmpty(){return!["imageHeight","imageWidth"].some(e=>this[e]!==void 0&&this[e]!==null)}calcIsResponsive(){this.isResponsiveValue=this.exactSizesAreEmpty}getObservedElementSelector(){return ls(this.cssClasses.root)}supportResponsiveness(){return!0}needResponsiveness(){return this.supportResponsiveness()}needResponsiveWidth(){return this.colCount>2}getCurrentColCount(){return this.responsiveColCount===void 0||this.colCount===0?this.colCount:this.responsiveColCount}getContainerStyle(){return this.isResponsive?{gridAutoFlow:this.gridColCount?null:"column",gridTemplateColumns:this.gridColCount?`repeat(${this.gridColCount}, 1fr)`:null}:{}}processResponsiveness(e,t){this._width=t=Math.floor(t);const s=(i,r,a)=>{let o=Math.floor(i/(r+a));return(o+1)*(r+a)-a<=i&&o++,o};if(this.isResponsive){const i=this.choices.length+(this.isDesignMode?1:0),r=(this.gapBetweenItems||0)*this.imageScale,a=this.minImageWidth*this.imageScale,o=this.maxImageWidth*this.imageScale,l=this.maxImageHeight*this.imageScale,u=this.minImageHeight*this.imageScale;let d=this.colCount,h;const f=s(t,a,r);d===0?((r+a)*i-r>t?h=Math.floor((t-r*(f-1))/f):h=Math.floor((t-r*(i-1))/i),this.gridColCount=Math.max(Math.min(i,f),1)):(f<d?(this.responsiveColCount=Math.max(f,1),d=this.responsiveColCount):this.responsiveColCount=d,this.gridColCount=this.responsiveColCount,h=Math.floor((t-r*(d-1))/d)),h=Math.max(a,Math.min(h,o));let C=Number.MIN_VALUE;this.choices.forEach(V=>{const P=h/V.aspectRatio;C=P>C?P:C}),C>l?C=l:C<u&&(C=u);const b=this.responsiveImageWidth,x=this.responsiveImageHeight;return this.responsiveImageWidth=h,this.responsiveImageHeight=C,b!==this.responsiveImageWidth||x!==this.responsiveImageHeight}return!1}triggerResponsiveness(e=!0){e&&this.reCalcGapBetweenItemsCallback&&this.reCalcGapBetweenItemsCallback(),super.triggerResponsiveness(e)}afterRender(e){super.afterRender(e);const t=this.getObservedElementSelector(),s=e&&t?e.querySelector(t):void 0;s&&(this.reCalcGapBetweenItemsCallback=()=>{this.gapBetweenItems=Math.ceil(Number.parseFloat(oe.getComputedStyle(s).gap))||16},this.reCalcGapBetweenItemsCallback())}get ariaRole(){return this.multiSelect?"group":"radiogroup"}get ariaRequired(){return null}get inputRequiredAttribute(){return this.multiSelect?this.hasRequiredError():null}}I([R({})],ds.prototype,"responsiveImageHeight",void 0),I([R({})],ds.prototype,"responsiveImageWidth",void 0),I([R({})],ds.prototype,"isResponsiveValue",void 0),I([R({})],ds.prototype,"maxImageWidth",void 0),I([R({})],ds.prototype,"minImageWidth",void 0),I([R({})],ds.prototype,"maxImageHeight",void 0),I([R({})],ds.prototype,"minImageHeight",void 0),I([R({})],ds.prototype,"responsiveColCount",void 0),I([R()],ds.prototype,"gridColCount",void 0),B.addClass("imageitemvalue",[{name:"imageLink:file",serializationProperty:"locImageLink"}],n=>new Qd(n),"itemvalue"),B.addClass("responsiveImageSize",[],void 0,"number"),B.addClass("imagepicker",[{name:"showOtherItem",visible:!1},{name:"otherText",visible:!1},{name:"showNoneItem",visible:!1},{name:"showRefuseItem",visible:!1},{name:"showDontKnowItem",visible:!1},{name:"noneText",visible:!1},{name:"placeholder",visible:!1},{name:"otherErrorText",visible:!1},{name:"storeOthersAsComment",visible:!1},{name:"contentMode",default:"image",choices:["image","video"]},{name:"imageFit",default:"contain",choices:["none","contain","cover","fill"]},{name:"imageHeight:number",minValue:0},{name:"imageWidth:number",minValue:0},{name:"minImageWidth:responsiveImageSize",default:200,minValue:0},{name:"minImageHeight:responsiveImageSize",default:133,minValue:0},{name:"maxImageWidth:responsiveImageSize",default:3e3,minValue:0},{name:"maxImageHeight:responsiveImageSize",default:3e3,minValue:0},"showLabel:boolean",{name:"colCount:number",default:0,choices:[0,1,2,3,4,5]},"multiSelect:boolean"],function(){return new ds("")},"checkboxbase"),B.getProperty("imagepicker","choices").type="imageitemvalue[]",Qe.Instance.registerQuestion("imagepicker",n=>{var e=new ds(n);return e});const ob=[".mp4",".mov",".wmv",".flv",".avi",".mkv"],Q_="https://www.youtube.com/",lb="embed";class Hd extends Fd{constructor(e){super(e);const t=this.createLocalizableString("imageLink");t.onGetTextCallback=s=>H_(s,this.contentMode=="youtube"),this.createLocalizableString("altText"),this.registerPropertyChangedHandlers(["contentMode","imageLink"],()=>this.calculateRenderedMode())}getType(){return"image"}get isCompositeQuestion(){return!1}onSurveyLoad(){super.onSurveyLoad(),this.calculateRenderedMode()}get imageLink(){return this.getLocalizableStringText("imageLink")}set imageLink(e){this.setLocalizableStringText("imageLink",e)}get locImageLink(){return this.getLocalizableString("imageLink")}get altText(){return this.getLocalizableStringText("altText")}set altText(e){this.setLocalizableStringText("altText",e)}get locAltText(){return this.getLocalizableString("altText")}get imageHeight(){return this.getPropertyValue("imageHeight")}set imageHeight(e){this.setPropertyValue("imageHeight",e)}get renderedStyleHeight(){return this.imageHeight?Yo(this.imageHeight):void 0}get renderedHeight(){return this.imageHeight?er(this.imageHeight):void 0}get imageWidth(){return this.getPropertyValue("imageWidth")}set imageWidth(e){this.setPropertyValue("imageWidth",e)}get renderedStyleWidth(){return this.imageWidth?Yo(this.imageWidth):void 0}get renderedWidth(){return this.imageWidth?er(this.imageWidth):void 0}get imageFit(){return this.getPropertyValue("imageFit")}set imageFit(e){this.setPropertyValue("imageFit",e)}get contentMode(){return this.getPropertyValue("contentMode")}set contentMode(e){this.setPropertyValue("contentMode",e),e==="video"&&(this.showLabel=!0)}get renderedMode(){return this.getPropertyValue("renderedMode","image")}get ariaInvalid(){return null}get ariaLabel(){return null}get renderedAltText(){return this.altText||this.title}getImageCss(){const e=this.getPropertyByName("imageHeight"),t=this.getPropertyByName("imageWidth"),s=e.isDefaultValue(this.imageHeight)&&t.isDefaultValue(this.imageWidth);return new j().append(this.cssClasses.image).append(this.cssClasses.adaptive,s).toString()}onLoadHandler(){this.contentNotLoaded=!1}onErrorHandler(){this.contentNotLoaded=!0}setRenderedMode(e){this.setPropertyValue("renderedMode",e)}calculateRenderedMode(){this.contentMode!=="auto"?this.setRenderedMode(this.contentMode):this.isYoutubeVideo()?this.setRenderedMode("youtube"):this.isVideo()?this.setRenderedMode("video"):this.setRenderedMode("image")}isYoutubeVideo(){return L.isUrlYoutubeVideo(this.imageLink)}isVideo(){let e=this.imageLink;if(!e)return!1;e=e.toLowerCase();for(let t=0;t<ob.length;t++)if(e.endsWith(ob[t]))return!0;return!1}}I([R({defaultValue:!1})],Hd.prototype,"contentNotLoaded",void 0);function H_(n,e){if(!n||!L.isUrlYoutubeVideo(n))return e?"":n;if(n.toLocaleLowerCase().indexOf(lb)>-1)return n;let s="";for(var i=n.length-1;i>=0&&!(n[i]==="="||n[i]==="/");i--)s=n[i]+s;return Q_+lb+"/"+s}B.addClass("image",[{name:"imageLink:file",serializationProperty:"locImageLink"},{name:"altText",serializationProperty:"locAltText",alternativeName:"text",category:"general"},{name:"contentMode",default:"auto",choices:["auto","image","video","youtube"]},{name:"imageFit",default:"contain",choices:["none","contain","cover","fill"]},{name:"imageHeight",default:"150"},{name:"imageWidth",default:"200"}],function(){return new Hd("")},"nonvalue"),Qe.Instance.registerQuestion("image",n=>new Hd(n));class yl{constructor(e,t,s,i){if(isNaN(e)||isNaN(t))throw new Error(`Point is invalid: (${e}, ${t})`);this.x=+e,this.y=+t,this.pressure=s||0,this.time=i||Date.now()}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}equals(e){return this.x===e.x&&this.y===e.y&&this.pressure===e.pressure&&this.time===e.time}velocityFrom(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):0}}class zd{static fromPoints(e,t){const s=this.calculateControlPoints(e[0],e[1],e[2]).c2,i=this.calculateControlPoints(e[1],e[2],e[3]).c1;return new zd(e[1],s,i,e[2],t.start,t.end)}static calculateControlPoints(e,t,s){const i=e.x-t.x,r=e.y-t.y,a=t.x-s.x,o=t.y-s.y,l={x:(e.x+t.x)/2,y:(e.y+t.y)/2},u={x:(t.x+s.x)/2,y:(t.y+s.y)/2},d=Math.sqrt(i*i+r*r),h=Math.sqrt(a*a+o*o),f=l.x-u.x,C=l.y-u.y,b=h/(d+h),x={x:u.x+f*b,y:u.y+C*b},V=t.x-x.x,P=t.y-x.y;return{c1:new yl(l.x+V,l.y+P),c2:new yl(u.x+V,u.y+P)}}constructor(e,t,s,i,r,a){this.startPoint=e,this.control2=t,this.control1=s,this.endPoint=i,this.startWidth=r,this.endWidth=a}length(){let t=0,s,i;for(let r=0;r<=10;r+=1){const a=r/10,o=this.point(a,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),l=this.point(a,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(r>0){const u=o-s,d=l-i;t+=Math.sqrt(u*u+d*d)}s=o,i=l}return t}point(e,t,s,i,r){return t*(1-e)*(1-e)*(1-e)+3*s*(1-e)*(1-e)*e+3*i*(1-e)*e*e+r*e*e*e}}class z_{constructor(){try{this._et=new EventTarget}catch{this._et=document}}addEventListener(e,t,s){this._et.addEventListener(e,t,s)}dispatchEvent(e){return this._et.dispatchEvent(e)}removeEventListener(e,t,s){this._et.removeEventListener(e,t,s)}}function j_(n,e=250){let t=0,s=null,i,r,a;const o=()=>{t=Date.now(),s=null,i=n.apply(r,a),s||(r=null,a=[])};return function(...u){const d=Date.now(),h=e-(d-t);return r=this,a=u,h<=0||h>e?(s&&(clearTimeout(s),s=null),t=d,i=n.apply(r,a),s||(r=null,a=[])):s||(s=window.setTimeout(o,h)),i}}class vl extends z_{constructor(e,t={}){super(),this.canvas=e,this._drawingStroke=!1,this._isEmpty=!0,this._lastPoints=[],this._data=[],this._lastVelocity=0,this._lastWidth=0,this._handleMouseDown=s=>{s.buttons===1&&this._strokeBegin(s)},this._handleMouseMove=s=>{this._strokeMoveUpdate(s)},this._handleMouseUp=s=>{s.buttons===1&&this._strokeEnd(s)},this._handleTouchStart=s=>{if(s.cancelable&&s.preventDefault(),s.targetTouches.length===1){const i=s.changedTouches[0];this._strokeBegin(i)}},this._handleTouchMove=s=>{s.cancelable&&s.preventDefault();const i=s.targetTouches[0];this._strokeMoveUpdate(i)},this._handleTouchEnd=s=>{if(s.target===this.canvas){s.cancelable&&s.preventDefault();const r=s.changedTouches[0];this._strokeEnd(r)}},this._handlePointerStart=s=>{s.preventDefault(),this._strokeBegin(s)},this._handlePointerMove=s=>{this._strokeMoveUpdate(s)},this._handlePointerEnd=s=>{this._drawingStroke&&(s.preventDefault(),this._strokeEnd(s))},this.velocityFilterWeight=t.velocityFilterWeight||.7,this.minWidth=t.minWidth||.5,this.maxWidth=t.maxWidth||2.5,this.throttle="throttle"in t?t.throttle:16,this.minDistance="minDistance"in t?t.minDistance:5,this.dotSize=t.dotSize||0,this.penColor=t.penColor||"black",this.backgroundColor=t.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=t.compositeOperation||"source-over",this.canvasContextOptions="canvasContextOptions"in t?t.canvasContextOptions:{},this._strokeMoveUpdate=this.throttle?j_(vl.prototype._strokeUpdate,this.throttle):vl.prototype._strokeUpdate,this._ctx=e.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){const{_ctx:e,canvas:t}=this;e.fillStyle=this.backgroundColor,e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0}fromDataURL(e,t={}){return new Promise((s,i)=>{const r=new Image,a=t.ratio||window.devicePixelRatio||1,o=t.width||this.canvas.width/a,l=t.height||this.canvas.height/a,u=t.xOffset||0,d=t.yOffset||0;this._reset(this._getPointGroupOptions()),r.onload=()=>{this._ctx.drawImage(r,u,d,o,l),s()},r.onerror=h=>{i(h)},r.crossOrigin="anonymous",r.src=e,this._isEmpty=!1})}toDataURL(e="image/png",t){switch(e){case"image/svg+xml":return typeof t!="object"&&(t=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(t))}`;default:return typeof t!="number"&&(t=void 0),this.canvas.toDataURL(e,t)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";const e=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!e?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerStart),this.canvas.removeEventListener("pointermove",this._handlePointerMove),this.canvas.ownerDocument.removeEventListener("pointerup",this._handlePointerEnd),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("mousemove",this._handleMouseMove),this.canvas.ownerDocument.removeEventListener("mouseup",this._handleMouseUp),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this.canvas.removeEventListener("touchmove",this._handleTouchMove),this.canvas.removeEventListener("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(e,{clear:t=!0}={}){t&&this.clear(),this._fromData(e,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(e)}toData(){return this._data}_getPointGroupOptions(e){return{penColor:e&&"penColor"in e?e.penColor:this.penColor,dotSize:e&&"dotSize"in e?e.dotSize:this.dotSize,minWidth:e&&"minWidth"in e?e.minWidth:this.minWidth,maxWidth:e&&"maxWidth"in e?e.maxWidth:this.maxWidth,velocityFilterWeight:e&&"velocityFilterWeight"in e?e.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:e&&"compositeOperation"in e?e.compositeOperation:this.compositeOperation}}_strokeBegin(e){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:e,cancelable:!0})))return;this._drawingStroke=!0;const s=this._getPointGroupOptions(),i=Object.assign(Object.assign({},s),{points:[]});this._data.push(i),this._reset(s),this._strokeUpdate(e)}_strokeUpdate(e){if(!this._drawingStroke)return;if(this._data.length===0){this._strokeBegin(e);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:e}));const t=e.clientX,s=e.clientY,i=e.pressure!==void 0?e.pressure:e.force!==void 0?e.force:0,r=this._createPoint(t,s,i),a=this._data[this._data.length-1],o=a.points,l=o.length>0&&o[o.length-1],u=l?r.distanceTo(l)<=this.minDistance:!1,d=this._getPointGroupOptions(a);if(!l||!(l&&u)){const h=this._addPoint(r,d);l?h&&this._drawCurve(h,d):this._drawDot(r,d),o.push({time:r.time,x:r.x,y:r.y,pressure:r.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:e}))}_strokeEnd(e){this._drawingStroke&&(this._strokeUpdate(e),this._drawingStroke=!1,this.dispatchEvent(new CustomEvent("endStroke",{detail:e})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerStart),this.canvas.addEventListener("pointermove",this._handlePointerMove),this.canvas.ownerDocument.addEventListener("pointerup",this._handlePointerEnd)}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown),this.canvas.addEventListener("mousemove",this._handleMouseMove),this.canvas.ownerDocument.addEventListener("mouseup",this._handleMouseUp)}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart),this.canvas.addEventListener("touchmove",this._handleTouchMove),this.canvas.addEventListener("touchend",this._handleTouchEnd)}_reset(e){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(e.minWidth+e.maxWidth)/2,this._ctx.fillStyle=e.penColor,this._ctx.globalCompositeOperation=e.compositeOperation}_createPoint(e,t,s){const i=this.canvas.getBoundingClientRect();return new yl(e-i.left,t-i.top,s,new Date().getTime())}_addPoint(e,t){const{_lastPoints:s}=this;if(s.push(e),s.length>2){s.length===3&&s.unshift(s[0]);const i=this._calculateCurveWidths(s[1],s[2],t),r=zd.fromPoints(s,i);return s.shift(),r}return null}_calculateCurveWidths(e,t,s){const i=s.velocityFilterWeight*t.velocityFrom(e)+(1-s.velocityFilterWeight)*this._lastVelocity,r=this._strokeWidth(i,s),a={end:r,start:this._lastWidth};return this._lastVelocity=i,this._lastWidth=r,a}_strokeWidth(e,t){return Math.max(t.maxWidth/(e+1),t.minWidth)}_drawCurveSegment(e,t,s){const i=this._ctx;i.moveTo(e,t),i.arc(e,t,s,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(e,t){const s=this._ctx,i=e.endWidth-e.startWidth,r=Math.ceil(e.length())*2;s.beginPath(),s.fillStyle=t.penColor;for(let a=0;a<r;a+=1){const o=a/r,l=o*o,u=l*o,d=1-o,h=d*d,f=h*d;let C=f*e.startPoint.x;C+=3*h*o*e.control1.x,C+=3*d*l*e.control2.x,C+=u*e.endPoint.x;let b=f*e.startPoint.y;b+=3*h*o*e.control1.y,b+=3*d*l*e.control2.y,b+=u*e.endPoint.y;const x=Math.min(e.startWidth+u*i,t.maxWidth);this._drawCurveSegment(C,b,x)}s.closePath(),s.fill()}_drawDot(e,t){const s=this._ctx,i=t.dotSize>0?t.dotSize:(t.minWidth+t.maxWidth)/2;s.beginPath(),this._drawCurveSegment(e.x,e.y,i),s.closePath(),s.fillStyle=t.penColor,s.fill()}_fromData(e,t,s){for(const i of e){const{points:r}=i,a=this._getPointGroupOptions(i);if(r.length>1)for(let o=0;o<r.length;o+=1){const l=r[o],u=new yl(l.x,l.y,l.pressure,l.time);o===0&&this._reset(a);const d=this._addPoint(u,a);d&&t(d,a)}else this._reset(a),s(r[0],a)}}toSVG({includeBackgroundColor:e=!1}={}){const t=this._data,s=Math.max(window.devicePixelRatio||1,1),i=0,r=0,a=this.canvas.width/s,o=this.canvas.height/s,l=document.createElementNS("http://www.w3.org/2000/svg","svg");if(l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),l.setAttribute("viewBox",`${i} ${r} ${a} ${o}`),l.setAttribute("width",a.toString()),l.setAttribute("height",o.toString()),e&&this.backgroundColor){const u=document.createElement("rect");u.setAttribute("width","100%"),u.setAttribute("height","100%"),u.setAttribute("fill",this.backgroundColor),l.appendChild(u)}return this._fromData(t,(u,{penColor:d})=>{const h=document.createElement("path");if(!isNaN(u.control1.x)&&!isNaN(u.control1.y)&&!isNaN(u.control2.x)&&!isNaN(u.control2.y)){const f=`M ${u.startPoint.x.toFixed(3)},${u.startPoint.y.toFixed(3)} C ${u.control1.x.toFixed(3)},${u.control1.y.toFixed(3)} ${u.control2.x.toFixed(3)},${u.control2.y.toFixed(3)} ${u.endPoint.x.toFixed(3)},${u.endPoint.y.toFixed(3)}`;h.setAttribute("d",f),h.setAttribute("stroke-width",(u.endWidth*2.25).toFixed(3)),h.setAttribute("stroke",d),h.setAttribute("fill","none"),h.setAttribute("stroke-linecap","round"),l.appendChild(h)}},(u,{penColor:d,dotSize:h,minWidth:f,maxWidth:C})=>{const b=document.createElement("circle"),x=h>0?h:(f+C)/2;b.setAttribute("r",x.toString()),b.setAttribute("cx",u.x.toString()),b.setAttribute("cy",u.y.toString()),b.setAttribute("fill",d),l.appendChild(b)}),l.outerHTML}}var U_=300,W_=200;class ks extends fl{getPenColorFromTheme(){const e=this.survey;return!!e&&!!e.themeVariables&&e.themeVariables["--sjs-primary-backcolor"]}updateColors(e){const t=this.getPenColorFromTheme(),s=this.getPropertyByName("penColor");e.penColor=this.penColor||t||s.defaultValue||"#1ab394";const i=this.getPropertyByName("backgroundColor"),r=t?"transparent":void 0,a=this.backgroundImage?"transparent":this.backgroundColor;e.backgroundColor=a||r||i.defaultValue||"#ffffff"}getCssRoot(e){return new j().append(super.getCssRoot(e)).append(e.small,this.signatureWidth.toString()==="300").toString()}getFormat(){return this.dataFormat==="jpeg"?"image/jpeg":this.dataFormat==="svg"?"image/svg+xml":""}updateValue(){if(this.signaturePad){var e=this.signaturePad.toDataURL(this.getFormat());this.valueIsUpdatingInternally=!0,this.value=e,this.valueIsUpdatingInternally=!1}}constructor(e){super(e),this.valueIsUpdatingInternally=!1,this._loadedData=void 0,this.updateValueHandler=()=>{this._loadedData=void 0,this.scaleCanvas(!0,!0)}}getType(){return"signaturepad"}afterRenderQuestionElement(e){he.isAvailable()&&e&&(this.isDesignMode||this.initSignaturePad(e),this.element=e),super.afterRenderQuestionElement(e)}beforeDestroyQuestionElement(e){e&&this.destroySignaturePad(e)}themeChanged(e){this.signaturePad&&this.updateColors(this.signaturePad)}resizeCanvas(){this.canvas.width=this.containerWidth,this.canvas.height=this.containerHeight}scaleCanvas(e=!0,t=!1){const s=this.canvas,i=s.offsetWidth/this.containerWidth;(this.scale!=i||t)&&(this.scale=i,s.style.width=this.renderedCanvasWidth,this.resizeCanvas(),this.signaturePad.minWidth=this.penMinWidth*i,this.signaturePad.maxWidth=this.penMaxWidth*i,s.getContext("2d").scale(1/i,1/i),e&&this.loadPreview(this.value))}fromUrl(e){if(this.isFileLoading=!0,yR(e))this.fromDataUrl(e),this.isFileLoading=!1;else{const t=new Image;t.crossOrigin="anonymous",t.src=e,t.onload=()=>{if(this.canvas){const i=oe.createElement("canvas");i.width=this.containerWidth,i.height=this.containerHeight,i.getContext("2d").drawImage(t,0,0);var s=i.toDataURL(this.getFormat());this.fromDataUrl(s)}this.isFileLoading=!1},t.onerror=()=>{this.isFileLoading=!1}}}fromDataUrl(e){if(this._loadedData=e,this.signaturePad){let t=1,s=this.scale;this.dataFormat==="svg"&&(t=he.getDevicePixelRatio()||1,s=1);const i={width:this.canvas.width*s/t,height:this.canvas.height*s/t};this.signaturePad.fromDataURL(e,i)}}get loadedData(){return this._loadedData}loadPreview(e){if(!e){this.signaturePad&&this.canvas&&(this.canvas.getContext("2d").clearRect(0,0,this.canvas.width*this.scale,this.canvas.height*this.scale),this.signaturePad.clear()),this.hasDrawnStroke=!1,this.valueWasChangedFromLastUpload=!1;return}if(this.storeDataAsText)this.fromDataUrl(e);else if(this.loadedData)this.fromDataUrl(this.loadedData);else{var t=e?[e]:[];this._previewLoader&&this._previewLoader.dispose(),this.isFileLoading=!0,this._previewLoader=new tb(this,(s,i)=>{s==="success"&&i&&i.length>0&&i[0].content?(this.fromDataUrl(i[0].content),this.isFileLoading=!1):s==="skipped"&&this.fromUrl(e),this._previewLoader.dispose(),this._previewLoader=void 0}),this._previewLoader.load(t)}}onChangeQuestionValue(e){super.onChangeQuestionValue(e),this.isLoadingFromJson||(this._loadedData=void 0,this.loadPreview(e))}onSurveyLoad(){super.onSurveyLoad(),this.loadPreview(this.value)}initSignaturePad(e){var t=e.getElementsByTagName("canvas")[0];this.canvas=t,this.resizeCanvas();var s=new vl(t,{backgroundColor:"#ffffff"});this.signaturePad=s,this.isInputReadOnly&&s.off(),this.readOnlyChangedCallback=()=>{this.isInputReadOnly?s.off():s.on()},this.updateColors(s),s.addEventListener("beginStroke",()=>{this.scaleCanvas(),this.hasDrawnStroke=!0,t.focus()},{once:!1}),s.addEventListener("endStroke",()=>{this.storeDataAsText?this.updateValue():this.valueWasChangedFromLastUpload=!0},{once:!1}),this.updateValueHandler(),this.readOnlyChangedCallback();var i=(r,a)=>{(a.name==="signatureWidth"||a.name==="signatureHeight")&&(this.valueIsUpdatingInternally||this.updateValueHandler())};this.onPropertyChanged.add(i),this.signaturePad.propertyChangedHandler=i}destroySignaturePad(e){this.signaturePad&&(this.onPropertyChanged.remove(this.signaturePad.propertyChangedHandler),this.signaturePad.off()),this.readOnlyChangedCallback=null,this.signaturePad=null}get dataFormat(){return this.getPropertyValue("dataFormat")}set dataFormat(e){this.setPropertyValue("dataFormat",jd(e))}get signatureWidth(){return this.getPropertyValue("signatureWidth")}set signatureWidth(e){this.setPropertyValue("signatureWidth",e)}get signatureHeight(){return this.getPropertyValue("signatureHeight")}set signatureHeight(e){this.setPropertyValue("signatureHeight",e)}get containerHeight(){return this.signatureHeight||W_}get containerWidth(){return this.signatureWidth||U_}get renderedCanvasWidth(){return this.signatureAutoScaleEnabled?"100%":this.containerWidth+"px"}get height(){return this.getPropertyValue("height")}set height(e){this.setPropertyValue("height",e)}get allowClear(){return this.getPropertyValue("allowClear")}set allowClear(e){this.setPropertyValue("allowClear",e)}get canShowClearButton(){const e=!this.nothingIsDrawn(),t=this.isUploading;return!this.isInputReadOnly&&this.allowClear&&e&&!t}get penColor(){return this.getPropertyValue("penColor")}set penColor(e){this.setPropertyValue("penColor",e),this.signaturePad&&this.updateColors(this.signaturePad)}get backgroundColor(){return this.getPropertyValue("backgroundColor")}set backgroundColor(e){this.setPropertyValue("backgroundColor",e),this.signaturePad&&this.updateColors(this.signaturePad)}get backgroundImage(){return this.getPropertyValue("backgroundImage")}set backgroundImage(e){this.setPropertyValue("backgroundImage",e),this.signaturePad&&this.updateColors(this.signaturePad)}get clearButtonCaption(){return this.getLocalizationString("clearCaption")}get locRenderedPlaceholder(){return this.isReadOnly?this.locPlaceholderReadOnly:this.locPlaceholder}nothingIsDrawn(){const e=this.hasDrawnStroke,t=this.isEmpty(),s=this.isUploading,i=this.valueWasChangedFromLastUpload;return!e&&t&&!s&&!i}needShowPlaceholder(){return this.showPlaceholder&&this.nothingIsDrawn()}onBlurCore(e){if(super.onBlurCore(e),!this.storeDataAsText&&!this.element.contains(e.relatedTarget)){if(!this.valueWasChangedFromLastUpload)return;this.uploadFiles([B_(this.signaturePad.toDataURL(this.getFormat()),this.name+"."+jd(this.dataFormat),this.getFormat())],"signature"),this.valueWasChangedFromLastUpload=!1}}uploadResultItemToValue(e){return e.content}setValueFromResult(e){this.valueIsUpdatingInternally=!0,this.value=e?.length?e.map(t=>t.content)[0]:void 0,this.valueIsUpdatingInternally=!1}clearValue(e,t){this.valueWasChangedFromLastUpload=!1,super.clearValue(e,t),this._loadedData=void 0,this.loadPreview(this.value)}endLoadingFromJson(){super.endLoadingFromJson(),this.signatureWidth===300&&this.width&&typeof this.width=="number"&&this.width&&(xs.warn("Use signatureWidth property to set width for the signature pad"),this.signatureWidth=this.width,this.width=void 0),this.signatureHeight===200&&this.height&&(xs.warn("Use signatureHeight property to set width for the signature pad"),this.signatureHeight=this.height,this.height=void 0)}}I([R({defaultValue:!1})],ks.prototype,"hasDrawnStroke",void 0),I([R({defaultValue:!1})],ks.prototype,"isReadyForUpload",void 0),I([R({defaultValue:!1})],ks.prototype,"valueWasChangedFromLastUpload",void 0),I([R()],ks.prototype,"signatureAutoScaleEnabled",void 0),I([R()],ks.prototype,"penMinWidth",void 0),I([R()],ks.prototype,"penMaxWidth",void 0),I([R({})],ks.prototype,"showPlaceholder",void 0),I([R({localizable:{defaultStr:"signaturePlaceHolder"}})],ks.prototype,"placeholder",void 0),I([R({localizable:{defaultStr:"signaturePlaceHolderReadOnly"}})],ks.prototype,"placeholderReadOnly",void 0);function jd(n){return n||(n="png"),n=n.replace("image/","").replace("+xml",""),n!=="jpeg"&&n!=="svg"&&(n="png"),n}B.addClass("signaturepad",[{name:"signatureWidth:number",category:"general",default:300},{name:"signatureHeight:number",category:"general",default:200},{name:"signatureAutoScaleEnabled:boolean",category:"general",default:!1},{name:"penMinWidth:number",category:"general",default:.5},{name:"penMaxWidth:number",category:"general",default:2.5},{name:"height:number",category:"general",visible:!1},{name:"allowClear:boolean",category:"general",default:!0},{name:"showPlaceholder:boolean",category:"general",default:!0},{name:"placeholder:text",serializationProperty:"locPlaceholder",category:"general",dependsOn:"showPlaceholder",visibleIf:n=>n.showPlaceholder},{name:"placeholderReadOnly:text",serializationProperty:"locPlaceholderReadOnly",category:"general",dependsOn:"showPlaceholder",visibleIf:n=>n.showPlaceholder},{name:"backgroundImage:file",category:"general"},{name:"penColor:color",category:"general"},{name:"backgroundColor:color",category:"general"},{name:"dataFormat",category:"general",default:"png",choices:[{value:"png",text:"PNG"},{value:"jpeg",text:"JPEG"},{value:"svg",text:"SVG"}],onSettingValue:(n,e)=>jd(e)},{name:"defaultValue",visible:!1},{name:"correctAnswer",visible:!1},{name:"storeDataAsText:boolean",default:!0},{name:"waitForUpload:boolean",default:!1}],function(){return new ks("")},"question"),Qe.Instance.registerQuestion("signaturepad",n=>new ks(n));class $_ extends S1{constructor(e){super(),this.item=e}getIndex(){return this.panelIndex}getQuestionData(){return this.item.data}getValue(e,t,s,i){if(e.length===0)return;if(e.length===1){const u=this.getPanelValue(e[0].name);if(u!==void 0)return{isFound:!0,value:u,context:this}}const r=D.expressionVariables,a=r.panel;if(e.length>1&&e[0].name.toLocaleLowerCase()===r.parentPanel.toLocaleLowerCase()){const u=this.item.data;if(u&&u.parentQuestion&&u.parent&&u.parent.data)return e[0].name=a,u.parent.data.getValueGetterContext().getValue(e,!0,s,i)}const o=this.item.panel,l=e[0].name===a;if(l||!t){l&&e.shift();const u=new _d(o.questions).getValue(e,!1,s,i);if(u&&u.isFound)return u;const d=this.item.getAllValues();if(t){const h=this.getValueFromBindedQuestions(e,d);if(h)return h}return new ws(d).getValue(e,!1,s,i)}}getTextValue(e,t,s){return e=e.toLocaleLowerCase(),[this.indexVar,this.visIndexVar].indexOf(e)>-1&&t>-1&&t++,super.getTextValue(e,t,s)}get indexVar(){return D.expressionVariables.panelIndex.toLocaleLowerCase()}get visIndexVar(){return D.expressionVariables.visiblePanelIndex.toLocaleLowerCase()}getPanelValue(e){if(e=e.toLocaleLowerCase(),e===this.indexVar)return this.panelIndex;if(e==this.visIndexVar)return this.visiblePanelIndex}get panelIndex(){return this.getPanels(!1).indexOf(this.item.panel)}get visiblePanelIndex(){return this.getPanels(!0).indexOf(this.item.panel)}getPanels(e){const t=this.item.data;return t?e?t.visiblePanels:t.panels:[]}}class G_ extends il{constructor(e){super(e),this.question=e}getValue(e,t,s,i){if(!i&&this.question.isEmpty())return{isFound:e.length===0,value:void 0};if(s>-1){const r=this.question;return s>=0&&s<r.panels.length?r.panels[s].data.getValueGetterContext().getValue(e,!1,s,i):{isFound:!1,value:void 0,context:this}}return super.getValue(e,t,s,i)}}class J_ extends xe{constructor(e){super(e)}}class ub{constructor(e,t){this.data=e,this.data=e,this.panelValue=t,this.textPreProcessor=new nl(this),this.setSurveyImpl()}get panel(){return this.panelValue}setSurveyImpl(){this.panel.setSurveyImpl(this)}getValueGetterContext(){return new $_(this)}getValue(e){var t=this.getAllValues();return t[e]}setValue(e,t){const s=this.data.getPanelItemData(this),i=s?s[e]:void 0;if(L.isTwoValueEquals(t,i,!1,!0,!1))return;this.data.setPanelItemData(this,e,L.getUnbindValue(t));const r=this.panel.questions;for(var a=0;a<r.length;a++){const o=r[a];o.getValueName()!==e&&o.checkBindings(e,t);const l=D.commentSuffix;if(e.endsWith(l)){e=e.substring(0,e.length-l.length);const d=this.panel.getQuestionByName(e);d&&(t=d.value)}const u=D.expressionVariables.panel+"."+e;o.runTriggers(u,t)}}getVariable(e){}setVariable(e,t){}getComment(e){var t=this.getValue(e+D.commentSuffix);return t||""}setComment(e,t,s){this.setValue(e+D.commentSuffix,t)}findQuestionByName(e){if(!e)return;const t=D.expressionVariables.panel+".";if(e.indexOf(t)===0)return this.panel.getQuestionByName(e.substring(t.length));const s=this.getSurvey();return s?s.getQuestionByName(e):null}getEditingSurveyElement(){}getAllValues(){return this.data.getPanelItemData(this)}getFilteredProperties(){return this.data&&this.data.getRootData()?this.data.getRootData().getFilteredProperties():{survey:this.getSurvey()}}getSurveyData(){return this}getSurvey(){return this.data?this.data.getSurvey():null}getTextProcessor(){return this.textPreProcessor}}class K_{constructor(e){this.data=e}getSurveyData(){return null}getSurvey(){return this.data.getSurvey()}getTextProcessor(){return null}}class fi extends kt{constructor(e){super(e),this._renderedPanels=[],this.isPanelsAnimationRunning=!1,this.isAddingNewPanels=!1,this.isSetPanelItemData={},this.createNewArray("panels",t=>{this.onPanelAdded(t)},t=>{this.onPanelRemoved(t)}),this.createNewArray("visiblePanels"),this.templateValue=this.createAndSetupNewPanelObject(),this.template.renderWidth="100%",this.template.selectedElementInDesign=this,this.template.addElementCallback=t=>{this.addOnPropertyChangedCallback(t),this.rebuildPanels()},this.template.removeElementCallback=()=>{this.rebuildPanels()},this.createLocString({name:"confirmDeleteText",translationKey:"confirmDelete"}),this.createLocString({name:"keyDuplicationError",hasTranslation:!0}),this.createLocString({name:"addPanelText",translationKey:"addPanel"}),this.createLocString({name:"removePanelText",translationKey:"removePanel"}),this.createLocString({name:"prevPanelText",translationKey:"pagePrevText"}),this.createLocString({name:"nextPanelText",translationKey:"pageNextText"}),this.createLocString({name:"noEntriesText",translationKey:"noEntriesText"}),this.createLocString({name:"editPanelText",translationKey:"editText"}),this.createLocString({name:"templateTabTitle",translationKey:"panelDynamicTabTextFormat",supportsMarkdown:!0}),this.createLocString({name:"tabTitlePlaceholder",translationKey:"tabTitlePlaceholder",supportsMarkdown:!0}),this.registerPropertyChangedHandlers(["panelsState"],()=>{this.setPanelsState()}),this.registerPropertyChangedHandlers(["newPanelPosition","displayMode","showProgressBar"],()=>{this.updateFooterActions()}),this.registerPropertyChangedHandlers(["allowAddPanel"],()=>{this.updateNoEntriesTextDefaultLoc()}),this.registerPropertyChangedHandlers(["minPanelCount"],()=>{this.onMinPanelCountChanged()}),this.registerPropertyChangedHandlers(["maxPanelCount"],()=>{this.onMaxPanelCountChanged()}),this.registerPropertyChangedHandlers(["templateQuestionTitleLocation","templateQuestionTitleWidth"],()=>{const t=this.visiblePanelsCore;t&&t.forEach(s=>{s.updateElementCss(!0)})})}get isCompositeQuestion(){return!0}get isContainer(){return!0}getFirstQuestionToFocus(e){for(var t=0;t<this.visiblePanelsCore.length;t++){const s=this.visiblePanelsCore[t].getFirstQuestionToFocus(e);if(s)return s}return this.showAddPanelButton&&(!e||this.currentErrorCount>0)?this:null}getFirstInputElementId(){return this.showAddPanelButton?this.addButtonId:super.getFirstInputElementId()}getFirstErrorInputElementId(){const e=this.getFirstQuestionToFocus(!0);return e?e.inputId:super.getFirstErrorInputElementId()}setSurveyImpl(e,t){super.setSurveyImpl(e,t),this.setTemplatePanelSurveyImpl(),this.setPanelsSurveyImpl()}assignOnPropertyChangedToTemplate(){for(var e=this.template.elements,t=0;t<e.length;t++)this.addOnPropertyChangedCallback(e[t])}addOnPropertyChangedCallback(e){e.isQuestion&&e.setParentQuestion(this),e.onPropertyChanged.add((t,s)=>{this.onTemplateElementPropertyChanged(t,s)}),e.isPanel&&(e.addElementCallback=t=>{this.addOnPropertyChangedCallback(t)})}onTemplateElementPropertyChanged(e,t){if(!(this.isLoadingFromJson||this.useTemplatePanel||this.panelsCore.length==0)){var s=B.findProperty(e.getType(),t.name);if(s)for(var i=this.panelsCore,r=0;r<i.length;r++){var a=i[r].getQuestionByName(e.name);a&&a[t.name]!==t.newValue&&(a[t.name]=t.newValue)}}}get useTemplatePanel(){return this.isDesignMode&&!this.isContentElement}getType(){return"paneldynamic"}clearOnDeletingContainer(){this.panelsCore.forEach(e=>{e.clearOnDeletingContainer()})}get isAllowTitleLeft(){return!1}removeElement(e){return this.template.removeElement(e)}get template(){return this.templateValue}getPanelInDesignMode(){return this.template}getPanels(){return[this.template]}get templateElements(){return this.template.elements}get templateTitle(){return this.template.title}set templateTitle(e){this.template.title=e}get locTemplateTitle(){return this.template.locTitle}get templateTabTitle(){return this.locTemplateTabTitle.text}set templateTabTitle(e){this.locTemplateTabTitle.text=e}get locTemplateTabTitle(){return this.getLocalizableString("templateTabTitle")}get tabTitlePlaceholder(){return this.locTabTitlePlaceholder.text}set tabTitlePlaceholder(e){this.locTabTitlePlaceholder.text=e}get locTabTitlePlaceholder(){return this.getLocalizableString("tabTitlePlaceholder")}get templateDescription(){return this.template.description}set templateDescription(e){this.template.description=e}get locTemplateDescription(){return this.template.locDescription}get templateVisibleIf(){return this.getPropertyValue("templateVisibleIf")}set templateVisibleIf(e){this.setPropertyValue("templateVisibleIf",e),this.template.visibleIf=e}get questionStartIndex(){return this.template.questionStartIndex}set questionStartIndex(e){this.template.questionStartIndex=e}get items(){for(var e=[],t=0;t<this.panelsCore.length;t++)e.push(this.panelsCore[t].data);return e}get panels(){return this.buildPanelsFirstTime(this.canBuildPanels),this.panelsCore}get visiblePanels(){return this.buildPanelsFirstTime(this.canBuildPanels),this.visiblePanelsCore}get panelsCore(){return this.getPropertyValue("panels")}get visiblePanelsCore(){return this.getPropertyValue("visiblePanels")}onPanelAdded(e){if(this.onPanelRemovedCore(e),!e.visible)return;let t=0;const s=this.panelsCore;for(var i=0;i<s.length&&s[i]!==e;i++)s[i].visible&&t++;this.visiblePanelsCore.splice(t,0,e),this.addTabFromToolbar(e,t),this.currentPanel||(this.currentPanel=e),this.updateRenderedPanels()}onPanelRemoved(e){let t=this.onPanelRemovedCore(e);if(this.currentPanel===e){const s=this.visiblePanelsCore;t>=s.length&&(t=s.length-1),this.currentPanel=t>=0?s[t]:null}this.updateRenderedPanels()}onPanelRemovedCore(e){const t=this.visiblePanelsCore;let s=t.indexOf(e);return s>-1&&(t.splice(s,1),this.removeTabFromToolbar(e)),s}get currentIndex(){return this.isRenderModeList?-1:this.useTemplatePanel?0:this.visiblePanelsCore.indexOf(this.currentPanel)}set currentIndex(e){e<0||this.visiblePanelCount<1||(e>=this.visiblePanelCount&&(e=this.visiblePanelCount-1),this.currentPanel=this.visiblePanelsCore[e])}get currentPanel(){if(this.isDesignMode)return this.template;if(this.isRenderModeList||this.useTemplatePanel)return null;let e=this.getPropertyValue("currentPanel",null);return!e&&this.visiblePanelCount>0&&(e=this.visiblePanelsCore[0],this.currentPanel=e),e}set currentPanel(e){if(this.isRenderModeList||this.useTemplatePanel)return;const t=this.getPropertyValue("currentPanel"),s=e?this.visiblePanelsCore.indexOf(e):-1;if(!(e&&s<0||e===t)&&(t&&t.onHidingContent(),e&&e.onFirstRendering(),this.setPropertyValue("currentPanel",e),this.updateRenderedPanels(),this.updateFooterActions(),this.updateTabToolbarItemsPressedState(),this.fireCallback(this.currentIndexChangedCallback),s>-1&&this.survey)){const i={panel:e,visiblePanelIndex:s};this.survey.dynamicPanelCurrentIndexChanged(this,i)}}updateRenderedPanels(){this.isRenderModeList?this.renderedPanels=[].concat(this.visiblePanels):this.currentPanel?this.renderedPanels=[this.currentPanel]:this.renderedPanels=[],this.renderedPanels.forEach(e=>this.panelOnFirstRendering(e))}panelOnFirstRendering(e){e&&(e.onFirstRendering(),e.locStrsChanged())}set renderedPanels(e){this.renderedPanels.length==0||e.length==0?(this.blockAnimations(),this.panelsAnimation.sync(e),this.releaseAnimations()):(this.isPanelsAnimationRunning=!0,this.panelsAnimation.sync(e))}get renderedPanels(){return this._renderedPanels}getPanelsAnimationOptions(){const e=()=>{if(this.isRenderModeList)return"";let t=new j,s=!1;const i=this.renderedPanels.filter(a=>a!==this.currentPanel)[0];let r=this.visiblePanels.indexOf(i);return r<0&&(s=!0,r=this.removedPanelIndex),t.append("sv-pd-animation-adding",!!this.focusNewPanelCallback).append("sv-pd-animation-removing",s).append("sv-pd-animation-left",r<=this.currentIndex).append("sv-pd-animation-right",r>this.currentIndex).toString()};return{getRerenderEvent:()=>this.onElementRerendered,getAnimatedElement:t=>{var s,i;if(t&&this.cssContent){const r=ls(this.cssContent);return(i=(s=this.getWrapperElement())===null||s===void 0?void 0:s.querySelector(`:scope ${r} #${t.id}`))===null||i===void 0?void 0:i.parentElement}},getEnterOptions:()=>{const t=new j().append(this.cssClasses.panelWrapperEnter).append(e()).toString();return{onBeforeRunAnimation:s=>{if(this.focusNewPanelCallback){const i=this.isRenderModeList?s:s.parentElement;Ke.ScrollElementToViewCore(i,!1,!1,{behavior:"smooth"})}!this.isRenderModeList&&s.parentElement?Vn(s.parentElement,{heightTo:s.offsetHeight+"px"}):ci(s)},onAfterRunAnimation:s=>{Vs(s),s.parentElement&&Vs(s.parentElement)},cssClass:t}},getLeaveOptions:()=>{const t=new j().append(this.cssClasses.panelWrapperLeave).append(e()).toString();return{onBeforeRunAnimation:s=>{!this.isRenderModeList&&s.parentElement?Vn(s.parentElement,{heightFrom:s.offsetHeight+"px"}):ci(s)},onAfterRunAnimation:s=>{Vs(s),s.parentElement&&Vs(s.parentElement)},cssClass:t}},isAnimationEnabled:()=>this.animationAllowed&&!!this.getWrapperElement()}}disablePanelsAnimations(){this.panelsCore.forEach(e=>{e.blockAnimations()})}enablePanelsAnimations(){this.panelsCore.forEach(e=>{e.releaseAnimations()})}updatePanelsAnimation(){this._panelsAnimations=new(this.isRenderModeList?Xi:m1)(this.getPanelsAnimationOptions(),(e,t)=>{this._renderedPanels=e,t||(this.isPanelsAnimationRunning=!1,this.focusNewPanel())},()=>this._renderedPanels)}get panelsAnimation(){return this._panelsAnimations||this.updatePanelsAnimation(),this._panelsAnimations}onHidingContent(){super.onHidingContent(),this.currentPanel?this.currentPanel.onHidingContent():this.visiblePanelsCore.forEach(e=>e.onHidingContent())}get confirmDelete(){return this.getPropertyValue("confirmDelete")}set confirmDelete(e){this.setPropertyValue("confirmDelete",e)}get keyName(){return this.getPropertyValue("keyName","")}set keyName(e){this.setPropertyValue("keyName",e)}get confirmDeleteText(){return this.getLocalizableStringText("confirmDeleteText")}set confirmDeleteText(e){this.setLocalizableStringText("confirmDeleteText",e)}get locConfirmDeleteText(){return this.getLocalizableString("confirmDeleteText")}get keyDuplicationError(){return this.getLocalizableStringText("keyDuplicationError")}set keyDuplicationError(e){this.setLocalizableStringText("keyDuplicationError",e)}get locKeyDuplicationError(){return this.getLocalizableString("keyDuplicationError")}get prevPanelText(){return this.getLocalizableStringText("prevPanelText")}set prevPanelText(e){this.setLocalizableStringText("prevPanelText",e)}get locPrevPanelText(){return this.getLocalizableString("prevPanelText")}get panelPrevText(){return this.prevPanelText}set panelPrevText(e){this.prevPanelText=e}get locPanelPrevText(){return this.locPrevPanelText}get nextPanelText(){return this.getLocalizableStringText("nextPanelText")}set nextPanelText(e){this.setLocalizableStringText("nextPanelText",e)}get locNextPanelText(){return this.getLocalizableString("nextPanelText")}get panelNextText(){return this.nextPanelText}set panelNextText(e){this.nextPanelText=e}get locPanelNextText(){return this.locNextPanelText}get addPanelText(){return this.getLocalizableStringText("addPanelText")}set addPanelText(e){this.setLocalizableStringText("addPanelText",e)}get locAddPanelText(){return this.getLocalizableString("addPanelText")}get panelAddText(){return this.addPanelText}set panelAddText(e){this.addPanelText=e}get locPanelAddText(){return this.locAddPanelText}get removePanelText(){return this.getLocalizableStringText("removePanelText")}set removePanelText(e){this.setLocalizableStringText("removePanelText",e)}get locRemovePanelText(){return this.getLocalizableString("removePanelText")}get panelRemoveText(){return this.removePanelText}set panelRemoveText(e){this.removePanelText=e}get locPanelRemoveText(){return this.locRemovePanelText}get isProgressTopShowing(){return this.displayMode=="carousel"&&(this.progressBarLocation==="top"||this.progressBarLocation==="topBottom")}get isProgressBottomShowing(){return this.displayMode=="carousel"&&(this.progressBarLocation==="bottom"||this.progressBarLocation==="topBottom")}get isPrevButtonVisible(){return this.currentIndex>0}get isPrevButtonShowing(){return this.isPrevButtonVisible}get isNextButtonVisible(){return this.currentIndex>=0&&this.currentIndex<this.visiblePanelCount-1}get isNextButtonShowing(){return this.isNextButtonVisible}get isRangeShowing(){return this.showProgressBar&&this.currentIndex>=0&&this.visiblePanelCount>1}getElementsInDesign(e=!1){return e?[this.template]:this.templateElements}prepareValueForPanelCreating(){this.addingNewPanelsValue=this.value,this.isAddingNewPanels=!0,this.isNewPanelsValueChanged=!1}setValueAfterPanelsCreating(){this.isAddingNewPanels=!1,this.isNewPanelsValueChanged&&(this.isValueChangingInternally=!0,this.value=this.addingNewPanelsValue,this.isValueChangingInternally=!1)}getValueCore(){return this.isAddingNewPanels?this.addingNewPanelsValue:super.getValueCore()}setValueCore(e){this.isAddingNewPanels?(this.isNewPanelsValueChanged=!0,this.addingNewPanelsValue=e):super.setValueCore(e)}setIsMobile(e){super.setIsMobile(e),(this.panelsCore||[]).forEach(t=>t.getQuestions(!0).forEach(s=>{s.setIsMobile(e)}))}themeChanged(e){super.themeChanged(e),(this.panelsCore||[]).forEach(t=>t.getQuestions(!0).forEach(s=>{s.themeChanged(e)}))}get panelCount(){return!this.canBuildPanels||this.wasNotRenderedInSurvey?this.getPropertyValue("panelCount"):this.panelsCore.length}set panelCount(e){if(e<0)return;if(!this.isLoadingFromJson&&this.isDesignMode){const s=this.minPanelCount;e<s&&(e=s);const i=this.maxPanelCount;i>0&&e>i&&(e=i)}if(!this.canBuildPanels||this.wasNotRenderedInSurvey){this.setPropertyValue("panelCount",e),this.updateFooterActions();return}if(e==this.panelsCore.length||this.useTemplatePanel)return;this.updateBindings("panelCount",e),this.prepareValueForPanelCreating();const t=e-this.panelCount===1;for(let s=this.panelCount;s<e;s++){const i=this.createNewPanel();this.panelsCore.push(i),this.displayMode=="list"&&this.panelsState!="default"&&(this.panelsState==="expanded"?i.expand():i.title&&i.collapse())}t&&this.singleInputOnAddItem(this.settingPanelCountBasedOnValue),e<this.panelCount&&this.panelsCore.splice(e,this.panelCount-e),this.disablePanelsAnimations(),this.setValueAfterPanelsCreating(),this.setValueBasedOnPanelCount(),this.reRunCondition(),this.updateFooterActions(),this.fireCallback(this.panelCountChangedCallback),this.enablePanelsAnimations()}get visiblePanelCount(){return this.visiblePanels.length}get panelsState(){return this.getPropertyValue("panelsState")}set panelsState(e){this.setPropertyValue("panelsState",e)}getStructuredValue(e=-1){if(e<0||this.isEmpty()||!Array.isArray(this.value))return this.value;const t=new Array,s=Math.min(this.visiblePanelCount,this.value.length);for(let i=0;i<s;i++){const r=this.visiblePanels[i],a={};r.collectValues(a,e),t.push(a)}return t}setTemplatePanelSurveyImpl(){this.template.setSurveyImpl(this.useTemplatePanel?this.surveyImpl:new K_(this))}setPanelsSurveyImpl(){for(var e=0;e<this.panelsCore.length;e++){var t=this.panelsCore[e];t!=this.template&&t.setSurveyImpl(t.data)}}setPanelsState(){if(!(this.useTemplatePanel||this.displayMode!="list"||!this.templateTitle))for(var e=0;e<this.panelsCore.length;e++){var t=this.panelsState;t==="firstExpanded"&&(t=e===0?"expanded":"collapsed"),this.panelsCore[e].state=t}}setValueBasedOnPanelCount(){var e=this.value;if((!e||!Array.isArray(e))&&(e=[]),e.length!=this.panelCount){for(var t=e.length;t<this.panelCount;t++){const s=this.panels[t].getValue(),i=L.isValueEmpty(s)?{}:s;e.push(i)}e.length>this.panelCount&&e.splice(this.panelCount,e.length-this.panelCount),this.isValueChangingInternally=!0,this.value=e,this.isValueChangingInternally=!1}}get minPanelCount(){return this.getPropertyValue("minPanelCount")}set minPanelCount(e){e<0&&(e=0),this.setPropertyValue("minPanelCount",e)}onMinPanelCountChanged(){const e=this.minPanelCount;e>this.maxPanelCount&&(this.maxPanelCount=e),this.panelCount<e&&(this.panelCount=e)}get maxPanelCount(){return this.getPropertyValue("maxPanelCount")}set maxPanelCount(e){e<=0||(e>D.panel.maxPanelCount&&(e=D.panel.maxPanelCount),this.setPropertyValue("maxPanelCount",e),this.updateFooterActions())}onMaxPanelCountChanged(){const e=this.maxPanelCount;e<this.minPanelCount&&(this.minPanelCount=e),this.panelCount>e&&(this.panelCount=e),this.updateFooterActions()}get allowAddPanel(){return this.getPropertyValue("allowAddPanel")}set allowAddPanel(e){this.setPropertyValue("allowAddPanel",e)}get addButtonId(){return this.id+"addPanel"}get newPanelPosition(){return this.getPropertyValue("newPanelPosition")}set newPanelPosition(e){this.setPropertyValue("newPanelPosition",e)}get allowRemovePanel(){return this.getPropertyValue("allowRemovePanel")}set allowRemovePanel(e){this.setPropertyValue("allowRemovePanel",e)}get templateQuestionTitleLocation(){return this.getPropertyValue("templateQuestionTitleLocation")}set templateQuestionTitleLocation(e){this.setPropertyValue("templateQuestionTitleLocation",e)}get templateTitleLocation(){return this.templateQuestionTitleLocation}set templateTitleLocation(e){this.templateQuestionTitleLocation=e}get templateQuestionTitleWidth(){return this.template.questionTitleWidth}set templateQuestionTitleWidth(e){this.template.questionTitleWidth=e}get templateErrorLocation(){return this.getPropertyValue("templateErrorLocation")}set templateErrorLocation(e){this.setPropertyValue("templateErrorLocation",e.toLowerCase())}resetSingleInput(){super.resetSingleInput(),this.locTemplateTitle.onGetTextCallback=null}getSingleInputQuestionsCore(e,t){this.onFirstRendering();const s=new Array,i=this.visiblePanels;if(t)for(let r=0;r<i.length;r++){const a=i[r];(!a.hasValueAnyQuestion(!0)||!a.validate(!1,!1))&&this.fillSingleInputQuestionsByPanel(s,a)}return this.getSingleInputQuestionsForDynamic(e,s)}fillSingleInputQuestionsInContainer(e,t){const s=this.getPanelByQuestion(t);this.fillSingleInputQuestionsByPanel(e,s)}fillSingleInputQuestionsByPanel(e,t){t&&t.visibleQuestions.forEach(s=>s.addNestedQuestion(e,!0,!1,!1))}getSingleQuestionLocTitleCore(){const e=this.locTemplateTitle;return e.onGetTextCallback=t=>{const s=this.singleInputQuestion;return s?this.processSingleInputTitle(t,this.getPanelByQuestion(s)):t},e}processSingleInputTitle(e,t){return e||(e=this.getSingleInputTitleTemplate()),t?t.getProcessedText(e):e}getSingleInputTitleTemplate(){return this.getLocalizationString("panelDynamicTabTextFormat")}getPanelByQuestion(e){let t=e.parent;for(;t&&t.parent;)t=t.parent;return t}getSingleInputAddTextCore(){if(this.canAddPanel)return this.addPanelText}singleInputAddItemCore(){this.addPanelUI()}getSingleQuestionOnChange(e){const t=this.visiblePanelsCore;if(t.length>0){(e<0||e>=t.length)&&(e=t.length-1);const i=t[e].visibleQuestions;if(i.length>0)return i[0]}return null}createSingleInputSummary(){const e=new q1(this,this.locNoEntriesText),t=new Array;return this.visiblePanels.forEach(s=>{const i=new wt(this,!0,void 0,this.locTemplateTitle.localizationName);i.setJson(this.locTemplateTitle.getJson()),i.onGetTextCallback=o=>this.processSingleInputTitle(this.templateTitle,s);const r=new xe({locTitle:this.getLocalizableString("editPanelText"),action:()=>{this.singInputEditPanel(s)}}),a=this.canRemovePanel?new xe({locTitle:this.locPanelRemoveText,action:()=>{this.removePanelUI(s)}}):void 0;t.push(new N1(i,r,a))}),e.items=t,e}singleInputMoveToFirstCore(){var e;let t=(e=this.singleInputQuestion)===null||e===void 0?void 0:e.parent;for(;t&&t.parent;)t=t.parent;this.singInputEditPanel(t)}singInputEditPanel(e){if(!e)return;const t=e.visibleQuestions;t.length>0&&this.setSingleInputQuestion(t[0])}get showQuestionNumbers(){return this.getPropertyValue("showQuestionNumbers")}set showQuestionNumbers(e){e||(e="off"),e=e.toLowerCase(),e==="onsurvey"&&(e="default"),this.setPropertyValue("showQuestionNumbers",e),!this.isLoadingFromJson&&this.survey&&this.survey.questionVisibilityChanged(this,this.visible,!0)}getShowQuestionNumbers(){var e;const t=this.showQuestionNumbers;if(t==="default"){const s=(e=this.survey)===null||e===void 0?void 0:e.showQuestionNumbers;if(s==="recursive")return s}return t}notifySurveyOnChildrenVisibilityChanged(){return this.showQuestionNumbers==="default"}get removePanelButtonLocation(){return this.getPropertyValue("removePanelButtonLocation")}set removePanelButtonLocation(e){this.setPropertyValue("removePanelButtonLocation",e)}get panelRemoveButtonLocation(){return this.removePanelButtonLocation}set panelRemoveButtonLocation(e){this.removePanelButtonLocation=e}get showRangeInProgress(){return this.showProgressBar}set showRangeInProgress(e){this.showProgressBar=e}get renderMode(){let e=this.displayMode;if(e=="carousel"){const t=this.progressBarLocation;if(t=="top")return"progressTop";if(t=="bottom")return"progressBottom";if(t=="topBottom")return"progressTopBottom"}return e}set renderMode(e){(e||"").startsWith("progress")?(e=="progressTop"?this.progressBarLocation="top":e=="progressBottom"?this.progressBarLocation="bottom":e=="progressTopBottom"&&(this.progressBarLocation="topBottom"),this.displayMode="carousel"):this.displayMode=e}updatePanelView(){this.blockAnimations(),this.updateRenderedPanels(),this.releaseAnimations(),this.updatePanelsAnimation()}get tabAlign(){return this.getPropertyValue("tabAlign")}set tabAlign(e){this.setPropertyValue("tabAlign",e),this.isRenderModeTab&&(this.tabbedMenu.containerCss=this.getTabbedMenuCss())}get isRenderModeList(){return this.displayMode==="list"||this.isSingleInputActive}get isRenderModeTab(){return this.displayMode==="tab"&&!this.isSingleInputActive}setVisibleIndex(e){const t=this.isDesignMode?[this.template]:this.visiblePanelsCore;if(this.isVisibleIndexNegative(e))return t.forEach(a=>a.setVisibleIndex(-1)),super.setVisibleIndex(-1);const s=this.getShowQuestionNumbers(),i=s==="default";let r=i?e:0;for(let a=0;a<t.length;a++){let o=this.setPanelVisibleIndex(t[a],r,s!="off");i&&(r+=o)}return super.setVisibleIndex(i?-1:e),i?r-e:1}setPanelVisibleIndex(e,t,s){return s?e.setVisibleIndex(t):(e.setVisibleIndex(-1),0)}get canAddPanel(){return this.isDesignMode||!this.legacyNavigation&&!this.isRenderModeList&&this.currentIndex<this.visiblePanelCount-1&&this.newPanelPosition!=="next"?!1:this.allowAddPanel&&!this.isReadOnly&&this.panelCount<this.maxPanelCount}get canRemovePanel(){return this.isDesignMode?!1:this.allowRemovePanel&&!this.isReadOnly&&this.panelCount>this.minPanelCount}rebuildPanels(){if(!this.isLoadingFromJson){this.prepareValueForPanelCreating();var e=[];if(this.useTemplatePanel)new ub(this,this.template),e.push(this.template);else for(var t=0;t<this.panelCount;t++)e.push(this.createNewPanel());this.panelsCore.splice(0,this.panelsCore.length,...e),this.setValueAfterPanelsCreating(),this.setPanelsState(),this.reRunCondition(),this.updateFooterActions(),this.fireCallback(this.panelCountChangedCallback),this.updateTabToolbar()}}get defaultPanelValue(){return this.getPropertyValue("defaultPanelValue")}set defaultPanelValue(e){this.setPropertyValue("defaultPanelValue",e)}get copyDefaultValueFromLastEntry(){return this.getPropertyValue("copyDefaultValueFromLastEntry")}set copyDefaultValueFromLastEntry(e){this.setPropertyValue("copyDefaultValueFromLastEntry",e)}get defaultValueFromLastPanel(){return this.copyDefaultValueFromLastEntry}set defaultValueFromLastPanel(e){this.copyDefaultValueFromLastEntry=e}isDefaultValueEmpty(){return super.isDefaultValueEmpty()&&this.isValueEmpty(this.defaultPanelValue)}setDefaultValue(){if(this.isValueEmpty(this.defaultPanelValue)||!this.isValueEmpty(this.defaultValue)){super.setDefaultValue();return}if(!(!this.isEmpty()||this.panelCount==0)){for(var e=[],t=0;t<this.panelCount;t++)e.push(this.defaultPanelValue);this.value=e}}get isValueArray(){return!0}isEmpty(){var e=this.value;if(!e||!Array.isArray(e))return!0;for(var t=0;t<e.length;t++)if(!this.isRowEmpty(e[t]))return!1;return!0}getProgressInfo(){return Ke.getProgressInfoByElements(this.visiblePanelsCore,this.isRequired)}isRowEmpty(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}addPanelUI(){return this.addPanel(void 0,!0)}addPanel(e,t){const s=t===!0;if(s&&(!this.canAddPanel||!this.canLeaveCurrentPanel()))return null;const i=this.addPanelCore(e);return this.panelOnFirstRendering(i),s&&(this.displayMode==="list"&&this.panelsState!=="default"&&i.expand(),this.focusNewPanelCallback=()=>{i?.focusFirstQuestion()},this.isPanelsAnimationRunning||this.focusNewPanel()),i}addPanelCore(e){const t=this.currentIndex;return e===void 0&&(e=t<0?this.panelCount:t+1),(e<0||e>this.panelCount)&&(e=this.panelCount),this.updateValueOnAddingPanel(t<0?this.panelCount-1:t,e),this.isRenderModeList||(this.currentIndex=e),this.notifyOnPanelAddedRemoved(!0,e),this.panelsCore[e]}focusNewPanel(){this.focusNewPanelCallback&&(this.focusNewPanelCallback(),this.focusNewPanelCallback=void 0)}updateValueOnAddingPanel(e,t){this.panelCount++;let s=this.value;if(!Array.isArray(s)||s.length!==this.panelCount)return;let i=!1;const r=this.panelCount-1;if(t<r){i=!0;const a=s[r];s.splice(r,1),s.splice(t,0,a)}if(this.isValueEmpty(this.defaultPanelValue)||(i=!0,this.copyValue(s[t],this.defaultPanelValue)),this.copyDefaultValueFromLastEntry&&s.length>1){const a=e>-1&&e<=r?e:r;i=!0,this.copyValue(s[t],s[a])}i&&(this.value=s)}canLeaveCurrentPanel(){return this.displayMode==="list"||!this.currentPanel||this.currentPanel.validate(!0,!0)}copyValue(e,t){for(var s in t)e[s]=t[s]}getPanelRemoveButtonId(e){return e.id+"_remove_button"}isRequireConfirmOnDelete(e){if(!this.confirmDelete)return!1;const t=this.getVisualPanelIndex(e);if(t<0||t>=this.visiblePanelCount)return!1;const s=this.visiblePanelsCore[t].getValue();return!this.isValueEmpty(s)&&(this.isValueEmpty(this.defaultPanelValue)||!this.isTwoValueEquals(s,this.defaultPanelValue))}goToNextPanel(){return this.currentIndex<0||!this.canLeaveCurrentPanel()?!1:(this.currentIndex++,!0)}goToPrevPanel(){this.currentIndex<0||this.currentIndex--}removePanelUI(e){this.removePanel(e,this.isRequireConfirmOnDelete(e))}removePanel(e,t){const s=this.getVisualPanelIndex(e);if(s<0||s>=this.visiblePanelCount)return;if(t!==void 0){if(!this.canRemovePanel)return;const r=()=>{var a;this.removePanelCore(s);const o=this.visiblePanelCount,l=s>=o?o-1:s;let u=o===0?this.addButtonId:l>-1?this.getPanelRemoveButtonId(this.visiblePanels[l]):"";u&&Ke.FocusElement(u,!0,(a=this.survey)===null||a===void 0?void 0:a.rootElement)};t?Go({message:this.confirmDeleteText,funcOnYes:()=>{r()},locale:this.getLocale(),rootElement:this.survey.rootElement,cssClass:this.cssClasses.confirmDialog}):r()}else this.removePanelCore(s)}removePanelCore(e){this.removedPanelIndex=e;const t=this.visiblePanelsCore[e],s=this.panelsCore.indexOf(t);if(!(s<0)&&!(this.survey&&!this.survey.dynamicPanelRemoving(this,s,t))){this.panelsCore.splice(s,1),this.updateBindings("panelCount",this.panelCount),this.singleInputOnRemoveItem(e);var i=this.value;!i||!Array.isArray(i)||s>=i.length?this.updateFooterActions():(this.isValueChangingInternally=!0,i.splice(s,1),this.value=i,this.updateFooterActions(),this.fireCallback(this.panelCountChangedCallback),this.notifyOnPanelAddedRemoved(!1,s,t),this.isValueChangingInternally=!1)}}notifyOnPanelAddedRemoved(e,t,s){s||(s=this.panelsCore[t]);const i=this.getShowQuestionNumbers();if(this.survey){const r=i==="default";e?this.survey.dynamicPanelAdded(this,t,s,r):this.survey.dynamicPanelRemoved(this,t,s,r)}e&&s&&(i==="onpanel"||i==="recursive")&&s.setVisibleIndex(0)}recursiveNoCallback(){return this.getShowQuestionNumbers()==="recursive"?this.no:""}getVisualPanelIndex(e){if(L.isNumber(e))return e;const t=this.visiblePanelsCore;for(var s=0;s<t.length;s++)if(t[s]===e||t[s].data===e)return s;return-1}getPanelVisibleIndexById(e){const t=this.visiblePanelsCore;for(var s=0;s<t.length;s++)if(t[s].id===e)return s;return-1}locStrsChanged(){super.locStrsChanged(),this.locTemplateTitle.strChanged();for(var e=this.panelsCore,t=0;t<e.length;t++)e[t].locStrsChanged();this.tabbedMenu&&this.tabbedMenu.locStrsChanged()}clearIncorrectValues(){for(var e=0;e<this.panelsCore.length;e++)this.clearIncorrectValuesInPanel(e)}clearErrors(){super.clearErrors();for(var e=0;e<this.panelsCore.length;e++)this.panelsCore[e].clearErrors()}getQuestionFromArray(e,t){return t<0||t>=this.panelsCore.length?null:this.panelsCore[t].getQuestionByName(e)}clearIncorrectValuesInPanel(e){var t=this.panelsCore[e];t.clearIncorrectValues();var s=this.value,i=s&&e<s.length?s[e]:null;if(i){var r=!1;for(var a in i)if(!this.getSharedQuestionFromArray(a,e)){var o=t.getQuestionByValueName(a);o||this.iscorrectValueWithPostPrefix(t,a,D.commentSuffix)||this.iscorrectValueWithPostPrefix(t,a,D.matrix.totalsSuffix)||(delete i[a],r=!0)}r&&(s[e]=i,this.value=s)}}iscorrectValueWithPostPrefix(e,t,s){return t.indexOf(s)!==t.length-s.length?!1:!!e.getQuestionByName(t.substring(0,t.indexOf(s)))}getSharedQuestionFromArray(e,t){return this.survey&&this.valueName?this.survey.getQuestionByValueNameFromArray(this.valueName,e,t):null}addConditionObjectsByContext(e,t){const s=t?.isValidator?t.errorOwner:t,i=!!t&&(t===!0||this.template.questions.indexOf(s)>-1),r=new Array,a=this.template.questions;for(var o=0;o<a.length;o++)a[o].addConditionObjectsByContext(r,t);for(var l=0;l<D.panel.maxPanelCountInCondition;l++){const u="["+l+"].",d=this.getValueName()+u,h=this.processedTitle+u;for(var o=0;o<r.length;o++)r[o].context?e.push(r[o]):e.push({name:d+r[o].name,text:h+r[o].text,question:r[o].question})}if(i){const u=t===!0?this.getValueName()+".":"",d=t===!0?this.processedTitle+".":"",h=D.expressionVariables.panel+".";for(var o=0;o<r.length;o++){if(r[o].question==t)continue;const C={name:u+h+r[o].name,text:d+h+r[o].text,question:r[o].question};C.context=this,e.push(C)}}}collectNestedQuestionsCore(e,t,s,i){i&&e.push(this);const r=t?this.visiblePanelsCore:this.panelsCore;Array.isArray(r)&&r.forEach(a=>{a.questions.forEach(o=>o.addNestedQuestion(e,t,s,i))})}getConditionJson(e=null,t=null){if(!t)return super.getConditionJson(e);var s=t,i=t.indexOf(".");i>-1&&(s=t.substring(0,i),t=t.substring(i+1));var r=this.template.getQuestionByName(s);return r?r.getConditionJson(e,t):null}onReadOnlyChanged(){var e=this.isReadOnly;this.template.readOnly=e;for(var t=0;t<this.panelsCore.length;t++)this.panelsCore[t].readOnly=e;this.updateNoEntriesTextDefaultLoc(),this.updateFooterActions(),super.onReadOnlyChanged()}updateNoEntriesTextDefaultLoc(){const e=this.getLocalizableString("noEntriesText");e&&(e.localizationName=this.isReadOnly||!this.allowAddPanel?"noEntriesReadonlyText":"noEntriesText")}onSurveyLoad(){this.template.readOnly=this.isReadOnly,this.template.onSurveyLoad();const e=this.adjustPanelCount();e>-1&&this.setPropertyValue("panelCount",e),super.onSurveyLoad()}adjustPanelCount(){const e=this.getPropertyValue("panelCount");return e<this.minPanelCount?this.minPanelCount:e>this.maxPanelCount?this.maxPanelCount:-1}buildPanelsFirstTime(e=!1){if(!this.hasPanelBuildFirstTime&&!(!e&&this.wasNotRenderedInSurvey)){if(this.blockAnimations(),this.hasPanelBuildFirstTime=!0,this.isBuildingPanelsFirstTime=!0,this.getPropertyValue("panelCount")>0&&(this.panelCount=this.getPropertyValue("panelCount")),this.useTemplatePanel&&this.rebuildPanels(),this.setPanelsSurveyImpl(),this.setPanelsState(),this.assignOnPropertyChangedToTemplate(),this.data&&this.isValueChangedWithoutPanels&&(this.isValueChangedWithoutPanels=!1,this.runTriggersOnBuildPanelsFirstTime()),this.survey)for(var t=0;t<this.panelCount;t++)this.notifyOnPanelAddedRemoved(!0,t);this.updateIsReady(),this.showAddPanelButton||this.updateNoEntriesTextDefaultLoc(),this.updateFooterActions(),this.isBuildingPanelsFirstTime=!1,this.releaseAnimations()}}runTriggersOnBuildPanelsFirstTime(){this.value,this.visiblePanelsCore.forEach(e=>{const t=this.getPanelItemData(e.data);if(!L.isValueEmpty(t)){const s=L.createCopyWithPrefix(t,D.expressionVariables.panel+".");e.questions.forEach(i=>i.runTriggers("",void 0,s))}})}get showAddPanelButton(){return this.allowAddPanel&&!this.isReadOnly}get wasNotRenderedInSurvey(){return!this.hasPanelBuildFirstTime&&!this.wasRendered&&!!this.survey}get canBuildPanels(){return!this.isLoadingFromJson&&!this.useTemplatePanel}onFirstRenderingCore(){super.onFirstRenderingCore(),this.buildPanelsFirstTime(),this.template.onFirstRendering()}localeChanged(){super.localeChanged(),this.panelsCore.forEach(e=>e.localeChanged())}runConditionCore(e){super.runConditionCore(e),this.runPanelsCondition(this.panelsCore,e)}runTriggers(e,t,s){super.runTriggers(e,t,s),this.visiblePanelsCore.forEach(i=>{i.questions.forEach(r=>r.runTriggers(e,t,s))})}reRunCondition(){this.data&&this.runCondition(this.getDataFilteredProperties())}runPanelsCondition(e,t){this.isValueChangingInternally=!0;for(var s=0;s<e.length;s++){const i=e[s],r=D.expressionVariables.panel,a=L.createCopy(t);a[r]=i,i.runCondition(a),i.isVisible}this.isValueChangingInternally=!1}onAnyValueChanged(e,t){super.onAnyValueChanged(e,t),!this.hasPanelBuildFirstTime&&e===this.getValueName()&&(this.isValueChangedWithoutPanels=!0);for(var s=0;s<this.panelsCore.length;s++)this.panelsCore[s].onAnyValueChanged(e,t),this.panelsCore[s].onAnyValueChanged(D.expressionVariables.panel,"")}hasKeysDuplicated(e){for(var t=[],s,i=0;i<this.panelsCore.length;i++)s=this.isValueDuplicated(this.panelsCore[i],t,e)||s;return s}updatePanelsContainsErrors(){const e=this.changingValueQuestions;if(!(!Array.isArray(e)||e.length===0)){for(var t=e[0],s=t.parent;s;)s.updateContainsErrors(),s=s.parent;this.updateContainsErrors()}}validateElementCore(e){if(this.isValueChangingInternally&&!this.hasInputInChangedQuestions()||this.isBuildingPanelsFirstTime)return!0;let t=!0;const s=this.changingValueQuestions;if(Array.isArray(s)){let i=!0;s.forEach(r=>{i=r.validateElement(e)&&i}),t=!this.hasKeysDuplicated(e)&&i,this.updatePanelsContainsErrors()}else t=this.validateInPanels(e);return super.validateElementCore(e)&&t}hasInputInChangedQuestions(){const e=this.changingValueQuestions;if(!Array.isArray(e)||e.length===0)return!1;for(let t=0;t<e.length;t++)if(e[t].hasInput)return!0;return!1}getContainsErrors(){var e=super.getContainsErrors();if(e)return e;for(var t=this.panelsCore,s=0;s<t.length;s++)if(t[s].containsErrors)return!0;return!1}getIsAnswered(){if(!super.getIsAnswered())return!1;for(var e=this.visiblePanelsCore,t=0;t<e.length;t++){var s=[];e[t].addQuestionsToList(s,!0);for(var i=0;i<s.length;i++)if(!s[i].isAnswered)return!1}return!0}clearValueOnHidding(e){if(!e){if(this.survey&&this.survey.getQuestionClearIfInvisible("onHidden")==="none")return;this.clearValueInPanelsIfInvisible("onHiddenContainer")}super.clearValueOnHidding(e)}clearValueIfInvisible(e="onHidden"){const t=e==="onHidden"?"onHiddenContainer":e;this.clearValueInPanelsIfInvisible(t),super.clearValueIfInvisible(e)}clearValueInPanelsIfInvisible(e){for(var t=0;t<this.panelsCore.length;t++){const r=this.panelsCore[t];var s=r.questions;this.isSetPanelItemData={};for(var i=0;i<s.length;i++){const a=s[i];a.visible&&!r.isVisible||(a.clearValueIfInvisible(e),this.isSetPanelItemData[a.getValueName()]=this.maxCheckCount+1)}}this.isSetPanelItemData={}}getIsRunningValidators(){if(super.getIsRunningValidators())return!0;for(var e=0;e<this.panelsCore.length;e++)for(var t=this.panelsCore[e].questions,s=0;s<t.length;s++)if(t[s].isRunningValidators)return!0;return!1}getAllErrors(){var e=super.getAllErrors();const t=this.visiblePanelsCore;for(var s=0;s<t.length;s++)for(var i=t[s].questions,r=0;r<i.length;r++){var a=i[r].getAllErrors();a&&a.length>0&&(e=e.concat(a))}return e}getValueGetterContext(){return new G_(this)}getDisplayValueCore(e,t){var s=this.getUnbindValue(t);if(!s||!Array.isArray(s))return s;for(var i=0;i<this.panelsCore.length&&i<s.length;i++){var r=s[i];r&&(s[i]=this.getPanelDisplayValue(i,r,e))}return s}getPanelDisplayValue(e,t,s){if(!t)return t;for(var i=this.panelsCore[e],r=Object.keys(t),a=0;a<r.length;a++){var o=r[a],l=i.getQuestionByValueName(o);if(l||(l=this.getSharedQuestionFromArray(o,e)),l){var u=l.getDisplayValue(s,t[o]);t[o]=u,s&&l.title&&l.title!==o&&(t[l.title]=u,delete t[o])}}return t}validateInPanels(e){let t=!0;const s=this.visiblePanels,i=[];for(let r=0;r<s.length;r++){let a=s[r].validateElement(e);a=!this.isValueDuplicated(s[r],i,e)&&a,!this.isRenderModeList&&!a&&t&&e.focusOnFirstError&&(this.currentIndex=r),t=a&&t}return t}isValueDuplicated(e,t,s){if(!this.keyName)return!1;var i=e.getQuestionByValueName(this.keyName);if(!i||i.isEmpty())return!1;var r=i.value;const a=this.changingValueQuestions;Array.isArray(a)&&a.indexOf(i)<0&&i.validateElement(s);for(var o=0;o<t.length;o++)if(r==t[o])return s.fireCallback&&i.addError(new x1(this.keyDuplicationError,this)),s.setErrorElement(i),!0;return t.push(r),!1}getPanelActions(e){let t=e.footerActions;return this.removePanelButtonLocation!=="right"&&t.push(new xe({id:`remove-panel-${e.id}`,component:"sv-paneldynamic-remove-btn",visible:new Ue(()=>[this.canRenderRemovePanel(e,"bottom")].every(s=>s===!0)),data:{question:this,panel:e}})),this.survey&&(t=this.survey.getUpdatedPanelFooterActions(e,t,this)),t}canRenderRemovePanelOnRight(e){return this.canRenderRemovePanel(e,"right")}canRenderRemovePanel(e,t){const s=this.canRemovePanel,i=e.state!=="collapsed";return this.removePanelButtonLocation===t&&s&&i}createNewPanel(){var e=this.createAndSetupNewPanelObject(),t=this.template.toJSON();return new rt().toObject(t,e),e.renderWidth="100%",e.updateCustomWidgets(),e.questions.forEach(s=>s.setParentQuestion(this)),new ub(this,e),e.onGetFooterActionsCallback=()=>this.getPanelActions(e),e.onGetFooterToolbarCssCallback=()=>this.cssClasses.panelFooter,e.registerPropertyChangedHandlers(["visible"],()=>{e.visible?this.onPanelAdded(e):this.onPanelRemoved(e),this.updateFooterActions()}),e}createAndSetupNewPanelObject(){var e=this.createNewPanelObject();return e.isInteractiveDesignElement=!1,e.setParentQuestion(this),e.onGetQuestionTitleLocation=()=>this.getTemplateQuestionTitleLocation(),e.onGetQuestionTitleWidth=()=>this.templateQuestionTitleWidth,e.recursiveNoCallback=()=>this.recursiveNoCallback(),e}getTemplateQuestionTitleLocation(){return this.templateQuestionTitleLocation!="default"?this.templateQuestionTitleLocation:this.getParentTitleLocation()}getChildErrorLocation(e){return this.templateErrorLocation!=="default"?this.templateErrorLocation:super.getChildErrorLocation(e)}createNewPanelObject(){return B.createClass("panel")}setPanelCountBasedOnValue(){if(!(this.isValueChangingInternally||this.useTemplatePanel)){var e=this.value,t=e&&Array.isArray(e)?e.length:0;t==0&&this.getPropertyValue("panelCount")>0&&(t=this.getPropertyValue("panelCount")),this.settingPanelCountBasedOnValue=!0,this.panelCount=t,this.settingPanelCountBasedOnValue=!1}}setQuestionValue(e){if(!this.settingPanelCountBasedOnValue){super.setQuestionValue(e,!1),this.setPanelCountBasedOnValue();for(var t=0;t<this.panelsCore.length;t++)this.panelUpdateValueFromSurvey(this.panelsCore[t]);this.updateIsAnswered()}}onSurveyValueChanged(e){if(!(e===void 0&&this.isAllPanelsEmpty())){super.onSurveyValueChanged(e);for(var t=0;t<this.panelsCore.length;t++)this.panelSurveyValueChanged(this.panelsCore[t]);e===void 0&&this.setValueBasedOnPanelCount(),this.updateIsReady()}}isAllPanelsEmpty(){for(var e=0;e<this.panelsCore.length;e++)if(!L.isValueEmpty(this.panelsCore[e].getValue()))return!1;return!0}panelUpdateValueFromSurvey(e){const t=e.questions;for(var s=this.getPanelItemData(e.data),i=0;i<t.length;i++){const r=t[i];r.updateValueFromSurvey(s[r.getValueName()]),r.updateCommentFromSurvey(s[r.getValueName()+D.commentSuffix]),r.initDataUI()}}panelSurveyValueChanged(e){for(var t=e.questions,s=this.getPanelItemData(e.data),i=0;i<t.length;i++){var r=t[i];r.onSurveyValueChanged(s[r.getValueName()])}}onSetData(){super.onSetData(),!this.isLoadingFromJson&&this.useTemplatePanel&&(this.setTemplatePanelSurveyImpl(),this.rebuildPanels())}isNewValueCorrect(e){return Array.isArray(e)}getValueChangingOptions(e){let t=e.parent;for(;t.parent;)t=t.parent;const s=t,i=this.panels.indexOf(s);return{question:this,panel:s,name:e.name,panelIndex:i,panelData:this.getPanelItemDataByIndex(i),oldValue:e.value}}getItemIndex(e){var t=this.items.indexOf(e);return t>-1?t:this.items.length}getVisibleItemIndex(e){const t=this.visiblePanelsCore;for(var s=0;s<t.length;s++)if(t[s].data===e)return s;return t.length}getPanelItemData(e){return this.getPanelItemDataByIndex(this.items.indexOf(e))}getPanelItemDataByIndex(e){const t=this.items;var s=this.value;return e<0&&Array.isArray(s)&&s.length>t.length&&(e=t.length),e<0?{}:!s||!Array.isArray(s)||s.length<=e?{}:s[e]}setPanelItemData(e,t,s){if(this.isSetPanelItemData[t]>this.maxCheckCount)return;this.isSetPanelItemData[t]||(this.isSetPanelItemData[t]=0),this.isSetPanelItemData[t]++;var i=this.items,r=i.indexOf(e);r<0&&(r=i.length);var a=this.getUnbindValue(this.value);(!a||!Array.isArray(a))&&(a=[]);const o=Math.max(r+1,i.length);for(var l=a.length;l<o;l++)a.push({});a[r]||(a[r]={}),this.isValueEmpty(s)?delete a[r][t]:a[r][t]=s,r>=0&&r<this.panelsCore.length&&(Array.isArray(this.changingValueQuestions)||(this.changingValueQuestions=[]),this.changingValueQuestions.push(this.panelsCore[r].getQuestionByValueName(t))),this.value=a,this.changingValueQuestions=null,this.isSetPanelItemData[t]--,this.isSetPanelItemData[t]-1&&delete this.isSetPanelItemData[t]}getRootData(){return this.data}getPlainData(e={includeEmpty:!0}){var t=super.getPlainData(e);if(t){t.isNode=!0;const s=Array.isArray(t.data)?[].concat(t.data):[];t.data=this.panels.map((i,r)=>{var a={name:i.name||r,title:i.title||"Panel",value:i.getValue(),displayValue:i.getValue(),getString:o=>typeof o=="object"?JSON.stringify(o):o,isNode:!0,data:i.questions.map(o=>o.getPlainData(e)).filter(o=>!!o)};return(e.calculations||[]).forEach(o=>{a[o.propertyName]=i[o.propertyName]}),a}),t.data=t.data.concat(s)}return t}updateElementCss(e){super.updateElementCss(e);for(var t=0;t<this.panelsCore.length;t++){var s=this.panelsCore[t];s.updateElementCss(e)}}get progressText(){var e=this.visiblePanelCount;return this.getLocalizationFormatString("panelDynamicProgressText",this.currentIndex+1,e)}get progress(){return(this.currentIndex+1)/this.visiblePanelCount*100+"%"}get progressBarAriaLabel(){return bt("progressbar",this.getLocale())}getRootCss(){return new j().append(super.getRootCss()).append(this.cssClasses.empty,this.getShowNoEntriesPlaceholder()).toString()}get cssHeader(){const e=this.isRenderModeTab&&!!this.visiblePanelCount;return new j().append(super.getCssHeader(this.cssClasses)).append(this.cssClasses.headerTab,this.hasTitleOnTop&&e).toString()}getTabsContainerCss(){return new j().append(this.cssClasses.tabsContainer).append(this.cssClasses.tabsContainerWithHeader,this.hasTitleOnTop).toString()}getPanelWrapperCss(e){return new j().append(this.cssClasses.panelWrapper,!e||e.visible).append(this.cssClasses.panelWrapperList,this.isRenderModeList).append(this.cssClasses.panelWrapperInRow,this.removePanelButtonLocation==="right").toString()}getPanelRemoveButtonCss(){return new j().append(this.cssClasses.button).append(this.cssClasses.buttonRemove).append(this.cssClasses.buttonRemoveRight,this.removePanelButtonLocation==="right").toString()}getAddButtonCss(){return new j().append(this.cssClasses.button).append(this.cssClasses.buttonAdd).append(this.cssClasses.buttonAdd+"--list-mode",this.displayMode==="list").toString()}getPrevButtonCss(){return new j().append(this.cssClasses.buttonPrev).append(this.cssClasses.buttonPrevDisabled,!this.isPrevButtonVisible).toString()}getNextButtonCss(){return new j().append(this.cssClasses.buttonNext).append(this.cssClasses.buttonNextDisabled,!this.isNextButtonVisible).toString()}get noEntriesText(){return this.getLocalizableStringText("noEntriesText")}set noEntriesText(e){this.setLocalizableStringText("noEntriesText",e)}get locNoEntriesText(){return this.getLocalizableString("noEntriesText")}getShowNoEntriesPlaceholder(){return!!this.cssClasses.noEntriesPlaceholder&&!this.isDesignMode&&this.visiblePanelCount===0}needResponsiveWidth(){const e=this.getPanels();for(let t=0;t<e.length;t++){const s=e[t];if(s.isVisible&&s.needResponsiveWidth())return!0}return!1}get hasTabbedMenu(){return this.isRenderModeTab&&this.visiblePanels.length>0}get tabbedMenu(){return this.isRenderModeTab?(this.tabbedMenuValue||(this.tabbedMenuValue=new Wo,this.tabbedMenuValue.dotsItem.popupModel.showPointer=!1,this.tabbedMenuValue.dotsItem.popupModel.verticalPosition="bottom",this.tabbedMenuValue.dotsItem.popupModel.horizontalPosition="center",this.updateElementCss(!1)),this.tabbedMenuValue):null}get showFooterToolbar(){return this.footerToolbar&&this._showFooterToolbar}get footerToolbar(){return this.footerToolbarValue||this.initFooterToolbar(),this.footerToolbarValue}get ariaRole(){return"group"}get ariaRequired(){return null}get ariaInvalid(){return null}updateFooterActions(){this.updateFooterActionsCallback&&this.updateFooterActionsCallback()}initFooterToolbar(){this.footerToolbarValue=this.createActionContainer();const e=[],t=new xe({id:"sv-pd-prev-btn",title:this.prevPanelText,action:()=>{this.goToPrevPanel()}}),s=new xe({id:"sv-pd-next-btn",title:this.nextPanelText,action:()=>{this.goToNextPanel()}}),i=new xe({id:"sv-pd-add-btn",component:"sv-paneldynamic-add-btn",data:{question:this}}),r=new xe({id:"sv-prev-btn-icon",component:"sv-paneldynamic-prev-btn",data:{question:this}}),a=new xe({id:"sv-pd-progress-text",component:"sv-paneldynamic-progress-text",data:{question:this}}),o=new xe({id:"sv-pd-next-btn-icon",component:"sv-paneldynamic-next-btn",data:{question:this}});e.push(t,s,i,r,a,o),this.updateFooterActionsCallback=()=>{const l=this.legacyNavigation,u=this.isRenderModeList,d=this.isMobile,h=!l&&!u;t.visible=h&&this.currentIndex>0,s.visible=h&&this.currentIndex<this.visiblePanelCount-1,s.needSpace=d&&s.visible&&t.visible,i.visible=this.canAddPanel,i.needSpace=this.isMobile&&!s.visible&&t.visible,a.visible=!this.isRenderModeList&&!d,a.needSpace=!l&&!this.isMobile;const f=l&&!u;r.visible=f,o.visible=f,r.needSpace=f},this.updateFooterActionsCallback(),this.footerToolbarValue.setItems(e),this.footerToolbar.flushUpdates(),this._showFooterToolbar=new Ue(()=>{var l;return(l=this.footerToolbarValue)===null||l===void 0?void 0:l.hasVisibleActions})}createTabByPanel(e,t){if(!this.isRenderModeTab)return;const s=new wt(e,!0);s.onGetTextCallback=o=>{if(o||(o=this.locTabTitlePlaceholder.renderedHtml),!this.survey)return o;const l={title:o,panel:e,visiblePanelIndex:t};return this.survey.dynamicPanelGetTabTitle(this,l),l.title},s.sharedData=this.locTemplateTabTitle;const i=e.id,r=this.getPanelVisibleIndexById(i)===this.currentIndex;return new J_({id:`${this.id}_tab_${i}`,panelId:i,pressed:r,locTitle:s,disableHide:r,action:()=>{this.currentIndex=this.getPanelVisibleIndexById(i)}})}getTabbedMenuCss(e){const t=e??this.cssClasses;return new j().append(t.tabsRoot).append(t.tabsLeft,this.tabAlign==="left").append(t.tabsRight,this.tabAlign==="right").append(t.tabsCenter,this.tabAlign==="center").toString()}updateTabToolbarItemsPressedState(){if(!this.isRenderModeTab||this.currentIndex<0||this.currentIndex>=this.visiblePanelCount)return;const e=this.visiblePanelsCore[this.currentIndex];this.tabbedMenu.actions.forEach(t=>{const s=t.panelId===e.id;t.pressed=s,t.disableHide=s})}updateTabToolbar(){if(!this.isRenderModeTab)return;const e=[],t=this.visiblePanelsCore;for(let s=0;s<t.length;s++)this.visiblePanelsCore.forEach(i=>e.push(this.createTabByPanel(t[s],s)));this.tabbedMenu.setItems(e)}addTabFromToolbar(e,t){if(!this.isRenderModeTab)return;const s=this.createTabByPanel(e,t);this.tabbedMenu.actions.splice(t,0,s),this.updateTabToolbarItemsPressedState()}removeTabFromToolbar(e){if(!this.isRenderModeTab)return;const t=this.tabbedMenu.actions.find(s=>s.panelId==e.id);t&&(this.tabbedMenu.actions.splice(this.tabbedMenu.actions.indexOf(t),1),this.updateTabToolbarItemsPressedState())}get showNavigation(){return this.isReadOnly&&this.visiblePanelCount==1?!1:this.visiblePanelCount>0&&!!this.cssClasses.footer}showSeparator(e){return this.isRenderModeList&&e<this.renderedPanels.length-1}calcCssClasses(e){const t=super.calcCssClasses(e),s=this.tabbedMenu;return s&&(s.containerCss=this.getTabbedMenuCss(t),s.cssClasses=t.tabs,s.dotsItem.cssClasses=t.tabs,s.dotsItem.popupModel.contentComponentData.model.cssClasses=e.list),t}onMobileChanged(){super.onMobileChanged(),this.updateFooterActions()}}fi.maxCheckCount=3,I([Ft({})],fi.prototype,"_renderedPanels",void 0),I([R({onSet:(n,e)=>{e.fireCallback(e.renderModeChangedCallback),e.updatePanelView()}})],fi.prototype,"displayMode",void 0),I([R({onSet:(n,e)=>{e.fireCallback(e.currentIndexChangedCallback)}})],fi.prototype,"showProgressBar",void 0),I([R({onSet:(n,e)=>{}})],fi.prototype,"progressBarLocation",void 0),I([R({defaultValue:!1})],fi.prototype,"_showFooterToolbar",void 0),I([R({defaultValue:!1,onSet:(n,e)=>{e.updateFooterActions()}})],fi.prototype,"legacyNavigation",void 0),B.addClass("paneldynamic",[{name:"showCommentArea:switch",layout:"row",visible:!0,category:"general"},{name:"templateElements",alternativeName:"questions",baseClassName:"question",visible:!1,isLightSerializable:!1},{name:"templateTitle:text",serializationProperty:"locTemplateTitle"},{name:"templateTabTitle",serializationProperty:"locTemplateTabTitle",visibleIf:n=>n.displayMode==="tab"},{name:"tabTitlePlaceholder",serializationProperty:"locTabTitlePlaceholder",visibleIf:n=>n.displayMode==="tab"},{name:"templateDescription:text",serializationProperty:"locTemplateDescription"},{name:"minWidth",defaultFunc:()=>"auto"},{name:"noEntriesText:text",serializationProperty:"locNoEntriesText"},{name:"allowAddPanel:boolean",default:!0},{name:"allowRemovePanel:boolean",default:!0},{name:"newPanelPosition",choices:["next","last"],default:"last",category:"layout"},{name:"panelCount:number",isBindable:!0,default:0,choices:[0,1,2,3,4,5,6,7,8,9,10]},{name:"minPanelCount:number",default:0,minValue:0},{name:"maxPanelCount:number",defaultFunc:()=>D.panel.maxPanelCount},"defaultPanelValue:panelvalue",{name:"copyDefaultValueFromLastEntry:boolean",alternativeName:"defaultValueFromLastPanel"},{name:"panelsState",default:"default",choices:["default","collapsed","expanded","firstExpanded"],visibleIf:n=>n.displayMode==="list"},{name:"keyName"},{name:"keyDuplicationError",serializationProperty:"locKeyDuplicationError"},{name:"confirmDelete:boolean"},{name:"confirmDeleteText",serializationProperty:"locConfirmDeleteText",visibleIf:n=>n.confirmDelete},{name:"addPanelText",alternativeName:"panelAddText",serializationProperty:"locAddPanelText",visibleIf:n=>n.allowAddPanel},{name:"removePanelText",alternativeName:"panelRemoveText",serializationProperty:"locRemovePanelText",visibleIf:n=>n.allowRemovePanel},{name:"prevPanelText",alternativeName:"panelPrevText",serializationProperty:"locPrevPanelText",visibleIf:n=>n.displayMode!=="list"},{name:"nextPanelText",alternativeName:"panelNextText",serializationProperty:"locNextPanelText",visibleIf:n=>n.displayMode!=="list"},{name:"showQuestionNumbers",default:"off",choices:["default","onpanel","recursive","off"]},{name:"questionStartIndex",visibleIf:n=>{const e=n.showQuestionNumbers;return e==="onpanel"||e==="recursive"}},{name:"renderMode",visible:!1,isSerializable:!1},{name:"displayMode",default:"list",choices:["list","carousel","tab"]},{name:"showProgressBar:boolean",alternativeName:"showRangeInProgress",default:!0,visibleIf:n=>n.displayMode==="carousel"},{name:"progressBarLocation",default:"top",choices:["top","bottom","topBottom"],visibleIf:n=>n.showProgressBar&&n.displayMode==="carousel"},{name:"tabAlign",default:"center",choices:["left","center","right"],visibleIf:n=>n.displayMode==="tab"},{name:"templateQuestionTitleLocation",alternativeName:"questionTitleLocation",default:"default",choices:["default","top","bottom","left"]},{name:"templateQuestionTitleWidth",visibleIf:function(n){return!!n&&n.template.availableQuestionTitleWidth()}},{name:"templateErrorLocation",default:"default",choices:["default","top","bottom"]},{name:"templateVisibleIf:expression",category:"logic"},{name:"removePanelButtonLocation",alternativeName:"panelRemoveButtonLocation",default:"bottom",choices:["bottom","right"],visibleIf:n=>n.allowRemovePanel}],function(){return new fi("")},"question"),Qe.Instance.registerQuestion("paneldynamic",n=>new fi(n));class hb{static getProgressTextInBarCss(e){return new j().append(e.progressText).append(e.progressTextInBar).toString()}static getProgressTextUnderBarCss(e){return new j().append(e.progressText).append(e.progressTextUnderBar).toString()}}class yi extends de{static get operators(){return yi.operatorsValue!=null||(yi.operatorsValue={empty:function(e,t){return!e},notempty:function(e,t){return!!e},equal:function(e,t){return e==t},notequal:function(e,t){return e!=t},contains:function(e,t){return e&&e.indexOf&&e.indexOf(t)>-1},notcontains:function(e,t){return!e||!e.indexOf||e.indexOf(t)==-1},greater:function(e,t){return e>t},less:function(e,t){return e<t},greaterorequal:function(e,t){return e>=t},lessorequal:function(e,t){return e<=t}}),yi.operatorsValue}constructor(){super()}get id(){return this.uniqueId}getType(){return"triggerbase"}toString(){var e=this.getType().replace("trigger",""),t=this.expression;return t&&(e+=", "+t),e}get isInternal(){return this.isGhost===!0}get operator(){return this.getPropertyValue("operator","equal")}set operator(e){e&&(e=e.toLowerCase(),yi.operators[e]&&this.setPropertyValue("operator",e))}get value(){return this.getPropertyValue("value",null)}set value(e){this.setPropertyValue("value",e)}get name(){return this.getPropertyValue("name","")}set name(e){this.setPropertyValue("name",e)}get expression(){return this.getPropertyValue("expression",this.buildExpression())}set expression(e){this.setPropertyValue("expression",e)}canBeExecuted(e){return!0}canBeExecutedOnComplete(){return!1}checkExpression(e){if(this.isExecutingOnNextPage=e.isOnNextPage,this.isExecutingOnNavigation=e.isOnNavigation||e.isOnNextPage,!this.canBeExecuted(e.isOnNextPage)||e.isOnComplete&&!this.canBeExecutedOnComplete())return;const t=Object.keys(e.keys);if(Array.isArray(t)&&!this.canBeExecuteOnKeysChange(t))return;const s=e.properties||null;this.runExpressionByProperty("expression",s,i=>{this.triggerResult(i===!0,s)},i=>this.isCheckRequired(i,e.keys))||this.isCheckRequired(null,e.keys)&&this.canSuccessOnEmptyExpression()&&this.triggerResult(!0,s)}canBeExecuteOnKeysChange(e){return!0}canSuccessOnEmptyExpression(){return!1}check(e){var t=yi.operators[this.operator](e,this.value);t?this.onSuccess(null):this.onFailure()}get requireValidQuestion(){return!1}triggerResult(e,t){e?(this.onSuccess(t),this.onSuccessExecuted()):this.onFailure()}onSuccess(e){}onFailure(){}onSuccessExecuted(){}buildExpression(){return!this.name||this.isValueEmpty(this.value)&&this.isRequireValue?"":"{"+this.name+"} "+this.operator+" "+Re.toOperandString(this.value)}isCheckRequired(e,t){return t?e?.hasFunction()===!0?!0:new Di().isAnyKeyChanged(t,this.getUsedVariables(e)):!1}getUsedVariables(e){if(!e)return[];const t=e.getVariables();if(Array.isArray(t)){const s=D.expressionVariables.unwrapPostfix;for(let i=t.length-1;i>=0;i--){const r=t[i];r.endsWith(s)&&t.push(r.substring(0,r.length-s.length))}}return t}get isRequireValue(){return this.operator!=="empty"&&this.operator!="notempty"}}yi.operatorsValue=null;class Wr extends yi{constructor(){super(),this.ownerValue=null}get owner(){return this.ownerValue}setOwner(e){this.ownerValue=e}getSurvey(e=!1){return this.owner&&this.owner.getSurvey?this.owner.getSurvey():null}isRealExecution(){return!0}onSuccessExecuted(){this.owner&&this.isRealExecution()&&this.owner.triggerExecuted(this)}}class Z_ extends Wr{constructor(){super(),this.pages=[],this.questions=[]}getType(){return"visibletrigger"}onSuccess(e){this.onTrigger(this.onItemSuccess)}onFailure(){this.onTrigger(this.onItemFailure)}onTrigger(e){if(this.owner)for(var t=this.owner.getObjects(this.pages,this.questions),s=0;s<t.length;s++)e(t[s])}onItemSuccess(e){e.visible=!0}onItemFailure(e){e.visible=!1}}class Y_ extends Wr{constructor(){super()}getType(){return"completetrigger"}get requireValidQuestion(){return!0}isRealExecution(){return!D.triggers.executeCompleteOnValueChanged===this.isExecutingOnNavigation}onSuccess(e){this.owner&&(this.isRealExecution()?this.owner.setCompleted(this):this.owner.canBeCompleted(this,!0))}onFailure(){this.owner.canBeCompleted(this,!1)}}class X_ extends Wr{constructor(){super()}getType(){return"setvaluetrigger"}canBeExecuted(e){return!e&&!!this.setToName}canBeExecuteOnKeysChange(e){return e.length===1&&e[0]===this.setToName?!1:super.canBeExecuteOnKeysChange(e)}onPropertyValueChanged(e,t,s){if(super.onPropertyValueChanged(e,t,s),e==="setToName"){var i=this.getSurvey();i&&!i.isLoadingFromJson&&i.isDesignMode&&(this.setValue=void 0)}}get setToName(){return this.getPropertyValue("setToName","")}set setToName(e){this.setPropertyValue("setToName",e)}get setValue(){return this.getPropertyValue("setValue")}set setValue(e){this.setPropertyValue("setValue",e)}get isVariable(){return this.getPropertyValue("isVariable")}set isVariable(e){this.setPropertyValue("isVariable",e)}onSuccess(e){!this.setToName||!this.owner||this.owner.setTriggerValue(this.setToName,L.getUnbindValue(this.setValue),this.isVariable)}}class e7 extends Wr{constructor(){super()}getType(){return"skiptrigger"}get requireValidQuestion(){return this.canBeExecuted(!1)}get gotoName(){return this.getPropertyValue("gotoName","")}set gotoName(e){this.setPropertyValue("gotoName",e)}canBeExecuted(e){return e===!D.triggers.executeSkipOnValueChanged}onSuccess(e){!this.gotoName||!this.owner||this.owner.focusQuestion(this.gotoName)}}class t7 extends Wr{constructor(){super()}getType(){return"runexpressiontrigger"}get setToName(){return this.getPropertyValue("setToName","")}set setToName(e){this.setPropertyValue("setToName",e)}get runExpression(){return this.getPropertyValue("runExpression","")}set runExpression(e){this.setPropertyValue("runExpression",e)}canBeExecuted(e){return!e}onSuccess(e){this.owner&&this.runExpressionByProperty("runExpression",e,t=>{this.onCompleteRunExpression(t)})}onCompleteRunExpression(e){this.setToName&&e!==void 0&&this.owner.setTriggerValue(this.setToName,L.convertValToQuestionVal(e),!1)}}class s7 extends Wr{constructor(){super()}canBeExecuted(e){return!e&&!!this.setToName&&!!this.fromName}get setToName(){return this.getPropertyValue("setToName","")}set setToName(e){this.setPropertyValue("setToName",e)}get fromName(){return this.getPropertyValue("fromName","")}set fromName(e){this.setPropertyValue("fromName",e)}get copyDisplayValue(){return this.getPropertyValue("copyDisplayValue")}set copyDisplayValue(e){this.setPropertyValue("copyDisplayValue",e)}getType(){return"copyvaluetrigger"}canBeExecuteOnKeysChange(e){return e.length===1&&e[0]===this.setToName?!1:super.canBeExecuteOnKeysChange(e)}onSuccess(e){!this.setToName||!this.owner||this.owner.copyTriggerValue(this.setToName,this.fromName,this.copyDisplayValue)}canSuccessOnEmptyExpression(){return!0}getUsedVariables(e){const t=super.getUsedVariables(e);return t.length===0&&this.fromName&&t.push(this.fromName),t}}B.addClass("trigger",[{name:"operator",default:"equal",visible:!1},{name:"value",visible:!1},"expression:condition"]),B.addClass("surveytrigger",[{name:"name",visible:!1}],null,"trigger"),B.addClass("visibletrigger",["pages:pages","questions:questions"],function(){return new Z_},"surveytrigger"),B.addClass("completetrigger",[],function(){return new Y_},"surveytrigger"),B.addClass("setvaluetrigger",[{name:"!setToName:questionvalue"},{name:"setValue:triggervalue",dependsOn:"setToName",visibleIf:function(n){return!!n&&!!n.setToName}},{name:"isVariable:boolean",visible:!1}],function(){return new X_},"surveytrigger"),B.addClass("copyvaluetrigger",[{name:"!fromName:questionvalue"},{name:"!setToName:questionvalue"},{name:"copyDisplayValue:boolean",visible:!1}],function(){return new s7},"surveytrigger"),B.addClass("skiptrigger",[{name:"!gotoName:question"}],function(){return new e7},"surveytrigger"),B.addClass("runexpressiontrigger",[{name:"setToName:questionvalue"},"runExpression:expression"],function(){return new t7},"surveytrigger");class db extends de{constructor(e,t=null){super(),this.closeOnCompleteTimeout=0,t?this.surveyValue=t:this.surveyValue=this.createSurvey(e),this.surveyValue.fitToContainer=!0,this.windowElement=oe.createElement("div"),this.survey.onComplete.add((s,i)=>{this.onSurveyComplete()}),this.registerPropertyChangedHandlers(["isShowing"],()=>{this.showingChangedCallback&&this.showingChangedCallback()}),this.registerPropertyChangedHandlers(["isExpanded"],()=>{this.onExpandedChanged()}),this.width=new Ue(()=>this.survey.width),this.width=this.survey.width,this.updateCss(),this.onCreating()}onCreating(){}getType(){return"popupsurvey"}get survey(){return this.surveyValue}get isShowing(){return this.getPropertyValue("isShowing",!1)}set isShowing(e){this.setPropertyValue("isShowing",e)}get isFullScreen(){return this.getPropertyValue("isFullScreen",!1)}set isFullScreen(e){!this.isExpanded&&e&&(this.isExpanded=!0),this.setPropertyValue("isFullScreen",e),this.setCssRoot()}show(){this.isShowing=!0}hide(){this.isShowing=!1}toggleFullScreen(){this.isFullScreen=!this.isFullScreen}get isExpanded(){return this.getPropertyValue("isExpanded",!1)}set isExpanded(e){this.isFullScreen&&!e&&(this.isFullScreen=!1),this.setPropertyValue("isExpanded",e)}get isCollapsed(){return!this.isExpanded}onExpandedChanged(){this.expandedChangedCallback&&this.expandedChangedCallback(),this.updateCssButton()}get title(){return this.survey.title}set title(e){this.survey.title=e}get locTitle(){return this.survey.locTitle.isEmpty?null:this.survey.locTitle}get locDescription(){return this.survey.locTitle.isEmpty?null:this.survey.locDescription}expand(){this.isExpanded=!0}collapse(){this.isExpanded=!1}changeExpandCollapse(){this.isExpanded=!this.isExpanded}get allowClose(){return this.getPropertyValue("allowClose",!1)}set allowClose(e){this.setPropertyValue("allowClose",e)}get allowFullScreen(){return this.getPropertyValue("allowFullScreen",!1)}set allowFullScreen(e){this.setPropertyValue("allowFullScreen",e)}get css(){return this.survey.css}get cssButton(){return this.getPropertyValue("cssButton","")}get cssRoot(){let e=this.getPropertyValue("cssRoot","");return this.isCollapsed&&(e+=" "+this.getPropertyValue("cssRootCollapsedMod","")),e}get cssRootCollapsedMod(){return this.getPropertyValue("cssRootCollapsedMod")}get cssRootContent(){return this.getPropertyValue("cssRootContent")}get cssBody(){return this.getPropertyValue("cssBody","")}get cssHeaderRoot(){return this.getPropertyValue("cssHeaderRoot","")}get cssHeaderTitleCollapsed(){return this.getPropertyValue("cssHeaderTitleCollapsed","")}get cssHeaderButtonsContainer(){return this.getPropertyValue("cssHeaderButtonsContainer","")}get cssHeaderCollapseButton(){return this.getPropertyValue("cssHeaderCollapseButton","")}get cssHeaderCloseButton(){return this.getPropertyValue("cssHeaderCloseButton","")}get cssHeaderFullScreenButton(){return this.getPropertyValue("cssHeaderFullScreenButton","")}get renderedWidth(){let e=this.getPropertyValue("width","60%");return e&&!isNaN(e)&&(e=e+"px"),e}updateCss(){if(!this.css||!this.css.window)return;const e=this.css.window;this.setCssRoot(),this.setPropertyValue("cssRootCollapsedMod",e.rootCollapsedMod),this.setPropertyValue("cssRootContent",e.rootContent),this.setPropertyValue("cssBody",e.body);const t=e.header;t&&(this.setPropertyValue("cssHeaderRoot",t.root),this.setPropertyValue("cssHeaderTitleCollapsed",t.titleCollapsed),this.setPropertyValue("cssHeaderButtonsContainer",t.buttonsContainer),this.setPropertyValue("cssHeaderCollapseButton",t.collapseButton),this.setPropertyValue("cssHeaderCloseButton",t.closeButton),this.setPropertyValue("cssHeaderFullScreenButton",t.fullScreenButton),this.updateCssButton())}setCssRoot(){const e=this.css.window;this.isFullScreen?this.setPropertyValue("cssRoot",e.root+" "+e.rootFullScreenMode):this.setPropertyValue("cssRoot",e.root)}updateCssButton(){const e=this.css.window?this.css.window.header:null;e&&this.setCssButton(this.isExpanded?e.buttonExpanded:e.buttonCollapsed)}setCssButton(e){e&&this.setPropertyValue("cssButton",e)}createSurvey(e){return new Ie(e)}onSurveyComplete(){if(!(this.closeOnCompleteTimeout<0))if(this.closeOnCompleteTimeout==0)this.hide();else{var e=this,t=null,s=function(){e.hide(),clearInterval(t)};t=setInterval(s,this.closeOnCompleteTimeout*1e3)}}onScroll(){this.survey.onScroll()}}I([R()],db.prototype,"width",void 0);class i7{constructor(){this._lockScroll=!1}setRootElement(e){this._containerElementValue=e?.querySelector(".sv-scroll__scroller"),this._scrollbarElement=e?.querySelector(".sv-scroll__scrollbar"),this._scrollbarSizerElement=e?.querySelector(".sv-scroll__scrollbar-sizer"),this._containerBodyElement=e?.querySelector(".sv-scroll__container"),!(!e||!he.isAvailable())&&(this._containerBodyResizeObserver=new ResizeObserver(t=>{for(let s of t){const i=s.contentBoxSize?s.contentBoxSize[0].blockSize:s.contentRect.width;this._scrollbarSizerElement.style.height=i+"px"}this.onInnerHeightChanged&&this.onInnerHeightChanged(this._containerBodyElement.clientHeight>this._containerElementValue.clientHeight)}),this._containerBodyResizeObserver.observe(this._containerBodyElement))}onScrollContainer(){this._lockScroll=!0,this._scrollbarElement.scrollTop=this._containerElementValue.scrollTop}onScrollScrollbar(){if(this._lockScroll){this._lockScroll=!1;return}this._containerElementValue.scrollTop=this._scrollbarElement.scrollTop}unsubscribeRootElement(){this._containerBodyResizeObserver&&(this._containerBodyResizeObserver.disconnect(),this._containerBodyResizeObserver=void 0)}}const cb='input:not(:disabled):not([readonly]):not([type=hidden]),select:not(:disabled):not([readonly]),textarea:not(:disabled):not([readonly]), button:not(:disabled):not([readonly]), [tabindex]:not([tabindex^="-"])';class vi extends de{updateIsVisible(e){this._isVisible=e,this.onVisibilityChanged.fire(this,{isVisible:e})}updateBeforeShowing(){this.model.onShow()}updateAfterHiding(){this.model.onHiding()}getLeaveOptions(){return{cssClass:"sv-popup--leave",onBeforeRunAnimation:e=>{e.setAttribute("inert","")},onAfterRunAnimation:e=>e.removeAttribute("inert")}}getEnterOptions(){return{cssClass:"sv-popup--enter"}}getAnimatedElement(){return this.getAnimationContainer()}isAnimationEnabled(){return this.model.displayMode!=="overlay"&&D.animationEnabled}getRerenderEvent(){return this.onElementRerendered}getAnimationContainer(){var e;return(e=this.container)===null||e===void 0?void 0:e.querySelector(this.fixedPopupContainer)}get isVisible(){return this._isVisible}set isVisible(e){this.visibilityAnimation.sync(e)}get container(){return this.containerElement||this.createdContainer}getLocale(){return this.locale?this.locale:super.getLocale()}hidePopup(){this.model.isVisible=!1}getStyleClass(){return new j().append(this.model.cssClass)}getShowFooter(){return this.isOverlay}getShowHeader(){return!1}getPopupHeaderTemplate(){}createFooterActionBar(){this.footerToolbarValue=new Vt}resetDimensionsAndPositionStyleProperties(){this.top="",this.left="",this.height="",this.width="",this.minWidth=""}onModelChanging(e){}setupModel(e){this.model&&this.model.onVisibilityChanged.remove(this.onModelIsVisibleChangedCallback),this.onModelChanging(e),this._model=e,e.onVisibilityChanged.add(this.onModelIsVisibleChangedCallback),this.onModelIsVisibleChangedCallback()}get model(){return this._model}set model(e){this.setupModel(e)}constructor(e){super(),this.popupSelector=".sv-popup",this.fixedPopupContainer=".sv-popup",this.containerSelector=".sv-popup__container",this.scrollingContentSelector=".sv-popup__scrolling-content",this.visibilityAnimation=new g1(this,t=>{this._isVisible!==t&&(t?(this.updateBeforeShowing(),this.updateIsVisible(t)):(this.updateOnHiding(),this.updateIsVisible(t),this.updateAfterHiding(),this._isPositionSetValue=!1))},()=>this._isVisible),this.onVisibilityChanged=new Xt,this.onModelIsVisibleChangedCallback=()=>{this.isVisible=this.model.isVisible},this._isPositionSetValue=!1,this.model=e,this.locale=this.model.locale}get title(){return this.model.title}get contentComponentName(){return this.model.contentComponentName}get contentComponentData(){return this.model.contentComponentData}get isModal(){return this.model.isModal}get isFocusedContent(){return this.model.isFocusedContent}get isFocusedContainer(){return this.model.isFocusedContainer}get showFooter(){return this.getShowFooter()}get showHeader(){return this.getShowHeader()}get popupHeaderTemplate(){return this.getPopupHeaderTemplate()}get isOverlay(){return this.model.displayMode==="overlay"}get styleClass(){return this.getStyleClass().toString()}get cancelButtonText(){return this.getLocalizationString("modalCancelButtonText")}get footerToolbar(){return this.footerToolbarValue||this.createFooterActionBar(),this.footerToolbarValue}onKeyDown(e){e.key==="Tab"||e.keyCode===9?this.trapFocus(e):(e.key==="Escape"||e.keyCode===27)&&this.hidePopup()}trapFocus(e){const t=this.container.querySelectorAll(cb),s=t[0],i=t[t.length-1];e.shiftKey?D.environment.root.activeElement===s&&(i.focus(),e.preventDefault()):D.environment.root.activeElement===i&&(s.focus(),e.preventDefault())}switchFocus(){this.isFocusedContent?this.focusFirstInput():this.isFocusedContainer&&this.focusContainer()}get isPositionSet(){return this._isPositionSetValue}updateOnShowing(){this.prevActiveElement=D.environment.root.activeElement,this.isOverlay&&this.resetDimensionsAndPositionStyleProperties(),this.switchFocus(),this._isPositionSetValue=!0}updateOnHiding(){this.isFocusedContent&&this.prevActiveElement&&this.prevActiveElement.focus({preventScroll:!0})}focusContainer(){if(!this.container)return;const e=this.container.querySelector(this.popupSelector);e?.focus()}focusFirstInput(){setTimeout(()=>{if(this.container){var e=this.container.querySelector(this.model.focusFirstInputSelector||cb);e?e.focus():this.focusContainer()}},100)}clickOutside(e){this.hidePopup(),e?.stopPropagation()}blur(e){this.model.onBlur()}cancel(){this.model.onCancel(),this.hidePopup()}dispose(){super.dispose(),this.model&&this.model.onVisibilityChanged.remove(this.onModelIsVisibleChangedCallback),this.createdContainer&&(this.createdContainer.remove(),this.createdContainer=void 0),this.footerToolbarValue&&this.footerToolbarValue.dispose(),this.resetComponentElement()}initializePopupContainer(){if(!this.container){const e=oe.createElement("div");this.createdContainer=e,gR(D.environment.popupMountContainer).appendChild(e)}}setComponentElement(e){e&&(this.containerElement=e)}resetComponentElement(){this.containerElement=void 0,this.prevActiveElement=void 0}preventScrollOuside(e,t){let s=e.target;for(;s!==this.container;){if(oe.getComputedStyle(s).overflowY==="auto"&&s.scrollHeight!==s.offsetHeight){const{scrollHeight:i,scrollTop:r,clientHeight:a}=s;if(!(t>0&&Math.abs(i-a-r)<1)&&!(t<0&&r<=0))return}s=s.parentElement}e.cancelable&&e.preventDefault()}}I([R({defaultValue:"0px"})],vi.prototype,"top",void 0),I([R({defaultValue:"0px"})],vi.prototype,"left",void 0),I([R({defaultValue:"auto"})],vi.prototype,"height",void 0),I([R({defaultValue:"auto"})],vi.prototype,"width",void 0),I([R({defaultValue:"auto"})],vi.prototype,"minWidth",void 0),I([R({defaultValue:!1})],vi.prototype,"_isVisible",void 0),I([R()],vi.prototype,"locale",void 0);class Ud{constructor(e,t,s,i){this.x=e,this.y=t,this.width=s,this.height=i}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}}class Ys{static calculatePosition(e,t,s,i,r,a="flex"){let o=e.left,l=e.top;return a==="flex"&&(r=="center"?o=(e.left+e.right-s)/2:r=="left"?o=e.left-s:o=e.right),i=="middle"?l=(e.top+e.bottom-t)/2:i=="top"?l=e.top-t:l=e.bottom,r!="center"&&i!="middle"&&(i=="top"?l=l+e.height:l=l-e.height),{left:Math.round(o),top:Math.round(l)}}static getCorrectedVerticalDimensions(e,t,s,i,r=!0,a={top:0,bottom:0}){let o;const l=s-Ys.bottomIndent;if(i==="top"&&(o={height:t,top:e}),e<-a.top)o={height:r?t+e:t,top:-a.top};else if(t+e>s){let u=Math.min(t,l-e);o={height:r?u:t,top:r?e:e-(t-u)}}return o&&(o.height=Math.min(o.height,l),o.top=Math.max(o.top,-a.top)),o}static updateHorizontalDimensions(e,t,s,i,r="flex",a={left:0,right:0}){t+=a.left+a.right;let o,l=e;return i==="center"&&(r==="fixed"?(e+t>s&&(o=s-e),l-=a.left):e<0?(l=a.left,o=Math.min(t,s)):t+e>s&&(l=s-t,l=Math.max(l,a.left),o=Math.min(t,s))),i==="left"&&e<0&&(l=a.left,o=Math.min(t,s)),i==="right"&&t+e>s&&(o=s-e),{width:o-a.left-a.right,left:l}}static updateVerticalPosition(e,t,s,i,r){if(i==="middle")return i;let a=t-(e.top+(s!=="center"?e.height:0)),o=t+e.bottom-(s!=="center"?e.height:0)-r;return a>0&&o<=0&&i=="top"?i="bottom":o>0&&a<=0&&i=="bottom"?i="top":o>0&&a>0&&(i=a<o?"top":"bottom"),i}static updateHorizontalPosition(e,t,s,i){if(s==="center")return s;let r=t-e.left,a=t+e.right-i;return r>0&&a<=0&&s=="left"?s="right":a>0&&r<=0&&s=="right"?s="left":a>0&&r>0&&(s=r<a?"left":"right"),s}static calculatePopupDirection(e,t){var s;return t=="center"&&e!="middle"?s=e:t!="center"&&(s=t),s}static calculatePointerTarget(e,t,s,i,r,a=0,o=0){var l={};return r!="center"?(l.top=e.top+e.height/2,l.left=e[r]):i!="middle"&&(l.top=e[i],l.left=e.left+e.width/2),l.left=Math.round(l.left-s),l.top=Math.round(l.top-t),r=="left"&&(l.left-=a+o),r==="center"&&(l.left-=a),l}}Ys.bottomIndent=16;class Cl extends vi{createFooterActionBar(){super.createFooterActionBar(),this.footerToolbar.setCssClasses({root:Os.root,defaultSizeMode:Os.defaultSizeMode,smallSizeMode:Os.smallSizeMode,item:"sd-action sv-menu-popup__button"},!1),this.footerToolbar.containerCss="sv-menu-footer-action-bar";let e=[{id:"cancel",visibleIndex:10,title:this.cancelButtonText,innerCss:"sv-popup__button--cancel",action:()=>{this.cancel()}}];e=this.model.updateFooterActions(e),this.footerToolbarValue.setItems(e)}getAvailableAreaRect(){const e=this.model.getAreaCallback?this.model.getAreaCallback(this.container):void 0;if(e){const t=e.getBoundingClientRect();return new Ud(t.x,t.y,t.width,t.height)}return new Ud(0,0,he.getInnerWidth(),he.getInnerHeight())}getTargetElementRect(e){const t=this.container;let s=this.model.getTargetCallback?this.model.getTargetCallback(t):void 0;if(t&&t.parentElement&&!this.isModal&&!s&&(s=t.parentElement),!s)return null;const i=s.getBoundingClientRect();return new Ud(i.left-e.left,i.top-e.top,i.width,i.height)}_updatePosition(){var e,t,s;const i=this.getAvailableAreaRect(),r=this.getTargetElementRect(i);if(!r)return;const a=(e=this.container)===null||e===void 0?void 0:e.querySelector(this.containerSelector);if(!a)return;const o=(t=this.container)===null||t===void 0?void 0:t.querySelector(this.fixedPopupContainer),l=a.querySelector(this.scrollingContentSelector),u=oe.getComputedStyle(a),d=parseFloat(u.marginLeft)||0,h=parseFloat(u.marginRight)||0,f=parseFloat(u.marginTop)||0,C=parseFloat(u.marginBottom)||0;let b=a.offsetHeight-l.offsetHeight+l.scrollHeight;const x=a.getBoundingClientRect().width;this.model.setWidthByTarget&&(this.minWidth=r.width+"px");let V=this.model.verticalPosition,P=this.getActualHorizontalPosition();if(he.isAvailable()){const X=[b,he.getInnerHeight()*.9,(s=he.getVisualViewport())===null||s===void 0?void 0:s.height];b=Math.ceil(Math.min(...X.filter(N=>typeof N=="number"))),V=Ys.updateVerticalPosition(r,b,this.model.horizontalPosition,this.model.verticalPosition,i.height),P=Ys.updateHorizontalPosition(r,x,P,i.width)}this.popupDirection=Ys.calculatePopupDirection(V,P);const M=Ys.calculatePosition(r,b,x+d+h,V,P,this.model.positionMode);if(he.isAvailable()){const X=Ys.getCorrectedVerticalDimensions(M.top,b,i.height,V,this.model.canShrink,{top:f,bottom:C});if(X&&(this.height=X.height+"px",M.top=X.top),this.model.setWidthByTarget)this.width=r.width+"px",M.left=r.left;else{const N=Ys.updateHorizontalDimensions(M.left,x,he.getInnerWidth(),P,this.model.positionMode,{left:d,right:h});N&&(this.width=N.width?N.width+"px":void 0,M.left=N.left)}}if(o){const X=o.getBoundingClientRect();M.top-=X.top,M.left-=X.left}this.showHeader&&(this.pointerTarget=Ys.calculatePointerTarget(r,M.top,M.left,V,P,d,h),this.pointerTarget.top+="px",this.pointerTarget.left+="px"),M.left+=i.left,M.top+=i.top,this.left=M.left+"px",this.top=M.top+"px"}getActualHorizontalPosition(){let e=this.model.horizontalPosition;return oe.isAvailable()&&oe.getComputedStyle(oe.getBody()).direction=="rtl"&&(this.model.horizontalPosition==="left"?e="right":this.model.horizontalPosition==="right"&&(e="left")),e}getStyleClass(){const e=this.model.getDisplayMode();return super.getStyleClass().append("sv-popup--menu-phone",e==="menu-overlay").append("sv-popup--menu-tablet",e==="menu-popup-overlay").append("sv-popup--menu-popup",e==="menu-popup").append("sv-popup--show-pointer",e==="menu-popup"&&this.showHeader).append(`sv-popup--${this.popupDirection}`,e==="menu-popup"&&(this.showHeader||this.popupDirection=="top"||this.popupDirection=="bottom"))}getShowHeader(){return this.model.showPointer&&!this.isOverlay}getPopupHeaderTemplate(){return"popup-pointer"}constructor(e){super(e),this.scrollEventCallBack=t=>{if(this.isOverlay&&vt){t.stopPropagation(),t.preventDefault();return}this.hidePopup()},this.resizeEventCallback=()=>{if(!he.isAvailable())return;const t=he.getVisualViewport(),s=oe.getDocumentElement();s&&t&&s.style.setProperty("--sv-popup-overlay-height",`${t.height*t.scale}px`)},this.resizeWindowCallback=()=>{this.isOverlay||this.updatePosition(!0,Ie.platform==="vue"||Ie.platform==="vue3"||Ie.platform=="react"||Ie.platform=="js-ui")},this.clientY=0,this.touchStartEventCallback=t=>{this.clientY=t.touches[0].clientY},this.touchMoveEventCallback=t=>{this.preventScrollOuside(t,this.clientY-t.changedTouches[0].clientY)},this.model.onRecalculatePosition.add(this.recalculatePositionHandler)}setComponentElement(e){super.setComponentElement(e)}resetComponentElement(){super.resetComponentElement()}updateOnShowing(){const{root:e}=D.environment;this.prevActiveElement=e.activeElement,this.isOverlay?this.resetDimensionsAndPositionStyleProperties():this.updatePosition(!0,!1),this.switchFocus(),he.addEventListener("resize",this.resizeWindowCallback),this.shouldCreateResizeCallback&&(he.getVisualViewport().addEventListener("resize",this.resizeEventCallback),this.container&&(this.container.addEventListener("touchstart",this.touchStartEventCallback),this.container.addEventListener("touchmove",this.touchMoveEventCallback)),this.resizeEventCallback()),he.addEventListener("scroll",this.scrollEventCallBack),this._isPositionSetValue=!0}get shouldCreateResizeCallback(){return!!he.getVisualViewport()&&this.isOverlay}updatePosition(e,t=!0){e&&(this.height="auto"),t?setTimeout(()=>{this._updatePosition()},1):this._updatePosition()}updateOnHiding(){super.updateOnHiding(),he.removeEventListener("resize",this.resizeWindowCallback),this.shouldCreateResizeCallback&&(he.getVisualViewport().removeEventListener("resize",this.resizeEventCallback),this.container&&(this.container.removeEventListener("touchstart",this.touchStartEventCallback),this.container.removeEventListener("touchmove",this.touchMoveEventCallback))),he.removeEventListener("scroll",this.scrollEventCallBack),this.isDisposed||(this.top=void 0,this.left=void 0,this.height=void 0,this.width=void 0,this.minWidth=void 0)}onModelChanging(e){this.model&&this.model.onRecalculatePosition.remove(this.recalculatePositionHandler),this.recalculatePositionHandler||(this.recalculatePositionHandler=(t,s)=>{this.isOverlay||this.updatePosition(s.isResetHeight)}),super.onModelChanging(e),e.onRecalculatePosition.add(this.recalculatePositionHandler)}dispose(){super.dispose(),this.updateOnHiding(),this.model&&(this.model.onRecalculatePosition.remove(this.recalculatePositionHandler),this.recalculatePositionHandler=void 0),this.resetComponentElement()}}Cl.tabletSizeBreakpoint=600,I([R({defaultValue:"left"})],Cl.prototype,"popupDirection",void 0),I([R({defaultValue:{left:"0px",top:"0px"}})],Cl.prototype,"pointerTarget",void 0);class pb extends vi{getStyleClass(){const e=this.model.getDisplayMode();return super.getStyleClass().append("sv-popup--modal-popup",e==="modal-popup").append("sv-popup--modal-overlay",e==="modal-overlay")}getShowFooter(){return!0}createFooterActionBar(){super.createFooterActionBar(),this.footerToolbar.setCssClasses({root:Os.root,defaultSizeMode:Os.defaultSizeMode,smallSizeMode:Os.smallSizeMode,item:"sv-popup__body-footer-item sv-popup__button sv-modal-popup__button sd-btn sd-btn--small"},!1),this.footerToolbar.containerCss="sv-modal-footer-action-bar";let e=[{id:"cancel",visibleIndex:10,title:this.cancelButtonText,innerCss:"sv-popup__button--cancel",action:()=>{this.cancel()}},{id:"apply",visibleIndex:20,title:this.applyButtonText,innerCss:"sv-popup__button--apply sd-btn--action",action:()=>{this.apply()}}];e=this.model.updateFooterActions(e),this.footerToolbarValue.setItems(e)}constructor(e){super(e),this.onScrollOutsideCallback=t=>{this.preventScrollOuside(t,t.deltaY)}}get applyButtonText(){return this.getLocalizationString("modalApplyButtonText")}apply(){this.model.onApply&&!this.model.onApply()||this.hidePopup()}clickOutside(){}onKeyDown(e){(e.key==="Escape"||e.keyCode===27)&&this.model.onCancel(),super.onKeyDown(e)}updateOnShowing(){this.container&&this.container.addEventListener("wheel",this.onScrollOutsideCallback,{passive:!1}),super.updateOnShowing()}updateOnHiding(){this.container&&this.container.removeEventListener("wheel",this.onScrollOutsideCallback),super.updateOnHiding()}}function r7(n,e){var t;const s=Object.assign({},n);s.verticalPosition="top",s.horizontalPosition="left",s.showPointer=!1,s.isModal=!0,s.displayMode=n.displayMode||"popup";const i=new Mt(n.componentName,n.data,s);i.isFocusedContent=(t=n.isFocusedContent)!==null&&t!==void 0?t:!0;const r=new pb(i);if(e&&e.appendChild){var a=oe.createElement("div");e.appendChild(a),r.setComponentElement(a)}r.container||r.initializePopupContainer();const o=(l,u)=>{u.isVisible||a&&r.resetComponentElement(),r.onVisibilityChanged.remove(o)};return r.onVisibilityChanged.add(o),r}function n7(n){return n.isModal?new pb(n):new Cl(n)}class bl extends hl{getBaseType(){return"buttongroupitemvalue"}}I([R()],bl.prototype,"iconName",void 0),I([R()],bl.prototype,"iconSize",void 0),I([R()],bl.prototype,"showCaption",void 0);class gb extends dl{constructor(e){super(e),this._allowClear=!0,this.createLocString({name:"buttongroupOptionsCaption",hasTranslation:!0}),this.createLocalizableString("readOnlyText",this,!0),this.registerPropertyChangedHandlers(["value","renderAs","placeholder","choices","visibleChoices"],()=>{this.updateReadOnlyText()}),this.updateReadOnlyText()}locStrsChanged(){var e;super.locStrsChanged(),this.updateReadOnlyText(),(e=this.dropdownListModelValue)===null||e===void 0||e.locStrsChanged()}updateReadOnlyText(){this.readOnlyText=this.displayValue||this.placeholder}getType(){return"buttongroup"}getItemValueType(){return"buttongroupitemvalue"}supportOther(){return!1}getControlClass(){return this.isEmpty(),new j().append(this.cssClasses.control).append(this.cssClasses.controlEmpty,this.isEmpty()).append(this.cssClasses.onError,this.hasCssError()).append(this.cssClasses.controlDisabled,this.isDisabledStyle).append(this.cssClasses.controlReadOnly,this.isReadOnlyStyle).append(this.cssClasses.controlPreview,this.isPreviewStyle).toString()}getFirstInputElementId(){return this.inputId+"_0"}getInputId(e){return this.inputId+"_"+e}get placeholder(){return this.getLocalizableStringText("buttongroupOptionsCaption")}set placeholder(e){this.setLocalizableStringText("buttongroupOptionsCaption",e)}get locPlaceholder(){return this.getLocalizableString("buttongroupOptionsCaption")}get allowClear(){return this._allowClear}set allowClear(e){this._allowClear=e}get searchEnabled(){return!1}isItemSelected(e){return e.value==this.value}get readOnlyText(){return this.getLocalizableStringText("readOnlyText")}set readOnlyText(e){this.setLocalizableStringText("readOnlyText",e)}get locReadOnlyText(){return this.getLocalizableString("readOnlyText")}get showSelectedItemLocText(){return!this.readOnly&&!this.inputHasValue&&!!this.selectedItemLocText}get selectedItemLocText(){var e;return(e=this.selectedItem)===null||e===void 0?void 0:e.locText}set dropdownListModel(e){this.dropdownListModelValue=e,this.updateElementCss()}get dropdownListModel(){return this.renderAs==="dropdown"&&this.onBeforeSetCompactRenderer(),this.dropdownListModelValue}get selectedItem(){return this.getSingleSelectedItem()}onBlurCore(e){var t;(t=this.dropdownListModel)===null||t===void 0||t.onBlur(e),super.onBlurCore(e)}updateCssClasses(e,t){super.updateCssClasses(e,t),Xo(e,t)}calcCssClasses(e){const t=super.calcCssClasses(e);return this.dropdownListModelValue&&this.dropdownListModelValue.updateCssClasses(t.popup,t.list),t}needResponsiveWidth(){return!0}supportResponsiveness(){return!0}getCompactRenderAs(){return"dropdown"}getObservedElementSelector(){return".sd-button-group-scrollable-container"}onBeforeSetCompactRenderer(){!this.isDisposed&&!this.dropdownListModelValue&&(this.dropdownListModelValue=new Wt(this))}dispose(){super.dispose(),this.dropdownListModelValue&&(this.dropdownListModelValue.dispose(),this.dropdownListModelValue=void 0)}}I([R({defaultValue:!1})],gb.prototype,"inputHasValue",void 0),B.addClass("buttongroup",[{name:"choices:buttongroupitemvalue[]"}],function(){return new gb("")},"checkboxbase"),B.addClass("buttongroupitemvalue",[{name:"showCaption:boolean",default:!0},{name:"iconName:text"},{name:"iconSize:number"}],n=>new bl(n),"choiceitem");class a7{constructor(e,t,s){this.question=e,this.item=t,this.index=s}get value(){return this.item.value}get iconName(){return this.item.iconName}get iconSize(){return this.item.iconSize||24}get caption(){return this.item.locText}get showCaption(){return this.item.showCaption||this.item.showCaption===void 0}get isRequired(){return this.question.isRequired}get selected(){return this.question.isItemSelected(this.item)}get readOnly(){return this.question.isInputReadOnly||!this.item.isEnabled}get name(){return this.question.name+"_"+this.question.id}get id(){return this.question.inputId+"_"+this.index}get hasErrors(){return this.question.errors.length>0}get describedBy(){return this.question.errors.length>0?this.question.id+"_errors":null}get labelClass(){return new j().append(this.question.cssClasses.item).append(this.question.cssClasses.itemSelected,this.selected).append(this.question.cssClasses.itemHover,!this.readOnly&&!this.selected).append(this.question.cssClasses.itemDisabled,this.question.isReadOnly||!this.item.isEnabled).toString()}get css(){return{label:this.labelClass,icon:this.question.cssClasses.itemIcon,control:this.question.cssClasses.itemControl,caption:this.question.cssClasses.itemCaption,decorator:this.question.cssClasses.itemDecorator}}onChange(){this.question.selectItem(this.item)}}class wl extends de{getSurvey(e=!1){var t;return(t=this.owner)===null||t===void 0?void 0:t.getSurvey()}getType(){return"masksettings"}setData(e){B.getProperties(this.getType()).forEach(s=>{const i=e[s.name];this[s.name]=i!==void 0?i:s.getDefaultValue(this)})}getData(){const e={};return B.getProperties(this.getType()).forEach(s=>{const i=this[s.name];s.isDefaultValue(i)||(e[s.name]=i)}),e}processInput(e){return{value:e.prevValue,caretPosition:e.selectionEnd,cancelPreventDefault:!1}}getUnmaskedValue(e){return e}getMaskedValue(e){return e}getTextAlignment(){return"auto"}getTypeForExpressions(){return"text"}}I([R()],wl.prototype,"saveMaskedValue",void 0),B.addClass("masksettings",[{name:"saveMaskedValue:boolean",visibleIf:function(n){return n?n.getType()!=="masksettings":!1}}],function(){return new wl});function Wd(n){const e=[];let t=!1;const s=Object.keys(D.maskSettings.patternDefinitions);for(let i=0;i<n.length;i++){const r=n[i];r===D.maskSettings.patternEscapeChar?t=!0:t?(t=!1,e.push({type:"fixed",value:r})):e.push({type:s.indexOf(r)!==-1?"regex":"const",value:r})}return e}function o7(n,e,t){const s=D.maskSettings.patternDefinitions[t.value];for(;e<n.length;){if(n[e].match(s))return e;e++}return e}function l7(n,e,t){const s=n??"";let i="",r=0;const a=typeof e=="string"?Wd(e):e;for(let o=0;o<a.length;o++)switch(a[o].type){case"regex":if(r<s.length&&(r=o7(s,r,a[o])),r<s.length)i+=s[r];else if(t)i+=D.maskSettings.patternPlaceholderChar;else return i;r++;break;case"const":case"fixed":i+=a[o].value,a[o].value===s[r]&&r++;break}return i}function $d(n,e,t,s=!1){let i="";if(!n)return i;let r=typeof e=="string"?Wd(e):e;for(let a=0;a<r.length;a++)if(r[a].type==="fixed"&&!s&&(i+=r[a].value),r[a].type==="regex"){const o=D.maskSettings.patternDefinitions[r[a].value];if(n[a]&&n[a].match(o))i+=n[a];else if(t){i="";break}else break}return i}class Gd extends wl{constructor(){super(...arguments),this.literals=[]}updateLiterals(){this.literals=Wd(this.pattern||"")}onPropertyValueChanged(e,t,s){super.onPropertyValueChanged(e,t,s),e==="pattern"&&this.updateLiterals()}getType(){return"patternmask"}fromJSON(e,t){super.fromJSON(e,t),this.updateLiterals()}_getMaskedValue(e,t=!1){return l7(e??"",this.literals,t)}_getUnmaskedValue(e,t=!1){return $d(e??"",this.literals,t)}processInput(e){const t={value:e.prevValue,caretPosition:e.selectionEnd,cancelPreventDefault:!1};if(!e.insertedChars&&e.selectionStart===e.selectionEnd)return t;const s=e.prevValue.slice(0,e.selectionStart)+(e.insertedChars||""),i=$d(e.prevValue.slice(0,e.selectionStart),this.literals.slice(0,e.selectionStart),!1),r=$d(e.prevValue.slice(e.selectionEnd),this.literals.slice(e.selectionEnd),!1,!0);return t.value=this._getMaskedValue(i+(e.insertedChars||"")+r,!0),!e.insertedChars&&e.inputDirection==="backward"?t.caretPosition=e.selectionStart:t.caretPosition=this._getMaskedValue(s).length,t}getMaskedValue(e){return this._getMaskedValue(e,!0)}getUnmaskedValue(e){return this._getUnmaskedValue(e,!0)}}I([R()],Gd.prototype,"pattern",void 0),B.addClass("patternmask",[{name:"pattern"}],function(){return new Gd},"masksettings");function u7(n,e=!0,t=3){let s=[];if(e){for(let i=n.length-t;i>-t;i-=t)s.push(n.substring(i,i+t));s=s.reverse()}else for(let i=0;i<n.length;i+=t)s.push(n.substring(i,i+t));return s}class Fi extends wl{calccaretPosition(e,t,s){const i=e?this.displayNumber(this.parseNumber(e),!1).length:0;let r=0,a=t.selectionStart;const o=!t.insertedChars&&t.inputDirection==="forward";for(let l=0;l<s.length;l++)if(s[l]!==this.thousandsSeparator&&r++,r===i+(o?1:0)){o?a=l:a=l+1;break}return a}numericalCompositionIsEmpty(e){return!e.integralPart&&!e.fractionalPart}displayNumber(e,t=!0,s=!1){let i=e.integralPart;t&&i&&(i=u7(i).join(this.thousandsSeparator));let r=e.fractionalPart;const a=e.isNegative?"-":"";if(r===""){if(s)return!i||i==="0"?i:a+i;{const o=e.hasDecimalSeparator&&!s?this.decimalSeparator:"",l=i+o;return l==="0"?l:a+l}}else return i=i||"0",r=r.substring(0,this.precision),[a+i,r].join(this.decimalSeparator)}convertNumber(e){let t;const s=e.isNegative?"-":"";return e.fractionalPart?t=parseFloat(s+(e.integralPart||"0")+"."+e.fractionalPart.substring(0,this.precision)):t=parseInt(s+e.integralPart||"0"),t}validateNumber(e,t){const s=this.min||Number.MIN_SAFE_INTEGER,i=this.max||Number.MAX_SAFE_INTEGER;if(this.numericalCompositionIsEmpty(e))return!0;if(this.min!==void 0||this.max!==void 0){let r=this.convertNumber(e);if(Number.isNaN(r)||r>=s&&r<=i)return!0;if(!t){if(!e.hasDecimalSeparator&&r!=0){let a=r,o=r;if(r>0){if(r+1>s&&r<=i)return!0;for(;a=a*10+9,o=o*10,!(o>i);)if(a>s)return!0;return!1}if(r<0){if(r>=s&&r-1<i)return!0;for(;a=a*10,o=o*10-9,!(a<s);)if(o<i)return!0;return!1}}else{const a=Math.pow(.1,(e.fractionalPart||"").length);if(r>=0)return r+a>s&&r<=i;if(r<0)return r>=s&&r-a<i}return r>=0&&r<=i||r<0&&r>=s}return!1}return!0}parseNumber(e){const t={integralPart:"",fractionalPart:"",hasDecimalSeparator:!1,isNegative:!1},s=e==null?"":e.toString();let i=0;for(let r=0;r<s.length;r++){const a=s[r];switch(a){case"-":{this.allowNegativeValues&&(this.min===void 0||this.min<0)&&i++;break}case this.decimalSeparator:{this.precision>0&&(t.hasDecimalSeparator=!0);break}case this.thousandsSeparator:break;default:a.match(Bd)&&(t.hasDecimalSeparator?t.fractionalPart+=a:t.integralPart+=a)}}return t.isNegative=i%2!==0,t.integralPart.length>1&&t.integralPart[0]==="0"&&(t.integralPart=t.integralPart.slice(1)),t}getNumberMaskedValue(e,t=!1){const s=this.parseNumber(e);return this.validateNumber(s,t)?this.displayNumber(s,!0,t):null}getNumberUnmaskedValue(e){const t=this.parseNumber(e);if(!this.numericalCompositionIsEmpty(t))return this.convertNumber(t)}getTextAlignment(){return"right"}getMaskedValue(e){let t=e==null?"":e.toString();return t=t.replace(".",this.decimalSeparator),this.getNumberMaskedValue(t,!0)}getUnmaskedValue(e){return this.getNumberUnmaskedValue(e)}processInput(e){const t={value:e.prevValue,caretPosition:e.selectionEnd,cancelPreventDefault:!1},s=e.prevValue.slice(0,e.selectionStart)+(e.insertedChars||""),i=e.prevValue.slice(e.selectionEnd),r=s+i,a=this.parseNumber(r);if(!this.validateNumber(a,!1))return t;const o=this.getNumberMaskedValue(r),l=this.calccaretPosition(s,e,o);return t.value=o,t.caretPosition=l,t}getType(){return"numericmask"}isValueUndefined(e){return e===""||super.isValueUndefined(e)}}I([R()],Fi.prototype,"allowNegativeValues",void 0),I([R()],Fi.prototype,"decimalSeparator",void 0),I([R()],Fi.prototype,"precision",void 0),I([R()],Fi.prototype,"thousandsSeparator",void 0),I([R()],Fi.prototype,"min",void 0),I([R()],Fi.prototype,"max",void 0),B.addClass("numericmask",[{name:"allowNegativeValues:boolean",default:!0},{name:"decimalSeparator",default:".",maxLength:1},{name:"thousandsSeparator",default:",",maxLength:1},{name:"precision:number",default:2,minValue:0},{name:"min:number"},{name:"max:number"}],function(){return new Fi},"masksettings");function mb(n,e){switch(n){case"hour":case"minute":case"second":case"day":case"month":return 2;case"timeMarker":case"year":return e;default:return 1}}function h7(n,e){let t=e;return n.count<n.maxCount&&(n.type==="day"&&parseInt(e[0])===0||n.type==="month"&&parseInt(e[0])===0)&&(t=e.slice(1,e.length)),t}function d7(n){const e=[];let t;const s=(i,r,a=!1)=>{if(t&&t===i){e[e.length-1].count++;const o=mb(i,e[e.length-1].count);e[e.length-1].maxCount=o}else{const o=mb(i,1);e.push({type:i,value:r,count:1,maxCount:o,upperCase:a})}};for(let i=0;i<n.length;i++){const r=n[i];switch(r){case"m":s("month",r);break;case"d":s("day",r);break;case"y":s("year",r);break;case"h":s("hour",r,!1);break;case"H":s("hour",r,!0);break;case"M":s("minute",r);break;case"s":s("second",r);break;case"t":s("timeMarker",r);break;case"T":s("timeMarker",r,!0);break;default:e.push({type:"separator",value:r,count:1,maxCount:1,upperCase:!1});break}t=e[e.length-1].type}return e}class Jd extends Gd{constructor(){super(...arguments),this.defaultDate="1970-01-01T",this.turnOfTheCentury=68,this.twelve=12,this.lexems=[],this.inputDateTimeData=[],this.validBeginningOfNumbers={hour:1,hourU:2,minute:5,second:5,day:3,month:1}}get hasDatePart(){return this.lexems.some(e=>e.type==="day"||e.type==="month"||e.type==="year")}get hasTimePart(){return this.lexems.some(e=>e.type==="hour"||e.type==="minute"||e.type==="second")}get is12Hours(){return this.lexems.filter(e=>e.type==="hour"&&!e.upperCase).length>0}getType(){return"datetimemask"}getTypeForExpressions(){return this.hasTimePart?"datetime-local":"datetime"}updateLiterals(){this.lexems=d7(this.pattern||"")}leaveOnlyNumbers(e){let t="";for(let s=0;s<e.length;s++)e[s].match(Bd)&&(t+=e[s]);return t}getMaskedStrFromISO(e){let t=new Date(e);return this.initInputDateTimeData(),this.hasTimePart||(t=new Date(e+"T00:00:00")),this.hasDatePart||(t=new Date(this.defaultDate+e)),isNaN(t)||this.lexems.forEach((s,i)=>{let r=this.inputDateTimeData[i];switch(r.isCompleted=!0,s.type){case"hour":{this.is12Hours?r.value=((t.getHours()-1)%this.twelve+1).toString():r.value=t.getHours().toString();break}case"minute":{r.value=t.getMinutes().toString();break}case"second":{r.value=t.getSeconds().toString();break}case"timeMarker":{const a=t.getHours()>=this.twelve?"pm":"am";r.value=s.upperCase?a.toUpperCase():a;break}case"day":{r.value=t.getDate().toString();break}case"month":{r.value=(t.getMonth()+1).toString();break}case"year":{let a=t.getFullYear();s.count==2&&(a=a%100),r.value=a.toString();break}}}),this.getFormatedString(!0)}initInputDateTimeData(){this.inputDateTimeData=[],this.lexems.forEach(e=>{this.inputDateTimeData.push({lexem:e,isCompleted:!1,value:void 0})})}getISO_8601Format(e){const t=[],s=[];if(e.year!==void 0){const r=this.getPlaceholder(4,e.year.toString(),"0")+e.year;t.push(r)}if(e.month!==void 0&&e.year!==void 0){const r=this.getPlaceholder(2,e.month.toString(),"0")+e.month;t.push(r)}if(e.day!==void 0&&e.month!==void 0&&e.year!==void 0){const r=this.getPlaceholder(2,e.day.toString(),"0")+e.day;t.push(r)}if(e.hour!==void 0){const r=this.getPlaceholder(2,e.hour.toString(),"0")+e.hour;s.push(r)}if(e.minute!==void 0&&e.hour!==void 0){const r=this.getPlaceholder(2,e.minute.toString(),"0")+e.minute;s.push(r)}if(e.second!==void 0&&e.minute!==void 0&&e.hour!==void 0){const r=this.getPlaceholder(2,e.second.toString(),"0")+e.second;s.push(r)}const i=[];return t.length>0&&i.push(t.join("-")),s.length>1&&i.push(s.join(":")),i.join("T")}isYearValid(e){if(e.min===void 0&&e.max===void 0)return!1;const t=e.year.toString(),s=e.min.toISOString().slice(0,t.length),i=e.max.toISOString().slice(0,t.length);return e.year>=parseInt(s)&&e.year<=parseInt(i)}createIDateTimeCompositionWithDefaults(e,t){const s=e.day==29&&e.month==2;let i=e.min.getFullYear(),r=e.max.getFullYear();s&&(i=Math.ceil(i/4)*4,r=Math.floor(r/4)*4,i>r&&(i=void 0,r=void 0));const a=e.year!==void 0?e.year:t?r:i,o=e.month!==void 0?e.month:t&&this.hasDatePart?12:1,l=e.day!==void 0?e.day:t&&this.hasDatePart?this.getMaxDateForMonth(a,o):1,u=e.hour!==void 0?e.hour:t?23:0,d=e.minute!==void 0?e.minute:t?59:0,h=e.second!==void 0?e.second:t?59:0;return{year:a,month:o,day:l,hour:u,minute:d,second:h}}getMaxDateForMonth(e,t){return t==2?e%4==0&&e%100!=0||e%400==0?29:28:[31,28,31,30,31,30,31,31,30,31,30,31][t-1]}isDateValid(e){const t=new Date(this.getISO_8601Format(this.createIDateTimeCompositionWithDefaults(e,!1))),s=new Date(this.getISO_8601Format(this.createIDateTimeCompositionWithDefaults(e,!0)));return!isNaN(t)&&(t.getDate()===e.day||e.day===void 0)&&(t.getMonth()===e.month-1||e.month===void 0)&&(t.getFullYear()===e.year||e.year===void 0)&&s>=e.min&&t<=e.max}getPlaceholder(e,t,s){const i=e-(t||"").length;return i>0?s.repeat(i):""}isDateValid12(e){return this.is12Hours?this.is12Hours&&e.hour>this.twelve?!1:e.timeMarker?e.timeMarker[0].toLowerCase()==="p"?(e.hour!==this.twelve&&(e.hour+=this.twelve),this.isDateValid(e)):(e.hour===this.twelve&&(e.hour=0),this.isDateValid(e)):this.isDateValid(e)?!0:(e.hour+=this.twelve,this.isDateValid(e)):this.isDateValid(e)}updateTimeMarkerInputDateTimeData(e,t){let s=e.value;if(!s)return;const i="timeMarker",r=Object.assign({},t);r[i]=s,this.isDateValid12(r)?e.isCompleted=!0:s=s.slice(0,s.length-1),e.value=s||void 0,t[i]=s||void 0}updateInputDateTimeData(e,t){let s=e.value;if(!s)return;const i=e.lexem.type,r=Object.assign({},t);if(r[i]=parseInt(this.parseTwoDigitYear(e)),s.length===e.lexem.maxCount)if(this.isDateValid12(r)){e.isCompleted=!0,e.value=s||void 0,t[i]=parseInt(s)>0?parseInt(s):void 0;return}else s=s.slice(0,s.length-1);r[i]=parseInt(s);const a=parseInt(s[0]),o=this.validBeginningOfNumbers[i+(e.lexem.upperCase?"U":"")];i==="year"&&!this.isYearValid(r)?(s=s.slice(0,s.length-1),e.isCompleted=!1):o!==void 0&&a>o?this.isDateValid12(r)?e.isCompleted=!0:s=s.slice(0,s.length-1):o!==void 0&&a!==0&&a<=o&&(this.checkValidationDateTimePart(r,i,e),e.isCompleted&&!this.isDateValid12(r)&&(s=s.slice(0,s.length-1))),e.value=s||void 0,t[i]=parseInt(s)>0?parseInt(s):void 0}checkValidationDateTimePart(e,t,s){const i=e[t];let r=i*10,a=10;t==="month"&&(a=3),t==="hour"&&(a=this.is12Hours?3:5),s.isCompleted=!0;for(let o=0;o<a;o++)if(e[t]=r+o,this.isDateValid12(e)){s.isCompleted=!1;break}e[t]=i}getCorrectDatePartFormat(e,t){const s=e.lexem;let i=e.value||"";return i&&s.type==="timeMarker"?(t&&(i=i+this.getPlaceholder(s.count,i,s.value)),i):(i&&e.isCompleted&&(i=parseInt(i).toString()),i&&e.isCompleted?i=this.getPlaceholder(s.count,i,"0")+i:(i=h7(s,i),t&&(i+=this.getPlaceholder(s.count,i,s.value))),i)}createIDateTimeComposition(){let e,t;return this.hasDatePart?(e=this.min||"0001-01-01",t=this.max||"9996-12-31"):(e=this.defaultDate+(this.min||"00:00:00"),t=this.defaultDate+(this.max||"23:59:59")),{hour:void 0,minute:void 0,second:void 0,day:void 0,month:void 0,year:void 0,min:new Date(e),max:new Date(t)}}parseTwoDigitYear(e){const t=e.value;return e.lexem.type!=="year"||e.lexem.count>2?t:(this.max&&this.max.length>=4&&(this.turnOfTheCentury=parseInt(this.max.slice(2,4))),(parseInt(t)>this.turnOfTheCentury?"19":"20")+t)}getFormatedString(e){let t="",s="",i=!1,r=this.inputDateTimeData.length-1;if(!e){const a=this.inputDateTimeData.filter(o=>!!o.value);r=this.inputDateTimeData.indexOf(a[a.length-1])}for(let a=0;a<this.inputDateTimeData.length;a++){const o=this.inputDateTimeData[a];switch(o.lexem.type){case"timeMarker":case"hour":case"minute":case"second":case"day":case"month":case"year":if(o.value===void 0&&!e)return t+=i?s:"",t;{const l=e||r>a,u=this.getCorrectDatePartFormat(o,l);t+=s+u,i=o.isCompleted}break;case"separator":s=o.lexem.value;break}}return t}cleanTimeMarker(e,t){let s="";e=e.toUpperCase();for(let i=0;i<e.length;i++)(!s&&(e[i]=="P"||e[i]=="A")||s&&e[i]=="M")&&(s+=e[i]);return t?s=s.toUpperCase():s=s.toLowerCase(),s}setInputDateTimeData(e){let t=0;this.initInputDateTimeData(),this.lexems.forEach((s,i)=>{if(e.length>0&&t<e.length){if(s.type==="separator")return;const r=this.inputDateTimeData[i],a=e[t];let o;s.type==="timeMarker"?o=this.cleanTimeMarker(a,s.upperCase):o=this.leaveOnlyNumbers(a),r.value=o.slice(0,s.maxCount),t++}})}_getMaskedValue(e,t=!0){let s=e==null?"":e.toString();const i=this.getParts(s);this.setInputDateTimeData(i);const r=this.createIDateTimeComposition();return this.inputDateTimeData.forEach(o=>{o.lexem.type==="timeMarker"?this.updateTimeMarkerInputDateTimeData(o,r):this.updateInputDateTimeData(o,r)}),this.getFormatedString(t)}getParts(e){const t=[],s=this.lexems.filter(l=>l.type!=="separator"),i=this.lexems.filter(l=>l.type==="separator").map(l=>l.value);let r="",a=!1,o=!1;for(let l=0;l<e.length;l++){const u=e[l];if(u.match(Bd)||u===s[t.length].value||s[t.length].type==="timeMarker"?(a=!1,o=!1,r+=u):i.indexOf(u)!==-1?o||(a=!0,t.push(r),r=""):a||(o=!0,t.push(r),r=""),t.length>=s.length){a=!1;break}}return(r!=""||a)&&t.push(r),t}getUnmaskedValue(e){var t;let s=e==null?"":e.toString();const i=this.getParts(s);this.setInputDateTimeData(i);const r=(t=this.inputDateTimeData.filter(l=>l.lexem.type==="timeMarker")[0])===null||t===void 0?void 0:t.value.toLowerCase()[0],a=this.createIDateTimeComposition();let o=!1;return this.inputDateTimeData.forEach(l=>{let u=l.value;if(l.lexem.type=="timeMarker"||l.lexem.type=="separator")return;if(!u||u.length<l.lexem.count){o=!0;return}let d=parseInt(this.parseTwoDigitYear(l));l.lexem.type=="hour"&&r==="p"&&d!=this.twelve&&(d+=this.twelve),a[l.lexem.type]=d}),o?"":this.getISO_8601Format(a)}getMaskedValue(e){return this.getMaskedStrFromISO(e)}processInput(e){const t={value:e.prevValue,caretPosition:e.selectionEnd,cancelPreventDefault:!1},s=e.prevValue.slice(0,e.selectionStart),i=e.prevValue.slice(e.selectionEnd);return t.value=this._getMaskedValue(s+(e.insertedChars||"")+i),!e.insertedChars&&e.inputDirection==="backward"?t.caretPosition=e.selectionStart:t.caretPosition=this._getMaskedValue(s+(e.insertedChars||""),!1).length,t}}I([R()],Jd.prototype,"min",void 0),I([R()],Jd.prototype,"max",void 0),B.addClass("datetimemask",[{name:"min",type:"datetime",enableIf:n=>!!n.pattern},{name:"max",type:"datetime",enableIf:n=>!!n.pattern}],function(){return new Jd},"patternmask");class Kd extends Fi{getType(){return"currencymask"}wrapText(e){const t=this.prefix||"",s=this.suffix||"";let i=e;return i&&(i.indexOf(t)===-1&&(i=t+i),i.indexOf(s)===-1&&(i+=s),i)}unwrapInputArgs(e){let t=e.prevValue;if(t){if(this.prefix&&t.indexOf(this.prefix)!==-1){t=t.slice(t.indexOf(this.prefix)+this.prefix.length);const s=(this.prefix||"").length;e.selectionStart=Math.max(e.selectionStart-s,0),e.selectionEnd-=s}this.suffix&&t.indexOf(this.suffix)!==-1&&(t=t.slice(0,t.indexOf(this.suffix))),e.prevValue=t}}processInput(e){this.unwrapInputArgs(e);const t=super.processInput(e),s=(this.prefix||"").length;return t.value&&(t.caretPosition+=s),t.value=this.wrapText(t.value),t}getMaskedValue(e){const t=super.getMaskedValue(e);return this.wrapText(t)}}I([R()],Kd.prototype,"prefix",void 0),I([R()],Kd.prototype,"suffix",void 0),B.addClass("currencymask",[{name:"prefix"},{name:"suffix"}],()=>new Kd,"numericmask");var xl;xl="2.3.15",D.version=xl;function c7(n,e){if(xl!=n){const t="survey-core has version '"+xl+"' and "+e+" has version '"+n+"'. SurveyJS libraries should have the same versions to work correctly.";console.error(t)}}class p7{constructor(){this.icons={},this.iconPrefix="icon-",this.onIconsChanged=new Xt}processId(e,t){return e.indexOf(t)==0&&(e=e.substring(t.length)),e=f1[e]||e,e}registerIconFromSymbol(e,t){this.icons[e]=t}registerIconFromSvgViaElement(e,t,s=this.iconPrefix){if(!oe.isAvailable())return;e=this.processId(e,s);let i=oe.createElement("div");i.innerHTML=t;let r=oe.createElement("symbol"),a=i.querySelector("svg");r.innerHTML=a.innerHTML;for(var o=0;o<a.attributes.length;o++)r.setAttributeNS("http://www.w3.org/2000/svg",a.attributes[o].name,a.attributes[o].value);r.id=s+e,this.registerIconFromSymbol(e,r.outerHTML)}registerIconFromSvg(e,t,s=this.iconPrefix){e=this.processId(e,s);const i="<svg ",r="</svg>";t=t.trim();const a=t.toLowerCase();return a.substring(0,i.length)===i&&a.substring(a.length-r.length,a.length)===r?(this.registerIconFromSymbol(e,'<symbol id="'+s+e+'" '+t.substring(i.length,a.length-r.length)+"</symbol>"),!0):!1}registerIconsFromFolder(e){e.keys().forEach(t=>{this.registerIconFromSvg(t.substring(2,t.length-4).toLowerCase(),e(t))})}registerIcons(e){for(const t in e)this.registerIconFromSvg(t,e[t]);this.updateMarkup()}registerIcon(e,t,s="v2"){this.registerIconFromSvg(e,t),Yd(s,{[e]:t})}iconsRenderedHtml(){return Object.keys(this.icons).map(e=>this.icons[e]).join("")}updateMarkup(){this.onIconsChanged.fire(this,{})}}const Vl=new p7,Zd={};function Yd(n,e){Zd[n]||(Zd[n]={});const t=Zd[n];for(const s in e)t[s]=e[s]}var Ln,De,fb,rr,yb,vb,Cb,bb,Xd,ec,tc,An={},wb=[],g7=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Dn=Array.isArray;function Xs(n,e){for(var t in e)n[t]=e[t];return n}function sc(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function v(n,e,t){var s,i,r,a={};for(r in e)r=="key"?s=e[r]:r=="ref"?i=e[r]:a[r]=e[r];if(arguments.length>2&&(a.children=arguments.length>3?Ln.call(arguments,2):t),typeof n=="function"&&n.defaultProps!=null)for(r in n.defaultProps)a[r]===void 0&&(a[r]=n.defaultProps[r]);return On(n,a,s,i,null)}function On(n,e,t,s,i){var r={type:n,props:e,key:t,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++fb,__i:-1,__u:0};return i==null&&De.vnode!=null&&De.vnode(r),r}function gt(){return{current:null}}function ke(n){return n.children}function Ye(n,e){this.props=n,this.context=e}function $r(n,e){if(e==null)return n.__?$r(n.__,n.__i+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?$r(n):null}function xb(n){var e,t;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return xb(n)}}function Vb(n){(!n.__d&&(n.__d=!0)&&rr.push(n)&&!Pl.__r++||yb!=De.debounceRendering)&&((yb=De.debounceRendering)||vb)(Pl)}function Pl(){for(var n,e,t,s,i,r,a,o=1;rr.length;)rr.length>o&&rr.sort(Cb),n=rr.shift(),o=rr.length,n.__d&&(t=void 0,s=void 0,i=(s=(e=n).__v).__e,r=[],a=[],e.__P&&((t=Xs({},s)).__v=s.__v+1,De.vnode&&De.vnode(t),ic(e.__P,t,s,e.__n,e.__P.namespaceURI,32&s.__u?[i]:null,r,i??$r(s),!!(32&s.__u),a),t.__v=s.__v,t.__.__k[t.__i]=t,Eb(r,t,a),s.__e=s.__=null,t.__e!=i&&xb(t)));Pl.__r=0}function Pb(n,e,t,s,i,r,a,o,l,u,d){var h,f,C,b,x,V,P,M=s&&s.__k||wb,X=e.length;for(l=m7(t,e,M,l,X),h=0;h<X;h++)(C=t.__k[h])!=null&&(f=C.__i==-1?An:M[C.__i]||An,C.__i=h,V=ic(n,C,f,i,r,a,o,l,u,d),b=C.__e,C.ref&&f.ref!=C.ref&&(f.ref&&nc(f.ref,null,C),d.push(C.ref,C.__c||b,C)),x==null&&b!=null&&(x=b),(P=!!(4&C.__u))||f.__k===C.__k?l=Sb(C,l,n,P):typeof C.type=="function"&&V!==void 0?l=V:b&&(l=b.nextSibling),C.__u&=-7);return t.__e=x,l}function m7(n,e,t,s,i){var r,a,o,l,u,d=t.length,h=d,f=0;for(n.__k=new Array(i),r=0;r<i;r++)(a=e[r])!=null&&typeof a!="boolean"&&typeof a!="function"?(l=r+f,(a=n.__k[r]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?On(null,a,null,null,null):Dn(a)?On(ke,{children:a},null,null,null):a.constructor==null&&a.__b>0?On(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=n,a.__b=n.__b+1,o=null,(u=a.__i=f7(a,t,l,h))!=-1&&(h--,(o=t[u])&&(o.__u|=2)),o==null||o.__v==null?(u==-1&&(i>d?f--:i<d&&f++),typeof a.type!="function"&&(a.__u|=4)):u!=l&&(u==l-1?f--:u==l+1?f++:(u>l?f--:f++,a.__u|=4))):n.__k[r]=null;if(h)for(r=0;r<d;r++)(o=t[r])!=null&&(2&o.__u)==0&&(o.__e==s&&(s=$r(o)),_b(o,o));return s}function Sb(n,e,t,s){var i,r;if(typeof n.type=="function"){for(i=n.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=n,e=Sb(i[r],e,t,s));return e}n.__e!=e&&(s&&(e&&n.type&&!e.parentNode&&(e=$r(n)),t.insertBefore(n.__e,e||null)),e=n.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Sl(n,e){return e=e||[],n==null||typeof n=="boolean"||(Dn(n)?n.some(function(t){Sl(t,e)}):e.push(n)),e}function f7(n,e,t,s){var i,r,a,o=n.key,l=n.type,u=e[t],d=u!=null&&(2&u.__u)==0;if(u===null&&n.key==null||d&&o==u.key&&l==u.type)return t;if(s>(d?1:0)){for(i=t-1,r=t+1;i>=0||r<e.length;)if((u=e[a=i>=0?i--:r++])!=null&&(2&u.__u)==0&&o==u.key&&l==u.type)return a}return-1}function Ib(n,e,t){e[0]=="-"?n.setProperty(e,t??""):n[e]=t==null?"":typeof t!="number"||g7.test(e)?t:t+"px"}function Il(n,e,t,s,i){var r,a;e:if(e=="style")if(typeof t=="string")n.style.cssText=t;else{if(typeof s=="string"&&(n.style.cssText=s=""),s)for(e in s)t&&e in t||Ib(n.style,e,"");if(t)for(e in t)s&&t[e]==s[e]||Ib(n.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")r=e!=(e=e.replace(bb,"$1")),a=e.toLowerCase(),e=a in n||e=="onFocusOut"||e=="onFocusIn"?a.slice(2):e.slice(2),n.l||(n.l={}),n.l[e+r]=t,t?s?t.u=s.u:(t.u=Xd,n.addEventListener(e,r?tc:ec,r)):n.removeEventListener(e,r?tc:ec,r);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in n)try{n[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?n.removeAttribute(e):n.setAttribute(e,e=="popover"&&t==1?"":t))}}function Tb(n){return function(e){if(this.l){var t=this.l[e.type+n];if(e.t==null)e.t=Xd++;else if(e.t<t.u)return;return t(De.event?De.event(e):e)}}}function ic(n,e,t,s,i,r,a,o,l,u){var d,h,f,C,b,x,V,P,M,X,N,W,J,ie,ne,ce,ye,le=e.type;if(e.constructor!=null)return null;128&t.__u&&(l=!!(32&t.__u),r=[o=e.__e=t.__e]),(d=De.__b)&&d(e);e:if(typeof le=="function")try{if(P=e.props,M="prototype"in le&&le.prototype.render,X=(d=le.contextType)&&s[d.__c],N=d?X?X.props.value:d.__:s,t.__c?V=(h=e.__c=t.__c).__=h.__E:(M?e.__c=h=new le(P,N):(e.__c=h=new Ye(P,N),h.constructor=le,h.render=v7),X&&X.sub(h),h.props=P,h.state||(h.state={}),h.context=N,h.__n=s,f=h.__d=!0,h.__h=[],h._sb=[]),M&&h.__s==null&&(h.__s=h.state),M&&le.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=Xs({},h.__s)),Xs(h.__s,le.getDerivedStateFromProps(P,h.__s))),C=h.props,b=h.state,h.__v=e,f)M&&le.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),M&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(M&&le.getDerivedStateFromProps==null&&P!==C&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(P,N),!h.__e&&h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(P,h.__s,N)===!1||e.__v==t.__v){for(e.__v!=t.__v&&(h.props=P,h.state=h.__s,h.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(be){be&&(be.__=e)}),W=0;W<h._sb.length;W++)h.__h.push(h._sb[W]);h._sb=[],h.__h.length&&a.push(h);break e}h.componentWillUpdate!=null&&h.componentWillUpdate(P,h.__s,N),M&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(C,b,x)})}if(h.context=N,h.props=P,h.__P=n,h.__e=!1,J=De.__r,ie=0,M){for(h.state=h.__s,h.__d=!1,J&&J(e),d=h.render(h.props,h.state,h.context),ne=0;ne<h._sb.length;ne++)h.__h.push(h._sb[ne]);h._sb=[]}else do h.__d=!1,J&&J(e),d=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++ie<25);h.state=h.__s,h.getChildContext!=null&&(s=Xs(Xs({},s),h.getChildContext())),M&&!f&&h.getSnapshotBeforeUpdate!=null&&(x=h.getSnapshotBeforeUpdate(C,b)),ce=d,d!=null&&d.type===ke&&d.key==null&&(ce=Rb(d.props.children)),o=Pb(n,Dn(ce)?ce:[ce],e,t,s,i,r,a,o,l,u),h.base=e.__e,e.__u&=-161,h.__h.length&&a.push(h),V&&(h.__E=h.__=null)}catch(be){if(e.__v=null,l||r!=null)if(be.then){for(e.__u|=l?160:128;o&&o.nodeType==8&&o.nextSibling;)o=o.nextSibling;r[r.indexOf(o)]=null,e.__e=o}else{for(ye=r.length;ye--;)sc(r[ye]);rc(e)}else e.__e=t.__e,e.__k=t.__k,be.then||rc(e);De.__e(be,e,t)}else r==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):o=e.__e=y7(t.__e,e,t,s,i,r,a,l,u);return(d=De.diffed)&&d(e),128&e.__u?void 0:o}function rc(n){n&&n.__c&&(n.__c.__e=!0),n&&n.__k&&n.__k.forEach(rc)}function Eb(n,e,t){for(var s=0;s<t.length;s++)nc(t[s],t[++s],t[++s]);De.__c&&De.__c(e,n),n.some(function(i){try{n=i.__h,i.__h=[],n.some(function(r){r.call(i)})}catch(r){De.__e(r,i.__v)}})}function Rb(n){return typeof n!="object"||n==null||n.__b&&n.__b>0?n:Dn(n)?n.map(Rb):Xs({},n)}function y7(n,e,t,s,i,r,a,o,l){var u,d,h,f,C,b,x,V=t.props,P=e.props,M=e.type;if(M=="svg"?i="http://www.w3.org/2000/svg":M=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(u=0;u<r.length;u++)if((C=r[u])&&"setAttribute"in C==!!M&&(M?C.localName==M:C.nodeType==3)){n=C,r[u]=null;break}}if(n==null){if(M==null)return document.createTextNode(P);n=document.createElementNS(i,M,P.is&&P),o&&(De.__m&&De.__m(e,r),o=!1),r=null}if(M==null)V===P||o&&n.data==P||(n.data=P);else{if(r=r&&Ln.call(n.childNodes),V=t.props||An,!o&&r!=null)for(V={},u=0;u<n.attributes.length;u++)V[(C=n.attributes[u]).name]=C.value;for(u in V)if(C=V[u],u!="children"){if(u=="dangerouslySetInnerHTML")h=C;else if(!(u in P)){if(u=="value"&&"defaultValue"in P||u=="checked"&&"defaultChecked"in P)continue;Il(n,u,null,C,i)}}for(u in P)C=P[u],u=="children"?f=C:u=="dangerouslySetInnerHTML"?d=C:u=="value"?b=C:u=="checked"?x=C:o&&typeof C!="function"||V[u]===C||Il(n,u,C,V[u],i);if(d)o||h&&(d.__html==h.__html||d.__html==n.innerHTML)||(n.innerHTML=d.__html),e.__k=[];else if(h&&(n.innerHTML=""),Pb(e.type=="template"?n.content:n,Dn(f)?f:[f],e,t,s,M=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,a,r?r[0]:t.__k&&$r(t,0),o,l),r!=null)for(u=r.length;u--;)sc(r[u]);o||(u="value",M=="progress"&&b==null?n.removeAttribute("value"):b!=null&&(b!==n[u]||M=="progress"&&!b||M=="option"&&b!=V[u])&&Il(n,u,b,V[u],i),u="checked",x!=null&&x!=n[u]&&Il(n,u,x,V[u],i))}return n}function nc(n,e,t){try{if(typeof n=="function"){var s=typeof n.__u=="function";s&&n.__u(),s&&e==null||(n.__u=n(e))}else n.current=e}catch(i){De.__e(i,t)}}function _b(n,e,t){var s,i;if(De.unmount&&De.unmount(n),(s=n.ref)&&(s.current&&s.current!=n.__e||nc(s,null,e)),(s=n.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(r){De.__e(r,e)}s.base=s.__P=null}if(s=n.__k)for(i=0;i<s.length;i++)s[i]&&_b(s[i],e,t||typeof n.type!="function");t||sc(n.__e),n.__c=n.__=n.__e=void 0}function v7(n,e,t){return this.constructor(n,t)}function ac(n,e,t){var s,i,r,a;e==document&&(e=document.documentElement),De.__&&De.__(n,e),i=(s=!1)?null:e.__k,r=[],a=[],ic(e,n=e.__k=v(ke,null,[n]),i||An,An,e.namespaceURI,i?null:e.firstChild?Ln.call(e.childNodes):null,r,i?i.__e:e.firstChild,s,a),Eb(r,n,a)}function C7(n,e,t){var s,i,r,a,o=Xs({},n.props);for(r in n.type&&n.type.defaultProps&&(a=n.type.defaultProps),e)r=="key"?s=e[r]:r=="ref"?i=e[r]:o[r]=e[r]===void 0&&a!=null?a[r]:e[r];return arguments.length>2&&(o.children=arguments.length>3?Ln.call(arguments,2):t),On(n.type,o,s||n.key,i||n.ref,null)}Ln=wb.slice,De={__e:function(n,e,t,s){for(var i,r,a;e=e.__;)if((i=e.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(n)),a=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(n,s||{}),a=i.__d),a)return i.__E=i}catch(o){n=o}throw n}},fb=0,Ye.prototype.setState=function(n,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Xs({},this.state),typeof n=="function"&&(n=n(Xs({},t),this.props)),n&&Xs(t,n),n!=null&&this.__v&&(e&&this._sb.push(e),Vb(this))},Ye.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),Vb(this))},Ye.prototype.render=ke,rr=[],vb=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Cb=function(n,e){return n.__v.__b-e.__v.__b},Pl.__r=0,bb=/(PointerCapture)$|Capture$/i,Xd=0,ec=Tb(!1),tc=Tb(!0);var ei,oc,Lb,Ab=[],Qt=De,Db=Qt.__b,Ob=Qt.__r,Mb=Qt.diffed,kb=Qt.__c,Nb=Qt.unmount,qb=Qt.__;function b7(){for(var n;n=Ab.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(Tl),n.__H.__h.forEach(lc),n.__H.__h=[]}catch(e){n.__H.__h=[],Qt.__e(e,n.__v)}}Qt.__b=function(n){ei=null,Db&&Db(n)},Qt.__=function(n,e){n&&e.__k&&e.__k.__m&&(n.__m=e.__k.__m),qb&&qb(n,e)},Qt.__r=function(n){Ob&&Ob(n);var e=(ei=n.__c).__H;e&&(oc===ei?(e.__h=[],ei.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.forEach(Tl),e.__h.forEach(lc),e.__h=[])),oc=ei},Qt.diffed=function(n){Mb&&Mb(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(Ab.push(e)!==1&&Lb===Qt.requestAnimationFrame||((Lb=Qt.requestAnimationFrame)||w7)(b7)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),oc=ei=null},Qt.__c=function(n,e){e.some(function(t){try{t.__h.forEach(Tl),t.__h=t.__h.filter(function(s){return!s.__||lc(s)})}catch(s){e.some(function(i){i.__h&&(i.__h=[])}),e=[],Qt.__e(s,t.__v)}}),kb&&kb(n,e)},Qt.unmount=function(n){Nb&&Nb(n);var e,t=n.__c;t&&t.__H&&(t.__H.__.forEach(function(s){try{Tl(s)}catch(i){e=i}}),t.__H=void 0,e&&Qt.__e(e,t.__v))};var Bb=typeof requestAnimationFrame=="function";function w7(n){var e,t=function(){clearTimeout(s),Bb&&cancelAnimationFrame(e),setTimeout(n)},s=setTimeout(t,35);Bb&&(e=requestAnimationFrame(t))}function Tl(n){var e=ei,t=n.__c;typeof t=="function"&&(n.__c=void 0,t()),ei=e}function lc(n){var e=ei;n.__c=n.__(),ei=e}function x7(n,e){for(var t in e)n[t]=e[t];return n}function Fb(n,e){for(var t in n)if(t!=="__source"&&!(t in e))return!0;for(var s in e)if(s!=="__source"&&n[s]!==e[s])return!0;return!1}function Qb(n,e){this.props=n,this.context=e}(Qb.prototype=new Ye).isPureReactComponent=!0,Qb.prototype.shouldComponentUpdate=function(n,e){return Fb(this.props,n)||Fb(this.state,e)};var Hb=De.__b;De.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),Hb&&Hb(n)};var V7=De.__e;De.__e=function(n,e,t,s){if(n.then){for(var i,r=e;r=r.__;)if((i=r.__c)&&i.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),i.__c(n,e)}V7(n,e,t,s)};var zb=De.unmount;function jb(n,e,t){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(s){typeof s.__c=="function"&&s.__c()}),n.__c.__H=null),(n=x7({},n)).__c!=null&&(n.__c.__P===t&&(n.__c.__P=e),n.__c.__e=!0,n.__c=null),n.__k=n.__k&&n.__k.map(function(s){return jb(s,e,t)})),n}function Ub(n,e,t){return n&&t&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(s){return Ub(s,e,t)}),n.__c&&n.__c.__P===e&&(n.__e&&t.appendChild(n.__e),n.__c.__e=!0,n.__c.__P=t)),n}function uc(){this.__u=0,this.o=null,this.__b=null}function Wb(n){var e=n.__.__c;return e&&e.__a&&e.__a(n)}function El(){this.i=null,this.l=null}De.unmount=function(n){var e=n.__c;e&&e.__R&&e.__R(),e&&32&n.__u&&(n.type=null),zb&&zb(n)},(uc.prototype=new Ye).__c=function(n,e){var t=e.__c,s=this;s.o==null&&(s.o=[]),s.o.push(t);var i=Wb(s.__v),r=!1,a=function(){r||(r=!0,t.__R=null,i?i(o):o())};t.__R=a;var o=function(){if(!--s.__u){if(s.state.__a){var l=s.state.__a;s.__v.__k[0]=Ub(l,l.__c.__P,l.__c.__O)}var u;for(s.setState({__a:s.__b=null});u=s.o.pop();)u.forceUpdate()}};s.__u++||32&e.__u||s.setState({__a:s.__b=s.__v.__k[0]}),n.then(a,a)},uc.prototype.componentWillUnmount=function(){this.o=[]},uc.prototype.render=function(n,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),s=this.__v.__k[0].__c;this.__v.__k[0]=jb(this.__b,t,s.__O=s.__P)}this.__b=null}var i=e.__a&&v(ke,null,n.fallback);return i&&(i.__u&=-33),[v(ke,null,e.__a?null:n.children),i]};var $b=function(n,e,t){if(++t[1]===t[0]&&n.l.delete(e),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.l.size))for(t=n.i;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;n.i=t=t[2]}};function P7(n){return this.getChildContext=function(){return n.context},n.children}function S7(n){var e=this,t=n.h;if(e.componentWillUnmount=function(){ac(null,e.v),e.v=null,e.h=null},e.h&&e.h!==t&&e.componentWillUnmount(),!e.v){for(var s=e.__v;s!==null&&!s.__m&&s.__!==null;)s=s.__;e.h=t,e.v={nodeType:1,parentNode:t,childNodes:[],__k:{__m:s.__m},contains:function(){return!0},insertBefore:function(i,r){this.childNodes.push(i),e.h.insertBefore(i,r)},removeChild:function(i){this.childNodes.splice(this.childNodes.indexOf(i)>>>1,1),e.h.removeChild(i)}}}ac(v(P7,{context:e.context},n.__v),e.v)}function I7(n,e){var t=v(S7,{__v:n,h:e});return t.containerInfo=e,t}(El.prototype=new Ye).__a=function(n){var e=this,t=Wb(e.__v),s=e.l.get(n);return s[0]++,function(i){var r=function(){e.props.revealOrder?(s.push(i),$b(e,n,s)):i()};t?t(r):r()}},El.prototype.render=function(n){this.i=null,this.l=new Map;var e=Sl(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.l.set(e[t],this.i=[1,0,this.i]);return n.children},El.prototype.componentDidUpdate=El.prototype.componentDidMount=function(){var n=this;this.l.forEach(function(e,t){$b(n,t,e)})};var Gb=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,T7=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,E7=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,R7=/[A-Z0-9]/g,_7=typeof document<"u",L7=function(n){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(n)};function Jb(n,e,t){return e.__k==null&&(e.textContent=""),ac(n,e),typeof t=="function"&&t(),n?n.__c:null}Ye.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(n){Object.defineProperty(Ye.prototype,n,{configurable:!0,get:function(){return this["UNSAFE_"+n]},set:function(e){Object.defineProperty(this,n,{configurable:!0,writable:!0,value:e})}})});var Kb=De.event;function A7(){}function D7(){return this.cancelBubble}function O7(){return this.defaultPrevented}De.event=function(n){return Kb&&(n=Kb(n)),n.persist=A7,n.isPropagationStopped=D7,n.isDefaultPrevented=O7,n.nativeEvent=n};var M7={enumerable:!1,configurable:!0,get:function(){return this.class}},Zb=De.vnode;De.vnode=function(n){typeof n.type=="string"&&(function(e){var t=e.props,s=e.type,i={},r=s.indexOf("-")===-1;for(var a in t){var o=t[a];if(!(a==="value"&&"defaultValue"in t&&o==null||_7&&a==="children"&&s==="noscript"||a==="class"||a==="className")){var l=a.toLowerCase();a==="defaultValue"&&"value"in t&&t.value==null?a="value":a==="download"&&o===!0?o="":l==="translate"&&o==="no"?o=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?a="ondblclick":l!=="onchange"||s!=="input"&&s!=="textarea"||L7(t.type)?l==="onfocus"?a="onfocusin":l==="onblur"?a="onfocusout":E7.test(a)&&(a=l):l=a="oninput":r&&T7.test(a)?a=a.replace(R7,"-$&").toLowerCase():o===null&&(o=void 0),l==="oninput"&&i[a=l]&&(a="oninputCapture"),i[a]=o}}s=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=Sl(t.children).forEach(function(u){u.props.selected=i.value.indexOf(u.props.value)!=-1})),s=="select"&&i.defaultValue!=null&&(i.value=Sl(t.children).forEach(function(u){u.props.selected=i.multiple?i.defaultValue.indexOf(u.props.value)!=-1:i.defaultValue==u.props.value})),t.class&&!t.className?(i.class=t.class,Object.defineProperty(i,"className",M7)):(t.className&&!t.class||t.class&&t.className)&&(i.class=i.className=t.className),e.props=i})(n),n.$$typeof=Gb,Zb&&Zb(n)};var Yb=De.__r;De.__r=function(n){Yb&&Yb(n),n.__c};var Xb=De.diffed;De.diffed=function(n){Xb&&Xb(n);var e=n.props,t=n.__e;t!=null&&n.type==="textarea"&&"value"in e&&e.value!==t.value&&(t.value=e.value==null?"":e.value)};function k7(n){return!!n&&n.$$typeof===Gb}function ew(n){return k7(n)?C7.apply(null,arguments):n}var tw=function(n,e){return n(e)};class te{constructor(){this.creatorHash={}}registerElement(e,t){this.creatorHash[e]=t}getAllTypes(){var e=new Array;for(var t in this.creatorHash)e.push(t);return e.sort()}isElementRegistered(e){return!!this.creatorHash[e]}createElement(e,t){var s=this.creatorHash[e];return s==null?null:s(t)}}te.Instance=new te;class ti{static wrapRow(e,t,s){const i=e.getRowWrapperComponentName(s),r=e.getRowWrapperComponentData(s);return te.Instance.createElement(i,{element:t,row:s,componentData:r})}static wrapElement(e,t,s){const i=e.getElementWrapperComponentName(s),r=e.getElementWrapperComponentData(s);return te.Instance.createElement(i,{element:t,question:s,componentData:r})}static wrapQuestionContent(e,t,s){const i=e.getQuestionContentWrapperComponentName(s),r=e.getElementWrapperComponentData(s);return te.Instance.createElement(i,{element:t,question:s,componentData:r})}static wrapItemValue(e,t,s,i){const r=e.getItemValueWrapperComponentName(i,s),a=e.getItemValueWrapperComponentData(i,s);return te.Instance.createElement(r,{key:t?.key,element:t,question:s,item:i,componentData:a})}static wrapMatrixCell(e,t,s,i="cell"){const r=e.getElementWrapperComponentName(s,i),a=e.getElementWrapperComponentData(s,i);return te.Instance.createElement(r,{element:t,cell:s,componentData:a})}}Ie.platform="react";class Ve extends Ye{static renderLocString(e,t=null,s){return te.Instance.createElement(e.renderAs,{locStr:e.renderAsData,style:t,key:s})}static renderQuestionDescription(e){var t=Ve.renderLocString(e.locDescription);return v("div",{style:e.hasDescription?void 0:{display:"none"},id:e.ariaDescriptionId,className:e.cssDescription},t)}constructor(e){super(e),this._allowComponentUpdate=!0,this.prevStateElements=[],this.propertyValueChangedHandler=(t,s)=>{const i=s.name;!this.canUsePropInState(i)||this.isRendering||(this.changedStatePropNameValue=i,this.setState(r=>{var a={};return a[i]=s.newValue,a}))},this.onArrayChangedCallback=(t,s)=>{this.isRendering||(this.changedStatePropNameValue=s.name,this.setState(i=>{var r={};return r[s.name]=s.newValue,r}))}}componentDidMount(){this.makeBaseElementsReact()}componentWillUnmount(){this.unMakeBaseElementsReact(),this.disableStateElementsRerenderEvent(this.getStateElements())}componentDidUpdate(e,t){var s;this.makeBaseElementsReact();const i=this.getStateElements();this.disableStateElementsRerenderEvent(((s=this.prevStateElements)!==null&&s!==void 0?s:[]).filter(r=>!i.find(a=>a==r))),this.prevStateElements=[],this.getStateElements().forEach(r=>{r.afterRerender()})}allowComponentUpdate(){this._allowComponentUpdate=!0,this.forceUpdate()}denyComponentUpdate(){this._allowComponentUpdate=!1}shouldComponentUpdate(e,t){return this._allowComponentUpdate&&(this.unMakeBaseElementsReact(),this.prevStateElements=this.getStateElements()),this._allowComponentUpdate}render(){if(!this.canRender())return null;this.startEndRendering(1);var e=this.renderElement();return this.startEndRendering(-1),e&&(e=this.wrapElement(e)),this.changedStatePropNameValue=void 0,e}wrapElement(e){return e}get isRendering(){var e=this.getRenderedElements();for(let t of e)if(t.reactRendering>0)return!0;return!1}getRenderedElements(){return this.getStateElements()}startEndRendering(e){var t=this.getRenderedElements();for(let s of t)s.reactRendering||(s.reactRendering=0),s.reactRendering+=e}canRender(){return!0}renderElement(){return null}get changedStatePropName(){return this.changedStatePropNameValue}makeBaseElementsReact(){for(var e=this.getStateElements(),t=0;t<e.length;t++)e[t].enableOnElementRerenderedEvent(),this.makeBaseElementReact(e[t])}unMakeBaseElementsReact(){var e=this.getStateElements();this.unMakeBaseElementsReactive(e)}unMakeBaseElementsReactive(e){for(var t=0;t<e.length;t++)this.unMakeBaseElementReact(e[t])}disableStateElementsRerenderEvent(e){e.forEach(t=>{t.disableOnElementRerenderedEvent()})}getStateElements(){var e=this.getStateElement();return e?[e]:[]}getStateElement(){return null}get isDisplayMode(){return this.props.isDisplayMode||!1}renderLocString(e,t=null,s){return Ve.renderLocString(e,t,s)}canMakeReact(e){return!!e&&!!e.iteratePropertiesHash}makeBaseElementReact(e){this.canMakeReact(e)&&(e.addOnArrayChangedCallback(this.onArrayChangedCallback),e.addOnPropertyValueChangedCallback(this.propertyValueChangedHandler))}canUsePropInState(e){return!0}unMakeBaseElementReact(e){this.canMakeReact(e)&&(e.removeOnPropertyValueChangedCallback(this.propertyValueChangedHandler),e.removeOnArrayChangedCallback(this.onArrayChangedCallback))}}class ht extends Ve{constructor(e){super(e)}get cssClasses(){return this.props.cssClasses}}class Tt extends Ve{constructor(e){super(e)}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.updateDomElement()}componentDidMount(){super.componentDidMount(),this.updateDomElement()}componentWillUnmount(){if(super.componentWillUnmount(),this.questionBase){const e=this.content||this.control;this.questionBase.beforeDestroyQuestionElement(e),e&&e.removeAttribute("data-rendered")}}updateDomElement(){const e=this.content||this.control;e&&e.getAttribute("data-rendered")!=="r"&&(e.setAttribute("data-rendered","r"),this.questionBase.afterRenderQuestionElement(e))}get questionBase(){return this.props.question}getRenderedElements(){return[this.questionBase]}get creator(){return this.props.creator}canRender(){return!!this.questionBase&&!!this.creator}shouldComponentUpdate(e,t){return super.shouldComponentUpdate(e,t)?!this.questionBase.customWidget||!!this.questionBase.customWidgetData.isNeedRender||!!this.questionBase.customWidget.widgetJson.isDefaultRender||!!this.questionBase.customWidget.widgetJson.render:!1}get isDisplayMode(){return this.props.isDisplayMode||!!this.questionBase&&this.questionBase.isInputReadOnly||!1}wrapCell(e,t,s){if(!s)return t;const i=this.questionBase.survey;let r=null;return i&&(r=ti.wrapMatrixCell(i,t,e,s)),r??t}setControl(e){e&&(this.control=e)}setContent(e){e&&(this.content=e)}}class Mn extends Tt{constructor(e){super(e),this.updateValueOnEvent=t=>{L.isTwoValueEquals(this.questionBase.value,t.target.value,!1,!0,!1)||this.setValueCore(t.target.value)},this.updateValueOnEvent=this.updateValueOnEvent.bind(this)}get question(){return this.questionBase}setValueCore(e){this.questionBase.value=e}getValueCore(){return this.questionBase.value}updateDomElement(){if(this.control){const e=this.control,t=this.getValueCore();L.isTwoValueEquals(t,e.value,!1,!0,!1)||(e.value=this.getValue(t))}super.updateDomElement()}getValue(e){return L.isValueEmpty(e)?"":e}}class ze extends Ye{constructor(e){super(e),this.svgIconRef=gt()}updateSvg(){this.props.iconName&&bR(this.props.size,this.props.width,this.props.height,this.props.iconName,this.svgIconRef.current,this.props.title)}componentDidUpdate(){this.updateSvg()}render(){let e="sv-svg-icon";return this.props.className&&(e+=" "+this.props.className),this.props.iconName?v("svg",{className:e,style:this.props.style,onClick:this.props.onClick,ref:this.svgIconRef,role:"presentation"},v("use",null)):null}componentDidMount(){this.updateSvg()}}te.Instance.registerElement("sv-svg-icon",n=>v(ze,n));class sw extends Ye{constructor(e){super(e)}render(){var e=`sv-action-bar-separator ${this.props.cssClasses}`;return v("div",{className:e})}}te.Instance.registerElement("sv-action-bar-separator",n=>v(sw,n));class kn extends Ve{constructor(e){super(e),this.ref=gt()}get item(){return this.props.item}getStateElement(){return this.item}renderElement(){const e=this.item.getActionRootCss(),t=this.item.needSeparator?v(sw,null):null,s=te.Instance.createElement(this.item.component||"sv-action-bar-item",{item:this.item});return v("div",{className:e,id:this.item.id,ref:this.ref},v("div",{className:"sv-action__content"},t,s))}componentWillUnmount(){super.componentWillUnmount(),this.item.updateModeCallback=void 0}componentDidMount(){super.componentDidMount(),this.item.updateModeCallback=(e,t)=>{queueMicrotask(()=>{tw?tw(()=>{this.item.mode=e}):this.item.mode=e,queueMicrotask(()=>{t(e,this.ref.current)})})},this.item.afterRender()}}class iw extends Ve{get item(){return this.props.item}getStateElement(){return this.item}renderElement(){return v(ke,null,this.renderInnerButton())}renderText(){if(!this.item.hasTitle)return null;const e=this.item.getActionBarItemTitleCss();return v("span",{className:e},this.item.title)}renderButtonContent(){const e=this.renderText(),t=this.item.iconName?v(ze,{className:this.item.cssClasses.itemIcon,size:this.item.iconSize,iconName:this.item.iconName,title:this.item.tooltip||this.item.title}):null;return v(ke,null,t,e)}renderInnerButton(){const e=this.item.getActionBarItemCss(),t=this.item.tooltip||this.item.title,s=this.renderButtonContent(),i=this.item.disableTabStop?-1:void 0;return gc(v("button",{className:e,type:"button",disabled:this.item.disabled,onMouseDown:a=>this.item.doMouseDown(a),onFocus:a=>this.item.doFocus(a),onClick:a=>this.item.doAction(a),title:t,tabIndex:i,"aria-checked":this.item.ariaChecked,"aria-expanded":this.item.ariaExpanded,role:this.item.ariaRole},s),this.item,{processEsc:!1})}}te.Instance.registerElement("sv-action-bar-item",n=>v(iw,n));class Nn extends Ve{constructor(e){super(e),this.containerRef=gt(),this.createModel()}get model(){return this.props.model}getStateElement(){return this.model}createModel(){this.popup=n7(this.props.model)}setTargetElement(){const e=this.containerRef.current;this.popup.setComponentElement(e)}componentDidMount(){super.componentDidMount(),this.setTargetElement()}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.setTargetElement()}componentWillUnmount(){super.componentWillUnmount(),this.popup.resetComponentElement()}shouldComponentUpdate(e,t){var s;if(!super.shouldComponentUpdate(e,t))return!1;const i=e.model!==this.popup.model;return i&&((s=this.popup)===null||s===void 0||s.dispose(),this.createModel()),i}render(){this.popup.model=this.model;let e;return this.model.isModal?e=v(hc,{model:this.popup}):e=v(N7,{model:this.popup}),v("div",{ref:this.containerRef},e)}}te.Instance.registerElement("sv-popup",n=>v(Nn,n));class hc extends Ve{constructor(e){super(e),this.handleKeydown=t=>{this.model.onKeyDown(t)},this.clickInside=t=>{t.stopPropagation()}}get model(){return this.props.model}getStateElement(){return this.model}componentDidUpdate(e,t){super.componentDidUpdate(e,t),!this.model.isPositionSet&&this.model.isVisible&&this.model.updateOnShowing()}renderContainer(e){const t=e.showHeader?this.renderHeaderPopup(e):null,s=e.title?this.renderHeaderContent():null,i=this.renderContent(),r=e.showFooter?this.renderFooter(this.model):null;return v("div",{className:"sv-popup__container",style:{left:e.left,top:e.top,height:e.height,width:e.width,minWidth:e.minWidth},onClick:a=>{this.clickInside(a)}},t,v("div",{className:"sv-popup__body-content"},s,v("div",{className:"sv-popup__scrolling-content"},i),r))}renderHeaderContent(){return v("div",{className:"sv-popup__body-header"},this.model.title)}renderContent(){const e=te.Instance.createElement(this.model.contentComponentName,this.model.contentComponentData);return v("div",{className:"sv-popup__content"},e)}renderHeaderPopup(e){return null}renderFooter(e){return v("div",{className:"sv-popup__body-footer"},v(Is,{model:e.footerToolbar}))}render(){const e=this.renderContainer(this.model),t=new j().append("sv-popup").append(this.model.styleClass).toString(),s={display:this.model.isVisible?"":"none"};return v("div",{tabIndex:-1,className:t,style:s,onClick:i=>{this.model.clickOutside(i)},onBlur:i=>{this.model.blur(i)},onKeyDown:this.handleKeydown},e)}componentDidMount(){super.componentDidMount(),this.model.isVisible&&this.model.updateOnShowing()}}class N7 extends hc{renderHeaderPopup(e){const t=e;return t?v("span",{style:{left:t.pointerTarget.left,top:t.pointerTarget.top},className:"sv-popup__pointer"}):null}}class q7 extends iw{constructor(e){super(e)}renderInnerButton(){const e=super.renderInnerButton();return v(ke,null,e,v(Nn,{model:this.item.popupModel}))}componentDidMount(){this.viewModel=new lR(this.item)}componentWillUnmount(){super.componentWillUnmount(),this.viewModel.dispose()}}te.Instance.registerElement("sv-action-bar-item-dropdown",n=>v(q7,n));class Is extends Ve{constructor(e){super(e),this.rootRef=gt()}get handleClick(){return this.props.handleClick!==void 0?this.props.handleClick:!0}get model(){return this.props.model}componentDidMount(){if(super.componentDidMount(),!this.model.hasVisibleActions)return;const e=this.rootRef.current;e&&this.model.initResponsivityManager(e,t=>{setTimeout(t,100)})}componentWillUnmount(){super.componentWillUnmount(),this.model.resetResponsivityManager()}componentDidUpdate(e,t){if(super.componentDidUpdate(e,t),e.model!=this.props.model&&e.model.resetResponsivityManager(),this.model.hasVisibleActions){const s=this.rootRef.current;s&&this.model.initResponsivityManager(s,i=>{setTimeout(i,100)})}}getStateElement(){return this.model}renderElement(){if(!this.model.hasActions)return null;const e=this.renderItems();return v("div",{ref:this.rootRef,style:this.model.getRootStyle(),className:this.model.getRootCss(),onClick:this.handleClick?function(t){t.stopPropagation()}:void 0},e)}renderItems(){return this.model.renderedActions.concat([]).map((e,t)=>v(kn,{item:e,key:e.renderedId}))}}te.Instance.registerElement("sv-action-bar",n=>v(Is,n));class rw extends Ye{constructor(e){super(e)}get cssClasses(){return this.props.cssClasses}get element(){return this.props.element}render(){if(this.element.isTitleRenderedAsString)return Ve.renderLocString(this.element.locRenderedTitle);var e=this.renderTitleSpans(this.element.getTitleOwner(),this.cssClasses);return v(ke,null,e)}renderTitleSpans(e,t){var s=a=>v("span",{"data-key":a,key:a},""),i=[];e.isRequireTextOnStart&&(i.push(this.renderRequireText(e)),i.push(s("req-sp")));var r=e.no;return r&&(i.push(v("span",{"data-key":"q_num",key:"q_num",className:e.cssTitleNumber,style:{position:"static"},"aria-hidden":!0},r)),i.push(s("num-sp"))),e.isRequireTextBeforeTitle&&(i.push(this.renderRequireText(e)),i.push(s("req-sp"))),i.push(Ve.renderLocString(e.locRenderedTitle,null,"q_title")),e.isRequireTextAfterTitle&&(i.push(s("req-sp")),i.push(this.renderRequireText(e))),i}renderRequireText(e){return v("span",{"data-key":"req-text",key:"req-text",className:e.cssRequiredMark,"aria-hidden":!0},e.requiredMark)}}class dc extends Ye{get cssClasses(){return this.props.cssClasses}get element(){return this.props.element}get renderActions(){return this.props.renderActions===void 0?!0:this.props.renderActions}render(){const e=v(rw,{element:this.element,cssClasses:this.cssClasses});return this.element.hasTitleActions?v("div",{className:"sv-title-actions"},v("span",{className:"sv-title-actions__title"},e),this.renderActions?v(Is,{model:this.element.getTitleToolbar()}):null):e}}pi.Instance.registerRenderer("element","title-actions","sv-title-actions"),te.Instance.registerElement("sv-title-actions",n=>v(dc,n));class Gr extends Ye{constructor(e){super(e)}get element(){return this.props.element}renderTitleExpandableSvg(){if(!this.element.getCssTitleExpandableSvg())return null;let e=this.element.isExpanded?"icon-collapse-16x16":"icon-expand-16x16";return v(ze,{className:this.element.getCssTitleExpandableSvg(),iconName:e,size:"auto"})}render(){const e=this.element;if(!e||!e.hasTitle)return null;const t=e.titleAriaLabel||void 0,s=this.renderTitleExpandableSvg(),i=v(dc,{element:e,cssClasses:e.cssClasses,renderActions:this.props.renderActions});let r,a;e.hasTitleEvents&&(a=l=>{Id(l.nativeEvent)});const o=e.titleTagName;return v(o,{className:e.cssTitle,id:e.ariaTitleId,"aria-label":t,tabIndex:e.titleTabIndex,"aria-expanded":e.titleAriaExpanded,role:e.titleAriaRole,onClick:r,onKeyUp:a},s,i)}}class nw extends Ye{constructor(e){super(e),this.state={changed:0},this.rootRef=gt()}get survey(){return this.props.survey}get css(){return this.survey.css}componentDidMount(){const e=this;this.survey.afterRenderHeader(this.rootRef.current),this.survey.locLogo.onChanged=function(){e.setState({changed:e.state.changed+1})}}componentWillUnmount(){this.survey.locLogo.onChanged=function(){}}renderTitle(){if(!this.survey.renderedHasTitle)return null;const e=Ve.renderLocString(this.survey.locDescription);return v("div",{className:this.css.headerText,style:{maxWidth:this.survey.titleMaxWidth}},v(Gr,{element:this.survey}),this.survey.renderedHasDescription?v("div",{className:this.css.description},e):null)}renderLogoImage(e){if(!e)return null;const t=this.survey.getElementWrapperComponentName(this.survey,"logo-image"),s=this.survey.getElementWrapperComponentData(this.survey,"logo-image");return te.Instance.createElement(t,{data:s})}render(){return this.survey.renderedHasHeader?v("div",{className:this.css.header,ref:this.rootRef},this.renderLogoImage(this.survey.isLogoBefore),this.renderTitle(),this.renderLogoImage(this.survey.isLogoAfter),v("div",{className:this.css.headerClose})):null}}te.Instance.registerElement("survey-header",n=>v(nw,n));class je{constructor(){this.creatorHash={}}registerQuestion(e,t){this.creatorHash[e]=t}getAllTypes(){var e=new Array;for(var t in this.creatorHash)e.push(t);return e.sort()}createQuestion(e,t){var s=this.creatorHash[e];return s==null?null:s(t)}}je.Instance=new je;class B7 extends Ye{render(){return v("div",{className:"sv-brand-info"},v("a",{className:"sv-brand-info__logo",href:"https://surveyjs.io/?utm_source=built-in_links&utm_medium=online_survey_tool&utm_campaign=landing_page"},v("img",{src:"https://surveyjs.io/Content/Images/poweredby.svg"})),v("div",{className:"sv-brand-info__text"},"Try and see how easy it is to ",v("a",{href:"https://surveyjs.io/create-survey?utm_source=built-in_links&utm_medium=online_survey_tool&utm_campaign=create_survey"},"create a survey")),v("div",{className:"sv-brand-info__terms"},v("a",{href:"https://surveyjs.io/TermsOfUse"},"Terms of Use & Privacy Statement")))}}class aw extends Ve{get notifier(){return this.props.notifier}getStateElement(){return this.notifier}renderElement(){if(!this.notifier.isDisplayed)return null;const e={visibility:this.notifier.active?"visible":"hidden"};return v("div",{className:this.notifier.css,style:e,role:"alert","aria-live":"polite"},v("span",null,this.notifier.message),v(Is,{model:this.notifier.actionBar}))}}te.Instance.registerElement("sv-notifier",n=>v(aw,n));class Ci extends Ye{render(){const e=this.props.survey.getContainerContent(this.props.container),t=this.props.needRenderWrapper!==!1;return e.length==0?null:t?v("div",{className:"sv-components-column sv-components-container-"+this.props.container},e.map(s=>te.Instance.createElement(s.component,{survey:this.props.survey,model:s.data,container:this.props.container,key:s.id}))):v(ke,null,e.map(s=>te.Instance.createElement(s.component,{survey:this.props.survey,model:s.data,container:this.props.container,key:s.id})))}}te.Instance.registerElement("sv-components-container",n=>v(Ci,n));class F7 extends Ye{constructor(e){super(e),this.onIconsChanged=()=>{this.containerRef.current&&(this.containerRef.current.innerHTML=Vl.iconsRenderedHtml())},this.containerRef=gt()}componentDidMount(){this.onIconsChanged(),Vl.onIconsChanged.add(this.onIconsChanged)}componentWillUnmount(){Vl.onIconsChanged.remove(this.onIconsChanged)}render(){return v("svg",{style:{display:"none"},id:"sv-icon-holder-global-container",ref:this.containerRef})}}class qn extends Ve{constructor(e){super(e),this.isInitialized=!1,this.init=()=>{this.isInitialized||(D.showDialog=(t,s)=>this.showDialog(t,s),this.isInitialized=!0)},this.clean=()=>{this.isInitialized&&(D.showDialog=void 0,this.isInitialized=!1)},this.state={changed:0},this.descriptor={init:this.init,clean:this.clean}}static addModalDescriptor(e){D.showDialog||e.init(),this.modalDescriptors.push(e)}static removeModalDescriptor(e){e.clean(),this.modalDescriptors.splice(this.modalDescriptors.indexOf(e),1),!D.showDialog&&this.modalDescriptors[0]&&this.modalDescriptors[0].init()}renderElement(){return this.model?I7(v(hc,{model:this.model}),this.model.container):null}showDialog(e,t){this.model=r7(e,t);const s=(i,r)=>{r.isVisible||(this.model.dispose(),this.model=void 0,this.setState({changed:this.state.changed+1}))};return this.model.onVisibilityChanged.add(s),this.model.model.isVisible=!0,this.setState({changed:this.state.changed+1}),this.model}componentDidMount(){qn.addModalDescriptor(this.descriptor)}componentWillUnmount(){this.model&&(this.model.dispose(),this.model=void 0),qn.removeModalDescriptor(this.descriptor)}}qn.modalDescriptors=[];var Q7={modernbooleancheckchecked:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><polygon points="19,10 14,10 14,5 10,5 10,10 5,10 5,14 10,14 10,19 14,19 14,14 19,14 "></polygon></svg>',modernbooleancheckind:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><path d="M22,0H2C0.9,0,0,0.9,0,2v20c0,1.1,0.9,2,2,2h20c1.1,0,2-0.9,2-2V2C24,0.9,23.1,0,22,0z M21,18L6,3h15V18z M3,6l15,15H3V6z"></path></svg>',modernbooleancheckunchecked:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><rect x="5" y="10" width="14" height="4"></rect></svg>',moderncheck:'<svg viewBox="0 0 24 24"><path d="M5,13l2-2l3,3l7-7l2,2l-9,9L5,13z"></path></svg>',modernradio:'<svg viewBox="-12 -12 24 24"><circle r="6" cx="0" cy="0"></circle></svg>',progressbutton:'<svg viewBox="0 0 10 10"><polygon points="2,2 0,4 5,9 10,4 8,2 5,5 "></polygon></svg>',removefile:'<svg viewBox="0 0 16 16"><path d="M8,2C4.7,2,2,4.7,2,8s2.7,6,6,6s6-2.7,6-6S11.3,2,8,2z M11,10l-1,1L8,9l-2,2l-1-1l2-2L5,6l1-1l2,2l2-2l1,1L9,8 L11,10z"></path></svg>',timercircle:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 160 160"><circle cx="80" cy="80" r="70" style="stroke: var(--sd-timer-stroke-background-color); stroke-width: var(--sd-timer-stroke-background-width)" stroke-dasharray="none" stroke-dashoffset="none"></circle><circle cx="80" cy="80" r="70"></circle></svg>',"add-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 11H17V13H13V17H11V13H7V11H11V7H13V11ZM23 12C23 18.1 18.1 23 12 23C5.9 23 1 18.1 1 12C1 5.9 5.9 1 12 1C18.1 1 23 5.9 23 12ZM21 12C21 7 17 3 12 3C7 3 3 7 3 12C3 17 7 21 12 21C17 21 21 17 21 12Z"></path></svg>',"arrowleft-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M15 8.99999H4.4L8.7 13.3L7.3 14.7L0.599998 7.99999L7.3 1.29999L8.7 2.69999L4.4 6.99999H15V8.99999Z"></path></svg>',"arrowright-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M1 6.99999H11.6L7.3 2.69999L8.7 1.29999L15.4 7.99999L8.7 14.7L7.3 13.3L11.6 8.99999H1V6.99999Z"></path></svg>',"camera-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.01 4H18.4C18.2 4 18.01 3.9 17.9 3.73L16.97 2.34C16.41 1.5 15.48 1 14.47 1H9.54C8.53 1 7.6 1.5 7.04 2.34L6.11 3.73C6 3.9 5.81 4 5.61 4H4C2.35 4 1 5.35 1 7V19C1 20.65 2.35 22 4 22H20C21.65 22 23 20.65 23 19V7C23 5.35 21.65 4 20 4H20.01ZM21.01 19C21.01 19.55 20.56 20 20.01 20H4.01C3.46 20 3.01 19.55 3.01 19V7C3.01 6.45 3.46 6 4.01 6H5.62C6.49 6 7.3 5.56 7.79 4.84L8.72 3.45C8.91 3.17 9.22 3 9.55 3H14.48C14.81 3 15.13 3.17 15.31 3.45L16.24 4.84C16.72 5.56 17.54 6 18.41 6H20.02C20.57 6 21.02 6.45 21.02 7V19H21.01ZM12.01 6C8.7 6 6.01 8.69 6.01 12C6.01 15.31 8.7 18 12.01 18C15.32 18 18.01 15.31 18.01 12C18.01 8.69 15.32 6 12.01 6ZM12.01 16C9.8 16 8.01 14.21 8.01 12C8.01 9.79 9.8 8 12.01 8C14.22 8 16.01 9.79 16.01 12C16.01 14.21 14.22 16 12.01 16ZM13.01 10C13.01 10.55 12.56 11 12.01 11C11.46 11 11.01 11.45 11.01 12C11.01 12.55 10.56 13 10.01 13C9.46 13 9.01 12.55 9.01 12C9.01 10.35 10.36 9 12.01 9C12.56 9 13.01 9.45 13.01 10Z"></path></svg>',"camera-32x32":'<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M27 6H23.8C23.34 6 22.92 5.77 22.66 5.39L22.25 4.78C21.51 3.66 20.26 3 18.92 3H13.06C11.72 3 10.48 3.67 9.73 4.78L9.32 5.39C9.07 5.77 8.64 6 8.18 6H4.98C2.79 6 1 7.79 1 10V24C1 26.21 2.79 28 5 28H27C29.21 28 31 26.21 31 24V10C31 7.79 29.21 6 27 6ZM29 24C29 25.1 28.1 26 27 26H5C3.9 26 3 25.1 3 24V10C3 8.9 3.9 8 5 8H8.2C9.33 8 10.38 7.44 11 6.5L11.41 5.89C11.78 5.33 12.41 5 13.07 5H18.93C19.6 5 20.22 5.33 20.59 5.89L21 6.5C21.62 7.44 22.68 8 23.8 8H27C28.1 8 29 8.9 29 10V24ZM16 9C12.13 9 9 12.13 9 16C9 19.87 12.13 23 16 23C19.87 23 23 19.87 23 16C23 12.13 19.87 9 16 9ZM16 21C13.24 21 11 18.76 11 16C11 13.24 13.24 11 16 11C18.76 11 21 13.24 21 16C21 18.76 18.76 21 16 21ZM17 13C17 13.55 16.55 14 16 14C14.9 14 14 14.9 14 16C14 16.55 13.55 17 13 17C12.45 17 12 16.55 12 16C12 13.79 13.79 12 16 12C16.55 12 17 12.45 17 13Z"></path></svg>',"cancel-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M22.6 8.6L16.4 2.4C16 2 15.5 1.8 15 1.8C14.5 1.8 14 2 13.6 2.4L1.40005 14.6C0.600049 15.4 0.600049 16.6 1.40005 17.4L6.00005 22H12L22.6 11.4C23.3 10.6 23.3 9.3 22.6 8.6ZM11.1 20H6.80005L2.80005 16L6.20005 12.6L12.4 18.8L11.1 20ZM13.8 17.4L7.60005 11.2L15 3.8L21.2 10L13.8 17.4ZM16 20H23V22H14L16 20Z"></path></svg>',"check-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5.003 14.413L0.292999 9.70303L1.703 8.29303L5.003 11.583L14.293 2.29303L15.703 3.70303L5.003 14.413Z"></path></svg>',"check-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9 20.1L1 12L3.1 9.9L9 15.9L20.9 4L23 6.1L9 20.1Z"></path></svg>',"chevrondown-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 15L17 10H7L12 15Z"></path></svg>',"chevronright-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5.64648 12.6465L6.34648 13.3465L11.7465 8.04648L6.34648 2.64648L5.64648 3.34648L10.2465 8.04648L5.64648 12.6465Z"></path></svg>',"clear-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13.35 3.34999L12.65 2.64999L8.05002 7.24999L3.35002 2.64999L2.65002 3.34999L7.25002 8.04999L2.65002 12.65L3.35002 13.35L8.05002 8.74999L12.65 13.35L13.35 12.65L8.75002 8.04999L13.35 3.34999Z"></path></svg>',"clear-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M22.6 8.6L16.4 2.4C16 2 15.5 1.8 15 1.8C14.5 1.8 14 2 13.6 2.4L1.40005 14.6C0.600049 15.4 0.600049 16.6 1.40005 17.4L6.00005 22H12L22.6 11.4C23.3 10.6 23.3 9.3 22.6 8.6ZM11.1 20H6.80005L2.80005 16L6.20005 12.6L12.4 18.8L11.1 20ZM13.8 17.4L7.60005 11.2L15 3.8L21.2 10L13.8 17.4ZM16 20H23V22H14L16 20Z"></path></svg>',"close-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M9.43 8.0025L13.7 3.7225C14.09 3.3325 14.09 2.6925 13.7 2.2925C13.31 1.9025 12.67 1.9025 12.27 2.2925L7.99 6.5725L3.72 2.3025C3.33 1.9025 2.69 1.9025 2.3 2.3025C1.9 2.6925 1.9 3.3325 2.3 3.7225L6.58 8.0025L2.3 12.2825C1.91 12.6725 1.91 13.3125 2.3 13.7125C2.69 14.1025 3.33 14.1025 3.73 13.7125L8.01 9.4325L12.29 13.7125C12.68 14.1025 13.32 14.1025 13.72 13.7125C14.11 13.3225 14.11 12.6825 13.72 12.2825L9.44 8.0025H9.43Z"></path></svg>',"close-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.4101 12L20.7001 4.71C21.0901 4.32 21.0901 3.69 20.7001 3.3C20.3101 2.91 19.6801 2.91 19.2901 3.3L12.0001 10.59L4.71006 3.29C4.32006 2.9 3.68006 2.9 3.29006 3.29C2.90006 3.68 2.90006 4.32 3.29006 4.71L10.5801 12L3.29006 19.29C2.90006 19.68 2.90006 20.31 3.29006 20.7C3.49006 20.9 3.74006 20.99 4.00006 20.99C4.26006 20.99 4.51006 20.89 4.71006 20.7L12.0001 13.41L19.2901 20.7C19.4901 20.9 19.7401 20.99 20.0001 20.99C20.2601 20.99 20.5101 20.89 20.7101 20.7C21.1001 20.31 21.1001 19.68 20.7101 19.29L13.4201 12H13.4101Z"></path></svg>',"collapse-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2 6L3 5L8 10L13 5L14 6L8 12L2 6Z"></path></svg>',"collapsedetails-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13 7H3V9H13V7Z"></path></svg>',"delete-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M15 2H14H11V1C11 0.4 10.6 0 10 0H7C6.4 0 6 0.4 6 1V2H3H2V4H3V14C3 15.1 3.9 16 5 16H12C13.1 16 14 15.1 14 14V4H15V2ZM7 1H10V2H7V1ZM12 14H5V4H12V14ZM7 13H6V5H7V13ZM9 13H8V5H9V13ZM11 13H10V5H11V13Z"></path></svg>',"delete-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M22 4H20H16V2C16 0.9 15.1 0 14 0H10C8.9 0 8 0.9 8 2V4H4H2V6H4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V6H22V4ZM10 2H14V4H10V2ZM18 20H6V6H8H16H18V20ZM14 8H16V18H14V8ZM11 8H13V18H11V8ZM8 8H10V18H8V8Z"></path></svg>',"drag-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 6C13 4.9 13.9 4 15 4C16.1 4 17 4.9 17 6C17 7.1 16.1 8 15 8C13.9 8 13 7.1 13 6ZM9 4C7.9 4 7 4.9 7 6C7 7.1 7.9 8 9 8C10.1 8 11 7.1 11 6C11 4.9 10.1 4 9 4ZM15 10C13.9 10 13 10.9 13 12C13 13.1 13.9 14 15 14C16.1 14 17 13.1 17 12C17 10.9 16.1 10 15 10ZM9 10C7.9 10 7 10.9 7 12C7 13.1 7.9 14 9 14C10.1 14 11 13.1 11 12C11 10.9 10.1 10 9 10ZM15 16C13.9 16 13 16.9 13 18C13 19.1 13.9 20 15 20C16.1 20 17 19.1 17 18C17 16.9 16.1 16 15 16ZM9 16C7.9 16 7 16.9 7 18C7 19.1 7.9 20 9 20C10.1 20 11 19.1 11 18C11 16.9 10.1 16 9 16Z"></path></svg>',"draghorizontal-24x16":'<svg viewBox="0 0 24 16" xmlns="http://www.w3.org/2000/svg"><path d="M18 9C19.1 9 20 9.9 20 11C20 12.1 19.1 13 18 13C16.9 13 16 12.1 16 11C16 9.9 16.9 9 18 9ZM20 5C20 3.9 19.1 3 18 3C16.9 3 16 3.9 16 5C16 6.1 16.9 7 18 7C19.1 7 20 6.1 20 5ZM14 11C14 9.9 13.1 9 12 9C10.9 9 10 9.9 10 11C10 12.1 10.9 13 12 13C13.1 13 14 12.1 14 11ZM14 5C14 3.9 13.1 3 12 3C10.9 3 10 3.9 10 5C10 6.1 10.9 7 12 7C13.1 7 14 6.1 14 5ZM8 11C8 9.9 7.1 9 6 9C4.9 9 4 9.9 4 11C4 12.1 4.9 13 6 13C7.1 13 8 12.1 8 11ZM8 5C8 3.9 7.1 3 6 3C4.9 3 4 3.9 4 5C4 6.1 4.9 7 6 7C7.1 7 8 6.1 8 5Z"></path></svg>',"editsmall-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13.59 4.5884L11.42 2.4184C11.03 2.0284 10.52 1.8284 10.01 1.8284C9.5 1.8284 8.99 2.0284 8.6 2.4184L3.76 7.2384C2.63 8.3684 2 9.8884 2 11.4784V12.9884C2 13.5384 2.45 13.9884 3 13.9884H4.51C6.1 13.9884 7.63 13.3584 8.75 12.2284L13.58 7.3984C14.36 6.6184 14.36 5.3484 13.58 4.5684L13.59 4.5884ZM7.35 10.8284C6.59 11.5884 5.59 11.9984 4.52 11.9984H4.01V11.4884C4.01 10.4184 4.43 9.4184 5.18 8.6584L7.72 6.1184L9.89 8.2884L7.35 10.8284ZM11.3 6.8784L9.13 4.7084L10.01 3.8284L12.18 5.9984L11.3 6.8784Z"></path></svg>',"expand-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6 14L5 13L10 8L5 3L6 2L12 8L6 14Z"></path></svg>',"expanddetails-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13 7H9V3H7V7H3V9H7V13H9V9H13V7Z"></path></svg>',"file-72x72":'<svg viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M62.83 12.83L53.17 3.17C52.7982 2.79866 52.357 2.50421 51.8714 2.30346C51.3858 2.1027 50.8654 1.99959 50.34 2H14C12.4087 2 10.8826 2.63214 9.75735 3.75736C8.63214 4.88258 8 6.4087 8 8V64C8 65.5913 8.63214 67.1174 9.75735 68.2426C10.8826 69.3679 12.4087 70 14 70H58C59.5913 70 61.1174 69.3679 62.2426 68.2426C63.3679 67.1174 64 65.5913 64 64V15.66C64.0004 15.1346 63.8973 14.6142 63.6965 14.1286C63.4958 13.643 63.2013 13.2018 62.83 12.83ZM52 4.83L61.17 14H56C54.9391 14 53.9217 13.5786 53.1716 12.8284C52.4214 12.0783 52 11.0609 52 10V4.83ZM62 64C62 65.0609 61.5786 66.0783 60.8284 66.8284C60.0783 67.5786 59.0609 68 58 68H14C12.9391 68 11.9217 67.5786 11.1716 66.8284C10.4214 66.0783 10 65.0609 10 64V8C10 6.93914 10.4214 5.92172 11.1716 5.17157C11.9217 4.42143 12.9391 4 14 4H50V10C50 11.5913 50.6321 13.1174 51.7574 14.2426C52.8826 15.3679 54.4087 16 56 16H62V64ZM22 26H50V28H22V26ZM22 32H50V34H22V32ZM22 38H50V40H22V38ZM22 44H50V46H22V44Z"></path></svg>',"flip-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M23 12.0037C23 14.2445 21.7794 16.3052 19.5684 17.8257C19.3984 17.9458 19.1983 18.0058 19.0082 18.0058C18.688 18.0058 18.3779 17.8557 18.1778 17.5756C17.8677 17.1155 17.9777 16.4953 18.4379 16.1852C20.0887 15.0448 21.0091 13.5643 21.0091 12.0138C21.0091 8.70262 16.9673 6.01171 12.005 6.01171C11.4948 6.01171 10.9945 6.04172 10.5043 6.09173L11.7149 7.30215C12.105 7.69228 12.105 8.32249 11.7149 8.71263C11.5148 8.9127 11.2647 9.00273 11.0045 9.00273C10.7444 9.00273 10.4943 8.90269 10.2942 8.71263L6.58254 5.00136L10.2842 1.2901C10.6744 0.899964 11.3047 0.899964 11.6949 1.2901C12.085 1.68023 12.085 2.31045 11.6949 2.70058L10.3042 4.09105C10.8545 4.03103 11.4147 4.00102 11.985 4.00102C18.0578 4.00102 22.99 7.59225 22.99 12.0037H23ZM12.2851 15.2949C11.895 15.685 11.895 16.3152 12.2851 16.7054L13.4957 17.9158C13.0055 17.9758 12.4952 17.9958 11.995 17.9958C7.03274 17.9958 2.99091 15.3049 2.99091 11.9937C2.99091 10.4332 3.90132 8.95271 5.56207 7.82232C6.02228 7.51222 6.13233 6.89201 5.82219 6.43185C5.51205 5.97169 4.89177 5.86166 4.43156 6.17176C2.22055 7.69228 1 9.76299 1 11.9937C1 16.4052 5.93224 19.9965 12.005 19.9965C12.5753 19.9965 13.1355 19.9665 13.6858 19.9064L12.2951 21.2969C11.905 21.6871 11.905 22.3173 12.2951 22.7074C12.4952 22.9075 12.7453 22.9975 13.0055 22.9975C13.2656 22.9975 13.5157 22.8975 13.7158 22.7074L17.4275 18.9961L13.7158 15.2849C13.3256 14.8947 12.6953 14.8947 12.3051 15.2849L12.2851 15.2949Z"></path></svg>',"folder-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.93 9H21V7C21 6.46957 20.7893 5.96086 20.4142 5.58579C20.0391 5.21071 19.5304 5 19 5H10L8 3H4C3.46957 3 2.96086 3.21071 2.58579 3.58579C2.21071 3.96086 2 4.46957 2 5L2 21H21L23.89 11.63C23.9916 11.3244 24.0179 10.9988 23.9667 10.6809C23.9155 10.363 23.7882 10.0621 23.5958 9.80392C23.4034 9.54571 23.1514 9.33779 22.8614 9.19782C22.5714 9.05786 22.2519 8.99 21.93 9ZM4 5H7.17L8.59 6.41L9.17 7H19V9H6L4 15V5ZM22 11L19.54 19H4.77L7.44 11H22Z"></path></svg>',"fullsize-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M12 13H4C2.9 13 2 12.1 2 11V5C2 3.9 2.9 3 4 3H12C13.1 3 14 3.9 14 5V11C14 12.1 13.1 13 12 13ZM4 5V11H12V5H4Z"></path></svg>',"image-48x48":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M36 8H12C9.79 8 8 9.79 8 12V36C8 38.21 9.79 40 12 40H36C38.21 40 40 38.21 40 36V12C40 9.79 38.21 8 36 8ZM38 36C38 37.1 37.1 38 36 38H12C10.9 38 10 37.1 10 36V12C10 10.9 10.9 10 12 10H36C37.1 10 38 10.9 38 12V36ZM14 17C14 15.34 15.34 14 17 14C18.66 14 20 15.34 20 17C20 18.66 18.66 20 17 20C15.34 20 14 18.66 14 17ZM27 24L36 36H12L19 27L23 29L27 24Z"></path></svg>',"loading-48x48":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_19679_369428)"><path opacity="0.1" d="M24 40C15.18 40 8 32.82 8 24C8 15.18 15.18 8 24 8C32.82 8 40 15.18 40 24C40 32.82 32.82 40 24 40ZM24 12C17.38 12 12 17.38 12 24C12 30.62 17.38 36 24 36C30.62 36 36 30.62 36 24C36 17.38 30.62 12 24 12Z" fill="black" fill-opacity="0.91"></path><path d="M10 26C8.9 26 8 25.1 8 24C8 15.18 15.18 8 24 8C25.1 8 26 8.9 26 10C26 11.1 25.1 12 24 12C17.38 12 12 17.38 12 24C12 25.1 11.1 26 10 26Z"></path></g><defs><clipPath id="clip0_19679_369428"><rect width="32" height="32" fill="white" transform="translate(8 8)"></rect></clipPath></defs></svg>',"maximize-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6.71 10.71L4.42 13H6.01C6.56 13 7.01 13.45 7.01 14C7.01 14.55 6.56 15 6.01 15H2C1.45 15 1 14.55 1 14V10C1 9.45 1.45 9 2 9C2.55 9 3 9.45 3 10V11.59L5.29 9.3C5.68 8.91 6.31 8.91 6.7 9.3C7.09 9.69 7.09 10.32 6.7 10.71H6.71ZM14 1H10C9.45 1 9 1.45 9 2C9 2.55 9.45 3 10 3H11.59L9.3 5.29C8.91 5.68 8.91 6.31 9.3 6.7C9.5 6.9 9.75 6.99 10.01 6.99C10.27 6.99 10.52 6.89 10.72 6.7L13.01 4.41V6C13.01 6.55 13.46 7 14.01 7C14.56 7 15.01 6.55 15.01 6V2C15.01 1.45 14.56 1 14.01 1H14Z"></path></svg>',"minimize-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13 9H3C2.45 9 2 8.55 2 8C2 7.45 2.45 7 3 7H13C13.55 7 14 7.45 14 8C14 8.55 13.55 9 13 9Z"></path></svg>',"more-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6 12C6 13.1 5.1 14 4 14C2.9 14 2 13.1 2 12C2 10.9 2.9 10 4 10C5.1 10 6 10.9 6 12ZM12 10C10.9 10 10 10.9 10 12C10 13.1 10.9 14 12 14C13.1 14 14 13.1 14 12C14 10.9 13.1 10 12 10ZM20 10C18.9 10 18 10.9 18 12C18 13.1 18.9 14 20 14C21.1 14 22 13.1 22 12C22 10.9 21.1 10 20 10Z"></path></svg>',"navmenu-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M16 7H2V5H16V7ZM2 11V13H22V11H2ZM2 19H10V17H2V19Z"></path></svg>',"noimage-48x48":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M14 17.01C14 16.4167 14.1759 15.8366 14.5056 15.3433C14.8352 14.8499 15.3038 14.4654 15.8519 14.2384C16.4001 14.0113 17.0033 13.9519 17.5853 14.0676C18.1672 14.1834 18.7018 14.4691 19.1213 14.8887C19.5409 15.3082 19.8266 15.8428 19.9424 16.4247C20.0581 17.0067 19.9987 17.6099 19.7716 18.1581C19.5446 18.7062 19.1601 19.1748 18.6667 19.5044C18.1734 19.8341 17.5933 20.01 17 20.01C16.2044 20.01 15.4413 19.6939 14.8787 19.1313C14.3161 18.5687 14 17.8056 14 17.01ZM27.09 24.14L20 36.01H36L27.09 24.14ZM36.72 8.14L35.57 10.01H36C36.5304 10.01 37.0391 10.2207 37.4142 10.5958C37.7893 10.9709 38 11.4796 38 12.01V36.01C38 36.5404 37.7893 37.0491 37.4142 37.4242C37.0391 37.7993 36.5304 38.01 36 38.01H18.77L17.57 40.01H36C37.0609 40.01 38.0783 39.5886 38.8284 38.8384C39.5786 38.0883 40 37.0709 40 36.01V12.01C39.9966 11.0765 39.6668 10.1737 39.0678 9.45778C38.4688 8.74188 37.6382 8.25802 36.72 8.09V8.14ZM36.86 4.5L12.86 44.5L11.14 43.5L13.23 40.01H12C10.9391 40.01 9.92172 39.5886 9.17157 38.8384C8.42143 38.0883 8 37.0709 8 36.01V12.01C8 10.9491 8.42143 9.93172 9.17157 9.18157C9.92172 8.43143 10.9391 8.01 12 8.01H32.43L35.14 3.5L36.86 4.5ZM14.43 38.01L15.63 36.01H12L19 27.01L20.56 27.8L31.23 10.01H12C11.4696 10.01 10.9609 10.2207 10.5858 10.5958C10.2107 10.9709 10 11.4796 10 12.01V36.01C10 36.5404 10.2107 37.0491 10.5858 37.4242C10.9609 37.7993 11.4696 38.01 12 38.01H14.43Z"></path></svg>',"ranking-arrows":'<svg viewBox="0 0 10 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 5L5 0L0 5H4V9H6V5H10Z"></path><path d="M6 19V15H4V19H0L5 24L10 19H6Z"></path></svg>',"rankingundefined-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13 7H3V9H13V7Z"></path></svg>',"rating-star-2":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M24 39.5057L11.7226 45.9839C10.4095 46.6739 8.87606 45.5622 9.12525 44.096L11.4734 30.373L1.54411 20.6556C0.480254 19.6207 1.06489 17.8095 2.53128 17.5986L16.2559 15.5957L22.3994 3.10891C23.0512 1.77685 24.9488 1.77685 25.6102 3.10891L31.7441 15.5957L45.4687 17.5986C46.9351 17.8095 47.5197 19.6207 46.4559 20.6556L36.5266 30.373L38.8748 44.096C39.1239 45.5622 37.5905 46.6835 36.2774 45.9839L24 39.5057Z" fill="none" stroke-width="2"></path><path d="M24.3981 33.1305L24 32.9206L23.6019 33.1305L15.8715 37.2059L17.3542 28.5663L17.43 28.1246L17.1095 27.8113L10.83 21.6746L19.4965 20.4049L19.9405 20.3399L20.1387 19.9373L24 12.0936L27.8613 19.9373L28.0595 20.3399L28.5035 20.4049L37.17 21.6746L30.8905 27.8113L30.57 28.1246L30.6458 28.5663L32.1285 37.2059L24.3981 33.1305Z" stroke-width="1.70746"></path></svg>',"rating-star-small-2":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 19.3373L6.13001 22.4373C5.50001 22.7673 4.77001 22.2373 4.89001 21.5373L6.01001 14.9773L1.26001 10.3273C0.750007 9.83728 1.03001 8.96728 1.73001 8.86728L8.29001 7.90728L11.23 1.93728C11.54 1.29728 12.45 1.29728 12.77 1.93728L15.7 7.90728L22.26 8.86728C22.96 8.96728 23.24 9.83728 22.73 10.3273L17.98 14.9773L19.1 21.5373C19.22 22.2373 18.49 22.7773 17.86 22.4373L11.99 19.3373H12Z" fill="none" stroke-width="2"></path><path d="M12 15.9472L8.58001 17.7572L9.23001 13.9272L6.45001 11.2072L10.29 10.6472L12 7.17725L13.71 10.6472L17.55 11.2072L14.77 13.9272L15.42 17.7572L12 15.9472Z"></path></svg>',"rating-star-small":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g><path d="M12 19.3373L6.13001 22.4373C5.50001 22.7673 4.77001 22.2373 4.89001 21.5373L6.01001 14.9773L1.26001 10.3273C0.750007 9.83728 1.03001 8.96728 1.73001 8.86728L8.29001 7.90728L11.23 1.93728C11.54 1.29728 12.45 1.29728 12.77 1.93728L15.7 7.90728L22.26 8.86728C22.96 8.96728 23.24 9.83728 22.73 10.3273L17.98 14.9773L19.1 21.5373C19.22 22.2373 18.49 22.7773 17.86 22.4373L11.99 19.3373H12Z"></path></g></svg>',"rating-star":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g><path d="M24 39.5057L11.7226 45.9839C10.4095 46.6739 8.87606 45.5622 9.12525 44.096L11.4734 30.373L1.54411 20.6556C0.480254 19.6207 1.06489 17.8095 2.53128 17.5986L16.2559 15.5957L22.3994 3.10891C23.0512 1.77685 24.9488 1.77685 25.6102 3.10891L31.7441 15.5957L45.4687 17.5986C46.9351 17.8095 47.5197 19.6207 46.4559 20.6556L36.5266 30.373L38.8748 44.096C39.1239 45.5622 37.5905 46.6835 36.2774 45.9839L24 39.5057Z"></path></g></svg>',"reorder-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 5L12 0L7 5H11V9H13V5H17Z"></path><path d="M13 19V15H11V19H7L12 24L17 19H13Z"></path></svg>',"restoredown-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M15 6C15 6.55 14.55 7 14 7H10C9.45 7 9 6.55 9 6V2C9 1.45 9.45 1 10 1C10.55 1 11 1.45 11 2V3.59L13.29 1.29C13.49 1.09 13.74 1 14 1C14.26 1 14.51 1.1 14.71 1.29C15.1 1.68 15.1 2.31 14.71 2.7L12.42 4.99H14.01C14.56 4.99 15.01 5.44 15.01 5.99L15 6ZM6 9H2C1.45 9 0.999998 9.45 0.999998 10C0.999998 10.55 1.45 11 2 11H3.59L1.29 13.29C0.899998 13.68 0.899998 14.31 1.29 14.7C1.68 15.09 2.31 15.09 2.7 14.7L4.99 12.41V14C4.99 14.55 5.44 15 5.99 15C6.54 15 6.99 14.55 6.99 14V10C6.99 9.45 6.54 9 5.99 9H6Z"></path></svg>',"search-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14 2C9.6 2 6 5.6 6 10C6 11.8 6.6 13.5 7.7 14.9L2.3 20.3C1.9 20.7 1.9 21.3 2.3 21.7C2.5 21.9 2.7 22 3 22C3.3 22 3.5 21.9 3.7 21.7L9.1 16.3C10.5 17.4 12.2 18 14 18C18.4 18 22 14.4 22 10C22 5.6 18.4 2 14 2ZM14 16C10.7 16 8 13.3 8 10C8 6.7 10.7 4 14 4C17.3 4 20 6.7 20 10C20 13.3 17.3 16 14 16Z"></path></svg>',"smiley-rate1-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 4.9938C4 4.44362 4.45 3.99348 5 3.99348H6.59L5.3 2.70306C4.91 2.31293 4.91 1.68272 5.3 1.2926C5.69 0.902468 6.32 0.902468 6.71 1.2926L9.71 4.29357C9.8 4.3836 9.88 4.49364 9.93 4.62368C10.03 4.86376 10.03 5.14385 9.93 5.38393C9.88 5.50397 9.81 5.614 9.71 5.71404L6.71 8.71501C6.51 8.91508 6.26 9.00511 6 9.00511C5.74 9.00511 5.49 8.90508 5.29 8.71501C4.9 8.32489 4.9 7.69468 5.29 7.30456L6.58 6.01413H4.99C4.44 6.01413 3.99 5.56399 3.99 5.01381L4 4.9938ZM14.08 5.37393C14.13 5.49397 14.2 5.604 14.3 5.70403L17.3 8.70501C17.5 8.90508 17.75 8.99511 18.01 8.99511C18.27 8.99511 18.52 8.89507 18.72 8.70501C19.11 8.31488 19.11 7.68468 18.72 7.29455L17.43 6.00413H19.02C19.57 6.00413 20.02 5.55399 20.02 5.00381C20.02 4.45363 19.57 4.00348 19.02 4.00348H17.43L18.72 2.71306C19.11 2.32293 19.11 1.69273 18.72 1.3026C18.33 0.912471 17.7 0.912471 17.31 1.3026L14.31 4.30358C14.22 4.39361 14.14 4.50364 14.09 4.63368C13.99 4.87376 13.99 5.15385 14.09 5.39393L14.08 5.37393ZM22 14.9971V20.999C22 22.6496 20.65 24 19 24H5C3.35 24 2 22.6496 2 20.999V14.9971C2 13.3465 3.35 11.9961 5 11.9961H19C20.65 11.9961 22 13.3465 22 14.9971ZM19 13.9967H16V16.9977H20V14.9971C20 14.4469 19.55 13.9967 19 13.9967ZM14 16.9977V13.9967H10V16.9977H14ZM10 18.9984V21.9993H14V18.9984H10ZM4 14.9971V16.9977H8V13.9967H5C4.45 13.9967 4 14.4469 4 14.9971ZM5 21.9993H8V18.9984H4V20.999C4 21.5492 4.45 21.9993 5 21.9993ZM20 20.999V18.9984H16V21.9993H19C19.55 21.9993 20 21.5492 20 20.999Z"></path></svg>',"smiley-rate10-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.01 23C6.85721 23 1.15412 19.9621 0.0134987 13.1669C-0.0765501 12.6272 0.293651 12.1076 0.833944 12.0177C1.38424 11.9277 1.89452 12.2975 1.98457 12.8371C2.92508 18.4732 7.69767 20.9914 12 20.9914C16.3023 20.9914 21.0749 18.4732 22.0154 12.8371C22.1055 12.2975 22.6158 11.9277 23.1661 12.0177C23.7063 12.1076 24.0765 12.6272 23.9865 13.1669C22.8559 19.9521 17.1428 23 11.99 23H12.01ZM21.165 6.15177C22.3056 5.01257 22.3056 3.16386 21.165 2.02465L21.0049 1.85477C19.9143 0.765533 18.1633 0.725561 17.0227 1.71487C15.8821 0.715568 14.1312 0.765533 13.0406 1.85477L12.8705 2.01466C11.7299 3.15386 11.7299 5.00257 12.8705 6.14178L17.0227 10.2889L21.175 6.14178L21.165 6.15177ZM15.742 3.27378L17.0127 4.54289L18.2834 3.27378C18.6436 2.91403 19.2239 2.91403 19.5841 3.27378L19.7442 3.43367C20.1044 3.79342 20.1044 4.37301 19.7442 4.73276L17.0127 7.46086L14.2812 4.73276C13.921 4.37301 13.921 3.79342 14.2812 3.43367L14.4413 3.27378C14.6214 3.09391 14.8515 3.00397 15.0917 3.00397C15.3318 3.00397 15.5619 3.09391 15.742 3.27378ZM11.1595 6.15177C12.3002 5.01257 12.3002 3.16386 11.1595 2.02465L10.9995 1.85477C9.90886 0.765533 8.15792 0.725561 7.0173 1.71487C5.87668 0.715568 4.12573 0.765533 3.03514 1.85477L2.86505 2.01466C1.72443 3.15386 1.72443 5.00257 2.86505 6.14178L7.0173 10.2889L11.1695 6.14178L11.1595 6.15177ZM5.7366 3.27378L7.00729 4.54289L8.27798 3.27378C8.63818 2.91403 9.21849 2.91403 9.57869 3.27378L9.73877 3.43367C10.099 3.79342 10.099 4.37301 9.73877 4.73276L7.00729 7.46086L4.27581 4.73276C3.91562 4.37301 3.91562 3.79342 4.27581 3.43367L4.4359 3.27378C4.61599 3.09391 4.84612 3.00397 5.08625 3.00397C5.32638 3.00397 5.5565 3.09391 5.7366 3.27378Z"></path></svg>',"smiley-rate2-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_15894_140103)"><path d="M4.88291 4.51001C4.47291 4.51001 4.08291 4.25001 3.94291 3.84001C3.76291 3.32001 4.03291 2.75001 4.55291 2.57001L8.32291 1.25001C8.84291 1.06001 9.41291 1.34001 9.59291 1.86001C9.77291 2.38001 9.50291 2.95001 8.98291 3.13001L5.20291 4.45001C5.09291 4.49001 4.98291 4.51001 4.87291 4.51001H4.88291ZM19.8129 3.89001C20.0229 3.38001 19.7729 2.79001 19.2629 2.59001L15.5529 1.07001C15.0429 0.860007 14.4529 1.11001 14.2529 1.62001C14.0429 2.13001 14.2929 2.72001 14.8029 2.92001L18.5029 4.43001C18.6229 4.48001 18.7529 4.50001 18.8829 4.50001C19.2729 4.50001 19.6529 4.27001 19.8129 3.88001V3.89001ZM3.50291 6.00001C2.64291 6.37001 1.79291 6.88001 1.00291 7.48001C0.79291 7.64001 0.64291 7.87001 0.59291 8.14001C0.48291 8.73001 0.87291 9.29001 1.45291 9.40001C2.04291 9.51001 2.60291 9.12001 2.71291 8.54001C2.87291 7.69001 3.12291 6.83001 3.50291 5.99001V6.00001ZM21.0429 8.55001C21.6029 10.48 24.2429 8.84001 22.7529 7.48001C21.9629 6.88001 21.1129 6.37001 20.2529 6.00001C20.6329 6.84001 20.8829 7.70001 21.0429 8.55001ZM21.5729 13.2C21.2529 14.2 22.5429 15.09 23.3629 14.39C23.8529 14 23.9229 13.29 23.5429 12.81C21.7429 10.67 22.1329 10.55 21.5829 13.2H21.5729ZM1.75291 11C1.22291 11.79 -0.14709 12.64 0.0129102 13.75C0.15291 14.36 0.75291 14.74 1.35291 14.6C2.98291 14.1 1.80291 12.22 1.75291 11ZM19.8829 17C19.8829 13.14 16.2929 10 11.8829 10C7.47291 10 3.88291 13.14 3.88291 17C3.88291 20.86 7.47291 24 11.8829 24C16.2929 24 19.8829 20.86 19.8829 17ZM17.8829 17C17.8829 19.76 15.1929 22 11.8829 22C8.57291 22 5.88291 19.76 5.88291 17C5.88291 14.24 8.57291 12 11.8829 12C15.1929 12 17.8829 14.24 17.8829 17Z"></path></g><defs><clipPath id="clip0_15894_140103"><rect width="24" height="24" fill="white"></rect></clipPath></defs></svg>',"smiley-rate3-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.01915 7C6.46961 7 6.01998 6.55 6.01998 6V2C6.01998 1.45 6.46961 1 7.01915 1C7.56869 1 8.01832 1.45 8.01832 2V6C8.01832 6.55 7.56869 7 7.01915 7ZM18.01 6V2C18.01 1.45 17.5604 1 17.0108 1C16.4613 1 16.0117 1.45 16.0117 2V6C16.0117 6.55 16.4613 7 17.0108 7C17.5604 7 18.01 6.55 18.01 6ZM16.4213 21.58L18.01 19.99L19.2989 21.28C19.6886 21.67 20.3181 21.67 20.7077 21.28C21.0974 20.89 21.0974 20.26 20.7077 19.87L19.4188 18.58C18.6395 17.8 17.3705 17.8 16.5912 18.58L15.0025 20.17L13.4138 18.58C12.6345 17.8 11.3655 17.8 10.5862 18.58L8.9975 20.17L7.40883 18.58C6.62948 17.8 5.36053 17.8 4.58118 18.58L3.29226 19.87C2.90258 20.26 2.90258 20.89 3.29226 21.28C3.68193 21.67 4.31141 21.67 4.70108 21.28L5.99001 19.99L7.57868 21.58C8.35803 22.36 9.62698 22.36 10.4063 21.58L11.995 19.99L13.5837 21.58C13.9734 21.97 14.4829 22.16 14.9925 22.16C15.5021 22.16 16.0117 21.97 16.4013 21.58H16.4213Z"></path></svg>',"smiley-rate4-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.06927 7C6.51927 7 6.06927 6.55 6.06927 6V2C6.06927 1.45 6.51927 1 7.06927 1C7.61927 1 8.06927 1.45 8.06927 2V6C8.06927 6.55 7.61927 7 7.06927 7ZM18.0693 6V2C18.0693 1.45 17.6193 1 17.0693 1C16.5193 1 16.0693 1.45 16.0693 2V6C16.0693 6.55 16.5193 7 17.0693 7C17.6193 7 18.0693 6.55 18.0693 6ZM22.5693 21.9C23.0693 21.66 23.2793 21.07 23.0393 20.57C21.1093 16.52 16.9093 14 12.0693 14C7.22927 14 3.02927 16.52 1.09927 20.57C0.859273 21.07 1.06927 21.67 1.56927 21.9C2.06927 22.14 2.65927 21.93 2.89927 21.43C4.49927 18.08 8.00927 16 12.0593 16C16.1093 16 19.6293 18.08 21.2193 21.43C21.3893 21.79 21.7493 22 22.1193 22C22.2593 22 22.4093 21.97 22.5493 21.9H22.5693Z"></path></svg>',"smiley-rate5-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.00572 7C6.45572 7 6.00572 6.55 6.00572 6V2C6.00572 1.45 6.45572 1 7.00572 1C7.55572 1 8.00572 1.45 8.00572 2V6C8.00572 6.55 7.55572 7 7.00572 7ZM18.0057 6V2C18.0057 1.45 17.5557 1 17.0057 1C16.4557 1 16.0057 1.45 16.0057 2V6C16.0057 6.55 16.4557 7 17.0057 7C17.5557 7 18.0057 6.55 18.0057 6ZM19.9457 21.33C20.1257 20.81 19.8557 20.24 19.3357 20.05C14.5457 18.35 9.45572 18.35 4.66572 20.05C4.14572 20.23 3.87572 20.81 4.05572 21.33C4.23572 21.85 4.80572 22.12 5.33572 21.94C9.69572 20.4 14.3057 20.4 18.6657 21.94C18.7757 21.98 18.8857 22 18.9957 22C19.4057 22 19.7957 21.74 19.9357 21.33H19.9457Z"></path></svg>',"smiley-rate6-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7 7C6.45 7 6 6.55 6 6V2C6 1.45 6.45 1 7 1C7.55 1 8 1.45 8 2V6C8 6.55 7.55 7 7 7ZM18 6V2C18 1.45 17.55 1 17 1C16.45 1 16 1.45 16 2V6C16 6.55 16.45 7 17 7C17.55 7 18 6.55 18 6ZM21 21C21 20.45 20.55 20 20 20H4C3.45 20 3 20.45 3 21C3 21.55 3.45 22 4 22H20C20.55 22 21 21.55 21 21Z"></path></svg>',"smiley-rate7-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.0022 23.99C11.452 23.99 11.0018 23.5402 11.0018 22.9904C11.0018 22.4407 11.452 21.9909 12.0022 21.9909C16.3137 21.9909 21.0755 19.472 22.0158 13.8344C22.1058 13.2947 22.616 12.9248 23.1662 13.0148C23.7064 13.1047 24.0765 13.6245 23.9865 14.1643C22.8561 20.9513 17.144 24 11.9922 24L12.0022 23.99ZM8.00072 5.99783V1.99957C8.00072 1.4498 7.55056 1 7.00036 1C6.45016 1 6 1.4498 6 1.99957V5.99783C6 6.54759 6.45016 6.99739 7.00036 6.99739C7.55056 6.99739 8.00072 6.54759 8.00072 5.99783ZM18.0043 5.99783V1.99957C18.0043 1.4498 17.5542 1 17.004 1C16.4538 1 16.0036 1.4498 16.0036 1.99957V5.99783C16.0036 6.54759 16.4538 6.99739 17.004 6.99739C17.5542 6.99739 18.0043 6.54759 18.0043 5.99783Z"></path></svg>',"smiley-rate8-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.01 24C6.85721 24 1.15412 20.96 0.0134987 14.16C-0.0765501 13.62 0.293651 13.1 0.833944 13.01C1.38424 12.92 1.89452 13.29 1.98457 13.83C2.92508 19.47 7.69767 21.99 12 21.99C16.3023 21.99 21.0749 19.47 22.0154 13.83C22.1055 13.29 22.6158 12.92 23.1661 13.01C23.7063 13.1 24.0765 13.62 23.9865 14.16C22.8559 20.95 17.1428 24 11.99 24H12.01ZM8.00783 6V2C8.00783 1.45 7.55759 1 7.00729 1C6.45699 1 6.00675 1.45 6.00675 2V6C6.00675 6.55 6.45699 7 7.00729 7C7.55759 7 8.00783 6.55 8.00783 6ZM18.0133 6V2C18.0133 1.45 17.563 1 17.0127 1C16.4624 1 16.0122 1.45 16.0122 2V6C16.0122 6.55 16.4624 7 17.0127 7C17.563 7 18.0133 6.55 18.0133 6Z"></path></svg>',"smiley-rate9-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.01 24C6.85767 24 1.15509 20.96 0.0145752 14.16C-0.0354475 13.87 0.0445888 13.57 0.234675 13.35C0.424761 13.13 0.704888 13 0.995019 13H23.005C23.2951 13 23.5752 13.13 23.7653 13.35C23.9554 13.57 24.0354 13.87 23.9854 14.16C22.8549 20.95 17.1423 24 11.99 24H12.01ZM2.25559 15C3.61621 19.82 8.0182 22 12.01 22C16.0018 22 20.4038 19.82 21.7644 15H2.25559ZM8.00819 6V2C8.00819 1.45 7.55799 1 7.00774 1C6.45749 1 6.00729 1.45 6.00729 2V6C6.00729 6.55 6.45749 7 7.00774 7C7.55799 7 8.00819 6.55 8.00819 6ZM18.0127 6V2C18.0127 1.45 17.5625 1 17.0123 1C16.462 1 16.0118 1.45 16.0118 2V6C16.0118 6.55 16.462 7 17.0123 7C17.5625 7 18.0127 6.55 18.0127 6Z"></path></svg>'};var ow={modernbooleancheckchecked:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><polygon points="19,10 14,10 14,5 10,5 10,10 5,10 5,14 10,14 10,19 14,19 14,14 19,14 "></polygon></svg>',modernbooleancheckind:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><path d="M22,0H2C0.9,0,0,0.9,0,2v20c0,1.1,0.9,2,2,2h20c1.1,0,2-0.9,2-2V2C24,0.9,23.1,0,22,0z M21,18L6,3h15V18z M3,6l15,15H3V6z"></path></svg>',modernbooleancheckunchecked:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><rect x="5" y="10" width="14" height="4"></rect></svg>',moderncheck:'<svg viewBox="0 0 24 24"><path d="M5,13l2-2l3,3l7-7l2,2l-9,9L5,13z"></path></svg>',modernradio:'<svg viewBox="-12 -12 24 24"><circle r="6" cx="0" cy="0"></circle></svg>',progressbutton:'<svg viewBox="0 0 10 10"><polygon points="2,2 0,4 5,9 10,4 8,2 5,5 "></polygon></svg>',removefile:'<svg viewBox="0 0 16 16"><path d="M8,2C4.7,2,2,4.7,2,8s2.7,6,6,6s6-2.7,6-6S11.3,2,8,2z M11,10l-1,1L8,9l-2,2l-1-1l2-2L5,6l1-1l2,2l2-2l1,1L9,8 L11,10z"></path></svg>',timercircle:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 160 160"><circle cx="80" cy="80" r="70" style="stroke: var(--sd-timer-stroke-background-color); stroke-width: var(--sd-timer-stroke-background-width)" stroke-dasharray="none" stroke-dashoffset="none"></circle><circle cx="80" cy="80" r="70"></circle></svg>',"add-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.75 12C15.75 12.41 15.41 12.75 15 12.75H12.75V15C12.75 15.41 12.41 15.75 12 15.75C11.59 15.75 11.25 15.41 11.25 15V12.75H9C8.59 12.75 8.25 12.41 8.25 12C8.25 11.59 8.59 11.25 9 11.25H11.25V9C11.25 8.59 11.59 8.25 12 8.25C12.41 8.25 12.75 8.59 12.75 9V11.25H15C15.41 11.25 15.75 11.59 15.75 12ZM21.75 12C21.75 17.38 17.38 21.75 12 21.75C6.62 21.75 2.25 17.38 2.25 12C2.25 6.62 6.62 2.25 12 2.25C17.38 2.25 21.75 6.62 21.75 12ZM20.25 12C20.25 7.45 16.55 3.75 12 3.75C7.45 3.75 3.75 7.45 3.75 12C3.75 16.55 7.45 20.25 12 20.25C16.55 20.25 20.25 16.55 20.25 12Z"></path></svg>',"arrowleft-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.7475 7.9975C14.7475 8.4075 14.4075 8.7475 13.9975 8.7475H3.8075L7.5275 12.4675C7.8175 12.7575 7.8175 13.2375 7.5275 13.5275C7.3775 13.6775 7.1875 13.7475 6.9975 13.7475C6.8075 13.7475 6.6175 13.6775 6.4675 13.5275L1.4675 8.5275C1.1775 8.2375 1.1775 7.7575 1.4675 7.4675L6.4675 2.4675C6.7575 2.1775 7.2375 2.1775 7.5275 2.4675C7.8175 2.7575 7.8175 3.2375 7.5275 3.5275L3.8075 7.2475H13.9975C14.4075 7.2475 14.7475 7.5875 14.7475 7.9975Z"></path></svg>',"arrowright-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.53 8.5275L9.53 13.5275C9.38 13.6775 9.19 13.7475 9 13.7475C8.81 13.7475 8.62 13.6775 8.47 13.5275C8.18 13.2375 8.18 12.7575 8.47 12.4675L12.19 8.7475H2C1.59 8.7475 1.25 8.4075 1.25 7.9975C1.25 7.5875 1.59 7.2475 2 7.2475H12.19L8.47 3.5275C8.18 3.2375 8.18 2.7575 8.47 2.4675C8.76 2.1775 9.24 2.1775 9.53 2.4675L14.53 7.4675C14.82 7.7575 14.82 8.2375 14.53 8.5275Z"></path></svg>',"camera-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.19 4.25H17.12C16.72 4.25 16.35 4.03 16.17 3.67C15.73 2.8 14.86 2.25 13.88 2.25H10.12C9.14 2.25 8.27 2.79 7.83 3.67C7.65 4.03 7.29 4.25 6.88 4.25H4.81C3.4 4.25 2.25 5.4 2.25 6.81V18.19C2.25 19.6 3.4 20.75 4.81 20.75H19.19C20.6 20.75 21.75 19.6 21.75 18.19V6.81C21.75 5.4 20.6 4.25 19.19 4.25ZM20.25 18.19C20.25 18.77 19.78 19.25 19.19 19.25H4.81C4.23 19.25 3.75 18.78 3.75 18.19V6.81C3.75 6.23 4.22 5.75 4.81 5.75H6.88C7.86 5.75 8.73 5.21 9.17 4.33C9.35 3.97 9.71 3.75 10.12 3.75H13.88C14.28 3.75 14.65 3.97 14.83 4.33C15.27 5.2 16.14 5.75 17.12 5.75H19.19C19.77 5.75 20.25 6.22 20.25 6.81V18.19ZM12 6.25C8.83 6.25 6.25 8.83 6.25 12C6.25 15.17 8.83 17.75 12 17.75C15.17 17.75 17.75 15.17 17.75 12C17.75 8.83 15.17 6.25 12 6.25ZM12 16.25C9.66 16.25 7.75 14.34 7.75 12C7.75 9.66 9.66 7.75 12 7.75C14.34 7.75 16.25 9.66 16.25 12C16.25 14.34 14.34 16.25 12 16.25ZM14.75 12C14.75 13.52 13.52 14.75 12 14.75C11.59 14.75 11.25 14.41 11.25 14C11.25 13.59 11.59 13.25 12 13.25C12.69 13.25 13.25 12.69 13.25 12C13.25 11.59 13.59 11.25 14 11.25C14.41 11.25 14.75 11.59 14.75 12Z"></path></svg>',"camera-32x32":'<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M25 7.25H22.19C21.73 7.25 21.31 7 21.09 6.59L20.89 6.22C20.23 5.01 18.97 4.25 17.59 4.25H14.41C13.03 4.25 11.77 5 11.11 6.22L10.91 6.6C10.69 7 10.27 7.26 9.81 7.26H7C4.93 7.26 3.25 8.94 3.25 11.01V24.01C3.25 26.08 4.93 27.76 7 27.76H25C27.07 27.76 28.75 26.08 28.75 24.01V11C28.75 8.93 27.07 7.25 25 7.25ZM27.25 24C27.25 25.24 26.24 26.25 25 26.25H7C5.76 26.25 4.75 25.24 4.75 24V11C4.75 9.76 5.76 8.75 7 8.75H9.81C10.82 8.75 11.75 8.2 12.23 7.31L12.43 6.94C12.82 6.21 13.58 5.76 14.41 5.76H17.59C18.42 5.76 19.18 6.21 19.57 6.94L19.77 7.31C20.25 8.2 21.18 8.76 22.19 8.76H25C26.24 8.76 27.25 9.77 27.25 11.01V24.01V24ZM16 10.25C12.28 10.25 9.25 13.28 9.25 17C9.25 20.72 12.28 23.75 16 23.75C19.72 23.75 22.75 20.72 22.75 17C22.75 13.28 19.72 10.25 16 10.25ZM16 22.25C13.11 22.25 10.75 19.89 10.75 17C10.75 14.11 13.11 11.75 16 11.75C18.89 11.75 21.25 14.11 21.25 17C21.25 19.89 18.89 22.25 16 22.25ZM19.75 17C19.75 19.07 18.07 20.75 16 20.75C15.59 20.75 15.25 20.41 15.25 20C15.25 19.59 15.59 19.25 16 19.25C17.24 19.25 18.25 18.24 18.25 17C18.25 16.59 18.59 16.25 19 16.25C19.41 16.25 19.75 16.59 19.75 17Z"></path></svg>',"cancel-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.8099 11.75L15.2799 9.28C15.5699 8.99 15.5699 8.51 15.2799 8.22C14.9899 7.93 14.5099 7.93 14.2199 8.22L11.7499 10.69L9.27994 8.22C8.98994 7.93 8.50994 7.93 8.21994 8.22C7.92994 8.51 7.92994 8.99 8.21994 9.28L10.6899 11.75L8.21994 14.22C7.92994 14.51 7.92994 14.99 8.21994 15.28C8.36994 15.43 8.55994 15.5 8.74994 15.5C8.93994 15.5 9.12994 15.43 9.27994 15.28L11.7499 12.81L14.2199 15.28C14.3699 15.43 14.5599 15.5 14.7499 15.5C14.9399 15.5 15.1299 15.43 15.2799 15.28C15.5699 14.99 15.5699 14.51 15.2799 14.22L12.8099 11.75Z"></path></svg>',"check-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.0275 5.0275L6.5275 12.5275C6.3775 12.6775 6.1875 12.7475 5.9975 12.7475C5.8075 12.7475 5.6175 12.6775 5.4675 12.5275L2.4675 9.5275C2.1775 9.2375 2.1775 8.7575 2.4675 8.4675C2.7575 8.1775 3.2375 8.1775 3.5275 8.4675L5.9975 10.9375L12.9675 3.9675C13.2575 3.6775 13.7375 3.6775 14.0275 3.9675C14.3175 4.2575 14.3175 4.7375 14.0275 5.0275Z"></path></svg>',"check-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.5275 7.5275L9.5275 17.5275C9.3775 17.6775 9.1875 17.7475 8.9975 17.7475C8.8075 17.7475 8.6175 17.6775 8.4675 17.5275L4.4675 13.5275C4.1775 13.2375 4.1775 12.7575 4.4675 12.4675C4.7575 12.1775 5.2375 12.1775 5.5275 12.4675L8.9975 15.9375L18.4675 6.4675C18.7575 6.1775 19.2375 6.1775 19.5275 6.4675C19.8175 6.7575 19.8175 7.2375 19.5275 7.5275Z"></path></svg>',"chevrondown-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M16.5275 10.5275L12.5275 14.5275C12.3775 14.6775 12.1875 14.7475 11.9975 14.7475C11.8075 14.7475 11.6175 14.6775 11.4675 14.5275L7.4675 10.5275C7.1775 10.2375 7.1775 9.7575 7.4675 9.4675C7.7575 9.1775 8.2375 9.1775 8.5275 9.4675L11.9975 12.9375L15.4675 9.4675C15.7575 9.1775 16.2375 9.1775 16.5275 9.4675C16.8175 9.7575 16.8175 10.2375 16.5275 10.5275Z"></path></svg>',"chevronright-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.35 8.34627L7.35 12.3463C7.25 12.4463 7.12 12.4963 7 12.4963C6.88 12.4963 6.74 12.4463 6.65 12.3463C6.45 12.1463 6.45 11.8363 6.65 11.6363L10.3 7.98627L6.65 4.34627C6.45 4.15627 6.45 3.83627 6.65 3.64627C6.85 3.45627 7.16 3.44627 7.35 3.64627L11.35 7.64627C11.55 7.84627 11.55 8.15627 11.35 8.35627V8.34627Z"></path></svg>',"clear-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M12.35 11.65C12.55 11.85 12.55 12.16 12.35 12.36C12.25 12.46 12.12 12.51 12 12.51C11.88 12.51 11.74 12.46 11.65 12.36L8 8.71L4.35 12.36C4.25 12.46 4.12 12.51 4 12.51C3.88 12.51 3.74 12.46 3.65 12.36C3.45 12.16 3.45 11.85 3.65 11.65L7.3 8L3.65 4.35C3.45 4.16 3.45 3.84 3.65 3.65C3.85 3.46 4.16 3.45 4.35 3.65L8 7.3L11.65 3.65C11.85 3.45 12.16 3.45 12.36 3.65C12.56 3.85 12.56 4.16 12.36 4.36L8.71 8.01L12.36 11.66L12.35 11.65Z"></path></svg>',"clear-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.12 10.9325C20.64 10.4125 20.93 9.7225 20.93 8.9925C20.93 8.2625 20.64 7.5725 20.12 7.0525L16.95 3.8825C15.88 2.8125 14.13 2.8125 13.06 3.8825L3.88 13.0525C3.36 13.5725 3.07 14.2625 3.07 14.9925C3.07 15.7225 3.36 16.4125 3.88 16.9325L5.64 18.6925C6.57 19.6225 7.78 20.0825 9 20.0825C10.22 20.0825 11.43 19.6225 12.36 18.6925L20.12 10.9325ZM14.12 4.9325C14.36 4.6925 14.67 4.5625 15 4.5625C15.33 4.5625 15.65 4.6925 15.88 4.9325L19.05 8.1025C19.54 8.5925 19.54 9.3825 19.05 9.8725L12.99 15.9325L8.05 10.9925L14.12 4.9325ZM6.7 17.6325L4.94 15.8725C4.45 15.3825 4.45 14.5925 4.94 14.1025L7 12.0425L11.94 16.9825L11.3 17.6225C10.07 18.8525 7.93 18.8525 6.7 17.6225V17.6325ZM22.75 20.9925C22.75 21.4025 22.41 21.7425 22 21.7425H14C13.59 21.7425 13.25 21.4025 13.25 20.9925C13.25 20.5825 13.59 20.2425 14 20.2425H22C22.41 20.2425 22.75 20.5825 22.75 20.9925ZM4.75 20.9925C4.75 21.4025 4.41 21.7425 4 21.7425H2C1.59 21.7425 1.25 21.4025 1.25 20.9925C1.25 20.5825 1.59 20.2425 2 20.2425H4C4.41 20.2425 4.75 20.5825 4.75 20.9925Z"></path></svg>',"close-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13.5275 12.4675C13.8175 12.7575 13.8175 13.2375 13.5275 13.5275C13.3775 13.6775 13.1875 13.7475 12.9975 13.7475C12.8075 13.7475 12.6175 13.6775 12.4675 13.5275L7.9975 9.0575L3.5275 13.5275C3.3775 13.6775 3.1875 13.7475 2.9975 13.7475C2.8075 13.7475 2.6175 13.6775 2.4675 13.5275C2.1775 13.2375 2.1775 12.7575 2.4675 12.4675L6.9375 7.9975L2.4675 3.5275C2.1775 3.2375 2.1775 2.7575 2.4675 2.4675C2.7575 2.1775 3.2375 2.1775 3.5275 2.4675L7.9975 6.9375L12.4675 2.4675C12.7575 2.1775 13.2375 2.1775 13.5275 2.4675C13.8175 2.7575 13.8175 3.2375 13.5275 3.5275L9.0575 7.9975L13.5275 12.4675Z"></path></svg>',"close-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.5275 18.4675C19.8175 18.7575 19.8175 19.2375 19.5275 19.5275C19.3775 19.6775 19.1875 19.7475 18.9975 19.7475C18.8075 19.7475 18.6175 19.6775 18.4675 19.5275L11.9975 13.0575L5.5275 19.5275C5.3775 19.6775 5.1875 19.7475 4.9975 19.7475C4.8075 19.7475 4.6175 19.6775 4.4675 19.5275C4.1775 19.2375 4.1775 18.7575 4.4675 18.4675L10.9375 11.9975L4.4675 5.5275C4.1775 5.2375 4.1775 4.7575 4.4675 4.4675C4.7575 4.1775 5.2375 4.1775 5.5275 4.4675L11.9975 10.9375L18.4675 4.4675C18.7575 4.1775 19.2375 4.1775 19.5275 4.4675C19.8175 4.7575 19.8175 5.2375 19.5275 5.5275L13.0575 11.9975L19.5275 18.4675Z"></path></svg>',"collapse-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.75 8C11.75 8.41 11.41 8.75 11 8.75H5C4.59 8.75 4.25 8.41 4.25 8C4.25 7.59 4.59 7.25 5 7.25H11C11.41 7.25 11.75 7.59 11.75 8Z"></path></svg>',"collapsedetails-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.75 8C11.75 8.41 11.41 8.75 11 8.75H5C4.59 8.75 4.25 8.41 4.25 8C4.25 7.59 4.59 7.25 5 7.25H11C11.41 7.25 11.75 7.59 11.75 8Z"></path></svg>',"delete-16x16":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13 3.25H10.75V3C10.75 2.04 9.96 1.25 9 1.25H7C6.04 1.25 5.25 2.04 5.25 3V3.25H3C2.59 3.25 2.25 3.59 2.25 4C2.25 4.41 2.59 4.75 3 4.75H3.25V13C3.25 13.96 4.04 14.75 5 14.75H11C11.96 14.75 12.75 13.96 12.75 13V4.75H13C13.41 4.75 13.75 4.41 13.75 4C13.75 3.59 13.41 3.25 13 3.25ZM6.75 3C6.75 2.86 6.86 2.75 7 2.75H9C9.14 2.75 9.25 2.86 9.25 3V3.25H6.75V3ZM11.25 13C11.25 13.14 11.14 13.25 11 13.25H5C4.86 13.25 4.75 13.14 4.75 13V4.75H11.25V13ZM9.25 6.25C9.66 6.25 10 6.59 10 7V11C10 11.41 9.66 11.75 9.25 11.75C8.84 11.75 8.5 11.41 8.5 11V7C8.5 6.59 8.84 6.25 9.25 6.25ZM7.5 7V11C7.5 11.41 7.16 11.75 6.75 11.75C6.34 11.75 6 11.41 6 11V7C6 6.59 6.34 6.25 6.75 6.25C7.16 6.25 7.5 6.59 7.5 7Z"></path></svg>',"delete-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.75 9V17C12.75 17.41 12.41 17.75 12 17.75C11.59 17.75 11.25 17.41 11.25 17V9C11.25 8.59 11.59 8.25 12 8.25C12.41 8.25 12.75 8.59 12.75 9ZM14.25 9V17C14.25 17.41 14.59 17.75 15 17.75C15.41 17.75 15.75 17.41 15.75 17V9C15.75 8.59 15.41 8.25 15 8.25C14.59 8.25 14.25 8.59 14.25 9ZM9 8.25C8.59 8.25 8.25 8.59 8.25 9V17C8.25 17.41 8.59 17.75 9 17.75C9.41 17.75 9.75 17.41 9.75 17V9C9.75 8.59 9.41 8.25 9 8.25ZM20.75 6C20.75 6.41 20.41 6.75 20 6.75H18.75V18C18.75 19.52 17.52 20.75 16 20.75H8C6.48 20.75 5.25 19.52 5.25 18V6.75H4C3.59 6.75 3.25 6.41 3.25 6C3.25 5.59 3.59 5.25 4 5.25H8.25V4C8.25 3.04 9.04 2.25 10 2.25H14C14.96 2.25 15.75 3.04 15.75 4V5.25H20C20.41 5.25 20.75 5.59 20.75 6ZM9.75 5.25H14.25V4C14.25 3.86 14.14 3.75 14 3.75H10C9.86 3.75 9.75 3.86 9.75 4V5.25ZM17.25 6.75H6.75V18C6.75 18.69 7.31 19.25 8 19.25H16C16.69 19.25 17.25 18.69 17.25 18V6.75Z"></path></svg>',"drag-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14.5 8.75C15.19 8.75 15.75 8.19 15.75 7.5C15.75 6.81 15.19 6.25 14.5 6.25C13.81 6.25 13.25 6.81 13.25 7.5C13.25 8.19 13.81 8.75 14.5 8.75ZM14.5 7.25C14.64 7.25 14.75 7.36 14.75 7.5C14.75 7.78 14.25 7.78 14.25 7.5C14.25 7.36 14.36 7.25 14.5 7.25ZM9.5 6.25C8.81 6.25 8.25 6.81 8.25 7.5C8.25 8.19 8.81 8.75 9.5 8.75C10.19 8.75 10.75 8.19 10.75 7.5C10.75 6.81 10.19 6.25 9.5 6.25ZM9.25 7.5C9.25 7.36 9.36 7.25 9.5 7.25C9.64 7.25 9.75 7.36 9.75 7.5C9.75 7.78 9.25 7.78 9.25 7.5ZM14.5 11.25C13.81 11.25 13.25 11.81 13.25 12.5C13.25 13.19 13.81 13.75 14.5 13.75C15.19 13.75 15.75 13.19 15.75 12.5C15.75 11.81 15.19 11.25 14.5 11.25ZM14.25 12.5C14.25 12.36 14.36 12.25 14.5 12.25C14.64 12.25 14.75 12.36 14.75 12.5C14.75 12.78 14.25 12.78 14.25 12.5ZM9.5 11.25C8.81 11.25 8.25 11.81 8.25 12.5C8.25 13.19 8.81 13.75 9.5 13.75C10.19 13.75 10.75 13.19 10.75 12.5C10.75 11.81 10.19 11.25 9.5 11.25ZM9.25 12.5C9.25 12.36 9.36 12.25 9.5 12.25C9.64 12.25 9.75 12.36 9.75 12.5C9.75 12.78 9.25 12.78 9.25 12.5ZM14.5 16.25C13.81 16.25 13.25 16.81 13.25 17.5C13.25 18.19 13.81 18.75 14.5 18.75C15.19 18.75 15.75 18.19 15.75 17.5C15.75 16.81 15.19 16.25 14.5 16.25ZM14.25 17.5C14.25 17.36 14.36 17.25 14.5 17.25C14.64 17.25 14.75 17.36 14.75 17.5C14.75 17.78 14.25 17.78 14.25 17.5ZM9.5 16.25C8.81 16.25 8.25 16.81 8.25 17.5C8.25 18.19 8.81 18.75 9.5 18.75C10.19 18.75 10.75 18.19 10.75 17.5C10.75 16.81 10.19 16.25 9.5 16.25ZM9.25 17.5C9.25 17.36 9.36 17.25 9.5 17.25C9.64 17.25 9.75 17.36 9.75 17.5C9.75 17.78 9.25 17.78 9.25 17.5Z"></path></svg>',"draghorizontal-24x16":'<svg viewBox="0 0 24 16" xmlns="http://www.w3.org/2000/svg"><path d="M17.5 9.25C16.81 9.25 16.25 9.81 16.25 10.5C16.25 11.19 16.81 11.75 17.5 11.75C18.19 11.75 18.75 11.19 18.75 10.5C18.75 9.81 18.19 9.25 17.5 9.25ZM17.25 10.5C17.25 10.36 17.36 10.25 17.5 10.25C17.64 10.25 17.75 10.36 17.75 10.5C17.75 10.78 17.25 10.78 17.25 10.5ZM17.5 6.75C18.19 6.75 18.75 6.19 18.75 5.5C18.75 4.81 18.19 4.25 17.5 4.25C16.81 4.25 16.25 4.81 16.25 5.5C16.25 6.19 16.81 6.75 17.5 6.75ZM17.5 5.25C17.64 5.25 17.75 5.36 17.75 5.5C17.75 5.78 17.25 5.78 17.25 5.5C17.25 5.36 17.36 5.25 17.5 5.25ZM12.5 9.25C11.81 9.25 11.25 9.81 11.25 10.5C11.25 11.19 11.81 11.75 12.5 11.75C13.19 11.75 13.75 11.19 13.75 10.5C13.75 9.81 13.19 9.25 12.5 9.25ZM12.25 10.5C12.25 10.36 12.36 10.25 12.5 10.25C12.64 10.25 12.75 10.36 12.75 10.5C12.75 10.78 12.25 10.78 12.25 10.5ZM12.5 4.25C11.81 4.25 11.25 4.81 11.25 5.5C11.25 6.19 11.81 6.75 12.5 6.75C13.19 6.75 13.75 6.19 13.75 5.5C13.75 4.81 13.19 4.25 12.5 4.25ZM12.25 5.5C12.25 5.36 12.36 5.25 12.5 5.25C12.64 5.25 12.75 5.36 12.75 5.5C12.75 5.78 12.25 5.78 12.25 5.5ZM7.5 9.25C6.81 9.25 6.25 9.81 6.25 10.5C6.25 11.19 6.81 11.75 7.5 11.75C8.19 11.75 8.75 11.19 8.75 10.5C8.75 9.81 8.19 9.25 7.5 9.25ZM7.25 10.5C7.25 10.36 7.36 10.25 7.5 10.25C7.64 10.25 7.75 10.36 7.75 10.5C7.75 10.78 7.25 10.78 7.25 10.5ZM7.5 4.25C6.81 4.25 6.25 4.81 6.25 5.5C6.25 6.19 6.81 6.75 7.5 6.75C8.19 6.75 8.75 6.19 8.75 5.5C8.75 4.81 8.19 4.25 7.5 4.25ZM7.25 5.5C7.25 5.36 7.36 5.25 7.5 5.25C7.64 5.25 7.75 5.36 7.75 5.5C7.75 5.78 7.25 5.78 7.25 5.5Z"></path></svg>',"editsmall-16x16":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.1209 3.05249L12.9509 2.88249C11.8809 1.81249 10.1309 1.81249 9.06089 2.88249L3.47089 8.46249C3.37089 8.56249 3.31089 8.68249 3.27089 8.81249L2.27089 12.8125C2.21089 13.0625 2.28089 13.3425 2.47089 13.5225C2.61089 13.6625 2.80089 13.7425 3.00089 13.7425C3.06089 13.7425 3.12089 13.7425 3.18089 13.7225L7.18089 12.7225C7.31089 12.6925 7.43089 12.6225 7.53089 12.5225L13.1209 6.93249C14.1909 5.86249 14.1909 4.11249 13.1209 3.04249V3.05249ZM6.62089 11.3125L4.04089 11.9625L4.69089 9.38249L8.01089 6.06249L9.95089 8.00249L6.63089 11.3225L6.62089 11.3125ZM12.0609 5.87249L11.0009 6.93249L9.06089 4.99249L10.1209 3.93249C10.6109 3.44249 11.4009 3.44249 11.8909 3.93249L12.0609 4.10249C12.5509 4.59249 12.5509 5.38249 12.0609 5.87249Z"></path></svg>',"expand-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.75 8C11.75 8.41 11.41 8.75 11 8.75H8.75V11C8.75 11.41 8.41 11.75 8 11.75C7.59 11.75 7.25 11.41 7.25 11V8.75H5C4.59 8.75 4.25 8.41 4.25 8C4.25 7.59 4.59 7.25 5 7.25H7.25V5C7.25 4.59 7.59 4.25 8 4.25C8.41 4.25 8.75 4.59 8.75 5V7.25H11C11.41 7.25 11.75 7.59 11.75 8Z"></path></svg>',"expanddetails-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.75 8C11.75 8.41 11.41 8.75 11 8.75H8.75V11C8.75 11.41 8.41 11.75 8 11.75C7.59 11.75 7.25 11.41 7.25 11V8.75H5C4.59 8.75 4.25 8.41 4.25 8C4.25 7.59 4.59 7.25 5 7.25H7.25V5C7.25 4.59 7.59 4.25 8 4.25C8.41 4.25 8.75 4.59 8.75 5V7.25H11C11.41 7.25 11.75 7.59 11.75 8Z"></path></svg>',"file-72x72":'<svg viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M62.83 12.83L53.17 3.17C52.7982 2.79866 52.357 2.50421 51.8714 2.30346C51.3858 2.1027 50.8654 1.99959 50.34 2H14C12.4087 2 10.8826 2.63214 9.75735 3.75736C8.63214 4.88258 8 6.4087 8 8V64C8 65.5913 8.63214 67.1174 9.75735 68.2426C10.8826 69.3679 12.4087 70 14 70H58C59.5913 70 61.1174 69.3679 62.2426 68.2426C63.3679 67.1174 64 65.5913 64 64V15.66C64.0004 15.1346 63.8973 14.6142 63.6965 14.1286C63.4958 13.643 63.2013 13.2018 62.83 12.83ZM52 4.83L61.17 14H56C54.9391 14 53.9217 13.5786 53.1716 12.8284C52.4214 12.0783 52 11.0609 52 10V4.83ZM62 64C62 65.0609 61.5786 66.0783 60.8284 66.8284C60.0783 67.5786 59.0609 68 58 68H14C12.9391 68 11.9217 67.5786 11.1716 66.8284C10.4214 66.0783 10 65.0609 10 64V8C10 6.93914 10.4214 5.92172 11.1716 5.17157C11.9217 4.42143 12.9391 4 14 4H50V10C50 11.5913 50.6321 13.1174 51.7574 14.2426C52.8826 15.3679 54.4087 16 56 16H62V64ZM22 26H50V28H22V26ZM22 32H50V34H22V32ZM22 38H50V40H22V38ZM22 44H50V46H22V44Z"></path></svg>',"flip-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14.53 17.4775C14.82 17.7675 14.82 18.2475 14.53 18.5375L11.53 21.5375C11.38 21.6875 11.19 21.7575 11 21.7575C10.81 21.7575 10.62 21.6875 10.47 21.5375C10.18 21.2475 10.18 20.7675 10.47 20.4775L12.2 18.7475C12.13 18.7475 12.07 18.7475 12 18.7475C6.62 18.7475 2.25 15.7475 2.25 12.0575C2.25 10.2975 3.22 8.6375 4.99 7.3875C5.33 7.1475 5.8 7.2275 6.03 7.5675C6.27 7.9075 6.19 8.3775 5.85 8.6075C4.49 9.5675 3.74 10.7875 3.74 12.0575C3.74 14.9175 7.44 17.2475 11.99 17.2475C12.05 17.2475 12.11 17.2475 12.17 17.2475L10.46 15.5375C10.17 15.2475 10.17 14.7675 10.46 14.4775C10.75 14.1875 11.23 14.1875 11.52 14.4775L14.52 17.4775H14.53ZM12 5.2575C11.93 5.2575 11.87 5.2575 11.8 5.2575L13.53 3.5275C13.82 3.2375 13.82 2.7575 13.53 2.4675C13.24 2.1775 12.76 2.1775 12.47 2.4675L9.47 5.4675C9.18 5.7575 9.18 6.2375 9.47 6.5275L12.47 9.5275C12.62 9.6775 12.81 9.7475 13 9.7475C13.19 9.7475 13.38 9.6775 13.53 9.5275C13.82 9.2375 13.82 8.7575 13.53 8.4675L11.82 6.7575C11.88 6.7575 11.94 6.7575 12 6.7575C16.55 6.7575 20.25 9.0875 20.25 11.9475C20.25 13.2075 19.5 14.4375 18.14 15.3975C17.8 15.6375 17.72 16.1075 17.96 16.4475C18.11 16.6575 18.34 16.7675 18.57 16.7675C18.72 16.7675 18.87 16.7275 19 16.6275C20.77 15.3775 21.75 13.7175 21.75 11.9575C21.75 8.2675 17.38 5.2675 12 5.2675V5.2575Z"></path></svg>',"folder-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.72 9.24C21.45 8.92 21.12 8.67 20.75 8.5V8C20.75 6.48 19.52 5.25 18 5.25H10.65C10.32 4.1 9.26 3.25 8 3.25H6C4.48 3.25 3.25 4.48 3.25 6V18C3.25 19.52 4.48 20.75 6 20.75H18.33C19.66 20.75 20.8 19.8 21.04 18.49L22.31 11.49C22.46 10.69 22.24 9.86 21.72 9.24ZM4.75 18V6C4.75 5.31 5.31 4.75 6 4.75H8C8.69 4.75 9.25 5.31 9.25 6C9.25 6.41 9.59 6.75 10 6.75H18C18.69 6.75 19.25 7.31 19.25 8V8.25H9.27C7.94 8.25 6.8 9.2 6.56 10.51L5.29 17.51C5.19 18.07 5.27 18.64 5.51 19.15C5.06 18.96 4.75 18.52 4.75 18ZM20.83 11.22L19.56 18.22C19.45 18.81 18.94 19.25 18.33 19.25H8C7.63 19.25 7.28 19.09 7.04 18.8C6.8 18.51 6.7 18.14 6.77 17.78L8.04 10.78C8.15 10.19 8.66 9.75 9.27 9.75H19.6C19.97 9.75 20.32 9.91 20.56 10.2C20.8 10.49 20.9 10.86 20.83 11.22Z"></path></svg>',"fullsize-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M12 3.25H4C3.04 3.25 2.25 4.04 2.25 5V11C2.25 11.96 3.04 12.75 4 12.75H12C12.96 12.75 13.75 11.96 13.75 11V5C13.75 4.04 12.96 3.25 12 3.25ZM12.25 11C12.25 11.14 12.14 11.25 12 11.25H4C3.86 11.25 3.75 11.14 3.75 11V5C3.75 4.86 3.86 4.75 4 4.75H12C12.14 4.75 12.25 4.86 12.25 5V11Z"></path></svg>',"image-48x48":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M33 10.25H15C12.38 10.25 10.25 12.38 10.25 15V33C10.25 35.62 12.38 37.75 15 37.75H33C35.62 37.75 37.75 35.62 37.75 33V15C37.75 12.38 35.62 10.25 33 10.25ZM36.25 33C36.25 34.79 34.79 36.25 33 36.25H15C13.21 36.25 11.75 34.79 11.75 33V15C11.75 13.21 13.21 11.75 15 11.75H33C34.79 11.75 36.25 13.21 36.25 15V33ZM30.5 14.25C28.71 14.25 27.25 15.71 27.25 17.5C27.25 19.29 28.71 20.75 30.5 20.75C32.29 20.75 33.75 19.29 33.75 17.5C33.75 15.71 32.29 14.25 30.5 14.25ZM30.5 19.25C29.54 19.25 28.75 18.46 28.75 17.5C28.75 16.54 29.54 15.75 30.5 15.75C31.46 15.75 32.25 16.54 32.25 17.5C32.25 18.46 31.46 19.25 30.5 19.25ZM29.26 26.28C28.94 25.92 28.49 25.71 28.01 25.7C27.54 25.68 27.07 25.87 26.73 26.2L24.95 27.94L22.28 25.23C21.94 24.89 21.5 24.71 21 24.71C20.52 24.71 20.06 24.93 19.74 25.28L14.74 30.78C14.25 31.3 14.12 32.06 14.41 32.72C14.69 33.36 15.28 33.75 15.95 33.75H32.07C32.74 33.75 33.33 33.35 33.61 32.72C33.89 32.06 33.77 31.31 33.29 30.79L29.27 26.29L29.26 26.28ZM32.22 32.12C32.18 32.2 32.13 32.25 32.06 32.25H15.94C15.87 32.25 15.81 32.21 15.78 32.12C15.77 32.09 15.71 31.93 15.83 31.8L20.84 26.29C20.9 26.22 20.99 26.21 21.02 26.21C21.06 26.21 21.14 26.22 21.2 26.29L24.4 29.54C24.69 29.83 25.16 29.84 25.46 29.54L27.77 27.27C27.83 27.21 27.9 27.2 27.94 27.2C28.01 27.2 28.06 27.21 28.13 27.28L32.16 31.79C32.16 31.79 32.16 31.79 32.17 31.8C32.29 31.93 32.23 32.09 32.22 32.12Z"></path></svg>',"loading-48x48":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_19679_369428)"><path opacity="0.1" d="M24 40C15.18 40 8 32.82 8 24C8 15.18 15.18 8 24 8C32.82 8 40 15.18 40 24C40 32.82 32.82 40 24 40ZM24 12C17.38 12 12 17.38 12 24C12 30.62 17.38 36 24 36C30.62 36 36 30.62 36 24C36 17.38 30.62 12 24 12Z" fill="black" fill-opacity="0.91"></path><path d="M10 26C8.9 26 8 25.1 8 24C8 15.18 15.18 8 24 8C25.1 8 26 8.9 26 10C26 11.1 25.1 12 24 12C17.38 12 12 17.38 12 24C12 25.1 11.1 26 10 26Z"></path></g><defs><clipPath id="clip0_19679_369428"><rect width="32" height="32" fill="white" transform="translate(8 8)"></rect></clipPath></defs></svg>',"maximize-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13.75 3V7C13.75 7.41 13.41 7.75 13 7.75C12.59 7.75 12.25 7.41 12.25 7V4.81L9.53 7.53C9.38 7.68 9.19 7.75 9 7.75C8.81 7.75 8.62 7.68 8.47 7.53C8.18 7.24 8.18 6.76 8.47 6.47L11.19 3.75H9C8.59 3.75 8.25 3.41 8.25 3C8.25 2.59 8.59 2.25 9 2.25H13C13.1 2.25 13.19 2.27 13.29 2.31C13.47 2.39 13.62 2.53 13.7 2.72C13.74 2.81 13.76 2.91 13.76 3.01L13.75 3ZM7.53 8.47C7.24 8.18 6.76 8.18 6.47 8.47L3.75 11.19V9C3.75 8.59 3.41 8.25 3 8.25C2.59 8.25 2.25 8.59 2.25 9V13C2.25 13.1 2.27 13.19 2.31 13.29C2.39 13.47 2.53 13.62 2.72 13.7C2.81 13.74 2.91 13.76 3.01 13.76H7.01C7.42 13.76 7.76 13.42 7.76 13.01C7.76 12.6 7.42 12.26 7.01 12.26H4.82L7.54 9.54C7.83 9.25 7.83 8.77 7.54 8.48L7.53 8.47Z"></path></svg>',"minimize-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13.75 8C13.75 8.41 13.41 8.75 13 8.75H3C2.59 8.75 2.25 8.41 2.25 8C2.25 7.59 2.59 7.25 3 7.25H13C13.41 7.25 13.75 7.59 13.75 8Z"></path></svg>',"more-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 10.25C11.04 10.25 10.25 11.04 10.25 12C10.25 12.96 11.04 13.75 12 13.75C12.96 13.75 13.75 12.96 13.75 12C13.75 11.04 12.96 10.25 12 10.25ZM11.75 12C11.75 11.86 11.86 11.75 12 11.75C12.14 11.75 12.25 11.86 12.25 12C12.25 12.28 11.75 12.28 11.75 12ZM19 10.25C18.04 10.25 17.25 11.04 17.25 12C17.25 12.96 18.04 13.75 19 13.75C19.96 13.75 20.75 12.96 20.75 12C20.75 11.04 19.96 10.25 19 10.25ZM18.75 12C18.75 11.86 18.86 11.75 19 11.75C19.14 11.75 19.25 11.86 19.25 12C19.25 12.28 18.75 12.28 18.75 12ZM5 10.25C4.04 10.25 3.25 11.04 3.25 12C3.25 12.96 4.04 13.75 5 13.75C5.96 13.75 6.75 12.96 6.75 12C6.75 11.04 5.96 10.25 5 10.25ZM4.75 12C4.75 11.86 4.86 11.75 5 11.75C5.14 11.75 5.25 11.86 5.25 12C5.25 12.28 4.75 12.28 4.75 12Z"></path></svg>',"navmenu-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.25 7C3.25 6.59 3.59 6.25 4 6.25H15C15.41 6.25 15.75 6.59 15.75 7C15.75 7.41 15.41 7.75 15 7.75H4C3.59 7.75 3.25 7.41 3.25 7ZM20 11.25H4C3.59 11.25 3.25 11.59 3.25 12C3.25 12.41 3.59 12.75 4 12.75H20C20.41 12.75 20.75 12.41 20.75 12C20.75 11.59 20.41 11.25 20 11.25ZM9 16.25H4C3.59 16.25 3.25 16.59 3.25 17C3.25 17.41 3.59 17.75 4 17.75H9C9.41 17.75 9.75 17.41 9.75 17C9.75 16.59 9.41 16.25 9 16.25Z"></path></svg>',"noimage-48x48":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M30.4975 14.2475C28.7075 14.2475 27.2475 15.7075 27.2475 17.4975C27.2475 19.2875 28.7075 20.7475 30.4975 20.7475C32.2875 20.7475 33.7475 19.2875 33.7475 17.4975C33.7475 15.7075 32.2875 14.2475 30.4975 14.2475ZM30.4975 19.2475C29.5375 19.2475 28.7475 18.4575 28.7475 17.4975C28.7475 16.5375 29.5375 15.7475 30.4975 15.7475C31.4575 15.7475 32.2475 16.5375 32.2475 17.4975C32.2475 18.4575 31.4575 19.2475 30.4975 19.2475ZM13.5175 11.2175C13.4375 10.8075 13.7075 10.4175 14.1175 10.3375C14.4275 10.2775 14.7175 10.2475 14.9975 10.2475H32.9975C35.6175 10.2475 37.7475 12.3775 37.7475 14.9975V32.9975C37.7475 33.2775 37.7175 33.5675 37.6575 33.8775C37.5875 34.2375 37.2775 34.4875 36.9175 34.4875C36.8675 34.4875 36.8275 34.4875 36.7775 34.4775C36.3675 34.3975 36.1075 34.0075 36.1775 33.5975C36.2175 33.3775 36.2375 33.1775 36.2375 32.9975V14.9975C36.2375 13.2075 34.7775 11.7475 32.9875 11.7475H14.9975C14.8075 11.7475 14.6175 11.7675 14.3975 11.8075C13.9875 11.8875 13.5975 11.6175 13.5175 11.2075V11.2175ZM34.4775 36.7775C34.5575 37.1875 34.2875 37.5775 33.8775 37.6575C33.5675 37.7175 33.2775 37.7475 32.9975 37.7475H14.9975C12.3775 37.7475 10.2475 35.6175 10.2475 32.9975V14.9975C10.2475 14.7175 10.2775 14.4275 10.3375 14.1175C10.4175 13.7075 10.8075 13.4375 11.2175 13.5175C11.6275 13.5975 11.8875 13.9875 11.8175 14.3975C11.7775 14.6175 11.7575 14.8175 11.7575 14.9975V32.9975C11.7575 34.7875 13.2175 36.2475 15.0075 36.2475H33.0075C33.1975 36.2475 33.3875 36.2275 33.6075 36.1875C34.0075 36.1075 34.4075 36.3775 34.4875 36.7875L34.4775 36.7775ZM15.8275 31.7975C15.6975 31.9375 15.7575 32.0875 15.7775 32.1175C15.8175 32.1975 15.8675 32.2475 15.9375 32.2475H29.8175C30.2275 32.2475 30.5675 32.5875 30.5675 32.9975C30.5675 33.4075 30.2275 33.7475 29.8175 33.7475H15.9375C15.2675 33.7475 14.6775 33.3475 14.3975 32.7175C14.1075 32.0575 14.2375 31.2975 14.7275 30.7775L19.7275 25.2775C20.0475 24.9275 20.5075 24.7175 20.9875 24.7075C21.4875 24.7275 21.9375 24.8875 22.2675 25.2275L25.4675 28.4775C25.7575 28.7675 25.7575 29.2475 25.4675 29.5375C25.1675 29.8275 24.6975 29.8275 24.4075 29.5375L21.2075 26.2875C21.1475 26.2175 21.0675 26.1875 21.0275 26.2075C20.9875 26.2075 20.9075 26.2175 20.8475 26.2875L15.8375 31.7975H15.8275ZM38.5275 38.5275C38.3775 38.6775 38.1875 38.7475 37.9975 38.7475C37.8075 38.7475 37.6175 38.6775 37.4675 38.5275L9.4675 10.5275C9.1775 10.2375 9.1775 9.7575 9.4675 9.4675C9.7575 9.1775 10.2375 9.1775 10.5275 9.4675L38.5275 37.4675C38.8175 37.7575 38.8175 38.2375 38.5275 38.5275Z"></path></svg>',"ranking-arrows":'<svg viewBox="0 0 10 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 5L5 0L0 5H4V9H6V5H10Z"></path><path d="M6 19V15H4V19H0L5 24L10 19H6Z"></path></svg>',"rankingundefined-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.75 8C11.75 8.41 11.41 8.75 11 8.75H5C4.59 8.75 4.25 8.41 4.25 8C4.25 7.59 4.59 7.25 5 7.25H11C11.41 7.25 11.75 7.59 11.75 8Z"></path></svg>',"rating-star-2":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M24 39.5057L11.7226 45.9839C10.4095 46.6739 8.87606 45.5622 9.12525 44.096L11.4734 30.373L1.54411 20.6556C0.480254 19.6207 1.06489 17.8095 2.53128 17.5986L16.2559 15.5957L22.3994 3.10891C23.0512 1.77685 24.9488 1.77685 25.6102 3.10891L31.7441 15.5957L45.4687 17.5986C46.9351 17.8095 47.5197 19.6207 46.4559 20.6556L36.5266 30.373L38.8748 44.096C39.1239 45.5622 37.5905 46.6835 36.2774 45.9839L24 39.5057Z" fill="none" stroke-width="2"></path><path d="M24.3981 33.1305L24 32.9206L23.6019 33.1305L15.8715 37.2059L17.3542 28.5663L17.43 28.1246L17.1095 27.8113L10.83 21.6746L19.4965 20.4049L19.9405 20.3399L20.1387 19.9373L24 12.0936L27.8613 19.9373L28.0595 20.3399L28.5035 20.4049L37.17 21.6746L30.8905 27.8113L30.57 28.1246L30.6458 28.5663L32.1285 37.2059L24.3981 33.1305Z" stroke-width="1.70746"></path></svg>',"rating-star-small-2":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 19.3373L6.13001 22.4373C5.50001 22.7673 4.77001 22.2373 4.89001 21.5373L6.01001 14.9773L1.26001 10.3273C0.750007 9.83728 1.03001 8.96728 1.73001 8.86728L8.29001 7.90728L11.23 1.93728C11.54 1.29728 12.45 1.29728 12.77 1.93728L15.7 7.90728L22.26 8.86728C22.96 8.96728 23.24 9.83728 22.73 10.3273L17.98 14.9773L19.1 21.5373C19.22 22.2373 18.49 22.7773 17.86 22.4373L11.99 19.3373H12Z" fill="none" stroke-width="2"></path><path d="M12 15.9472L8.58001 17.7572L9.23001 13.9272L6.45001 11.2072L10.29 10.6472L12 7.17725L13.71 10.6472L17.55 11.2072L14.77 13.9272L15.42 17.7572L12 15.9472Z"></path></svg>',"rating-star-small":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g><path d="M12 19.3373L6.13001 22.4373C5.50001 22.7673 4.77001 22.2373 4.89001 21.5373L6.01001 14.9773L1.26001 10.3273C0.750007 9.83728 1.03001 8.96728 1.73001 8.86728L8.29001 7.90728L11.23 1.93728C11.54 1.29728 12.45 1.29728 12.77 1.93728L15.7 7.90728L22.26 8.86728C22.96 8.96728 23.24 9.83728 22.73 10.3273L17.98 14.9773L19.1 21.5373C19.22 22.2373 18.49 22.7773 17.86 22.4373L11.99 19.3373H12Z"></path></g></svg>',"rating-star":'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g><path d="M24 39.5057L11.7226 45.9839C10.4095 46.6739 8.87606 45.5622 9.12525 44.096L11.4734 30.373L1.54411 20.6556C0.480254 19.6207 1.06489 17.8095 2.53128 17.5986L16.2559 15.5957L22.3994 3.10891C23.0512 1.77685 24.9488 1.77685 25.6102 3.10891L31.7441 15.5957L45.4687 17.5986C46.9351 17.8095 47.5197 19.6207 46.4559 20.6556L36.5266 30.373L38.8748 44.096C39.1239 45.5622 37.5905 46.6835 36.2774 45.9839L24 39.5057Z"></path></g></svg>',"reorder-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.9444 10.75H15.0544C15.7144 10.75 16.3144 10.39 16.6144 9.80002C16.9144 9.22002 16.8644 8.52002 16.4844 7.98002L13.4244 3.71002C12.7644 2.79002 11.2344 2.79002 10.5744 3.71002L7.5244 7.99002C7.1444 8.53002 7.0944 9.22002 7.3944 9.81002C7.6944 10.4 8.2944 10.76 8.9544 10.76L8.9444 10.75ZM8.7444 8.86002L11.7944 4.58002C11.8644 4.49002 11.9544 4.48002 11.9944 4.48002C12.0344 4.48002 12.1344 4.49002 12.1944 4.58002L15.2544 8.86002C15.3344 8.97002 15.3044 9.07002 15.2744 9.12002C15.2444 9.17002 15.1844 9.26002 15.0544 9.26002H8.9444C8.8144 9.26002 8.7444 9.18002 8.7244 9.12002C8.7044 9.06002 8.6644 8.97002 8.7444 8.86002ZM15.0544 13.25H8.9444C8.2844 13.25 7.6844 13.61 7.3844 14.2C7.0844 14.78 7.1344 15.48 7.5144 16.02L10.5744 20.3C10.9044 20.76 11.4344 21.03 11.9944 21.03C12.5544 21.03 13.0944 20.76 13.4144 20.3L16.4744 16.02C16.8544 15.48 16.9044 14.79 16.6044 14.2C16.3044 13.61 15.7044 13.25 15.0444 13.25H15.0544ZM15.2644 15.15L12.2044 19.43C12.0744 19.61 11.9244 19.61 11.7944 19.43L8.7344 15.15C8.6544 15.04 8.6844 14.94 8.7144 14.89C8.7444 14.84 8.8044 14.75 8.9344 14.75H15.0444C15.1744 14.75 15.2444 14.83 15.2644 14.89C15.2844 14.95 15.3244 15.04 15.2444 15.15H15.2644Z"></path></svg>',"restoredown-16x16":'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.69 8.71C7.73 8.8 7.75 8.9 7.75 9V13C7.75 13.41 7.41 13.75 7 13.75C6.59 13.75 6.25 13.41 6.25 13V10.81L3.53 13.53C3.38 13.68 3.19 13.75 3 13.75C2.81 13.75 2.62 13.68 2.47 13.53C2.18 13.24 2.18 12.76 2.47 12.47L5.19 9.75H3C2.59 9.75 2.25 9.41 2.25 9C2.25 8.59 2.59 8.25 3 8.25H7C7.1 8.25 7.19 8.27 7.29 8.31C7.47 8.39 7.62 8.53 7.7 8.72L7.69 8.71ZM13 6.25H10.81L13.53 3.53C13.82 3.24 13.82 2.76 13.53 2.47C13.24 2.18 12.76 2.18 12.47 2.47L9.75 5.19V3C9.75 2.59 9.41 2.25 9 2.25C8.59 2.25 8.25 2.59 8.25 3V7C8.25 7.1 8.27 7.19 8.31 7.29C8.39 7.47 8.53 7.62 8.72 7.7C8.81 7.74 8.91 7.76 9.01 7.76H13.01C13.42 7.76 13.76 7.42 13.76 7.01C13.76 6.6 13.42 6.26 13.01 6.26L13 6.25Z"></path></svg>',"search-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.9975 2.25C9.7275 2.25 6.2475 5.73 6.2475 10C6.2475 11.87 6.9075 13.58 8.0175 14.92L2.4675 20.47C2.1775 20.76 2.1775 21.24 2.4675 21.53C2.6175 21.68 2.8075 21.75 2.9975 21.75C3.1875 21.75 3.3775 21.68 3.5275 21.53L9.0775 15.98C10.4175 17.08 12.1275 17.75 13.9975 17.75C18.2675 17.75 21.7475 14.27 21.7475 10C21.7475 5.73 18.2675 2.25 13.9975 2.25ZM13.9975 16.25C10.5475 16.25 7.7475 13.45 7.7475 10C7.7475 6.55 10.5475 3.75 13.9975 3.75C17.4475 3.75 20.2475 6.55 20.2475 10C20.2475 13.45 17.4475 16.25 13.9975 16.25Z"></path></svg>',"smiley-rate1-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 4.9938C4 4.44362 4.45 3.99348 5 3.99348H6.59L5.3 2.70306C4.91 2.31293 4.91 1.68272 5.3 1.2926C5.69 0.902468 6.32 0.902468 6.71 1.2926L9.71 4.29357C9.8 4.3836 9.88 4.49364 9.93 4.62368C10.03 4.86376 10.03 5.14385 9.93 5.38393C9.88 5.50397 9.81 5.614 9.71 5.71404L6.71 8.71501C6.51 8.91508 6.26 9.00511 6 9.00511C5.74 9.00511 5.49 8.90508 5.29 8.71501C4.9 8.32489 4.9 7.69468 5.29 7.30456L6.58 6.01413H4.99C4.44 6.01413 3.99 5.56399 3.99 5.01381L4 4.9938ZM14.08 5.37393C14.13 5.49397 14.2 5.604 14.3 5.70403L17.3 8.70501C17.5 8.90508 17.75 8.99511 18.01 8.99511C18.27 8.99511 18.52 8.89507 18.72 8.70501C19.11 8.31488 19.11 7.68468 18.72 7.29455L17.43 6.00413H19.02C19.57 6.00413 20.02 5.55399 20.02 5.00381C20.02 4.45363 19.57 4.00348 19.02 4.00348H17.43L18.72 2.71306C19.11 2.32293 19.11 1.69273 18.72 1.3026C18.33 0.912471 17.7 0.912471 17.31 1.3026L14.31 4.30358C14.22 4.39361 14.14 4.50364 14.09 4.63368C13.99 4.87376 13.99 5.15385 14.09 5.39393L14.08 5.37393ZM22 14.9971V20.999C22 22.6496 20.65 24 19 24H5C3.35 24 2 22.6496 2 20.999V14.9971C2 13.3465 3.35 11.9961 5 11.9961H19C20.65 11.9961 22 13.3465 22 14.9971ZM19 13.9967H16V16.9977H20V14.9971C20 14.4469 19.55 13.9967 19 13.9967ZM14 16.9977V13.9967H10V16.9977H14ZM10 18.9984V21.9993H14V18.9984H10ZM4 14.9971V16.9977H8V13.9967H5C4.45 13.9967 4 14.4469 4 14.9971ZM5 21.9993H8V18.9984H4V20.999C4 21.5492 4.45 21.9993 5 21.9993ZM20 20.999V18.9984H16V21.9993H19C19.55 21.9993 20 21.5492 20 20.999Z"></path></svg>',"smiley-rate10-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.01 23C6.85721 23 1.15412 19.9621 0.0134987 13.1669C-0.0765501 12.6272 0.293651 12.1076 0.833944 12.0177C1.38424 11.9277 1.89452 12.2975 1.98457 12.8371C2.92508 18.4732 7.69767 20.9914 12 20.9914C16.3023 20.9914 21.0749 18.4732 22.0154 12.8371C22.1055 12.2975 22.6158 11.9277 23.1661 12.0177C23.7063 12.1076 24.0765 12.6272 23.9865 13.1669C22.8559 19.9521 17.1428 23 11.99 23H12.01ZM21.165 6.15177C22.3056 5.01257 22.3056 3.16386 21.165 2.02465L21.0049 1.85477C19.9143 0.765533 18.1633 0.725561 17.0227 1.71487C15.8821 0.715568 14.1312 0.765533 13.0406 1.85477L12.8705 2.01466C11.7299 3.15386 11.7299 5.00257 12.8705 6.14178L17.0227 10.2889L21.175 6.14178L21.165 6.15177ZM15.742 3.27378L17.0127 4.54289L18.2834 3.27378C18.6436 2.91403 19.2239 2.91403 19.5841 3.27378L19.7442 3.43367C20.1044 3.79342 20.1044 4.37301 19.7442 4.73276L17.0127 7.46086L14.2812 4.73276C13.921 4.37301 13.921 3.79342 14.2812 3.43367L14.4413 3.27378C14.6214 3.09391 14.8515 3.00397 15.0917 3.00397C15.3318 3.00397 15.5619 3.09391 15.742 3.27378ZM11.1595 6.15177C12.3002 5.01257 12.3002 3.16386 11.1595 2.02465L10.9995 1.85477C9.90886 0.765533 8.15792 0.725561 7.0173 1.71487C5.87668 0.715568 4.12573 0.765533 3.03514 1.85477L2.86505 2.01466C1.72443 3.15386 1.72443 5.00257 2.86505 6.14178L7.0173 10.2889L11.1695 6.14178L11.1595 6.15177ZM5.7366 3.27378L7.00729 4.54289L8.27798 3.27378C8.63818 2.91403 9.21849 2.91403 9.57869 3.27378L9.73877 3.43367C10.099 3.79342 10.099 4.37301 9.73877 4.73276L7.00729 7.46086L4.27581 4.73276C3.91562 4.37301 3.91562 3.79342 4.27581 3.43367L4.4359 3.27378C4.61599 3.09391 4.84612 3.00397 5.08625 3.00397C5.32638 3.00397 5.5565 3.09391 5.7366 3.27378Z"></path></svg>',"smiley-rate2-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_15894_140103)"><path d="M4.88291 4.51001C4.47291 4.51001 4.08291 4.25001 3.94291 3.84001C3.76291 3.32001 4.03291 2.75001 4.55291 2.57001L8.32291 1.25001C8.84291 1.06001 9.41291 1.34001 9.59291 1.86001C9.77291 2.38001 9.50291 2.95001 8.98291 3.13001L5.20291 4.45001C5.09291 4.49001 4.98291 4.51001 4.87291 4.51001H4.88291ZM19.8129 3.89001C20.0229 3.38001 19.7729 2.79001 19.2629 2.59001L15.5529 1.07001C15.0429 0.860007 14.4529 1.11001 14.2529 1.62001C14.0429 2.13001 14.2929 2.72001 14.8029 2.92001L18.5029 4.43001C18.6229 4.48001 18.7529 4.50001 18.8829 4.50001C19.2729 4.50001 19.6529 4.27001 19.8129 3.88001V3.89001ZM3.50291 6.00001C2.64291 6.37001 1.79291 6.88001 1.00291 7.48001C0.79291 7.64001 0.64291 7.87001 0.59291 8.14001C0.48291 8.73001 0.87291 9.29001 1.45291 9.40001C2.04291 9.51001 2.60291 9.12001 2.71291 8.54001C2.87291 7.69001 3.12291 6.83001 3.50291 5.99001V6.00001ZM21.0429 8.55001C21.6029 10.48 24.2429 8.84001 22.7529 7.48001C21.9629 6.88001 21.1129 6.37001 20.2529 6.00001C20.6329 6.84001 20.8829 7.70001 21.0429 8.55001ZM21.5729 13.2C21.2529 14.2 22.5429 15.09 23.3629 14.39C23.8529 14 23.9229 13.29 23.5429 12.81C21.7429 10.67 22.1329 10.55 21.5829 13.2H21.5729ZM1.75291 11C1.22291 11.79 -0.14709 12.64 0.0129102 13.75C0.15291 14.36 0.75291 14.74 1.35291 14.6C2.98291 14.1 1.80291 12.22 1.75291 11ZM19.8829 17C19.8829 13.14 16.2929 10 11.8829 10C7.47291 10 3.88291 13.14 3.88291 17C3.88291 20.86 7.47291 24 11.8829 24C16.2929 24 19.8829 20.86 19.8829 17ZM17.8829 17C17.8829 19.76 15.1929 22 11.8829 22C8.57291 22 5.88291 19.76 5.88291 17C5.88291 14.24 8.57291 12 11.8829 12C15.1929 12 17.8829 14.24 17.8829 17Z"></path></g><defs><clipPath id="clip0_15894_140103"><rect width="24" height="24" fill="white"></rect></clipPath></defs></svg>',"smiley-rate3-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.01915 7C6.46961 7 6.01998 6.55 6.01998 6V2C6.01998 1.45 6.46961 1 7.01915 1C7.56869 1 8.01832 1.45 8.01832 2V6C8.01832 6.55 7.56869 7 7.01915 7ZM18.01 6V2C18.01 1.45 17.5604 1 17.0108 1C16.4613 1 16.0117 1.45 16.0117 2V6C16.0117 6.55 16.4613 7 17.0108 7C17.5604 7 18.01 6.55 18.01 6ZM16.4213 21.58L18.01 19.99L19.2989 21.28C19.6886 21.67 20.3181 21.67 20.7077 21.28C21.0974 20.89 21.0974 20.26 20.7077 19.87L19.4188 18.58C18.6395 17.8 17.3705 17.8 16.5912 18.58L15.0025 20.17L13.4138 18.58C12.6345 17.8 11.3655 17.8 10.5862 18.58L8.9975 20.17L7.40883 18.58C6.62948 17.8 5.36053 17.8 4.58118 18.58L3.29226 19.87C2.90258 20.26 2.90258 20.89 3.29226 21.28C3.68193 21.67 4.31141 21.67 4.70108 21.28L5.99001 19.99L7.57868 21.58C8.35803 22.36 9.62698 22.36 10.4063 21.58L11.995 19.99L13.5837 21.58C13.9734 21.97 14.4829 22.16 14.9925 22.16C15.5021 22.16 16.0117 21.97 16.4013 21.58H16.4213Z"></path></svg>',"smiley-rate4-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.06927 7C6.51927 7 6.06927 6.55 6.06927 6V2C6.06927 1.45 6.51927 1 7.06927 1C7.61927 1 8.06927 1.45 8.06927 2V6C8.06927 6.55 7.61927 7 7.06927 7ZM18.0693 6V2C18.0693 1.45 17.6193 1 17.0693 1C16.5193 1 16.0693 1.45 16.0693 2V6C16.0693 6.55 16.5193 7 17.0693 7C17.6193 7 18.0693 6.55 18.0693 6ZM22.5693 21.9C23.0693 21.66 23.2793 21.07 23.0393 20.57C21.1093 16.52 16.9093 14 12.0693 14C7.22927 14 3.02927 16.52 1.09927 20.57C0.859273 21.07 1.06927 21.67 1.56927 21.9C2.06927 22.14 2.65927 21.93 2.89927 21.43C4.49927 18.08 8.00927 16 12.0593 16C16.1093 16 19.6293 18.08 21.2193 21.43C21.3893 21.79 21.7493 22 22.1193 22C22.2593 22 22.4093 21.97 22.5493 21.9H22.5693Z"></path></svg>',"smiley-rate5-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.00572 7C6.45572 7 6.00572 6.55 6.00572 6V2C6.00572 1.45 6.45572 1 7.00572 1C7.55572 1 8.00572 1.45 8.00572 2V6C8.00572 6.55 7.55572 7 7.00572 7ZM18.0057 6V2C18.0057 1.45 17.5557 1 17.0057 1C16.4557 1 16.0057 1.45 16.0057 2V6C16.0057 6.55 16.4557 7 17.0057 7C17.5557 7 18.0057 6.55 18.0057 6ZM19.9457 21.33C20.1257 20.81 19.8557 20.24 19.3357 20.05C14.5457 18.35 9.45572 18.35 4.66572 20.05C4.14572 20.23 3.87572 20.81 4.05572 21.33C4.23572 21.85 4.80572 22.12 5.33572 21.94C9.69572 20.4 14.3057 20.4 18.6657 21.94C18.7757 21.98 18.8857 22 18.9957 22C19.4057 22 19.7957 21.74 19.9357 21.33H19.9457Z"></path></svg>',"smiley-rate6-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7 7C6.45 7 6 6.55 6 6V2C6 1.45 6.45 1 7 1C7.55 1 8 1.45 8 2V6C8 6.55 7.55 7 7 7ZM18 6V2C18 1.45 17.55 1 17 1C16.45 1 16 1.45 16 2V6C16 6.55 16.45 7 17 7C17.55 7 18 6.55 18 6ZM21 21C21 20.45 20.55 20 20 20H4C3.45 20 3 20.45 3 21C3 21.55 3.45 22 4 22H20C20.55 22 21 21.55 21 21Z"></path></svg>',"smiley-rate7-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.0022 23.99C11.452 23.99 11.0018 23.5402 11.0018 22.9904C11.0018 22.4407 11.452 21.9909 12.0022 21.9909C16.3137 21.9909 21.0755 19.472 22.0158 13.8344C22.1058 13.2947 22.616 12.9248 23.1662 13.0148C23.7064 13.1047 24.0765 13.6245 23.9865 14.1643C22.8561 20.9513 17.144 24 11.9922 24L12.0022 23.99ZM8.00072 5.99783V1.99957C8.00072 1.4498 7.55056 1 7.00036 1C6.45016 1 6 1.4498 6 1.99957V5.99783C6 6.54759 6.45016 6.99739 7.00036 6.99739C7.55056 6.99739 8.00072 6.54759 8.00072 5.99783ZM18.0043 5.99783V1.99957C18.0043 1.4498 17.5542 1 17.004 1C16.4538 1 16.0036 1.4498 16.0036 1.99957V5.99783C16.0036 6.54759 16.4538 6.99739 17.004 6.99739C17.5542 6.99739 18.0043 6.54759 18.0043 5.99783Z"></path></svg>',"smiley-rate8-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.01 24C6.85721 24 1.15412 20.96 0.0134987 14.16C-0.0765501 13.62 0.293651 13.1 0.833944 13.01C1.38424 12.92 1.89452 13.29 1.98457 13.83C2.92508 19.47 7.69767 21.99 12 21.99C16.3023 21.99 21.0749 19.47 22.0154 13.83C22.1055 13.29 22.6158 12.92 23.1661 13.01C23.7063 13.1 24.0765 13.62 23.9865 14.16C22.8559 20.95 17.1428 24 11.99 24H12.01ZM8.00783 6V2C8.00783 1.45 7.55759 1 7.00729 1C6.45699 1 6.00675 1.45 6.00675 2V6C6.00675 6.55 6.45699 7 7.00729 7C7.55759 7 8.00783 6.55 8.00783 6ZM18.0133 6V2C18.0133 1.45 17.563 1 17.0127 1C16.4624 1 16.0122 1.45 16.0122 2V6C16.0122 6.55 16.4624 7 17.0127 7C17.563 7 18.0133 6.55 18.0133 6Z"></path></svg>',"smiley-rate9-24x24":'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.01 24C6.85767 24 1.15509 20.96 0.0145752 14.16C-0.0354475 13.87 0.0445888 13.57 0.234675 13.35C0.424761 13.13 0.704888 13 0.995019 13H23.005C23.2951 13 23.5752 13.13 23.7653 13.35C23.9554 13.57 24.0354 13.87 23.9854 14.16C22.8549 20.95 17.1423 24 11.99 24H12.01ZM2.25559 15C3.61621 19.82 8.0182 22 12.01 22C16.0018 22 20.4038 19.82 21.7644 15H2.25559ZM8.00819 6V2C8.00819 1.45 7.55799 1 7.00774 1C6.45749 1 6.00729 1.45 6.00729 2V6C6.00729 6.55 6.45749 7 7.00774 7C7.55799 7 8.00819 6.55 8.00819 6ZM18.0127 6V2C18.0127 1.45 17.5625 1 17.0123 1C16.462 1 16.0118 1.45 16.0118 2V6C16.0118 6.55 16.462 7 17.0123 7C17.5625 7 18.0127 6.55 18.0127 6Z"></path></svg>'};class cc extends Ye{constructor(e){super(e),this.rootRef=gt(),this.model=new i7,this.model.onInnerHeightChanged=t=>{this.props.onInnerHeightChanged&&this.props.onInnerHeightChanged(t)}}componentDidMount(){const e=this.rootRef.current;e&&this.model.setRootElement(e)}componentWillUnmount(){this.model.unsubscribeRootElement(),this.model.setRootElement(void 0)}render(){return this.props.disabled?v(ke,null,this.props.children):v("div",{ref:this.rootRef,className:"sv-scroll__wrapper"},v("div",{className:"sv-scroll__scroller sv-drag-target-skipped",onScroll:()=>this.model.onScrollContainer()},v("div",{className:"sv-scroll__container"},this.props.children)),v("div",{className:"sv-scroll__scrollbar",onScroll:()=>this.model.onScrollScrollbar()},v("div",{className:"sv-scroll__scrollbar-sizer"})))}}te.Instance.registerElement("svc-scroll",n=>v(cc,n)),Yd("v1",Q7),Yd("v2",ow),Vl.registerIcons(ow);class pc extends Ve{constructor(e){super(e),this.previousJSON={},this.isSurveyUpdated=!1,this.createSurvey(e),this.updateSurvey(e,{}),this.rootRef=gt(),this.rootNodeId=e.id||null,this.rootNodeClassName=e.className||""}getStateElement(){return this.survey}onSurveyUpdated(){if(this.survey){const e=this.rootRef.current;e&&this.survey.afterRenderSurvey(e),this.survey.startTimerFromUI(),this.setSurveyEvents()}}shouldComponentUpdate(e,t){return super.shouldComponentUpdate(e,t)?(this.isModelJSONChanged(e)&&(this.destroySurvey(),this.createSurvey(e),this.updateSurvey(e,{}),this.isSurveyUpdated=!0),!0):!1}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.updateSurvey(this.props,e),this.isSurveyUpdated&&(this.onSurveyUpdated(),this.isSurveyUpdated=!1)}componentDidMount(){super.componentDidMount(),this.onSurveyUpdated()}destroySurvey(){this.survey&&(this.survey.renderCallback=void 0,this.survey.onPartialSend.clear(),this.survey.stopTimer(),this.survey.destroyResizeObserver())}componentWillUnmount(){super.componentWillUnmount(),this.destroySurvey()}doRender(){let e;this.survey.state=="completed"?e=this.renderCompleted():this.survey.state=="completedbefore"?e=this.renderCompletedBefore():this.survey.state=="loading"?e=this.renderLoading():this.survey.state=="empty"?e=this.renderEmptySurvey():e=this.renderSurvey();const t=this.survey.backgroundImage?v("div",{className:this.css.rootBackgroundImage,style:this.survey.backgroundImageStyle}):null,s=this.survey.headerView==="basic"?v(nw,{survey:this.survey}):null,i=function(l){l.preventDefault()};let r=v("div",{className:"sv_custom_header"});this.survey.hasLogo&&(r=null);const a=this.survey.getRootCss(),o=this.rootNodeClassName?this.rootNodeClassName+" "+a:a;return v("div",{id:this.rootNodeId,ref:this.rootRef,className:o,style:this.survey.themeVariables,lang:this.survey.locale||"en",dir:this.survey.localeDir},v(cc,{disabled:this.survey.rootScrollDisabled},this.survey.needRenderIcons?v(F7,null):null,v(qn,null),v("div",{className:this.survey.wrapperFormCss},t,v("form",{onSubmit:i},v(cc,{disabled:this.survey.formScrollDisabled},r,v("div",{className:this.css.container},s,v(Ci,{survey:this.survey,container:"header",needRenderWrapper:!1}),e,v(Ci,{survey:this.survey,container:"footer",needRenderWrapper:!1})))),v(aw,{notifier:this.survey.notifier}))))}renderElement(){return this.doRender()}get css(){return this.survey.css}set css(e){this.survey.css=e}renderCompleted(){if(!this.survey.showCompletedPage)return null;var e={__html:this.survey.processedCompletedHtml};return v(ke,null,v("div",{dangerouslySetInnerHTML:e,className:this.survey.completedCss}),v(Ci,{survey:this.survey,container:"completePage",needRenderWrapper:!1}))}renderCompletedBefore(){var e={__html:this.survey.processedCompletedBeforeHtml};return v("div",{dangerouslySetInnerHTML:e,className:this.survey.completedBeforeCss})}renderLoading(){var e={__html:this.survey.processedLoadingHtml};return v("div",{dangerouslySetInnerHTML:e,className:this.survey.loadingBodyCss})}renderSurvey(){var e=this.survey.activePage?this.renderPage(this.survey.activePage):null;this.survey.isShowStartingPage;var t=this.survey.activePage?this.survey.activePage.id:"";let s=this.survey.bodyCss;const i={};return this.survey.renderedWidth&&(i.maxWidth=this.survey.renderedWidth),v("div",{className:this.survey.bodyContainerCss},v(Ci,{survey:this.survey,container:"left"}),v("div",{className:"sv-components-column sv-components-column--expandable"},v(Ci,{survey:this.survey,container:"center"}),v("div",{id:t,className:s,style:i},v(Ci,{survey:this.survey,container:"contentTop"}),e,v(Ci,{survey:this.survey,container:"contentBottom"}),this.survey.showBrandInfo?v(B7,null):null)),v(Ci,{survey:this.survey,container:"right"}))}renderPage(e){return te.Instance.createElement(this.survey.pageComponent||"sv-page",{survey:this.survey,page:e,css:this.css,creator:this})}renderEmptySurvey(){return v("div",{className:this.css.bodyEmpty},this.survey.emptySurveyText)}createSurvey(e){e||(e={}),this.previousJSON={},e?e.model?this.survey=e.model:e.json&&(this.previousJSON=e.json,this.survey=new Ie(e.json)):this.survey=new Ie,e.css&&(this.survey.css=this.css)}isModelJSONChanged(e){return e.model?this.survey!==e.model:e.json?!L.isTwoValueEquals(e.json,this.previousJSON):!1}updateSurvey(e,t){if(e){t=t||{};for(var s in e)if(!(s=="model"||s=="children"||s=="json")){if(s=="css"){this.survey.mergeValues(e.css,this.survey.getCss()),this.survey.updateNavigationCss(),this.survey.updateElementCss();continue}e[s]!==t[s]&&(s.indexOf("on")==0&&this.survey[s]&&this.survey[s].add?(t[s]&&this.survey[s].remove(t[s]),this.survey[s].add(e[s])):this.survey[s]=e[s])}}}setSurveyEvents(){var e=this;this.survey.renderCallback=function(){var t=e.state&&e.state.modelChanged?e.state.modelChanged:0;e.setState({modelChanged:t+1})},this.survey.onPartialSend.add(t=>{e.state&&e.setState(e.state)})}createQuestionElement(e){return je.Instance.createQuestion(e.isDefaultRendering()?e.getTemplate():e.getComponentName(),{question:e,isDisplayMode:e.isInputReadOnly,creator:this})}renderError(e,t,s,i){return te.Instance.createElement(this.survey.questionErrorComponent,{key:e,error:t,cssClasses:s,element:i})}questionTitleLocation(){return this.survey.questionTitleLocation}questionErrorLocation(){return this.survey.questionErrorLocation}}te.Instance.registerElement("survey",n=>v(pc,n));function gc(n,e,t={processEsc:!0,disableTabStop:!1}){return e&&e.disableTabStop||t&&t.disableTabStop?ew(n,{tabIndex:-1}):(t=Object.assign({},t),ew(n,{tabIndex:0,onKeyUp:s=>(s.preventDefault(),s.stopPropagation(),Id(s,t),!1),onKeyDown:s=>xR(s,t),onBlur:s=>y1(s)}))}class mc extends Ye{constructor(e){super(e),this.updateStateFunction=null,this.state={update:0}}get survey(){return this.props.survey}get css(){return this.props.css||this.survey.css}componentDidMount(){if(this.survey){var e=this;this.updateStateFunction=function(){e.setState({update:e.state.update+1})},this.survey.onPageVisibleChanged.add(this.updateStateFunction)}}componentWillUnmount(){this.survey&&this.updateStateFunction&&(this.survey.onPageVisibleChanged.remove(this.updateStateFunction),this.updateStateFunction=null)}}class H7 extends ht{constructor(e){super(e),this.circleLength=440}getStateElement(){return this.timerModel}get timerModel(){return this.props.model}get progress(){return-this.timerModel.progress*this.circleLength}render(){if(!this.timerModel.isRunning)return null;let e=v("div",{className:this.timerModel.survey.getCss().timerRoot},this.timerModel.text);if(this.timerModel.showTimerAsClock){let t={strokeDasharray:this.circleLength,strokeDashoffset:this.progress};const s=this.timerModel.showProgress?v(ze,{className:this.timerModel.getProgressCss(),style:t,iconName:"icon-timercircle",size:"auto"}):null;e=v("div",{className:this.timerModel.rootCss},s,v("div",{className:this.timerModel.textContainerCss},v("span",{className:this.timerModel.majorTextCss},this.timerModel.clockMajorText),this.timerModel.clockMinorText?v("span",{className:this.timerModel.minorTextCss},this.timerModel.clockMinorText):null))}return e}}te.Instance.registerElement("sv-timerpanel",n=>v(H7,n));class z7 extends Ve{constructor(e){super(e),this.element.cssClasses,this.rootRef=gt()}getStateElement(){return this.element}get element(){return this.props.element}get index(){return this.props.index}get row(){return this.props.row}get survey(){return this.props.survey}get creator(){return this.props.creator}get css(){return this.props.css}componentDidMount(){super.componentDidMount(),this.rootRef.current&&this.element.setWrapperElement(this.rootRef.current)}componentWillUnmount(){super.componentWillUnmount(),this.element.setWrapperElement(void 0)}shouldComponentUpdate(e,t){return super.shouldComponentUpdate(e,t)?(e.element!==this.element&&(e.element&&e.element.setWrapperElement(this.rootRef.current),this.element&&this.element.setWrapperElement(void 0)),this.element.cssClasses,!0):!1}renderElement(){const e=this.element,t=this.createElement(e,this.index),s=e.cssClassesValue,i=()=>{const r=e;r&&r.isQuestion&&r.focusIn()};return v("div",{className:s.questionWrapper,style:e.rootStyle,"data-key":e.name+this.index,onFocus:i,ref:this.rootRef},t)}createElement(e,t){if(!this.row.isNeedRender)return te.Instance.createElement(e.skeletonComponentName,{element:e,css:this.css});let s=e.getTemplate();return te.Instance.isElementRegistered(s)||(s="question"),te.Instance.createElement(s,{element:e,creator:this.creator,survey:this.survey,css:this.css})}}class j7 extends Ve{constructor(e){super(e),this.rootRef=gt(),this.recalculateCss()}recalculateCss(){this.row.visibleElements.map(e=>e.cssClasses)}getStateElement(){return this.row}get row(){return this.props.row}get survey(){return this.props.survey}get creator(){return this.props.creator}get css(){return this.props.css}canRender(){return!!this.row&&!!this.survey&&!!this.creator}renderElementContent(){const e=this.row.visibleElements.map((t,s)=>v(z7,{element:t,index:s,row:this.row,survey:this.survey,creator:this.creator,css:this.css,key:t.id}));return v("div",{ref:this.rootRef,className:this.row.getRowCss()},e)}renderElement(){const e=this.survey,t=this.renderElementContent();return ti.wrapRow(e,t,this.row)||t}componentDidMount(){super.componentDidMount();var e=this.rootRef.current;if(this.rootRef.current&&this.row.setRootElement(this.rootRef.current),e&&!this.row.isNeedRender){var t=e;this.lazyRenderingTimeout=setTimeout(()=>{this.row.startLazyRendering(t)},10)}}shouldComponentUpdate(e,t){return super.shouldComponentUpdate(e,t)?(e.row!==this.row&&(e.row.isNeedRender=this.row.isNeedRender,e.row.setRootElement(this.rootRef.current),this.row.setRootElement(void 0),this.stopLazyRendering()),this.recalculateCss(),!0):!1}stopLazyRendering(){clearTimeout(this.lazyRenderingTimeout),this.row.stopLazyRendering(),this.row.isNeedRender=!this.row.isLazyRendering()}componentWillUnmount(){super.componentWillUnmount(),this.row&&(this.row.setRootElement(void 0),this.stopLazyRendering())}createElement(e,t){const s=t?"-"+t:0;var i=e.getType();return te.Instance.isElementRegistered(i)||(i="question"),te.Instance.createElement(i,{key:e.name+s,element:e,creator:this.creator,survey:this.survey,css:this.css})}}class lw extends Ve{constructor(e){super(e),this.rootRef=gt()}getStateElement(){return this.panelBase}canUsePropInState(e){return e!=="elements"&&super.canUsePropInState(e)}get survey(){return this.getSurvey()}get creator(){return this.props.creator}get css(){return this.getCss()}get panelBase(){return this.getPanelBase()}getPanelBase(){return this.props.element||this.props.question}getSurvey(){return this.props.survey||(this.panelBase?this.panelBase.survey:null)}getCss(){return this.props.css}componentDidMount(){super.componentDidMount(),this.doAfterRender()}componentWillUnmount(){super.componentWillUnmount();var e=this.rootRef.current;e&&e.removeAttribute("data-rendered")}componentDidUpdate(e,t){super.componentDidUpdate(e,t),!(e.page&&this.survey&&this.survey.activePage&&e.page.id===this.survey.activePage.id)&&this.doAfterRender()}doAfterRender(){var e=this.rootRef.current;e&&this.survey&&(this.panelBase.isPanel?this.panelBase.afterRender(e):this.survey.afterRenderPage(e))}getIsVisible(){return this.panelBase.isVisible}canRender(){return super.canRender()&&!!this.survey&&!!this.panelBase&&!!this.panelBase.survey&&this.getIsVisible()}renderRows(e){return this.panelBase.visibleRows.map(t=>this.createRow(t,e))}createRow(e,t){return v(j7,{key:e.id,row:e,survey:this.survey,creator:this.creator,css:t})}}class fc extends Ve{getStateElement(){return this.props.counter}renderElement(){return v("div",{className:this.props.remainingCharacterCounter},this.props.counter.remainingCharacterCounter)}}te.Instance.registerElement("sv-character-counter",n=>v(fc,n));class yc extends Ve{constructor(e){super(e),this.initialValue=this.viewModel.getTextValue()||"",this.textareaRef=gt()}get viewModel(){return this.props.viewModel}canRender(){return!!this.viewModel.question}componentDidMount(){super.componentDidMount();let e=this.textareaRef.current;e&&this.viewModel.setElement(e)}componentWillUnmount(){super.componentWillUnmount(),this.viewModel.resetElement()}renderElement(){return v("textarea",{id:this.viewModel.id,className:this.viewModel.className,ref:this.textareaRef,disabled:this.viewModel.isDisabledAttr,readOnly:this.viewModel.isReadOnlyAttr,rows:this.viewModel.rows,cols:this.viewModel.cols,placeholder:this.viewModel.placeholder,maxLength:this.viewModel.maxLength,defaultValue:this.initialValue,onChange:e=>{this.viewModel.onTextAreaInput(e)},onFocus:e=>{this.viewModel.onTextAreaFocus(e)},onBlur:e=>{this.viewModel.onTextAreaBlur(e)},onKeyDown:e=>{this.viewModel.onTextAreaKeyDown(e)},"aria-required":this.viewModel.ariaRequired,"aria-label":this.viewModel.ariaLabel,"aria-labelledby":this.viewModel.ariaLabelledBy,"aria-describedby":this.viewModel.ariaDescribedBy,"aria-invalid":this.viewModel.ariaInvalid,"aria-errormessage":this.viewModel.ariaErrormessage,style:{resize:this.viewModel.question.resizeStyle}})}}te.Instance.registerElement("sv-text-area",n=>v(yc,n));class U7 extends Mn{renderCharacterCounter(){let e=null;return this.question.getMaxLength()&&(e=v(fc,{counter:this.question.characterCounter,remainingCharacterCounter:this.question.cssClasses.remainingCharacterCounter})),e}constructor(e){super(e)}renderElement(){if(this.question.isReadOnlyRenderDiv())return v("div",null,this.question.value);const e=this.renderCharacterCounter(),t=this.props.question.textAreaModel;return v(ke,null,v(yc,{viewModel:t}),e)}}class uw extends ht{constructor(e){super(e),this.textAreaModel=this.getTextAreaModel()}canRender(){return!!this.props.question}getTextAreaModel(){return this.props.question.commentTextAreaModel}renderElement(){if(this.props.question.isReadOnlyRenderDiv()){const t=this.textAreaModel.getTextValue()||"";return v("div",null,t)}return v(yc,{key:this.getKey(),viewModel:this.textAreaModel})}getKey(){}}class vc extends uw{constructor(e){super(e)}getTextAreaModel(){return this.props.question.getCommentTextAreaModel(this.props.item)}getKey(){return this.props.item.uniqueId}}je.Instance.registerQuestion("comment",n=>v(U7,n));class W7 extends Tt{constructor(e){super(e),this.widgetRef=gt()}_afterRender(){if(this.questionBase.customWidget){let e=this.widgetRef.current;e&&(this.questionBase.customWidget.afterRender(this.questionBase,e),this.questionBase.customWidgetData.isNeedRender=!1)}}componentDidMount(){super.componentDidMount(),this.questionBase&&this._afterRender()}componentDidUpdate(e,t){super.componentDidUpdate(e,t);var s=!!this.questionBase.customWidget&&this.questionBase.customWidget.isDefaultRender;this.questionBase&&!s&&this._afterRender()}componentWillUnmount(){if(super.componentWillUnmount(),this.questionBase.customWidget){let e=this.widgetRef.current;e&&this.questionBase.customWidget.willUnmount(this.questionBase,e)}}canRender(){return super.canRender()&&this.questionBase.visible}renderElement(){let e=this.questionBase.customWidget;if(e.isDefaultRender)return v("div",{ref:this.widgetRef},this.creator.createQuestionElement(this.questionBase));let t=null;if(e.widgetJson.render)t=e.widgetJson.render(this.questionBase);else if(e.htmlTemplate){let s={__html:e.htmlTemplate};return v("div",{ref:this.widgetRef,dangerouslySetInnerHTML:s})}return v("div",{ref:this.widgetRef},t)}}class hw extends Ve{get element(){return this.props.element}getRenderedElements(){return[this.element]}renderElement(){const e=this.element,t=e.hasTitle?v(Gr,{element:e}):null,s=e.hasDescriptionUnderTitle?Ve.renderQuestionDescription(this.element):null,i=e.hasAdditionalTitleToolbar?v(Is,{model:e.additionalTitleToolbar}):null,r={width:void 0};return e instanceof kt&&(r.width=e.titleWidth),v("div",{className:e.cssHeader,onClick:a=>e.clickTitleFunction&&e.clickTitleFunction(a.nativeEvent),style:r},t,s,i)}}class dw extends ht{constructor(e){super(e)}get css(){return this.props.css}get summary(){return this.props.summary}renderElement(){return this.summary?this.summary.isEmpty()?this.renderNoItems():this.renderItems():null}renderItems(){return v("div",{className:this.css.summary},this.summary.items.map((e,t)=>this.renderItem(e,t)))}renderNoItems(){const e=this.summary.question;return te.Instance.createElement("sv-placeholder-"+e.getTemplate(),{cssClasses:this.css,question:e})||v("div",null,this.renderLocString(this.summary.noEntry))}renderItem(e,t){const s=e.btnEdit?v("button",{className:this.css.summaryRowActionEdit,onClick:()=>e.btnEdit.action(),title:e.btnEdit.title},v(ze,{iconName:"icon-editsmall-16x16",iconSize:"auto"})):null,i=e.showRemove&&e.btnRemove?v("button",{className:this.css.summaryRowActionDelete,onClick:()=>e.btnRemove.action(),title:e.btnRemove.title},v(ze,{iconName:"icon-delete-16x16",iconSize:"auto"})):null;return v("div",{className:this.css.summaryRow,key:t},v("div",{className:this.css.summaryRowContent},this.renderLocString(e.locText)),v("div",{className:this.css.summaryRowActions},s,i))}}te.Instance.registerElement("sv-singleinput-summary",n=>v(dw,n));class cw extends Ve{constructor(e){super(e)}getStateElement(){return this.props.model}get items(){return this.props.model.actions}get css(){return this.props.css}renderElement(){if(!this.items||!this.items.length)return null;const e=this.renderItems();return v("div",{className:this.css.breadcrumbsRoot},e)}renderItems(){const e=[];return this.items.concat([]).forEach((t,s)=>{s&&e.push(v(ze,{key:t.renderedId+"_separator",className:this.css.breadcrumbsSeparator,iconName:"arrowright-16x16",size:"auto"})),e.push(v(kn,{key:t.renderedId,item:t}))}),e}}te.Instance.registerElement("sv-breadcrumbs",n=>v(cw,n));class Qi extends Ve{static renderQuestionBody(e,t){var s=t.customWidget;return s?v(W7,{creator:e,question:t}):e.createQuestionElement(t)}constructor(e){super(e),this.isNeedFocus=!1,this.rootRef=gt()}getStateElement(){return this.question}get question(){return this.props.element}get creator(){return this.props.creator}componentDidMount(){super.componentDidMount(),this.question&&(this.question.react=this),this.doAfterRender()}componentWillUnmount(){super.componentWillUnmount(),this.question&&(this.question.react=null);const e=this.rootRef.current;e&&e.removeAttribute("data-rendered")}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.doAfterRender()}doAfterRender(){if(this.isNeedFocus&&(this.question.isCollapsed||this.question.clickTitleFunction(),this.isNeedFocus=!1),this.question){var e=this.rootRef.current;e&&e.getAttribute("data-rendered")!=="r"&&(e.setAttribute("data-rendered","r"),this.question.afterRender&&this.question.afterRender(e))}}canRender(){return super.canRender()&&!!this.question&&!!this.creator}renderQuestionContent(){let e=this.question;var t={display:this.question.renderedIsExpanded?"":"none"},s=e.cssClasses,i=this.renderQuestion(),r=e&&e.hasComment?this.renderComment(s):null,a=e.hasDescriptionUnderInput?this.renderDescription():null;return v("div",{className:e.cssContent||void 0,style:t,"aria-hidden":e.contentAriaHidden,role:"presentation","data-sv-drop-target-matrix":this.question.dragDropMatrixAttribute,"data-sv-drop-target-matrix-row":this.question.dragDropMatrixAttribute},i,r,a)}renderElement(){var e=this.question,t=e.cssClasses,s=this.renderHeader(e),i=e.hasTitleOnLeftTop?s:null,r=e.hasTitleOnBottom?s:null;const a=this.question.showErrorsAboveQuestion?this.renderErrors(t,""):null,o=this.question.showErrorsBelowQuestion?this.renderErrors(t,""):null,l=e.getRootStyle(),u=e.singleInputHasActions?this.renderSingleInputBreadcrumbs(e,t):void 0,f=(e.singleInputSummary?this.renderSingleInputSummary(e,t):void 0)||(e.singleInputQuestion?this.renderSingleInputQuestion(e,t):void 0)||this.wrapQuestionContent(this.renderQuestionContent());return v(ke,null,v("div",{ref:this.rootRef,id:e.id,className:e.getRootCss(),style:l,"data-name":e.name,role:e.ariaRole,"aria-required":this.question.ariaRequired,"aria-invalid":this.question.ariaInvalid,"aria-label":this.question.ariaLabel,"aria-labelledby":e.ariaLabelledBy,"aria-describedby":e.ariaDescribedBy,"aria-expanded":e.ariaExpanded},u,a,i,f,r,o))}renderSingleInputQuestion(e,t){const s=e.singleInputQuestion,i=s.id;return v(Qi,{key:i,element:s,creator:this.creator,css:t})}renderSingleInputBreadcrumbs(e,t){return v(cw,{model:e.singleInputActions,css:t})}renderSingleInputSummary(e,t){return v(dw,{summary:e.singleInputSummary,creator:this.creator,css:t})}wrapElement(e){const t=this.question.survey;let s=null;return t&&(s=ti.wrapElement(t,e,this.question)),s??e}wrapQuestionContent(e){const t=this.question.survey;let s=null;return t&&(s=ti.wrapQuestionContent(t,e,this.question)),s??e}renderQuestion(){return Qi.renderQuestionBody(this.creator,this.question)}renderDescription(){return Ve.renderQuestionDescription(this.question)}renderComment(e){const t=Ve.renderLocString(this.question.locCommentText);return v("div",{className:this.question.getCommentAreaCss()},v("div",null,t),v(uw,{question:this.question,cssClasses:e,isDisplayMode:this.question.isInputReadOnly}))}renderHeader(e){return v(hw,{element:e})}renderErrors(e,t){return v(Rl,{element:this.question,cssClasses:e,creator:this.creator,location:t,id:this.question.id+"_errors"})}}te.Instance.registerElement("question",n=>v(Qi,n));class Rl extends ht{constructor(e){super(e),this.state=this.getState()}get id(){return this.props.element.id+"_errors"}get element(){return this.props.element}get creator(){return this.props.creator}getState(e=null){return e?{error:e.error+1}:{error:0}}canRender(){return!!this.element&&this.element.hasVisibleErrors}componentWillUnmount(){}renderElement(){const e=[];for(let t=0;t<this.element.renderedErrors.length;t++){const s="error"+t;e.push(this.creator.renderError(s,this.element.renderedErrors[t],this.cssClasses,this.element))}return v("div",{className:this.element.cssError,id:this.id},e)}}class pw extends ht{constructor(e){super(e)}getStateElement(){return this.question}get question(){return this.getQuestion()}get creator(){return this.props.creator}getQuestion(){return this.props.question}get itemCss(){return this.props.itemCss}componentDidMount(){super.componentDidMount(),this.doAfterRender()}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.doAfterRender()}doAfterRender(){}canRender(){return!!this.question}renderContent(){var e=this.renderQuestion();return v(ke,null,e)}getShowErrors(){return this.question.isVisible}renderQuestion(){return Qi.renderQuestionBody(this.creator,this.question)}}class $7 extends pw{constructor(e){super(e),this.cellRef=gt()}componentWillUnmount(){if(super.componentWillUnmount(),this.question){var e=this.cellRef.current;e&&e.removeAttribute("data-rendered")}}renderCellContent(){return v("div",{className:this.props.cell.cellQuestionWrapperClassName},this.renderQuestion())}renderElement(){var e=this.getCellStyle();const t=this.props.cell,s=()=>{t.focusIn()};return v("td",{ref:this.cellRef,className:this.itemCss,colSpan:t.colSpans,title:t.getTitle(),style:e,onFocus:s},this.wrapCell(this.props.cell,this.renderCellContent()))}getCellStyle(){return null}getHeaderText(){return""}wrapCell(e,t){if(!e)return t;const s=this.question.survey;let i=null;return s&&(i=ti.wrapMatrixCell(s,t,e,this.props.reason)),i??t}}class gw extends Ye{constructor(e){super(e),this.state={changed:0},this.question&&this.registerCallback(this.question)}get question(){return this.props.question}update(){this.setState({changed:this.state.changed+1})}getQuestionPropertiesToTrack(){return["errors"]}registerCallback(e){e.registerFunctionOnPropertiesValueChanged(this.getQuestionPropertiesToTrack(),()=>{this.update()},"__reactSubscription")}unRegisterCallback(e){e.unRegisterFunctionOnPropertiesValueChanged(this.getQuestionPropertiesToTrack(),"__reactSubscription")}componentDidUpdate(e){e.question&&e.question!==this.question&&this.unRegisterCallback(e.cell),this.question&&this.registerCallback(this.question)}componentWillUnmount(){this.question&&this.unRegisterCallback(this.question)}render(){return v(Rl,{element:this.question,creator:this.props.creator,cssClasses:this.question.cssClasses})}}class G7 extends lw{constructor(e){super(e)}getPanelBase(){return this.props.page}get page(){return this.panelBase}renderElement(){var e=this.renderTitle(),t=this.renderDescription(),s=this.renderRows(this.panelBase.cssClasses);const i=v(Rl,{element:this.panelBase,cssClasses:this.panelBase.cssClasses,creator:this.creator});return v("div",{ref:this.rootRef,className:this.page.cssRoot},e,t,i,s)}renderTitle(){return v(Gr,{element:this.page})}renderDescription(){if(!this.page._showDescription)return null;var e=Ve.renderLocString(this.page.locDescription);return v("div",{className:this.panelBase.cssClasses.page.description},e)}}te.Instance.registerElement("sv-page",n=>v(G7,n));class Jr extends lw{constructor(e){super(e),this.hasBeenExpanded=!1}get panel(){return this.panelBase}renderElement(){const e=this.renderHeader(),t=v(Rl,{element:this.panelBase,cssClasses:this.panelBase.cssClasses,creator:this.creator}),s={paddingLeft:this.panel.innerPaddingLeft,display:this.panel.renderedIsExpanded?void 0:"none"};let i=null;if(this.panel.renderedIsExpanded){const a=this.renderRows(this.panelBase.cssClasses),o=this.panelBase.cssClasses.panel.content;i=this.renderContent(s,a,o)}const r=()=>{this.panelBase&&this.panelBase.focusIn()};return v("div",{ref:this.rootRef,className:this.panelBase.getContainerCss(),onFocus:r,id:this.panelBase.id},this.panel.showErrorsAbovePanel?t:null,e,this.panel.showErrorsAbovePanel?null:t,i)}renderHeader(){return!this.panel.hasTitle&&!this.panel.hasDescription?null:v(hw,{element:this.panel})}wrapElement(e){const t=this.panel.survey;let s=null;return t&&(s=ti.wrapElement(t,e,this.panel)),s??e}renderContent(e,t,s){const i=this.renderBottom();return v("div",{style:e,className:s,id:this.panel.contentId,role:this.panel.ariaRole,"aria-labelledby":this.panel.ariaLabelledBy,"aria-label":this.panel.ariaLabel},t,i)}renderTitle(){return this.panelBase.title?v(Gr,{element:this.panelBase}):null}renderDescription(){if(!this.panelBase.description)return null;var e=Ve.renderLocString(this.panelBase.locDescription);return v("div",{className:this.panel.cssClasses.panel.description},e)}renderBottom(){const e=this.panel.getFooterToolbar();return e.hasActions?v(Is,{model:e}):null}getIsVisible(){return this.panelBase.getIsContentVisible()}}te.Instance.registerElement("panel",n=>v(Jr,n));class J7 extends Jr{constructor(e){super(e)}get flowPanel(){return this.panel}componentDidMount(){super.componentDidMount(),this.flowPanel&&(this.flowPanel.onCustomHtmlProducing=function(){return""},this.flowPanel.onGetHtmlForQuestion=this.renderQuestion)}componentWillUnmount(){super.componentWillUnmount(),this.flowPanel&&(this.flowPanel.onCustomHtmlProducing=null,this.flowPanel.onGetHtmlForQuestion=null)}getQuestion(e){return this.flowPanel.getQuestionByName(e)}renderQuestion(e){return"<question>"+e.name+"</question>"}renderRows(){const e=this.renderHtml();return e?[e]:[]}getNodeIndex(){return this.renderedIndex++}renderHtml(){if(!this.flowPanel)return null;const e="<span>"+this.flowPanel.produceHtml()+"</span>";if(!DOMParser)return v("div",{dangerouslySetInnerHTML:{__html:e}});const t=new DOMParser().parseFromString(e,"text/xml");return this.renderedIndex=0,this.renderParentNode(t)}renderNodes(e){const t=[];for(let s=0;s<e.length;s++){const i=this.renderNode(e[s]);i&&t.push(i)}return t}getStyle(e){const t={};return e.toLowerCase()==="b"&&(t.fontWeight="bold"),e.toLowerCase()==="i"&&(t.fontStyle="italic"),e.toLowerCase()==="u"&&(t.textDecoration="underline"),t}renderParentNode(e){const t=e.nodeName.toLowerCase(),s=this.renderNodes(this.getChildDomNodes(e));return t==="div"?v("div",{key:this.getNodeIndex()},s):v("span",{key:this.getNodeIndex(),style:this.getStyle(t)},s)}renderNode(e){if(!this.hasTextChildNodesOnly(e))return this.renderParentNode(e);const t=e.nodeName.toLowerCase();if(t==="question"){const s=this.flowPanel.getQuestionByName(e.textContent);if(!s)return null;const i=v(Qi,{key:s.name,element:s,creator:this.creator,css:this.css});return v("span",{key:this.getNodeIndex()},i)}return t==="div"?v("div",{key:this.getNodeIndex()},e.textContent):v("span",{key:this.getNodeIndex(),style:this.getStyle(t)},e.textContent)}getChildDomNodes(e){const t=[];for(let s=0;s<e.childNodes.length;s++)t.push(e.childNodes[s]);return t}hasTextChildNodesOnly(e){const t=e.childNodes;for(let s=0;s<t.length;s++)if(t[s].nodeName.toLowerCase()!=="#text")return!1;return!0}renderContent(e,t){return v("f-panel",{style:e},t)}}te.Instance.registerElement("flowpanel",n=>v(J7,n));class mw extends Tt{constructor(e){super(e)}get question(){return this.questionBase}renderElement(){var e=this.question.cssClasses;return v("fieldset",{className:this.question.getSelectBaseRootCss(),ref:t=>this.setControl(t),role:this.question.a11y_input_ariaRole,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-labelledby":this.question.a11y_input_ariaLabelledBy,"aria-describedby":this.question.a11y_input_ariaDescribedBy,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage},this.renderHeader(),this.question.hasColumns?this.getColumnedBody(e):this.getBody(e),this.getFooter())}renderHeader(){return null}getFooter(){if(this.question.hasFootItems){const e=this.question.footItems.map((t,s)=>this.renderItem(t,!1,this.question.cssClasses));return v(ke,null,e)}return null}getStateValue(){}isItemChecked(e,t){return!1}getColumnedBody(e){return v("div",{className:e.rootMultiColumn},this.getColumns(e))}getColumns(e){const t=this.getStateValue();return this.question.columns.map((s,i)=>{var r=s.map((a,o)=>this.renderItem(a,i===0&&o===0,e,""+i+o,this.isItemChecked(a,t)));return v("div",{key:"column"+i+this.question.getItemsColumnKey(s),className:this.question.getColumnClass(),role:"presentation"},r)})}getBody(e){return this.question.blockedRow?v("div",{className:e.rootRow},this.getItems(e,this.question.dataChoices)):v(ke,null,this.getItems(e,this.question.bodyItems))}getItems(e,t){const s=[],i=this.getStateValue();for(let r=0;r<t.length;r++){const a=t[r],o=this.renderItem(a,r==0,e,""+r,this.isItemChecked(a,i));o&&s.push(o)}return s}get textStyle(){return null}renderItem(e,t,s,i,r){const a=te.Instance.createElement(this.question.itemComponent,{key:e.uniqueId,question:this.question,cssClasses:s,isDisplayMode:this.isDisplayMode,item:e,textStyle:this.textStyle,index:i,isFirst:t,isChecked:r,creator:this.props.creator}),o=this.question.survey;let l=null;return o&&a&&(l=ti.wrapItemValue(o,a,this.question,e)),l??a}}class fw extends ht{constructor(e){super(e),this.handleOnChange=t=>{this.doOnItemChange(t)},this.rootRef=gt()}getStateElement(){return this.item}get question(){return this.props.question}get item(){return this.props.item}get textStyle(){return this.props.textStyle}get isFirst(){return this.props.isFirst}get index(){return this.props.index}get hideCaption(){return this.props.hideCaption===!0}get ariaLabel(){return this.props.ariaLabel||null}componentDidUpdate(e,t){super.componentDidUpdate(e,t),e.item!==this.props.item&&!this.question.isDesignMode&&(this.props.item&&this.props.item.setRootElement(this.rootRef.current),e.item&&e.item.setRootElement(void 0))}shouldComponentUpdate(e,t){return super.shouldComponentUpdate(e,t)?!this.question.customWidget||!!this.question.customWidgetData.isNeedRender||!!this.question.customWidget.widgetJson.isDefaultRender||!!this.question.customWidget.widgetJson.render:!1}doOnItemChange(e){}canRender(){return!!this.item&&!!this.question}renderElement(){return v(ke,null,this.renderElementContent(),this.renderPanel(),this.renderComment())}renderElementContent(){return null}get inputStyle(){return null}renderComment(){return this.item.isCommentShowing?v("div",{className:this.question.getCommentAreaCss(!0)},v(vc,{question:this.question,item:this.item,cssClasses:this.question.cssClasses})):null}renderPanel(){if(this.item.isPanelShowing){const e=this.item.panel;return v(Jr,{key:e.id,element:e,survey:this.question.survey,cssClasses:this.props.cssClasses,isDisplayMode:this.isDisplayMode,creator:this.props.creator})}return null}componentDidMount(){super.componentDidMount(),this.question.isDesignMode||this.item.setRootElement(this.rootRef.current)}componentWillUnmount(){super.componentWillUnmount(),this.question.isDesignMode||this.item.setRootElement(void 0)}}class K7 extends mw{constructor(e){super(e)}get question(){return this.questionBase}renderHeader(){return v(ke,null,v("legend",{className:"sv-hidden"},this.question.locTitle.renderedHtml),this.getHeader())}getHeader(){return this.question.hasHeadItems?this.question.headItems.map((e,t)=>this.renderItem(e,!1,this.question.cssClasses)):null}}class yw extends fw{constructor(e){super(e)}doOnItemChange(e){this.question.clickItemHandler(this.item,e.target.checked)}renderElementContent(){const e=this.question.isItemSelected(this.item);return this.renderCheckbox(e)}get inputStyle(){return null}renderCheckbox(e){const t=this.question.getItemId(this.item),s=this.question.getItemClass(this.item),i=this.question.getLabelClass(this.item),r=this.hideCaption?null:v("span",{className:this.cssClasses.controlLabel},this.renderLocString(this.item.locText,this.textStyle));return v("div",{className:s,role:"presentation",ref:this.rootRef},v("label",{className:i},v("input",{className:this.cssClasses.itemControl,type:"checkbox",name:this.question.name+this.item.id,value:this.item.value,id:t,style:this.inputStyle,disabled:!this.question.getItemEnabled(this.item),readOnly:this.question.isReadOnlyAttr,checked:e,onChange:this.handleOnChange,required:this.question.hasRequiredError(),"aria-label":this.ariaLabel}),this.cssClasses.materialDecorator?v("span",{className:this.cssClasses.materialDecorator},this.question.itemSvgIcon?v("svg",{className:this.cssClasses.itemDecorator},v("use",{xlinkHref:this.question.itemSvgIcon})):null):null,r))}}te.Instance.registerElement("survey-checkbox-item",n=>v(yw,n)),je.Instance.registerQuestion("checkbox",n=>v(K7,n));class Z7 extends Tt{get question(){return this.questionBase}renderElement(){return this.question.selectToRankEnabled?v("div",{className:this.question.rootClass,ref:t=>this.setControl(t)},v("div",{className:this.question.getContainerClasses("from"),"data-ranking":"from-container"},this.getItems(this.question.renderedUnRankingChoices,!0),this.question.renderedUnRankingChoices.length===0?v("div",{className:this.question.cssClasses.containerPlaceholder}," ",this.renderLocString(this.question.locSelectToRankEmptyRankedAreaText)," "):null),v("div",{className:this.question.cssClasses.containersDivider}),v("div",{className:this.question.getContainerClasses("to"),"data-ranking":"to-container"},this.getItems(),this.question.renderedRankingChoices.length===0?v("div",{className:this.question.cssClasses.containerPlaceholder}," ",this.renderLocString(this.question.locSelectToRankEmptyUnrankedAreaText)," "):null)):v("div",{className:this.question.rootClass,ref:e=>this.setControl(e)},this.getItems())}getItems(e=this.question.renderedRankingChoices,t){const s=[];for(let i=0;i<e.length;i++){const r=e[i];s.push(this.renderItem(r,i,a=>{this.question.handleKeydown.call(this.question,a,r)},a=>{a.persist(),this.question.handlePointerDown.call(this.question,a,r,a.currentTarget)},a=>{a.persist(),this.question.handlePointerUp.call(this.question,a,r,a.currentTarget)},this.question.cssClasses,this.question.getItemClass(r),this.question,t))}return s}renderItem(e,t,s,i,r,a,o,l,u){""+e.renderedId;const d=this.renderLocString(e.locText),h=t,f=this.question.getNumberByIndex(h),C=this.question.getItemTabIndex(e),b=v(Y7,{key:e.uniqueId,text:d,index:h,indexText:f,itemTabIndex:C,handleKeydown:s,handlePointerDown:i,handlePointerUp:r,cssClasses:a,itemClass:o,question:l,unrankedItem:u,item:e}),x=this.question.survey;let V=null;return x&&(V=ti.wrapItemValue(x,b,this.question,e)),V??b}}class Y7 extends ht{get text(){return this.props.text}get index(){return this.props.index}get indexText(){return this.props.indexText}get handleKeydown(){return this.props.handleKeydown}get handlePointerDown(){return this.props.handlePointerDown}get handlePointerUp(){return this.props.handlePointerUp}get cssClasses(){return this.props.cssClasses}get itemClass(){return this.props.itemClass}get itemTabIndex(){return this.props.itemTabIndex}get question(){return this.props.question}get unrankedItem(){return this.props.unrankedItem}get item(){return this.props.item}renderEmptyIcon(){return v("svg",null,v("use",{xlinkHref:this.question.dashSvgIcon}))}renderElement(){let e=te.Instance.createElement(this.question.itemComponent,{item:this.item,cssClasses:this.cssClasses});return v("div",{id:this.question.getItemId(this.item),tabIndex:this.itemTabIndex,className:this.itemClass,onKeyDown:this.handleKeydown,onPointerDown:this.handlePointerDown,onPointerUp:this.handlePointerUp,"data-sv-drop-target-ranking-item":this.index},v("div",{tabIndex:-1,style:{outline:"none"}},v("div",{className:this.cssClasses.itemGhostNode}),v("div",{className:this.cssClasses.itemContent},v("div",{className:this.cssClasses.itemIconContainer},v("svg",{className:this.question.getIconHoverCss()},v("use",{xlinkHref:this.question.dragDropSvgIcon})),v("svg",{className:this.question.getIconFocusCss()},v("use",{xlinkHref:this.question.arrowsSvgIcon}))),v("div",{className:this.question.getItemIndexClasses(this.item)},!this.unrankedItem&&this.indexText?this.indexText:this.renderEmptyIcon()),e)))}}class X7 extends ht{get item(){return this.props.item}get cssClasses(){return this.props.cssClasses}renderElement(){return v("div",{className:this.cssClasses.controlLabel},Ve.renderLocString(this.item.locText))}}te.Instance.registerElement("sv-ranking-item",n=>v(X7,n)),je.Instance.registerQuestion("ranking",n=>v(Z7,n));class Cc extends Ve{constructor(e){super(e),this.handleOnMouseDown=this.handleOnMouseDown.bind(this)}get question(){return this.props.question}get item(){return this.props.item}get index(){return this.props.index}getStateElement(){return this.item}handleOnMouseDown(e){this.question.onMouseDown()}}class eL extends Cc{render(){var e=this.renderLocString(this.item.locText);return v("label",{onMouseDown:this.handleOnMouseDown,className:this.question.getItemClassByText(this.item.itemValue,this.item.text)},v("input",{type:"radio",className:"sv-visuallyhidden",name:this.question.questionName,id:this.question.getInputId(this.index),value:this.item.value,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,checked:this.question.value==this.item.value,onClick:this.props.handleOnClick,onChange:()=>{},"aria-label":this.question.ariaLabel}),v("span",{className:this.question.cssClasses.itemText,"data-text":this.item.text},e))}componentDidMount(){super.componentDidMount()}}te.Instance.registerElement("sv-rating-item",n=>v(eL,n));class tL extends Cc{render(){return v("label",{onMouseDown:this.handleOnMouseDown,className:this.question.getItemClass(this.item.itemValue),onMouseOver:e=>this.question.onItemMouseIn(this.item),onMouseOut:e=>this.question.onItemMouseOut(this.item),title:this.item.text},v("input",{type:"radio",className:"sv-visuallyhidden",name:this.question.questionName,id:this.question.getInputId(this.index),value:this.item.value,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,checked:this.question.value==this.item.value,onClick:this.props.handleOnClick,onChange:()=>{},"aria-label":this.question.ariaLabel}),v(ze,{className:"sv-star",size:"auto",iconName:this.question.itemStarIcon}),v(ze,{className:"sv-star-2",size:"auto",iconName:this.question.itemStarIconAlt}))}}te.Instance.registerElement("sv-rating-item-star",n=>v(tL,n));class sL extends Cc{render(){return v("label",{onMouseDown:this.handleOnMouseDown,style:this.question.getItemStyle(this.item.itemValue,this.item.highlight),className:this.question.getItemClass(this.item.itemValue),onMouseOver:e=>this.question.onItemMouseIn(this.item),onMouseOut:e=>this.question.onItemMouseOut(this.item),title:this.item.text},v("input",{type:"radio",className:"sv-visuallyhidden",name:this.question.questionName,id:this.question.getInputId(this.index),value:this.item.value,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,checked:this.question.value==this.item.value,onClick:this.props.handleOnClick,onChange:()=>{},"aria-label":this.question.ariaLabel}),v(ze,{size:"auto",iconName:this.question.getItemSmileyIconName(this.item.itemValue)}))}}te.Instance.registerElement("sv-rating-item-smiley",n=>v(sL,n));class iL extends Ve{get item(){return this.props.item}getStateElement(){return this.item}render(){if(!this.item)return null;const e=this.props.item,t=this.renderDescription(e);return v("div",{className:"sd-rating-dropdown-item"},v("span",{className:"sd-rating-dropdown-item_text"},e.title),t)}renderDescription(e){return e.description?v("div",{className:"sd-rating-dropdown-item_description"},this.renderLocString(e.description,void 0,"locString")):null}}te.Instance.registerElement("sv-rating-dropdown-item",n=>v(iL,n));class vw extends Ve{get model(){return this.props.model}get question(){return this.props.question}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.updateDomElement()}componentDidMount(){super.componentDidMount(),this.updateDomElement()}updateDomElement(){if(this.inputElement){const e=this.inputElement,t=this.model.inputStringRendered;L.isTwoValueEquals(t,e.value,!1,!0,!1)||(e.value=this.model.inputStringRendered)}}onChange(e){var t;const s=(t=e.target.getRootNode())===null||t===void 0?void 0:t.activeElement;e.target===s&&(this.model.inputStringRendered=e.target.value)}keyhandler(e){this.model.inputKeyHandler(e)}onBlur(e){this.question.onBlur(e)}onFocus(e){this.question.onFocus(e)}constructor(e){super(e)}getStateElement(){return this.model}render(){return v("div",{className:this.question.cssClasses.hint},this.model.showHintPrefix?v("div",{className:this.question.cssClasses.hintPrefix},v("span",null,this.model.hintStringPrefix)):null,v("div",{className:this.question.cssClasses.hintSuffixWrapper},this.model.showHintString?v("div",{className:this.question.cssClasses.hintSuffix},v("span",{style:{visibility:"hidden"},"data-bind":"text: model.filterString"},this.model.inputStringRendered),v("span",null,this.model.hintStringSuffix)):null,v("input",{type:"text",autoComplete:"off",id:this.question.getInputId(),inputMode:this.model.inputMode,ref:e=>this.inputElement=e,className:this.question.cssClasses.filterStringInput,disabled:this.question.isInputReadOnly,readOnly:this.model.filterReadOnly?!0:void 0,size:this.model.inputStringRendered?void 0:1,role:this.model.ariaInputRole,"aria-required":this.model.ariaInputRequired,"aria-invalid":this.model.ariaInputInvalid,"aria-errormessage":this.model.ariaInputErrorMessage,"aria-expanded":this.model.ariaInputExpanded,"aria-label":this.model.ariaInputLabel,"aria-labelledby":this.model.ariaInputLabelledby,"aria-describedby":this.model.ariaInputDescribedby,"aria-controls":this.model.ariaInputControls,"aria-activedescendant":this.model.ariaInputActivedescendant,placeholder:this.model.filterStringPlaceholder,onKeyDown:e=>{this.keyhandler(e)},onChange:e=>{this.onChange(e)},onBlur:e=>{this.onBlur(e)},onFocus:e=>{this.onFocus(e)}})))}}je.Instance.registerQuestion("sv-tagbox-filter",n=>v(vw,n));class rL extends ht{constructor(e){super(e),this.state={changed:0},this.setupModel()}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.setupModel()}componentDidMount(){super.componentDidMount(),this.setupModel()}componentWillUnmount(){super.componentWillUnmount(),this.item&&(this.item.locText.onChanged=()=>{})}setupModel(){if(!this.item.locText)return;const e=this;this.item.locText.onChanged=()=>{e.setState({changed:e.state.changed+1})}}getStateElement(){return this.item}get item(){return this.props.item}canRender(){return!!this.item}renderElement(){return v("option",{value:this.item.value,disabled:!this.item.isEnabled},this.item.text)}}class _l extends Mn{constructor(){super(...arguments),this.click=e=>{var t;(t=this.question.dropdownListModel)===null||t===void 0||t.onClick(e)},this.chevronPointerDown=e=>{var t;(t=this.question.dropdownListModel)===null||t===void 0||t.chevronPointerDown(e)},this.clear=e=>{var t;(t=this.question.dropdownListModel)===null||t===void 0||t.onClear(e)},this.keyhandler=e=>{var t;(t=this.question.dropdownListModel)===null||t===void 0||t.keyHandler(e)},this.blur=e=>{this.updateInputDomElement(),this.question.onBlur(e)},this.focus=e=>{this.question.onFocus(e)}}get dropdownListModel(){return this.question.dropdownListModel}getStateElement(){return this.question.dropdownListModel}setValueCore(e){this.questionBase.renderedValue=e}getValueCore(){return this.questionBase.renderedValue}renderReadOnlyElement(){return this.question.locReadOnlyText?v("div",{className:this.question.cssClasses.controlValue},this.renderLocString(this.question.locReadOnlyText)):null}renderSelect(e){let t=null;const s=this.dropdownListModel;return this.question.isReadOnly?t=v("div",{id:this.question.inputId,role:s?.ariaQuestionRole,"aria-label":s?.ariaQuestionLabel,"aria-labelledby":s?.ariaQuestionLabelledby,"aria-describedby":s?.ariaQuestionDescribedby,"aria-expanded":"false","aria-readonly":"true","aria-disabled":"true",tabIndex:this.question.isDisabledAttr?void 0:0,className:this.question.getControlClass(),ref:i=>this.setControl(i)},this.renderReadOnlyElement(),this.renderEditorButtons()):t=v(ke,null,this.renderInput(),this.question.isInputReadOnly?null:v(Nn,{model:s.popupModel})),v("div",{className:e.selectWrapper,onClick:this.click},t)}renderValueElement(){return this.question.showInputFieldComponent?te.Instance.createElement(this.question.inputFieldComponentName,{item:this.dropdownListModel.getSelectedAction(),question:this.question}):this.question.showSelectedItemLocText?this.renderLocString(this.question.selectedItemLocText):null}renderInput(){const e=this.dropdownListModel;let t=this.renderValueElement();return v("div",{id:this.question.inputId,className:this.question.getControlClass(),tabIndex:e.noTabIndex?void 0:0,disabled:this.question.isDisabledAttr,required:this.question.isRequired,onKeyDown:this.keyhandler,onBlur:this.blur,onFocus:this.focus,role:e.ariaQuestionRole,"aria-required":e.ariaQuestionRequired,"aria-invalid":e.ariaQuestionInvalid,"aria-errormessage":e.ariaQuestionErrorMessage,"aria-expanded":e.ariaQuestionExpanded,"aria-label":e.ariaQuestionLabel,"aria-labelledby":e.ariaQuestionLabelledby,"aria-describedby":e.ariaQuestionDescribedby,"aria-controls":e.ariaQuestionControls,"aria-activedescendant":e.ariaQuestionActivedescendant,ref:s=>this.setControl(s)},e.showHintPrefix?v("div",{className:this.question.cssClasses.hintPrefix},v("span",null,e.hintStringPrefix)):null,v("div",{className:this.question.cssClasses.controlValue},e.showHintString?v("div",{className:this.question.cssClasses.hintSuffix},v("span",{style:{visibility:"hidden"},"data-bind":"text: model.filterString"},e.inputStringRendered),v("span",null,e.hintStringSuffix)):null,t,e.needRenderInput?this.renderFilterInput():null),this.renderEditorButtons())}renderFilterInput(){const{root:e}=D.environment,t=this.dropdownListModel,s=i=>{var r;const a=(r=i.target.getRootNode())===null||r===void 0?void 0:r.activeElement;i.target===a&&(t.inputStringRendered=i.target.value)};return v("input",{type:"text",autoComplete:"off",id:this.question.getInputId(),ref:i=>this.inputElement=i,className:this.question.cssClasses.filterStringInput,role:t.ariaInputRole,"aria-required":t.ariaInputRequired,"aria-invalid":t.ariaInputInvalid,"aria-errormessage":t.ariaInputErrorMessage,"aria-expanded":t.ariaInputExpanded,"aria-label":t.ariaInputLabel,"aria-labelledby":t.ariaInputLabelledby,"aria-describedby":t.ariaInputDescribedby,"aria-controls":t.ariaInputControls,"aria-activedescendant":t.ariaInputActivedescendant,placeholder:t.placeholderRendered,readOnly:t.filterReadOnly?!0:void 0,tabIndex:t.noTabIndex?void 0:-1,disabled:this.question.isDisabledAttr,inputMode:t.inputMode,onChange:i=>{s(i)},onBlur:this.blur,onFocus:this.focus})}renderOther(e,t){return!e||!e.isCommentShowing?null:v("div",{key:e.uniqueId,className:this.question.getCommentAreaCss(!0)},v(vc,{question:this.question,item:e,cssClasses:this.question.cssClasses}))}renderEditorButtons(){return v(Is,{model:this.dropdownListModel.editorButtons})}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.updateInputDomElement()}componentDidMount(){super.componentDidMount(),this.updateInputDomElement()}componentWillUnmount(){super.componentWillUnmount(),this.question.dropdownListModel&&(this.question.dropdownListModel.focused=!1)}updateInputDomElement(){if(this.inputElement){const e=this.inputElement,t=this.question.dropdownListModel.inputStringRendered;L.isTwoValueEquals(t,e.value,!1,!0,!1)||(e.value=this.question.dropdownListModel.inputStringRendered)}}}class Cw extends _l{constructor(e){super(e)}renderElement(){const e=this.question.cssClasses,t=this.renderOther(this.question.selectedItem,e),s=this.renderSelect(e);return v("div",{className:this.question.renderCssRoot},s,t)}}je.Instance.registerQuestion("dropdown",n=>v(Cw,n));class nL extends ht{constructor(e){super(e)}get question(){return this.props.question}get item(){return this.props.item}canRender(){return!!this.item&&!!this.question}renderElement(){const e=this.renderLocString(this.item.locText),t=s=>{this.question.dropdownListModel.deselectItem(this.item.value),s.stopPropagation()};return v("div",{className:"sv-tagbox__item"},v("div",{className:"sv-tagbox__item-text"},e),v("div",{className:this.question.cssClasses.cleanItemButton,onClick:t},v(ze,{className:this.question.cssClasses.cleanItemButtonSvg,iconName:this.question.cssClasses.cleanItemButtonIconId,size:"auto"})))}}class aL extends _l{constructor(e){super(e)}renderItem(e,t){return v(nL,{key:e,question:this.question,item:t})}renderInput(){const e=this.dropdownListModel,t=this.question.selectedChoices.map((s,i)=>this.renderItem("item"+i,s));return v("div",{id:this.question.inputId,className:this.question.getControlClass(),tabIndex:e.noTabIndex?void 0:0,disabled:this.question.isInputReadOnly,required:this.question.isRequired,onKeyDown:this.keyhandler,onBlur:this.blur,role:e.ariaQuestionRole,"aria-required":e.ariaQuestionRequired,"aria-invalid":e.ariaQuestionInvalid,"aria-errormessage":e.ariaQuestionErrorMessage,"aria-label":e.ariaQuestionLabel,"aria-labelledby":e.ariaQuestionLabelledby,"aria-describedby":e.ariaQuestionDescribedby,"aria-expanded":e.ariaQuestionExpanded,"aria-controls":e.ariaQuestionControls,"aria-activedescendant":e.ariaQuestionActivedescendant,ref:s=>this.setControl(s)},v("div",{className:this.question.cssClasses.controlValue},t,e.needRenderInput?v(vw,{model:e,question:this.question}):null),this.renderEditorButtons())}renderElement(){const e=this.question.cssClasses,t=this.renderOther(this.question.otherItem,e),s=this.renderSelect(e);return v("div",{className:this.question.renderCssRoot},s,t)}}je.Instance.registerQuestion("tagbox",n=>v(aL,n));class oL extends Cw{constructor(e){super(e)}renderSelect(e){const t=r=>{this.question.onClick(r)},s=r=>{this.question.onKeyUp(r)},i=this.isDisplayMode?v("div",{id:this.question.inputId,className:this.question.getControlClass(),disabled:!0},this.question.readOnlyText):v("select",{id:this.question.inputId,className:this.question.getControlClass(),ref:r=>this.setControl(r),autoComplete:this.question.autocomplete,onChange:this.updateValueOnEvent,onInput:this.updateValueOnEvent,onClick:t,onKeyUp:s,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage,required:this.question.isRequired},this.question.allowClear?v("option",{value:""},this.question.placeholder):null,this.question.visibleChoices.map(r=>v(rL,{key:r.uniqueId,item:r})));return v("div",{className:e.selectWrapper},i,this.createChevronButton())}createChevronButton(){return this.question.cssClasses.chevronButtonIconId?v("div",{className:this.question.cssClasses.chevronButton,"aria-hidden":"true",onPointerDown:this.chevronPointerDown},v(ze,{className:this.question.cssClasses.chevronButtonSvg,iconName:this.question.cssClasses.chevronButtonIconId,size:"auto"})):null}}je.Instance.registerQuestion("sv-dropdown-select",n=>v(oL,n)),pi.Instance.registerRenderer("dropdown","select","sv-dropdown-select");class lL extends Tt{constructor(e){super(e),this.state={rowsChanged:0}}get question(){return this.questionBase}componentDidMount(){if(super.componentDidMount(),this.question){var e=this;this.question.visibleRowsChangedCallback=function(){e.setState({rowsChanged:e.state.rowsChanged+1})}}}componentWillUnmount(){super.componentWillUnmount(),this.question&&(this.question.visibleRowsChangedCallback=null)}renderElement(){for(var e=this.question.cssClasses,t=this.question.hasRows?v("td",null):null,s=[],i=0;i<this.question.visibleColumns.length;i++){var r=this.question.visibleColumns[i],a=this.renderLocString(r.locText);const h={};this.question.columnMinWidth&&(h.minWidth=this.question.columnMinWidth,h.width=this.question.columnMinWidth),s.push(v("th",{className:this.question.cssClasses.headerCell,style:h,key:r.uniqueId},this.wrapCell({column:r},a,"column-header")))}for(var o=[],l=this.question.visibleRows,i=0;i<l.length;i++){var u=l[i];o.push(v(uL,{key:u.uniqueId,question:this.question,cssClasses:e,row:u,isFirst:i==0}))}var d=this.question.showHeader?v("thead",{role:"presentation"},v("tr",null,t,s)):null;return v("div",{className:e.tableWrapper,ref:h=>this.setControl(h)},v("fieldset",{role:"radiogroup"},v("legend",{className:"sv-visuallyhidden"},this.question.locTitle.renderedHtml),v("table",{className:this.question.getTableCss(),role:"presentation"},d,v("tbody",null,o))))}}class uL extends ht{constructor(e){super(e)}getStateElement(){return this.row?this.row.item:super.getStateElement()}get question(){return this.props.question}get row(){return this.props.row}wrapCell(e,t,s){if(!s)return t;const i=this.question.survey;let r=null;return i&&(r=ti.wrapMatrixCell(i,t,e,s)),r??t}canRender(){return!!this.row}renderElement(){var e=null;if(this.question.hasRows){var t=this.renderLocString(this.row.locText);const i={};this.question.rowTitleWidth&&(i.minWidth=this.question.rowTitleWidth,i.width=this.question.rowTitleWidth),e=v("td",{style:i,className:this.row.rowTextClasses},this.wrapCell({row:this.row},t,"row-header"))}var s=this.generateTds();return v("tr",{className:this.row.rowClasses||void 0},e,s)}generateTds(){const e=[],t=this.row,s=this.question.cellComponent;for(var i=0;i<this.question.visibleColumns.length;i++){let r=null;const a=this.question.visibleColumns[i],o=a.uniqueId;let l=this.question.getItemClass(t,a);if(this.question.hasCellText){const u=d=>()=>this.cellClick(t,d);r=v("td",{key:o,className:l,onClick:u?u(a):()=>{}},this.renderLocString(this.question.getCellDisplayLocText(t.name,a)))}else{const u=te.Instance.createElement(s,{question:this.question,row:this.row,column:a,columnIndex:i,cssClasses:this.cssClasses,cellChanged:()=>{this.cellClick(this.row,a)}});r=v("td",{key:o,"data-responsive-title":a.locText.renderedHtml,className:this.question.cssClasses.cell},u)}e.push(r)}return e}cellClick(e,t){e.cellClick(t),this.setState({value:e.value})}}class hL extends ht{constructor(e){super(e),this.handleOnMouseDown=this.handleOnMouseDown.bind(this),this.handleOnChange=this.handleOnChange.bind(this)}handleOnChange(e){this.props.cellChanged&&this.props.cellChanged(),this.setState({value:this.row.isChecked(this.column)})}handleOnMouseDown(e){this.question.onMouseDown()}get question(){return this.props.question}get row(){return this.props.row}get column(){return this.props.column}get columnIndex(){return this.props.columnIndex}canRender(){return!!this.question&&!!this.row}renderElement(){const e=this.row.isChecked(this.column),t=this.question.inputId+"_"+this.row.name+"_"+this.columnIndex,s=this.question.getItemClass(this.row,this.column),i=this.question.getItemSvgIcon(this.row,this.column),r=this.question.isMobile?v("span",{className:this.question.cssClasses.cellResponsiveTitle},this.renderLocString(this.column.locText)):void 0;return v("label",{onMouseDown:this.handleOnMouseDown,className:s},this.renderInput(t,e),v("span",{className:this.question.cssMaterialDecorator},i?v("svg",{className:this.question.cssItemDecorator},v("use",{xlinkHref:i})):null),r)}renderInput(e,t){return v("input",{id:e,type:this.question.checkType,className:this.question.cssItemValue,name:this.row.fullName,value:this.column.value,disabled:this.row.isDisabledAttr,readOnly:this.row.isReadOnlyAttr,checked:t,onChange:this.handleOnChange,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.getCellAriaLabel(this.row,this.column),"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage})}}te.Instance.registerElement("survey-matrix-cell",n=>v(hL,n)),je.Instance.registerQuestion("matrix",n=>v(lL,n));class dL extends Tt{constructor(e){super(e)}get question(){return this.questionBase}componentDidMount(){this.reactOnStrChanged()}componentWillUnmount(){this.question.locHtml.onChanged=function(){}}componentDidUpdate(e,t){this.reactOnStrChanged()}reactOnStrChanged(){this.question.locHtml.onChanged=()=>{this.setState({changed:this.state&&this.state.changed?this.state.changed+1:1})}}canRender(){return super.canRender()&&!!this.question.html}renderElement(){var e={__html:this.question.locHtml.renderedHtml};return v("div",{className:this.question.renderCssRoot,dangerouslySetInnerHTML:e})}}je.Instance.registerQuestion("html",n=>v(dL,n));class bw extends Ye{render(){return v("div",{className:"sd-loading-indicator"},v(ze,{iconName:"icon-loading",size:"auto"}))}}class cL extends Tt{constructor(e){super(e)}get question(){return this.questionBase}renderElement(){const e=this.question.allowShowPreview?this.renderPreview():null,t=this.question.showLoadingIndicator?this.renderLoadingIndicator():null,s=this.question.isPlayingVideo?this.renderVideo():null,i=this.question.showFileDecorator?this.renderFileDecorator():null,r=this.question.fileNavigatorVisible?v(Is,{model:this.question.fileNavigator}):null;let a;return this.question.isReadOnlyAttr?a=v("input",{readOnly:!0,type:"file",className:this.isDisplayMode?this.question.getReadOnlyFileCss():this.question.cssClasses.fileInput,id:this.question.inputId,ref:o=>this.setControl(o),style:this.isDisplayMode?{color:"transparent"}:{},multiple:this.question.allowMultiple,placeholder:this.question.title,accept:this.question.acceptedTypes}):this.question.isDisabledAttr?a=v("input",{disabled:!0,type:"file",className:this.isDisplayMode?this.question.getReadOnlyFileCss():this.question.cssClasses.fileInput,id:this.question.inputId,ref:o=>this.setControl(o),style:this.isDisplayMode?{color:"transparent"}:{},multiple:this.question.allowMultiple,placeholder:this.question.title,accept:this.question.acceptedTypes}):this.question.hasFileUI?a=v("input",{type:"file",disabled:this.isDisplayMode,tabIndex:-1,className:this.isDisplayMode?this.question.getReadOnlyFileCss():this.question.cssClasses.fileInput,id:this.question.inputId,ref:o=>this.setControl(o),style:this.isDisplayMode?{color:"transparent"}:{},"aria-required":this.question.ariaRequired,"aria-label":this.question.ariaLabel,"aria-invalid":this.question.ariaInvalid,"aria-errormessage":this.question.ariaErrormessage,multiple:this.question.allowMultiple,title:this.question.inputTitle,accept:this.question.acceptedTypes,capture:this.question.renderCapture}):a=null,v("div",{className:this.question.fileRootCss,ref:o=>this.setContent(o)},a,v("div",{className:this.question.cssClasses.dragArea,onDrop:this.question.onDrop,onDragOver:this.question.onDragOver,onDragLeave:this.question.onDragLeave,onDragEnter:this.question.onDragEnter},i,t,s,e,r))}renderFileDecorator(){const e=this.question.actionsContainerVisible?v(Is,{model:this.question.actionsContainer}):null;return v("div",{className:this.question.getFileDecoratorCss()},this.question.showDragAreaPlaceholder?v("span",{className:this.question.cssClasses.dragAreaPlaceholder},this.renderLocString(this.question.locRenderedPlaceholder)):!1,v("div",{className:this.question.cssClasses.wrapper},e))}renderPreview(){return te.Instance.createElement("sv-file-preview",{question:this.question})}renderLoadingIndicator(){return v("div",{className:this.question.cssClasses.loadingIndicator},v(bw,null))}renderVideo(){return v("div",{className:this.question.cssClasses.videoContainer},v(kn,{item:this.question.changeCameraAction}),v(kn,{item:this.question.closeCameraAction}),v("video",{autoPlay:!0,playsInline:!0,id:this.question.videoId,className:this.question.cssClasses.video}),v(kn,{item:this.question.takePictureAction}))}}je.Instance.registerQuestion("file",n=>v(cL,n));class pL extends ht{constructor(e){super(e)}get question(){return this.props.item&&this.props.item.data.question||this.props.data.question}render(){return gc(v("label",{tabIndex:0,className:this.question.getChooseFileCss(),htmlFor:this.question.inputId,"aria-label":this.question.chooseButtonText,onClick:e=>this.question.chooseFile(e.nativeEvent)},this.question.cssClasses.chooseFileIconId?v(ze,{title:this.question.chooseButtonText,iconName:this.question.cssClasses.chooseFileIconId,size:"auto"}):null,v("span",null,this.question.chooseButtonText)))}}te.Instance.registerElement("sv-file-choose-btn",n=>v(pL,n));class gL extends Ve{get question(){return this.props.question}get page(){return this.props.page}renderElement(){const e=this.page.items.map((t,s)=>te.Instance.createElement("sv-file-item",{item:t,question:this.question,key:s}));return v("div",{className:this.page.css,id:this.page.id},e)}}class mL extends Ve{get question(){return this.props.question}renderFileSign(e,t){return!e||!t.name?null:v("div",{className:e},v("a",{href:t.content,onClick:s=>{this.question.doDownloadFile(s,t)},title:t.name,download:t.name,style:{width:this.question.imageWidth}},t.name))}renderElement(){const e=this.question.renderedPages.map((t,s)=>v(gL,{page:t,question:this.question,key:t.id}));return v("div",{className:this.question.cssClasses.fileList||void 0},e)}canRender(){return this.question.showPreviewContainer}}te.Instance.registerElement("sv-file-preview",n=>v(mL,n));class fL extends Ve{get question(){return this.props.question}get item(){return this.props.item}renderFileSign(e,t){return!e||!t.name?null:v("div",{className:e},v("a",{href:t.content,onClick:s=>{this.question.doDownloadFile(s,t)},title:t.name,download:t.name,target:"_blank",rel:"noreferrer",style:{width:this.question.imageWidth}},t.name))}renderElement(){const e=this.item;return v("span",{className:this.question.cssClasses.previewItem,onClick:t=>this.question.doDownloadFileFromContainer(t)},this.renderFileSign(this.question.cssClasses.fileSign,e),v("div",{className:this.question.getImageWrapperCss(e)},this.question.canPreviewImage(e)?v("img",{src:e.content,style:{height:this.question.imageHeight,width:this.question.imageWidth},alt:"File preview"}):this.question.cssClasses.defaultImage?v(ze,{iconName:this.question.cssClasses.defaultImageIconId,size:"auto",className:this.question.cssClasses.defaultImage}):null,e.name&&!this.question.isReadOnly?v("div",{className:this.question.getRemoveButtonCss(),onClick:t=>this.question.doRemoveFile(e,t)},v("span",{className:this.question.cssClasses.removeFile},this.question.removeFileCaption),this.question.cssClasses.removeFileSvgIconId?v(ze,{title:this.question.removeFileCaption,iconName:this.question.cssClasses.removeFileSvgIconId,size:"auto",className:this.question.cssClasses.removeFileSvg}):null):null),this.renderFileSign(this.question.cssClasses.fileSignBottom,e))}canRender(){return this.question.showPreviewContainer}}te.Instance.registerElement("sv-file-item",n=>v(fL,n));class yL extends Tt{constructor(e){super(e)}get question(){return this.questionBase}renderElement(){for(var e=this.question.cssClasses,t=this.question.getRows(),s=[],i=0;i<t.length;i++)t[i].isVisible&&s.push(this.renderRow(i,t[i].cells,e));return v("table",{className:this.question.getQuestionRootCss()},v("tbody",null,s))}renderCell(e,t,s){let i;const r=()=>{e.item.focusIn()};return e.isErrorsCell?i=v(gw,{question:e.item.editor,creator:this.creator}):i=v(vL,{question:this.question,item:e.item,creator:this.creator,cssClasses:t}),v("td",{key:e.item.id,className:e.className,onFocus:r},i)}renderRow(e,t,s){const i="item"+e,r=[];for(let a=0;a<t.length;a++){const o=t[a];r.push(this.renderCell(o,s,a))}return v("tr",{key:i,className:s.row},r)}}class vL extends ht{get question(){return this.props.question}get item(){return this.props.item}getStateElements(){return[this.item,this.item.editor]}get creator(){return this.props.creator}renderElement(){const e=this.item,t=this.cssClasses,s={};return this.question.itemTitleWidth&&(s.minWidth=this.question.itemTitleWidth,s.width=this.question.itemTitleWidth),v("label",{className:this.question.getItemLabelCss(e)},v("span",{className:t.itemTitle,style:s},v(rw,{element:e.editor,cssClasses:e.editor.cssClasses})),v(CL,{cssClasses:t,itemCss:this.question.getItemCss(),question:e.editor,creator:this.creator}))}}class CL extends pw{renderElement(){return v("div",{className:this.itemCss},this.renderContent())}}je.Instance.registerQuestion("multipletext",n=>v(yL,n));class bL extends mw{constructor(e){super(e)}get question(){return this.questionBase}getFooter(){return v(ke,null,super.getFooter(),this.renderClearButton())}renderClearButton(){return this.question.showClearButtonInContent?v("div",null,v("input",{type:"button",className:this.question.cssClasses.clearButton,onClick:()=>this.question.clearValueFromUI(),value:this.question.clearButtonCaption})):null}getStateValue(){return this.question.isEmpty()?"":this.question.renderedValue}isItemChecked(e,t){return e.value===t}}class ww extends fw{constructor(e){super(e),this.handleOnMouseDown=this.handleOnMouseDown.bind(this)}getStateElement(){return this.item}get question(){return this.props.question}get isChecked(){return this.props.isChecked}doOnItemChange(e){this.question.clickItemHandler(this.item)}handleOnMouseDown(e){this.question.onMouseDown()}renderElementContent(){return this.renderRadioButton()}renderRadioButton(){var e=this.question.getItemClass(this.item),t=this.question.getLabelClass(this.item),s=this.question.getControlLabelClass(this.item);const i=this.hideCaption?null:v("span",{className:s},this.renderLocString(this.item.locText,this.textStyle));return v("div",{className:e,role:"presentation",ref:this.rootRef},v("label",{onMouseDown:this.handleOnMouseDown,className:t},v("input",{"aria-errormessage":this.question.ariaErrormessage,className:this.cssClasses.itemControl,id:this.question.getItemId(this.item),type:"radio",name:this.question.questionName,checked:this.isChecked,value:this.item.value,disabled:!this.question.getItemEnabled(this.item),readOnly:this.question.isReadOnlyAttr,onChange:this.handleOnChange,"aria-label":this.ariaLabel}),this.cssClasses.materialDecorator?v("span",{className:this.cssClasses.materialDecorator},this.question.itemSvgIcon?v("svg",{className:this.cssClasses.itemDecorator},v("use",{xlinkHref:this.question.itemSvgIcon})):null):null,i))}}te.Instance.registerElement("survey-radiogroup-item",n=>v(ww,n)),je.Instance.registerQuestion("radiogroup",n=>v(bL,n));class wL extends Mn{constructor(e){super(e)}renderInput(){const e=this.question.getControlClass(),t=this.question.renderedPlaceholder;if(this.question.isReadOnlyRenderDiv())return v("div",null,this.question.inputValue);const s=this.question.getMaxLength()?v(fc,{counter:this.question.characterCounter,remainingCharacterCounter:this.question.cssClasses.remainingCharacterCounter}):null;return v(ke,null,v("input",{id:this.question.inputId,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,className:e,type:this.question.inputType,ref:i=>this.setControl(i),style:this.question.inputStyle,maxLength:this.question.getMaxLength(),min:this.question.renderedMin,max:this.question.renderedMax,step:this.question.renderedStep,size:this.question.inputSize,placeholder:t,list:this.question.dataListId,autoComplete:this.question.autocomplete,onBlur:i=>{this.question.onBlur(i)},onFocus:i=>{this.question.onFocus(i)},onChange:this.question.onChange,onClick:this.question.readOnlyBlocker,onPointerDown:this.question.readOnlyBlocker,onKeyUp:this.question.onKeyUp,onKeyDown:this.question.onKeyDown,onCompositionUpdate:i=>this.question.onCompositionUpdate(i.nativeEvent),"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-labelledby":this.question.a11y_input_ariaLabelledBy,"aria-describedby":this.question.a11y_input_ariaDescribedBy,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage}),s)}renderElement(){return this.question.dataListId?v("div",null,this.renderInput(),this.renderDataList()):this.renderInput()}setValueCore(e){this.question.inputValue=e}getValueCore(){return this.question.inputValue}renderDataList(){if(!this.question.dataListId)return null;var e=this.question.dataList;if(e.length==0)return null;for(var t=[],s=0;s<e.length;s++)t.push(v("option",{key:"item"+s,value:e[s]}));return v("datalist",{id:this.question.dataListId},t)}}je.Instance.registerQuestion("text",n=>v(wL,n));class bc extends Tt{constructor(e){super(e),this.handleOnChange=this.handleOnChange.bind(this),this.handleOnClick=this.handleOnClick.bind(this),this.handleOnLabelClick=this.handleOnLabelClick.bind(this),this.handleOnSwitchClick=this.handleOnSwitchClick.bind(this),this.handleOnKeyDown=this.handleOnKeyDown.bind(this),this.checkRef=gt()}getStateElement(){return this.question}get question(){return this.questionBase}doCheck(e){this.question.booleanValue=e}handleOnChange(e){this.doCheck(e.target.checked)}handleOnClick(e){this.question.onLabelClick(e,!0)}handleOnSwitchClick(e){this.question.onSwitchClickModel(e.nativeEvent)}handleOnLabelClick(e,t){this.question.onLabelClick(e,t)}handleOnKeyDown(e){this.question.onKeyDownCore(e)}updateDomElement(){if(!this.question)return;const e=this.checkRef.current;e&&(e.indeterminate=this.question.isIndeterminate),this.setControl(e),super.updateDomElement()}renderElement(){const e=this.question.cssClasses,t=this.question.getItemCss();return v("div",{className:e.root,onKeyDown:this.handleOnKeyDown},v("label",{className:t},v("input",{ref:this.checkRef,type:"checkbox",name:this.question.name,value:this.question.booleanValue===null?"":this.question.booleanValue,id:this.question.inputId,className:e.control,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,checked:this.question.booleanValue||!1,onChange:this.handleOnChange,role:this.question.a11y_input_ariaRole,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-labelledby":this.question.a11y_input_ariaLabelledBy,"aria-describedby":this.question.a11y_input_ariaDescribedBy,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage}),v("div",{className:e.sliderGhost,onClick:s=>this.handleOnLabelClick(s,this.question.swapOrder)},v("span",{className:this.question.getLabelCss(this.question.swapOrder)},this.renderLocString(this.question.locLabelLeft))),v("div",{className:e.switch,onClick:this.handleOnSwitchClick},v("span",{className:e.slider},this.question.isDeterminated&&e.sliderText?v("span",{className:e.sliderText},this.renderLocString(this.question.getCheckedLabel())):null)),v("div",{className:e.sliderGhost,onClick:s=>this.handleOnLabelClick(s,!this.question.swapOrder)},v("span",{className:this.question.getLabelCss(!this.question.swapOrder)},this.renderLocString(this.question.locLabelRight)))))}}je.Instance.registerQuestion("boolean",n=>v(bc,n));class xL extends bc{constructor(e){super(e)}renderElement(){const e=this.question.cssClasses,t=this.question.getCheckboxItemCss(),s=this.question.canRenderLabelDescription?Ve.renderQuestionDescription(this.question):null;return v("div",{className:e.rootCheckbox},v("div",{className:t},v("label",{className:e.checkboxLabel},v("input",{ref:this.checkRef,type:"checkbox",name:this.question.name,value:this.question.booleanValue===null?"":this.question.booleanValue,id:this.question.inputId,className:e.controlCheckbox,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,checked:this.question.booleanValue||!1,onChange:this.handleOnChange,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-labelledby":this.question.a11y_input_ariaLabelledBy,"aria-describedby":this.question.a11y_input_ariaDescribedBy,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage}),v("span",{className:e.checkboxMaterialDecorator},this.question.svgIcon?v("svg",{className:e.checkboxItemDecorator},v("use",{xlinkHref:this.question.svgIcon})):null,v("span",{className:"check"})),this.question.isLabelRendered&&v("span",{className:e.checkboxControlLabel,id:this.question.labelRenderedAriaID},v(dc,{element:this.question,cssClasses:this.question.cssClasses}))),s))}}je.Instance.registerQuestion("sv-boolean-checkbox",n=>v(xL,n)),pi.Instance.registerRenderer("boolean","checkbox","sv-boolean-checkbox");class VL extends bc{constructor(e){super(e)}renderRadioItem(e,t){const s=this.question.cssClasses,i=()=>{this.question.value=e};return v("div",{role:"presentation",className:this.question.getRadioItemClass(s,e)},v("label",{className:s.radioLabel},v("input",{type:"radio",name:this.question.name,value:e,"aria-errormessage":this.question.ariaErrormessage,checked:e===this.question.value,disabled:this.question.isDisabledAttr,readOnly:this.question.isReadOnlyAttr,className:s.itemRadioControl,onChange:i}),this.question.cssClasses.materialRadioDecorator?v("span",{className:s.materialRadioDecorator},this.question.itemSvgIcon?v("svg",{className:s.itemRadioDecorator},v("use",{xlinkHref:this.question.itemSvgIcon})):null):null,v("span",{className:s.radioControlLabel},this.renderLocString(t))))}renderElement(){const e=this.question.cssClasses;return v("div",{className:e.rootRadio},v("fieldset",{role:"presentation",className:e.radioFieldset},this.question.swapOrder?v(ke,null,this.renderRadioItem(this.question.getValueTrue(),this.question.locLabelTrue),this.renderRadioItem(this.question.getValueFalse(),this.question.locLabelFalse)):v(ke,null,this.renderRadioItem(this.question.getValueFalse(),this.question.locLabelFalse),this.renderRadioItem(this.question.getValueTrue(),this.question.locLabelTrue))))}}je.Instance.registerQuestion("sv-boolean-radio",n=>v(VL,n)),pi.Instance.registerRenderer("boolean","radio","sv-boolean-radio");class PL extends Tt{constructor(e){super(e),this.state={value:this.question.value}}get question(){return this.questionBase}renderElement(){return v("div",null)}}je.Instance.registerQuestion("empty",n=>v(PL,n));class xw extends Ve{constructor(e){super(e),this.root=gt(),this.onPointerDownHandler=t=>{this.parentMatrix.onPointerDown(t.nativeEvent,this.model.row)}}get model(){return this.props.model}get parentMatrix(){return this.props.parentMatrix}getStateElement(){return this.model}componentDidMount(){super.componentDidMount(),this.root.current&&this.model.setRootElement(this.root.current)}componentWillUnmount(){super.componentWillUnmount(),this.model.setRootElement(void 0)}shouldComponentUpdate(e,t){return super.shouldComponentUpdate(e,t)?(e.model!==this.model&&(e.element&&e.element.setRootElement(this.root.current),this.model&&this.model.setRootElement(void 0)),!0):!1}render(){const e=this.model;return e.visible?v("tr",{ref:this.root,className:e.className,"data-sv-drop-target-matrix-row":e.dropTargetId,onPointerDown:t=>this.onPointerDownHandler(t)},this.props.children):null}}te.Instance.registerElement("sv-matrix-row",n=>v(xw,n));class Vw extends ht{get question(){return this.props.item.data.question}renderElement(){return v("div",null,this.renderIcon())}renderIcon(){return this.question.iconDragElement?v("svg",{className:this.question.cssClasses.dragElementDecorator},v("use",{xlinkHref:this.question.iconDragElement})):v("span",{className:this.question.cssClasses.iconDrag})}}te.Instance.registerElement("sv-matrix-drag-drop-icon",n=>v(Vw,n));class SL extends Ve{get question(){return this.props.question}get creator(){return this.props.creator}get table(){return this.question.renderedTable}getStateElement(){return this.table}wrapCell(e,t,s){return this.props.wrapCell(e,t,s)}renderHeader(){const e=this.question.renderedTable;if(!e.showHeader)return null;const t=[],s=e.headerRow.cells;for(var i=0;i<s.length;i++){const r=s[i],a="column"+i,o={};r.width&&(o.width=r.width),r.minWidth&&(o.minWidth=r.minWidth);const l=this.renderCellContent(r,"column-header",{}),u=r.hasTitle?v("th",{className:r.className,key:a,style:o}," ",l," "):v("td",{className:r.className,key:a,style:o});t.push(u)}return v("thead",null,v("tr",null,t))}renderFooter(){const e=this.question.renderedTable;if(!e.showFooter)return null;const t=this.renderRow("footer",e.footerRow,this.question.cssClasses,"row-footer");return v("tfoot",null,t)}renderRows(){const e=this.question.cssClasses,t=[],s=this.question.renderedTable.renderedRows;for(var i=0;i<s.length;i++)t.push(this.renderRow(s[i].id,s[i],e));return v("tbody",null,t)}renderRow(e,t,s,i){const r=[],a=t.cells;for(var o=0;o<a.length;o++)r.push(this.renderCell(a[o],s,i));const l="row"+e;return v(ke,{key:l},i=="row-footer"?v("tr",null,r):v(xw,{model:t,parentMatrix:this.question},r))}renderCell(e,t,s){const i="cell"+e.id;if(e.hasQuestion)return v(EL,{key:i,cssClasses:t,cell:e,creator:this.creator,reason:s});if(e.isErrorsCell&&e.isErrorsCell)return v(TL,{cell:e,key:i,keyValue:i,question:e.question,creator:this.creator});let r=s;r||(r=e.hasTitle?"row-header":"");const a=this.renderCellContent(e,r,t);let o=null;return(e.width||e.minWidth)&&(o={},e.width&&(o.width=e.width),e.minWidth&&(o.minWidth=e.minWidth)),v("td",{className:e.className,key:i,style:o,colSpan:e.colSpans,title:e.getTitle()},a)}renderCellContent(e,t,s){let i=null,r=null;if((e.width||e.minWidth)&&(r={},e.width&&(r.width=e.width),e.minWidth&&(r.minWidth=e.minWidth)),e.hasTitle){t="row-header";const o=this.renderLocString(e.locTitle),l=e.column?v(Sw,{column:e.column,question:this.question}):null;i=v(ke,null,o,l)}if(e.isDragHandlerCell&&(i=v(ke,null,v(Vw,{item:{data:{row:e.row,question:this.question}}}))),e.isActionsCell&&(i=te.Instance.createElement("sv-matrixdynamic-actions-cell",{question:this.question,cssClasses:s,cell:e,model:e.item.getData()})),e.hasPanel&&(i=v(Jr,{key:e.panel.id,element:e.panel,survey:this.question.survey,cssClasses:s,isDisplayMode:this.isDisplayMode,creator:this.creator})),!i)return null;const a=v(ke,null,i);return this.wrapCell(e,a,t)}renderElement(){const e=this.renderHeader(),t=this.renderFooter(),s=this.renderRows();return v("table",{className:this.question.getTableCss()},e,s,t)}}class Pw extends Tt{constructor(e){super(e),this.question.renderedTable,this.state=this.getState()}get question(){return this.questionBase}getState(e=null){return{rowCounter:e?e.rowCounter+1:0}}updateStateOnCallback(){this.isRendering||this.setState(this.getState(this.state))}componentDidMount(){super.componentDidMount(),this.question.onRenderedTableResetCallback=()=>{this.updateStateOnCallback()}}componentWillUnmount(){super.componentWillUnmount(),this.question.onRenderedTableResetCallback=()=>{}}renderElement(){return this.renderTableDiv()}renderTableDiv(){return v("div",{className:this.question.cssClasses.tableWrapper,ref:e=>this.setControl(e)},v(SL,{question:this.question,creator:this.creator,wrapCell:(e,t,s)=>this.wrapCell(e,t,s)}))}}class IL extends ht{constructor(e){super(e)}get model(){return this.props.model}renderElement(){return v(Is,{model:this.model,handleClick:!1})}}class TL extends gw{constructor(e){super(e)}get key(){return this.props.keyValue}get cell(){return this.props.cell}render(){return this.cell.isVisible?v("td",{className:this.cell.className,key:this.key,colSpan:this.cell.colSpans,title:this.cell.getTitle()},super.render()):null}getQuestionPropertiesToTrack(){return super.getQuestionPropertiesToTrack().concat(["visible"])}}te.Instance.registerElement("sv-matrixdynamic-actions-cell",n=>v(IL,n));class Sw extends ht{constructor(e){super(e)}get column(){return this.props.column}get question(){return this.props.question}getStateElement(){return this.column}renderElement(){return this.column.isRenderedRequired?v(ke,null,v("span",null,""),v("span",{className:this.question.cssClasses.cellRequiredMark},this.column.requiredMark)):null}}class EL extends $7{constructor(e){super(e)}get cell(){return this.props.cell}get itemCss(){return this.cell?this.cell.className:""}getQuestion(){var e=super.getQuestion();return e||(this.cell?this.cell.question:null)}doAfterRender(){var e=this.cellRef.current;if(e&&this.cell&&this.question&&this.question.survey&&e.getAttribute("data-rendered")!=="r"){e.setAttribute("data-rendered","r");const t={cell:this.cell,cellQuestion:this.question,htmlElement:e,row:this.cell.row,column:this.cell.cell.column};this.question.survey.matrixAfterCellRender(t),this.question.afterRenderCore(e)}}getShowErrors(){return this.question.isVisible&&(!this.cell.isChoice||this.cell.isFirstChoice)}getCellStyle(){var e=super.getCellStyle();return(this.cell.width||this.cell.minWidth)&&(e||(e={}),this.cell.width&&(e.width=this.cell.width),this.cell.minWidth&&(e.minWidth=this.cell.minWidth)),e}getHeaderText(){return this.cell.headers}renderElement(){return this.cell.isVisible?super.renderElement():null}renderCellContent(){const e=super.renderCellContent(),t=this.cell.showResponsiveTitle?v("span",{className:this.cell.responsiveTitleCss},this.renderLocString(this.cell.responsiveLocTitle),v(Sw,{column:this.cell.column,question:this.cell.matrix})):null;return v(ke,null,t,e)}renderQuestion(){return this.question.isVisible?this.cell.isChoice?this.cell.isOtherChoice?this.renderOtherComment():this.cell.isCheckbox?this.renderCellCheckboxButton():this.renderCellRadiogroupButton():Qi.renderQuestionBody(this.creator,this.question):v(ke,null)}renderOtherComment(){const e=this.cell.question,t=e.cssClasses||{};return v(vc,{question:e,item:e.otherItem,cssClasses:t})}renderCellCheckboxButton(){var e=this.cell.question.id+"item"+this.cell.choiceIndex;return v(yw,{key:e,question:this.cell.question,cssClasses:this.cell.question.cssClasses,isDisplayMode:this.cell.question.isInputReadOnly,item:this.cell.item,isFirst:this.cell.isFirstChoice,index:this.cell.choiceIndex.toString(),hideCaption:!0,ariaLabel:this.getCellAriaLabel()})}renderCellRadiogroupButton(){var e=this.cell.question.id+"item"+this.cell.choiceIndex;return v(ww,{key:e,question:this.cell.question,cssClasses:this.cell.question.cssClasses,isDisplayMode:this.cell.question.isInputReadOnly,item:this.cell.item,index:this.cell.choiceIndex.toString(),isChecked:this.cell.question.value===this.cell.item.value,isDisabled:this.cell.question.isReadOnly||!this.cell.item.isEnabled,hideCaption:!0,ariaLabel:this.getCellAriaLabel()})}getCellAriaLabel(){return this.question.parentQuestion.getCellAriaLabel(this.cell.row,this.cell.column)}}class RL extends Pw{constructor(e){super(e)}}je.Instance.registerQuestion("matrixdropdown",n=>v(RL,n));class _L extends Pw{constructor(e){super(e),this.handleOnRowAddClick=this.handleOnRowAddClick.bind(this)}get matrix(){return this.questionBase}handleOnRowAddClick(e){this.matrix.addRowUI()}renderElement(){var e=this.question.cssClasses,t=this.question.renderedTable.showTable,s=t?this.renderTableDiv():this.renderNoRowsContent(e);return v("div",null,this.renderAddRowButtonOnTop(e),s,this.renderAddRowButtonOnBottom(e))}renderAddRowButtonOnTop(e){return this.matrix.renderedTable.showAddRowOnTop?this.renderAddRowButton(e):null}renderAddRowButtonOnBottom(e){return this.matrix.renderedTable.showAddRowOnBottom?this.renderAddRowButton(e):null}renderNoRowsContent(e){return te.Instance.createElement("sv-placeholder-matrixdynamic",{cssClasses:e,question:this.matrix})}renderAddRowButton(e,t=!1){return te.Instance.createElement("sv-matrixdynamic-add-btn",{question:this.question,cssClasses:e,isEmptySection:t})}}je.Instance.registerQuestion("matrixdynamic",n=>v(_L,n));class LL extends ht{constructor(e){super(e),this.handleOnRowAddClick=this.handleOnRowAddClick.bind(this)}get matrix(){return this.props.question}handleOnRowAddClick(e){this.matrix.addRowUI()}renderElement(){const e=this.renderLocString(this.matrix.locAddRowText),t=v("button",{className:this.matrix.getAddRowButtonCss(this.props.isEmptySection),type:"button",disabled:this.matrix.isInputReadOnly,onClick:this.matrix.isDesignMode?void 0:this.handleOnRowAddClick},e,v("span",{className:this.props.cssClasses.iconAdd},this.cssClasses.iconAddId&&v("svg",null,v("use",{xlinkHref:this.cssClasses.iconAddId}))));return this.props.isEmptySection?t:v("div",{className:this.props.cssClasses.footer},t)}}class AL extends ht{constructor(e){super(e)}renderElement(){const e=this.props.cssClasses,t=this.props.question,s=t.renderedTable.showAddRow,i=this.renderLocString(t.locNoRowsText),r=v("div",{className:e.noRowsText},i),a=s?this.renderAddRowButton(e,t):void 0;return v("div",{className:e.noRowsSection},r,a)}renderAddRowButton(e,t){return te.Instance.createElement("sv-matrixdynamic-add-btn",{question:t,cssClasses:e,isEmptySection:!0})}}te.Instance.registerElement("sv-matrixdynamic-add-btn",n=>v(LL,n)),te.Instance.registerElement("sv-placeholder-matrixdynamic",n=>v(AL,n));class DL extends Tt{constructor(e){super(e)}get question(){return this.questionBase}componentDidMount(){super.componentDidMount(),this.setState({panelCounter:0});const e=this;this.question.panelCountChangedCallback=function(){e.updateQuestionRendering()},this.question.currentIndexChangedCallback=function(){e.updateQuestionRendering()},this.question.renderModeChangedCallback=function(){e.updateQuestionRendering()}}componentWillUnmount(){super.componentWillUnmount(),this.question.panelCountChangedCallback=()=>{},this.question.currentIndexChangedCallback=()=>{},this.question.renderModeChangedCallback=()=>{}}updateQuestionRendering(){this.setState({panelCounter:this.state?this.state.panelCounter+1:1})}renderElement(){const e=[],t=this.question.cssClasses;this.question.renderedPanels.forEach((a,o)=>{e.push(v(OL,{key:a.id,element:a,question:this.question,index:o,cssClasses:t,isDisplayMode:this.isDisplayMode,creator:this.creator}))});const s=this.question.isRangeShowing&&this.question.isProgressTopShowing?this.renderRange():null,i=this.renderNavigatorV2(),r=this.renderPlaceholder(t);return v("div",{className:t.root},this.question.hasTabbedMenu?v("div",{className:this.question.getTabsContainerCss()},v(Is,{model:this.question.tabbedMenu})):null,r,s,v("div",{className:this.question.cssClasses.panelsContainer},e),i)}renderRange(){return v("div",{className:this.question.cssClasses.progress},v("div",{className:this.question.cssClasses.progressBar,style:{width:this.question.progress},role:"progressbar","aria-label":this.question.progressBarAriaLabel}))}renderAddRowButton(){return te.Instance.createElement("sv-paneldynamic-add-btn",{data:{question:this.question}})}renderNavigatorV2(){if(!this.question.showNavigation)return null;const e=this.question.isRangeShowing&&this.question.isProgressBottomShowing?this.renderRange():null;return v("div",{className:this.question.cssClasses.footer},v("hr",{className:this.question.cssClasses.separator}),e,this.question.showFooterToolbar?v("div",{className:this.question.cssClasses.footerButtonsContainer},v(Is,{model:this.question.footerToolbar})):null)}renderPlaceholder(e){return this.question.getShowNoEntriesPlaceholder()?te.Instance.createElement("sv-placeholder-paneldynamic",{cssClasses:e,question:this.question}):null}}class OL extends Jr{get question(){return this.props.question}get index(){return this.props.index}getSurvey(){return this.question?this.question.survey:null}getCss(){const e=this.getSurvey();return e?e.getCss():{}}render(){const e=super.render(),t=this.renderButton(),s=this.question.showSeparator(this.index)?v("hr",{className:this.question.cssClasses.separator}):null;return v(ke,null,v("div",{className:this.question.getPanelWrapperCss(this.panel)},e,t),s)}renderButton(){return this.question.canRenderRemovePanelOnRight(this.panel)?te.Instance.createElement("sv-paneldynamic-remove-btn",{data:{question:this.question,panel:this.panel}}):null}}je.Instance.registerQuestion("paneldynamic",n=>v(DL,n));class ML extends ht{constructor(e){super(e)}renderElement(){const e=this.props.cssClasses,t=this.props.question;return v("div",{className:e.noEntriesPlaceholder},v("span",null,this.renderLocString(t.locNoEntriesText)),this.renderAddRowButton(t))}renderAddRowButton(e){return te.Instance.createElement("sv-paneldynamic-add-btn",{data:{question:e}})}}te.Instance.registerElement("sv-placeholder-paneldynamic",n=>v(ML,n));class Ll extends mc{constructor(e){super(e)}get isTop(){return this.props.isTop}get progress(){return this.survey.progressValue}get progressText(){return this.survey.progressText}get progressBarAriaLabel(){return this.survey.progressBarAriaLabel}render(){var e={width:this.progress+"%"};return v("div",{className:this.survey.getProgressCssClasses(this.props.container)},v("div",{style:e,className:this.css.progressBar,role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-label":this.progressBarAriaLabel},v("span",{className:hb.getProgressTextInBarCss(this.css)},this.progressText)),v("span",{className:hb.getProgressTextUnderBarCss(this.css)},this.progressText))}}te.Instance.registerElement("sv-progress-pages",n=>v(Ll,n)),te.Instance.registerElement("sv-progress-questions",n=>v(Ll,n)),te.Instance.registerElement("sv-progress-correctquestions",n=>v(Ll,n)),te.Instance.registerElement("sv-progress-requiredquestions",n=>v(Ll,n));class kL extends mc{constructor(e){super(e),this.listContainerRef=gt()}get model(){return this.props.model}get container(){return this.props.container}onResize(e){this.setState({canShowItemTitles:e}),this.setState({canShowHeader:!e})}onUpdateScroller(e){this.setState({hasScroller:e})}onUpdateSettings(){this.setState({canShowItemTitles:this.model.showItemTitles}),this.setState({canShowFooter:!this.model.showItemTitles})}render(){return v("div",{className:this.model.getRootCss(this.props.container),style:{maxWidth:this.model.progressWidth},role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-label":this.model.progressBarAriaLabel},this.state.canShowHeader?v("div",{className:this.css.progressButtonsHeader},v("div",{className:this.css.progressButtonsPageTitle,title:this.model.headerText},this.model.headerText)):null,v("div",{className:this.css.progressButtonsContainer},v("div",{className:this.model.getScrollButtonCss(this.state.hasScroller,!0),role:"button",onClick:()=>this.clickScrollButton(this.listContainerRef.current,!0)}),v("div",{className:this.css.progressButtonsListContainer,ref:this.listContainerRef},v("ul",{className:this.css.progressButtonsList},this.getListElements())),v("div",{className:this.model.getScrollButtonCss(this.state.hasScroller,!1),role:"button",onClick:()=>this.clickScrollButton(this.listContainerRef.current,!1)})),this.state.canShowFooter?v("div",{className:this.css.progressButtonsFooter},v("div",{className:this.css.progressButtonsPageTitle,title:this.model.footerText},this.model.footerText)):null)}getListElements(){let e=[];return this.survey.visiblePages.forEach((t,s)=>{e.push(this.renderListElement(t,s))}),e}renderListElement(e,t){const s=Ve.renderLocString(e.locNavigationTitle);return v("li",{key:"listelement"+t,className:this.model.getListElementCss(t),onClick:this.model.isListElementClickable(t)?()=>this.model.clickListElement(e):void 0,"data-page-number":this.model.getItemNumber(e)},v("div",{className:this.css.progressButtonsConnector}),this.state.canShowItemTitles?v(ke,null,v("div",{className:this.css.progressButtonsPageTitle,title:e.renderedNavigationTitle},s),v("div",{className:this.css.progressButtonsPageDescription,title:e.navigationDescription},e.navigationDescription)):null,v("div",{className:this.css.progressButtonsButton},v("div",{className:this.css.progressButtonsButtonBackground}),v("div",{className:this.css.progressButtonsButtonContent}),v("span",null,this.model.getItemNumber(e))))}clickScrollButton(e,t){e&&(e.scrollLeft+=(t?-1:1)*70)}componentDidMount(){super.componentDidMount(),setTimeout(()=>{this.respManager=new C_(this.model,this.listContainerRef.current,this)},10)}componentWillUnmount(){this.respManager&&this.respManager.dispose(),super.componentWillUnmount()}}te.Instance.registerElement("sv-progress-buttons",n=>v(kL,n));class Iw extends Ve{constructor(e){super(e),this.handleKeydown=t=>{this.model.onKeyDown(t)},this.elementRef=gt()}get model(){return this.props.model}get item(){return this.props.item}getStateElement(){return this.item}render(){if(!this.item)return null;const e=this.model.getItemClass(this.item),t=this.item.component||this.model.itemComponent,s=te.Instance.createElement(t,{item:this.item,key:this.item.id,model:this.model}),i=v("div",{ref:this.elementRef,style:this.model.getItemStyle(this.item),className:this.model.cssClasses.itemBody,title:this.item.getTooltip(),onMouseOver:l=>{this.model.onItemHover(this.item)},onMouseLeave:l=>{this.model.onItemLeave(this.item)}},s),r=this.item.needSeparator?v("div",{className:this.model.cssClasses.itemSeparator}):null,o={display:this.model.isItemVisible(this.item)?null:"none"};return gc(v("li",{className:e,role:this.model.listItemRole,style:o,id:this.item.elementId,"aria-selected":this.model.getA11yItemAriaSelected(this.item),"aria-checked":this.model.getA11yItemAriaChecked(this.item),onClick:l=>{this.model.onItemClick(this.item),l.stopPropagation()},onPointerDown:l=>this.model.onPointerDown(l,this.item)},r,i),this.item)}componentDidMount(){var e;super.componentDidMount(),this.model.onItemRended(this.item,(e=this.elementRef)===null||e===void 0?void 0:e.current)}}te.Instance.registerElement("sv-list-item",n=>v(Iw,n));class Tw extends Ve{constructor(e){super(e),this.handleKeydown=t=>{this.model.onKeyDown(t)},this.handleMouseMove=t=>{this.model.onMouseMove(t)},this.state={filterString:this.model.filterString||""},this.listContainerRef=gt()}get model(){return this.props.model}getStateElement(){return this.model}componentDidMount(){super.componentDidMount(),this.listContainerRef&&this.listContainerRef.current&&this.model.initListContainerHtmlElement(this.listContainerRef.current)}componentDidUpdate(e,t){var s;super.componentDidUpdate(e,t),this.model!==e.model&&(this.model&&(!((s=this.listContainerRef)===null||s===void 0)&&s.current)&&this.model.initListContainerHtmlElement(this.listContainerRef.current),e.model&&e.model.initListContainerHtmlElement(void 0))}componentWillUnmount(){super.componentWillUnmount(),this.model&&this.model.initListContainerHtmlElement(void 0)}renderElement(){return v("div",{className:this.model.cssClasses.root,ref:this.listContainerRef},this.searchElementContent(),this.emptyContent(),this.renderList())}renderList(){if(!this.model.renderElements)return null;const e=this.renderItems(),t={display:this.model.isEmpty?"none":null};return v("ul",{className:this.model.getListClass(),style:t,role:this.model.listRole,"aria-label":this.model.a11ya11y_input_ariaLabel,id:this.model.elementId,onMouseDown:s=>{s.preventDefault()},onKeyDown:this.handleKeydown,onMouseMove:this.handleMouseMove},e)}renderItems(){if(!this.model)return null;const e=this.model.renderedActions;return e?e.map((t,s)=>v(Iw,{model:this.model,item:t,key:"item"+s})):null}searchElementContent(){if(this.model.showFilter){const e=i=>{var r;const a=(r=i.target.getRootNode())===null||r===void 0?void 0:r.activeElement;i.target===a&&(this.model.filterString=i.target.value)},t=i=>{this.model.goToItems(i)},s=this.model.showSearchClearButton&&this.model.filterString?v("button",{className:this.model.cssClasses.searchClearButtonIcon,onClick:i=>{this.model.onClickSearchClearButton(i)}},v(ze,{iconName:"icon-searchclear",size:"auto"})):null;return v("div",{className:this.model.cssClasses.filter},v("div",{className:this.model.cssClasses.filterIcon},v(ze,{iconName:"icon-search",size:"auto"})),v("input",{type:"text",className:this.model.cssClasses.filterInput,"aria-label":this.model.filterStringPlaceholder,placeholder:this.model.filterStringPlaceholder,value:this.state.filterString,onKeyUp:t,onChange:e}),s)}else return null}emptyContent(){const e={display:this.model.isEmpty?null:"none"};return v("div",{className:this.model.cssClasses.emptyContainer,style:e},v("div",{className:this.model.cssClasses.emptyText,"aria-label":this.model.emptyMessage},this.model.emptyMessage))}}te.Instance.registerElement("sv-list",n=>v(Tw,n));class NL extends mc{componentDidMount(){super.componentDidMount(),this.props.model.updateStickyTOCSize(this.survey.rootElement)}render(){const e=this.props.model;let t;return e.isMobile?t=v("div",{onClick:e.togglePopup},v(ze,{iconName:e.icon,size:24}),v(Nn,{model:e.popupModel})):t=v(Tw,{model:e.listModel}),v("div",{className:e.containerCss},t)}}te.Instance.registerElement("sv-navigation-toc",n=>v(NL,n));class qL extends Tt{constructor(e){super(e),this.handleOnClick=this.handleOnClick.bind(this)}get question(){return this.questionBase}handleOnClick(e){this.question.setValueFromClick(e.target.value),this.setState({value:this.question.value})}renderItem(e,t){return te.Instance.createElement(this.question.itemComponent,{question:this.question,item:e,index:t,key:"value"+t,handleOnClick:this.handleOnClick,isDisplayMode:this.isDisplayMode})}renderElement(){var e=this.question.cssClasses,t=this.question.minRateDescription?this.renderLocString(this.question.locMinRateDescription):null,s=this.question.maxRateDescription?this.renderLocString(this.question.locMaxRateDescription):null;return v("div",{className:this.question.ratingRootCss,ref:i=>this.setControl(i)},v("fieldset",{role:this.question.a11y_input_ariaRole,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-labelledby":this.question.a11y_input_ariaLabelledBy,"aria-describedby":this.question.a11y_input_ariaDescribedBy,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage},v("legend",{role:"presentation",className:"sv-hidden"}),this.question.hasMinLabel?v("span",{className:e.minText},t):null,this.question.renderedRateItems.map((i,r)=>this.renderItem(i,r)),this.question.hasMaxLabel?v("span",{className:e.maxText},s):null))}}je.Instance.registerQuestion("rating",n=>v(qL,n));class BL extends _l{constructor(e){super(e)}renderElement(){var e=this.question.cssClasses,t=this.renderSelect(e);return v("div",{className:this.question.cssClasses.rootDropdown},t)}}je.Instance.registerQuestion("sv-rating-dropdown",n=>v(BL,n)),pi.Instance.registerRenderer("rating","dropdown","sv-rating-dropdown");class FL extends Tt{constructor(e){super(e),this.rangeInputRef=gt()}componentDidMount(){super.componentDidMount(),this.question.refreshInputRange(this.rangeInputRef.current)}get question(){return this.questionBase}getStateElement(){return this.question}renderElement(){const{cssClasses:e,showLabels:t,sliderType:s,getTrackPercentLeft:i,getTrackPercentRight:r,allowDragRange:a,setValueByClickOnPath:o}=this.question,l=s==="single"&&a?null:this.getRangeInput(),u=this.getInputsAndThumbs(),d=t?this.getLabels():null;return v("div",{className:this.question.rootCss,ref:h=>this.setControl(h)},l,v("div",{className:e.visualContainer,onPointerUp:h=>{o(h.nativeEvent,this.control)}},v("div",{className:e.visualContainerSlider},v("div",{className:e.inverseTrackLeft,style:{width:i()+"%"}}),v("div",{className:e.inverseTrackRight,style:{width:r()+"%"}}),v("div",{className:e.rangeTrack,style:{left:i()+"%",right:r()+"%"}}),u)),d)}getInputsAndThumbs(){const e=[],t=this.question.renderedValue;for(let s=0;s<t.length;s++){const i=v(ke,{key:s},this.getInput(s),this.getThumb(s));e.push(i)}return e}getThumb(e){const{cssClasses:t,getThumbContainerCss:s,tooltipVisibility:i,tooltipCss:r,getPercent:a,renderedValue:o,getTooltipValue:l}=this.question,u=o[e];let d=null;return i!=="never"&&(d=v("div",{className:r},v("div",{className:t.tooltipPanel},v("div",{className:t.tooltipValue},l(e))))),v("div",{className:s(e),style:{left:a(u)+"%"}},d,v("div",{className:t.thumb},v("div",{className:t.thumbDot})))}getInput(e){const{renderedMax:t,renderedMin:s,step:i,cssClasses:r,isDisabledAttr:a,renderedValue:o,handleOnChange:l,handlePointerDown:u,handlePointerUp:d,handleKeyDown:h,handleKeyUp:f,handleOnFocus:C,handleOnBlur:b,id:x}=this.question,V=o[e];return v("input",{className:r.input,id:x+"-sjs-slider-input-"+e,type:"range",min:s,max:t,step:i,value:V,onChange:M=>{l(M.nativeEvent,e)},onPointerDown:M=>{u(M.nativeEvent)},onPointerUp:M=>{M.stopPropagation(),d(M.nativeEvent)},onKeyDown:M=>{h(M.nativeEvent)},onKeyUp:M=>{f(M.nativeEvent)},onFocus:()=>{C(e)},onBlur:()=>{b()},disabled:a,"aria-required":this.question.a11y_input_ariaRequired,"aria-label":this.question.a11y_input_ariaLabel,"aria-labelledby":this.question.a11y_input_ariaLabelledBy,"aria-describedby":this.question.a11y_input_ariaDescribedBy,"aria-invalid":this.question.a11y_input_ariaInvalid,"aria-errormessage":this.question.a11y_input_ariaErrormessage})}getRangeInput(){const{renderedMax:e,renderedMin:t,step:s,cssClasses:i,handleRangeOnChange:r,handleRangePointerDown:a,handleRangePointerUp:o,id:l}=this.question;return v("input",{name:"range-input",id:l+"-sjs-slider-input-range-input",ref:this.rangeInputRef,className:i.input,type:"range","aria-hidden":"true",min:t,max:e,step:s,tabIndex:-1,onChange:u=>{r(u.nativeEvent)},onPointerDown:u=>{u.persist(),a(u.nativeEvent,this.control)},onPointerUp:u=>{o(u.nativeEvent,this.control)}})}getLabels(){const e=[],{renderedLabels:t,cssClasses:s}=this.question;for(let i=0;i<t.length;i++){const r=te.Instance.createElement("sv-slider-label-item",{item:t[i],question:this.question,key:t[i].id});e.push(r)}return v("div",{className:s.labelsContainer},v("div",null,e))}}je.Instance.registerQuestion("slider",n=>v(FL,n));class QL extends Tt{constructor(e){super(e)}get question(){return this.questionBase}renderElement(){var e=this.question.cssClasses;return v("div",{id:this.question.inputId,className:e.root,ref:t=>this.setControl(t),"aria-live":"polite","aria-label":this.question.formatedValue},this.question.formatedValue)}}je.Instance.registerQuestion("expression",n=>v(QL,n));class HL extends pc{constructor(e){super(e),this.handleOnExpanded=this.handleOnExpanded.bind(this)}getStateElements(){return[this.popup,this.popup.survey]}handleOnExpanded(e){this.popup.changeExpandCollapse()}canRender(){return super.canRender()&&this.popup.isShowing}renderElement(){var e=this.renderWindowHeader(),t=this.renderBody();let s={};return this.popup.renderedWidth&&(s.width=this.popup.renderedWidth,s.maxWidth=this.popup.renderedWidth),v("div",{className:this.popup.cssRoot,style:s,onScroll:()=>this.popup.onScroll()},v("div",{className:this.popup.cssRootContent},e,t))}renderWindowHeader(){var e=this.popup,t=e.cssHeaderRoot,s=null,i,r=null,a=null;return e.isCollapsed?(t+=" "+e.cssRootCollapsedMod,s=this.renderTitleCollapsed(e),i=this.renderExpandIcon()):i=this.renderCollapseIcon(),e.allowClose&&(r=this.renderCloseButton(this.popup)),e.allowFullScreen&&(a=this.renderAllowFullScreenButon(this.popup)),v("div",{className:e.cssHeaderRoot},s,v("div",{className:e.cssHeaderButtonsContainer},a,v("div",{className:e.cssHeaderCollapseButton,onClick:this.handleOnExpanded},i),r))}renderTitleCollapsed(e){return e.locTitle?v("div",{className:e.cssHeaderTitleCollapsed},e.locTitle.renderedHtml):null}renderExpandIcon(){return v(ze,{iconName:"icon-restore_16x16",size:16})}renderCollapseIcon(){return v(ze,{iconName:"icon-minimize_16x16",size:16})}renderCloseButton(e){return v("div",{className:e.cssHeaderCloseButton,onClick:()=>{e.hide(),typeof this.props.onClose=="function"&&this.props.onClose()}},v(ze,{iconName:"icon-close_16x16",size:16}))}renderAllowFullScreenButon(e){let t;return e.isFullScreen?t=v(ze,{iconName:"icon-back-to-panel_16x16",size:16}):t=v(ze,{iconName:"icon-full-screen_16x16",size:16}),v("div",{className:e.cssHeaderFullScreenButton,onClick:()=>{e.toggleFullScreen()}},t)}renderBody(){return v("div",{className:this.popup.cssBody},this.doRender())}createSurvey(e){e||(e={}),super.createSurvey(e),this.popup=new db(null,this.survey),e.closeOnCompleteTimeout&&(this.popup.closeOnCompleteTimeout=e.closeOnCompleteTimeout),this.popup.allowClose=e.allowClose,this.popup.allowFullScreen=e.allowFullScreen,this.popup.isShowing=!0,!this.popup.isExpanded&&(e.expanded||e.isExpanded)&&this.popup.expand()}}class zL extends Tt{constructor(e){super(e)}get question(){return this.questionBase}renderElement(){var e=this.question.cssClasses;return v("fieldset",{className:this.question.getSelectBaseRootCss(),style:this.question.getContainerStyle()},v("legend",{className:"sv-hidden"},this.question.locTitle.renderedHtml),this.question.hasColumns?this.getColumns(e):this.getItems(e))}getColumns(e){return this.question.columns.map((t,s)=>{var i=t.map((r,a)=>this.renderItem(r,e));return v("div",{key:"column"+s+this.question.getItemsColumnKey(t),className:this.question.getColumnClass(),role:"presentation"},i)})}getItems(e){for(var t=[],s=0;s<this.question.visibleChoices.length;s++){var i=this.question.visibleChoices[s];t.push(this.renderItem(i,e))}return t}get textStyle(){return{marginLeft:"3px",display:"inline",position:"static"}}renderItem(e,t){const s=v(jL,{key:e.uniqueId,question:this.question,item:e,cssClasses:t}),i=this.question.survey;let r=null;return i&&(r=ti.wrapItemValue(i,s,this.question,e)),r??s}}class jL extends ht{constructor(e){super(e),this.handleOnChange=this.handleOnChange.bind(this)}getStateElement(){return this.item}componentDidMount(){super.componentDidMount(),this.reactOnStrChanged()}componentWillUnmount(){super.componentWillUnmount(),this.item.locImageLink.onChanged=function(){}}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.reactOnStrChanged()}reactOnStrChanged(){this.item.locImageLink.onChanged=()=>{this.setState({locImageLinkchanged:this.state&&this.state.locImageLink?this.state.locImageLink+1:1})}}get cssClasses(){return this.props.cssClasses}get item(){return this.props.item}get question(){return this.props.question}handleOnChange(e){if(!this.question.isReadOnlyAttr){if(this.question.multiSelect)if(e.target.checked)this.question.value=this.question.value.concat(e.target.value);else{var t=this.question.value;t.splice(this.question.value.indexOf(e.target.value),1),this.question.value=t}else this.question.value=e.target.value;this.setState({value:this.question.value})}}renderElement(){const e=this.item,t=this.question,s=this.cssClasses;var i=t.isItemSelected(e),r=t.getItemClass(e),a=null;t.showLabel&&(a=v("span",{className:t.cssClasses.itemText},e.text?Ve.renderLocString(e.locText):e.value));var o={objectFit:this.question.imageFit},l=null;if(e.locImageLink.renderedHtml&&this.question.contentMode==="image"&&(l=v("img",{className:s.image,src:e.locImageLink.renderedHtml,width:this.question.renderedImageWidth,height:this.question.renderedImageHeight,alt:e.locText.renderedHtml,style:o,onLoad:d=>{this.question.onContentLoaded(e,d.nativeEvent)},onError:d=>{e.onErrorHandler(e,d.nativeEvent)}})),e.locImageLink.renderedHtml&&this.question.contentMode==="video"&&(l=v("video",{controls:!0,className:s.image,src:e.locImageLink.renderedHtml,width:this.question.renderedImageWidth,height:this.question.renderedImageHeight,style:o,onLoadedMetadata:d=>{this.question.onContentLoaded(e,d.nativeEvent)},onError:d=>{e.onErrorHandler(e,d.nativeEvent)}})),!e.locImageLink.renderedHtml||e.contentNotLoaded){let d={width:this.question.renderedImageWidth,height:this.question.renderedImageHeight,objectFit:this.question.imageFit};l=v("div",{className:s.itemNoImage,style:d},s.itemNoImageSvgIcon?v(ze,{className:s.itemNoImageSvgIcon,iconName:this.question.cssClasses.itemNoImageSvgIconId,size:48}):null)}return v("div",{className:r},v("label",{className:s.label},v("input",{className:s.itemControl,id:this.question.getItemId(e),type:this.question.inputType,name:this.question.questionName,checked:i,value:e.value,disabled:!this.question.getItemEnabled(e),readOnly:this.question.isReadOnlyAttr,onChange:this.handleOnChange,required:this.question.inputRequiredAttribute,"aria-label":e.locText.renderedHtml,"aria-invalid":this.question.ariaInvalid,"aria-errormessage":this.question.ariaErrormessage}),v("div",{className:this.question.cssClasses.itemDecorator},v("div",{className:this.question.cssClasses.imageContainer},this.question.cssClasses.checkedItemDecorator?v("span",{className:this.question.cssClasses.checkedItemDecorator,"aria-hidden":"true"},this.question.cssClasses.checkedItemSvgIconId?v(ze,{size:"auto",className:this.question.cssClasses.checkedItemSvgIcon,iconName:this.question.cssClasses.checkedItemSvgIconId}):null):null,l),a)))}}je.Instance.registerQuestion("imagepicker",n=>v(zL,n));class UL extends Tt{constructor(e){super(e)}componentDidMount(){super.componentDidMount(),this.question.locImageLink.onChanged=()=>{this.forceUpdate()}}componentWillUnmount(){super.componentWillUnmount(),this.question.locImageLink.onChanged=()=>{}}get question(){return this.questionBase}renderElement(){var e=this.question.getImageCss(),t={objectFit:this.question.imageFit,width:this.question.renderedStyleWidth,height:this.question.renderedStyleHeight};(!this.question.imageLink||this.question.contentNotLoaded)&&(t.display="none");var s=null;this.question.renderedMode==="image"&&(s=v("img",{className:e,src:this.question.locImageLink.renderedHtml||null,alt:this.question.renderedAltText,width:this.question.renderedWidth,height:this.question.renderedHeight,style:t,onLoad:r=>{this.question.onLoadHandler()},onError:r=>{this.question.onErrorHandler()}})),this.question.renderedMode==="video"&&(s=v("video",{controls:!0,className:e,src:this.question.locImageLink.renderedHtml,width:this.question.renderedWidth,height:this.question.renderedHeight,style:t,onLoadedMetadata:r=>{this.question.onLoadHandler()},onError:r=>{this.question.onErrorHandler()}})),this.question.renderedMode==="youtube"&&(s=v("iframe",{className:e,src:this.question.locImageLink.renderedHtml,width:this.question.renderedWidth,height:this.question.renderedHeight,style:t,title:this.question.renderedAltText}));var i=null;return(!this.question.imageLink||this.question.contentNotLoaded)&&(i=v("div",{className:this.question.cssClasses.noImage},v(ze,{iconName:this.question.cssClasses.noImageSvgIconId,size:48}))),v("div",{className:this.question.cssClasses.root},s,i)}}je.Instance.registerQuestion("image",n=>v(UL,n));class WL extends Tt{constructor(e){super(e),this.state={value:this.question.value}}get question(){return this.questionBase}renderElement(){var e=this.question.cssClasses;const t=this.question.showLoadingIndicator?this.renderLoadingIndicator():null;var s=this.renderCleanButton();return v("div",{className:e.root,ref:i=>this.setControl(i),style:{width:this.question.renderedCanvasWidth}},v("div",{className:e.placeholder,style:{display:this.question.needShowPlaceholder()?"":"none"}},this.renderLocString(this.question.locRenderedPlaceholder)),v("div",null,this.renderBackgroundImage(),v("canvas",{tabIndex:-1,className:this.question.cssClasses.canvas,onBlur:i=>{this.question.onBlur(i)}})),s,t)}renderBackgroundImage(){return this.question.backgroundImage?v("img",{className:this.question.cssClasses.backgroundImage,src:this.question.backgroundImage,style:{width:this.question.renderedCanvasWidth},role:"presentation"}):null}renderLoadingIndicator(){return v("div",{className:this.question.cssClasses.loadingIndicator},v(bw,null))}renderCleanButton(){if(!this.question.canShowClearButton)return null;var e=this.question.cssClasses;return v("div",{className:e.controls},v("button",{type:"button",className:e.clearButton,title:this.question.clearButtonCaption,onClick:()=>this.question.clearValueFromUI()},this.question.cssClasses.clearButtonIconId?v(ze,{iconName:this.question.cssClasses.clearButtonIconId,size:"auto"}):v("span",null,"")," "))}}je.Instance.registerQuestion("signaturepad",n=>v(WL,n));class $L extends Tt{constructor(e){super(e)}get question(){return this.questionBase}getStateElement(){return this.question}renderElement(){const e=this.renderItems();return v("div",{className:this.question.cssClasses.root},e)}renderItems(){return this.question.visibleChoices.map((e,t)=>v(GL,{key:this.question.inputId+"_"+t,item:e,question:this.question,index:t}))}}je.Instance.registerQuestion("buttongroup",n=>v($L,n));class GL extends Ve{constructor(e){super(e)}get index(){return this.props.index}get question(){return this.props.question}get item(){return this.props.item}getStateElement(){return this.item}renderElement(){this.model=new a7(this.question,this.item,this.index);const e=this.renderIcon(),t=this.renderInput(),s=this.renderCaption();return v("label",{className:this.model.css.label,title:this.model.caption.renderedHtml},t,v("div",{className:this.model.css.decorator},e,s))}renderIcon(){return this.model.iconName?v(ze,{className:this.model.css.icon,iconName:this.model.iconName,size:this.model.iconSize||24}):null}renderInput(){return v("input",{className:this.model.css.control,id:this.model.id,type:"radio",name:this.model.name,checked:this.model.selected,value:this.model.value,disabled:this.model.readOnly,onChange:()=>{this.model.onChange()},"aria-required":this.model.isRequired,"aria-label":this.model.caption.renderedHtml,"aria-invalid":this.model.hasErrors,"aria-errormessage":this.model.describedBy})}renderCaption(){if(!this.model.showCaption)return null;let e=this.renderLocString(this.model.caption);return v("span",{className:this.model.css.caption,title:this.model.caption.renderedHtml},e)}}class JL extends _l{constructor(e){super(e)}renderElement(){const e=this.question.cssClasses,t=this.renderSelect(e);return v("div",{className:this.question.cssClasses.rootDropdown},t)}}je.Instance.registerQuestion("sv-buttongroup-dropdown",n=>v(JL,n)),pi.Instance.registerRenderer("buttongroup","dropdown","sv-buttongroup-dropdown");class KL extends Mn{constructor(e){super(e)}getStateElements(){const e=super.getStateElements();return this.question.contentQuestion&&e.push(this.question.contentQuestion),e}renderElement(){return Qi.renderQuestionBody(this.creator,this.question.contentQuestion)}}class ZL extends Mn{constructor(e){super(e)}canRender(){return!!this.question.contentPanel}renderElement(){return v(Jr,{element:this.question.contentPanel,creator:this.creator,survey:this.question.survey})}}je.Instance.registerQuestion("custom",n=>v(KL,n)),je.Instance.registerQuestion("composite",n=>v(ZL,n));class YL extends Ve{get model(){return this.props.model}get item(){return this.props.item}getStateElement(){return this.item}render(){if(!this.item)return null;const e=this.renderLocString(this.item.locTitle,void 0,"locString"),t=this.item.iconName?v(ze,{className:this.model.cssClasses.itemIcon,iconName:this.item.iconName,size:this.item.iconSize,"aria-label":this.item.title}):null,s=this.item.markerIconName?v(ze,{className:this.item.cssClasses.itemMarkerIcon,iconName:this.item.markerIconName,size:"auto"}):null;return v(ke,null,t,e,s)}}te.Instance.registerElement("sv-list-item-content",n=>v(YL,n));class XL extends Ve{get model(){return this.props.model}get item(){return this.props.item}getStateElement(){return this.item}render(){var e;if(!this.item)return null;const t=te.Instance.createElement("sv-list-item-content",{item:this.item,key:"content"+this.item.id,model:this.model});return v(ke,null,t,v(Nn,{model:(e=this.item)===null||e===void 0?void 0:e.popupModel}))}}te.Instance.registerElement("sv-list-item-group",n=>v(XL,n));class e4 extends Ye{constructor(e){super(e)}get survey(){return this.props.data}render(){const e=[];return e.push(v("div",{key:"logo-image",className:this.survey.logoClassNames},v("img",{className:this.survey.css.logoImage,src:this.survey.locLogo.renderedHtml||null,alt:this.survey.locTitle.renderedHtml,width:this.survey.renderedLogoWidth,height:this.survey.renderedLogoHeight,style:{objectFit:this.survey.logoFit,width:this.survey.renderedStyleLogoWidth,height:this.survey.renderedStyleLogoHeight}}))),v(ke,null,e)}}te.Instance.registerElement("sv-logo-image",n=>v(e4,n));class t4 extends ht{constructor(e){super(e),this.handleOnRowRemoveClick=this.handleOnRowRemoveClick.bind(this)}get question(){return this.props.item.data.question}get row(){return this.props.item.data.row}handleOnRowRemoveClick(e){this.question.removeRowUI(this.row)}renderElement(){var e=this.renderLocString(this.question.locRemoveRowText);return v("button",{className:this.question.getRemoveRowButtonCss(),type:"button",onClick:this.handleOnRowRemoveClick,disabled:this.question.isInputReadOnly},e,v("span",{className:this.question.cssClasses.iconRemove}))}}te.Instance.registerElement("sv-matrix-remove-button",n=>v(t4,n));class s4 extends ht{constructor(e){super(e),this.handleOnShowHideClick=this.handleOnShowHideClick.bind(this)}getStateElement(){return this.props.item}get item(){return this.props.item}get question(){return this.props.item.data.question}get row(){return this.props.item.data.row}handleOnShowHideClick(e){this.row.showHideDetailPanelClick()}renderElement(){var e=this.row.isDetailPanelShowing,t=e,s=e?this.row.detailPanelId:void 0;return v("button",{type:"button",title:this.props.item.title,onClick:this.handleOnShowHideClick,className:this.question.getDetailPanelButtonCss(this.row),"aria-expanded":t,"aria-controls":s},v(ze,{className:this.question.getDetailPanelIconCss(this.row),iconName:this.question.getDetailPanelIconId(this.row),size:"auto"}))}}te.Instance.registerElement("sv-matrix-detail-button",n=>v(s4,n));class Bn extends ht{constructor(e){super(e)}get data(){return this.props.item&&this.props.item.data||this.props.data}get question(){return this.props.item&&this.props.item.data.question||this.props.data.question}}class i4 extends Bn{constructor(){super(...arguments),this.handleClick=e=>{this.question.addPanelUI()}}renderElement(){if(!this.question.canAddPanel)return null;const e=this.renderLocString(this.question.locAddPanelText);return v("button",{type:"button",id:this.question.addButtonId,className:this.question.getAddButtonCss(),onClick:this.handleClick},v("span",{className:this.question.cssClasses.buttonAddText},e))}}te.Instance.registerElement("sv-paneldynamic-add-btn",n=>v(i4,n));class r4 extends Bn{constructor(){super(...arguments),this.handleClick=e=>{this.question.removePanelUI(this.data.panel)}}renderElement(){const e=this.renderLocString(this.question.locRemovePanelText),t=this.question.getPanelRemoveButtonId(this.data.panel);return v("button",{id:t,className:this.question.getPanelRemoveButtonCss(),onClick:this.handleClick,type:"button"},v("span",{className:this.question.cssClasses.buttonRemoveText},e),v("span",{className:this.question.cssClasses.iconRemove}))}}te.Instance.registerElement("sv-paneldynamic-remove-btn",n=>v(r4,n));class n4 extends Bn{constructor(){super(...arguments),this.handleClick=e=>{this.question.goToPrevPanel()}}renderElement(){return v("div",{title:this.question.panelPrevText,onClick:this.handleClick,className:this.question.getPrevButtonCss()},v(ze,{iconName:this.question.cssClasses.progressBtnIcon,size:"auto"}))}}te.Instance.registerElement("sv-paneldynamic-prev-btn",n=>v(n4,n));class a4 extends Bn{constructor(){super(...arguments),this.handleClick=e=>{this.question.goToNextPanel()}}renderElement(){return v("div",{title:this.question.panelNextText,onClick:this.handleClick,className:this.question.getNextButtonCss()},v(ze,{iconName:this.question.cssClasses.progressBtnIcon,size:"auto"}))}}te.Instance.registerElement("sv-paneldynamic-next-btn",n=>v(a4,n));class o4 extends Bn{renderElement(){return v("div",{className:this.question.cssClasses.progressText},this.question.progressText)}}te.Instance.registerElement("sv-paneldynamic-progress-text",n=>v(o4,n));class l4 extends ht{get item(){return this.props.item}canRender(){return this.item.isVisible}renderElement(){return v("input",{className:this.item.innerCss,type:"button",disabled:this.item.disabled,onMouseDown:this.item.data&&this.item.data.mouseDown,onClick:this.item.action,title:this.item.getTooltip(),value:this.item.title})}}te.Instance.registerElement("sv-nav-btn",n=>v(l4,n));class Ew extends Ye{constructor(e){super(e),this.onChangedHandler=(t,s)=>{this.isRendering||this.setState({changed:this.state&&this.state.changed?this.state.changed+1:1})},this.rootRef=gt()}get locStr(){return this.props.locStr}get style(){return this.props.style}componentDidMount(){this.reactOnStrChanged()}componentWillUnmount(){this.locStr&&this.locStr.onStringChanged.remove(this.onChangedHandler)}componentDidUpdate(e,t){e.locStr&&e.locStr.onStringChanged.remove(this.onChangedHandler),this.reactOnStrChanged()}reactOnStrChanged(){this.locStr&&this.locStr.onStringChanged.add(this.onChangedHandler)}render(){if(!this.locStr)return null;this.isRendering=!0;const e=this.renderString();return this.isRendering=!1,e}renderString(){const e=this.locStr.allowLineBreaks?"sv-string-viewer sv-string-viewer--multiline":"sv-string-viewer";if(this.locStr.hasHtml){let t={__html:this.locStr.renderedHtml};return v("span",{ref:this.rootRef,className:e,style:this.style,dangerouslySetInnerHTML:t})}return v("span",{ref:this.rootRef,className:e,style:this.style},this.locStr.renderedHtml)}}te.Instance.registerElement(wt.defaultRenderer,n=>v(Ew,n));class u4 extends Ye{render(){const e=this.props.error,t=this.props.cssClasses;return v("div",null,v("span",{className:e.getCssIcon(t),"aria-hidden":"true"}),v("span",{className:this.props.cssClasses.error.item||void 0},v(Ew,{locStr:e.locText})))}}te.Instance.registerElement("sv-question-error",n=>v(u4,n));class h4 extends Ve{getStateElement(){return this.item}get item(){return this.props.item}get question(){return this.props.question}componentDidUpdate(e,t){super.componentDidUpdate(e,t)}renderElement(){const{cssClasses:e,handleLabelPointerUp:t,getLabelCss:s,getPercent:i}=this.question,{value:r,locText:a}=this.item;let o=null,l=null;return this.item.showValue?(o=v("div",{className:e.labelText},this.item.value),l=v("div",{className:e.labelTextSecondaryMode},this.renderLocString(a))):o=v("div",{className:e.labelText},this.renderLocString(a)),v("div",{key:this.item.uniqueId,className:s(a),style:{left:i(r)+"%"},onPointerUp:u=>{t(u.nativeEvent,r)}},v("div",{className:e.labelTick}),v("div",{className:e.labelTextContainer},o,l))}}te.Instance.registerElement("sv-slider-label-item",n=>v(h4,n));class d4 extends Ye{render(){var e,t;return v("div",{className:"sv-skeleton-element",id:(e=this.props.element)===null||e===void 0?void 0:e.id,style:{height:(t=this.props.element)===null||t===void 0?void 0:t.skeletonHeight}})}}te.Instance.registerElement("sv-skeleton",n=>v(d4,n));class c4 extends Ye{get model(){return this.props.model}renderLogoImage(){const e=this.model.survey.getElementWrapperComponentName(this.model.survey,"logo-image"),t=this.model.survey.getElementWrapperComponentData(this.model.survey,"logo-image");return te.Instance.createElement(e,{data:t})}render(){return v("div",{className:"sv-header--mobile"},this.model.survey.hasLogo?v("div",{className:"sv-header__logo"},this.renderLogoImage()):null,this.model.survey.hasTitle?v("div",{className:"sv-header__title",style:{maxWidth:this.model.renderedTextAreaWidth}},v(Gr,{element:this.model.survey})):null,this.model.survey.renderedHasDescription?v("div",{className:"sv-header__description",style:{maxWidth:this.model.renderedTextAreaWidth}},v("div",{className:this.model.survey.css.description},Ve.renderLocString(this.model.survey.locDescription))):null)}}class p4 extends Ye{get model(){return this.props.model}renderLogoImage(){const e=this.model.survey.getElementWrapperComponentName(this.model.survey,"logo-image"),t=this.model.survey.getElementWrapperComponentData(this.model.survey,"logo-image");return te.Instance.createElement(e,{data:t})}render(){return v("div",{className:this.model.css,style:this.model.style},v("div",{className:"sv-header__cell-content",style:this.model.contentStyle},this.model.showLogo?v("div",{className:"sv-header__logo"},this.renderLogoImage()):null,this.model.showTitle?v("div",{className:"sv-header__title",style:{maxWidth:this.model.textAreaWidth}},v(Gr,{element:this.model.survey})):null,this.model.showDescription?v("div",{className:"sv-header__description",style:{maxWidth:this.model.textAreaWidth}},v("div",{className:this.model.survey.css.description},Ve.renderLocString(this.model.survey.locDescription))):null))}}class g4 extends Ve{get model(){return this.props.model}getStateElement(){return this.model}renderElement(){if(this.model.survey=this.props.survey,this.props.survey.headerView!=="advanced"||this.model.isEmpty)return null;let e=null;return this.props.survey.isMobile?e=v(c4,{model:this.model}):e=v("div",{className:this.model.contentClasses,style:{maxWidth:this.model.maxWidth}},this.model.cells.map((t,s)=>v(p4,{key:s,model:t}))),v("div",{className:this.model.headerClasses,style:{height:this.model.renderedHeight}},this.model.backgroundImage?v("div",{style:this.model.backgroundImageStyle,className:this.model.backgroundImageClasses}):null,e)}componentDidMount(){super.componentDidMount(),this.model.processResponsiveness()}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.model.processResponsiveness()}}te.Instance.registerElement("sv-header",n=>v(g4,n));class m4 extends Ye{constructor(e){super(e),this.onInput=t=>{this.locStr.text=t.target.innerText},this.onClick=t=>{t.preventDefault(),t.stopPropagation()},this.state={changed:0}}get locStr(){return this.props.locStr}get style(){return this.props.style}componentDidMount(){if(this.locStr){var e=this;this.locStr.onChanged=function(){e.setState({changed:e.state.changed+1})}}}componentWillUnmount(){this.locStr&&(this.locStr.onChanged=function(){})}render(){if(!this.locStr)return null;if(this.locStr.hasHtml){const e={__html:this.locStr.renderedHtml};return v("span",{className:"sv-string-editor",contentEditable:"true",suppressContentEditableWarning:!0,style:this.style,dangerouslySetInnerHTML:e,onBlur:this.onInput,onClick:this.onClick})}return v("span",{className:"sv-string-editor",contentEditable:"true",suppressContentEditableWarning:!0,style:this.style,onBlur:this.onInput,onClick:this.onClick},this.locStr.renderedHtml)}}te.Instance.registerElement(wt.editableRenderer,n=>v(m4,n));function Rw(n,e,t={}){const s=v(pc,Object.assign({model:n},t));Jb(s,e)}function f4(n,e,t={}){const s=v(HL,Object.assign({model:n},t));Jb(s,e)}function _w(n){return this.each(function(){f4(n.model,this,n)})}let wc=globalThis;typeof globalThis>"u"&&(wc=window);let Al=wc.jQuery||wc.$;if(typeof Al<"u")Lw(Al);else try{Al=require("jquery"),Lw(Al)}catch{}function Lw(n){n.fn.extend({Survey:function(e){return this.each(function(){Rw(e.model,this,e)})},PopupSurvey:_w,SurveyWindow:_w})}Ie.platform="js-ui",Ie.prototype.render=function(n=null){this.renderCallback?this.renderCallback():Rw(this,n)},c7("2.3.15","survey-js-ui");var y4="4.0.0";const v4={name:"SurveyjsComponent",version:y4,parameters:{name:{type:$.STRING,default:void 0},survey_json:{type:$.OBJECT,default:{}},survey_function:{type:$.FUNCTION,default:null},validation_function:{type:$.FUNCTION,default:null},min_width:{type:$.STRING,default:"min(100vw, 800px)"},coordinates:{type:$.OBJECT,default:{x:0,y:0}}},data:{response:{type:$.OBJECT},rt:{type:$.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},kp=class kp{constructor(e){this.survey=null,this.response={},this.rt=0,this.startTime=0,this.jsPsych=e}createSurveyContainer(e,t){const s=document.createElement("div");return s.classList.add("jspsych-survey-container"),s.style.textAlign="initial",s.style.minWidth=t,s.style.overflowY="auto",s.style.overflowX="auto",e.appendChild(s),s}render(e,t,s){const i=d=>d<-1?-50:d>1?50:d*50,r=document.createElement("div");r.id="jspsych-survey-surveyjs-container",r.style.position="absolute",r.style.maxHeight="90vh",r.style.overflowY="auto",r.style.overflowX="hidden";const a=i(t.coordinates.x),o=i(t.coordinates.y);r.style.left=`calc(50% + ${a}vw)`,r.style.top=`calc(50% + ${o}vh)`,r.style.transform="translate(-50%, -50%)",e.appendChild(r),JSON.stringify(t.survey_json)==="{}"&&t.survey_function===null&&console.error("Survey plugin warning: you must define the survey using a non-empty JSON object and/or a survey function.");const l=t.survey_json.themeVariables||{};this.survey=new Ie(t.survey_json),t.survey_function!==null&&typeof t.survey_function=="function"&&t.survey_function(this.survey),Object.keys(l).length>0&&(console.log("Applying theme with variables:",l),this.survey.applyTheme({cssVariables:l,themeName:"plain",colorPalette:"light",isPanelless:!1})),t.validation_function&&typeof t.validation_function=="function"&&this.survey.onValidateQuestion.add(t.validation_function),this.survey.onComplete.add((d,h)=>{const f=d.getAllQuestions(),C=Object.keys(d.data);for(const b of f)C.includes(b.name)||d.mergeData({[b.name]:b.defaultValue??null});this.rt=Math.round(performance.now()-this.startTime),this.response=d.data,s&&typeof s=="function"&&s()});const u=this.createSurveyContainer(r,t.min_width||"min(100vw, 800px)");this.survey.render(u),this.startTime=performance.now()}getResponse(){return this.response}getRT(){return this.rt}getSurvey(){return this.survey}destroy(){}};kp.info=v4;let xc=kp;var C4="2.1.0";const b4={name:"SketchpadComponent",version:C4,parameters:{name:{type:$.STRING,default:void 0},canvas_shape:{type:$.STRING,default:"rectangle"},canvas_width:{type:$.INT,default:500},canvas_height:{type:$.INT,default:500},canvas_diameter:{type:$.INT,default:500},canvas_border_width:{type:$.INT,default:0},canvas_border_color:{type:$.STRING,default:"#000"},background_image:{type:$.IMAGE,default:null},background_color:{type:$.STRING,default:"#ffffff"},stroke_width:{type:$.INT,default:2},stroke_color:{type:$.STRING,default:"#000000"},stroke_color_palette:{type:$.STRING,array:!0,default:[]},prompt:{type:$.HTML_STRING,default:null},prompt_location:{type:$.STRING,default:"abovecanvas"},save_final_image:{type:$.BOOL,default:!0},save_strokes:{type:$.BOOL,default:!0},key_to_draw:{type:$.KEY,default:null},show_clear_button:{type:$.BOOL,default:!0},clear_button_label:{type:$.STRING,default:"Clear"},show_undo_button:{type:$.BOOL,default:!0},undo_button_label:{type:$.STRING,default:"Undo"},show_redo_button:{type:$.BOOL,default:!0},redo_button_label:{type:$.STRING,default:"Redo"},coordinates:{type:$.OBJECT,default:{x:0,y:0}}},data:{png:{type:$.STRING},strokes:{type:$.COMPLEX,array:!0,nested:{action:{type:$.STRING},x:{type:$.INT,optional:!0},y:{type:$.INT,optional:!0},t:{type:$.INT,optional:!0},color:{type:$.STRING,optional:!0}}}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},Np=class Np{constructor(e){this.display=null,this.canvas=null,this.ctx=null,this.is_drawing=!1,this.strokes=[],this.stroke=[],this.undo_history=[],this.mouse_position={x:0,y:0},this.draw_key_held=!1,this.current_stroke_color="#000000",this.background_image=null,this.start_time=0,this.jsPsych=e}async render(e,t){const s=o=>o<-1?-50:o>1?50:o*50,i=document.createElement("div");i.id="jspsych-sketchpad-container",i.style.position="absolute";const r=s(t.coordinates.x),a=s(t.coordinates.y);i.style.left=`calc(50% + ${r}vw)`,i.style.top=`calc(50% + ${a}vh)`,i.style.transform="translate(-50%, -50%)",e.appendChild(i),this.display=i,this.current_stroke_color=t.stroke_color,this.start_time=performance.now(),this.init_display(t),this.setup_event_listeners(t),this.add_background_color(t),await this.add_background_image(t)}init_display(e){this.add_css(e);let t;if(e.canvas_shape=="rectangle")t=`
        <canvas id="sketchpad-canvas" 
        width="${e.canvas_width}" 
        height="${e.canvas_height}" 
        class="sketchpad-rectangle"></canvas>
      `;else if(e.canvas_shape=="circle")t=`
        <canvas id="sketchpad-canvas" 
        width="${e.canvas_diameter}" 
        height="${e.canvas_diameter}" 
        class="sketchpad-circle">
        </canvas>
      `;else throw new Error('`canvas_shape` parameter in sketchpad plugin must be either "rectangle" or "circle"');let s='<div id="sketchpad-controls">';s+='<div id="sketchpad-color-palette">';const i=Array.isArray(e.stroke_color_palette)?e.stroke_color_palette:[];for(const a of i)s+=`<button class="sketchpad-color-select" data-color="${a}" style="background-color:${a};"></button>`;s+="</div>",s+='<div id="sketchpad-actions">',e.show_clear_button&&(s+=`<button class="jspsych-btn" id="sketchpad-clear" disabled>${e.clear_button_label}</button>`),e.show_undo_button&&(s+=`<button class="jspsych-btn" id="sketchpad-undo" disabled>${e.undo_button_label}</button>`,e.show_redo_button&&(s+=`<button class="jspsych-btn" id="sketchpad-redo" disabled>${e.redo_button_label}</button>`)),s+="</div></div>",t+=s;let r=t;e.prompt!==null&&(e.prompt_location=="abovecanvas"?r=e.prompt+t:e.prompt_location=="belowcanvas"&&(r=t+e.prompt)),this.display&&(this.display.innerHTML=r,this.canvas=this.display.querySelector("#sketchpad-canvas"),this.canvas&&(this.ctx=this.canvas.getContext("2d")))}setup_event_listeners(e){if(document.addEventListener("pointermove",t=>{this.mouse_position={x:t.clientX,y:t.clientY}}),!!this.canvas&&(this.canvas.addEventListener("pointerdown",this.start_draw.bind(this,e)),this.canvas.addEventListener("pointermove",this.move_draw.bind(this,e)),this.canvas.addEventListener("pointerup",this.end_draw.bind(this)),this.canvas.addEventListener("pointerleave",this.end_draw.bind(this)),this.canvas.addEventListener("pointercancel",this.end_draw.bind(this)),e.key_to_draw!==null&&(document.addEventListener("keydown",t=>{t.key==e.key_to_draw&&!this.is_drawing&&!this.draw_key_held&&(this.draw_key_held=!0,this.canvas&&document.elementFromPoint(this.mouse_position.x,this.mouse_position.y)==this.canvas&&this.canvas.dispatchEvent(new PointerEvent("pointerdown",{clientX:this.mouse_position.x,clientY:this.mouse_position.y})))}),document.addEventListener("keyup",t=>{t.key==e.key_to_draw&&(this.draw_key_held=!1,this.canvas&&document.elementFromPoint(this.mouse_position.x,this.mouse_position.y)==this.canvas&&this.canvas.dispatchEvent(new PointerEvent("pointerup",{clientX:this.mouse_position.x,clientY:this.mouse_position.y})))})),e.show_undo_button&&this.display&&(this.display.querySelector("#sketchpad-undo")?.addEventListener("click",this.undo.bind(this,e)),e.show_redo_button&&this.display.querySelector("#sketchpad-redo")?.addEventListener("click",this.redo.bind(this,e))),e.show_clear_button&&this.display&&this.display.querySelector("#sketchpad-clear")?.addEventListener("click",this.clear.bind(this,e)),this.display)){const t=Array.prototype.slice.call(this.display.querySelectorAll(".sketchpad-color-select"));for(const s of t)s.addEventListener("click",i=>{const r=i.target;this.current_stroke_color=r.getAttribute("data-color")})}}add_css(e){document.querySelector("head")?.insertAdjacentHTML("beforeend",`<style id="sketchpad-styles">
        #sketchpad-controls {
          line-height: 1; 
          width:${e.canvas_shape=="rectangle"?e.canvas_width+e.canvas_border_width*2:e.canvas_diameter+e.canvas_border_width*2}px; 
          display: flex; 
          justify-content: space-between; 
          flex-wrap: wrap;
          margin: auto;
        }
        #sketchpad-color-palette { 
          display: inline-block; text-align:left; flex-grow: 1;
        }
        .sketchpad-color-select { 
          cursor: pointer; height: 33px; width: 33px; border-radius: 4px; padding: 0; border: 1px solid #ccc; 
        }
        #sketchpad-actions {
          display:inline-block; text-align:right; flex-grow: 1;
        }
        #sketchpad-actions button {
          margin-left: 4px;
        }
        #sketchpad-canvas {
          touch-action: none;
          border: ${e.canvas_border_width}px solid ${e.canvas_border_color};
        }
        .sketchpad-circle {
          border-radius: ${e.canvas_diameter/2}px;
        }
      </style>`)}add_background_color(e){this.ctx&&(this.ctx.fillStyle=e.background_color,e.canvas_shape=="rectangle"&&this.ctx.fillRect(0,0,e.canvas_width,e.canvas_height),e.canvas_shape=="circle"&&this.ctx.fillRect(0,0,e.canvas_diameter,e.canvas_diameter))}async add_background_image(e){return new Promise((t,s)=>{e.background_image!==null?(this.background_image=new Image,this.background_image.src=e.background_image,this.background_image.onload=()=>{this.ctx&&this.background_image&&this.ctx.drawImage(this.background_image,0,0),t()}):t()})}start_draw(e,t){if(!this.canvas||!this.ctx)return;this.is_drawing=!0;const s=Math.round(t.clientX-this.canvas.getBoundingClientRect().left),i=Math.round(t.clientY-this.canvas.getBoundingClientRect().top);this.undo_history=[],this.set_redo_btn_state(!1,e),this.ctx.beginPath(),this.ctx.moveTo(s,i),this.ctx.strokeStyle=this.current_stroke_color,this.ctx.lineJoin="round",this.ctx.lineWidth=e.stroke_width,this.stroke=[],this.stroke.push({x:s,y:i,color:this.current_stroke_color,action:"start",t:Math.round(performance.now()-this.start_time)}),this.canvas.releasePointerCapture(t.pointerId)}move_draw(e,t){if(!(!this.canvas||!this.ctx)&&this.is_drawing){const s=Math.round(t.clientX-this.canvas.getBoundingClientRect().left),i=Math.round(t.clientY-this.canvas.getBoundingClientRect().top);this.ctx.lineTo(s,i),this.ctx.stroke(),this.stroke.push({x:s,y:i,action:"move"})}}end_draw(e){this.is_drawing&&(this.stroke.push({action:"end",t:Math.round(performance.now()-this.start_time)}),this.strokes.push(this.stroke),this.set_undo_btn_state(!0,{}),this.set_clear_btn_state(!0,{})),this.is_drawing=!1}render_drawing(e){if(!(!this.ctx||!this.canvas)){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.add_background_color(e),this.background_image&&this.ctx&&this.ctx.drawImage(this.background_image,0,0);for(const t of this.strokes)for(const s of t)s.action=="start"&&(this.ctx.beginPath(),this.ctx.moveTo(s.x,s.y),this.ctx.strokeStyle=s.color,this.ctx.lineJoin="round",this.ctx.lineWidth=e.stroke_width),s.action=="move"&&(this.ctx.lineTo(s.x,s.y),this.ctx.stroke())}}undo(e){this.undo_history.push(this.strokes.pop()),this.set_redo_btn_state(!0,e),this.strokes.length==0&&this.set_undo_btn_state(!1,e),this.render_drawing(e)}redo(e){this.strokes.push(this.undo_history.pop()),this.set_undo_btn_state(!0,e),this.undo_history.length==0&&this.set_redo_btn_state(!1,e),this.render_drawing(e)}clear(e){this.strokes=[],this.undo_history=[],this.render_drawing(e),this.set_redo_btn_state(!1,e),this.set_undo_btn_state(!1,e),this.set_clear_btn_state(!1,e)}set_undo_btn_state(e,t){if(t.show_undo_button&&this.display){const s=this.display.querySelector("#sketchpad-undo");s&&(s.disabled=!e)}}set_redo_btn_state(e,t){if(t.show_undo_button&&t.show_redo_button&&this.display){const s=this.display.querySelector("#sketchpad-redo");s&&(s.disabled=!e)}}set_clear_btn_state(e,t){if(t.show_clear_button&&this.display){const s=this.display.querySelector("#sketchpad-clear");s&&(s.disabled=!e)}}getStrokes(){return this.strokes}getImageData(){return this.canvas?this.canvas.toDataURL():null}destroy(){document.querySelector("#sketchpad-styles")?.remove()}};Np.info=b4;let Vc=Np;const w4={name:"AudioResponseComponent",version:"1.0.0",parameters:{name:{type:$.STRING,default:void 0},recording_duration:{type:$.INT,default:2e3},show_done_button:{type:$.BOOL,default:!0},done_button_label:{type:$.STRING,default:"Continue"},record_again_button_label:{type:$.STRING,default:"Record again"},accept_button_label:{type:$.STRING,default:"Continue"},allow_playback:{type:$.BOOL,default:!1},save_audio_url:{type:$.BOOL,default:!1}},data:{response:{type:$.STRING},rt:{type:$.INT},estimated_stimulus_onset:{type:$.INT},audio_url:{type:$.STRING}}},qp=class qp{constructor(e){this.recorder=null,this.recorded_data_chunks=[],this.rt=null,this.response="",this.audio_url="",this.recorder_start_time=0,this.stimulus_start_time=0,this.load_resolver=null,this.data_available_handler=null,this.stop_event_handler=null,this.start_event_handler=null,this.buttonContainer=null,this.jsPsych=e}async render(e,t,s){if(this.recorder=this.jsPsych.pluginAPI.getMicrophoneRecorder(),!this.recorder){console.error("Microphone recorder not initialized. Make sure to use the initialize-microphone plugin first."),e.innerHTML='<p style="color: red;">Microphone not initialized. Please add the initialize-microphone plugin to your timeline.</p>';return}this.setupRecordingEvents(e,t,s),this.startRecording()}setupRecordingEvents(e,t,s){this.recorder&&(this.data_available_handler=i=>{i.data.size>0&&this.recorded_data_chunks.push(i.data)},this.stop_event_handler=()=>{const i=new Blob(this.recorded_data_chunks,{type:this.recorded_data_chunks[0]?.type||"audio/webm"});this.audio_url=URL.createObjectURL(i);const r=new FileReader;r.addEventListener("load",()=>{const a=r.result.split(",")[1];this.response=a,this.load_resolver&&this.load_resolver()}),r.readAsDataURL(i)},this.start_event_handler=i=>{this.recorded_data_chunks=[],this.recorder_start_time=i.timeStamp||performance.now(),this.showDisplay(e,t,s)},this.recorder.addEventListener("dataavailable",this.data_available_handler),this.recorder.addEventListener("stop",this.stop_event_handler),this.recorder.addEventListener("start",this.start_event_handler))}startRecording(){this.recorder&&this.recorder.start()}showDisplay(e,t,s){if(this.stimulus_start_time=performance.now(),this.buttonContainer=document.createElement("div"),this.buttonContainer.id="jspsych-audio-response-buttons",this.buttonContainer.style.marginTop="20px",t.show_done_button!==!1){const i=document.createElement("button");i.className="jspsych-btn",i.id="finish-trial",i.textContent=t.done_button_label||"Continue",i.addEventListener("click",()=>{const r=performance.now();this.rt=Math.round(r-this.stimulus_start_time),this.stopRecording().then(()=>{t.allow_playback?this.showPlaybackControls(e,t,s):s&&s()})}),this.buttonContainer.appendChild(i)}e.appendChild(this.buttonContainer),t.recording_duration!==null&&t.recording_duration!==void 0&&this.jsPsych.pluginAPI.setTimeout(()=>{this.recorder&&this.recorder.state!=="inactive"&&this.stopRecording().then(()=>{t.allow_playback?this.showPlaybackControls(e,t,s):s&&s()})},t.recording_duration)}stopRecording(){return this.recorder?(this.recorder.stop(),new Promise(e=>{this.load_resolver=e})):Promise.resolve()}showPlaybackControls(e,t,s){this.buttonContainer?this.buttonContainer.innerHTML="":(this.buttonContainer=document.createElement("div"),this.buttonContainer.id="jspsych-audio-response-playback",e.appendChild(this.buttonContainer));const i=document.createElement("audio");i.id="playback",i.src=this.audio_url,i.controls=!0,i.style.display="block",i.style.margin="20px auto";const r=document.createElement("button");r.id="record-again",r.className="jspsych-btn",r.textContent=t.record_again_button_label||"Record again",r.style.marginRight="10px";const a=document.createElement("button");a.id="continue",a.className="jspsych-btn",a.textContent=t.accept_button_label||"Continue",r.addEventListener("click",()=>{URL.revokeObjectURL(this.audio_url),this.rt=null,this.response="",this.buttonContainer&&(this.buttonContainer.innerHTML=""),this.recorder&&this.recorder.start()}),a.addEventListener("click",()=>{s&&s()}),this.buttonContainer.appendChild(i),this.buttonContainer.appendChild(r),this.buttonContainer.appendChild(a)}getResponse(){return{response:this.response,audio_url:this.audio_url,estimated_stimulus_onset:Math.round(this.stimulus_start_time-this.recorder_start_time)}}getRT(){return this.rt}destroy(){this.recorder&&(this.data_available_handler&&this.recorder.removeEventListener("dataavailable",this.data_available_handler),this.stop_event_handler&&this.recorder.removeEventListener("stop",this.stop_event_handler),this.start_event_handler&&this.recorder.removeEventListener("start",this.start_event_handler)),this.audio_url&&URL.revokeObjectURL(this.audio_url),this.recorder=null}};qp.info=w4;let Pc=qp;const x4={name:"DynamicPlugin",version:"1.0.0",parameters:{components:{type:$.COMPLEX,array:!0,default:[]},response_components:{type:$.COMPLEX,array:!0,default:[]},stimuli_duration:{type:$.INT,default:null},trial_duration:{type:$.INT,default:null},response_ends_trial:{type:$.BOOL,default:!0}},data:{rt:{type:$.INT}}},V4={ImageComponent:od,VideoComponent:ld,HtmlComponent:ud,AudioComponent:hd},P4={ButtonResponseComponent:dd,SliderResponseComponent:cd,KeyboardResponseComponent:pd,InputResponseComponent:gd,SurveyComponent:xc,SketchpadComponent:Vc,AudioResponseComponent:Pc},Bp=class Bp{constructor(e){this.jsPsych=e}trial(e,t){if(!document.getElementById("jspsych-dynamic-plugin-styles")){const f=document.createElement("style");f.id="jspsych-dynamic-plugin-styles",f.textContent=`
        #jspsych-dynamic-plugin-container {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-height: 100vh;
          position: relative;
          width: 100%;
        }
        .dynamic-image-component,
        #jspsych-html-component-main,
        #jspsych-button-response-main {
          visibility: visible !important;
        }
        #jspsych-dynamic-plugin-container img,
        #jspsych-dynamic-plugin-container canvas {
          display: block;
        }
      `,document.head.appendChild(f)}const s=document.createElement("div");s.id="jspsych-dynamic-plugin-container",e.appendChild(s);const i=performance.now(),r=[],a=[];let o=!1;const l={};t.components&&t.components.length>0&&t.components.forEach((f,C)=>{const b=V4[f.type];if(b){l[f.type]=(l[f.type]||0)+1,f.name||(f.name=`${f.type}_${l[f.type]}`);const x=new b(this.jsPsych);r.push({instance:x,config:f})}else console.warn(`Unknown component type: ${f.type}`)});const u={};t.response_components&&t.response_components.length>0&&t.response_components.forEach((f,C)=>{const b=P4[f.type];if(b){u[f.type]=(u[f.type]||0)+1,f.name||(f.name=`${f.type}_${u[f.type]}`);const x=new b(this.jsPsych);a.push({instance:x,config:f})}else console.warn(`Unknown response component type: ${f.type}`)}),r.forEach(({instance:f,config:C})=>{f.render(s,C,()=>{!o&&t.response_ends_trial&&(o=!0,d(),h())})}),a.forEach(({instance:f,config:C})=>{f.render(s,C,()=>{!o&&t.response_ends_trial&&(o=!0,d(),h())})});const d=()=>{a.forEach(({instance:f,config:C})=>{f.recordResponse&&typeof f.recordResponse=="function"&&f.recordResponse(C)}),r.forEach(({instance:f,config:C})=>{f.recordResponse&&typeof f.recordResponse=="function"&&f.recordResponse(C)})},h=()=>{const C={rt:Math.round(performance.now()-i)};r.forEach(({instance:b,config:x})=>{const V=x.name;if(C[`${V}_type`]=x.type,x.stimulus!==void 0&&(C[`${V}_stimulus`]=x.stimulus),x.coordinates!==void 0&&(C[`${V}_coordinates`]=JSON.stringify(x.coordinates)),b.getResponse&&typeof b.getResponse=="function"){const P=b.getResponse();x.type==="SurveyComponent"&&typeof P=="object"&&P!==null?Object.keys(P).forEach(M=>{C[`${V}_${M}`]=P[M]}):C[`${V}_response`]=P,b.getRT&&typeof b.getRT=="function"&&(C[`${V}_rt`]=b.getRT())}}),a.forEach(({instance:b,config:x})=>{const V=x.name;if(C[`${V}_type`]=x.type,b.getResponse&&typeof b.getResponse=="function"){const P=b.getResponse();C[`${V}_response`]=P}if(b.getRT&&typeof b.getRT=="function"&&(C[`${V}_rt`]=b.getRT()),x.type==="SliderResponseComponent"&&b.getSliderStart&&(C[`${V}_slider_start`]=b.getSliderStart()),x.type==="SketchpadComponent"&&(b.getStrokes&&typeof b.getStrokes=="function"&&(C[`${V}_strokes`]=JSON.stringify(b.getStrokes())),b.getImageData&&typeof b.getImageData=="function"&&(C[`${V}_png`]=b.getImageData())),x.type==="AudioResponseComponent"){const P=b.getResponse?b.getResponse():null;P&&typeof P=="object"&&(C[`${V}_response`]=P.response,C[`${V}_audio_url`]=P.audio_url,C[`${V}_estimated_stimulus_onset`]=P.estimated_stimulus_onset)}}),r.forEach(({instance:b})=>{b.destroy&&b.destroy()}),a.forEach(({instance:b})=>{b.destroy&&b.destroy()}),e.innerHTML="",this.jsPsych.finishTrial(C)};t.stimuli_duration!==null&&t.stimuli_duration!==void 0&&this.jsPsych.pluginAPI.setTimeout(()=>{r.forEach(({instance:f})=>{f.hide&&f.hide()})},t.stimuli_duration),t.trial_duration!==null&&t.trial_duration!==void 0&&this.jsPsych.pluginAPI.setTimeout(()=>{o||(o=!0,d()),h()},t.trial_duration)}};Bp.info=x4;let Sc=Bp;const Aw=Object.freeze(Object.defineProperty({__proto__:null,DynamicPlugin:Sc,initJsPsych:U0,jsPsychAnimation:Ul,jsPsychAudioButtonResponse:Wl,jsPsychAudioKeyboardResponse:$l,jsPsychAudioSliderResponse:Gl,jsPsychBrowserCheck:Kl,jsPsychCallFunction:Zl,jsPsychCanvasButtonResponse:Yl,jsPsychCanvasKeyboardResponse:Xl,jsPsychCanvasSliderResponse:eu,jsPsychCategorizeAnimation:tu,jsPsychCategorizeHtml:su,jsPsychCategorizeImage:iu,jsPsychCloze:ru,jsPsychExtensionMouseTracking:rd,jsPsychExtensionRecordVideo:id,jsPsychExtensionWebgazer:Xh,jsPsychExternalHtml:nu,jsPsychFreeSort:au,jsPsychFullscreen:ou,jsPsychHtmlAudioResponse:lu,jsPsychHtmlButtonResponse:uu,jsPsychHtmlKeyboardResponse:hu,jsPsychHtmlSliderResponse:du,jsPsychHtmlVideoResponse:cu,jsPsychIatHtml:pu,jsPsychIatImage:gu,jsPsychImageButtonResponse:mu,jsPsychImageKeyboardResponse:fu,jsPsychImageSliderResponse:yu,jsPsychInitializeCamera:vu,jsPsychInitializeMicrophone:Cu,jsPsychInstructions:bu,jsPsychMaxdiff:wu,jsPsychMirrorCamera:xu,jsPsychPreload:Vu,jsPsychReconstruction:Pu,jsPsychResize:Su,jsPsychSameDifferentHtml:Iu,jsPsychSameDifferentImage:Tu,jsPsychSerialReactionTime:Eu,jsPsychSerialReactionTimeMouse:Ru,jsPsychSketchpad:_u,jsPsychSurvey:Hh,jsPsychSurveyHtmlForm:zh,jsPsychSurveyLikert:jh,jsPsychSurveyMultiChoice:Uh,jsPsychSurveyMultiSelect:Wh,jsPsychSurveyText:$h,jsPsychVideoButtonResponse:Gh,jsPsychVideoKeyboardResponse:Jh,jsPsychVideoSliderResponse:Kh,jsPsychVirtualChinrest:Zh,jsPsychVisualSearchCircle:Yh,jsPsychWebgazerCalibrate:ed,jsPsychWebgazerInitCamera:td,jsPsychWebgazerValidate:sd},Symbol.toStringTag,{value:"Module"}));typeof window<"u"&&(Object.assign(window,Aw),window.jsPsychModule=Aw)})();
