<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png+xml" href="/icon/fp black.png">
    <title>Experiment</title>
    <script src="https://unpkg.com/jspsych@8.2.1"></script>
    <script src="https://unpkg.com/@jspsych/plugin-animation@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-audio-button-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-audio-keyboard-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-audio-slider-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-browser-check@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-call-function@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-canvas-button-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-canvas-keyboard-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-canvas-slider-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-categorize-animation@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-categorize-html@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-categorize-image@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-cloze@2.2.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-external-html@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-free-sort@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-fullscreen@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-audio-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-button-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-slider-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-video-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-iat-html@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-iat-image@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-image-button-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-image-keyboard-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-image-slider-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-initialize-camera@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-initialize-microphone@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-instructions@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-maxdiff@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-mirror-camera@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-preload@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-reconstruction@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-resize@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-same-different-html@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-same-different-image@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-serial-reaction-time@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-serial-reaction-time-mouse@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-sketchpad@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-html-form@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-likert@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-multi-choice@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-multi-select@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-text@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-video-button-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-video-keyboard-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-video-slider-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-virtual-chinrest@3.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-visual-search-circle@2.2.0"></script>

    <script src="https://cdn.jsdelivr.net/gh/jspsych/jspsych@jspsych@7.0.0/examples/js/webgazer/webgazer.js"></script>

    <script src="https://unpkg.com/@jspsych/extension-webgazer@1.2.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-webgazer-calibrate@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-webgazer-init-camera@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-webgazer-validate@2.1.0"></script>

    <script src="https://unpkg.com/@jspsych/extension-record-video@1.2.0"></script>
    <script src="https://unpkg.com/@jspsych/extension-mouse-tracking@1.0.0"></script>

    <link href="https://unpkg.com/jspsych@7.3.1/css/jspsych.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://unpkg.com/@jspsych/plugin-survey@2.1.0/css/survey.css">

    <style>
      body {
        margin: 0;
        padding: 0;
        background-color: #f0f0f0;
      }
      #jspsych-target {
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="jspsych-target"></div>

    
  

<script id="generated-script">

  const trialSessionId =
    (crypto.randomUUID
      ? crypto.randomUUID()
      : Math.random().toString(36).slice(2, 10));

  let participantNumber;

  async function saveSession(trialSessionId) {
   
   const res = await fetch("/api/append-result/dc109108-ff41-4ff9-a830-316588ad7d83", {
      method: "POST",
      headers: { "Content-Type": "application/json", Accept: "*/*" },
      body: JSON.stringify({
        sessionId: trialSessionId,
      }),
    });
  
    const result = await res.json();
    participantNumber = result.participantNumber;
    return participantNumber;
    
  }

  (async () => {
    participantNumber = await saveSession(trialSessionId);

    if (typeof participantNumber !== "number" || isNaN(participantNumber)) {
      alert("The participant number is not assigned. Please, wait.");
      throw new Error("participantNumber not assigned");
    }

    // --- Branching logic functions (outside initJsPsych for timeline access) ---
    window.nextTrialId = null;
    window.skipRemaining = false;
    window.branchingActive = false;

    const evaluateCondition = (trialData, condition) => {
      // All rules in a condition must be true (AND logic)
      return condition.rules.every(rule => {
        const propValue = trialData[rule.prop];
        const compareValue = rule.value;
        
        // Convert values for comparison
        const numPropValue = parseFloat(propValue);
        const numCompareValue = parseFloat(compareValue);
        const isNumeric = !isNaN(numPropValue) && !isNaN(numCompareValue);
        
        switch (rule.op) {
          case '==':
            return isNumeric ? numPropValue === numCompareValue : propValue == compareValue;
          case '!=':
            return isNumeric ? numPropValue !== numCompareValue : propValue != compareValue;
          case '>':
            return isNumeric && numPropValue > numCompareValue;
          case '<':
            return isNumeric && numPropValue < numCompareValue;
          case '>=':
            return isNumeric && numPropValue >= numCompareValue;
          case '<=':
            return isNumeric && numPropValue <= numCompareValue;
          default:
            return false;
        }
      });
    };
    
    const getNextTrialId = (lastTrialData) => {
      if (!lastTrialData || !lastTrialData.trials || !lastTrialData.trials[0]) {
        return null;
      }
      
      const trial = lastTrialData.trials[0];
      
      // Check if trial/loop has branches
      if (!Array.isArray(trial.branches) || trial.branches.length === 0) {
        return null;
      }
      
      // Si solo hay un branch O no hay condiciones, seguir al primer branch automáticamente
      const hasMultipleBranches = trial.branches.length > 1;
      const hasBranchConditions = Array.isArray(trial.branchConditions) && trial.branchConditions.length > 0;
      
      if (!hasMultipleBranches || !hasBranchConditions) {
        console.log('Auto-branching to first branch:', trial.branches[0]);
        return trial.branches[0];
      }
      
      // Si hay múltiples branches Y condiciones, evaluar las condiciones
      // branchConditions is an array of arrays, flatten it first
      const conditions = trial.branchConditions.flat();
      
      // Evaluate each condition (OR logic between conditions)
      for (const condition of conditions) {
        if (!condition || !condition.rules) {
          console.warn('Invalid condition structure:', condition);
          continue;
        }
        
        if (evaluateCondition(trial, condition)) {
          console.log('Condition matched:', condition);
          return condition.nextTrialId;
        }
      }
      
      // No condition matched - seguir al primer branch por defecto
      console.log('No condition matched, defaulting to first branch:', trial.branches[0]);
      return trial.branches[0];
    };

    const jsPsych = initJsPsych({

    

    on_data_update: function (data) {
      const res = fetch("/api/append-result/dc109108-ff41-4ff9-a830-316588ad7d83", {
        method: "PUT",
        headers: { "Content-Type": "application/json", Accept: "*/*" },
        body: JSON.stringify({
          sessionId: trialSessionId,
          response: data,
        }),
      });

      // Solo evaluar branching si el trial/loop tiene un trial_id o loop_id válido
      if ((!data.trial_id || data.trial_id === undefined) && (!data.loop_id || data.loop_id === undefined)) {
        return;
      }
      
      const lastTrialData = jsPsych.data.getLastTrialData();
      const trial = lastTrialData.trials ? lastTrialData.trials[0] : null;
      
      // Verificar si este trial/loop tiene branches
      if (!trial || !trial.branches || trial.branches.length === 0) {
        return; // No tiene branches, no hay nada que hacer
      }
      
      console.log('Trial/Loop data:', lastTrialData);
      
      const nextTrialId = getNextTrialId(lastTrialData);
      console.log('Next trial/loop ID:', nextTrialId);
      
      if (nextTrialId) {
        window.nextTrialId = nextTrialId;
        window.skipRemaining = true;
        window.branchingActive = true;
        console.log('Branching activated: skip to trial/loop', nextTrialId);
      }
    },

  on_finish: function() {
    jsPsych.data.displayData
  }
});

const timeline = [];

const welcome = {
  type: jsPsychHtmlButtonResponse,
  stimulus: "Welcome to the experiment. Press 'Start' to begin.",
  choices: ['Start'],
};

timeline.push(welcome);


    const preloadconsentnrm = {
        type: jsPsychPreload,
       files: [],
    }
    timeline.push(preloadconsentnrm);
    
    const test_stimuli_consentnrm = [{stimulus: "<div id=\"ilxn\" style=\"box-sizing: border-box;\">Loop?</div>",
choices: ["Si","No"]}];
    const consentnrm_timeline = {
    type: jsPsychHtmlButtonResponse, stimulus: jsPsych.timelineVariable("stimulus"),
choices: jsPsych.timelineVariable("choices"),
      data: {
        rt: "rt",
response: "response",
stimulus: "stimulus",
        trial_id: 1762198896586,
        
        branches: [1762198937121, "loop_1762199634851"],
        branchConditions: [[{"id":1762199014286,"rules":[{"prop":"response","op":"==","value":"1"}],"nextTrialId":"1762198937121"},{"id":1762200042199,"rules":[{"prop":"response","op":"==","value":"0"}],"nextTrialId":"loop_1762199634851"}]] 
        
      },
    };
    const consentnrm_procedure = {
    timeline: 
    [consentnrm_timeline],
    timeline_variables: test_stimuli_consentnrm,
    conditional_function: function() {
      const currentId = 1762198896586;
      
      // Si skipRemaining está activo, verificar si este es el trial objetivo
      if (window.skipRemaining) {
        if (String(currentId) === String(window.nextTrialId)) {
          // Encontramos el trial objetivo
          window.skipRemaining = false;
          window.nextTrialId = null;
          return true;
        }
        // No es el objetivo, saltar
        return false;
      }
      
      return true;
    },
    
    };
    timeline.push(consentnrm_procedure);
  


    const preloadnobn = {
        type: jsPsychPreload,
       files: [],
    }
    timeline.push(preloadnobn);
    
    const test_stimuli_nobn = [{stimulus: "<div id=\"iukh\" style=\"box-sizing: border-box;\">Gracias por participar</div>"}];
    const nobn_timeline = {
    type: jsPsychHtmlKeyboardResponse, stimulus: jsPsych.timelineVariable("stimulus"),
      data: {
        response: "response",
rt: "rt",
stimulus: "stimulus",
        trial_id: 1762198937121,
        
        branches: [1762201407148, 1762201408848],
        branchConditions: [undefined] 
        
      },
    
    on_finish: function(data) {
      // Branching automático al primer branch
      const branches = [1762201407148, 1762201408848];
      if (branches.length > 0) {
        window.nextTrialId = branches[0];
        window.skipRemaining = true;
        window.branchingActive = true;
      }
    },
    };
    const nobn_procedure = {
    timeline: 
    [nobn_timeline],
    timeline_variables: test_stimuli_nobn,
    conditional_function: function() {
      const currentId = 1762198937121;
      
      // Si skipRemaining está activo, verificar si este es el trial objetivo
      if (window.skipRemaining) {
        if (String(currentId) === String(window.nextTrialId)) {
          // Encontramos el trial objetivo
          window.skipRemaining = false;
          window.nextTrialId = null;
          return true;
        }
        // No es el objetivo, saltar
        return false;
      }
      
      return true;
    },
    
    };
    timeline.push(nobn_procedure);
  



    const test_stimuli_loop_1762199634851 = [
  {
    "stimulus_sin": "<div id=\"i0gh\" style=\"box-sizing: border-box;\">Loop loco?</div>",
    "choices_sin": [
      "s",
      "n"
    ],
    "stimulus_no": "<div id=\"idh7\" style=\"box-sizing: border-box;\">NO LOCO</div>",
    "stimulus_si": "<div id=\"iolv\" style=\"box-sizing: border-box;\">LOCOTE</div>"
  }
];
    
    
    
    const preloadsin = {
        type: jsPsychPreload,
       files: [],
    }
    timeline.push(preloadsin);
    
    const sin_timeline = {
    type: jsPsychHtmlKeyboardResponse, stimulus: jsPsych.timelineVariable("stimulus_sin"),
choices: jsPsych.timelineVariable("choices_sin"),
      data: {
        response: "response_sin",
rt: "rt_sin",
stimulus: "stimulus_sin",
        trial_id: 1762198966389,
        
        branches: [1762199606669, 1762202918477],
        branchConditions: [[{"id":1762203084731,"rules":[{"prop":"response","op":"==","value":"s"}],"nextTrialId":"1762202918477"},{"id":1762203092164,"rules":[{"prop":"response","op":"==","value":"n"}],"nextTrialId":"1762199606669"}]] 
        
      },
    };



    
    const preloadno = {
        type: jsPsychPreload,
       files: [],
    }
    timeline.push(preloadno);
    
    const no_timeline = {
    type: jsPsychHtmlKeyboardResponse, stimulus: jsPsych.timelineVariable("stimulus_no"),
      data: {
        response: "response_no",
rt: "rt_no",
stimulus: "stimulus_no",
        trial_id: 1762199606669,
        
      },
    
    on_finish: function(data) {
      // Este trial no tiene branches, es un trial terminal dentro del loop
      // Si llegamos aquí después de un branching interno, terminar el loop
      if (loopBranchingActive) {
        jsPsych.abortCurrentTimeline();
      }
    },};



    
    const preloadsi = {
        type: jsPsychPreload,
       files: [],
    }
    timeline.push(preloadsi);
    
    const si_timeline = {
    type: jsPsychHtmlKeyboardResponse, stimulus: jsPsych.timelineVariable("stimulus_si"),
      data: {
        response: "response_si",
rt: "rt_si",
stimulus: "stimulus_si",
        trial_id: 1762202918477,
        
      },
    
    on_finish: function(data) {
      // Este trial no tiene branches, es un trial terminal dentro del loop
      // Si llegamos aquí después de un branching interno, terminar el loop
      if (loopBranchingActive) {
        jsPsych.abortCurrentTimeline();
      }
    },};


// --- Branching logic functions for internal loop trials ---
let loopNextTrialId = null;
let loopSkipRemaining = false;
let loopBranchingActive = false;


    const sin_wrapper = {
      timeline: [sin_timeline],
      conditional_function: function() {
        // Si loopSkipRemaining está activo, verificar si este es el trial objetivo
        if (loopSkipRemaining) {
          // El trial_id se evalúa desde el data del trial
          // Necesitamos usar el ID definido en el trial
          const currentTrialId = sin_timeline.data.trial_id;
          if (String(currentTrialId) === String(loopNextTrialId)) {
            // Encontramos el trial objetivo dentro del loop
            loopSkipRemaining = false;
            loopNextTrialId = null;
            return true;
          }
          // No es el objetivo, saltar
          return false;
        }
        return true;
      }
    };


    const no_wrapper = {
      timeline: [no_timeline],
      conditional_function: function() {
        // Si loopSkipRemaining está activo, verificar si este es el trial objetivo
        if (loopSkipRemaining) {
          // El trial_id se evalúa desde el data del trial
          // Necesitamos usar el ID definido en el trial
          const currentTrialId = no_timeline.data.trial_id;
          if (String(currentTrialId) === String(loopNextTrialId)) {
            // Encontramos el trial objetivo dentro del loop
            loopSkipRemaining = false;
            loopNextTrialId = null;
            return true;
          }
          // No es el objetivo, saltar
          return false;
        }
        return true;
      }
    };


    const si_wrapper = {
      timeline: [si_timeline],
      conditional_function: function() {
        // Si loopSkipRemaining está activo, verificar si este es el trial objetivo
        if (loopSkipRemaining) {
          // El trial_id se evalúa desde el data del trial
          // Necesitamos usar el ID definido en el trial
          const currentTrialId = si_timeline.data.trial_id;
          if (String(currentTrialId) === String(loopNextTrialId)) {
            // Encontramos el trial objetivo dentro del loop
            loopSkipRemaining = false;
            loopNextTrialId = null;
            return true;
          }
          // No es el objetivo, saltar
          return false;
        }
        return true;
      }
    };

const evaluateLoopCondition = (trialData, condition) => {
  // All rules in a condition must be true (AND logic)
  return condition.rules.every(rule => {
    const propValue = trialData[rule.prop];
    const compareValue = rule.value;
    
    // Convert values for comparison
    const numPropValue = parseFloat(propValue);
    const numCompareValue = parseFloat(compareValue);
    const isNumeric = !isNaN(numPropValue) && !isNaN(numCompareValue);
    
    switch (rule.op) {
      case '==':
        return isNumeric ? numPropValue === numCompareValue : propValue == compareValue;
      case '!=':
        return isNumeric ? numPropValue !== numCompareValue : propValue != compareValue;
      case '>':
        return isNumeric && numPropValue > numCompareValue;
      case '<':
        return isNumeric && numPropValue < numCompareValue;
      case '>=':
        return isNumeric && numPropValue >= numCompareValue;
      case '<=':
        return isNumeric && numPropValue <= numCompareValue;
      default:
        return false;
    }
  });
};

const getNextLoopTrialId = (lastTrialData) => {
  if (!lastTrialData || !lastTrialData.trials || !lastTrialData.trials[0]) {
    return null;
  }
  
  const trial = lastTrialData.trials[0];
  
  // Check if trial has branches
  if (!Array.isArray(trial.branches) || trial.branches.length === 0) {
    return null;
  }
  
  // Si solo hay un branch O no hay condiciones, seguir al primer branch automáticamente
  const hasMultipleBranches = trial.branches.length > 1;
  const hasBranchConditions = Array.isArray(trial.branchConditions) && trial.branchConditions.length > 0;
  
  if (!hasMultipleBranches || !hasBranchConditions) {
    console.log('Loop internal: Auto-branching to first branch:', trial.branches[0]);
    return trial.branches[0];
  }
  
  // Si hay múltiples branches Y condiciones, evaluar las condiciones
  const conditions = trial.branchConditions.flat();
  
  // Evaluate each condition (OR logic between conditions)
  for (const condition of conditions) {
    if (!condition || !condition.rules) {
      console.warn('Invalid condition structure:', condition);
      continue;
    }
    
    if (evaluateLoopCondition(trial, condition)) {
      console.log('Loop internal: Condition matched:', condition);
      return condition.nextTrialId;
    }
  }
  
  // No condition matched - seguir al primer branch por defecto
  console.log('Loop internal: No condition matched, defaulting to first branch:', trial.branches[0]);
  return trial.branches[0];
};

const loop_1762199634851_procedure = {
  timeline: [sin_wrapper, no_wrapper, si_wrapper],
  timeline_variables: test_stimuli_loop_1762199634851,
  repetitions: 1,
  randomize_order: false,
  conditional_function: function() {
    const currentId = "loop_1762199634851";
    
    // Si skipRemaining está activo, verificar si este es el loop objetivo
    if (window.skipRemaining) {
      if (String(currentId) === String(window.nextTrialId)) {
        // Encontramos el loop objetivo
        window.skipRemaining = false;
        window.nextTrialId = null;
        return true;
      }
      // No es el objetivo, saltar
      return false;
    }
    
    return true;
  },
  on_timeline_start: function() {
    // Reset loop branching variables at the start of each loop iteration
    loopNextTrialId = null;
    loopSkipRemaining = false;
    loopBranchingActive = false;
  },
  on_timeline_finish: function() {
    // Reset loop branching variables when the loop finishes
    loopNextTrialId = null;
    loopSkipRemaining = false;
    loopBranchingActive = false;
  },
  on_data_update: function(data) {
    // Solo evaluar branching interno si el trial tiene un trial_id válido
    if (!data.trial_id || data.trial_id === undefined) {
      return;
    }
    
    const lastTrialData = jsPsych.data.getLastTrialData();
    const trial = lastTrialData.trials ? lastTrialData.trials[0] : null;
    
    // Verificar si este trial interno tiene branches
    if (!trial || !trial.branches || trial.branches.length === 0) {
      return; // No tiene branches, no hay nada que hacer
    }
    
    console.log('Loop internal trial data:', lastTrialData);
    
    const nextTrialId = getNextLoopTrialId(lastTrialData);
    console.log('Next loop internal trial ID:', nextTrialId);
    
    if (nextTrialId) {
      loopNextTrialId = nextTrialId;
      loopSkipRemaining = true;
      loopBranchingActive = true;
      console.log('Loop internal branching activated: skip to trial', nextTrialId);
    }
  },
  data: {
    loop_id: "loop_1762199634851",
    branches: [1762200368924],
    branchConditions: undefined
  },
  on_finish: function(data) {
    // Branching automático al primer branch
    const branches = [1762200368924];
    if (branches.length > 0) {
      window.nextTrialId = branches[0];
      window.skipRemaining = true;
      window.branchingActive = true;
    }
  },
};
timeline.push(loop_1762199634851_procedure);



    const preloadNew_Trial_1k = {
        type: jsPsychPreload,
       files: [],
    }
    timeline.push(preloadNew_Trial_1k);
    
    const test_stimuli_New_Trial_1k = [{stimulus: "<div id=\"isjq\" style=\"box-sizing: border-box;\">después de loop</div>",
choices: ["k"]}];
    const New_Trial_1k_timeline = {
    type: jsPsychHtmlKeyboardResponse, stimulus: jsPsych.timelineVariable("stimulus"),
choices: jsPsych.timelineVariable("choices"),
      data: {
        response: "response",
rt: "rt",
stimulus: "stimulus",
        trial_id: 1762200368924,
        
        branches: [1762201778731],
        branchConditions: [undefined] 
        
      },
    
    on_finish: function(data) {
      // Branching automático al primer branch
      const branches = [1762201778731];
      if (branches.length > 0) {
        window.nextTrialId = branches[0];
        window.skipRemaining = true;
        window.branchingActive = true;
      }
    },
    };
    const New_Trial_1k_procedure = {
    timeline: 
    [New_Trial_1k_timeline],
    timeline_variables: test_stimuli_New_Trial_1k,
    conditional_function: function() {
      const currentId = 1762200368924;
      
      // Si skipRemaining está activo, verificar si este es el trial objetivo
      if (window.skipRemaining) {
        if (String(currentId) === String(window.nextTrialId)) {
          // Encontramos el trial objetivo
          window.skipRemaining = false;
          window.nextTrialId = null;
          return true;
        }
        // No es el objetivo, saltar
        return false;
      }
      
      return true;
    },
    
    };
    timeline.push(New_Trial_1k_procedure);
  

jsPsych.run(timeline);

})();

</script></body></html>